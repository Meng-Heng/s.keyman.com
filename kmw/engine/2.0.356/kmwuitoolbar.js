var e=!0,l=null,m=!1;
(function(){var i=window.tavultesoft.keymanweb,o=i.osk,k=i.util;if(!k.isTouchDevice()){i.ui={s:m,c:l,Ea:l,n:l,o:l,P:l,u:l,Z:l,g:l,I:l,m:l,j:[],i:l,O:[],t:[],h:"as",b:[],X:0,ua:1,ra:l,q:l,v:"",pa:0,qa:0,p:[],D:m,z:0,H:""};var a=i.ui;a.name="toolbar";a.a={fa:"Languages",ia:"Turn off KeymanWeb keyboards",ha:"Off",ka:"Show On Screen Keyboard",ga:"Select language"};a.a.SelectKeyboardPre="Select ";a.a.SelectKeyboardSuf="keyboard";a.a.AltKeyboardsPre="Alternate keyboards for ";a.a.AltKeyboardsSuf="";a.a.ca=
"Central America";a.a.sa="South America";a.a.na="North America";a.a.eu="Europe";a.a.af="Africa";a.a.me="Middle east";a.a.as="Asia";a.a.oc="Oceania";a.createNode=function(a,c,d,f){var g=document.createElement(a);c&&(g.id=c);d&&(g.className=d);f&&(g.innerHTML=f);if("a"==a||"area"==a||"map"==a)g.Ia=function(){return m};return g};a.initialize=a.Ga=function(){if(i.initialized&&!a.s&&(a.s=e,!k.isTouchDevice())){k.linkStyleSheet(k.getOption("resources")+"ui/toolbar/kmwuitoolbar.css");a.e={};a.e.ca={k:a.a.ca,
l:"49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61"};a.e.sa={k:a.a.sa,l:"82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89"};a.e.na={k:a.a.na,l:"0,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8"};
a.e.eu={k:a.a.eu,l:"145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33"};a.e.af={k:a.a.af,l:"150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60"};a.e.me={k:a.a.me,
l:"205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53"};a.e.as={k:a.a.as,l:"219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0"};a.e.oc={k:a.a.oc,l:"288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130"};
a.c=a.createNode("div","kmw_controls");a.c.style.display="block";var b=a.createNode("a","kmw_controls_start",l," ");b.href="http://tavultesoft.com/keymanweb/";b.target="_blank";a.c.appendChild(b);a.o=a.createNode("div","kmw_btn_keyboards","kmw_button");a.o.title=a.a.ga;b=a.createNode("a",l,"kmw_button_a");b.href="#";b.onclick=a.Ba;b.appendChild(a.createNode("div","kmw_img_keyboards","kmw_img"));b.appendChild(a.createNode("div",l,"kmw_a",a.a.fa));b.appendChild(a.createNode("div",l,"kmw_drop"));a.o.appendChild(b);
a.m=a.createNode("div","kmw_selector");a.J=a.createNode("div","kmw_selector_regions");a.n=a.createNode("div","kmw_browsemap");b=a.createNode("img","kmw_region_browsemap");b.src=k.getOption("resources")+"ui/toolbar/blank.gif";b.useMap="#kmw_worldgrey16";a.n.appendChild(b);var c=a.createNode("map","kmw_worldgrey16");c.name="kmw_worldgrey16";for(var d in a.e)b=a.createNode("area"),b.shape="poly",b.alt="",b.href="#",b.title=a.e[d].k,b.Fa="true",b.onclick=function(b){return function(c){return a.R(c,b)}}(d),
b.onmouseover=function(b){return function(c){return a.W(c,b)}}(d),b.onmouseout=function(b){return function(c){return a.ba(c,b)}}(d),b.coords=a.e[d].l,c.appendChild(b);b=a.createNode("area");b.shape="default";b.Ha="true";b.alt="";b.onclick=a.f;c.appendChild(b);a.n.appendChild(c);a.J.appendChild(a.n);a.i=[];b=a.createNode("ul");for(d in a.e)c=a.createNode("li"),a.i[d]=a.createNode("a",l,l,a.e[d].k),a.i[d].href="#",a.i[d].onclick=function(b){return function(c){return a.R(c,b)}}(d),a.i[d].onmouseover=
function(b){return function(c){return a.W(c,b)}}(d),a.i[d].onmouseout=function(b){return function(c){return a.ba(c,b)}}(d),c.appendChild(a.i[d]),b.appendChild(c);a.J.appendChild(b);a.m.appendChild(a.J);a.o.appendChild(a.m);a.c.appendChild(a.o);a.c.appendChild(a.Z=a.createNode("div","kmw_bar_off","kmw_bar"));a.u=a.createNode("div","kmw_btn_off","kmw_button_selected");b=a.createNode("a",l,"kmw_button_a");b.href="#";b.onclick=a.va;b.title=a.a.ia;b.appendChild(a.createNode("div","kmw_img_off","kmw_img"));
b.appendChild(a.createNode("div",l,"kmw_a",a.a.ha));a.u.appendChild(b);a.c.appendChild(a.u);a.c.appendChild(a.P=a.createNode("div","kmw_control_keyboards","kmw_button"));a.c.appendChild(a.I=a.createNode("div","kmw_bar_osk","kmw_bar"));a.g=a.createNode("div","kmw_btn_osk","kmw_button");b=a.createNode("a",l,"kmw_button_a");b.href="#";b.onclick=a.Ca;b.title=a.a.ka;b.appendChild(a.createNode("div","kmw_img_osk","kmw_img"));a.g.appendChild(b);a.c.appendChild(a.g);a.c.appendChild(a.createNode("div","kmw_controls_end",
l," "));d=a.createNode("div");d.id="kmw_map_preload";a.c.appendChild(d);a.c.appendChild(a.createNode("br",l,"kmw_clear"));if(d=document.getElementById("KeymanWebControl"))d.style.visibility="hidden",d.style.maxHeight="35px",d.appendChild(a.c);a.D=e;a.z&&clearTimeout(a.z);a.z=setTimeout(a.F,2E3);k.attachDOMEvent(document.body,"click",a.V,m);a.h="eu";i.focusLastActiveElement()}};a.F=function(){if(a.D){a.D=m;var b=0;a.j=[];var c=i.getKeyboards();c.sort(a.Da);for(var d in a.e){a.j[d]=a.createNode("div",
l,"kmw_selector_region");for(var f=a.createNode("div",l,"kmw_keyboard_col"),g=0,h=0,n="",j=0;j<c.length;j++)c[j].RegionCode==d&&c[j].LanguageCode!=n&&(n=c[j].LanguageCode,g++);g=((g+3)/4).toFixed(0);n="";for(j=0;j<c.length;j++)if(c[j].RegionCode==d)if(c[j].LanguageCode==n){var p=a.p[n].d;p.push?p.push(c[j]):a.p[n].d=p.concat(c[j])}else{n=c[j].LanguageCode;a.p[n]={id:c[j].LanguageCode,name:c[j].LanguageName,d:[c[j]]};0==h%g&&0<h&&(a.j[d].appendChild(f),f=a.createNode("div",l,3==h/g?"kmw_keyboard_col_right":
"kmw_keyboard_col"));h++;var p=a.createNode("div",l,"kmw_language"),k=a.createNode("a",l,l,c[j].LanguageName);k.href="#";k.onclick=function(b){return function(c){return a.aa(c,b)}}(a.p[n]);p.appendChild(k);f.appendChild(p);b++}a.j[d].appendChild(f);a.j[d].appendChild(a.createNode("div",l,"kmw_clear"));a.J.appendChild(a.j[d])}a.ta();a.R(l,a.h);a.M();i.focusLastActiveElement()}};a.Da=function(a,c){return a.RegionCode<c.RegionCode?-2:a.RegionCode>c.RegionCode?2:a.LanguageName<c.LanguageName?-1:a.LanguageName>
c.LanguageName?1:0};a.A=function(b){for(var c=0;c<a.b.length;c++)if(a.b[c].lang.id==b.id)return c;return l};a.U=function(b,c){var d=a.A(b);if(d==l){if(a.b.length>=a.ua){for(var f=2147483647,d=l,g=0;g<a.b.length;g++)a.b[g].Q<f&&(d=g,f=a.b[g].Q);d!=l&&(f=a.b[d],a.t[f.lang.id]=l,a.O[f.lang.id]=l,a.P.removeChild(f.G),a.b=0==d?a.b.slice(d+1):d==a.b.length-1?a.b.slice(0,d):a.b.slice(0,d).concat(a.b.slice(d+1)))}d=a.createNode("div",l,"kmw_button");f=a.createNode("a",l,"kmw_button_a"+(1<b.d.length?" kmw_norightgap":
""));f.href="#";var g=a.a.SelectKeyboardPre+c.Name,h=a.a.SelectKeyboardSuf;0>g.toLowerCase().indexOf(h.toLowerCase())&&(g=g+" "+h);f.title=g;f.onclick=function(c){return a.aa(c,b)};f.appendChild(a.createNode("div","kmw_img_kbd","kmw_img"));a.H=a.truncate(b.name,28);f.appendChild(a.createNode("div",l,"kmw_a",a.H));d.appendChild(f);h=f;if(1<b.d.length){f=a.createNode("a",l,"kmw_button_a kmw_noleftgap");f.href="#";f.title=a.a.AltKeyboardsPre+b.name+a.a.AltKeyboardsSuf;f.onclick=function(c){return a.Aa(c,
b)};var i=a.createNode("div",l,"kmw_a"),g=a.truncate(c.Name.replace(/\s?keyboard/i,""),40-a.H.length);i.appendChild(a.O[b.id]=a.createNode("span",l,"kmw_kbd",g));f.appendChild(i);f.appendChild(a.createNode("div",l,"kmw_drop"));d.appendChild(f);a.t[b.id]=a.createNode("ul",l,"kmw_selector_kbd");a.t[b.id].style.display="none";for(var j in b.d)i=a.createNode("li"),g=b.d[j].Name.replace(/\s?keyboard/i,""),f=a.createNode("a",l,l,g),f.href="#",f.title="",f.onclick=function(b,c){return function(d){return a.C(d,
b,c)}}(b,b.d[j]),i.appendChild(f),a.t[b.id].appendChild(i);d.appendChild(a.t[b.id])}a.P.appendChild(d);a.b.push({Q:a.X++,lang:b,N:c,G:d,T:h})}else{a.b[d].Q=a.X++;a.b[d].N=c;if(j=a.O[b.id])g=c.Name.replace(/\s?keyboard/i,""),j.innerHTML=a.truncate(g,40-a.H.length);a.b[d].T&&(g=a.a.SelectKeyboardPre+c.Name,h=a.a.SelectKeyboardSuf,0>g.toLowerCase().indexOf(h.toLowerCase())&&(g=g+" "+h),a.b[d].T.title=g)}};a.truncate=function(a,c){return a.length<=c?a:a.substr(0,c-1)+"\u2026"};a.za=function(){a.D=e;a.z&&
clearTimeout(a.z);a.z=setTimeout(a.F,2E3)};i.addEventListener("keyboardregistered",a.za);a.r=function(b){var c=a.Y;c&&(c.style.display="none");a.K();return a.f(b)};a.Aa=function(b,c){a.B(b);var d=a.t[c.id];if(d){if("block"==d.style.display)return a.r(b);d.style.display="block";a.Y=d;a.S(d,a.r)}return a.f(b)};a.aa=function(b,c){var d=a.A(c),f=l,f=d==l?c.d[0]:a.b[d].N;return!f?m:a.C(b,c,f)};a.C=function(b,c,d){if(a.v){var f=a.A(a.v);f!=l&&(a.b[f].G.className="kmw_button")}a.u.className="kmw_button";
a.v=c;a.q=d;a.ja=c.id;a.w();a.U(c,d);i.setActiveKeyboard(d.InternalName,c.id);a.b[a.A(c)].G.className="kmw_button_selected";a.$();a.M();return a.B(b)||a.r(b)};a.M=function(){var b=[a.u,a.Z,a.g,a.I],c=m;i.isCJK(a.q)?c=e:a.q==l&&(c="none"==b[2].style.display);if(a.q!=l||0<a.b.length)for(var d=0;d<b.length;d++)b[d].style.display="";else for(d=0;d<b.length;d++)b[d].style.display="none";c?a.g.style.display=a.I.style.display="none":a.q==l&&(a.g.className="kmw_button_disabled");a.c.parentNode.style.visibility=
"visible"};a.w=function(){i.focusLastActiveElement()};a.Ca=function(b){o&&""!=i.getActiveKeyboard()&&(o.isEnabled()?o.hide():o.show(e));a.w();return a.f(b)};a.va=function(b){if("kmw_controls_disabled"!=a.c.className){a.r(l);if(a.v){var c=a.A(a.v);c!=l&&(a.b[c].G.className="kmw_button")}a.q=l;a.v=l;a.ja="";a.u.className="kmw_button_selected"}a.w();i.setActiveKeyboard("","");a.$();a.M();return a.f(b)};a.f=function(a){a||(a=window.event);window.event&&(window.event.returnValue=m);a&&(a.cancelBubble=
e);return m};a.R=function(b,c){var d=a.n;if(!d)return a.f(b);d.className="kmw_browsemap_"+c;"undefined"==typeof a.j[c]&&(a.D=e,a.F());a.j[c].style.display="block";a.i[c].className="selected";a.h!=l&&a.h!=c&&(a.j[a.h].style.display="none",a.i[a.h].className="");a.h=c;return a.f(b)};a.ba=function(b,c){a.n.className=a.h==l?"":"kmw_browsemap_"+a.h;a.i[c].className=a.h==c?"selected":"";return a.f(b)};a.W=function(b,c){a.n.className="kmw_browsemap_"+c+"_sel";a.i[c].className="hover";return a.f(b)};a.ya=
function(a){return a.getAttribute?a.getAttribute("kmw_disable")||a.kmw_disable:a.kmw_disable};a.oa=function(b){if(!a.s)return e;b=b.target;if("textarea"==b.tagName.toLowerCase()||"input"==b.tagName.toLowerCase()&&"text"==b.type.toLowerCase())if(a.ra=b,a.ya(b))"kmw_controls_disabled"!=a.c.className&&(a.c.className="kmw_controls_disabled");else{a.q!=l&&(i.isCJK()?a.g.style.display=a.I.style.display="none":a.g.className=o&&o.isEnabled()?"kmw_button_selected":"kmw_button");""!=a.c.className&&(a.c.className=
"");var c,d;c=b.da?b.da:64;d=b.ea?b.ea:0;a.pa=k.getAbsoluteX(b)+c;a.qa=k.getAbsoluteY(b)+b.offsetHeight+d}return e};i.addEventListener("controlfocused",a.oa);a.la=function(){if(!a.s)return e;"none"!=a.g.style.display&&(a.g.className="kmw_button_disabled");return e};i.addEventListener("controlblurred",a.la);a.ma=function(b){if(b.indirect){var c=b.internalName,b=b.languageCode;if(""!=b&&""!=c&&(b=a.p[b],b!=l))for(var d=0;d<b.d.length;d++)b.d[d].InternalName==c&&(a.C(l,b,b.d[d]),window.focus(),a.w())}return e};
i.addEventListener("keyboardchange",a.ma);a.xa=function(b){a.s&&(a.g.className="kmw_button_selected");return b};o.addEventListener("show",a.xa);a.wa=function(b){a.s&&b.HiddenByUser&&(a.g.className="kmw_button")};o.addEventListener("hide",a.wa);a.Ba=function(b){a.F();if("kmw_controls_disabled"==a.c.className)return a.f(b);a.r(l);if("kmw_over"==a.m.className)return a.B(b);a.m.className="kmw_over";a.o.className="kmw_button_selected";a.S(a.m,a.B);return a.f(b)};a.B=function(b){a.m.className="";a.o.className=
"kmw_button";a.K();return a.f(b)};a.V=function(b){var c=a.Y;if((!c||"none"==c.style.display)&&""==a.m.className)return e;a.B(b);a.r(b);return a.f(b)};var q=l,r=l,s=l;a.L=function(b){var c=b&&b.target||window.event&&window.event.srcElement;if(c)for(;c.parentNode;){if(c==r)return l;c=c.parentNode}"#document"==c.nodeName&&a.V(b);return q};a.S=function(b,c){a.L==document.onclick&&a.K();q=c;r=b;s=document.onclick;document.onclick=a.L};a.K=function(){a.L==document.onclick&&(document.onclick=s,r=q=s=l)};
a.ta=function(){var b="",c=k.loadCookie("KeymanWeb_Keyboard");void 0!=c.current&&(b=c.current.split(":")[0]);c=k.loadCookie("KeymanWeb_Toolbar");void 0!=c.region&&(a.h=c.region);if(void 0!=c.maxrecent)for(var d=0;d<c.maxrecent;d++){if(void 0!=c["recent"+d]){var f=c["recent"+d].split(",");if(2==f.length){var g=a.p[f[0]];if(g!=l)for(var h=0;h<g.d.length;h++)if(g.d[h].InternalName==f[1]){a.U(g,g.d[h]);if(g.d[h].InternalName==b){a.C(l,g,g.d[h]);window.focus();a.w();break}break}}}}else if(b=i.getActiveKeyboard(),
h=i.getActiveLanguage(),""!=h&&""!=b&&(c=a.p[h],c!=l))for(h=0;h<c.d.length;h++)c.d[h].InternalName==b&&(a.C(l,c,c.d[h]),window.focus(),a.w())};a.$=function(){var b={};b.region=a.h;b.maxrecent=""+a.b.length;for(var c=0;c<a.b.length;c++)b["recent"+c]=a.b[c].lang.id+","+a.b[c].N.InternalName;k.saveCookie("KeymanWeb_Toolbar",b)}}})();
