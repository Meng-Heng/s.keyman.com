{"version":3,"file":"kmwuitoggle.js","lineCount":21,"mappings":"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","sources":["kmwuitoggle.ts"],"sourcesContent":["/// \u003creference path=\"kmwexthtml.ts\" /\u003e  // Includes KMW-added property declaration extensions for HTML elements.\r\n\r\n/***\r\n   KeymanWeb 11.0\r\n   Copyright 2019 SIL International\r\n***/\r\n\r\n// If a UI module has been loaded, we can rely on the publically-published \u0027name\u0027 property\r\n// having been set as a way to short-out a UI reload.  Its parent object always exists by\r\n// this point in the build process.\r\nif(!window[\u0027keyman\u0027][\u0027ui\u0027][\u0027name\u0027]) { \r\n  /********************************/\r\n  /*                              */\r\n  /* Toggle User Interface Code   */\r\n  /*                              */\r\n  /********************************/\r\n      \r\n  /**\r\n   * Do not enclose in an anonymous function, as the compiler may create\r\n   * global scope variables to replace true, false, null, which may collide\r\n   * with other variables.\r\n   * Instead, use the --output-wrapper command during optimization, which will\r\n   * add the anonymous function to enclose all code, including those optimized\r\n   * variables which would otherwise have global scope.\r\n   **/  \r\n\r\n  try {\r\n\r\n    // Declare KeymanWeb, OnScreen Keyboard and Util objects\r\n    var keymanweb=window[\u0027keyman\u0027],osk=keymanweb[\u0027osk\u0027],util=keymanweb[\u0027util\u0027];\r\n    var dbg=keymanweb[\u0027debug\u0027];\r\n    \r\n    // Disable UI for touch devices\r\n    if(util[\u0027isTouchDevice\u0027]()) throw \u0027\u0027;\r\n\r\n    // Initialize user interface common variables       \r\n    var ui:any=keymanweb[\u0027ui\u0027] = {\r\n      name: \u0027toggle\u0027,\r\n      initialized: false,\r\n      controller: null,\r\n      oskButton: null,\r\n      kbdButton: null,\r\n      controllerHovered: false,\r\n      keyboards: [],\r\n      lastActiveKeyboard: -1,\r\n      selectedMenuItem: null,\r\n      updateList: true,\r\n      updateTimer: null    \r\n    }\r\n    \r\n    /**\r\n     * Update the KeymanWeb user interface when an input element is focused or blurred\r\n     * \r\n     * @param       {Object}            someElement     focused element\r\n     * @param       {(boolean|number)}  focusing        true if focusing\r\n     * @param       {Object}            activeControl   Object representing API specs for the control, if it exists and is now focused.\r\n     */    \r\n    ui.doFocus = function(someElement,focusing, activeControl) {\r\n      // This callback must be ignored until UI is initialized, or for touch devices (which can never initialize the UI)\r\n      if(!ui.initialized) {\r\n        return;\r\n      }\r\n      \r\n      // We don\u0027t want to shift the controller to something that\u0027s not an input element,\r\n      // but do want to account for window.event\u0027s data when legitimate.\r\n      if(window.event \u0026\u0026 keymanweb[\u0027isAttached\u0027](window.event.srcElement)) {\r\n        someElement=window.event.srcElement;\r\n      }\r\n\r\n      if(focusing)\r\n      {\r\n        ui.controller.style.display = \u0027block\u0027;\r\n      } \r\n      else \r\n      {\r\n        if(!(keymanweb[\u0027getUIState\u0027]()[\u0027activationPending\u0027]) \u0026\u0026 !ui.controllerHovered)\r\n        {\r\n          ui.controller.style.display = \u0027none\u0027;   \r\n        }\r\n      }\r\n      \r\n    /* I2406 - Find an appropriate position for the controller */  \r\n      var x, y, w, h, p;\r\n    \r\n      p = util[\u0027getAbsolute\u0027](someElement); x = p[\u0027x\u0027]; y=p[\u0027y\u0027];\r\n\r\n      if(someElement.defaultView \u0026\u0026 someElement.defaultView.frameElement)\r\n      { \r\n        w = someElement.defaultView.frameElement.clientWidth;\r\n        h = someElement.defaultView.frameElement.clientHeight;\r\n      }\r\n      else\r\n      {\r\n        w = someElement.offsetWidth;\r\n        h = someElement.offsetHeight;\r\n      }\r\n      if(x + w \u003e window.innerWidth + document.documentElement.scrollLeft - ui.controller.offsetWidth - 1)\r\n        y += h;\r\n      else\r\n      {\r\n        x += w + 2;  \r\n        //y += h - ui.controller.offsetHeight - 1; // ui.controller.offsetheight is returned as its prior value, which results in incorrect UI positioning\r\n        // so better to set the offset absolutely JMD 11/2/11\r\n        y += h - 29; //prevent UI being positioned *above* the top of the element \r\n      }\r\n        \r\n      if(isNaN(x) || isNaN(y)) return;\r\n      ui.controller.style.left = x + \u0027px\u0027;\r\n      ui.controller.style.top = y + \u0027px\u0027;    \r\n    }\r\n\r\n    keymanweb[\u0027addEventListener\u0027](\u0027controlfocused\u0027,function(params){ui.doFocus(params.target,true, params[\u0027activeControl\u0027]);});\r\n    keymanweb[\u0027addEventListener\u0027](\u0027controlblurred\u0027,function(params){ui.doFocus(params.target,false, null);});\r\n\r\n    osk[\u0027addEventListener\u0027](\u0027show\u0027,\r\n      function(oskPosition)\r\n      {\r\n        // Ensure that the ui.controller is visible if help is displayed\r\n        ui.controller.style.display = \u0027block\u0027;\r\n        ui.oskButton._setSelected(true);\r\n      \r\n  /* The following is probably not needed for KMW2, since OSK position is set by KMW, not by the UI        \r\n        //TODO:  This may not be correct - may need to refer to userLocated argument, not function???\r\n        // Check if OSK position is user-defined, return if so\r\n        if (osk[\u0027userLocated\u0027]()) return oskPosition;\r\n      \r\n        // Otherwise, return the position with respect to the focussed element\r\n        var someElement = keymanweb[\u0027getLastActiveElement\u0027](), x, y, w, h, p;\r\n        if(someElement != null)\r\n        {\r\n          p = util[\u0027getAbsolute\u0027](someElement); x = p[\u0027x\u0027]; y = p[\u0027y\u0027];\r\n          if(someElement.parentWindow \u0026\u0026 someElement.parentWindow.frameElement)\r\n          {\r\n            w = someElement.parentWindow.frameElement.clientWidth;\r\n            h = someElement.parentWindow.frameElement.clientHeight;\r\n          }\r\n          else if(someElement.defaultView \u0026\u0026 someElement.defaultView.frameElement)\r\n          { \r\n            w = someElement.defaultView.frameElement.clientWidth;\r\n            h = someElement.defaultView.frameElement.clientHeight;\r\n          }\r\n          else\r\n          {\r\n            w = someElement.offsetWidth;\r\n            h = someElement.offsetHeight;\r\n          }\r\n    //TODO:  check the logic of this - it doesn\u0027t look right!!!  Signs on top, height??\r\n          var r = osk[\u0027getRect\u0027]();\r\n          x += 32;\r\n          if(y + h + (r.height - r.top) \u003e (window.clientHeight?window.clientHeight:window.innerHeight) + document.documentElement.scrollTop \u0026\u0026 \r\n            y - (r.height - r.top) \u003e= document.documentElement.scrollTop)\r\n          {\r\n            y -= (r.height - r.top);\r\n          }\r\n          else\r\n            y += h;\r\n        }\r\n        else\r\n        {\r\n          x = ui.controller.offsetLeft;\r\n          y = ui.controller.offsetTop + ui.controller.offsetHeight;\r\n        }\r\n        oskPosition[\u0027x\u0027] = x; \r\n        oskPosition[\u0027y\u0027] = y; \r\n  */      \r\n        return oskPosition;\r\n      });\r\n    \r\n    osk[\u0027addEventListener\u0027](\u0027hide\u0027,\r\n      function(byUser)\r\n      {\r\n        if(byUser[\u0027HiddenByUser\u0027]) ui.oskButton._setSelected(false);\r\n      });\r\n    \r\n    /**\r\n     * Toggle the on screen keyboard display - KMW button control event \r\n     **/\r\n    ui.switchOsk = function()\r\n    {\r\n      // Check that user control of OSK is allowed\r\n      if((keymanweb[\u0027getActiveKeyboard\u0027]() == \u0027\u0027) || keymanweb[\u0027isCJK\u0027]() ) return;  \r\n      \r\n      osk[\u0027show\u0027](!osk[\u0027isEnabled\u0027]());  \r\n    }\r\n    \r\n    /**\r\n     * Toggle a single keyboard on or off - KMW button control event \r\n     **/\r\n    ui.switchSingleKbd = function()\r\n    {\r\n      var _v = (keymanweb[\u0027getActiveKeyboard\u0027]() == \u0027\u0027),nLastKbd=0,kbdName=\u0027\u0027,lgCode=\u0027\u0027;\r\n      if(_v)\r\n      {\r\n        if(ui.keyboards.length == 0) return;\r\n        if(ui.lastActiveKeyboard \u003c ui.keyboards.length \u0026\u0026 ui.lastActiveKeyboard \u003e= 0) nLastKbd = ui.lastActiveKeyboard;\r\n        kbdName = ui.keyboards[nLastKbd]._InternalName;\r\n        lgCode = ui.keyboards[nLastKbd]._LanguageCode;\r\n        keymanweb[\u0027setActiveKeyboard\u0027](kbdName,lgCode);\r\n        ui.lastActiveKeyboard = nLastKbd;\r\n      }\r\n      else\r\n      {\r\n        keymanweb[\u0027setActiveKeyboard\u0027](\u0027\u0027);\r\n      }\r\n      if(ui.kbdButton) ui.kbdButton._setSelected(_v);\r\n    }\r\n    \r\n    /**\r\n     * Switch to the next keyboard in the list - KMW button control event \r\n     **/\r\n    ui.switchNextKbd = function()\r\n    {\r\n      var _v = (keymanweb[\u0027getActiveKeyboard\u0027]() == \u0027\u0027),kbdName=\u0027\u0027,lgCode=\u0027\u0027;\r\n      if(_v)\r\n      {\r\n        if(ui.keyboards.length == 0) return;\r\n        kbdName = ui.keyboards[0]._InternalName;\r\n        lgCode = ui.keyboards[0]._LanguageCode;\r\n        keymanweb[\u0027setActiveKeyboard\u0027](kbdName,lgCode);\r\n        ui.lastActiveKeyboard = 0;\r\n      }\r\n      else\r\n      {\r\n        if(ui.lastActiveKeyboard == ui.keyboards.length-1)\r\n        {\r\n          keymanweb[\u0027setActiveKeyboard\u0027](\u0027\u0027);\r\n          _v = false;\r\n        }\r\n        else\r\n        {\r\n          kbdName = ui.keyboards[++ui.lastActiveKeyboard]._InternalName;\r\n          lgCode = ui.keyboards[ui.lastActiveKeyboard]._LanguageCode; \r\n          keymanweb[\u0027setActiveKeyboard\u0027](kbdName,lgCode);\r\n          _v = true;\r\n        }\r\n      }\r\n      if(ui.kbdButton) ui.kbdButton._setSelected(_v);\r\n    }\r\n    \r\n    /**\r\n     * Create a button object for KeymanWeb UI buttons\r\n     * \r\n     * @constructor   \r\n     * @param       {string}    _src\r\n     * @param       {string}    _caption\r\n     * @param       {boolean}   _selected\r\n     * @return      {Object}    \r\n     * \r\n     * @suppress {suspiciousCode}  // Closure isn\u0027t smart enough to realize that _onmouseover\r\n     *                             // and the like are defined on individual instances later.\r\n     *                             // It thinks they\u0027re always null.        \r\n     **/\r\n    ui.button = function(_src, _caption, _selected)\r\n    {\r\n      this._onclick = null;\r\n      this._onmouseover = null;\r\n      this._onmouseout = null;\r\n      this._elem = null;\r\n      this._down = false;\r\n      this._over = false;\r\n      this._selected = _selected;\r\n    \r\n      /*public*/ this.getElem = function()\r\n      {\r\n        return this._owningObject._elem;\r\n      };\r\n      \r\n      /*private*/ this.__updatestyle = function()\r\n      {\r\n        var ss=this._owningObject._elem.style;\r\n        if(this._owningObject._over)\r\n        {\r\n          ss.margin = \u00270px\u0027;\r\n          if(this._owningObject._selected) {\r\n            ss.border = \u0027solid 1px #ad4a28\u0027;\r\n            ss.background = \u0027#dfb4b4\u0027;\r\n          }\r\n          else {\r\n            ss.border = \u0027solid 1px #dfb4b4\u0027;\r\n            ss.background = \u0027#f3e5de\u0027;\r\n          }\r\n        }\r\n        else if(this._owningObject._selected)\r\n        {\r\n          ss.background = \u0027#f3e5de\u0027;\r\n          ss.margin = \u00270px\u0027;\r\n          ss.border = \u0027solid 1px #ad4a28\u0027;\r\n        }\r\n        else\r\n        {\r\n          ss.background = \u0027none\u0027;\r\n          ss.margin = \u00271px\u0027;\r\n          ss.border = \u0027none\u0027;\r\n        }\r\n      };\r\n      \r\n      /*private*/ this.__mouseover = function()\r\n      {\r\n        ui.controllerHovered = true;\r\n        this._owningObject._over = true;\r\n        if(this._owningObject._onmouseover != null) this._owningObject._onmouseover();\r\n        this._owningObject.__updatestyle();\r\n      };\r\n      \r\n      /*private*/ this.__mouseout = function()\r\n      { \r\n        ui.controllerHovered = false;\r\n        this._owningObject._over = false;\r\n        if(this._owningObject._onmouseout != null) this._owningObject._onmouseout();\r\n        this._owningObject.__updatestyle();\r\n      };\r\n      \r\n      /*private*/ this.__click = function()\r\n      { \r\n        keymanweb[\u0027activatingUI\u0027](false); // Clear activating UI flag once click is acknowledged\r\n        if(this._owningObject._onclick != null) \r\n            return this._owningObject._onclick();\r\n        return false;\r\n      };\r\n    \r\n      /*private*/ this.__mousedown = function()\r\n      {\r\n        keymanweb[\u0027activatingUI\u0027](true);  // Set activating UI flag (to manage focus/blur) on any UI mouse down event\r\n        this._owningObject._down = true;\r\n        this._owningObject.__updatestyle();\r\n        return false;\r\n      };\r\n      \r\n      /*private*/ this.__mouseup = function()\r\n      {\r\n        this._owningObject._down = false;\r\n        this._owningObject.__updatestyle();\r\n      };\r\n      \r\n      /*public*/ this._setSelected = function(_value)\r\n      {\r\n        keymanweb[\u0027activatingUI\u0027](false); // Always clear activating UI flag after selecting UI\r\n        this._owningObject._selected = _value;\r\n        this._owningObject.__updatestyle();\r\n      };\r\n      \r\n      /*public*/ this._getSelected = function()\r\n      {\r\n        return this._owningObject._selected;\r\n      };\r\n    \r\n      /*public*/ this._getOver = function()\r\n      {\r\n        return this._owningObject._over;\r\n      };\r\n      \r\n      /*public*/ this._getDown = function()\r\n      {\r\n        return this._owningObject._down;\r\n      };\r\n    \r\n      this._owningObject = this; // simplifies meaning of \u0027this\u0027\r\n      \r\n      var imgPath=util[\u0027getOption\u0027](\u0027resources\u0027) + \u0027ui/toggle/\u0027;\r\n      var _elemImg = util[\u0027createElement\u0027](\u0027img\u0027);\r\n      this._elem = util[\u0027createElement\u0027](\u0027div\u0027);\r\n      this._elem._owningObject = this;\r\n      _elemImg.style.display = \u0027block\u0027;\r\n      _elemImg.src = imgPath + _src;\r\n      _elemImg.id = \u0027KMW_Controller_Img\u0027;\r\n      this._elem.style.margin = \u00270px\u0027; //display = \u0027inline\u0027;\r\n      this._elem.style.width = \u002724px\u0027;\r\n      this._elem.style.height = \u002724px\u0027;\r\n      this._elem.style.zIndex = \u002710002\u0027;\r\n      this._elem.style.lineHeight = \u0027100%\u0027;\r\n      this._elem.style.styleFloat = this._elem.style.cssFloat = \u0027left\u0027;\r\n    \r\n      _elemImg.title = _caption;\r\n      _elemImg.alt = _caption;\r\n      this._elem.appendChild(_elemImg);\r\n      this._elem.onmouseover = this.__mouseover;\r\n      this._elem.onmouseout = this.__mouseout;\r\n      this._elem.onmousedown = this.__mousedown;\r\n      this._elem.onmouseup = this.__mouseup;\r\n      _elemImg._owningObject = this;\r\n      _elemImg.onclick = this.__click;\r\n      \r\n      this.__updatestyle();\r\n      \r\n      return this;\r\n    };\r\n    \r\n    /**\r\n     * Function     Initialize\r\n     * Scope        Private   \r\n     * Description  Initialize Toggle User Interface\r\n     **/   \r\n    ui[\u0027initialize\u0027] = ui.Initialize = function()\r\n    { \r\n      //Never initialize before KMW!\r\n      if(!keymanweb[\u0027initialized\u0027] || util[\u0027isTouchDevice\u0027]()) return;\r\n        \r\n      if(!ui.initialized)  // I2403 - Allow toggle design to be loaded twice\r\n      {\r\n        ui.controller = util[\u0027createElement\u0027](\u0027div\u0027);\r\n      }\r\n      else\r\n        ui.controller.innerHTML = \u0027\u0027;  // I2403 - Allow toggle design to be loaded twice\r\n      \r\n      var imgPath = util[\u0027getOption\u0027](\u0027resources\u0027)+\u0027ui/toggle/\u0027;\t\r\n      ui.controller.style.background = \u0027url(\u0027+imgPath+\u0027kmwcontroller2x.gif)\u0027;    \r\n      ui.controller.style.padding = \u00271px 2px\u0027;\r\n\r\n      // Create keyboard list and OSK control buttones, and set initial styles\r\n      var v1=util[\u0027loadCookie\u0027](\u0027KeymanWeb_Keyboard\u0027),kbdEnabledOnLoad=false;\r\n      if(typeof(v1[\u0027current\u0027])!=\u0027undefined\u0027) kbdEnabledOnLoad = (v1[\u0027current\u0027].indexOf(\u0027---\u0027) \u003c 0);\r\n      ui.kbdButton = new ui.button(\u0027kmw_logo_16.gif\u0027, \u0027Use Web Keyboard\u0027, kbdEnabledOnLoad); \r\n      ui.controller.appendChild(ui.kbdButton.getElem());\r\n    \r\n      var v2 = util[\u0027loadCookie\u0027](\u0027KeymanWeb_OnScreenKeyboard\u0027),oskEnabledOnLoad=true; \r\n      if(typeof(v2[\u0027visible\u0027])!=\u0027undefined\u0027) oskEnabledOnLoad=(v2[\u0027visible\u0027] == 1); \r\n    \r\n      // Add keyboard icon\r\n      ui.oskButton = new ui.button(\u0027kmw_osk_16.gif\u0027,\u0027Show On Screen Keyboard\u0027,oskEnabledOnLoad); \r\n      ui.oskButton._onclick = ui.switchOsk;\r\n      ui.controller.appendChild(ui.oskButton.getElem());\r\n\r\n      // Hide controller unless already initialized\r\n      if(!ui.initialized) ui.controller.style.display = \u0027none\u0027;\r\n      ui.controller.style.zIndex = \u002710001\u0027;\r\n      ui.controller.style.position = \u0027absolute\u0027;\r\n      \r\n      // The following three lines prevent the UI from being positioned incorrectly when the page is resized,\r\n      // but don\u0027t fix the problem completely, as the kbd icon still moves.  probably need to insert a DIV\r\n      // between the button and the container, and make that DIV fixed height and overflow:hidden \r\n      //ui.controller.style.maxHeight = \u002726px\u0027;  \r\n      //ui.oskButton.getElem().style.position = \u0027relative\u0027;  \r\n      //ui.oskButton.getElem().style.overflow = \u0027hidden\u0027;\t\r\n      \r\n      if(!ui.initialized)  // I2403 - Allow toggle design to be loaded more than once if necessary\r\n        document.body.appendChild(ui.controller);\t   \r\n    \r\n      // Set initialized true  \r\n      ui.initialized = true;  // I2403 - Allow toggle design to be loaded more than once if needed\r\n\r\n      // Then update the keyboard list if keyboards already loaded (i.e. in page script)\r\n      ui.updateKeyboardList();     \r\n      \r\n    }\r\n\r\n    ui.shutdown = function() {\r\n      var root = ui.controller;\r\n\r\n      if(root) {\r\n        root.parentNode.removeChild(root);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Function     updateKeyboardList\r\n     * Scope        Private   \r\n     * Description  Rebuild the UI and keyboard list\r\n     **/   \r\n    ui.updateKeyboardList=function()\r\n    {                 \r\n      if(!(keymanweb[\u0027initialized\u0027] || ui.initialized)) return; //TODO: may want to restart the timer??\r\n                      \r\n      ui.updateList = false;\r\n\r\n      var _kbds=keymanweb[\u0027getKeyboards\u0027](),imgPath=util[\u0027getOption\u0027](\u0027resources\u0027) +\u0027ui/toggle/\u0027;\t   \r\n  \r\n      // Check the number of installed keyboards to determine whether or not we will have a dropdown\r\n      if(_kbds.length \u003e 1)\r\n      {\r\n        // Multiple keyboards\r\n        var _kmw_ctrl_img=\u003cHTMLImageElement\u003e document.getElementById(\u0027KMW_Controller_Img\u0027)\r\n        _kmw_ctrl_img.src = imgPath+\u0027kmw_logo_16_down.gif\u0027;\r\n        _kmw_ctrl_img.style.width = \u0027100%\u0027;\r\n            \r\n        ui.controller.style.background = \u0027url(\u0027+imgPath+\u0027kmwcontroller2x.gif)\u0027;\r\n        \r\n        ui.kbdButton.getElem().id = \u0027kmwico\u0027;\r\n        ui.kbdButton.getElem().style.width = \u002736px\u0027;\r\n        ui.kbdButton._onmouseover = function()\r\n          {\r\n            ui.keyboardMenu.className=\"sfhover\";\r\n          };\r\n        ui.kbdButton._onmouseout = function()\r\n          {\r\n            ui.keyboardMenu.className=\"sfunhover\";\r\n          };\r\n        ui.kbdButton._onclick = null;\r\n        ui.createMenu();\r\n      }\r\n      // Single keyboard\r\n      else if(_kbds.length == 1)\r\n      {\r\n        var _kmw_ctrl_img=\u003cHTMLImageElement\u003e document.getElementById(\u0027KMW_Controller_Img\u0027)\r\n        _kmw_ctrl_img.src = imgPath+\u0027kmw_logo_16.gif\u0027;\r\n        \r\n        ui.kbdButton.getElem().id = \u0027kmwico\u0027;\r\n        ui.kbdButton.getElem().style.width = \u002724px\u0027;\r\n\r\n        var Lki=_kbds[0][\u0027InternalName\u0027];    \r\n        var Lklc=_kbds[0][\u0027LanguageCode\u0027];  \r\n        ui.controller.style.background = \u0027url(\u0027+imgPath+\u0027kmwcontroller2.gif)\u0027;\r\n        ui.keyboards.push({_InternalName: Lki, _LanguageCode: Lklc, _Index: 0});\r\n        ui.kbdButton._onclick = ui.switchSingleKbd;\r\n        ui.kbdButton._onmouseover = function() { };\r\n        ui.kbdButton._onmouseout = function() { };\r\n\r\n        // We must reconstruct the ui.keyboards array, and this done by ui.createMenu.\r\n        ui.createMenu();\r\n\r\n        // Must remove menu if keyboards have been removed leaving only a single keyboard\r\n        if(typeof(ui.keyboardMenu) != \u0027undefined\u0027) delete ui.keyboardMenu;\r\n      }\r\n      \r\n      // Highlight the last active keyboard\r\n      var sk=keymanweb[\u0027getSavedKeyboard\u0027]().split(\u0027:\u0027);\r\n      ui.updateMenu(sk[0],sk[1]);\r\n    }  \r\n\r\n    /**\r\n     * Keyboard registration event handler\r\n     *    \r\n     * Set a timer to update the UI keyboard list on timeout after each keyboard is registered, \r\n     * thus updating only once when only if multiple keyboards are registered together\r\n     */   \r\n    keymanweb[\u0027addEventListener\u0027](\u0027keyboardregistered\u0027, \r\n      function(p)\r\n      {   \r\n          ui.updateList = true;\r\n          if(ui.updateTimer) clearTimeout(ui.updateTimer);\r\n          ui.updateTimer = setTimeout(ui.updateKeyboardList,200);\r\n      });       \r\n\r\n\r\n    /**\r\n     * Keyboard change event handler\r\n     *        \r\n     * Update menu selection and control OSK display appropriately\r\n     */\r\n    keymanweb[\u0027addEventListener\u0027](\u0027keyboardchange\u0027,  \r\n      function(p)\r\n      {\r\n        ui.updateMenu(p[\u0027internalName\u0027],p[\u0027languageCode\u0027]);  \r\n      });\r\n    \r\n    /* ----------------------------------------\r\n      Drop down menu\r\n      ---------------------------------------- */\r\n    \r\n  //  var  _SelectedMenuItem;\r\n    \r\n    /**\r\n     * Function     selecKbd\r\n     * Scope        Private \r\n     * @param       {number}  _kbd         \r\n     * Description  Select a keyboard from the drop down menu \r\n     **/\r\n    ui.selectKbd = function(_kbd)\r\n    {\r\n        var _name,_lgCode,_index;\r\n        if(_kbd \u003c 0) \r\n        { \r\n          _name = \u0027\u0027; _lgCode=\u0027\u0027;_index = \u0027\u0027; \r\n        }\r\n        else \r\n        { \r\n          _name = ui.keyboards[_kbd]._InternalName; _lgCode = ui.keyboards[_kbd]._LanguageCode; _index = ui.keyboards[_kbd]._Index; \r\n        }\r\n        keymanweb[\u0027setActiveKeyboard\u0027](_name,_lgCode);\r\n        keymanweb[\u0027focusLastActiveElement\u0027]();\r\n        ui.kbdButton._setSelected(_name != \u0027\u0027);\r\n        if(_kbd \u003e= 0) ui.lastActiveKeyboard = _kbd;\r\n\r\n        return false;\r\n    };\r\n    \r\n    /**\r\n     * Function     updateMenu\r\n     * Scope        Private\r\n     * @param       {string}    kbdName\r\n     * @param       {?string=}  lgCode\r\n     * Description  Updates the menu selection when a change is required\r\n     **/    \r\n    ui.updateMenu = function(kbdName,lgCode)\r\n    {        \r\n      var i,_k=document.getElementById(\u0027KMWSel_$\u0027);\r\n\r\n      for(i=0; i\u003cui.keyboards.length; i++)\r\n      { \r\n        if(ui.keyboards[i]._InternalName == kbdName \u0026\u0026 ui.keyboards[i]._LanguageCode == lgCode)\r\n          _k=document.getElementById(\u0027KMWSel_\u0027+ui.keyboards[i]._InternalName+\u0027$\u0027+ui.keyboards[i]._Index);\r\n      }\r\n    \r\n      if(_k)\r\n      {\r\n        if(ui.selectedMenuItem != null) ui.selectedMenuItem.className=\u0027\u0027;\r\n        _k.className=\u0027selected\u0027; ui.selectedMenuItem=_k;\r\n      }\r\n\r\n      // Occurs for desktop form-factors when no keyboard (aka the sys default) is active.\r\n      if(!ui.oskButton) {\r\n        return;\r\n      }\r\n\r\n      // Hide the OSK button for CJK keyboards (or non-mapped)\r\n      if(lgCode==\u0027cmn\u0027 || lgCode==\u0027jpn\u0027 || lgCode==\u0027kor\u0027)\r\n      {\r\n        ui.oskButton.getElem().style.display=\u0027none\u0027;\r\n        //osk[\u0027show\u0027](true);\r\n      }\r\n      else if(kbdName == \u0027\u0027)\r\n      {\r\n        ui.oskButton.getElem().style.display=\u0027none\u0027;\r\n      }\r\n      else\r\n      {\r\n        ui.oskButton.getElem().style.display=\u0027block\u0027;\r\n        //osk[\u0027show\u0027](osk[\u0027isEnabled\u0027]());\r\n      }\r\n    }\r\n    util[\u0027addStyleSheet\u0027](\r\n      \"#KeymanWeb_KbdList {\"+\r\n        \"display: block;\"+\r\n        \"position: absolute;\"+\r\n        \"width: auto;\"+ ((util[\u0027getIEVersion\u0027]() \u003c 8) ? \"200px;\" : \"auto;\")+\r\n        \"line-height: 100%;\"+\r\n        \"margin: 0;\"+\r\n        \"clear: both;\"+\r\n        \"float: none;\"+\r\n        \"top: auto;\"+\r\n        \"border: solid 2px #ad4a28;\"+\r\n        \"-moz-border-radius: 4px;\"+\r\n        \"-webkit-border-radius: 4px;\"+\r\n        \"border-radius: 4px;\"+\r\n        \"box-shadow: 4px 4px 2px rgba(136,136,136,.5);\"+\r\n        \"-webkit-box-shadow: 4px 4px 2px rgba(136,136,136,.5);\"+\r\n        \"-moz-box-shadow: 4px 4px 2px rgba(136,136,136,.5);\"+\r\n        ((util[\u0027getIEVersion\u0027]() \u003c 99) ? \"filter:progid:DXImageTransform.Microsoft.DropShadow(OffX=4,OffY=4,Color=#80646464);\" : \"\")+\r\n        \"list-style: none;\"+\r\n        \"padding: 0;\"+\r\n        \"background: white;\"+\r\n        \"max-height: 300px;\"+\r\n        \"overflow-y: scroll;\"+ \r\n        \"overflow-x: hidden;\"+\r\n        \"white-space: nowrap;\"+\r\n        \"z-index: 10001; /* above the osk */\"+\r\n      \"}\"+\r\n      ((util[\u0027getIEVersion\u0027]() \u003c 7) ? \r\n        \"* html #KeymanWeb_KbdList {height: expression(this.scrollHeight \u003e 299 ? \u0027300px\u0027 : \u0027auto\u0027);}\" : \"\")+    \r\n      \".sfunhover#KeymanWeb_KbdList {\"+\r\n        \"display: none; left: -999px;\"+\r\n      \"}\"+\r\n      \".sfhover#KeymanWeb_KbdList {\"+\r\n        \"display: block;\"+\r\n        \"left: auto;\"+\r\n      \"}\"+\r\n      \"#KeymanWeb_KbdList li {\"+\r\n        \"float: none;\"+\r\n        \"width: auto;\"+\r\n        \"padding: 0;\"+\r\n        \"margin: 0;\"+\r\n      \"text-align: left;\"+\r\n      \"}\"+\r\n      \"#KeymanWeb_KbdList li a {\"+\r\n        \"display: block; \"+\r\n        \"padding: 2px 4px;\"+\r\n        \"color: #404040;\"+\r\n        \"font-family: Tahoma,Verdana,Arial,sans-serif;\"+\r\n        \"font-size: 8pt;\"+\r\n        \"text-decoration: none;\"+\r\n      \"}\"+\r\n      \"#KeymanWeb_KbdList li a.selected {\"+\r\n        \"font-weight: bold;\"+\r\n        \"color: black;\"+\r\n      \"}\"+\r\n      \"#KeymanWeb_KbdList li a:hover {\"+\r\n        \"color: white;\"+\r\n        \"background-color: #ad4a28;\"+\r\n        \"text-decoration: underline;\"+\r\n      \"}\");\r\n    \r\n    /**\r\n     * Function     createMenu\r\n     * Scope        Private   \r\n     * Description  Create the drop down menu and populate with loaded KeymanWeb keyboards \r\n     **/\r\n    ui.createMenu = function()\r\n    {    \r\n      if(typeof(ui.keyboardMenu) == \u0027undefined\u0027)  // I2403 - Allow toggle design to be loaded twice\r\n      {\r\n        ui.keyboardMenu=util[\u0027createElement\u0027](\u0027ul\u0027);\r\n        ui.keyboardMenu.id=\u0027KeymanWeb_KbdList\u0027;\r\n        ui.keyboardMenu.className=\u0027sfunhover\u0027;\r\n      }\r\n      else ui.keyboardMenu.innerHTML = \u0027\u0027;  // I2403 - Allow toggle design to be loaded twice\r\n      \r\n      var _li=util[\u0027createElement\u0027](\u0027li\u0027);\r\n      var _a=util[\u0027createElement\u0027](\u0027a\u0027);\r\n      _a.innerHTML=\u0027English\u0027;\r\n      _a.href=\"#\";\r\n      _a.onclick = function() { return ui.selectKbd(-1); };\r\n      _a.id=\u0027KMWSel_$\u0027;\r\n      _a.className=\u0027selected\u0027;\r\n      _li.appendChild(_a);\r\n      \r\n      ui.selectedMenuItem=_a;\r\n      ui.keyboardMenu.appendChild(_li);\r\n        \r\n      var _kbds=keymanweb[\u0027getKeyboards\u0027](), _added=[];\r\n      ui.keyboards=[];\r\n      for(var _kbd = 0; _kbd \u003c _kbds.length; _kbd++)\r\n      {\r\n          var _li1=util[\u0027createElement\u0027](\u0027li\u0027);\r\n          var _a1=util[\u0027createElement\u0027](\u0027a\u0027);\r\n          _a1.innerHTML=_kbds[_kbd][\u0027LanguageName\u0027] + \u0027 - \u0027 + _kbds[_kbd][\u0027Name\u0027];\r\n          if(!_added[_kbds[_kbd][\u0027InternalName\u0027]]) _added[_kbds[_kbd][\u0027InternalName\u0027]]=0;\r\n          _added[_kbds[_kbd][\u0027InternalName\u0027]]++;\r\n    \r\n          var _n=_added[_kbds[_kbd][\u0027InternalName\u0027]];\r\n          ui.keyboards.push({_InternalName: _kbds[_kbd][\u0027InternalName\u0027], _LanguageCode:_kbds[_kbd][\u0027LanguageCode\u0027], _Index: _n});\r\n\r\n          _a1.href=\"#\";\r\n          _a1.onclick = (function(x) { return function() { return ui.selectKbd(x); } })(ui.keyboards.length-1);\r\n          _a1.id=\u0027KMWSel_\u0027+_kbds[_kbd][\u0027InternalName\u0027]+\u0027$\u0027+_n;\r\n    \r\n          _li1.appendChild(_a1);\r\n          ui.keyboardMenu.appendChild(_li1);\r\n      }\r\n      \r\n      //if(!ui.initialized) // I2403 - Allow toggle design to be loaded twice\r\n      if(ui.keyboardMenu.parentNode != ui.kbdButton.getElem()) ui.kbdButton.getElem().appendChild(ui.keyboardMenu);  \r\n    };\r\n    \r\n    keymanweb[\u0027addHotKey\u0027](191,0x20,ui.switchSingleKbd);\r\n    keymanweb[\u0027addHotKey\u0027](191,0x30,ui.switchNextKbd);\r\n    keymanweb[\u0027addHotKey\u0027](191,0x40,ui.switchOsk);\r\n\r\n    // Initialize after KMW is fully initialized\r\n    keymanweb[\u0027addEventListener\u0027](\u0027loaduserinterface\u0027,ui.Initialize);\r\n    \r\n    // but also execute here, for asynchronous UI script loading (occurring after KMW initialization)\r\n    ui.Initialize();\r\n      \r\n  } catch(ex){}\r\n}"],"names":["window","keymanweb","osk","util","dbg","ui","name","initialized","controller","oskButton","kbdButton","controllerHovered","keyboards","lastActiveKeyboard","selectedMenuItem","updateList","updateTimer","doFocus","ui.doFocus","someElement","focusing","activeControl","event","srcElement","style","display","p","x","y","defaultView","frameElement","w","clientWidth","h","clientHeight","offsetWidth","offsetHeight","innerWidth","document","documentElement","scrollLeft","isNaN","left","top","params","target","oskPosition","_setSelected","byUser","switchOsk","ui.switchOsk","switchSingleKbd","ui.switchSingleKbd","_v","nLastKbd","length","kbdName","_InternalName","lgCode","_LanguageCode","switchNextKbd","ui.switchNextKbd","button","ui.button","_src","_caption","_selected","_elem","_onmouseout","_onmouseover","_onclick","_over","_down","getElem","this.getElem","_owningObject","__updatestyle","this.__updatestyle","ss","margin","border","background","__mouseover","this.__mouseover","__mouseout","this.__mouseout","__click","this.__click","__mousedown","this.__mousedown","__mouseup","this.__mouseup","this._setSelected","_value","_getSelected","this._getSelected","_getOver","this._getOver","_getDown","this._getDown","imgPath","_elemImg","src","id","width","height","zIndex","lineHeight","styleFloat","cssFloat","title","alt","appendChild","onmouseover","onmouseout","onmousedown","onmouseup","onclick","Initialize","ui.Initialize","innerHTML","padding","v1","kbdEnabledOnLoad","indexOf","v2","oskEnabledOnLoad","position","body","updateKeyboardList","shutdown","ui.shutdown","root","parentNode","removeChild","ui.updateKeyboardList","_kbds","_kmw_ctrl_img","getElementById","ui.kbdButton._onmouseover","keyboardMenu","className","ui.kbdButton._onmouseout","createMenu","Lki","Lklc","push","_Index","sk","split","updateMenu","clearTimeout","setTimeout","selectKbd","ui.selectKbd","_kbd","_name","_lgCode","ui.updateMenu","i","_k","ui.createMenu","_li","_a","href","_a.onclick","_added","_li1","_a1","_n","ex"],"sourceRoot":"/keyman/web/source/"}
