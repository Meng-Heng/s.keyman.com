var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in c||(c[f]={});c=c[f]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},a={};try{return a.__proto__=b,a.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,a){b.__proto__=a;if(b.__proto__!==a)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(a,c,b){var d=this.length||0;0>c&&(c=Math.max(0,d+c));if(null==b||b>d)b=d;b=Number(b);0>b&&(b=Math.max(0,d+b));for(c=Number(c||0);c<b;c++)this[c]=a;return this}},"es6","es3");
var KeyEvent=function(){return function(){}}(),AttachmentInfo=function(){return function(b,a){this.keyboard=b;this.touchEnabled=a}}(),LegacyKeyEvent=function(){return function(){}}(),KeyInformation=function(){return function(){}}(),StyleCommand=function(){return function(b,a){this.cmd=b;this.state=a}}(),__extends=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])};
return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),CommonDOMStates=function(){function b(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._SelectionControl=this._Selection=null;this.modStateFlags=0}b.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),1E3)};return b}(),DOMEventHandlers=function(){function b(a){this.setFocus=function(a){}.bind(this);
this.flashCaret=function(){}.bind(this);this.setBlur=function(a){}.bind(this);this._ControlFocus=function(a){var c=this.keyman.util.device,f=this.keyman.osk;a=this.keyman._GetEventObject(a);a=this.keyman.util.eventTarget(a);if(null==a||c.touchable&&(null==a.className||0>a.className.indexOf("keymanweb-input")))return!0;a.nodeName.toLowerCase();if(a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLInputElement){var g=a.type.toLowerCase();if("text"!=g&&"search"!=g)return!0}else if(!(!c.touchable&&
a.isContentEditable||a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement))return!0;DOMTouchHandlers.states.activeElement=a;3==a.nodeType&&(a=a.parentNode);g=a;(null==a.className||0>a.className.indexOf("keymanweb-input"))&&this instanceof DOMTouchHandlers&&this.scrollBody(a);a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(a),a=a.contentWindow.document);var h=b.states.lastActiveElement;b.states.lastActiveElement=
a;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings():this._FocusKeyboardSettings(h?!1:!0);if(this._CommonFocusHelper(a))return!0;a._KeymanWebSelectionStart=a._KeymanWebSelectionEnd=null;a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(a);this.doControlFocused(g,b.states.lastActiveElement);c.touchable?f._Enabled=1:f.ready&&(this.keyman.keyboardManager.isCJK()&&(f._Enabled=1),f._Enabled?f._Show():f._Hide(!1));return!0}.bind(this);
this._ControlBlur=function(a){a=this.keyman._GetEventObject(a);var c=this.keyman.util.eventTarget(a);if(null==c)return!0;b.states.activeElement=null;this instanceof DOMTouchHandlers&&this.hideCaret();3==c.nodeType&&(c=c.parentNode);c.ownerDocument&&(c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(c=c.contentWindow.document),c instanceof c.ownerDocument.defaultView.HTMLInputElement||c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement)&&(c._KeymanWebSelectionStart=c.value._kmwCodeUnitToCodePoint(c.selectionStart),
c._KeymanWebSelectionEnd=c.value._kmwCodeUnitToCodePoint(c.selectionEnd));this._BlurKeyboardSettings();b.states.lastActiveElement=c;this.keyman.uiManager.justActivated=!1;var f=this.keyman.uiManager.isActivating;f||this.keyman.keyboardManager.notifyKeyboard(0,c,0);this.doControlBlurred(c,a,f);this.keyman.osk.ready&&!f&&this.keyman.osk._Hide(!1);return!0}.bind(this);this._SelectionChange=function(){b.states._IgnoreNextSelChange&&b.states._IgnoreNextSelChange--;return!0}.bind(this);this._KeyDown=function(a){var c=
this.keyman.keyboardManager.activeKeyboard,f=this.keyman.osk,g=this.keyman.util,h=this.keyman["interface"];b.states._KeyPressToSwallow=0;if(b.states._DisableInput||null==c)return!0;var e=g.eventTarget(a);if(g.device.touchable){if(e&&"undefined"!=typeof e.kmwInput&&0==e.kmwInput)return!0}else if(e&&0<=e.className.indexOf("kmw-disabled"))return!0;if(!f.ready)return!0;e=this._GetKeyEventProperties(a,!0);if(null==e)return!0;switch(e.Lcode){case 8:h.clearDeadkeys();break;case 16:case 17:case 18:case 20:case 144:case 145:return this.keyman.keyboardManager.notifyKeyboard(e.Lcode,
e.Ltarg,1),g.device.touchable?!0:f._UpdateVKShift(e,e.Lcode-15,1)}e.LmodifierChange&&(this.keyman.keyboardManager.notifyKeyboard(0,e.Ltarg,1),f._UpdateVKShift(e,0,1));!window.event&&this.keyman.keyMapManager.browserMap.FF["k"+e.Lcode]&&(e.Lcode=this.keyman.keyMapManager.browserMap.FF["k"+e.Lcode]);if(c.KM){if(8==e.Lcode)return b.states._KeyPressToSwallow=1,h.processKeystroke(g.physicalDevice,e.Ltarg,e)||h.output(1,b.states.lastActiveElement,""),!1;b.states._KeyPressToSwallow=0}else{var k=0,l=this.keyman.keyMapManager.languageMap[f._BaseLayout];
l&&l["k"+e.Lcode]&&(e.Lcode=l["k"+e.Lcode]);"undefined"!=typeof c.KM||e.Lmodifiers&96||(c={Lcode:this.keyman.keyMapManager._USKeyCodeToCharCode(e),Ltarg:e.Ltarg,Lmodifiers:0,LisVirtualKey:0},h.processKeystroke(g.physicalDevice,c.Ltarg,c)&&(k=1));k=k||h.processKeystroke(g.physicalDevice,e.Ltarg,e);8==e.Lcode&&!k&&null!=e.Ltarg.className&&0<=e.Ltarg.className.indexOf("keymanweb-input")&&h.output(1,b.states.lastActiveElement,"")}!k&&96<=e.Lcode&&111>=e.Lcode&&(h.output(0,e.Ltarg,String._kmwFromCharCode(106>
e.Lcode?e.Lcode-48:e.Lcode-64)),k=1);if(k)return a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),b.states._KeyPressToSwallow=a?this._GetEventKeyCode(a):0,!1;b.states._KeyPressToSwallow=0;return 8==e.Lcode&&null!=e.Ltarg.className&&0<=e.Ltarg.className.indexOf("keymanweb-input")?!1:"undefined"!=typeof e.Ltarg.base&&(a=f.defaultKeyOutput("",e.Lcode,e.Lmodifiers,!1,e.Ltarg))?(h.output(0,e.Ltarg,a),!1):!0}.bind(this);this._KeyPress=function(a){if(b.states._DisableInput||null==this.keyman.keyboardManager.activeKeyboard)return!0;
var c=this._GetKeyEventProperties(a);if(null==c||c.LisVirtualKey)return!0;if(!this.keyman.keyboardManager.activeKeyboard.KM){if(!b.states._KeyPressToSwallow||32>c.Lcode||this.keyman._BrowserIsSafari&&63232<c.Lcode&&63744>c.Lcode)return!0;if(a=this.keyman._GetEventObject(a))a.returnValue=!1;return!1}if(b.states._KeyPressToSwallow||this.keyman["interface"].processKeystroke(this.keyman.util.physicalDevice,c.Ltarg,c))return b.states._KeyPressToSwallow=0,a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),
!1;b.states._KeyPressToSwallow=0;return!0}.bind(this);this._KeyUp=function(a){var c=this.keyman.keyboardManager,b=this.keyman.osk;a=this._GetKeyEventProperties(a,!1);if(null==a||!b.ready)return!0;switch(a.Lcode){case 13:if(a.Ltarg instanceof a.Ltarg.ownerDocument.defaultView.HTMLTextAreaElement)break;if(a.Ltarg.base&&a.Ltarg.base instanceof a.Ltarg.base.ownerDocument.defaultView.HTMLTextAreaElement)break;a.Ltarg instanceof a.Ltarg.ownerDocument.defaultView.HTMLInputElement&&(c=a.Ltarg,"search"==c.type||
"submit"==c.type?c.form.submit():this.keyman.domManager.moveToNext(!1));return!0;case 16:case 17:case 18:case 20:case 144:case 145:return c.notifyKeyboard(a.Lcode,a.Ltarg,0),this.keyman.util.device.touchable?!0:b._UpdateVKShift(a,a.Lcode-15,1)}a.LmodifierChange&&(c.notifyKeyboard(0,a.Ltarg,0),b._UpdateVKShift(a,0,1));return!1}.bind(this);this.keyman=a}b.prototype.getText=function(a){return""};b.prototype.setText=function(a,c,b){};b.prototype.getTextBeforeCaret=function(a){return""};b.prototype.setTextBeforeCaret=
function(a,c){};b.prototype.getTextCaret=function(a){return 0};b.prototype.setTextCaret=function(a,c){};b.prototype.hideCaret=function(){};b.prototype.updateInput=function(a){};b.prototype.doControlFocused=function(a,c){var b={};b.target=a;b.activeControl=c;return this.keyman.util.callEvent("kmw.controlfocused",b)};b.prototype.doControlBlurred=function(a,c,b){var d={};d.target=a;d.event=c;d.isActivating=b;return this.keyman.util.callEvent("kmw.controlblurred",d)};b.prototype._BlurKeyboardSettings=
function(){var a=this.keyman.keyboardManager.activeKeyboard?this.keyman.keyboardManager.activeKeyboard.KI:"",c=b.states.lastActiveElement;c&&null!=c._kmwAttachment.keyboard?(c._kmwAttachment.keyboard=a,c._kmwAttachment.languageCode=this.keyman.keyboardManager.getActiveLanguage()):(this.keyman.globalKeyboard=a,this.keyman.globalLanguageCode=this.keyman.keyboardManager.getActiveLanguage())};b.prototype._FocusKeyboardSettings=function(a){var c=b.states.lastActiveElement;null!=c._kmwAttachment.keyboard?
this.keyman.keyboardManager.setActiveKeyboard(c._kmwAttachment.keyboard,c._kmwAttachment.languageCode):a||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode)};b.prototype._CommonFocusHelper=function(a){var c=this.keyman.uiManager;if(a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(a,1)||!this.keyman.domManager._IsMozillaEditableIframe(a,1)))return b.states._DisableInput=!0;
b.states._DisableInput=!1;c.justActivated||(this.keyman["interface"]._DeadKeys=[],this.keyman.keyboardManager.notifyKeyboard(0,a,1));c.justActivated||b.states._SelectionControl==a||(c.isActivating=!1);c.justActivated=!1;b.states._SelectionControl=a;return!1};b.prototype._GetEventKeyCode=function(a){return a.keyCode?a.keyCode:a.which?a.which:null};b.prototype._GetKeyEventProperties=function(a,c){c=new KeyEvent;a=this.keyman._GetEventObject(a);c.Ltarg=this.keyman.util.eventTarget(a);if(null==c.Ltarg||
!0===a.cancelBubble)return null;3==c.Ltarg.nodeType&&(c.Ltarg=c.Ltarg.parentNode);c.Lcode=this._GetEventKeyCode(a);if(null==c.Lcode)return null;var d=this.keyman.osk,f=b.states.modStateFlags,g=!1,h=!1;switch(c.Lcode){case d.keyCodes.K_CTRL:case d.keyCodes.K_LCTRL:case d.keyCodes.K_RCTRL:case d.keyCodes.K_CONTROL:case d.keyCodes.K_LCONTROL:case d.keyCodes.K_RCONTROL:g=!0;break;case d.keyCodes.K_LMENU:case d.keyCodes.K_RMENU:case d.keyCodes.K_ALT:case d.keyCodes.K_LALT:case d.keyCodes.K_RALT:h=!0}var e=
0|(a.getModifierState("Shift")?16:0);a.getModifierState("Control")&&(e|=0!=a.location&&g?1==a.location?d.modifierCodes.LCTRL:d.modifierCodes.RCTRL:f&3);a.getModifierState("Alt")&&(e|=0!=a.location&&h?1==a.location?d.modifierCodes.LALT:d.modifierCodes.RALT:f&12);c.Lstates=0;a.getModifierState("CapsLock")?c.Lstates=d.modifierCodes.CAPS:c.Lstates=d.modifierCodes.NO_CAPS;a.getModifierState("NumLock")?c.Lstates|=d.modifierCodes.NUM_LOCK:c.Lstates|=d.modifierCodes.NO_NUM_LOCK;a.getModifierState("ScrollLock")||
a.getModifierState("Scroll")?c.Lstates|=d.modifierCodes.SCROLL_LOCK:c.Lstates|=d.modifierCodes.NO_SCROLL_LOCK;e|=c.Lstates;c.LmodifierChange=b.states.modStateFlags!=e;b.states.modStateFlags=e;g=d.modifierCodes.RALT|d.modifierCodes.LCTRL;(f&g)==g&&(e&g)!=g&&(e&=~g);e&d.modifierCodes.RALT&&(e&=~d.modifierCodes.LCTRL);this.keyman.keyboardManager.isChiral()?(c.Lmodifiers=e&d.modifierBitmasks.CHIRAL,d.emulatesAltGr()&&(c.Lmodifiers&d.modifierBitmasks.ALT_GR_SIM)==d.modifierBitmasks.ALT_GR_SIM&&(c.Lmodifiers^=
d.modifierBitmasks.ALT_GR_SIM,c.Lmodifiers|=d.modifierCodes.RALT)):c.Lmodifiers=(a.getModifierState("Shift")?16:0)|(e&(d.modifierCodes.LCTRL|d.modifierCodes.RCTRL)?32:0)|(e&(d.modifierCodes.LALT|d.modifierCodes.RALT)?64:0);c.LisVirtualKeyCode="undefined"!=typeof a.charCode&&null!=a.charCode&&(0==a.charCode||0!=(c.Lmodifiers&111));c.LisVirtualKey=c.LisVirtualKeyCode||"keypress"!=a.type;return c};b.states=new CommonDOMStates;return b}(),DOMTouchHandlers=function(b){function a(a){a=b.call(this,a)||this;
a.setFocus=function(a){var c=this.keyman.osk,b=this.keyman.util;DOMEventHandlers.states.setFocusTimer();if(Util.instanceof(a,"TouchEvent"))var d=a.touches[0];else d={clientX:0,clientY:0},d.target=DOMEventHandlers.states.lastActiveElement?DOMEventHandlers.states.lastActiveElement.kmw_ip:this.keyman.domManager.sortedInputs[0].kmw_ip;a=d.clientX;var e=d.clientY,k=d.target;var l=Util.instanceof(k,"HTMLSpanElement")?k.parentNode:null!=k.className&&0<=k.className.indexOf("keymanweb-input")?k.firstChild:
k;d=l.parentNode;DOMEventHandlers.states.activeElement!=d&&(this.hideCaret(),DOMEventHandlers.states.activeElement=d,d.focus());this.keyman.domManager._SetTargDir(d);c.ready&&!c._Visible&&c._Show();if(Util.instanceof(k,"HTMLDivElement"))e=b._GetAbsoluteX(l.firstChild),"rtl"==d.dir?(e+=l.firstChild.offsetWidth,c=a>e?0:1E5):c=a<e?0:1E5,this.setTextCaret(d,c),this.scrollInput(d);else{var v;l=l.childNodes[1];k=0;var p=this.getText(d)._kmwLength();c=this.getTextCaret(d);var w=document.body.scrollTop;if(d.base instanceof
d.base.ownerDocument.defaultView.HTMLTextAreaElement){var n=Math.round(d.base.offsetHeight/d.base.rows);for(v=0;16>v;v++){var m=b._GetAbsoluteY(l)-w;if(m>e&&c>k&&c!=p)p=c,c=Math.round((c+k)/2);else if(m<e-n&&c<p&&c!=k)k=c,c=Math.round((c+p)/2);else break;this.setTextCaret(d,c)}for(;b._GetAbsoluteY(l)-w>e&&c>k;)this.setTextCaret(d,--c);for(;b._GetAbsoluteY(l)-w<e-n&&c<p;)this.setTextCaret(d,++c)}m="rtl"==d.dir?function(a,c){return a<c}:function(a,c){return a>c};for(v=0;16>v;v++){e=b._GetAbsoluteX(l);
if(m(e,a)&&c>k&&c!=p)p=c,c=Math.round((c+k)/2);else if(!m(e,a)&&c<p&&c!=k)k=c,c=Math.round((c+p)/2);else break;this.setTextCaret(d,c)}for(;m(b._GetAbsoluteX(l),a)&&c>k;)this.setTextCaret(d,--c);for(;!m(b._GetAbsoluteX(l),a)&&c<p;)this.setTextCaret(d,++c)}this._BlurKeyboardSettings();DOMEventHandlers.states.lastActiveElement=d;this._FocusKeyboardSettings(!1);this._CommonFocusHelper(d)}.bind(a);a.flashCaret=function(){if(this.keyman.util.device.touchable&&null!=DOMEventHandlers.states.activeElement){var a=
this.caret.style;a.visibility="visible"!=a.visibility?"visible":"hidden"}}.bind(a);a.setBlur=function(a){if("relatedTarget"in a&&a.relatedTarget&&(a=a.relatedTarget,"DIV"!=a.nodeName||-1==a.className.indexOf("keymanweb-input"))){this.cancelInput();return}DOMEventHandlers.states.focusing||this.cancelInput()}.bind(a);a.dragInput=function(a){a.preventDefault();a.stopPropagation();var c=Util.instanceof(a,"TouchEvent")?a.targetTouches[0].target:a.target;if(null!=c){if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=
c.parentNode;if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=c.parentNode;if(!(null==c.className||0>c.className.indexOf("keymanweb-input"))){if(Util.instanceof(a,"TouchEvent")){var b=a.touches[0].screenX;var d=a.touches[0].screenY}else b=a.screenX,d=a.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch={x:b,y:d};else{var e=this.firstTouch.x,k=this.firstTouch.y;a=c.firstChild;if("TEXTAREA"==c.base.nodeName){if(b=parseInt(a.style.top,10),isNaN(b)&&
(b=0),e=k-d,-4>e||4<e)a.style.top=(b<e?b-e:0)+"px",this.firstTouch.y=d}else{d=parseInt(a.style.left,10);isNaN(d)&&(d=0);var l=e-b;if(-4>l||4<l)e=0,k=this.keyman.util._GetAbsoluteX(c)+c.offsetWidth-a.offsetWidth-32,"rtl"==c.base.dir?e=16:k-=24,d-=l,d>e&&(d=e),d<k&&(d=k),a.style.left=d+"px",this.firstTouch.x=b}}this.setScrollBar(c)}}}.bind(a);a.initCaret();return a}__extends(a,b);a.prototype.initCaret=function(){this.caret=document.createElement("DIV");var a=this.caret.style;a.position="absolute";a.height=
"16px";a.width="2px";a.backgroundColor="blue";a.border="none";a.left=a.top="0px";a.display="block";a.visibility="hidden";a.zIndex="9998";this.caretTimerId=window.setInterval(this.flashCaret,500)};a.prototype.getText=function(a){return null==a?"":"string"==typeof a.textContent?a.textContent:a.innerText};a.prototype.setText=function(a,b,f){if(a&&0<a.childNodes.length){var c=a.firstChild,d=0;if(3<=c.childNodes.length){var e=c.childNodes[0];c=c.childNodes[2];if(null===b){var k="string"==typeof e.textContent?
e.textContent:e.innerText;b="string"==typeof c.textContent?c.textContent:c.innerText;b=k+b}0>f&&(f=0);d=b._kmwLength();if(null===f||f>d)f=d;k=b._kmwSubstr(0,f);b=b._kmwSubstr(f);"string"==typeof e.textContent?e.textContent=k:e.innerText=k;"string"==typeof c.textContent?c.textContent=b:c.innerText=b}}this.updateBaseElement(a,d)};a.prototype.getTextBeforeCaret=function(a){if(a&&1<a.childNodes.length&&(a=a.firstChild,0<a.childNodes.length)){a=a.childNodes[0];if("textContent"in a)return a.textContent;
if("innerText"in a)return a.innerText}return""};a.prototype.setTextBeforeCaret=function(a,b){if(a&&0<a.childNodes.length){var c=a.firstChild,d=0;1<c.childNodes.length&&(d=c.childNodes[0],c=c.childNodes[2],"TEXTAREA"!=a.base.nodeName&&(b=b.replace(/\s+$/," ")),"textContent"in d?d.textContent=b:"innerText"in d&&(d.innerText=b),d=b.length,"textContent"in c?d+=c.textContent.length:"innerText"in c&&(d+=c.innerText.length))}this.updateBaseElement(a,d);this.scrollInput(a)};a.prototype.getTextCaret=function(a){return this.getTextBeforeCaret(a)._kmwLength()};
a.prototype.setTextCaret=function(a,b){this.setText(a,null,b);this.showCaret(a)};a.prototype.hideCaret=function(){var a=DOMEventHandlers.states.lastActiveElement;if(a&&null!=a.className&&0<=a.className.indexOf("keymanweb-input")){if(a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement||a.base instanceof a.base.ownerDocument.defaultView.HTMLInputElement)a.base.value=this.getText(a);this.setText(a,null,1E5);var b=a.firstChild.style;"TEXTAREA"==a.base.nodeName?b.top="0":b.left="rtl"==
a.base.dir?a.offsetWidth-a.firstChild.offsetWidth-8+"px":"0";this.caret.parentNode&&this.caret.parentNode.removeChild(this.caret);this.caret.style.visibility="hidden";1<a.childNodes.length&&(a.childNodes[1].style.visibility="hidden")}};a.prototype.showCaret=function(a){if(a&&a.firstChild&&!(3>a.firstChild.childNodes.length)){var c=a.firstChild,b=this.caret.style,g=c.childNodes[1];this.caret.parentNode!=c&&c.appendChild(this.caret);b.left=g.offsetLeft+"px";b.top=g.offsetTop+"px";b.height=g.offsetHeight-
1+"px";b.visibility="hidden";this.scrollBody(a);this.setScrollBar(a)}};a.prototype.updateInput=function(a){var c=this.keyman.util,b=a.style,g=a.base,h=window.getComputedStyle(g,null),e=parseInt(h.marginLeft,10),k=parseInt(h.marginTop,10),l=c._GetAbsoluteX(g),v=c._GetAbsoluteY(g),p=a.offsetParent;p&&(l-=c._GetAbsoluteX(p),v-=c._GetAbsoluteY(p));isNaN(e)&&(e=0);isNaN(k)&&(k=0);b.left=l-e+"px";b.top=v-k+"px";"undefined"!=typeof h.MozBoxSizing&&(b.left=l+"px",b.top=v+"px");e=g.offsetWidth;g=g.offsetHeight;
k=parseInt(h.paddingLeft,10);l=parseInt(h.paddingRight,10);v=parseInt(h.paddingTop,10);p=parseInt(h.paddingBottom,10);var w=parseInt(h.borderLeft,10),n=parseInt(h.borderRight,10),m=parseInt(h.borderTop,10),r=parseInt(h.borderBottom,10),t="undefined";"undefined"!=typeof h.boxSizing?t=h.boxSizing:"undefined"!=typeof h.MozBoxSizing&&(t=h.MozBoxSizing);"content-box"==t&&(isNaN(k)||(e-=k),isNaN(l)||(e-=l),isNaN(w)||(e-=w),isNaN(n)||(e-=n),isNaN(v)||(g-=v),isNaN(p)||(g-=p),isNaN(m)||(g-=m),isNaN(r)||(g-=
r));"Android"==c.device.OS&&("undefined"!=typeof h.MozBoxSizing?(b.paddingTop=v+1+"px",b.paddingLeft=k+"px","TEXTAREA"==a.base.nodeName?b.marginTop="1px":b.marginLeft="1px",e--,g--):(e++,g++));b.width=e+"px";b.height=g+"px"};a.prototype.updateBaseElement=function(a,b){var c=a.base.ownerDocument.defaultView;a.base instanceof c.HTMLInputElement||a.base instanceof c.HTMLTextAreaElement?a.base.value=this.getText(a):a.base.textContent=this.getText(a);a.style.backgroundColor=0==b?"transparent":window.getComputedStyle(a.base,
null).backgroundColor;"iOS"==this.keyman.util.device.OS&&(a.base.style.visibility=0==b?"visible":"hidden")};a.prototype.cancelInput=function(){DOMEventHandlers.states.activeElement=null;this.hideCaret();this.keyman.osk.hideNow()};a.prototype.setScrollBar=function(a){var c=a.childNodes[0],b=a.childNodes[1].style;(c.offsetWidth>a.offsetWidth||0>c.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(b.height="4px",b.width=a.offsetWidth/c.offsetWidth*100+"%",b.left=-c.offsetLeft/c.offsetWidth*100+"%",b.top="0",
b.visibility="visible"):c.offsetHeight>a.offsetHeight||0>c.offsetTop?(b.width="4px",b.height=a.offsetHeight/c.offsetHeight*100+"%",b.top=-c.offsetTop/c.offsetHeight*100+"%",b.left="0",b.visibility="visible"):b.visibility="hidden"};a.prototype.scrollInput=function(a){if(a&&a.firstChild&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))){var c=a.firstChild;if(!(3>c.childNodes.length)){var b=this.keyman.util,g=c.childNodes[1],h=b._GetAbsoluteX(g);g=b._GetAbsoluteY(g);var e=b._GetAbsoluteX(a);
b=b._GetAbsoluteY(a);var k=parseInt(c.style.left,10),l=parseInt(c.style.top,10),v=0,p=0;isNaN(k)&&(k=0);isNaN(l)&&(l=0);a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement?(h=Math.round(a.offsetHeight/a.base.rows),g<b&&(p=g-b),g>b+a.offsetHeight-h&&(p=g-b-a.offsetHeight+h),0!=p&&(c.style.top=(l<p?l-p:0)+"px")):(h<e+8&&(v=h-e-12),h>e+a.offsetWidth-12&&(v=h-e-a.offsetWidth+12),0!=v&&(c.style.left=(k<v?k-v:0)+"px"));this.showCaret(a)}}};a.prototype.scrollBody=function(a){var c=this.keyman.osk,
b=this.keyman.util;if(a&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))&&c.ready){a=a.firstChild.childNodes[1];b=b._GetAbsoluteY(a);var g=window.pageYOffset;b<g?c=b-g:(c=b-g-(window.innerHeight-c._Box.offsetHeight-a.offsetHeight-2),0>c&&(c=0));0!=c&&window.scrollTo(0,c+window.pageYOffset)}};return a}(DOMEventHandlers);
String.kmwFromCharCode=function(b){var a=[],c;for(c=0;c<arguments.length;c++){var d=Number(arguments[c]);if(!isFinite(d)||0>d||1114111<d||Math.floor(d)!==d)throw new RangeError("Invalid code point "+d);65536>d?a.push(d):(d-=65536,a.push((d>>10)+55296),a.push(d%1024+56320))}return String.fromCharCode.apply(void 0,a)};
String.prototype.kmwCharCodeAt=function(b){var a=String(this),c=0;if(0>b||b>=a.length)return NaN;for(var d=0;d<b;d++)if(c=a.kmwNextChar(c),null===c)return NaN;b=a.charCodeAt(c);return 55296<=b&&56319>=b&&a.length>c+1&&(a=a.charCodeAt(c+1),56320<=a&&57343>=a)?(b-55296<<10)+(a-56320)+65536:b};String.prototype.kmwIndexOf=function(b,a){var c=String(this);b=c.indexOf(b,a);if(0>b)return b;for(var d=a=0;null!==d&&d<b;d=c.kmwNextChar(d))a++;return a};
String.prototype.kmwLastIndexOf=function(b,a){var c=String(this);b=c.lastIndexOf(b,a);if(0>b)return b;for(var d=a=0;null!==d&&d<b;d=c.kmwNextChar(d))a++;return a};String.prototype.kmwLength=function(){var b=String(this);if(0==b.length)return 0;for(var a=0,c=0;null!==c;a++)c=b.kmwNextChar(c);return a};String.prototype.kmwSlice=function(b,a){var c=String(this);b=c.kmwCodePointToCodeUnit(b);a=c.kmwCodePointToCodeUnit(a);return null===b||null===a?"":c.slice(b,a)};
String.prototype.kmwSubstr=function(b,a){var c=String(this);0>b&&(b=c.kmwLength()+b);0>b&&(b=0);var d=c.kmwCodePointToCodeUnit(b),f=d;if(null===d)return"";if(2>arguments.length)f=c.length;else for(var g=0;g<a;g++)f=c.kmwNextChar(f);return null===f?c.substring(d):c.substring(d,f)};
String.prototype.kmwSubstring=function(b,a){var c=String(this);if("undefined"==typeof a)b=c.kmwCodePointToCodeUnit(b),a=c.length;else{if(b>a){var d=b;b=a;a=d}b=c.kmwCodePointToCodeUnit(b);a=c.kmwCodePointToCodeUnit(a)}if(isNaN(b)||null===b)b=0;if(isNaN(a)||null===a)a=c.length;return c.substring(b,a)};
String.prototype.kmwNextChar=function(b){var a=String(this);if(null===b||0>b||b>=a.length-1)return null;var c=a.charCodeAt(b);return 55296<=c&&56319>=c&&a.length>b+1&&(c=a.charCodeAt(b+1),56320<=c&&57343>=c)?b==a.length-2?null:b+2:b+1};String.prototype.kmwPrevChar=function(b){var a=String(this);if(null==b||0>=b||b>a.length)return null;var c=a.charCodeAt(b-1);return 56320<=c&&57343>=c&&1<b&&(a=a.charCodeAt(b-2),55296<=a&&56319>=a)?b-2:b-1};
String.prototype.kmwCodePointToCodeUnit=function(b){if(null===b)return null;var a=String(this),c=0;if(0>b){c=a.length;for(var d=0;d>b;d--)c=a.kmwPrevChar(c);return c}if(b==a.kmwLength())return a.length;for(d=0;d<b;d++)c=a.kmwNextChar(c);return c};String.prototype.kmwCodeUnitToCodePoint=function(b){var a=String(this);return null===b?null:0==b?0:0>b?a.substr(b).kmwLength():a.substr(0,b).kmwLength()};String.prototype.kmwCharAt=function(b){var a=String(this);return 0<=b?a.kmwSubstr(b,1):""};
String.prototype.kmwBMPNextChar=function(b){var a=String(this);return 0>b||b>=a.length-1?null:b+1};String.prototype.kmwBMPPrevChar=function(b){var a=String(this);return 0>=b||b>a.length?null:b-1};String.prototype.kmwBMPCodePointToCodeUnit=function(b){return b};String.prototype.kmwBMPCodeUnitToCodePoint=function(b){return b};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(b,a){var c=String(this);return-1<b?c.substr(b,a):c.substr(c.length+b,-b)};
String.kmwEnableSupplementaryPlane=function(b){var a=String.prototype;String._kmwFromCharCode=b?String.kmwFromCharCode:String.fromCharCode;a._kmwCharAt=b?a.kmwCharAt:a.charAt;a._kmwCharCodeAt=b?a.kmwCharCodeAt:a.charCodeAt;a._kmwIndexOf=b?a.kmwIndexOf:a.indexOf;a._kmwLastIndexOf=b?a.kmwLastIndexOf:a.lastIndexOf;a._kmwSlice=b?a.kmwSlice:a.slice;a._kmwSubstring=b?a.kmwSubstring:a.substring;a._kmwSubstr=b?a.kmwSubstr:a.kmwBMPSubstr;a._kmwLength=b?a.kmwLength:a.kmwBMPLength;a._kmwNextChar=b?a.kmwNextChar:
a.kmwBMPNextChar;a._kmwPrevChar=b?a.kmwPrevChar:a.kmwBMPPrevChar;a._kmwCodePointToCodeUnit=b?a.kmwCodePointToCodeUnit:a.kmwBMPCodePointToCodeUnit;a._kmwCodeUnitToCodePoint=b?a.kmwCodeUnitToCodePoint:a.kmwBMPCodeUnitToCodePoint};
var DOMManager=function(){function b(a){this.inputList=[];this.sortedInputs=[];this.nonKMWTouchHandler=function(a){DOMEventHandlers.states.focusing=!1;clearTimeout(DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);this._EnablementMutationObserverCore=function(a){for(var c=0;c<a.length;c++){var b=a[c],g=b.oldValue?0<=b.oldValue.indexOf("kmw-disabled"):!1,h=0<=b.target.className.indexOf("kmw-disabled");g&&!h?this._EnableControl(b.target):!g&&h&&this._DisableControl(b.target);
!h&&"readonly"==b.attributeName&&(g=b.oldValue?null!=b.oldValue:!1,h=b.target,h instanceof h.ownerDocument.defaultView.HTMLInputElement||h instanceof h.ownerDocument.defaultView.HTMLTextAreaElement)&&(h=h.readOnly,g&&!h?this._EnableControl(b.target):!g&&h&&this._DisableControl(b.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var c=[],b=[],g=0;g<a.length;g++){for(var h=a[g],e=0;e<h.addedNodes.length;e++)c=c.concat(this._GetDocumentEditables(h.addedNodes[e]));for(e=0;e<h.removedNodes.length;e++)b=
b.concat(this._GetDocumentEditables(h.removedNodes[e]))}for(a=0;a<c.length;a++)this.isKMWInput(c[a])&&this._MutationAdditionObserved(c[a]);for(a=0;a<b.length;a++)this.isKMWInput(b[a])&&this._MutationRemovalObserved(b[a]);if(c.length||b.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var k=this;window.setTimeout(function(){k.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.keyman.touchAliasing.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),
1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var c=this,b=function(){c.attachToControl(a)};a.addEventListener("load",b);"complete"==a.contentDocument.readyState&&window.setTimeout(b,1)}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=
function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var c=a.className;0<=c.indexOf("kmw-disabled")&&(a.className=c.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk.ready&&this.keyman.osk._Unload();this.clearLastActiveElement()}.bind(this);this.keyman=
a;a.util.device.touchable&&(this.touchHandlers=new DOMTouchHandlers(a));this.nonTouchHandlers=new DOMEventHandlers(a)}b.prototype.shutdown=function(){this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver.disconnect&&this.attachmentObserver.disconnect()};b.prototype.getHandlers=function(a){return(a=a.base?a.base._kmwAttachment:a._kmwAttachment)?a.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};b.prototype.enableTouchElement=function(a){if("iframe"==
a.tagName.toLowerCase())return!1;if(this.isKMWDisabled(a))return this.setupNonKMWTouchElement(a),!1;a.kmwInput=!0;a.removeEventListener("touchstart",this.nonKMWTouchHandler);if(a.kmw_ip){if(-1!=this.inputList.indexOf(a.kmw_ip))return!1;this.inputList.push(a.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");return!0}var c=document.createElement("div");c.base=c.base=a;c._kmwAttachment=a._kmwAttachment;this.enableInputElement(c,!0);a.kmw_ip=
c;a.disabled=!0;c.className="keymanweb-input";c.dir=c.base.dir;var b=document.createElement("div");var f=window.getComputedStyle(c.base,null);a=c.style;a.overflow="hidden";a.position="absolute";a.border="hidden";a.border="none";a.borderRadius="5px";var g=document.createElement("div");var h=g.style;h.position="absolute";h.height=h.width="4px";h.left=h.top="0";h.display="block";h.visibility="hidden";h.backgroundColor="#808080";h.borderRadius="2px";h=document.createElement("span");var e=document.createElement("span");
var k=document.createElement("span");h.innerHTML=e.innerHTML=k.innerHTML="";h.className=e.className=k.className="keymanweb-font";b.appendChild(h);b.appendChild(k);b.appendChild(e);c.appendChild(b);c.appendChild(g);b=b.style;b.position="absolute";g=h.style;var l=e.style;k=k.style;g.border=l.border="none";g.height=l.height="100%";g.fontFamily=l.fontFamily=b.fontFamily=f.fontFamily;"input"!=c.base.nodeName.toLowerCase()||isNaN(parseInt(f.height,10))||(g.lineHeight=l.lineHeight=f.height);k.border="1px solid red";
k.visibility="hidden";k.marginLeft=k.marginRight="-1px";a.padding="8px";b.padding="0px 2px";b.backgroundColor="Android"==this.keyman.util.device.OS&&"transparent"==f.backgroundColor?"#fff":f.backgroundColor;c.tabIndex=0;c.style.msTouchAction="none";var v=this.touchHandlers;c.addEventListener("touchstart",v.setFocus);c.onmspointerdown=function(a){a.preventDefault();a.stopPropagation();return v.setFocus(a)};c.addEventListener("touchend",function(a){a.stopPropagation()});c.onmspointerup=function(a){a.stopPropagation()};
c.addEventListener("touchmove",v.dragInput,!1);c.onmspointermove=v.dragInput;c.onblur=v.setBlur;"textarea"==c.base.nodeName.toLowerCase()?h.style.whiteSpace=e.style.whiteSpace="pre-wrap":h.style.whiteSpace=e.style.whiteSpace="pre";c.base.parentNode.appendChild(c);v.updateInput(c);a=c.style;a.color=f.color;a.fontFamily=f.fontFamily;a.fontSize=f.fontSize;a.fontWeight=f.fontWeight;a.textDecoration=f.textDecoration;a.padding=f.padding;a.margin=f.margin;a.border=f.border;a.borderRadius=f.borderRadius;
"webkitTapHighlightColor"in a&&(a.webkitTapHighlightColor="rgba(0,0,0,0)");c.base instanceof c.base.ownerDocument.defaultView.HTMLTextAreaElement?(2==c.base.rows&&(h=parseInt(f.height,10)-parseInt(f.paddingTop,10)-parseInt(f.paddingBottom,10),f=parseInt(f.fontSize,10),f=Math.round(h/f),f>c.base.rows+1&&(c.base.rows=f)),b.width=a.width,b.minHeight=a.height):(b.minWidth=a.width,b.height=a.height);c.base.style.visibility="hidden";(function(a){a._kmwResizeHandler=function(c){window.setTimeout(function(){v.updateInput(a)},
1)};a.base.addEventListener("resize",a._kmwResizeHandler,!1)})(c);v.setText(c,c.base instanceof c.base.ownerDocument.defaultView.HTMLTextAreaElement||c.base instanceof c.base.ownerDocument.defaultView.HTMLInputElement?c.base.value:c.base.textContent,null);return!0};b.prototype.disableTouchElement=function(a){if("iframe"!=a.tagName.toLowerCase()){if(a.kmw_ip){var c=this.inputList.indexOf(a.kmw_ip);-1!=c&&this.inputList.splice(c,1);a.style.visibility="visible";a.disabled=!1;a.removeEventListener("resize",
a.kmw_ip._kmwResizeHandler);this.disableInputElement(a.kmw_ip);a.parentNode&&a.parentNode.removeChild(a.kmw_ip);delete a.kmw_ip}this.setupNonKMWTouchElement(a)}};b.prototype.setupNonKMWTouchElement=function(a){a.addEventListener("touchstart",this.nonKMWTouchHandler,!1);this.isAttached(a)&&(a._kmwAttachment.touchEnabled=!1)};b.prototype.enableInputElement=function(a,c){c=c?a.base:a;this.isKMWDisabled(c)||(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(a):(c.className=
c.className?c.className+" keymanweb-font":"keymanweb-font",this.inputList.push(a),this.keyman.util.attachDOMEvent(c,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.attachDOMEvent(c,"blur",this.getHandlers(a)._ControlBlur),a.onkeypress=this.getHandlers(a)._KeyPress,a.onkeydown=this.getHandlers(a)._KeyDown,a.onkeyup=this.getHandlers(a)._KeyUp))};b.prototype.disableInputElement=function(a,c){var b=c?a.base:a;if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this._DetachFromIframe(a);
else{0<b.className.indexOf("keymanweb-font")&&!c&&(b.className=b.className.replace("keymanweb-font","").trim());var f=this.inputList.indexOf(a);-1<f&&this.inputList.splice(f,1);c||(this.keyman.util.detachDOMEvent(b,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.detachDOMEvent(b,"blur",this.getHandlers(a)._ControlBlur));a.onkeypress=null;a.onkeydown=null;a.onkeyup=null}c&&(this.inputList.push(b),b.onkeypress=this.getHandlers(a)._KeyPress,b.onkeydown=this.getHandlers(a)._KeyDown,b.onkeyup=
this.getHandlers(a)._KeyUp)};b.prototype.isKMWDisabled=function(a){var c=a.className;return a.readOnly||c&&0<=c.indexOf("kmw-disabled")?!0:!1};b.prototype.attachToControl=function(a){var c=this.keyman.util.device.touchable;if(!this.isAttached(a)||a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(a)?(this.setupElementAttachment(a),this.isKMWDisabled(a)?c&&this.setupNonKMWTouchElement(a):c?this.enableTouchElement(a):this.enableInputElement(a)):c&&this.setupNonKMWTouchElement(a)};
b.prototype.detachFromControl=function(a){this.isAttached(a)&&(this.isKMWInput(a)&&(this.isKMWDisabled(a)||this._DisableControl(a)),this.clearElementAttachment(a))};b.prototype.isAttached=function(a){return a._kmwAttachment?!0:!1};b.prototype.isKMWInput=function(a){var c=this.keyman.util.device.touchable;if(a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement)return!0;if(a instanceof a.ownerDocument.defaultView.HTMLInputElement){if("text"==a.type||"search"==a.type)return!0}else if(a instanceof
a.ownerDocument.defaultView.HTMLIFrameElement&&!c)try{if(a.contentWindow.document)return!0}catch(d){}else if(a.isContentEditable&&!c)return!0;return!1};b.prototype.setupElementAttachment=function(a){a._kmwAttachment||(a._kmwAttachment=new AttachmentInfo(null,this.keyman.util.device.touchable))};b.prototype.clearElementAttachment=function(a){a._kmwAttachment=null};b.prototype._AttachToIframe=function(a){var c=this.keyman.util;try{var b=a.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?
(c.attachDOMEvent(b,"focus",this.getHandlers(a)._ControlFocus),c.attachDOMEvent(b,"blur",this.getHandlers(a)._ControlBlur),c.attachDOMEvent(b,"keydown",this.getHandlers(a)._KeyDown),c.attachDOMEvent(b,"keypress",this.getHandlers(a)._KeyPress),c.attachDOMEvent(b,"keyup",this.getHandlers(a)._KeyUp)):this._SetupDocument(b))}catch(f){}};b.prototype._DetachFromIframe=function(a){var c=this.keyman.util;try{var b=a.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?(c.detachDOMEvent(b,"focus",this.getHandlers(a)._ControlFocus),
c.detachDOMEvent(b,"blur",this.getHandlers(a)._ControlBlur),c.detachDOMEvent(b,"keydown",this.getHandlers(a)._KeyDown),c.detachDOMEvent(b,"keypress",this.getHandlers(a)._KeyPress),c.detachDOMEvent(b,"keyup",this.getHandlers(a)._KeyUp)):this._ClearDocument(b))}catch(f){}};b.prototype._GetDocumentEditables=function(a){var c=this.keyman.util,b=[];if(a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement){var f=a.ownerDocument.defaultView;a instanceof f.HTMLInputElement||a instanceof f.HTMLTextAreaElement?
b.push(a):a instanceof f.HTMLIFrameElement&&b.push(a)}a.getElementsByTagName&&(b=b.concat(c.arrayFromNodeList(a.getElementsByTagName("INPUT")),c.arrayFromNodeList(a.getElementsByTagName("TEXTAREA")),c.arrayFromNodeList(a.getElementsByTagName("IFRAME"))));a.querySelectorAll&&(b=b.concat(c.arrayFromNodeList(a.querySelectorAll("[contenteditable]"))));a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement&&a.isContentEditable&&b.push(a);return b};b.prototype._SetupDocument=function(a){a=
this._GetDocumentEditables(a);for(var c=0;c<a.length;c++)this.attachToControl(a[c])};b.prototype._ClearDocument=function(a){a=this._GetDocumentEditables(a);for(var c=0;c<a.length;c++)this.detachFromControl(a[c])};b.prototype._SetTargDir=function(a){var c=null!=this.keyman.keyboardManager.activeKeyboard&&this.keyman.keyboardManager.activeKeyboard.KRTL?"rtl":"ltr";a&&(this.keyman.util.device.touchable?0==a.textContent.length&&(a.base.dir=a.dir=c,this.getHandlers(a).setTextCaret(a,1E4)):a instanceof
a.ownerDocument.defaultView.HTMLInputElement||a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement?0==a.value.length&&(a.dir=c):"string"==typeof a.textContent&&0==a.textContent.length&&(a.dir=c))};b.prototype._DisableControl=function(a){if(this.isAttached(a)){var c=this.getLastActiveElement();if(c==a||c==a.kmw_ip)this.clearLastActiveElement(),this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode),this.keyman.osk._Hide();this.keyman.util.device.touchable?
(this.disableTouchElement(a),this.setupNonKMWTouchElement(a),window.setTimeout(function(){this.listInputs();for(var c=0;c<this.sortedInputs.length;c++)DOMEventHandlers.states[c].kmw_ip&&this.getHandlers(a).updateInput(DOMEventHandlers.states[c].kmw_ip)}.bind(this),1)):this.listInputs();this.disableInputElement(a)}};b.prototype._EnableControl=function(a){if(this.isAttached(a))if(this.keyman.util.device.touchable){this.enableTouchElement(a);var c=this.keyman;window.setTimeout(function(){c.domManager.listInputs();
for(var b=0;b<this.sortedInputs.length;b++)this.sortedInputs[b].kmw_ip&&this.getHandlers(a).updateInput(this.sortedInputs[b].kmw_ip)},1)}else this.enableInputElement(a)};b.prototype.listInputs=function(){var a,c=[],b=document.getElementsByTagName("input"),f=document.getElementsByTagName("textarea"),g=this.keyman.util;for(a=0;a<b.length;a++)switch(b[a].type){case "text":case "search":case "email":case "url":0>b[a].className.indexOf("kmw-disabled")&&c.push({ip:b[a],x:g._GetAbsoluteX(b[a]),y:g._GetAbsoluteY(b[a])})}for(a=
0;a<f.length;a++)0>f[a].className.indexOf("kmw-disabled")&&c.push({ip:f[a],x:g._GetAbsoluteX(f[a]),y:g._GetAbsoluteY(f[a])});c.sort(function(a,c){return a.y!=c.y?a.y-c.y:a.x-c.x});b=[];for(a=0;a<c.length;a++)b.push(c[a].ip);this.sortedInputs=b};b.prototype.disableControl=function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var c=a.className;0>c.indexOf("kmw-disabled")&&(a.className=c?c+" kmw-disabled":"kmw-disabled")};b.prototype.setKeyboardForControl=function(a,
c,b){null!==c&&void 0!==c?0>c.indexOf("Keyboard_")&&""!=c&&(c="Keyboard_"+c):b=null;if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(a)){a._kmwAttachment.keyboard=c;a._kmwAttachment.languageCode=b;var d=this.getLastActiveElement();!d||d!=a&&d!=a.kmw_ip||null!=c&&null!=b&&this.keyman.keyboardManager.setActiveKeyboard(c,b)}else console.error("KeymanWeb is not attached to element "+
a)};b.prototype.getKeyboardForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+a);return null};b.prototype.getLanguageForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+a);return null};b.prototype.focusLastActiveElement=function(){var a=this.getLastActiveElement();a&&(this.keyman.uiManager.justActivated=!0,a.ownerDocument&&a instanceof
a.ownerDocument.defaultView.HTMLIFrameElement&&this.keyman.domManager._IsMozillaEditableIframe(a,0)?a.ownerDocument.defaultView.focus():a.focus&&a.focus())};b.prototype.getLastActiveElement=function(){return DOMEventHandlers.states.lastActiveElement};b.prototype.clearLastActiveElement=function(){DOMEventHandlers.states.lastActiveElement=null};b.prototype.getActiveElement=function(){return DOMEventHandlers.states.activeElement};b.prototype._setActiveElement=function(a){DOMEventHandlers.states.activeElement=
a};b.prototype.setActiveElement=function(a,c){"string"==typeof a&&(a=document.getElementById(a));DOMEventHandlers.states.activeElement=DOMEventHandlers.states.lastActiveElement=a;1<arguments.length&&c&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocus():this.focusLastActiveElement())};b.prototype.initActiveElement=function(a){null==DOMEventHandlers.states.activeElement&&(DOMEventHandlers.states.activeElement=a)};b.prototype.moveToNext=function(a){var c,b=this.sortedInputs,f=this.getActiveElement(),
g=this.keyman.util.device.touchable;if(0!=b.length){g&&(f=f.base);for(c=0;c<b.length&&b[c]!=f;c++);c=a?c-1:c+1;c=c>=b.length?c-b.length:c;c=0>c?c+b.length:c;g?(DOMEventHandlers.states.focusing=!0,a=b[c].kmw_ip,"undefined"==typeof a?b[c].focus():(this.keyman.domManager.setActiveElement(a),this.touchHandlers.setTextCaret(a,1E4),this.touchHandlers.scrollInput(a),a.focus())):b[c].focus()}};b.prototype.moveToElement=function(a){"string"==typeof a&&(a=document.getElementById(a));this.keyman.util.device.touchable&&
a.kmw_ip?a.kmw_ip.focus():a.focus()};b.prototype._IsIEEditableIframe=function(a,c){var b,f=a&&(b=a.tagName)&&"body"==b.toLowerCase()&&(b=a.ownerDocument)&&b.parentWindow;return!c&&f||c&&(!f||a.isContentEditable)};b.prototype._IsMozillaEditableIframe=function(a,c){var b;a=a&&(b=a.defaultView)&&b.frameElement;return!c&&a||c&&(!a||"on"==b.document.designMode.toLowerCase())};b.prototype.getBaseFont=function(){var a=this.keyman.util,c=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),
f=0;if(0==c.length&&0==b.length)f=0;else if(0<c.length&&0==b.length)f=1;else if(0==c.length&&0<b.length)f=2;else{var g=c[0],h=b[0];g.offsetTop<h.offsetTop?f=1:g.offsetTop>h.offsetTop?f=2:g.offsetLeft<h.offsetLeft?f=1:g.offsetLeft>h.offsetLeft&&(f=2)}switch(f){case 0:case 1:a.getStyleValue(c[0],"font-family");case 2:var e=a.getStyleValue(b[0],"font-family")}if("undefined"==typeof e||"monospace"==e)e="Arial,sans-serif";return e};b.prototype.init=function(a){var c,b=this.keyman.osk;var f=this.keyman.util;
var g=f.device,h=function(a){if(0==a.length)return a;"/"!=a.substr(a.length-1,1)&&(a+="/");return"http"==a.replace(/^(http)s?:.*/,"$1")||"file"==a.replace(/^(file):.*/,"$1")?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.rootPath+a.substr(1):this.keyman.srcPath+a};var e=this.keyman.options;if("object"==typeof a&&null!==a)for(c in e)a.hasOwnProperty(c)&&(e[c]=a[c]);""!=e.root&&(this.keyman.rootPath=h(e.root));""==e.resources&&(e.resources=this.keyman.srcPath);e.resources=
h(e.resources);e.keyboards=h(e.keyboards);e.fonts=h(e.fonts);""==e.attachType&&(e.attachType="auto");this.keyman.setDefaultDeviceOptions(e);if(!this.keyman.initialized){var k=this.keyman,l=this;"complete"!==document.readyState?window.setTimeout(function(){l.init(a)},50):(this.keyman._MasterDocument=window.document,"Android"==g.OS&&(e=g.getDPI(),g.formFactor=screen.height<4*e||screen.width<4*e?"phone":"tablet"),this.keyman.setInitialized(1),b.prepare(),f.prepareWait(),this.keyman.keyboardManager.registerDeferredStubs(),
this.initializeUI(),this.keyman.keyboardManager.registerDeferredKeyboards(),this.keyman.isEmbedded?this.keyman.keyboardManager.setDefaultKeyboard()||console.error("No keyboard stubs exist - cannot initialize keyboard!"):(this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont(),g.touchable&&this.keyman.handleRotationEvents(),"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement),this.listInputs(),g.touchable&&(b._Box.addEventListener("touchend",function(a){a.stopPropagation()},
!1),f=document.createElement("DIV"),e=f.style,e.width="100%",e.height=screen.width/2+"px",document.body.appendChild(f),"Android"==g.OS&&0<navigator.userAgent.indexOf("Chrome")?(this.keyman.hideOskWhileScrolling=function(a){if("undefined"!=typeof b._Box&&"undefined"!=typeof b._Box.style){c=a.target.parentNode;if("undefined"!=typeof c&&null!=c&&(0<=c.className.indexOf("keymanweb-input")||0<=c.className.indexOf("kmw-key-")||"undefined"!=typeof c.parentNode&&(c=c.parentNode,0<=c.className.indexOf("keymanweb-input")||
0<=c.className.indexOf("kmw-key-"))))return;b.hideNow()}},document.body.addEventListener("touchstart",this.keyman.hideOskWhileScrolling,!1)):(this.keyman.conditionallyHideOsk=function(){k.hideOnRelease&&!b.lgList&&b.hideNow();k.hideOnRelease=!1},this.keyman.hideOskIfOnBody=function(a){k.touchY=a.touches[0].screenY;k.hideOnRelease=!0},this.keyman.cancelHideIfScrolling=function(a){a=a.touches[0].screenY;var c=k.touchY;if(5<a-c||5>c-a)k.hideOnRelease=!1},document.body.addEventListener("touchstart",this.keyman.hideOskIfOnBody,
!1),document.body.addEventListener("touchmove",this.keyman.cancelHideIfScrolling,!1),document.body.addEventListener("touchend",this.keyman.conditionallyHideOsk,!1))),this.keyman.keyboardManager.restoreCurrentKeyboard(),MutationObserver?(g=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&(f={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(g,f)),f={subtree:!0,attributes:!0,attributeOldValue:!0,
attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(g,f)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements."),this.keyman.setInitialized(2)))}};b.prototype.initializeUI=function(){this.keyman.ui&&this.keyman.ui.initialize instanceof Function?(this.keyman.ui.initialize(),this.keyman.osk._Show()):window.setTimeout(this.initializeUI.bind(this),
1E3)};return b}(),Device=function(){function b(){this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}b.prototype.getDPI=function(){var a=document.createElement("DIV"),c=a.style,b=96;if("complete"!==document.readyState)return b;a.id="calculateDPI";c.position="absolute";c.display="block";c.visibility="hidden";c.left="10px";c.top="10px";c.width="1in";c.height="10px";document.body.appendChild(a);
b="undefined"==typeof window.devicePixelRatio?a.offsetWidth:a.offsetWidth*window.devicePixelRatio;document.body.removeChild(a);return b};b.prototype.detect=function(){var a=b._GetIEVersion();if(navigator&&navigator.userAgent){var c=navigator.userAgent;0<=c.indexOf("iPad")&&(this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0);0<=c.indexOf("iPhone")&&(this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=25);if(0<=c.indexOf("Android")){this.OS="Android";this.formFactor=
"phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=c.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(d){}}0<=c.indexOf("Windows NT")&&(this.OS="Windows",0<=c.indexOf("Touch")&&(this.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}"tablet"==this.formFactor&&400>Math.min(screen.width,screen.height)&&(this.formFactor="phone");"phone"==this.formFactor&&720<Math.max(screen.width,screen.height)&&(this.formFactor="tablet");
"iOS"!=this.OS||"ongesturestart"in window||"Win32"==navigator.platform||(this.OS="Android");this.browser="web";if(999>a)this.browser="ie";else{if("iOS"==this.OS||"macosx"==this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?this.browser="opera":0<=navigator.userAgent.indexOf("Chrome")&&(this.browser="chrome"))}};b._GetIEVersion=
function(){var a="";"userAgent"in navigator&&(a=navigator.userAgent);if("selection"in document){var c=navigator.appVersion;var b=c.indexOf("MSIE ");if(0<=b){if("BackCompat"==document.compatMode)return 6;c=c.substr(b+5);b=c.indexOf(".");if(0<b)return parseInt(c.substr(0,b),10)}}b=a.indexOf("Trident/");if(0>b)return 999;a=a.substr(b+8);b=a.indexOf(".");return 0<b?parseInt(a.substr(0,b),10)+4:999};return b}(),Util=function(){function b(a){this.events={};this.currentEvents=[];this.embeddedFonts=[];this.getAbsoluteX=
this._GetAbsoluteX;this.getAbsoluteY=this._GetAbsoluteY;this.getAbsolute=this._GetAbsolute;this.selectStartHandler=function(){return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=a}b.prototype.initDevices=function(){this.device=new Device;this.physicalDevice=new Device;this.activeDevice=this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=!1);this.physicalDevice=new Device;this.physicalDevice.touchable=!1;this.physicalDevice.browser=
this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};b.prototype.arrayFromNodeList=function(a){for(var c=[],b=0;b<a.length;b++)c.push(a[b]);return c};b.prototype.addEventListener=function(a,c){this.removeEventListener(a,c);this.events[a].push(c);return!0};b.prototype.removeEventListener=function(a,c){"undefined"==typeof this.events[a]&&(this.events[a]=[]);for(var b=0;b<this.events[a].length;b++)if(this.events[a][b]==c)return this.events[a].splice(b,1),
!0;return!1};b.prototype.callEvent=function(a,c){if("undefined"==typeof this.events[a])return!0;if(-1!=this.currentEvents.indexOf(a))return!1;this.currentEvents.push(a);for(var b=0;b<this.events[a].length;b++){var f=this.events[a][b],g=!1;try{g=f(c)}catch(h){g=!1}if(!1===g)return this.currentEvents.pop(),!1}this.currentEvents.pop();return!0};b.prototype.attachDOMEvent=function(a,c,b,f){this.detachDOMEvent(a,c,b,f);a.addEventListener(c,b,f?!0:!1)};b.prototype.detachDOMEvent=function(a,c,b,f){a.removeEventListener(c,
b,f)};b.prototype.getOption=function(a,c){return a in this.keyman.options?this.keyman.options[a]:1<arguments.length?c:""};b.prototype.setOption=function(a,c){this.keyman.options[a]=c};b.prototype._GetAbsoluteX=function(a){if(!a)return 0;var c=a.offsetLeft?a.offsetLeft:0;var b=a;if(b.offsetParent)for(;b.offsetParent;)b=b.offsetParent,c+=b.offsetLeft;return b&&b.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&(a=b.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?c+this._GetAbsoluteX(a.defaultView.frameElement)-
a.documentElement.scrollLeft:c};b.prototype._GetAbsoluteY=function(a){if(!a)return 0;var c=a.offsetTop?a.offsetTop:0;var b=a;if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLElement)for(;b.offsetParent;)b=b.offsetParent,c+=b.offsetTop;return b&&b.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&(a=b.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?c+this._GetAbsoluteY(a.defaultView.frameElement)-a.documentElement.scrollTop:c};b.prototype._GetAbsolute=function(a){return{x:this._GetAbsoluteX(a),
y:this._GetAbsoluteY(a)}};b.prototype.mouseDownPreventDefaultHandler=function(a){a&&a.preventDefault()};b.prototype._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?a.onselectstart=this.selectStartHandler:(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};b.prototype.getIEVersion=function(){return Device._GetIEVersion()};b.prototype.getStyleValue=function(a,c){try{if(a&&"undefined"!=
typeof window.getComputedStyle)return window.getComputedStyle(a,"").getPropertyValue(c)}catch(d){}return""};b.prototype.getStyleInt=function(a,c,b){a=parseInt(this.getStyleValue(a,c),10);return isNaN(a)?"number"==typeof b?b:0:a};b.prototype.isTouchDevice=function(){return this.device.touchable};b.prototype.portraitView=function(){return!this.landscapeView()};b.prototype.landscapeView=function(){return"undefined"==typeof window.orientation?!1:1==Math.abs(window.orientation/90)};b.prototype.getViewportScale=
function(){try{if(screen.width>document.documentElement.clientWidth)return 1;var a=screen.width;this.landscapeView()?screen.width<screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/window.innerWidth)/100}catch(c){return 1}};b.prototype.barHeight=function(){var a=0;"phone"==this.device.formFactor&&(a=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return a};b.prototype._EncodeEntities=function(a){return a.replace("&",
"&amp;").replace("<","&lt;").replace(">","&gt;")};b.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};b.prototype.showShim=function(a,c,b){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};b.prototype.hideShim=function(a){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};
b.prototype.rgba=function(a,c,b,f,g){a="transparent";try{a="rgba("+c+","+b+","+f+","+g+")"}catch(h){a="rgb("+c+","+b+","+f+")"}return a};b.prototype.addStyleSheet=function(a){var c=document.createElement("style");c.type="text/css";c.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");0<a.length?a[0].appendChild(c):document.body.appendChild(c);return c};b.prototype.removeStyleSheet=function(a){if(null==a||"object"!=typeof a||"STYLE"!=a.nodeName||"undefined"==typeof a.parentNode||
null==a.parentNode)return!1;a.parentNode.removeChild(a);return!0};b.prototype.linkStyleSheet=function(a){var c=document.getElementsByTagName("head");if(0<c.length){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a;c[0].appendChild(b)}};b.prototype.addFontFaceStyleSheet=function(a){if("undefined"!=typeof a&&("undefined"==typeof a.files&&(a.files=a.source),"undefined"!=typeof a.files)){var c,b="",f="",g="",h="",e=[];for(c=0;c<this.embeddedFonts.length;c++)if(this.embeddedFonts[c]==
a.family)return;"string"==typeof a.files?e[0]=a.files:e=a.files;for(c=0;c<e.length;c++)0<e[c].indexOf(".ttf")&&(b=e[c]),0<e[c].indexOf(".woff")&&(f=e[c]),0<e[c].indexOf(".eot")&&(g=e[c]),0<e[c].indexOf(".svg")&&(h=e[c]);""!=b&&0>b.indexOf("/")&&(b=this.keyman.options.fonts+b);""!=f&&0>f.indexOf("/")&&(f=this.keyman.options.fonts+f);""!=g&&0>g.indexOf("/")&&(g=this.keyman.options.fonts+g);""!=h&&0>h.indexOf("/")&&(h=this.keyman.options.fonts+h);c="@font-face {\nfont-family:"+a.family+";\nfont-style:normal;\nfont-weight:normal;\n";
if(9<=Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=b)b=this.unCached(b),c=c+"src:url('"+b+"') format('truetype');";else return;else{g=[];"Android"==this.device.OS?(""!=h&&g.push("url('"+h+"') format('svg')"),""!=f&&g.push("url('"+f+"') format('woff')"),""!=b&&g.push("url('"+b+"') format('truetype')")):(""!=f&&g.push("url('"+f+"') format('woff')"),""!=b&&g.push("url('"+b+"') format('truetype')"),""!=h&&g.push("url('"+h+"') format('svg')"));if(0==g.length)return;c+="src:"+g.join(",")+";"}else if(""!=
g)c=c+"src:url('"+g+"');";else return;this.addStyleSheet(c+"\n}\n");this.embeddedFonts.push(a.family)}};b.prototype.unCached=function(a){return a};b.prototype.loadCookie=function(a){var c={};if(0<arguments.length){var b=this.loadCookie(),f;for(f in b)if(f==a)for(var g=decodeURI(b[f]).split(";"),h=0;h<g.length;h++){var e=g[h].split("=");c[e[0]]=1<e.length?e[1]:""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(b=document.cookie.split(/;\s*/),h=0;h<b.length;h++)g=b[h].split("="),
2==g.length&&(c[g[0]]=g[1]);return c};b.prototype.saveCookie=function(a,c){var b="",f;for(f in c)b=b+f+"="+c[f]+";";c=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=a+"="+encodeURI(b)+"; path=/; expires="+c};b.prototype.toNumber=function(a,c){a=parseInt(a,10);return isNaN(a)?c:a};b.prototype.toFloat=function(a,c){a=parseFloat(a);return isNaN(a)?c:a};b.prototype.nzString=function(a,c){var b="";1<arguments.length&&(b=c);return"undefined"==typeof a||null==a||0==a||""==a?b:""+a};
b.prototype.deepCopy=function(a,c){c=c||{};for(var b in a)"object"===typeof a[b]?(c[b]=a[b].constructor===Array?[]:{},this.deepCopy(a[b],c[b])):c[b]=a[b];return c};b.prototype.eventTarget=function(a){return a?a.target?a.target:a.srcElement?a.srcElement:window.event?window.event.srcElement:null:null};b.prototype.eventType=function(a){return a&&a.type?a.type:window.event?window.event.type:""};b.prototype.alert=function(a,c){var b=this.waiting,f=b.firstChild.childNodes;f[0].style.display="block";f[1].className=
"kmw-alert-text";f[1].innerHTML=a;f[2].style.display="none";b.style.display="block";b.dismiss=1<arguments.length?c:null};b.prototype.wait=function(a){};b.prototype.prepareWait=function(){var a=document.createElement("DIV"),c=document.createElement("DIV"),b=document.createElement("DIV"),f=document.createElement("DIV"),g=document.createElement("DIV");a.className="kmw-wait-background";c.className="kmw-wait-box";a.dismiss=null;b.className="kmw-wait-text";f.className="kmw-wait-graphic";g.className="kmw-alert-close";
c.onmousedown=c.onclick=function(c){"block"==g.style.display&&(a.style.display="none",a.dismiss&&a.dismiss())};c.addEventListener("touchstart",c.onclick,!1);a.onmousedown=a.onclick=function(a){a.preventDefault();a.stopPropagation()};a.addEventListener("touchstart",a.onclick,!1);c.appendChild(g);c.appendChild(b);c.appendChild(f);a.appendChild(c);document.body.appendChild(a);this.waiting=a};b.prototype.myPath=function(a){var c,b=document.getElementsByTagName("script");for(c=0;c<b.length;c++){var f=
b[c];if(0<=f.src.indexOf(a))return f.src.substr(0,f.src.lastIndexOf("/")+1)}return""};b.prototype.prependProtocol=function(a){return/^https?:/.test(a)?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.protocol+"/"+a:this.keyman.protocol+"//"+a};b.prototype.testString=function(a){var c=a.family;if("sample"in a&&"string"==typeof a.sample)return"BESbswy"+a.sample;var b="TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),
f="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");for(a=0;a<b.length;a++)if(c==b[a])return"BESbswy"+f[a];return"BESbswy"};b.prototype.checkFont=function(a){var c=a.family,b=document.createElement("DIV"),f=b.style,g=document.createElement("P"),h=document.createElement("P"),e=document.createElement("SPAN"),k=e.style,l=document.createElement("SPAN"),v=l.style;f.position="absolute";
f.top="10px";f.left="10px";f.visibility="hidden";document.body.appendChild(b);b.appendChild(g);b.appendChild(h);g.appendChild(e);h.appendChild(l);e.setAttribute("style","font-family:monospace !important");v.fontFamily=c+",monospace";k.fontSize=v.fontSize="24px";e.innerHTML=l.innerHTML=this.testString(a);e.offsetWidth!=l.offsetWidth&&(e.setAttribute("style","font-family:sans-serif !important"),v.fontFamily=c+",sans-serif",e.offsetWidth!=l.offsetWidth&&(e.setAttribute("style","font-family:serif !important"),
v.fontFamily=c+",serif"));a=e.offsetWidth!=l.offsetWidth;g.removeChild(e);h.removeChild(l);b.removeChild(g);b.removeChild(h);document.body.removeChild(b);return a};b.prototype.checkFontDescriptor=function(a){return"undefined"==typeof a||"string"!=typeof a.family?!0:this.checkFont(a)};b.instanceof=function(a,c){var b;if(a.Window)return"Window"==c;a.defaultView?b=a.defaultView[c]:a.ownerDocument?b=a.ownerDocument.defaultView[c]:a.target&&(this.instanceof(a.target,"Window")?b=a.target[c]:this.instanceof(a.target,
"Document")?b=a.target.defaultView[c]:this.instanceof(a.target,"HTMLElement")&&(b=a.target.ownerDocument.defaultView[c]));return b?a instanceof b:!1};return b}(),CachedContext=function(){function b(){this._cache=[]}b.prototype.reset=function(){this._cache=[]};b.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:this._cache[a][c]};b.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};
return b}(),Deadkey=function(){function b(a,c){this.p=a;this.d=c}b.prototype.match=function(a,c){this.matched=(a=this.p==a&&this.d==c)?1:0;return a};b.prototype.set=function(){this.matched=1};b.prototype.reset=function(){this.matched=0};return b}(),BeepData=function(){function b(a){this.e=a;this.c=a.style.backgroundColor}b.prototype.reset=function(){this.e.style.backgroundColor=this.c};return b}(),KeyboardInterface=function(){function b(a){this.cachedContext=new CachedContext;this.TSS_LAYER=33;this.TSS_PLATFORM=
31;this._AnyIndices=[];this._BeepObjects=[];this._BeepTimeout=0;this._DeadKeys=[];this._CacheCommands=function(a){var c=[new StyleCommand("backcolor",1),new StyleCommand("fontname",1),new StyleCommand("fontsize",1),new StyleCommand("forecolor",1),new StyleCommand("bold",0),new StyleCommand("italic",0),new StyleCommand("strikethrough",0),new StyleCommand("subscript",0),new StyleCommand("superscript",0),new StyleCommand("underline",0)];a.defaultView&&this.keymanweb._push(c,["hilitecolor",1]);for(var b=
0;b<c.length;b++)this.keymanweb._push(c[b],c[b][1]?a.queryCommandValue(c[b][0]):a.queryCommandState(c[b][0]));return c};this._CacheCommandsReset=function(a,b,f){for(var c=0;c<b.length;c++)b[c][1]?a.queryCommandValue(b[c][0])!=b[c][2]&&(f&&f(),a.execCommand(b[c][0],!1,b[c][2])):a.queryCommandState(b[c][0])!=b[c][2]&&(f&&f(),a.execCommand(b[c][0],!1,null))};this.clearDeadkeys=function(){this._DeadKeys=[]};this.keymanweb=a}b.prototype.saveFocus=function(){DOMEventHandlers.states._IgnoreNextSelChange=
1};b.prototype.insertText=function(a,c){this.resetContextCache();var b=this.keymanweb.domManager.getLastActiveElement();var f=!1;if(null!=b){f=b._KeymanWebSelectionStart;var g=b._KeymanWebSelectionEnd;this.keymanweb.uiManager.setActivatingUI(!0);DOMEventHandlers.states._IgnoreNextSelChange=100;this.keymanweb.domManager.focusLastActiveElement();b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&this.keymanweb.domManager._IsMozillaEditableIframe(b,0)&&(b=b.documentElement);
b._KeymanWebSelectionStart=f;b._KeymanWebSelectionEnd=g;DOMEventHandlers.states._IgnoreNextSelChange=0;null!=a&&this.output(0,b,a);"undefined"!==typeof c&&null!==c&&this.deadkeyOutput(0,b,c);b._KeymanWebSelectionStart=null;b._KeymanWebSelectionEnd=null;f=!0}return f};b.prototype.registerKeyboard=function(a){this.keymanweb.keyboardManager._registerKeyboard(a)};b.prototype.registerStub=function(a){return this.keymanweb.keyboardManager._registerStub(a)};b.prototype.context=function(a,b,d){var c=this.cachedContext.get(a,
b);if(null!==c)return c;d=this.keymanweb.KC_(a,b,d);this.cachedContext.set(a,b,d);return d};b.prototype.nul=function(a,b){return"\ufffe"===this.context(a+1,1,b)};b.prototype.contextMatch=function(a,b,d,f){if(this.context(a,f,b)===d)return!0;this._DeadkeyResetMatched();return!1};b.prototype.isKeypress=function(a){return this.keymanweb.keyboardManager.activeKeyboard.KM?!a.LisVirtualKey:this.keymanweb.keyMapManager._USKeyCodeToCharCode(a)?!0:!1};b.prototype.keyMatch=function(a,b,d){var c=!1,g=173==a.Lcode?
189:a.Lcode,h=this.keymanweb.keyboardManager.getKeyboardModifierBitmask(),e=h&this.keymanweb.osk.modifierBitmasks.ALL;h&=this.keymanweb.osk.stateBitmasks.ALL;255<a.vkCode&&(g=a.vkCode);if(a.LisVirtualKey||255<g){if(16384==(b&16384)||255<g)c=(c=d==g&&(b&e)==a.Lmodifiers)&&this.stateMatch(a,b&h)}else 0==(b&16384)&&(c=g==d);c||this._DeadkeyResetMatched();return c};b.prototype.stateMatch=function(a,b){return(b&a.Lstates)==b};b.prototype.keyInformation=function(a){var b=new KeyInformation;b.vk=a.LisVirtualKey;
b.code=a.Lcode;b.modifiers=a.Lmodifiers;return b};b.prototype.deadkeyMatch=function(a,b,d){if(0==this._DeadKeys.length)return!1;a=this._SelPos(b)-a;for(b=0;b<this._DeadKeys.length;b++)if(this._DeadKeys[b].match(a,d))return this._DeadKeys[b].set(),!0;this._DeadkeyResetMatched();return!1};b.prototype.beepReset=function(){this.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();this._BeepObjects=[]};b.prototype.beep=function(a){this.resetContextCache();
var b=a;b.defaultView&&a instanceof b.defaultView.Document&&(a=b.body);if(a.style&&"undefined"!=typeof a.style.backgroundColor){for(b=0;b<this._BeepObjects.length;b++)if(this._BeepObjects[b].e==a)return;this._BeepObjects=this.keymanweb._push(this._BeepObjects,new BeepData(a));a.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),50))}};b.prototype.any=function(a,b,d){if(""==b)return!1;b=d._kmwIndexOf(b);this._AnyIndices[a]=b;return 0<=
b};b.prototype.output=function(a,b,d){this.resetContextCache();if("oninserttext"in this.keymanweb)this.keymanweb.oninserttext(a,d);var c=b.body?b:b.ownerDocument;var g;if(0<=b.className.indexOf("keymanweb-input"))c=this.keymanweb.touchAliasing.getTextBeforeCaret(b),c=0<a?c._kmwSubstr(0,c._kmwLength()-a)+d:c+d,this.keymanweb.touchAliasing.setTextBeforeCaret(b,c);else{if(c&&(g=c.defaultView)&&g.getSelection&&("on"==c.designMode.toLowerCase()||"true"==b.contentEditable||"plaintext-only"==b.contentEditable||
""===b.contentEditable)){var h="on"==c.designMode.toLowerCase();if(h)var e=this._CacheCommands(c);var k=g.getSelection();g=k.focusNode.nodeValue?k.focusNode.substringData(0,k.focusOffset)._kmwLength():0;k.isCollapsed||k.deleteFromDocument();var l=k.getRangeAt(0);0<a&&(l.setStart(k.focusNode,k.focusOffset-k.focusNode.nodeValue.substr(0,k.focusOffset)._kmwSubstr(-a).length),l.deleteContents());if(0<d._kmwLength())if(3==k.focusNode.nodeType){l=k.focusOffset;k.focusNode.insertData(k.focusOffset,d);try{k.extend(k.focusNode,
l+d.length)}catch(p){k.focusNode.parentNode.scrollIntoView(),k.extend(k.focusNode,l+d.length)}}else{var v=c.createTextNode(d);l.insertNode(v);k.extend(v,d.length)}h&&this._CacheCommandsReset(c,e,null);k.collapseToEnd();0<=a&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(g,-a+d._kmwLength()))}else b.setSelectionRange&&(null!=b._KeymanWebSelectionStart?(g=b._KeymanWebSelectionStart,c=b._KeymanWebSelectionEnd):(g=b.value._kmwCodeUnitToCodePoint(b.selectionStart),c=b.value._kmwCodeUnitToCodePoint(b.selectionEnd)),
"textarea"==b.type.toLowerCase()&&"undefined"!=typeof b.scrollTop&&(h=b.scrollTop,k=b.scrollLeft),0>a?(b.value=b.value._kmwSubstring(0,g)+d+b.value._kmwSubstring(c),a=0):b.value=g<a?d+b.value._kmwSubstring(c):b.value._kmwSubstring(0,g-a)+d+b.value._kmwSubstring(c),0<=a&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(g,-a+d._kmwLength())),"undefined"!=typeof h&&(b.scrollTop=h,b.scrollLeft=k),a=g-a+d._kmwLength(),a=b.value._kmwCodePointToCodeUnit(a),b.setSelectionRange(a,a),b._KeymanWebSelectionStart=
null,b._KeymanWebSelectionEnd=null);"function"==typeof this.keymanweb.refreshElementContent&&this.keymanweb.refreshElementContent(b)}};b.prototype.deadkeyOutput=function(a,b,d){this.resetContextCache();0<=a&&this.output(a,b,"");a=new Deadkey(this._SelPos(b),d);this._DeadKeys=this.keymanweb._push(this._DeadKeys,a)};b.prototype.indexOutput=function(a,b,d,f){this.resetContextCache();this._AnyIndices[d-1]<b._kmwLength()&&this.output(a,f,b._kmwCharAt(this._AnyIndices[d-1]))};b.prototype.ifStore=function(a,
b,d){d=!0;if(a==this.TSS_LAYER)d=this.keymanweb.osk.layerId===b;else if(a==this.TSS_PLATFORM){var c=b.split(" ");for(a=0;a<c.length;a++){b=c[a].toLowerCase();switch(b){case "touch":case "hardware":this.keymanweb.util.activeDevice.touchable!=("touch"==b)&&(d=!1)}switch(b){case "windows":case "android":case "ios":case "macosx":case "linux":this.keymanweb.util.activeDevice.OS.toLowerCase()!=b&&(d=!1)}switch(b){case "tablet":case "phone":case "desktop":this.keymanweb.util.activeDevice.formFactor!=b&&
(d=!1)}switch(b){case "web":"native"==this.keymanweb.util.activeDevice.browser&&(d=!1);break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "opera":this.keymanweb.util.activeDevice.browser!=b&&(d=!1)}}}return d};b.prototype.setStore=function(a,b,d){this.resetContextCache();return a==this.TSS_LAYER?this.keymanweb.osk.showLayer(b):!1};b.prototype.loadStore=function(a,b,d){this.resetContextCache();a=this.keymanweb.util.loadCookie("KeymanWeb_"+a+"_Option_"+b);return"undefined"!=
typeof a[b]?decodeURI(a[b]):d};b.prototype.saveStore=function(a,b){this.resetContextCache();var c=this.keymanweb.keyboardManager.activeKeyboard;if(!c||"undefined"==typeof c.KI||""==c.KI)return!1;a="KeymanWeb_"+c.KI+"_Option_"+a;b=encodeURI(b);this.keymanweb.util.saveCookie(a,b);return!0};b.prototype.resetContextCache=function(){this.cachedContext.reset()};b.prototype._DeadkeyResetMatched=function(){var a,b=this._DeadKeys;for(a=0;a<b.length;a++)b[a].reset()};b.prototype._DeadkeyDeleteMatched=function(){var a,
b=this._DeadKeys;for(a=0;a<b.length;a++)b[a].matched&&b.splice(a,1)};b.prototype._DeadkeyAdjustPos=function(a,b){var c,f=this._DeadKeys;for(c=0;c<f.length;c++)f[c].p>a&&(f[c].p+=b)};b.prototype.processKeystroke=function(a,b,d){this.keymanweb._CachedSelectionStart=null;this._DeadkeyResetMatched();this.resetContextCache();this.keymanweb.util.activeDevice=a;return this.keymanweb.keyboardManager.activeKeyboard.gs(b,d)};b.prototype.getLastActiveElement=function(){return this.keymanweb.domManager.getLastActiveElement()};
b.prototype.focusLastActiveElement=function(){this.keymanweb.domManager.focusLastActiveElement()};b.prototype.hideHelp=function(){this.keymanweb.osk._Hide(!0)};b.prototype.showHelp=function(a,b){this.keymanweb.osk._Show(a,b)};b.prototype.showPinnedHelp=function(){this.keymanweb.osk.userPositioned=!0;this.keymanweb.osk._Show(-1,-1)};b.prototype.resetContext=function(){this.keymanweb.osk.layerId="default";this.clearDeadkeys();this.resetContextCache();this.resetVKShift();this.keymanweb.osk._Show()};
b.prototype._SelPos=function(a){var b,d;Device._GetIEVersion();if(this.keymanweb.isPositionSynthesized())return this.keymanweb.touchAliasing.getTextCaret(a);if(a._KeymanWebSelectionStart)return a._KeymanWebSelectionStart;if((b=a.ownerDocument)&&(d=b.defaultView))if(a instanceof d.HTMLInputElement||a instanceof d.HTMLTextAreaElement){if(a.setSelectionRange)return a.value.substr(0,a.selectionStart)._kmwLength()}else if(d.getSelection&&"on"==a.ownerDocument.designMode.toLowerCase()&&(a=d.getSelection(),
3==a.focusNode.nodeType))return a.focusNode.substringData(0,a.focusOffset)._kmwLength();return 0};b.prototype.resetVKShift=function(){this.keymanweb.uiManager.isActivating||this.keymanweb.osk._UpdateVKShift&&this.keymanweb.osk._UpdateVKShift(null,15,0)};return b}(),CloudRequestEntry=function(){function b(a,b){this.id=a;this.language=b}b.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};
return b}(),KeyboardFont=function(){return function(b,a){this.family=b.family;this.files=b.source;this.path=a}}(),KeyboardStub=function(){return function(b,a){this.KI="Keyboard_"+b;this.KLC=a}}(),KeyboardManager=function(){function b(a){this.activeStub=null;this.keyboardStubs=[];this.deferredStubs=[];this.deferredKRS=[];this.deferredKR=[];this.dfltStub=null;this.keyboards=[];this.languageList=null;this.languagesPending=[];this._GetKeyboardDetail=function(a){var b={};b.Name=a.KN;b.InternalName=a.KI;
b.LanguageName=a.KL;b.LanguageCode=a.KLC;b.RegionName=a.KR;b.RegionCode=a.KRC;b.CountryName=a.KC;b.CountryCode=a.KCC;b.KeyboardID=a.KD;b.Font=a.KFont;b.OskFont=a.KOskFont;return b};this.notifyKeyboard=function(a,b,f){var c=this.activeKeyboard;null!=c&&"function"==typeof c.KNS&&c.KNS(a,b,f)};this.keymanweb=a}b.prototype.getActiveKeyboardName=function(){return this.activeKeyboard?this.activeKeyboard.KI:""};b.prototype.getActiveLanguage=function(){return null==this.activeStub?"":this.activeStub.KLC};
b.prototype.getDetailedKeyboards=function(){var a=[],b;for(b=0;b<this.keyboardStubs.length;b++){var d=this.keyboardStubs[b];d=this._GetKeyboardDetail(d);a=this.keymanweb._push(a,d)}return a};b.prototype.registerDeferredStubs=function(){this.addKeyboardArray(this.deferredStubs);for(var a=0;a<this.deferredKRS.length;a++)this._registerStub(this.deferredKRS[a])};b.prototype.registerDeferredKeyboards=function(){for(var a=0;a<this.deferredKR.length;a++)this._registerKeyboard(this.deferredKR[a])};b.prototype.addStub=
function(a){if("string"!=typeof a.id)return!1;"undefined"!=typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var b=a.languages,d=[];"undefined"==typeof b.length?d[0]=b:d=b;var f={keyboardBaseUri:this.keymanweb.options.keyboards,
fontBaseUri:this.keymanweb.options.fonts};for(b=0;b<d.length;b++)this.mergeStub(a,d[b],f);return!0};b.prototype.mergeStub=function(a,c,d){var f=this.findStub(a.id,c.id);null==f&&(f=new KeyboardStub(a.id,c.id),this.keyboardStubs.push(f));var g=c.region,h=0;if("number"==typeof g)h=1>g||9<g?0:g-1;else if("string"==typeof g)for(var e=2==g.length?b.regionCodes:b.regions,k=0;k<e.length;k++)if(g.toLowerCase()==e[k].toLowerCase()){h=k;break}"undefined"==typeof f.KL&&(f.KL=c.name);"undefined"==typeof f.KR&&
(f.KR=b.regions[h]);"undefined"==typeof f.KRC&&(f.KRC=b.regionCodes[h]);"undefined"==typeof f.KN&&(f.KN=a.name);"undefined"==typeof f.KF&&(g=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,f.KF=a.filename,g.test(f.KF)||(f.KF=d.keyboardBaseUri+f.KF));a=d.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,g=/^https?\:/,g.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=
a;"undefined"==typeof f.KFont&&"undefined"!=typeof c.font&&(f.KFont=new KeyboardFont(c.font,a));"undefined"==typeof f.KOskFont&&"undefined"!=typeof c.oskFont&&(f.KOskFont=new KeyboardFont(c.oskFont,a));this.doKeyboardRegistered(f.KI,f.KL,f.KN,f.KLC,f.KP)};b.prototype.findStub=function(a,b){var c;for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI=="Keyboard_"+a&&this.keyboardStubs[c].KLC==b)return this.keyboardStubs[c];return null};b.prototype.setDefaultKeyboard=function(){return 0<
this.keyboardStubs.length?(this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC),!0):!1};b.prototype.setActiveKeyboard=function(a,b){this.doBeforeKeyboardChange(a,b);this._SetActiveKeyboard(a,b,!0);null!=this.keymanweb.domManager.getLastActiveElement()&&this.keymanweb.domManager.focusLastActiveElement();this.doKeyboardChange(a,b)};b.prototype._SetActiveKeyboard=function(a,b,d){var c,g,h=this.keymanweb.util,e=this.keymanweb.osk;if(2>arguments.length||!b)b="---";for(c=0;c<this.keyboardStubs.length&&
(a!=this.keyboardStubs[c].KI||b!=this.keyboardStubs[c].KLC&&"---"!=b);c++);h.device.touchable&&(""==a||null==a||c>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,b=this.keyboardStubs[0].KLC);2<arguments.length&&d&&this.saveCurrentKeyboard(a,b);if(!this.activeStub||!this.activeKeyboard||this.activeKeyboard.KI!=a||this.activeStub.KI!=a||this.activeStub.KLC!=b||this.keymanweb.mustReloadKeyboard){if(this.activeKeyboard&&this.activeKeyboard.KI==a)for(g=0;g<this.keyboardStubs.length;g++)if(this.keyboardStubs[g].KI==
a&&this.keyboardStubs[g].KLC==b){this.activeStub=this.keyboardStubs[g];e.appendStyleSheet();this.keymanweb.mustReloadKeyboard&&e._Load();return}this.activeStub=this.activeKeyboard=null;if(""==a)e._Hide(!1),this.keymanweb.isEmbedded||h.wait(!1);else{for(g=0;g<this.keyboards.length;g++)if(this.keyboards[g].KI==a){this.activeKeyboard=this.keyboards[g];this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement());for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI==
a&&(this.keyboardStubs[c].KLC==b||"---"==b)){this.activeStub=this.keyboardStubs[c];break}break}if(null==this.activeKeyboard){for(g=0;g<this.keyboardStubs.length;g++)if(this.keyboardStubs[g].KI==a&&(this.keyboardStubs[g].KLC==b||"---"==b)){if(this.isCJK(this.keyboardStubs[g])||h.device.touchable)e._Enabled=1;if(!this.keyboardStubs[g].asyncLoader){e.ready&&e._Hide(!1);var k=this.keyboardStubs[g];k.asyncLoader={};var l=k.KN,v=k.KL;l=l.replace(/\s*keyboard\s*/i,"");k.asyncLoader.callback=function(a,b){var c=
a||"Sorry, the "+l+" keyboard for "+v+" is not currently available.";this.keymanweb.isEmbedded||(h.wait(!1),h.alert(a||c,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(b){case "err":console.error(c);break;default:console.warn(c)}0<g&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);k.asyncLoader.timer=window.setTimeout(k.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||h.wait("Installing keyboard<br/>"+l);var p=this;window.setTimeout(function(){p.installKeyboard(k)},
0)}this.activeStub=this.keyboardStubs[g];return}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement())}c=this.activeKeyboard;null!==c&&String.kmwEnableSupplementaryPlane(c&&(c.KS&&1==c.KS||"Hieroglyphic"==c.KN));e._Load()}}};b.prototype.installKeyboard=function(a){var b=this.keymanweb.util,d=this.keymanweb.osk,f=b._CreateElement("script");f.charset="UTF-8";f.type="text/javascript";this.keymanweb.isEmbedded&&(f.id=a.KI);var g=a.KF,h=a.KL,e=a.KN,k=this;f.addEventListener("error",
function(){null!==a.asyncLoader.timer&&(window.clearTimeout(a.asyncLoader.timer),a.asyncLoader.timer=null);a.asyncLoader.callback("Cannot find the "+e+" keyboard for "+h+".","warn");a.asyncLoader=null},!1);f.addEventListener("load",function(){null!==a.asyncLoader.timer&&(window.clearTimeout(a.asyncLoader.timer),a.asyncLoader.timer=null);var c=k.getKeyboardByID(a.KI);c?a==k.activeStub&&(k.doBeforeKeyboardChange(c.KI,a.KLC),k.activeKeyboard=c,null!=k.keymanweb.domManager.getLastActiveElement()&&(k.keymanweb.uiManager.justActivated=
!0,k.keymanweb.domManager._SetTargDir(k.keymanweb.domManager.getLastActiveElement())),String.kmwEnableSupplementaryPlane(c&&(c.KS&&1==c.KS||"Hieroglyphic"==c.KN)),k.saveCurrentKeyboard(c.KI,a.KLC),d._Load(),k.keymanweb.isEmbedded||b.wait(!1)):a.asyncLoader.callback("Error registering the "+e+" keyboard for "+h+".","error");a.asyncLoader=null},!1);f.src=this.keymanweb.getKeyboardPath(g);try{document.body.appendChild(f)}catch(l){document.getElementsByTagName("head")[0].appendChild(f)}};b.prototype.saveCurrentKeyboard=
function(a,b){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b})};b.prototype.restoreCurrentKeyboard=function(){var a=this.keyboardStubs,b=a.length;if(!(1>a.length)){var d=this.getSavedKeyboard();d.split(":");var f=d.split(":");2>f.length&&(f[1]="");for(d=0;d<b&&(a[d].KI!=f[0]||a[d].KLC!=f[1]&&""!=f[1]);d++);if(d<b||null==this.activeKeyboard)this._SetActiveKeyboard(f[0],f[1],!1),this.keymanweb.globalKeyboard=f[0],this.keymanweb.globalLanguageCode=f[1],this.doKeyboardChange(f[0],
f[1])}};b.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");if("string"!=typeof a.current)return"Keyboard_us:eng";var b,d=this.keyboardStubs;for(b=0;b<d.length;b++){var f=d[b].KI+":"+d[b].KLC;if(f==a.current)return f}for(b=0;b<d.length;b++)if(f=d[b].KI+":"+d[b].KLC,"Keyboard_us:eng"==f)return f;return 0<d.length?d[0].KI+":"+d[0].KLC:"Keyboard_us:eng"};b.prototype.isCJK=function(a){var b=this.activeKeyboard,d="";0<arguments.length&&(b=a);b&&("undefined"!=
typeof b.KLC?d=b.KLC:"undefined"!=typeof b.LanguageCode&&(d=b.LanguageCode));return"cmn"==d||"jpn"==d||"kor"==d};b.prototype.isChiral=function(a){"string"==typeof a&&(a=this.getKeyboardByID(a));return!!(this.getKeyboardModifierBitmask(a)&this.keymanweb.osk.modifierBitmasks.IS_CHIRAL)};b.prototype.getKeyboardModifierBitmask=function(a){var b=this.activeKeyboard;0<arguments.length&&"undefined"!=typeof a&&(b=a);return b?b.KMBM?b.KMBM:this.keymanweb.osk.modifierBitmasks.NON_CHIRAL:0};b.prototype.getKeyboardByID=
function(a){var b;for(b=0;b<this.keyboards.length;b++)if(a==this.keyboards[b].KI)return this.keyboards[b];return null};b.prototype.isUniqueRequest=function(a,b){var c;if(null==this.findStub(b.id,b.language)){for(c=0;c<a.length;c++)if(a[c].id==b.id&&a[c].language==b.language)return!1;return!0}return!1};b.prototype.addKeyboardArray=function(a){if(!this.keymanweb.initialized)for(var b=0;b<a.length;b++)this.deferredStubs.push(a[b]);else if(0!=a.length){var d,f="",g=[];for(b=0;b<a.length;b++){if("string"==
typeof a[b]&&0<a[b].length){var h=a[b].split("@"),e=[""];"english"==h[0].toLowerCase()&&(h[0]="us");1<h.length&&(e=h[1].split(","));for(d=0;d<e.length;d++){var k=new CloudRequestEntry(h[0]);""!=e[d]&&(k.language=e[d]);2<h.length&&(k.version=h[2]);this.isUniqueRequest(g,k)&&g.push(k)}}if("object"==typeof a[b]&&null!=a[b])if("string"==typeof a[b].filename)this.addStub(a[b])||alert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");else if(a[b].language&&
(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[b].languages=a[b].language),e=a[b].languages,"number"==typeof e.length)for(d=0;d<e.length;d++)k=new CloudRequestEntry(a[b].id,a[b].languages[d].id),this.isUniqueRequest(g,k)&&g.push(k);else k=new CloudRequestEntry(a[b].id,a[b].languages[d].id),this.isUniqueRequest(g,k)&&g.push(k)}if(0!=g.length){a="&keyboardid=";for(b=0;b<g.length;b++)a=a+f+g[b].toString(),f=",";this.keymanCloudRequest(a,
!1)}}};b.prototype.registerLanguagesForKeyboard=function(a,b,d){var c,g=0;var h="";if("undefined"!=typeof a)if("string"==typeof b.keyboardid&&(h=b.keyboardid.split(",")[d]),"number"==typeof a.length)if(1==a.length||"$"==h.substr(-1,1)||""==h)for(h=0;h<a.length;h++)this.registerLanguagesForKeyboard(a[h],b,d);else{for(h=0;h<a.length;h++){var e=a[h].id.toLowerCase();"us"==e&&(e="english");for(c=0;c<a[h].languages.length;c++)if(e==a[h].languages[c].name.toLowerCase()){g=h;break}}this.registerLanguagesForKeyboard(a[g],
b,d)}else if(d=h.split("@")[1],"string"==typeof d&&(d=d.replace(/\$$/,"")),g=a.languages,"undefined"!=typeof g)if("number"==typeof g.length)for(h=0;h<g.length;h++)"undefined"!=typeof d&&g[h].id!=d||this.mergeStub(a,g[h],b);else this.mergeStub(a,g,b)};b.prototype.register=function(a){var b=a.options;a.timerid&&window.clearTimeout(a.timerid);if("string"==typeof a.error)b="","string"==typeof a.keyboardid&&(b=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),this.serverUnavailable(b+" keyboard not found.");
else if("undefined"!=typeof b&&"undefined"!=typeof b.context)if("keyboard"==b.context){var d=a.keyboard;if("number"==typeof d.length)for(a=0;a<d.length;a++)this.registerLanguagesForKeyboard(d[a],b,a);else this.registerLanguagesForKeyboard(d,b,0)}else"language"==b.context&&(this.languageList=a.languages,this.languagesPending&&this.addLanguageKeyboards(this.languagesPending),this.languagesPending=[])};b.prototype.addLanguageKeyboards=function(a){var b,d;if(null==this.languageList){var f=0==this.languagesPending.length;
for(b=0;b<a.length;b++)this.languagesPending.push(a[b]);f&&this.keymanCloudRequest("",!0)}else{var g="";for(b=0;b<a.length;b++){var h=a[b].toLowerCase();(d="$"==h.substr(-1,1))&&(h=h.substr(0,h.length-1));for(f=0;f<this.languageList.length;f++)if(h==this.languageList[f].name.toLowerCase()){""!=g&&(g+=",");g=g+"@"+this.languageList[f].id;d&&(g+="$");break}}""==g?this.keymanweb.util.alert("No keyboards are available for "+a[0]+". Does it have another language name?"):this.keymanCloudRequest("&keyboardid="+
g,!1)}};b.prototype.keymanCloudRequest=function(a,b){var c="https://api.keyman.com/cloud/4.0/",f=this.keymanweb.util._CreateElement("script");c=c+(1<arguments.length&&b?"languages":"keyboards")+"?jsonp=keyman.register&languageidtype=bcp47&version="+this.keymanweb.version+"."+KeymanBase.__BUILD__;var g=this;var h="&timerid="+window.setTimeout(function(){g.serverUnavailable(a)},1E4);f.charset="UTF-8";f.src=c+a+h;f.type="text/javascript";try{document.body.appendChild(f)}catch(e){document.getElementsByTagName("head")[0].appendChild(f)}};
b.prototype.serverUnavailable=function(a){this.keymanweb.util.alert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};b.prototype.removeKeyboards=function(a){if(0==arguments.length)return!1;var b,d,f=!0,g=!1,h=!1;for(b=0;b<arguments.length;b++){for(d=this.keyboardStubs.length-1;0<=d;d--)if("Keyboard_"+arguments[b]==this.keyboardStubs[d].KI){"Keyboard_"+arguments[b]==this.getActiveKeyboardName()&&(g=!0);h=!0;this.keyboardStubs.splice(d,1);break}0>d&&(f=!1)}g&&(0<this.keyboardStubs.length?
this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);h&&this.doKeyboardUnregistered();return f};b.prototype._registerKeyboard=function(a){if(this.keymanweb.initialized){var b;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(a);var d=this.activeStub,f=this.activeStub;if(!(d&&"KI"in d)||d.KI!=a.KI)for(b=0;b<this.keyboardStubs.length;b++){d=this.keyboardStubs[b];if(a.KI==d.KI)break;d=null}null==
this.activeStub&&null!=d&&(this.activeStub=d);for(b=0;b<this.keyboards.length;b++)if(a.KI==this.keyboards[b].KI)return;this.keyboards=this.keymanweb._push(this.keyboards,a);this.doKeyboardLoaded(a.KI);this.activeStub=f}else this.deferredKR.push(a)};b.prototype._registerStub=function(a){var b;if(!this.keymanweb.initialized)return this.deferredKRS.push(a),null;null==this.dfltStub&&(this.dfltStub=a);this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==
typeof a.KL&&(a.KL="undefined");for(b=0;b<this.keyboardStubs.length;b++)if(this.keyboardStubs[b].KI==a.KI&&(""==a.KLC||this.keyboardStubs[b].KLC==a.KLC))return 1;this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a);this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,a.KP);return null};b.prototype.doKeyboardRegistered=function(a,b,d,f,g){a={internalName:a,language:b,keyboardName:d,languageCode:f};g&&(a["package"]=g);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};b.prototype.doKeyboardUnregistered=
function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};b.prototype.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",b)};b.prototype.doBeforeKeyboardChange=function(a,b){var c={};c.internalName=a;c.languageCode=b;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",c)};b.prototype.doKeyboardChange=function(a,b,d){var c={};c.internalName=a;c.languageCode=b;c.indirect=2<arguments.length?d:!1;return this.keymanweb.util.callEvent("kmw.keyboardchange",
c)};b.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");b.regionCodes="un af as eu sa na oc ca me".split(" ");return b}(),KeyMap=function(){return function(){}}(),BrowserKeyMaps=function(){return function(){this.FF=new KeyMap;this.Safari=new KeyMap;this.Opera=new KeyMap;this.FF.k61=187;this.FF.k59=186}}(),LanguageKeyMaps=function(){return function(){this.se=new KeyMap;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=
221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new KeyMap;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),KeyMapManager=function(){function b(){this.browserMap=new BrowserKeyMaps;this.languageMap=new LanguageKeyMaps;this._usCodeInit()}b.prototype._usCodeInit=function(){var a=new KeyMap,b=new KeyMap;a.k192=96;a.k49=49;a.k50=50;a.k51=51;a.k52=52;a.k53=53;a.k54=54;a.k55=55;a.k56=56;a.k57=57;a.k48=48;a.k189=45;a.k187=61;a.k81=113;a.k87=119;a.k69=101;a.k82=114;a.k84=
116;a.k89=121;a.k85=117;a.k73=105;a.k79=111;a.k80=112;a.k219=91;a.k221=93;a.k220=92;a.k65=97;a.k83=115;a.k68=100;a.k70=102;a.k71=103;a.k72=104;a.k74=106;a.k75=107;a.k76=108;a.k186=59;a.k222=39;a.k90=122;a.k88=120;a.k67=99;a.k86=118;a.k66=98;a.k78=110;a.k77=109;a.k188=44;a.k190=46;a.k191=47;b.k192=126;b.k49=33;b.k50=64;b.k51=35;b.k52=36;b.k53=37;b.k54=94;b.k55=38;b.k56=42;b.k57=40;b.k48=41;b.k189=95;b.k187=43;b.k81=81;b.k87=87;b.k69=69;b.k82=82;b.k84=84;b.k89=89;b.k85=85;b.k73=73;b.k79=79;b.k80=80;
b.k219=123;b.k221=125;b.k220=124;b.k65=65;b.k83=83;b.k68=68;b.k70=70;b.k71=71;b.k72=72;b.k74=74;b.k75=75;b.k76=76;b.k186=58;b.k222=34;b.k90=90;b.k88=88;b.k67=67;b.k86=86;b.k66=66;b.k78=78;b.k77=77;b.k188=60;b.k190=62;b.k191=63;this._usCharCodes=[a,b]};b.prototype._USKeyCodeToCharCode=function(a){return this._usCharCodes[a.Lmodifiers&16?1:0]["k"+a.Lcode]};return b}(),Hotkey=function(){function b(a,b,d){this.code=a;this.shift=b;this.handler=d}b.prototype.matches=function(a,b){return this.code==a&&this.shift==
b};return b}(),HotkeyManager=function(){function b(a){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var b=this.keyman.domManager.nonTouchHandlers._GetEventKeyCode(a);if(null==b)return!1;for(var c=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),g=0;g<this.hotkeys.length;g++)if(this.hotkeys[g].matches(b,c))return this.hotkeys[g].Handler(),a.returnValue=!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=a}b.prototype.addHotKey=function(a,
b,d){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].code==a&&this.hotkeys[c].shift==b){this.hotkeys[c].handler=d;return}this.hotkeys.push(new Hotkey(a,b,d))};b.prototype.removeHotkey=function(a,b){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].matches(a,b)){this.hotkeys.splice(c,1);break}};return b}(),UIState=function(){return function(b,a){this.activationPending=b;this.activated=a}}(),UIManager=function(){function b(a){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",
{})};this.keyman=a}b.prototype.getUIState=function(){return new UIState(this.isActivating,this.justActivated)};b.prototype.setActivatingUI=function(a){this.isActivating=a?!0:!1};b.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};return b}(),KeymanBase=function(){function b(){this._TitleElement=null;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=
this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=!1;this.refocusTimer=0;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null};this.refreshElementContent=null;this.util=this.util=new Util(this);window.KeymanWeb=this.interface=this["interface"]=new KeyboardInterface(this);this.osk=this.osk={ready:!1};this.ui=this.ui=null;this.keyboardManager=new KeyboardManager(this);this.domManager=new DOMManager(this);
this.hotkeyManager=new HotkeyManager(this);this.uiManager=new UIManager(this);this.keyMapManager=new KeyMapManager;this.build=b.__BUILD__;this.srcPath=b._srcPath;this.rootPath=b._rootPath;this.protocol=b._protocol;this.version="10.0";this.helpURL="http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}b.prototype.setDefaultDeviceOptions=function(a){};b.prototype.getStyleSheetPath=function(a){return a};b.prototype.getKeyboardPath=function(a,b){return a};b.prototype.KC_=function(a,b,d){return""};
b.prototype.handleRotationEvents=function(){};b.prototype.alignInputs=function(a){};b.prototype.namespaceID=function(a){};b.prototype.preserveID=function(a){};b.prototype.setInitialized=function(a){this.initialized=this.initialized=a};b.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};b.prototype.shutdown=function(){this.domManager.shutdown();this.osk.shutdown()};b.prototype.isFontAvailable=function(a){return this.util.checkFont({family:a})};
b.prototype.addEventListener=function(a,b){return this.util.addEventListener("kmw."+a,b)};b.prototype._GetEventObject=function(a){if(!a&&(a=window.event,!a)){var b=this.domManager.getLastActiveElement();if(b){b=b.ownerDocument;if(b)var d=b.defaultView;if(!d)return null;a=d.event}}return a};b.prototype._push=function(a,b){a.push?a.push(b):a=a.concat(b);return a};b.prototype.attachToControl=function(a){this.domManager.attachToControl(a)};b.prototype.detachFromControl=function(a){this.domManager.detachFromControl(a)};
b.prototype.addKeyboards=function(a){0==arguments.length?this.keyboardManager.keymanCloudRequest("",!1):this.keyboardManager.addKeyboardArray(arguments)};b.prototype.addKeyboardsForLanguage=function(a){this.keyboardManager.addLanguageKeyboards(arguments)};b.prototype.register=function(a){this.keyboardManager.register(a)};b.prototype.removeKeyboards=function(a){return this.keyboardManager.removeKeyboards(a)};b.prototype.setActiveKeyboard=function(a,b){this.keyboardManager.setActiveKeyboard(a,b)};b.prototype.getActiveKeyboard=
function(){return this.keyboardManager.getActiveKeyboardName()};b.prototype.getActiveLanguage=function(){return this.keyboardManager.getActiveLanguage()};b.prototype.isAttached=function(a){return this.domManager.isAttached(a)};b.prototype.isCJK=function(a){return this.keyboardManager.isCJK(a)};b.prototype.isChiral=function(a){return this.keyboardManager.isChiral(a)};b.prototype.getKeyboard=function(a,b){var c,f=this.keyboardManager.getDetailedKeyboards();for(c=0;c<f.length;c++){var g=f[c];if(g.InternalName==
a||g.InternalName=="Keyboard_"+a)if(2>arguments.length||g.LanguageCode==b)return g}return null};b.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};b.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};b.prototype.init=function(a){this.domManager.init(a)};b.prototype.resetContext=function(){this.interface.resetContext()};b.prototype.disableControl=function(a){this.domManager.disableControl(a)};b.prototype.enableControl=function(a){this.domManager.enableControl(a)};
b.prototype.setKeyboardForControl=function(a,b,d){this.domManager.setKeyboardForControl(a,b,d)};b.prototype.getKeyboardForControl=function(a){this.domManager.getKeyboardForControl(a)};b.prototype.getLanguageForControl=function(a){this.domManager.getLanguageForControl(a)};b.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};b.prototype.getLastActiveElement=function(){return this.domManager.getLastActiveElement()};b.prototype.setActiveElement=function(a,b){return this.domManager.setActiveElement(a,
b)};b.prototype.moveToElement=function(a){this.domManager.moveToElement(a)};b.prototype.addHotKey=function(a,b,d){this.hotkeyManager.addHotKey(a,b,d)};b.prototype.removeHotKey=function(a,b){this.hotkeyManager.removeHotkey(a,b)};b.prototype.getUIState=function(){return this.uiManager.getUIState()};b.prototype.activatingUI=function(a){this.uiManager.setActivatingUI(a)};return b}(),scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+
1);KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");KeymanBase.__BUILD__=60;window.keyman&&window.keyman.loaded||function(){var b=window.keyman=new KeymanBase,a=b.osk;b.ui={};a.highlightSubKeys=function(a,b,f){};a.createKeyTip=function(){};a.optionKey=function(a,b,f){};a.showKeyTip=function(a,b){};a.waitForFonts=function(a,b){return!0}}();
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,c=b.util;b.debug=b.debug=function(a){if(null==b.debugElement){var c=document.createElement("DIV");var d=c.style;d.position="absolute";d.width="30%";d.maxHeight="50%";d.top="0";d.right="0";d.minHeight="50px";d.border="1px solid blue";d.whiteSpace="pre-line";d.overflowY="scroll";d=document.createElement("P");d.id="debug_output";d.style.margin="2px";c.appendChild(d);document.body.appendChild(c);b.debugElement=d}if(null!=(d=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof d.textContent?d.textContent="":d.innerHTML="";else{c=(new Date).toTimeString().substr(3,5)+" ";var h,e;for(h=0;h<arguments.length;h++){0<h&&(c+="; ");var k=arguments[h];if("object"==typeof k)if(null==k)c+="null";else{var l="";for(e in k){0<l.length&&(l+=", ");l=l+e+":";switch(typeof k[e]){case "string":case "number":case "boolean":l+=k[e];break;default:l+=typeof k[e]}if(1024<l.length){l=l.substr(0,1E3)+"...";break}}0<l.length&&(c=c+"{"+l+"}")}else c+=k}1500<c.length&&
(c=c.substr(0,1500)+" (more)");"undefined"!=typeof d.textContent?d.textContent=c+"\n"+d.textContent:d.innerHTML=c+"<br />"+d.innerHTML}};b.debugElement=null;b.delayedInit();a._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";b._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");c.attachDOMEvent(window,"load",b.domManager._WindowLoad,!1);c.attachDOMEvent(window,"unload",b.domManager._WindowUnload,!1);c.attachDOMEvent(document,"keyup",b.hotkeyManager._Process,
!1);c.attachDOMEvent(window,"focus",b.interface.resetVKShift.bind(b.interface),!1);c.attachDOMEvent(window,"blur",b.interface.resetVKShift.bind(b.interface),!1);String.kmwEnableSupplementaryPlane(!1)}();var OSKKeySpec=function(){return function(b,a,c,d,f,g){this.id=b;this.text=a;this.width=c?c:"50";this.sp=d;this.nextlayer=f;this.pad=g}}();
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,c=b.util,d=c.device,f=b["interface"];a.modifierCodes={LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384};a.modifierBitmasks={ALL:127,ALT_GR_SIM:a.modifierCodes.LCTRL|a.modifierCodes.LALT,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112};a.stateBitmasks={ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288};a.keyCodes={K_BKSP:8,K_TAB:9,
K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,K_SPACE:32,K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,K_NP2:98,K_NP3:99,
K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,K_NPPLUS:107,K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,K_QUOTE:222,K_oE2:226,
K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,K_CURRENCIES:50005,K_UPPER:50006,K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012};a.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};a.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,"*Shifted*":8,"*AltGr*":2,
"*TabLeft*":7,"*LAlt*":86,"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112};a.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*","leftctrl-leftalt-shift":"*LAltCtrlShift*","rightctrl-rightalt-shift":"*RAltCtrlShift*",
"shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};var g=[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']],h="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
a._Box=null;a._DivVKbd=null;a._DivVKbdHelp=null;a._Visible=0;a._Enabled=1;a._VShift=[];a._VKeySpans=[];a._VKeyDown=null;a._VKbdContainer=null;a._VOriginalWidth=1;a._BaseLayout="us";a._BaseLayoutEuro={};a._BaseLayoutEuro.se="\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ";a._BaseLayoutEuro.uk="`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ ";a._stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};a.lgTimer=null;a.lgKey=null;a.hkKey=null;
a.spaceBar=null;a.lgList=null;a.frameColor="#ad4a28";a.keyPending=null;a.fontFamily="";a.fontSize="1em";a.layout=null;a.layers=null;a.layerId="default";a.nextLayer="default";a.layerIndex=0;a.currentKey="";a.subkeyDelayTimer=null;a.popupPending=!1;a.popupVisible=!1;a.popupCallout=null;a.styleSheet=null;a.loadRetry=0;a.popupDelay=500;a.currentTarget=null;a.touchCount=0;a.touchX=0;a.deleting=0;a.x=99;a.y=0;a.width=1;a.height=1;a.rowHeight=1;a.nRows=1;a.vpScale=1;a.closeButton=null;a.resizeIcon=null;
a.resizing=0;a.pinImg=null;a.userPositioned=0;a.dfltX="";a.dfltY="";a.noDrag=!1;a.keytip=null;a.touchY=0;a.addCallout=function(a){};a.shutdown=function(){var b=a._Box;b.parentElement&&b.parentElement.removeChild(b)};a.addEventListener=function(a,b){return c.addEventListener("osk."+a,b)};a._TitleBarInterior=function(){var e=c._CreateElement("DIV"),k=e.style;k.paddingLeft="2px";k.cursor="move";k.background="#ad4a28";k.font="8pt Tahoma,Arial,sans-serif";k=c._CreateElement("DIV");k.className="kmw-title-bar-actions";
k.onmousedown=a._CancelMouse;var l=c._CreateElement("DIV");l.className="kmw-close-button";l.onmousedown=a._CancelMouse;l.onclick=function(){a._Hide(!0)};a.closeButton=l;k.appendChild(l);a.restorePosition=function(){a._Visible&&(b.domManager.focusLastActiveElement(),a.loadCookie(),a.userPositioned=!1,a.saveCookie(),a._Show(),a.doResizeMove());a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)};l=a.pinImg=c._CreateElement("DIV");l.className="kmw-pin-image";l.title=
"Pin the On Screen Keyboard to its default location on the active text box";l.onclick=a.restorePosition;l.onmousedown=a._CancelMouse;l.style.display="none";d.touchable||k.appendChild(l);e.appendChild(k);l=b._TitleElement=c._CreateElement("SPAN");l.className="kmw-title-bar-caption";l.innerHTML="KeymanWeb";e.appendChild(l);return e};a.isEnabled=a.isEnabled=function(){return a._Enabled};a.isVisible=a.isVisible=function(){return a._Visible};a.getRect=a.getRect=function(){var b={};a._DivVKbd?(b.left=b.left=
c._GetAbsoluteX(a._DivVKbd),b.top=b.top=c._GetAbsoluteY(a._DivVKbd),b.width=b.width=c._GetAbsoluteX(a._DivVKbdHelp)-c._GetAbsoluteX(a._DivVKbd)+a._DivVKbdHelp.offsetWidth,b.height=b.height=c._GetAbsoluteY(a._DivVKbdHelp)-c._GetAbsoluteY(a._DivVKbd)+a._DivVKbdHelp.offsetHeight):(b.left=b.left=c._GetAbsoluteX(a._Box),b.top=b.top=c._GetAbsoluteY(a._Box),b.width=b.width=c._GetAbsoluteX(a._Box)+a._Box.offsetWidth,b.height=b.height=c._GetAbsoluteY(a._Box)+a._Box.offsetHeight);return b};a.setRect=a.setRect=
function(b){if(null!=a._Box&&"desktop"==d.formFactor){var e=a._Box,l=e.style;"left"in b&&(l.left=b.left-c._GetAbsoluteX(e)+e.offsetLeft+"px",a.dfltX=l.left);"top"in b&&(l.top=b.top-c._GetAbsoluteY(e)+e.offsetTop+"px",a.dfltY=l.top);if(null!=a._DivVKbd){var f=a._DivVKbd;l=f.style;if("width"in b){var g=b.width-(e.offsetWidth-f.offsetWidth);g<.2*screen.width&&(g=.2*screen.width);g>.9*screen.width&&(g=.9*screen.width);l.width=g+"px";a.width=g}"height"in b&&(e=b.height-(e.offsetHeight-f.offsetHeight),
e<.1*screen.height&&(e=.1*screen.height),e>.5*screen.height&&(e=.5*screen.height),l.height=e+"px",l.fontSize=e/8+"px",a.height=e);"nosize"in b&&a.resizeIcon&&(a.resizeIcon.style.display=b.nosize?"none":"block")}"nomove"in b&&(a.noDrag=b.nomove,a.pinImg&&(a.pinImg.style.display=b.nomove||!a.userPositioned?"none":"block"));a.saveCookie()}};a.getPos=function(){var b=a._Box;return{left:a._Visible?b.offsetLeft:a.x,top:a._Visible?b.offsetTop:a.y}};a.setPos=a.setPos=function(b){if("undefined"!=typeof a._Box&&
!d.touchable){if(a.userPositioned){var c=b.left;b=b.top;"undefined"!=typeof c&&(c<-.8*a._Box.offsetWidth&&(c=-.8*a._Box.offsetWidth),a.userPositioned&&(a._Box.style.left=c+"px",a.x=c));"undefined"!=typeof b&&(0>b&&(b=0),a.userPositioned&&(a._Box.style.top=b+"px",a.y=b))}a.pinImg&&(a.pinImg.style.display=a.userPositioned?"block":"none")}};a._VKeyGetTarget=function(a){a=b._GetEventObject(a);a=c.eventTarget(a);if(null==a)return null;3==a.nodeType&&(a=a.parentNode);"SPAN"==a.tagName&&(a=a.parentNode);
return a};a.highlightKey=function(b,c){if(b&&""!=b.className&&!(0<=b.className.indexOf("kmw-key-row"))){var e=b.className;null!=a.keytip&&0>e.indexOf("kmw-key-shift")&&0>e.indexOf("kmw-spacebar")&&0>b.id.indexOf("popup")?a.showKeyTip(b,c):c&&0>e.indexOf(" kmw-key-touched")?(b.className=e+" kmw-key-touched",a.showKeyTip(null,!1)):b.className=e.replace(" kmw-key-touched","")}};a.showSubKeys=function(b){if(null!=a.keyPending){var e=document.createElement("DIV"),l=a.getDefaultKeyObject();e.id="kmw-popup-keys";
a.popupBaseKey=b;"phone"==d.formFactor&&a.prependBaseKey(b);var f=b.id.split("-");var g=f[f.length-1];if("phone"==d.formFactor&&b.subKeys[0].id!=g){g={id:g,layer:""};1<f.length&&(g.layer=f[0]);for(f=0;f<b.childNodes.length&&!a.hasClass(b.childNodes[f],"kmw-key-text");f++);f<b.childNodes.length&&(g.text=b.childNodes[f].textContent);b.subKeys.splice(0,0,g)}f=e.style;f.bottom=parseInt(b.style.bottom,10)+parseInt(b.style.height,10)+4+"px";f.fontFamily=a.fontFamily;f.fontSize=c.getStyleValue(b,"font-size");
f.visibility="hidden";g=b.subKeys.length;var h=Math.min(Math.ceil(g/9),2);var n=Math.ceil(g/h);1<h&&(f.width=n*b.offsetWidth+5*n+"px");for(f=0;f<g;f++){var m=b.subKeys[f];var r=document.createElement("DIV");for(var t in l)"string"!=typeof m[t]&&(m[t]=l[t]);r.className="kmw-key-square-ex";r.keyId=m.id;var u=r.style;var A=Math.floor(f/n);1<h&&0<A&&(u.marginTop="5px");r.width="undefined"!=typeof m.width?u.width=parseInt(m.width,10)*b.offsetWidth/100+"px":u.width=b.offsetWidth+"px";u.height=b.offsetHeight+
"px";A=document.createElement("DIV");a.setButtonClass(m,A);A.id="string"==typeof m.layer&&""!=m.layer?"popup-"+m.layer+"-"+m.id:"popup-"+a.layerId+"-"+m.id;A.key=m;var D=A.style;D.height=u.height;D.width=u.width;D.position="absolute";u=c._CreateElement("SPAN");u.className="kmw-key-text";null==m.text||""==m.text?(u.innerHTML="\u00a0","string"==typeof m.id&&/^U_[0-9A-F]{4}$/i.test(m.id)&&(u.innerHTML=String.fromCharCode(parseInt(m.id.substr(2),16)))):u.innerHTML=m.text;D=u.style;D.fontSize=a.fontSize;
"string"==typeof m.font&&""!=m.font&&(D.fontFamily=m.font);"string"==typeof m.fontsize&&0!=m.fontsize&&(D.fontSize=m.fontsize);A.appendChild(u);r.appendChild(A);e.appendChild(r)}a.showKeyTip(null,!1);a._Box.appendChild(e);f=e.style;l=c._GetAbsoluteX(b)+.5*(b.offsetWidth-e.offsetWidth);t=(c.landscapeView()?screen.height:screen.width)-e.offsetWidth;l>t&&(l=t);0>l&&(l=0);f.left=l+"px";a.popupCallout=a.addCallout(b);f.visibility="visible";e.shim=document.createElement("DIV");e.shim.id="kmw-popup-shim";
a._Box.appendChild(e.shim);"phone"==d.formFactor&&(b=e.childNodes[0].firstChild,a.keyPending=b,a.highlightKey(b,!0))}};a.prependBaseKey=function(b){if(b&&"undefined"!=typeof b.id){var c=b.id.split("-");var e=c[c.length-1],d=1<c.length?c[0]:"";if("undefined"!=typeof b.subKeys&&0<b.subKeys.length&&(b.subKeys[0].id!=e||b.subKeys[0].layer!=d)){e={id:e,layer:""};1<c.length&&(e.layer=c[0]);for(c=0;c<b.childNodes.length&&!a.hasClass(b.childNodes[c],"kmw-key-text");c++);c<b.childNodes.length&&(e.text=b.childNodes[c].textContent);
b.subKeys.splice(0,0,e)}}};a.getVKDictionaryCode=function(a){var c=b.keyboardManager.activeKeyboard;if(!c.VKDictionary){var e=[];if("string"==typeof c.KVKD)for(var d=c.KVKD.split(" "),f=0;f<d.length;f++)e[d[f]]=f+256;c.VKDictionary=e}return(a=c.VKDictionary[a])?a:0};a.selectLayer=function(c,k){var e=2>arguments.length?null:k,f=b.keyboardManager.isChiral();"number"==typeof e&&(e=a.getLayerId(16*e));if(!e)switch(c){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":e="shift";break;case "K_LCONTROL":case "K_LCTRL":if(f){e=
"leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(f){e="rightctrl";break}case "K_CTRL":e="ctrl";break;case "K_LMENU":case "K_LALT":if(f){e="leftalt";break}case "K_RMENU":case "K_RALT":if(f){e="rightalt";break}case "K_ALT":e="alt";break;case "K_ALTGR":e=f?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":e="default"}if(!e||e==a.layerId&&"desktop"!=d.formFactor)return!1;a.updateLayer(e);a._Show();return!0};a.defaultKeyOutput=
function(c,k,d,h,p){var e="",l=!1,v=p&&"undefined"!=typeof p.base;0==d?l=!0:d==a.modifierCodes.SHIFT&&(l=!0,d=1);if(v||h)switch((v=a.keyCodes[c])||(v=k),v){case a.keyCodes.K_BKSP:f.output(1,b.domManager.getLastActiveElement(),"");break;case a.keyCodes.K_TAB:b.domManager.moveToNext(d);break;case a.keyCodes.K_TABBACK:b.domManager.moveToNext(!0);break;case a.keyCodes.K_TABFWD:b.domManager.moveToNext(!1);break;case a.keyCodes.K_ENTER:if("TEXTAREA"==p.nodeName||"undefined"!=typeof p.base&&"TEXTAREA"==
p.base.nodeName)return"\n";h&&("INPUT"!=p.nodeName||"search"!=p.type&&"submit"!=p.type?"undefined"==typeof p.base||"search"!=p.base.type&&"submit"!=p.base.type?b.domManager.moveToNext(!1):(p.base.disabled=!1,p.base.form.submit()):p.form.submit());break;case a.keyCodes.K_SPACE:return" "}"U_"==c.substr(0,2)?(c=parseInt(c.substr(2,6),16),0<=c&&31>=c||128<=c&&159>=c?console.log("Suppressing Unicode control code: U_00"+c.toString(16)):e=String.kmwFromCharCode(c)):l&&(k>=a.keyCodes.K_0&&k<=a.keyCodes.K_9?
e=g[d][0][k-a.keyCodes.K_0]:k>=a.keyCodes.K_A&&k<=a.keyCodes.K_Z?e=String.fromCharCode(k+(d?0:32)):k>=a.keyCodes.K_COLON&&k<=a.keyCodes.K_BKQUOTE?e=g[d][1][k-a.keyCodes.K_COLON]:k>=a.keyCodes.K_LBRKT&&k<=a.keyCodes.K_QUOTE&&(e=g[d][2][k-a.keyCodes.K_LBRKT]));return e};a.clickKey=function(e){var k=b.domManager.getLastActiveElement(),l,g=b.keyboardManager.activeKeyboard;var h=e.id.split("-");if(2>h.length)return!0;"popup"==h[0]&&h.splice(0,1);if(null!=k){var w=h[0],n=h[h.length-1],m=l=a.getModifierState(a.layerId);
for(l=1;l<h.length-1;l++)w=w+"-"+h[l];"undefined"!=typeof e.key&&(m=e.key.nextlayer);b.domManager.initActiveElement(k);if("K_LOPT"==n||"K_ROPT"==n)return a.optionKey(e,n,!0),!0;a.highlightKey(e,!1);if("desktop"==d.formFactor&&a.selectLayer(n,m))return!0;h=k._KeymanWebSelectionStart;l=k._KeymanWebSelectionEnd;b.uiManager.setActivatingUI(!0);DOMEventHandlers.states._IgnoreNextSelChange=100;b.domManager.focusLastActiveElement();b.domManager._IsMozillaEditableIframe(k,0)&&(k=k.documentElement);k._KeymanWebSelectionStart=
h;k._KeymanWebSelectionEnd=l;DOMEventHandlers.states._IgnoreNextSelChange=0;b._CachedSelectionStart=null;f._DeadkeyDeleteMatched();h={Ltarg:k,Lmodifiers:0,Lstates:0,Lcode:a.keyCodes[n],LisVirtualKey:!0};h.Lstates|=a._stateKeys.K_CAPS?a.modifierCodes.CAPS:a.modifierCodes.NO_CAPS;h.Lstates|=a._stateKeys.K_NUMLOCK?a.modifierCodes.NUM_LOCK:a.modifierCodes.NO_NUM_LOCK;h.Lstates|=a._stateKeys.K_SCROLL?a.modifierCodes.SCROLL_LOCK:a.modifierCodes.NO_SCROLL_LOCK;"U_"==n.substr(0,2)&&(h.LisVirtualKey=!1);"undefined"==
typeof h.Lcode&&(h.Lcode=a.getVKDictionaryCode(n),h.Lcode||(h.Lcode=1));l="undefined"==typeof e.key?null:e.key.layer;l=null==l?a.getModifierState(w):a.getModifierState(l);h.Lmodifiers=l;(h.Lmodifiers&a.modifierBitmasks.ALT_GR_SIM)==a.modifierBitmasks.ALT_GR_SIM&&a.emulatesAltGr()&&(h.Lmodifiers&=~a.modifierBitmasks.ALT_GR_SIM,h.Lmodifiers|=a.modifierCodes.RALT);g&&g.KM?(w=e.firstChild.firstChild.wholeText,h.LisVirtualKey=!1,h.LisVirtualKeyCode=!1,h.vkCode=h.Lcode,h.Lcode!=a.keyCodes.K_SPACE&&(h.Lcode=
"string"==typeof w&&""!=w?w.charCodeAt(0):0,160==h.Lcode&&(h.Lcode=0)),h.Lmodifiers=0):h.vkCode=h.Lcode;"undefined"==typeof g.KM&&(h.Lcode=b.keyMapManager._USKeyCodeToCharCode(h),h.LisVirtualKey=!1);if(!g||0!=h.Lcode&&!f.processKeystroke(c.device,k,h))switch(h.Lcode=h.vkCode,n){case "K_CAPS":case "K_NUMLOCK":case "K_SCROLL":a._stateKeys[n]=!a._stateKeys[n];a._Show();break;default:(g=a.defaultKeyOutput(n,h.Lcode,l,!0,k))&&f.output(0,k,g)}"undefined"!=typeof e.key&&null!==e.key.nextlayer&&(a.nextLayer=
e.key.nextlayer);a.selectLayer(n,m);k._KeymanWebSelectionStart=null;k._KeymanWebSelectionEnd=null}b.uiManager.setActivatingUI(!1);return!0};a.getLayerId=function(b){var c="";if(0==b)return"default";b&a.modifierCodes.LCTRL&&(c=(0<c.length?c+"-":"")+"leftctrl");b&a.modifierCodes.RCTRL&&(c=(0<c.length?c+"-":"")+"rightctrl");b&a.modifierCodes.LALT&&(c=(0<c.length?c+"-":"")+"leftalt");b&a.modifierCodes.RALT&&(c=(0<c.length?c+"-":"")+"rightalt");b&a.modifierCodes.SHIFT&&(c=(0<c.length?c+"-":"")+"shift");
b&a.modifierCodes.CTRL&&(c=(0<c.length?c+"-":"")+"ctrl");b&a.modifierCodes.ALT&&(c=(0<c.length?c+"-":"")+"alt");return c};a.getModifierState=function(b){var c=0;0<=b.indexOf("shift")&&(c|=a.modifierCodes.SHIFT);var e=!1;0<=b.indexOf("leftctrl")&&(c|=a.modifierCodes.LCTRL,e=!0);0<=b.indexOf("rightctrl")&&(c|=a.modifierCodes.RCTRL,e=!0);0<=b.indexOf("ctrl")&&!e&&(c|=a.modifierCodes.CTRL);e=!1;0<=b.indexOf("leftalt")&&(c|=a.modifierCodes.LALT,e=!0);0<=b.indexOf("rightalt")&&(c|=a.modifierCodes.RALT,
e=!0);0<=b.indexOf("alt")&&!e&&(c|=a.modifierCodes.ALT);return c};a.updateLayer=function(b){var c=a.layerId,e=b,d,f="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(d=0;d<f.length;d++)e=e.replace(f[d]+"-",""),e=e.replace(f[d],"");if("default"==a.layerId||"numeric"==a.layerId||"symbol"==a.layerId||"currency"==a.layerId||""!=e)c=b;else{e=a.getModifierState(c);for(d=0;d<f.length;d++)c=c.replace(f[d]+"-",""),c=c.replace(f[d],"");switch(b){case "shift":e^=a.modifierCodes.SHIFT;break;
case "leftctrl":e^=a.modifierCodes.LCTRL;break;case "rightctrl":e^=a.modifierCodes.RCTRL;break;case "ctrl":e^=a.modifierCodes.CTRL;break;case "leftalt":e^=a.modifierCodes.LALT;break;case "rightalt":e^=a.modifierCodes.RALT;break;case "alt":e^=a.modifierCodes.ALT;break;default:c=b}"default"!=c&&(c=""==c?a.getLayerId(e):a.getLayerId(e)+"-"+c)}""==c&&(c="default");a.layerId=c;for(d=0;d<a.layers.length;d++)if(a.layerId==a.layers[d].id)return;a.layerId="default"};a.showLanguage=function(){var c="",k=b.keyboardManager.activeStub;
if(k){var d=k.KL;c=k.KN}else d=b._ActiveLanguage?b._ActiveLanguage.KN:"English";try{var f=a.spaceBar.firstChild.firstChild;f.parentNode.className="undefined"==typeof f.parentNode.className||""==f.parentNode.className?"kmw-spacebar":f.parentNode.className+" kmw-spacebar";f.className="kmw-spacebar-caption";c=c.replace(/\s*keyboard\s*/i,"");k="";k=c==d?d:d+" ("+c+")";f.innerHTML!=k&&(f.innerHTML=k)}catch(p){}};a.showLanguageMenu=function(){var e=b.keyboardManager.keyboardStubs;if(!(1>e.length)){var k=
a.lgList=c._CreateElement("DIV");a.lgList.id="kmw-language-menu";k.shim=c._CreateElement("DIV");k.shim.id="kmw-language-menu-background";k.shim.addEventListener("touchstart",function(b){b.preventDefault();a.hideLanguageList();if(2<b.touches.length){var c=b.touches[1].pageX;b=b.touches[1].pageY;c>a.spaceBar.offsetLeft&&c<a.spaceBar.offsetLeft+a.spaceBar.offsetWidth&&b>a.spaceBar.offsetTop&&b<a.spaceBar.offsetTop+a.spaceBar.offsetHeight&&a.showBuild()}},!1);document.body.appendChild(k.shim);var l=c._CreateElement("DIV"),
f=l.style,g=c._CreateElement("DIV");l.id="kmw-menu-scroll-container";g.id="kmw-menu-scroller";"WebkitOverflowScrolling"in f&&(f.WebkitOverflowScrolling="touch");l.appendChild(g);k.appendChild(l);var h;f=c._CreateElement("DIV");f.id="kmw-menu-index";for(h=1;26>=h;h++){var n=c._CreateElement("P");n.innerHTML=String.fromCharCode(h+64);f.appendChild(n)}f.addEventListener("touchstart",function(b){a.scrollToLanguage(b,l,g)},!1);f.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},
!1);k.appendChild(f);k.addEventListener("scroll",function(b){a.lgList.scrolling=!0},!1);l.addEventListener("scroll",function(a){1>l.scrollTop&&(l.scrollTop=1);l.scrollTop>l.scrollHeight-l.offsetHeight-1&&(l.scrollTop=l.scrollHeight-l.offsetHeight-1)},!1);a.lgList.activeLgNo=a.addLanguagesToMenu(g,e);a.lgList.visibility="hidden";document.body.appendChild(a.lgList);"Android"==d.OS&&"devicePixelRatio"in window&&(a.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==d.OS&&"tablet"==d.formFactor&&
"devicePixelRatio"in window&&(h=parseInt(c.getStyleValue(k,"width"),10),e=k.style,isNaN(h)||(e.width=e.maxWidth=2*h/window.devicePixelRatio+"px"),h=parseInt(c.getStyleValue(l,"width"),10),e=l.style,isNaN(h)||(e.width=e.maxWidth=2*h/window.devicePixelRatio+"px"),h=parseInt(c.getStyleValue(g,"width"),10),e=g.style,isNaN(h)||(e.width=e.maxWidth=2*h/window.devicePixelRatio+"px"));a.adjustLanguageMenu(0);e=Math.floor(k.offsetHeight/26);n=Math.round(100*e/(f.childNodes[1].offsetTop-f.childNodes[0].offsetTop))/
100;var m=.6<n?1:2;1.25<n&&(n=1.25);for(h=0;26>h;h++){var r=f.childNodes[h].style;2==m&&1==h%2?r.display="none":(r.fontSize=n*m+"em",r.lineHeight=e*m+"px")}h=l.offsetWidth;l.scrollHeight>l.offsetHeight+3?h+=f.offsetWidth:f.style.display="none";k.style.width=h+"px";a.lgList.visibility="";k=g.firstChild.offsetHeight*a.lgList.activeLgNo+1;l.scrollTop=k;l.scrollTop<k&&(l.scrollTop=l.scrollHeight-l.offsetHeight);l.scrollTop>l.scrollHeight-l.offsetHeight-1&&(l.scrollTop=l.scrollHeight-l.offsetHeight-1)}};
a.adjustLanguageMenu=function(b){var e=a.lgList,l=e.firstChild,f=l.firstChild,g=e.style;e=e.childNodes[1];var h=window.innerHeight-a.lgKey.offsetHeight-16;f=(f.childNodes.length+b-1)*f.firstChild.firstChild.offsetHeight;"iOS"==d.OS&&("phone"==d.formFactor?(b=c.landscapeView()?36:0,h=(window.innerHeight-b-16)*c.getViewportScale()):"tablet"==d.formFactor&&(b=c.landscapeView()?16:0,h-=b));g.left=c._GetAbsoluteX(a.lgKey)+"px";f>h&&(f=h);g.height=f+"px";g.top=c._GetAbsoluteY(a._Box)+a._Box.offsetHeight-
f+window.pageYOffset-6+"px";g.bottom="auto";e.style.height=l.style.height=g.height};a.scrollToLanguage=function(a,b,c){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();if("P"==a.touches[0].target.nodeName){var e,k=0;a=a.touches[0].target.innerHTML.charCodeAt(0);var d=c.childNodes;try{for(e=0;e<d.length-1;e++){var l=d[e].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(l>=a)break}}catch(m){}try{k=c.firstChild.offsetHeight*e+1,b.scrollTop=k}catch(m){k=0}try{b.scrollTop<k&&(b.scrollTop=
b.scrollHeight-b.offsetHeight),b.scrollTop>b.scrollHeight-b.offsetHeight-1&&(b.scrollTop=b.scrollHeight-b.offsetHeight-1)}catch(m){}}};a.addLanguagesToMenu=function(e,k){var l=k.length,f,g,h=[];for(g=0;g<l;g++){var n=k[g].KL;-1==h.indexOf(n)&&h.push(n)}h.sort();var m=Math.round(100/c.getViewportScale())/100;n=-1;for(f=0;f<h.length;f++){var r=c._CreateElement("DIV");r.className="kbd-list-closed";var t=c._CreateElement("P");t.kList=[];for(g=0;g<l;g++)k[g].KL==h[f]&&t.kList.push(k[g]);"iOS"==d.OS&&(t.style.fontSize=
m+"em");r.appendChild(t);e.appendChild(r);h[f]==b.keyboardManager.activeStub.KL&&(n=f);if(1<t.kList.length)for(t.className="kbd-list",t.innerHTML=h[f]+"...",t.scrolled=!1,t.ontouchend=function(b){b.preventDefault();b.stopPropagation();b.target.scrolled?b.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";a.adjustLanguageMenu("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},t.addEventListener("touchstart",function(a){a.stopPropagation()},
!1),t.addEventListener("touchmove",function(a){a.target.scrolled=!0;a.stopPropagation()},!1),g=0;g<t.kList.length;g++){var u=c._CreateElement("P");u.className="kbd-list-entry";"iOS"==d.OS&&(u.style.fontSize=m+"em");a.addKeyboardToMenu(t.kList[g],u,!1);r.appendChild(u)}else t.innerHTML=h[f],t.className="kbd-single-entry",a.addKeyboardToMenu(t.kList[0],t,!0);f==n&&(t.className+=" current")}k=c._CreateElement("DIV");k.id="kmw-menu-footer";l=function(a){a.preventDefault();a.stopPropagation()};k.addEventListener("touchstart",
l,!1);k.addEventListener("touchmove",l,!1);k.addEventListener("touchend",l,!1);e.appendChild(k);return n};a.addKeyboardToMenu=function(c,k,d){k.kn=c.KI;k.kc=c.KLC;k.innerHTML=d?c.KL:c.KN.replace(" Keyboard","");c=function(b){b.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");a.lgList.scrolling=!1;a.lgList.y0=b.touches[0].pageY;return!0};d=function(b){b.stopImmediatePropagation();var c=a.lgList.childNodes[0],e=c.scrollHeight-c.offsetHeight;if("undefined"!=typeof b.pageY)var k=
b.pageY;else if("undefined"!=typeof b.touches)k=b.touches[0].pageY;else return;var d=k-a.lgList.y0;if(0>d)c.scrollTop>=e-1&&(b.preventDefault(),a.lgList.y0=k);else if(0<d)2>c.scrollTop&&(b.preventDefault(),a.lgList.y0=k);else return;if(-5>d||5<d)a.lgList.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),a.lgList.y0=k;return!0};var e=function(c){c.preventDefault();"undefined"!=typeof c.stopImmediatePropagation?c.stopImmediatePropagation():c.stopPropagation();a.lgList.scrolling?this.className=
this.className.replace(/\s*selected/,""):(DOMEventHandlers.states.setFocusTimer(),a.lgList.style.display="none",b.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),b.keyboardManager.doKeyboardChange(this.kn,this.kc),b.domManager.focusLastActiveElement(),a.hideLanguageList(),a._Show());return!0};k.onmspointerdown=c;k.addEventListener("touchstart",c,!1);k.onmspointermove=d;k.addEventListener("touchmove",d,!1);k.onmspointerout=e;k.addEventListener("touchend",e,!1)};a.hideLanguageList=function(){a.lgList&&
(a.highlightKey(a.lgKey.firstChild,!1),a.lgList.style.visibility="hidden",window.setTimeout(function(){null!=a.lgList&&"undefined"!=typeof a.lgList&&(document.body.removeChild(a.lgList.shim),document.body.removeChild(a.lgList));a.lgList=null},500))};a._UpdateVKShift=function(c,k,d){var e=0,f=["CAPS","NUM_LOCK","SCROLL_LOCK"],l=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(c)for(e=c.Lmodifiers,k=c.Lstates,b.keyboardManager.isChiral()&&a.emulatesAltGr()&&(DOMEventHandlers.states.modStateFlags&a.modifierBitmasks.ALT_GR_SIM)==
a.modifierBitmasks.ALT_GR_SIM&&(e|=a.modifierBitmasks.ALT_GR_SIM,e&=~a.modifierCodes.RALT),c=0;c<f.length;c++)k&a.stateBitmasks[f[c]]&&(a._stateKeys[l[c]]=k&a.modifierCodes[f[c]]);else if(d)for(e|=k,c=0;c<f.length;c++)k&a.stateBitmasks[f[c]]&&(a._stateKeys[l[c]]=!0);else for(e&=~k,c=0;c<f.length;c++)k&a.stateBitmasks[f[c]]&&(a._stateKeys[l[c]]=!1);a.layerId=a.getLayerId(e);a._Visible&&a._Show();return!0};a._UpdateVKShiftStyle=function(b){var c;if(b)for(c=0;c<a.layers.length&&a.layers[c].id!=a.layerId;c++);
else{c=a.layerIndex;b=a.layers[c].id;var e=a.layers[c];c=["K_CAPS","K_NUMLOCK","K_SCROLL"];var d=[e.capsKey,e.numKey,e.scrollKey];for(e=0;e<d.length;e++)if(null!=d[e]){d[e].sp=a._stateKeys[c[e]]?a.buttonClasses["SHIFT-ON"]:a.buttonClasses.SHIFT;var f=document.getElementById(b+"-"+c[e]);a.setButtonClass(d[e],f,a.layout)}}};a._CancelMouse=function(a){(a=b._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};a.showLayer=function(c){if(b.keyboardManager.activeKeyboard)for(var e=
0;e<a.layers.length;e++)if(a.layers[e].id==c)return a.layerId=c,a._Show(),!0;return!1};a.getHeight=function(){if("function"==typeof b.getOskHeight)return b.getOskHeight();var a=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==d.formFactor){var k=Math.min(screen.height,screen.width),f=Math.max(screen.height,screen.width);a=c.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):f/k*a/1.6}"iOS"==d.OS&&(a/=c.getViewportScale());"Android"==d.OS&&"phone"==
d.formFactor&&"devicePixelRatio"in window&&/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(a*=window.devicePixelRatio);return a};a.getWidth=function(){if("function"==typeof b.getOskWidth)return b.getOskWidth();var a=screen.width;if("Android"==d.OS)try{a=document.documentElement.clientWidth}catch(k){a=screen.availWidth}return a};a.mouseOverMouseDownHandler=function(b){var e=c.eventTarget(b);null!==e&&"desktop"==d.formFactor&&("SPAN"==e.nodeName&&(e=e.parentNode),"mousedown"==c.eventType(b)?(a.currentKey=
e.id,a._CancelMouse(b),a.highlightKey(e,!0)):e.id==a.currentKey&&a.highlightKey(e,!0))};a.mouseUpMouseOutHandler=function(b){var e=c.eventTarget(b);null!==e&&"desktop"==d.formFactor&&("SPAN"==e.nodeName&&(e=e.parentNode),a.highlightKey(e,!1),"mouseup"==c.eventType(b)&&(e.id==a.currentKey&&a.clickKey(e),a.currentKey=""))};a.getDefaultKeyObject=function(){return{text:"",width:"100",pad:"15",sp:"0",layer:null,nextlayer:null}};a.deviceDependentLayout=function(b,k){var e=c._CreateElement("DIV"),f=e.style,
g=0;e.className="kmw-key-layer-group";switch(k){case "phone":case "tablet":g=a.getHeight(),f.height=g+"px"}if(null==b)return e;f.fontSize="undefined"==typeof b.fontsize||null==b.fontsize?"1em":b.fontsize;a.fontSize=f.fontSize;var h;var n=b.layer;var m=a.getDefaultKeyObject();m.fontsize=f.fontSize;var r=/\*\w+\*/;for(g=0;g<n.length;g++){var t=n[g];var u=t.row;for(h=u.length;0<h&&!(0<u[h-1].key.length);h--);h<u.length&&u.splice(h-u.length,u.length-h)}var A=100/u.length;"desktop"==k&&(A=100/u.length);
if("desktop"==k){var D=function(a){return a+"%"};var E=100}else D=function(a){return Math.round(a)+"px"},E=a.getWidth();d.touchable&&(e.addEventListener("touchstart",a.touch,!0),e.addEventListener("touchend",a.release,!0),e.addEventListener("touchmove",a.moveOver,!1));for(g=0;g<n.length;g++){t=n[g];t.aligned=!1;var x=c._CreateElement("DIV");u=x.style;x.className="kmw-key-layer";u.display=0==g?"block":"none";u.height=f.height;u.fontFamily="font"in b?b.font:"";x.layer=x.nextLayer=t.id;"string"==typeof t.nextlayer&&
(x.nextLayer=t.nextlayer);u=t.row;var I=0;for(h=0;h<u.length;h++){var H=0;var y=u[h];var z=y.key;for(y=0;y<z.length;y++){var q=z[y];if(null==q)--z.length;else{var K="string"==typeof q.width&&""!=q.width?parseInt(q.width,10):100;if(isNaN(K)||0==K)K=100;q.width=K.toString();var F="string"==typeof q.pad&&""!=q.pad?parseInt(q.pad,10):15;if(isNaN(F)||0==F)F=15;q.pad=F.toString();H+=K+F}}H>I&&(I=H)}I="desktop"==k?I+5:I+15;for(h=0;h<u.length;h++){H=c._CreateElement("DIV");H.className="kmw-key-row";H.onmousedown=
c.mouseDownPreventDefaultHandler;y=u[h];K=H.style;K.maxHeight=K.height=A+"%";z=y.key;for(y=0;y<z.length;y++){q=z[y];for(var L in m)"string"!=typeof q[L]&&(q[L]=m[L]);switch(q.sp){case "1":r.test(q.text)||""==q.text||(q.sp="3");break;case "2":r.test(q.text)||""==q.text||(q.sp="4")}}for(y=F=0;y<z.length-1;y++){q=Math.round(parseInt(z[y].width,10)*E/I);z[y].widthpc=q;var J=Math.round(parseInt(z[y].pad,10)*E/I);z[y].padpc=J;F+=J+q}F+=Math.round(15*E/I);1==z.length&&0>parseInt(z[0].pad,10)?(q=Math.round(parseInt(z[0].width,
10)*E/I),z[0].widthpc=q,F+=q,z[0].padpc=E-F):0<z.length&&(y=z.length-1,J=Math.round(parseInt(z[y].pad,10)*E/I),z[y].padpc=J,F+=J,z[y].widthpc=E-F);for(y=F=0;y<z.length;y++){q=z[y];J=c._CreateElement("DIV");J.keyId=q.id;J.className="kmw-key-square";var B=J.style;J.width=B.width=D(q.widthpc);"desktop"!=k?(B.left=D(F+z[y].padpc),B.bottom=K.bottom,B.height=K.height):B.marginLeft=D(q.padpc);F=F+z[y].padpc+z[y].widthpc;var G=c._CreateElement("DIV");a.setButtonClass(q,G,b);"desktop"!=k&&(G.style.left=B.left,
G.style.width=B.width);B=null;if(b.keyLabels||"desktop"==k){var C=a.keyCodes[q.id];switch(C){case 186:C=59;break;case 187:C=61;break;case 188:C=44;break;case 189:C=45;break;case 190:C=46;break;case 191:C=47;break;case 192:C=96;break;case 219:C=91;break;case 220:C=92;break;case 221:C=93;break;case 222:C=39;break;default:if(48>C||90<C)C=0}0<C&&(B=c._CreateElement("DIV"),B.className="kmw-key-label",B.innerHTML=String.fromCharCode(C),G.appendChild(B))}G.id=t.id+"-"+q.id;G.key=q;if("undefined"!=typeof q.sk&&
null!=q.sk)for(C=G.subKeys=q.sk,B=0;B<C.length;B++){if("1"==C[B].sp||"2"==C[B].sp)C[B].text=a.renameSpecialKey(C[B].text)}else G.subKeys=null;d.touchable||(G.onmouseover=G.onmousedown=a.mouseOverMouseDownHandler,G.onmouseup=G.onmouseout=a.mouseUpMouseOutHandler);B=c._CreateElement("SPAN");C=B.style;null==q.text||""==q.text?(B.innerHTML="\u00a0","string"==typeof q.id&&/^U_[0-9A-F]{4}$/i.test(q.id)&&(B.innerHTML=String.fromCharCode(parseInt(q.id.substr(2),16)))):B.innerHTML=q.text;B.className="kmw-key-text";
if("1"==q.sp||"2"==q.sp)B.innerHTML=a.renameSpecialKey("*Tab*"==q.text&&1==g?"*TabLeft*":q.text);"font"in q&&(C.fontFamily=q.font);"fontsize"in q&&(C.fontSize=q.fontsize);G.appendChild(B);J.appendChild(G);"undefined"!=typeof q.sk&&null!=q.sk&&(q=c._CreateElement("DIV"),q.className="kmw-key-popup-icon",G.appendChild(q));H.appendChild(J)}x.appendChild(H)}e.appendChild(x)}return e};a.renameSpecialKey=function(b){return a.specialCharacters[b]?String.fromCharCode(57344+a.specialCharacters[b]):b};a.clearPopup=
function(){var b=document.getElementById("kmw-popup-keys");null!=b&&(b.shim&&a._Box.removeChild(b.shim),b.parentNode.removeChild(b));a.popupCallout&&a._Box.removeChild(a.popupCallout);a.popupCallout=null;a.subkeyDelayTimer&&(window.clearTimeout(a.subkeyDelayTimer),a.subkeyDelayTimer=null);a.popupBaseKey=null};a.touch=function(b){var c=b.changedTouches[0].target,e=a.keyTarget(c);a.touchX=b.changedTouches[0].pageX;a.currentTarget=e;var d=document.getElementById("kmw-popup-keys");if(!(d&&"visible"==
d.style.visibility||a.popupVisible)){a.touchCount=b.touches.length;if(e&&0<=e.className.indexOf("key-hidden")||0<=c.className.indexOf("kmw-key-row"))e=a.findNearestKey(b,c);null!=e&&(b=e.id.split("-"),b=b[b.length-1],a.highlightKey(e,!0),"K_LOPT"==b||"K_ROPT"==b?(window.setTimeout(function(){a.clickKey(e)},0),a.keyPending=null):"K_BKSP"==b?(a.clickKey(e),a.deleteKey=e,a.deleting=window.setTimeout(a.repeatDelete,500),a.keyPending=null):(a.keyPending?(a.highlightKey(a.keyPending,!1),a.clickKey(a.keyPending),
a.clearPopup(),a.touchCount--):a.touchHold(e),a.keyPending=e))}};a.release=function(b){var c=document.getElementById("kmw-popup-keys"),e=a.currentTarget;if(c&&"visible"==c.style.visibility||a.popupVisible){if(0<b.touches.length)return;if(null==e||0>e.id.indexOf("popup")&&e.id!=a.popupBaseKey.id)a.highlightKey(a.keyPending,!1),a.clearPopup(),a.keyPending=null}e&&e.id&&a.optionKey(b,e.id,!1);e=b.changedTouches[0].pageX;e=2>e&&5<a.touchX||e>window.innerWidth-2&&a.touchX<window.innerWidth-5;c=a.touchCount;
0<a.touchCount&&a.touchCount--;a.keyPending?(a.highlightKey(a.keyPending,!1),0>a.keyPending.className.indexOf("hidden")&&0<c&&!e&&a.clickKey(a.keyPending),a.clearPopup(),a.keyPending=null):(c=b.changedTouches[0],e=a.keyTarget(c.target),e||(e=document.elementFromPoint(c.clientX,c.clientY),e=a.findNearestKey(b,e)),a.highlightKey(e,!1));a.deleting&&window.clearTimeout(a.deleting);a.deleting=0};a.moveOver=function(b){b.preventDefault();b.cancelBubble=!0;"function"==typeof b.stopImmediatePropagation?b.stopImmediatePropagation():
"function"==typeof b.stopPropagation&&b.stopPropagation();if(!(1<b.touches.length||0==a.touchCount)){var c="object"==typeof b.touches?b.touches[0].clientX:b.clientX,e="object"==typeof b.touches?b.touches[0].clientY:b.clientY,f=document.elementFromPoint(c,e),g=a.keyPending,h=a.keyTarget(f);if(h&&0<=h.className.indexOf("key-hidden")||f&&!h&&0<=f.className.indexOf("key-row"))h=a.findNearestKey(b,f);h&&"string"==typeof h.id&&0>h.id.indexOf("BKSP")&&(a.deleting&&window.clearTimeout(a.deleting),a.deleting=
0);if(a.popupVisible)null==h?(g&&a.highlightKey(g,!1),a.keyPending=null):h==a.popupBaseKey?(a.hasClass(h,"kmw-key-touched")||a.highlightKey(h,!0),a.keyPending=h):(g&&a.highlightKey(g,!1),a.keyPending=null);else{(f=document.getElementById("kmw-popup-keys"))&&"visible"==f.style.visibility&&"phone"==d.formFactor&&h==a.popupBaseKey&&(h=f.childNodes[0].firstChild);a.currentTarget=h;g&&h&&h.id!=g.id&&a.highlightKey(g,!1);a.highlightSubKeys(h,c,e);if(f&&"visible"==f.style.visibility){if(h&&0>h.id.indexOf("popup")&&
h!=a.popupBaseKey)return;h&&h==a.popupBaseKey&&0>h.className.indexOf("kmw-key-touched")&&a.highlightKey(h,!0)}else g&&b.touches[0].pageY<Math.max(5,a._Box.offsetTop-.25*a._Box.offsetHeight)&&(a.highlightKey(g,!1),a.showKeyTip(null,!1),a.keyPending=null);h&&a.keyPending&&(a.keyPending=h);a.keyPending&&(g!=h||0>h.className.indexOf("kmw-key-touched"))&&a.highlightKey(h,!0);g&&h&&h!=g&&""!=h.id&&a.touchHold(h)}}};a.hasClass=function(a,b){b=" "+b+" ";return 0<=(" "+a.className+" ").replace(/[\n\t\r\f]/g,
" ").indexOf(b)};a.keyTarget=function(b){try{if(b){if(a.hasClass(b,"kmw-key"))return b;if(b.parentNode&&a.hasClass(b.parentNode,"kmw-key"))return b.parentNode;if(b.firstChild&&a.hasClass(b.firstChild,"kmw-key"))return b.firstChild}}catch(k){}return null};a.findNearestKey=function(a,b){if(!a||"undefined"==typeof a.changedTouches||0==a.changedTouches.length)return null;for(a=a.changedTouches[0].pageX;b&&0>b.className.indexOf("key-row");)b=b.parentNode;if(!b)return null;var c,e=0,d=24,k=1E5;for(c=0;c<
b.childNodes.length;c++)if(!(0<=b.childNodes[c].firstChild.className.indexOf("key-hidden"))){var f=b.childNodes[c].firstChild.offsetLeft;var h=f+b.childNodes[c].firstChild.offsetWidth;f-=a;0<=f&&f<k&&(e=c,k=f);f=a-h;0<=f&&f<k&&(e=c,k=f)}return 1E5>k&&(b=b.childNodes[e].firstChild,f=b.offsetLeft,h=f+b.offsetWidth,40<b.offsetWidth&&(d=.6*b.offsetWidth),0<=f-a&&f-a<d||0<=a-h&&a-h<d)?b:null};a.repeatDelete=function(){a.deleting&&(a.clickKey(a.deleteKey),a.deleting=window.setTimeout(a.repeatDelete,100))};
a.setButtonClass=function(b,d,f){var e=0,k="default shift shift-on special special-on    deadkey blank hidden".split(" ");"string"==typeof b.dk&&"1"==b.dk&&(e=8);"string"==typeof b.sp&&(e=parseInt(b.sp,10));if(0>e||10<e)e=0;f=f||a.layout;d.className=4<f.layer[0].row.length&&"phone"==c.device.formFactor?"kmw-key kmw-5rows kmw-key-"+k[e]:"kmw-key kmw-key-"+k[e]};a.processLegacyDefinitions=function(b){for(var c=a.generateLayerIds(!1),e={},d=0;d<c.length;d++){for(var f=c[d],g=[],n=!1,m=0;65>m;m++){var r=
m+65*d;g.push(b[r]);r<b.length&&""!=b[r]&&m!=h.indexOf("K_SPACE")&&(n=!0)}n&&(e[f]=g)}"undefined"!=typeof e["default"]&&e["default"]||(e["default"]=[""]);"undefined"!=typeof e.shift&&e.shift||(e.shift=[""]);return e};a.formatDefaultLayer=function(b,c,d,f){for(var e=b.id,k=0;k<b.row.length;k++)for(var h=b.row[k].key,g=0;g<h.length;g++){var l=h[g];switch(l.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=e.indexOf("shift")&&(l.sp=a.buttonClasses["SHIFT-ON"]);"desktop"!=d&&"default"!=e&&(l.nextlayer=
"default");break;case "K_LCTRL":case "K_LCONTROL":if(c){-1!=e.indexOf("leftctrl")&&(l.sp=a.buttonClasses["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(c){-1!=e.indexOf("rightctrl")&&(l.sp=a.buttonClasses["SHIFT-ON"]);break}case "K_CONTROL":-1==e.indexOf("ctrl")||c&&(-1==e.indexOf("leftctrl")||-1==e.indexOf("rightctrl"))||(l.sp=a.buttonClasses["SHIFT-ON"]);break;case "K_LALT":if(c){-1!=e.indexOf("leftalt")&&(l.sp=a.buttonClasses["SHIFT-ON"]);break}case "K_RALT":if(c){-1!=e.indexOf("rightalt")&&
(l.sp=a.buttonClasses["SHIFT-ON"]);break}case "K_ALT":-1==e.indexOf("alt")||c&&(-1==e.indexOf("leftalt")||-1==e.indexOf("rightalt"))||(l.sp=a.buttonClasses["SHIFT-ON"]);break;case "K_oE2":"undefined"!=typeof f&&f||("desktop"==d?(h.splice(g--,1),h[0].width="200"):h[g].sp=a.buttonClasses.HIDDEN)}}};a.generateLayerIds=function(b){if(b){b=32;var c=1}else b=8,c=16;for(var e=[],d=0;d<b;d++)e.push(a.getLayerId(d*c));return e};a.emulatesAltGr=function(b){b=b?b:a.layers;return!(b[a.getLayerId(a.modifierCodes.LCTRL|
a.modifierCodes.LALT)]||b[a.getLayerId(a.modifierCodes.SHIFT|a.modifierCodes.LCTRL|a.modifierCodes.LALT)])};a.buildDefaultLayout=function(e,d,f){var k=f;var g=b.dfltLayout;"object"!=typeof g[k]&&(k="desktop");k=c.deepCopy(g[k]);var l;g=k.layer;var n=e.KLS,m=e.K102,r,t=d&a.modifierBitmasks.IS_CHIRAL;(d=!("undefined"==typeof n||!n))||(n=a.processLegacyDefinitions(e.BK));e=Object.getOwnPropertyNames(n);var u=[];e.splice(e.indexOf("default"),1);e=["default"].concat(e);a.emulatesAltGr(n)&&-1!=e.indexOf("rightalt")&&
(e.push("leftctrl-leftalt"),n["leftctrl-leftalt"]=n.rightalt);if("desktop"==f)for(u=a.generateLayerIds(t),l=0;l<u.length;l++)-1!=e.indexOf(u[l])&&u.splice(l--,1);var A=e.concat(u);if(d&&"desktop"!=f){d=null;u=g[0].row;for(l=0;l<u.length;l++){var D=u[l].key;for(var E=0;E<D.length;E++){var x=D[E];"K_SHIFT"==x.id&&(d=x)}}if(d)for(r in d.sk=[],n)"default"!=r&&"shift"!=r&&(l=a.modifierSpecials[r],d.sk.push(new OSKKeySpec("K_"+l,l,null,"1",r)));else console.warn("Error in default layout - cannot find default Shift key!")}for(l=
0;l<A.length;l++)0<l&&(g[l]=c.deepCopy(g[0])),g[l].id=A[l],g[l].nextlayer=A[l],a.formatDefaultLayer(g[l],0!=t,f,!!m);for(l=0;l<g.length;l++){t=g[l];var I=E=A=d=null,H=n[t.id],y="shift"==t.id?1:0,z="default"==t.id||y?1:0;u=t.row;for(r=0;r<u.length;r++)for(D=u[r].key,m=0;m<D.length;m++){x=D[m];var q=h.indexOf(x.id);if(H||z)H&&0<=q&&q<H.length&&(x.text=H[q]),z&&(""==x.text||"undefined"==typeof x.text)&&"K_SPACE"!=x.id&&130>q+65*y&&(x.text="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ "[q+
65*y]);"undefined"==typeof x.text&&(x.text="");switch(x.id){case "K_SHIFT":d=x;break;case "K_CAPS":A=x;break;case "K_NUMLOCK":E=x;break;case "K_SCROLL":I=x}if(null!=x.sk){for(q=0;q<x.sk.length;q++)-1==e.indexOf(x.sk[q].nextlayer)&&x.sk.splice(q--,1);0==x.sk.length&&(x.sk=null)}}t.shiftKey=d;t.capsKey=A;t.numKey=E;t.scrollKey=I;"desktop"!=f&&0<l&&null!=d&&(d.sp=a.buttonClasses["SHIFT-ON"],d.sk=null,d.text=a.modifierSpecials[g[l].id])}return k};a._GenerateVisualKeyboard=function(e,f,g,h){f=c._CreateElement("DIV");
var k=b.keyboardManager.activeKeyboard;if("object"!=typeof g||null==g)g=a.buildDefaultLayout(e,h,d.formFactor);a.layout=g;a.layers=g.layer;a.fontFamily="font"in g?g.font:"";g.keyLabels=k&&"undefined"!=typeof k.KDU&&k.KDU;e=a.deviceDependentLayout(g,d.formFactor);a.ddOSK=!0;a.keyMap=e;f.appendChild(e);a._DivVKbdHelp=a._DivVKbd=f;a._Box.className=d.formFactor+" "+d.OS.toLowerCase()+" kmw-osk-frame";f.className=d.formFactor+" kmw-osk-inner-frame";"desktop"==d.formFactor&&a._Box.appendChild(a.controlBar());
a._Box.appendChild(f);"desktop"==d.formFactor?a._Box.appendChild(a.resizeBar()):a.adjustHeights()};b.BuildVisualKeyboard=b.buildOSK=function(c,d,f,g){d=b.keyboardManager.activeKeyboard;var e="undefined"==typeof f?"desktop":f;g="undefined"==typeof g?"default":g;f=b.keyboardManager.keyboards;if(null!=c){var k=c.toLowerCase().replace("keyboard_","");for(c=0;c<f.length;c++)if(k==f[c].KI.toLowerCase().replace("keyboard_","")){d=f[c];break}}if(!d)return null;c=d.KVKL;f=null;k=d.KV;"object"==typeof c&&("object"==
typeof c[e]&&null!=c[e]?f=c[e]:"phone"==e&&"object"==typeof c.tablet&&null!=c.tablet?f=c.tablet:"tablet"==e&&"object"==typeof c.phone&&null!=c.phone?f=c.phone:"object"==typeof c.desktop&&null!=c.desktop&&(f=c.desktop));null==f&&null!=k&&(f=a.buildDefaultLayout(k,b.keyboardManager.getKeyboardModifierBitmask(d),e));null!=f&&(f.keyLabels="undefined"!=typeof d.KDU&&d.KDU);k=a.deviceDependentLayout(f,e);k.className=e+"-static kmw-osk-inner-frame";if(null!=f){var h,l;for(c=0;c<f.layer.length;c++){d=k.childNodes[c];
for(h=0;h<d.childNodes.length;h++)for(e=d.childNodes[h],l=0;l<e.childNodes.length;l++){var v=e.childNodes[l];v.style.height="100%"}d.style.display="number"==typeof g?c==g&&0<=g?"block":"none":"string"==typeof g?f.layer[c].id==g?"block":"none":0==c?"block":"none"}}else k.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+e+" layout is defined for "+d.KN+".</p>";k.style.border="1px solid #ccc";return k};a.adjustHeights=function(){if(a._Box&&a._Box.firstChild&&a._Box.firstChild.firstChild&&
a._Box.firstChild.firstChild.childNodes){var b=a._Box.firstChild.firstChild.childNodes,f=b[0].childNodes.length,g=a.getHeight(),h=Math.floor(g/(0==f?1:f)),p,w,n;var m=1;"Android"==d.OS&&"devicePixelRatio"in window&&(h/=window.devicePixelRatio);g=f*h;f=a._Box;h=f.style;h.height=h.maxHeight=g+3+"px";f=f.firstChild.firstChild;h=f.style;h.height=h.maxHeight=g+3+"px";"phone"==d.formFactor&&(m=.6);"iOS"==d.OS&&(m/=c.getViewportScale());h.fontSize=m+"em";var r="iOS"==d.OS&&"phone"==d.formFactor&&c.landscapeView();
for(m=0;m<b.length;m++){f=b[m].childNodes.length;h=Math.floor(g/(0==f?1:f));var t=Math.round(.15*h);b[m].style.height=g+3+"px";for(p=0;p<f;p++){var u=b[m].childNodes[p].style;u.bottom=(f-p-1)*h+1+"px";u.maxHeight=u.height=h+"px";var A=b[m].childNodes[p].childNodes;var D=A.length;for(w=0;w<D;w++){var E=A[w];for(n=0;n<E.childNodes.length&&!a.hasClass(E.childNodes[n],"kmw-key");n++);var x=E.childNodes[n].style;x.bottom=u.bottom;x.height=x.minHeight=h-t+"px";r&&0<n&&(E.childNodes[0].style.fontSize="6px")}}}}};
a.controlBar=function(){var e=c._CreateElement("DIV"),d="";e.id="keymanweb_title_bar";e.className="kmw-title-bar";e.onmousedown=a._VMoveMouseDown;b.keyboardManager.activeKeyboard&&(d=b.keyboardManager.activeKeyboard.KN);var f=c._CreateElement("SPAN");f.className="kmw-title-bar-caption";f.innerHTML=d;e.appendChild(f);d=a.closeButton=c._CreateElement("DIV");d.id="kmw-close-button";d.className="kmw-title-bar-image";d.onmousedown=a._CancelMouse;d.onclick=function(){a._Hide(!0)};e.appendChild(d);d=a.helpImg=
c._CreateElement("DIV");d.id="kmw-help-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Help";d.onclick=function(){c.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=a._CancelMouse;e.appendChild(d);d=a.configImg=c._CreateElement("DIV");d.id="kmw-config-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Configuration Options";d.onclick=function(){c.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};
d.onmousedown=a._CancelMouse;e.appendChild(d);d=a.pinImg=c._CreateElement("DIV");d.id="kmw-pin-image";d.className="kmw-title-bar-image";d.title="Pin the On Screen Keyboard to its default location on the active text box";d.onclick=function(){a.loadCookie();a.userPositioned=!1;a.saveCookie();a._Show();a.doResizeMove();a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=a._CancelMouse;e.appendChild(d);return e};a.showBuild=function(){c.alert("KeymanWeb Version "+
b.version+"."+b.build+'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2017 SIL International</span>')};a.resizeBar=function(){var b=c._CreateElement("DIV");b.className="kmw-footer";b.onmousedown=a._CancelMouse;var d=c._CreateElement("DIV");d.className="kmw-footer-caption";d.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';d.id="keymanweb-osk-footer-caption";c.attachDOMEvent(d,"dblclick",function(b){b&&b.shiftKey&&a.showBuild()},!1);"onselectstart"in d&&(d.onselectstart=
c.selectStartHandler);b.appendChild(d);d=c._CreateElement("DIV");d.className="kmw-footer-resize";d.onmousedown=a._VResizeMouseDown;d.onmouseover=d.onmouseout=a._VResizeMouseOut;b.appendChild(d);a.resizeIcon=d;return b};a._VKbdMouseOver=function(a){b.uiManager.setActivatingUI(!0)};a._VKbdMouseOut=function(a){b.uiManager.setActivatingUI(!1)};a._VResizeMouseOver=a._VResizeMouseOut=function(c){c=b._GetEventObject(c);if(!c)return!1;c&&c.preventDefault&&c.preventDefault();var e=a.getRect();a.width=e.width;
a.height=e.height;c.cancelBubble=!0;return!1};a._VResizeMouseDown=function(c){b.uiManager.justActivated=!0;c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(c.pageX){var e=c.pageX;var d=c.pageY}else c.clientX&&(e=c.clientX+document.body.scrollLeft,d=c.clientY+document.body.scrollTop);a._ResizeMouseX=e;a._ResizeMouseY=d;document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);a._VPreviousCursor=
document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof c.which?c.button:c.which;a._VOriginalWidth=a._DivVKbd.offsetWidth;a._VOriginalHeight=a._DivVKbd.offsetHeight;document.onmousemove=a._VResizeMouseMove;document.onmouseup=a._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="se-resize");c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VResizeMouseMove=function(c){c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(a._VPreviousMouseButton!=
("undefined"==typeof c.which?c.button:c.which))return a._VResizeMoveMouseUp(c);if(c.pageX){var e=c.pageX;var d=c.pageY}else c.clientX&&(e=c.clientX+document.body.scrollLeft,d=c.clientY+document.body.scrollTop);e=a._VOriginalWidth+e-a._ResizeMouseX;d=a._VOriginalHeight+d-a._ResizeMouseY;e<.2*screen.width&&(e=.2*screen.width);d<.1*screen.height&&(d=.1*screen.height);e>.9*screen.width&&(e=.9*screen.width);d>.5*screen.height&&(e=.5*screen.height);a._DivVKbd.style.width=e+"px";a._DivVKbd.style.height=
d+"px";a._DivVKbd.style.fontSize=d/8+"px";c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VMoveMouseDown=function(c){b.uiManager.justActivated=!0;c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(c.pageX){var e=c.pageX;var d=c.pageY}else c.clientX&&(e=c.clientX+document.body.scrollLeft,d=c.clientY+document.body.scrollTop);document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);
a._VPreviousCursor=document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof c.which?c.button:c.which;a._VMoveX=e-a._Box.offsetLeft;a._VMoveY=d-a._Box.offsetTop;b.keyboardManager.isCJK()&&(a.pinImg.style.left="15px");document.onmousemove=a._VMoveMouseMove;document.onmouseup=a._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VMoveMouseMove=function(c){c=b._GetEventObject(c);if(!c||
a.noDrag)return!0;a.resizing=1;a.userPositioned=!0;a.pinImg.style.display="block";if(a._VPreviousMouseButton!=("undefined"==typeof c.which?c.button:c.which))return a._VResizeMoveMouseUp(c);if(c.pageX){var e=c.pageX;var d=c.pageY}else c.clientX&&(e=c.clientX+document.body.scrollLeft,d=c.clientY+document.body.scrollTop);a._Box.style.left=e-a._VMoveX+"px";a._Box.style.top=d-a._VMoveY+"px";c&&c.preventDefault&&c.preventDefault();e=a.getRect();a.width=e.width;a.height=e.height;c.cancelBubble=!0;return!1};
a._VResizeMoveMouseUp=function(c){c=b._GetEventObject(c);if(!c)return!0;a.resizing=0;a.currentKey=null;document.onmousemove=a._VPreviousMouseMove;document.onmouseup=a._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=a._VPreviousCursor);b.domManager.focusLastActiveElement();c&&c.preventDefault&&c.preventDefault();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);a._DivVKbd&&(a._VOriginalWidth=a._DivVKbd.offsetWidth,a._VOriginalHeight=a._DivVKbd.offsetHeight);a.doResizeMove();
c.cancelBubble=!0;a.saveCookie();return!1};a.userLocated=function(){return a.userPositioned};a.show=function(b){0<arguments.length?(a._Enabled=b)?a._Show():a._Hide(!0):a._Visible?a._Hide(!0):a._Show()};a.doShow=function(a){return c.callEvent("osk.show",a)};a.doHide=function(a){return c.callEvent("osk.hide",a)};a.doResizeMove=function(a){return c.callEvent("osk.resizemove",a)};a._Show=function(e,f){if(null!=a._Box&&null!=b.domManager.getActiveElement()&&(d.touchable||null!=b.keyboardManager.activeKeyboard&&
a._Enabled)){var g=a._Box.style;d.touchable&&""==g.bottom&&(g.visibility="hidden");if(a.ddOSK){var h,k=-1,w=a._DivVKbd.childNodes[0].childNodes;for(h=0;h<w.length;h++)w[h].layer==a.layerId?(w[h].style.display="block",a.nextLayer=a.layerId,a.layerIndex=k=h,"string"==typeof a.layers[h].nextlayer&&(a.nextLayer=a.layers[h].nextlayer),a._UpdateVKShiftStyle()):w[h].style.display="none";d.touchable&&(g.position="fixed",g.left=g.bottom="0px",g.height=g.maxHeight=a._Box.firstChild.firstChild.style.height,
g.border="none",g.borderTop="1px solid gray",a._Enabled=1,a._Visible=1,"phone"==d.formFactor?a._DivVKbd.style.fontSize="120%":"Android"==d.OS&&"tablet"==d.formFactor&&300>parseInt(g.height,10)?a._DivVKbd.style.fontSize="120%":a._DivVKbd.style.fontSize="200%",a.lgKey=a.getSpecialKey(k,"K_LOPT"),a.hkKey=a.getSpecialKey(k,"K_ROPT"),"iOS"==d.OS&&"phone"==d.formFactor&&a.adjustHeights());a.spaceBar=a.getSpecialKey(k,"K_SPACE")}g.display="block";a.showLanguage();"desktop"==d.formFactor&&(g.position="absolute",
g.display="block",g.left="0px",a.loadCookie(),0<=e?(g.left=e+"px",g.top=f+"px"):a.userPositioned?(g.left=a.x+"px",g.top=a.y+"px"):(e=b.domManager.getActiveElement(),""!=a.dfltX?g.left=a.dfltX:"undefined"!=typeof e&&null!=e&&(g.left=c._GetAbsoluteX(e)+"px"),""!=a.dfltY?g.top=a.dfltY:"undefined"!=typeof e&&null!=e&&(g.top=c._GetAbsoluteY(e)+e.offsetHeight+"px")),a._Enabled=1,a._Visible=1,a._DivVKbd&&(a.width=a._DivVKbd.offsetWidth,a.height=a._DivVKbd.offsetHeight),a.saveCookie(),e=a.pinImg,"undefined"!=
typeof e&&null!=e&&(e.style.display=a.userPositioned?"block":"none"));"hidden"==g.visibility&&window.setTimeout(function(){a._Box.style.visibility="visible"},0);d.touchable||(g={},g.x=a._Box.offsetLeft,g.y=a._Box.offsetTop,g.userLocated=a.userPositioned,a.doShow(g))}};a.adjustRowLengths=function(b){if(!(0<=b)){var e=a._DivVKbd.childNodes[0].childNodes;if(!(0>b||b>=e.length||e[b].aligned)&&"block"==e[b].style.display){var f=a._DivVKbd.childNodes[0].offsetWidth-6;"Windows"==d.OS&&(f-=c.landscapeView()?
4:40);var g,h=e[b].childNodes;for(g=0;g<h.length;g++){var w=h[g].childNodes;var n=w.length;var m=w[n-2].offsetLeft+w[n-2].offsetWidth;w=w[n-1];w.style.width=f-m+"px"}e[b].aligned=!0}}};a.resetRowLengths=function(){var b,c=a._DivVKbd.childNodes[0].childNodes,d=-1;for(b=0;b<c.length;b++)"block"==c[b].style.display&&(d=b),c[b].aligned=!1;return d};a.getSpecialKey=function(b,c){var d=a._DivVKbd.childNodes[0].childNodes;if(0<=b&&b<d.length)for(b=d[b].childNodes,d=b[b.length-1].childNodes,b=0;b<d.length;b++)if(d[b].keyId==
c)return d[b];return null};a.hide=function(){a._Enabled=0;a._Hide(!0)};a._Hide=function(c){a._Box&&"block"==a._Box.style.display&&a._DivVKbd&&(a.width=a._DivVKbd.offsetWidth,a.height=a._DivVKbd.offsetHeight);if(c)a._Enabled=b.keyboardManager.isCJK()||d.touchable?1:0,a.saveCookie();else if("desktop"==d.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;a._Visible=0;if(a._Box&&d.touchable&&0<a._Box.offsetHeight){var e=a._Box.style;e.transition="string"==typeof e.MozBoxSizing?
"opacity 0.8s linear":e.msTransition=e.WebkitTransition="opacity 0.5s linear 0";window.setTimeout(function(){var b=a._Box.style;a._Visible?b.transition=b.msTransition=b.MozTransition=b.WebkitTransition="":(b.opacity="0",a._Box.addEventListener("transitionend",a.hideNow,!1),a._Box.addEventListener("webkitTransitionEnd",a.hideNow,!1))},200)}else a._Box&&(a._Box.style.display="none");e={};e.HiddenByUser=c;a.doHide(e);c&&b.domManager.focusLastActiveElement()};a.hideNow=function(){a._Box.removeEventListener("transitionend",
a.hideNow,!1);a._Box.removeEventListener("webkitTransitionEnd",a.hideNow,!1);var b=a._Box.style;b.display="none";b.opacity="1";a._Visible=0;b.transition=b.msTransition=b.mozTransition=b.WebkitTransition="";a.hkKey&&"undefined"!=typeof a.hkKey&&a.highlightKey(a.hkKey.firstChild,!1)};a.prepare=function(){b.initialized?(a.ready||(a._Box=c._CreateElement("DIV"),document.body.appendChild(a._Box),c.linkStyleSheet(b.getStyleSheetPath("kmwosk.css")),c.attachDOMEvent(a._Box,"mousedown",function(){b.uiManager.setActivatingUI(!0)}),
d.touchable&&(c.attachDOMEvent(a._Box,"touchstart",function(a){b.uiManager.setActivatingUI(!0);a.preventDefault();a.stopPropagation()}),c.attachDOMEvent(a._Box,"touchend",function(a){a.preventDefault();a.stopPropagation()}),c.attachDOMEvent(a._Box,"touchmove",function(a){a.preventDefault();a.stopPropagation()}),c.attachDOMEvent(a._Box,"touchcancel",function(a){a.preventDefault();a.stopPropagation()}),a.vpScale=c.getViewportScale())),a.loadCookie(),a.ready=!0):window.setTimeout(a.prepare,200)};a._Load=
function(){var e=b.keyboardManager.activeKeyboard;if(null==a._Box)99<=a.loadRetry||(window.setTimeout(a._Load,100),a.loadRetry++);else{a.loadRetry=0;b._TitleElement&&(b._TitleElement.innerHTML="KeymanWeb");a._Visible=0;a.layerId="default";var f=a._Box.style;f.zIndex="9999";f.display="none";f.width="auto";f.position="desktop"==d.formFactor?"absolute":"fixed";"phone"==d.formFactor&&(f.fontSize="1.6em");a._DivVKbd=a._DivVKbdHelp=null;a._Box.innerHTML="";a._Box.onmouseover=a._VKbdMouseOver;a._Box.onmouseout=
a._VKbdMouseOut;if(null!=e||d.touchable){var g=null,h=null;f="";a._Box.className="";if(null!=e){g=e.KV;f=e.KH;var p=e.KVKL;"undefined"!=typeof p&&null!=p&&(h=p[d.formFactor],"undefined"==typeof h||null==h)&&("phone"==d.formFactor?h=p.tablet:"tablet"==d.formFactor&&(h=p.phone),"undefined"==typeof h||null==h)&&(h=p.desktop)}if(null!=g&&null!=g.BK){p=g.BK;for(var w=!0,n=0;n<p.length;n++)if(0<p[n].length){w=!1;break}w&&(g=null)}null!=g||""==f||d.touchable?(null==g&&(g={F:"Tahoma",BK:"`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ "}),
a._GenerateVisualKeyboard(g,f,h,b.keyboardManager.getKeyboardModifierBitmask())):(a.ddOSK=!1,g=c._CreateElement("DIV"),g.className="kmw-title-bar",g.appendChild(a._TitleBarInterior()),g.onmousedown=a._VMoveMouseDown,a._Box.appendChild(g),g=c._CreateElement("DIV"),g.className="kmw-osk-static",g.innerHTML=f,a._Box.appendChild(g),e.KHF&&e.KHF(a._Box));b._TitleElement&&(b._TitleElement.innerHTML="<span style='font-weight:bold'>"+e.KN+"</span> - "+b._TitleElement.innerHTML,b._TitleElement.className="",
b._TitleElement.style.color="#fff")}else g=c._CreateElement("DIV"),g.className="kmw-title-bar",g.appendChild(a._TitleBarInterior()),g.onmousedown=a._VMoveMouseDown,a._Box.appendChild(g),g=c._CreateElement("DIV"),g.className="kmw-osk-none",a._Box.appendChild(g);a.createKeyTip();f=a._Box.firstChild;e=" kmw-keyboard-"+(e?e.KI.replace("Keyboard_",""):"");"keymanweb_title_bar"==f.id&&(f=f.nextSibling);f.className="kmw-osk-inner-frame"+e;a.appendStyleSheet();a._Enabled&&a._Show()}};a.appendStyleSheet=function(){var d=
b.keyboardManager.activeKeyboard,f=b.keyboardManager.activeStub;if(null!=f){a.styleSheet&&c.removeStyleSheet(a.styleSheet);var g=f.KFont;f=f.KOskFont;c.addFontFaceStyleSheet(g);c.addFontFaceStyleSheet(f);b.alignInputs(!1);var h=a.addFontStyle(g,f);null!=d&&"string"==typeof d.KCSS&&(h+=d.KCSS);a.styleSheet=c.addStyleSheet(h);a.waitForFonts(g,f)&&b.alignInputs(!0)}};a.addFontStyle=function(a,c){var d=b.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(d=a.family);d=d.replace(/\u0022/g,
"");var e=new RegExp("\\s?"+d+",?"),f=b.appliedFont.replace(/\u0022/g,"");f=f.replace(e,"");f=f.replace(/,$/,"");f='"'+(""==f?d:d+","+f).replace(/,\s?/g,'","')+'"';d=".keymanweb-font{\nfont-family:"+f+" !important;\n}\n";"undefined"!=typeof c?d=d+'.kmw-key-text{\nfont-family:"'+c.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n':"undefined"!=typeof a&&(d=d+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');b.appliedFont=f;return d};a._Unload=function(){a._VShift=
a._DivVKbd=a._VKeySpans=a._Box=0};a.saveCookie=function(){var b=c.loadCookie("KeymanWeb_OnScreenKeyboard"),d=a.getPos();b.visible=a._Enabled?1:0;b.userSet=a.userPositioned?1:0;b.left=d.left;b.top=d.top;a._DivVKbd&&(b.width=a.width,b.height=a.height);c.saveCookie("KeymanWeb_OnScreenKeyboard",b)};a.loadCookie=function(){var b=c.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return a.userPositioned=!1;a._Enabled=c.toNumber(b.visible,!0);a.userPositioned=c.toNumber(b.userSet,
!1);a.x=c.toNumber(b.left,-1);a.y=c.toNumber(b.top,-1);var d=c.toNumber(b.width,.3*screen.width);b=c.toNumber(b.height,.15*screen.height);d<.2*screen.width&&(d=.2*screen.width);b<.1*screen.height&&(b=.1*screen.height);d>.9*screen.width&&(d=.9*screen.width);b>.5*screen.height&&(d=.5*screen.height);a._DivVKbd&&(a._DivVKbd.style.width=d+"px",a._DivVKbd.style.height=b+"px",a._DivVKbd.style.fontSize=b/8+"px");-1!=a.x&&-1!=a.y&&a._Box||(a.userPositioned=!1);a.x<window.pageXOffset-.8*d&&(a.x=window.pageXOffset-
.8*d);0>a.y&&(a.x=-1,a.y=-1,a.userPositioned=!1);a.userPositioned&&a._Box&&a.setPos({left:a.x,top:a.y});return!0}}();
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,c=b.util,d=c.device;b.isEmbedded=!1;b.setDefaultDeviceOptions=function(a){""==a.attachType&&(a.attachType=d.touchable?"manual":"auto")};c.wait=function(a){var c=this.waiting;if("undefined"!=typeof c&&null!=c&&!b.warned){var d=c.firstChild.childNodes;a?(c.pending=!0,window.setTimeout(function(){c.pending&&(window.scrollTo(0,0),d[0].style.display="none",d[1].className="kmw-wait-text",d[1].innerHTML=a,d[2].style.display="block",c.style.display=
"block")},1E3)):c.pending&&(d[1].innerHTML="",c.pending=!1,c.style.display="none")}};b.getStyleSheetPath=function(a){return c.getOption("resources")+"osk/"+a};b.getKeyboardPath=function(a){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(a)?"":b.options.keyboards)+a};b.KC_=function(a,c,h){var e,f="",g=h.body?h:h.ownerDocument;if(d.touchable)f=b.touchAliasing.getTextBeforeCaret(h);else if(g&&(e=g.defaultView)&&e.getSelection&&("on"==g.designMode.toLowerCase()||"true"==h.contentEditable||"plaintext-only"==
h.contentEditable||""===h.contentEditable))h=e.getSelection(),3==h.focusNode.nodeType&&(f=h.focusNode.substringData(0,h.focusOffset));else if(h.setSelectionRange){if(h._KeymanWebSelectionStart)f=h._KeymanWebSelectionStart;else{if(null===b._CachedSelectionStart||h.selectionStart!==b._LastCachedSelection)b._LastCachedSelection=h.selectionStart,b._CachedSelectionStart=h.value._kmwCodeUnitToCodePoint(h.selectionStart),b._CachedSelectionEnd=h.value._kmwCodeUnitToCodePoint(h.selectionEnd);f=b._CachedSelectionStart}f=
h.value._kmwSubstr(0,f)}f._kmwLength()<a&&(f=Array(a-f._kmwLength()+1).join("\ufffe")+f);return f._kmwSubstr(-a)._kmwSubstr(0,c)};b.alignInputs=function(a){var c=b.domManager;if(d.touchable)for(var f=0;f<c.inputList.length;f++)a?(c.touchHandlers.updateInput(c.inputList[f]),c.inputList[f].style.visibility="visible",0<c.inputList[f].base.textContent.length&&(c.inputList[f].base.style.visibility="hidden")):(c.inputList[f].style.visibility="hidden",c.inputList[f].base.style.visibility="visible")};b.isPositionSynthesized=
function(){return d.touchable};a.highlightSubKeys=function(b,d,h){if(null!=b&&null!=b.subKeys){var e,f=document.getElementById("kmw-popup-keys");5<a.touchY-h&&null==f&&(a.subkeyDelayTimer&&window.clearTimeout(a.subkeyDelayTimer),a.showSubKeys(b),f=document.getElementById("kmw-popup-keys"));for(e=0;e<b.subKeys.length;e++)try{var g=f.childNodes[e].firstChild;var v=c._GetAbsoluteX(g);var p=c._GetAbsoluteY(g);var w=v+g.offsetWidth;var n=p+g.offsetHeight;var m=d>v&&d<w&&h>p&&h<n;a.highlightKey(g,m);m&&
a.highlightKey(b,!1)}catch(r){}}};a.optionKey=function(c,d,h){h&&(0<=d.indexOf("K_LOPT")?a.showLanguageMenu():0<=d.indexOf("K_ROPT")&&(b.uiManager.setActivatingUI(!1),a._Hide(!0),b.touchAliasing.hideCaret(),b.domManager.clearLastActiveElement()))};a.createKeyTip=function(){"phone"==d.formFactor&&(null==a.keytip&&(a.keytip=c._CreateElement("div"),a.keytip.className="kmw-keytip",a.keytip.id="kmw-keytip",a.keytip.style.pointerEvents="none",a.keytip.appendChild(c._CreateElement("canvas")),a.keytip.appendChild(c._CreateElement("span")),
a.keytip.key=null,a.keytip.state=!1),a._Box.appendChild(a.keytip))};a.showKeyTip=function(b,d){var f=a.keytip;if(null!=f&&(b!=f.key||d!=f.state)){var e=document.getElementById("kmw-popup-keys");e=e&&"visible"==e.style.visibility;if(d&&!e){var g=c._GetAbsoluteY(a._Box),l=a._Box.offsetHeight;e=c._GetAbsoluteX(b);for(var v=c._GetAbsoluteY(b),p=b.offsetWidth,w=b.offsetHeight,n=b.firstChild,m=f.style,r=f.childNodes[1],t=r.style,u=0,A=f.firstChild,D=0;D<b.childNodes.length&&(n=b.childNodes[D],!a.hasClass(n,
"kmw-key-text"));D++);A.width=1.6*p;A.height=2.3*w;m.top="auto";m.bottom=g+l-v-w+"px";m.textAlign="center";m.overflow="visible";m.fontFamily=c.getStyleValue(n,"font-family");m.width=A.width+"px";m.height=A.height+"px";g=c.getStyleInt(n,"font-size");0!=g&&(m.fontSize=1.8*g+"px");r.textContent=n.textContent;t.display="block";t.position="absolute";t.textAlign="center";t.width="100%";t.top="2%";t.bottom="auto";n=(A.width-p)/2;e<n?(u=-1,e+=n):e>window.innerWidth-p-n&&(u=1,e-=n);a.drawPreview(A,p,w,u);
m.left=e-n+"px";m.display="block"}else f.style.display="none";f.key=b;f.state=d}};a.drawPreview=function(a,b,c,e){c=a.getContext("2d");var f=(a.width-b)/2,g=a.height,h=0,p=f,w=b+f;b+=2*f;var n=.5*g,m=.6*g,r=8;"Android"==d.OS&&(r=3);switch(e){case -1:p-=f;w-=f;b-=f;break;case 1:h+=f,p+=f,w+=f}c.clearRect(0,0,a.width,a.height);"Android"==d.OS?(p=w=(p+w)/2,c.fillStyle="#999"):c.fillStyle="#ffffff";c.lineWidth="1";c.strokeStyle="#cccccc";c.save();c.beginPath();c.moveTo(h+r,0);c.arcTo(b,0,b,r,r);"Android"==
d.OS?(c.arcTo(b,n,w,m,r),c.arcTo(w,m,p,m,r)):(c.arcTo(b,n,w,m,r),c.arcTo(w,m,w-r,g,r),c.arcTo(w,g,p,g,r),c.arcTo(p,g,p,m-r,r));c.arcTo(p,m,h,n-r,r);c.arcTo(h,n,h,r,r);c.arcTo(h,0,h+r,0,r);c.fill();c.stroke();c.restore()};a.addCallout=function(b){if("phone"!=d.formFactor||"iOS"!=d.OS)return null;var f=c._CreateElement("div"),h=f.style;f.id="kmw-popup-callout";a._Box.appendChild(f);var e=b.offsetLeft,k=b.offsetWidth,l=b.offsetHeight;h.top=b.offsetTop-6+"px";h.left=e+"px";h.width=k+"px";h.height=l+6+
"px";return f};a.touchHold=function(b){a.subkeyDelayTimer&&(window.clearTimeout(a.subkeyDelayTimer),a.subkeyDelayTimer=null);"undefined"!=typeof b.subKeys&&null!=b.subKeys&&(a.subkeyDelayTimer=window.setTimeout(function(){a.clearPopup();a.showSubKeys(b)},a.popupDelay))};b.handleRotationEvents=function(){"iOS"==d.OS&&c.attachDOMEvent(window,"orientationchange",b.rotateDevice);"Android"==d.OS&&(a.wasVisible=a.isVisible,"onmozorientationchange"in screen?c.attachDOMEvent(screen,"mozorientationchange",
a.hideNow):c.attachDOMEvent(window,"orientationchange",a.hideNow),c.attachDOMEvent(window,"resize",function(){b.alignInputs(!0);a.hideLanguageList();a._Load();a.wasVisible&&a._Show()}))};b.rotateDevice=function(b){a.hideLanguageList();a._Visible&&(a.adjustHeights(),"phone"==d.formFactor&&"Android"==d.OS&&window.setTimeout(function(){window.scrollTo(0,1)},1E3))};a.waitForFonts=function(a,d){if("undefined"==typeof a&&"undefined"==typeof d||"undefined"==typeof a.files&&"undefined"==typeof d.files)return!0;
var f=c.checkFontDescriptor(a),e=c.checkFontDescriptor(d);if(f&&e)return!0;b.fontCheckTimer=window.setInterval(function(){c.checkFontDescriptor(a)&&c.checkFontDescriptor(d)&&(window.clearInterval(b.fontCheckTimer),b.fontCheckTimer=null,b.alignInputs(!0))},100);window.setTimeout(function(){b.fontCheckTimer&&(window.clearInterval(b.fontCheckTimer),b.fontCheckTimer=null,b.alignInputs(!0))},5E3);return!1}}();
window.keyman.initialized||(window.keyman.dfltLayout={desktop:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},
{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",
text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",
width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},
{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",
sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"200"}]}]}]},phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},
{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},
{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",
text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"200",sp:"1"}]}]}]}});(function(){var b=window.keyman,a=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(a),b.init(null))},10)})();
var CLOSURE_NO_DEPS=!0,COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(b){return void 0!==b};goog.isString=function(b){return"string"==typeof b};goog.isBoolean=function(b){return"boolean"==typeof b};goog.isNumber=function(b){return"number"==typeof b};goog.exportPath_=function(b,a,c){b=b.split(".");c=c||goog.global;b[0]in c||!c.execScript||c.execScript("var "+b[0]);for(var d;b.length&&(d=b.shift());)!b.length&&goog.isDef(a)?c[d]=a:c=c[d]&&c[d]!==Object.prototype[d]?c[d]:c[d]={}};
goog.define=function(b,a){COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&void 0===goog.global.CLOSURE_UNCOMPILED_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,b)?a=goog.global.CLOSURE_UNCOMPILED_DEFINES[b]:goog.global.CLOSURE_DEFINES&&void 0===goog.global.CLOSURE_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,b)&&(a=goog.global.CLOSURE_DEFINES[b]));goog.exportPath_(b,a)};goog.DEBUG=!0;goog.LOCALE="en";
goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(b){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');goog.constructNamespace_(b)};
goog.constructNamespace_=function(b,a){if(!COMPILED){delete goog.implicitNamespaces_[b];for(var c=b;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(b,a)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(b){if(!goog.isString(b)||!b||-1==b.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+b+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");
goog.moduleLoaderState_.moduleName=b;if(!COMPILED){if(goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');delete goog.implicitNamespaces_[b]}};goog.module.get=function(b){return goog.module.getInternal_(b)};goog.module.getInternal_=function(b){if(!COMPILED){if(b in goog.loadedModules_)return goog.loadedModules_[b];if(!goog.implicitNamespaces_[b])return b=goog.getObjectByName(b),null!=b?b:null}return null};goog.moduleLoaderState_=null;
goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(b){if(goog.DISALLOW_TEST_ONLY_CODE)throw b=b||"",Error("Importing test-only code into non-debug environment"+(b?": "+b:"."));};goog.forwardDeclare=function(b){};COMPILED||(goog.isProvided_=function(b){return b in goog.loadedModules_||!goog.implicitNamespaces_[b]&&goog.isDefAndNotNull(goog.getObjectByName(b))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(b,a){b=b.split(".");a=a||goog.global;for(var c=0;c<b.length;c++)if(a=a[b[c]],!goog.isDefAndNotNull(a))return null;return a};goog.globalize=function(b,a){a=a||goog.global;for(var c in b)a[c]=b[c]};goog.addDependency=function(b,a,c,d){if(goog.DEPENDENCIES_ENABLED){var f=goog.getLoader_();f&&f.addDependency(b,a,c,d)}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(b){goog.global.console&&goog.global.console.error(b)};
goog.require=function(b){goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_&&goog.getLoader_().earlyProcessLoad(b);if(!COMPILED){if(goog.isProvided_(b)){if(goog.isInModuleLoader_())return goog.module.getInternal_(b)}else if(goog.ENABLE_DEBUG_LOADER){var a=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{var c=goog.getLoader_();c?c.load(b):goog.logToConsole_("Could not load "+b+" because there is no debug loader.")}finally{goog.moduleLoaderState_=a}}return null}};goog.basePath="";
goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(b){b.instance_=void 0;b.getInstance=function(){if(b.instance_)return b.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=b);return b.instance_=new b}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.TRANSPILE="detect";goog.TRANSPILER="transpile.js";goog.DEBUG_LOADER="";goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var b=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(a){b=!1}goog.hasBadLetScoping=b}return goog.hasBadLetScoping};goog.workaroundSafari10EvalBug=function(b){return"(function(){"+b+"\n;})();\n"};
goog.loadModule=function(b){var a=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};if(goog.isFunction(b))var c=b.call(void 0,{});else if(goog.isString(b))goog.useSafari10Workaround()&&(b=goog.workaroundSafari10EvalBug(b)),c=goog.loadModuleFromSource_.call(void 0,b);else throw Error("Invalid module definition");var d=goog.moduleLoaderState_.moduleName;if(!goog.isString(d)||!d)throw Error('Invalid module name "'+d+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(d,c):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof c&&null!=c&&Object.seal(c);goog.loadedModules_[d]=c}finally{goog.moduleLoaderState_=a}};goog.loadModuleFromSource_=function(b){eval(b);return{}};goog.normalizePath_=function(b){b=b.split("/");for(var a=0;a<b.length;)"."==b[a]?b.splice(a,1):a&&".."==b[a]&&b[a-1]&&".."!=b[a-1]?b.splice(--a,2):a++;return b.join("/")};
goog.loadFileSync_=function(b){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(b);try{var a=new goog.global.XMLHttpRequest;a.open("get",b,!1);a.send();return 0==a.status||200==a.status?a.responseText:null}catch(c){return null}};
goog.transpile_=function(b,a){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var f=goog.basePath+goog.TRANSPILER,g=goog.loadFileSync_(f);if(g){(function(){eval(g+"\n//# sourceURL="+f)}).call(goog.global);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile;
c=goog.global.$jscomp;d=c.transpile}}d||(d=c.transpile=function(a,b){goog.logToConsole_(b+" requires transpilation but no transpiler was found.");return a});return d(b,a)};
goog.typeOf=function(b){var a=typeof b;if("object"==a)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return a;var c=Object.prototype.toString.call(b);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==a&&"undefined"==typeof b.call)return"object";return a};goog.isNull=function(b){return null===b};goog.isDefAndNotNull=function(b){return null!=b};goog.isArray=function(b){return"array"==goog.typeOf(b)};goog.isArrayLike=function(b){var a=goog.typeOf(b);return"array"==a||"object"==a&&"number"==typeof b.length};goog.isDateLike=function(b){return goog.isObject(b)&&"function"==typeof b.getFullYear};goog.isFunction=function(b){return"function"==goog.typeOf(b)};
goog.isObject=function(b){var a=typeof b;return"object"==a&&null!=b||"function"==a};goog.getUid=function(b){return b[goog.UID_PROPERTY_]||(b[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(b){return!!b[goog.UID_PROPERTY_]};goog.removeUid=function(b){null!==b&&"removeAttribute"in b&&b.removeAttribute(goog.UID_PROPERTY_);try{delete b[goog.UID_PROPERTY_]}catch(a){}};goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;
goog.removeHashCode=goog.removeUid;goog.cloneObject=function(b){var a=goog.typeOf(b);if("object"==a||"array"==a){if(b.clone)return b.clone();a="array"==a?[]:{};for(var c in b)a[c]=goog.cloneObject(b[c]);return a}return b};goog.bindNative_=function(b,a,c){return b.call.apply(b.bind,arguments)};
goog.bindJs_=function(b,a,c){if(!b)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return b.apply(a,c)}}return function(){return b.apply(a,arguments)}};goog.bind=function(b,a,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(b,a){var c=Array.prototype.slice.call(arguments,1);return function(){var a=c.slice();a.push.apply(a,arguments);return b.apply(this,a)}};goog.mixin=function(b,a){for(var c in a)b[c]=a[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(b){if(goog.global.execScript)goog.global.execScript(b,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(d){}if("undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(d){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(b);else{var a=goog.global.document,c=a.createElement("SCRIPT");c.type="text/javascript";c.defer=
!1;c.appendChild(a.createTextNode(b));a.head.appendChild(c);a.head.removeChild(c)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;
goog.getCssName=function(b,a){if("."==String(b).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+b);var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")};d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};b=a?b+"-"+d(a):d(b);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(b):b};
goog.setCssNameMapping=function(b,a){goog.cssNameMapping_=b;goog.cssNameMappingStyle_=a};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(b,a){a&&(b=b.replace(/\{\$([^}]+)}/g,function(b,d){return null!=a&&d in a?a[d]:b}));return b};goog.getMsgWithFallback=function(b,a){return b};goog.exportSymbol=function(b,a,c){goog.exportPath_(b,a,c)};goog.exportProperty=function(b,a,c){b[a]=c};
goog.inherits=function(b,a){function c(){}c.prototype=a.prototype;b.superClass_=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.base=function(b,c,g){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return a.prototype[c].apply(b,d)}};
goog.base=function(b,a,c){var d=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_){for(var f=Array(arguments.length-1),g=1;g<arguments.length;g++)f[g-1]=arguments[g];return d.superClass_.constructor.apply(b,f)}f=Array(arguments.length-2);for(g=2;g<arguments.length;g++)f[g-2]=arguments[g];g=!1;for(var h=b.constructor;h;h=
h.superClass_&&h.superClass_.constructor)if(h.prototype[a]===d)g=!0;else if(g)return h.prototype[a].apply(b,f);if(b[a]===d)return b.constructor.prototype[a].apply(b,f);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(b){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");b.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(b,a){var c=a.constructor,d=a.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,b);b&&goog.inherits(c,b);delete a.constructor;delete a.statics;goog.defineClass.applyProperties_(c.prototype,a);null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(b,a){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return b;var c=!goog.defineClass.isUnsealable_(a),d=function(){var a=b.apply(this,arguments)||this;a[goog.UID_PROPERTY_]=a[goog.UID_PROPERTY_];this.constructor===d&&c&&Object.seal instanceof Function&&Object.seal(a);return a};return d};goog.defineClass.isUnsealable_=function(b){return b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(b,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c])};goog.tagUnsealableClass=function(b){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var b=goog.global.document;return null!=b&&"write"in b},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var b=goog.global.document,a=b.currentScript;b=a?[a]:b.getElementsByTagName("SCRIPT");for(a=b.length-1;0<=a;--a){var c=b[a].src,d=c.lastIndexOf("?");d=-1==d?c.length:d;if("base.js"==c.substr(d-
7,7)){goog.basePath=c.substr(0,d-7);break}}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function b(a,b){d?c[a]=!0:b()?c[a]=!1:d=c[a]=!0}function a(a){try{return!!eval(a)}catch(h){return!1}}var c={es3:!1},d=!1,f=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";b("es5",function(){return a("[1,].length==1")});b("es6",function(){var b=f.match(/Edge\/(\d+)(\.\d)*/i);
return b&&15>Number(b[1])?!1:a('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')});b("es6-impl",function(){return!0});b("es7",function(){return a("2 ** 2 == 4")});b("es8",function(){return a("async () => 1, true")});return c},goog.Transpiler.prototype.needsTranspile=
function(b){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;this.requiresTranspilation_||(this.requiresTranspilation_=this.createRequiresTranspilation_());if(b in this.requiresTranspilation_)return this.requiresTranspilation_[b];throw Error("Unknown language mode: "+b);},goog.Transpiler.prototype.transpile=function(b,a){return goog.transpile_(b,a)},goog.transpiler_=new goog.Transpiler,goog.DebugLoader=function(){this.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},
written:{},deferred:{}};this.oldIeWaiting_=!1;this.queuedModules_=[];this.lastNonModuleScriptIndex_=0},goog.DebugLoader.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader.prototype.earlyProcessLoad=function(b){goog.DebugLoader.IS_OLD_IE_&&this.maybeProcessDeferredDep_(b)},goog.DebugLoader.prototype.load=function(b){var a=this.getPathFromDeps_(b);if(a){var c=function(a){if(!(a in g.written||a in g.visited)){g.visited[a]=!0;if(a in g.requires)for(var b in g.requires[a])if(!h.isProvided(b))if(b in
g.nameToPath)c(g.nameToPath[b]);else throw Error("Undefined nameToPath for "+b);a in f||(f[a]=!0,d.push(a))}},d=[],f={},g=this.dependencies_,h=this;c(a);for(b=0;b<d.length;b++)a=d[b],this.dependencies_.written[a]=!0;for(b=0;b<d.length;b++)if(a=d[b]){var e=g.loadFlags[a]||{},k=e.lang||"es3";k=this.getTranspiler().needsTranspile(k);"goog"==e.module||k?this.importProcessedScript_(goog.basePath+a,"goog"==e.module,k):this.importScript_(goog.basePath+a)}else throw Error("Undefined script input");}else throw b=
"goog.require could not find: "+b,this.logToConsole(b),Error(b);},goog.DebugLoader.prototype.addDependency=function(b,a,c,d){var f;b=b.replace(/\\/g,"/");var g=this.dependencies_;d&&"boolean"!==typeof d||(d=d?{module:"goog"}:{});for(var h=0;f=a[h];h++)g.nameToPath[f]=b,g.loadFlags[b]=d;for(d=0;a=c[d];d++)b in g.requires||(g.requires[b]={}),g.requires[b][a]=!0},goog.DebugLoader.prototype.importScript_=function(b,a){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this))(b,a)&&(this.dependencies_.written[b]=
!0)},goog.DebugLoader.prototype.importProcessedScript_=function(b,a,c){this.importScript_("",'goog.debugLoader_.retrieveAndExec_("'+b+'", '+a+", "+c+");")},goog.DebugLoader.prototype.retrieveAndExec_=function(b,a,c){if(!COMPILED){var d=b;b=this.normalizePath(b);var f=goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this),g=this.loadFileSync(b);if(null==g)throw Error('Load of "'+b+'" failed');c&&(g=this.getTranspiler().transpile(g,b));g=a?this.wrapModule_(b,g):g+("\n//# sourceURL="+
b);goog.DebugLoader.IS_OLD_IE_&&this.oldIeWaiting_?(this.dependencies_.deferred[d]=g,this.queuedModules_.push(d)):f(b,g)}},goog.DebugLoader.prototype.wrapModule_=function(b,a){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(a+"\n//# sourceURL="+b+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+a+"\n;return exports});\n//# sourceURL="+b+"\n"},goog.DebugLoader.prototype.loadQueuedModules_=function(){var b=this.queuedModules_.length;
if(0<b){var a=this.queuedModules_;this.queuedModules_=[];for(var c=0;c<b;c++)this.maybeProcessDeferredPath_(a[c])}this.oldIeWaiting_=!1},goog.DebugLoader.prototype.maybeProcessDeferredDep_=function(b){this.isDeferredModule_(b)&&this.allDepsAreAvailable_(b)&&(b=this.getPathFromDeps_(b),this.maybeProcessDeferredPath_(goog.basePath+b))},goog.DebugLoader.prototype.isDeferredModule_=function(b){var a=(b=this.getPathFromDeps_(b))&&this.dependencies_.loadFlags[b]||{},c=a.lang||"es3";return b&&("goog"==a.module||
this.getTranspiler().needsTranspile(c))?goog.basePath+b in this.dependencies_.deferred:!1},goog.DebugLoader.prototype.allDepsAreAvailable_=function(b){if((b=this.getPathFromDeps_(b))&&b in this.dependencies_.requires)for(var a in this.dependencies_.requires[b])if(!this.isProvided(a)&&!this.isDeferredModule_(a))return!1;return!0},goog.DebugLoader.prototype.maybeProcessDeferredPath_=function(b){if(b in this.dependencies_.deferred){var a=this.dependencies_.deferred[b];delete this.dependencies_.deferred[b];
goog.globalEval(a)}},goog.DebugLoader.prototype.writeScriptSrcNode_=function(b){goog.global.document.write('<script type="text/javascript" src="'+b+'">\x3c/script>')},goog.DebugLoader.prototype.appendScriptSrcNode_=function(b){var a=goog.global.document,c=a.createElement("script");c.type="text/javascript";c.src=b;c.defer=!1;c.async=!1;a.head.appendChild(c)},goog.DebugLoader.prototype.writeScriptTag_=function(b,a){if(this.inHtmlDocument()){var c=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&
"complete"==c.readyState){if(/\bdeps.js$/.test(b))return!1;throw Error('Cannot write "'+b+'" after document load');}void 0===a?goog.DebugLoader.IS_OLD_IE_?(this.oldIeWaiting_=!0,a=" onreadystatechange='goog.debugLoader_.onScriptLoad_(this, "+ ++this.lastNonModuleScriptIndex_+")' ",c.write('<script type="text/javascript" src="'+b+'"'+a+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?this.appendScriptSrcNode_(b):this.writeScriptSrcNode_(b):c.write('<script type="text/javascript">'+this.protectScriptTag_(a)+
"\x3c/script>");return!0}return!1},goog.DebugLoader.prototype.protectScriptTag_=function(b){return b.replace(/<\/(SCRIPT)/ig,"\\x3c/$1")},goog.DebugLoader.prototype.onScriptLoad_=function(b,a){"complete"==b.readyState&&this.lastNonModuleScriptIndex_==a&&this.loadQueuedModules_();return!0},goog.DebugLoader.prototype.getPathFromDeps_=function(b){return b in this.dependencies_.nameToPath?this.dependencies_.nameToPath[b]:null},goog.DebugLoader.prototype.getTranspiler=function(){return goog.transpiler_},
goog.DebugLoader.prototype.isProvided=function(b){return goog.isProvided_(b)},goog.DebugLoader.prototype.inHtmlDocument=function(){return goog.inHtmlDocument_()},goog.DebugLoader.prototype.logToConsole=function(b){goog.logToConsole_(b)},goog.DebugLoader.prototype.loadFileSync=function(b){return goog.loadFileSync_(b)},goog.DebugLoader.prototype.normalizePath=function(b){return goog.normalizePath_(b)},goog.debugLoader_=null,goog.registerDebugLoader=function(b){if(goog.debugLoader_)throw Error("Debug loader already registered!");
if(!(b instanceof goog.DebugLoader))throw Error("Not a goog.DebugLoader.");goog.debugLoader_=b},goog.getLoader_=function(){if(!goog.debugLoader_&&goog.DEBUG_LOADER)throw Error("Loaded debug loader file but no loader was registered!");goog.debugLoader_||(goog.debugLoader_=new goog.DebugLoader);return goog.debugLoader_},function(){if(goog.DEBUG_LOADER){var b=new goog.DebugLoader;b.importScript_(goog.basePath+goog.DEBUG_LOADER)}goog.global.CLOSURE_NO_DEPS||(b=b||new goog.DebugLoader,goog.DEBUG_LOADER||
goog.registerDebugLoader(b),b.importScript_(goog.basePath+"deps.js"))}());goog.exportSymbol("KeymanBase.prototype.addEventListener",KeymanBase.prototype.addEventListener);goog.exportSymbol("KeymanBase.prototype.isFontAvailable",KeymanBase.prototype.isFontAvailable);goog.exportSymbol("Device",Device);goog.exportSymbol("Util",Util);goog.exportSymbol("Util.prototype.attachDOMEvent",Util.prototype.attachDOMEvent);goog.exportSymbol("Util.prototype.detachDOMEvent",Util.prototype.detachDOMEvent);
goog.exportSymbol("Util.prototype.getOption",Util.prototype.getOption);goog.exportSymbol("Util.prototype.setOption",Util.prototype.setOption);goog.exportSymbol("Util.prototype.getAbsoluteX",Util.prototype._GetAbsoluteX);goog.exportSymbol("Util.prototype.getAbsoluteY",Util.prototype._GetAbsoluteY);goog.exportSymbol("Util.prototype.getAbsolute",Util.prototype._GetAbsolute);goog.exportSymbol("Util.prototype.createElement",Util.prototype.createElement);
goog.exportSymbol("Util.prototype.getIEVersion",Util.prototype.getIEVersion);goog.exportSymbol("Util.prototype.isTouchDevice",Util.prototype.isTouchDevice);goog.exportSymbol("Util.prototype.createShim",Util.prototype.createShim);goog.exportSymbol("Util.prototype.showShim",Util.prototype.showShim);goog.exportSymbol("Util.prototype.hideShim",Util.prototype.hideShim);goog.exportSymbol("Util.prototype.rgba",Util.prototype.rgba);goog.exportSymbol("Util.prototype.addStyleSheet",Util.prototype.addStyleSheet);
goog.exportSymbol("Util.prototype.removeStyleSheet",Util.prototype.removeStyleSheet);goog.exportSymbol("Util.prototype.linkStyleSheet",Util.prototype.linkStyleSheet);goog.exportSymbol("Util.prototype.addFontFaceStyleSheet",Util.prototype.addFontFaceStyleSheet);goog.exportSymbol("Util.prototype.loadCookie",Util.prototype.loadCookie);goog.exportSymbol("Util.prototype.saveCookie",Util.prototype.saveCookie);goog.exportSymbol("Util.prototype.toNumber",Util.prototype.toNumber);
goog.exportSymbol("Util.prototype.toFloat",Util.prototype.toFloat);goog.exportSymbol("Util.prototype.toNzString",Util.prototype.nzString);goog.exportSymbol("Util.prototype.alert",Util.prototype.alert);
(function(){var b=function(a,b,f){goog.exportSymbol("KeyboardInterface.prototype."+b,f);goog.exportSymbol("KeyboardInterface.prototype."+a,f)},a=function(a,b,f){goog.exportSymbol("KeyboardInterface.prototype."+b,f);goog.exportSymbol("KeyboardInterface.prototype."+a,f)};b("KSF","saveFocus",KeyboardInterface.prototype.saveFocus);b("KBR","beepReset",KeyboardInterface.prototype.beepReset);a("KT","insertText",KeyboardInterface.prototype.insertText);a("KR","registerKeyboard",KeyboardInterface.prototype.registerKeyboard);
a("KRS","registerStub",KeyboardInterface.prototype.registerStub);a("KC","context",KeyboardInterface.prototype.context);a("KN","nul",KeyboardInterface.prototype.nul);a("KCM","contextMatch",KeyboardInterface.prototype.contextMatch);a("KIK","isKeypress",KeyboardInterface.prototype.isKeypress);a("KKM","keyMatch",KeyboardInterface.prototype.keyMatch);a("KSM","stateMatch",KeyboardInterface.prototype.stateMatch);a("KKI","keyInformation",KeyboardInterface.prototype.keyInformation);a("KDM","deadkeyMatch",
KeyboardInterface.prototype.deadkeyMatch);a("KB","beep",KeyboardInterface.prototype.beep);a("KA","any",KeyboardInterface.prototype.any);a("KO","output",KeyboardInterface.prototype.output);a("KDO","deadkeyOutput",KeyboardInterface.prototype.deadkeyOutput);a("KIO","indexOutput",KeyboardInterface.prototype.indexOutput);a("KIFS","ifStore",KeyboardInterface.prototype.ifStore);a("KSETS","setStore",KeyboardInterface.prototype.setStore);a("KLOAD","loadStore",KeyboardInterface.prototype.loadStore);a("KSAVE",
"saveStore",KeyboardInterface.prototype.saveStore)})();
//# sourceMappingURL=keymanweb.js.map
