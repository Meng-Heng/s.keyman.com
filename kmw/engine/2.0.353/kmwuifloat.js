var g=!0,h=null,i=!1;
(function(){var d=window.tavultesoft.keymanweb,f=d.osk,e=d.util;if(!e.isTouchDevice()){d.ui={};var a=d.ui;a.name="float";a.a=h;a.b=h;a.e=h;a.f=h;a.d=h;a.m=i;a.n=g;a.o=h;a.c=i;a.B=function(){d.focusLastActiveElement();f.show&&(f.isEnabled()?f.hide():f.show(g));window.event&&(window.event.returnValue=i);return i};a.g=function(){if(d.initialized){if(!a.c&&!e.isTouchDevice()){var b=e.getOption("resources")+"ui/float/";a.b=e.createElement("DIV");a.e=e.createElement("DIV");a.d=e.createElement("IMG");a.b.innerHTML=
"<a href='http://keyman.com/web/' target='KeymanWebHelp'><img src='"+b+"kmicon.gif' border='0' style='padding: 0px 2px 0 1px; margin:0px;' title='KeymanWeb' alt='KeymanWeb' /></a>";var c=a.b.style;c.backgroundColor="white";c.border="solid 1px black";c.position="absolute";c.height="18px";c.font="bold 8pt sans-serif";c.display="none";c.textAlign="left";c.overflow="hidden";e.attachDOMEvent(a.b,"mousedown",a.v);e.attachDOMEvent(a.b,"mouseover",a.z);e.attachDOMEvent(a.b,"mouseout",a.w);a.A();window.createPopup&&
!("XmlHttpRequest"in window)&&(a.j=e.createShim());a.d.src=b+"kbdicon.gif";a.d.title="Display visual keyboard";a.l(i);b=e.createElement("DIV");a.f=b;b.onclick=a.B;b.appendChild(a.d);a.e.appendChild(b);a.b.appendChild(a.e);document.body.appendChild(a.b);a.j&&document.body.appendChild(a.j);a.a=e.createElement("SELECT");c=a.a.style;c.font="8pt sans-serif";c.backgroundColor="#f3e5de";c.border="solid 1px #7B9EBD";c.height="16px";c.margin="1px 2px 0px 2px";c.left="20px";c.top="0px";c.position="absolute";
c.maxWidth="150px";e.attachDOMEvent(a.a,"change",a.u);e.attachDOMEvent(a.a,"blur",a.t);a.e.appendChild(a.a);b=e.createElement("OPTION");b.value="-";b.innerHTML=e.getOption("unmappedKeyboardName","English");a.a.appendChild(b);b=e.getOption("ui");"object"==typeof b&&"undefined"!=typeof b.position&&(a.q="right"==b.position);a.c=g;a.r()}}else window.setTimeout(a.g,50)};d.addEventListener("unloaduserinterface",function(){a.a=a.e=a.b=a.d=h});a.r=function(){if(a.n){a.c||a.g();var b,c=a.a.getElementsByTagName("OPTION");
for(b=c.length;1<b;b--)a.a.removeChild(c[b-1]);var j=d.getKeyboards();for(b=0;b<j.length;b++){c=e.createElement("OPTION");c.value=j[b].InternalName+":"+j[b].LanguageCode;c.innerHTML=j[b].Name.replace(/\s?keyboard/i,"");if(j[b].LanguageName){var k=j[b].LanguageName,k=k.split(",")[0];-1==j[b].Name.search(k)&&(c.innerHTML=k+" ("+c.innerHTML+")")}a.a.appendChild(c)}}a.n=i;b=d.getSavedKeyboard().split(":");2>b.length&&(b[1]="");a.i(b[0],b[1])};a.i=function(b,c){var d=0;if(a.c){var e=b;""!=c&&(e+=":"+c);
if(""==b)a.a.selectedIndex=0;else for(var f=a.a.getElementsByTagName("OPTION"),d=0;d<f.length;d++){var l=f[d].value;""==c&&(l=l.split(":")[0]);if(l==e){a.a.selectedIndex=d;break}}}};a.l=function(b){var c=a.d.style;c.width="24px";c.height="13px";c.top="1px";c.verticalAlign="bottom";c.padding="2px 2px 1px 2px";c.position="absolute";c.border=b?"inset 1px #808080":"none";c.background=b?"#f7e7de":"white";c.display="block";a.c&&(a.f.style.display="block")};a.A=function(){d.addEventListener("keyboardregistered",
function(){a.n=g;a.o&&clearTimeout(a.o);a.o=setTimeout(a.r,200)});d.addEventListener("keyboardloaded",function(){var b=d.getSavedKeyboard().split(":");1<b.length&&a.i(b[0],b[1])});d.addEventListener("keyboardchange",function(b){a.i(b.internalName,b.languageCode);a.k()});f.addEventListener("show",function(b){a.k();return b});f.addEventListener("hide",function(){a.c&&a.l(i)})};a.v=function(){d.activatingUI&&d.activatingUI(1)};a.z=function(){d.activatingUI&&d.activatingUI(1)};a.w=function(){d.activatingUI&&
d.activatingUI(0)};a.u=function(){if("-"!=a.a.value){var b=a.a.options[a.a.selectedIndex].value.split(":");d.setActiveKeyboard(b[0],b[1])}else d.setActiveKeyboard("");d.focusLastActiveElement();a.m=g};a.t=function(){a.m||d.focusLastActiveElement();a.m=i};a.h=function(b,c){if(a.c){var e=a.b.style;b&&c&&(e.left=b+"px",e.top=c+"px");e.display="block";a.d.style.left=a.a.offsetWidth+24+"px";a.k();a.i(d.getActiveKeyboard(),d.getActiveLanguage())}};a.s=function(){a.c&&(a.b.style.display="none",e.hideShim(a.j))};
a.k=function(){a.f!=h&&(d.isCJK()||0==a.a.selectedIndex?(a.f.style.display="none",a.b.style.width=a.a.offsetWidth+30+"px"):(a.f.style.display="block",a.l(f.isEnabled()),a.b.style.width=a.a.offsetWidth+56+"px"))};d.addEventListener("controlfocused",function(b){if(b.activeControl==h||b.activeControl.LEnabled)a.q?a.h(e.getAbsoluteX(b.target)+b.target.offsetWidth+1,e.getAbsoluteY(b.target)+1):a.h(e.getAbsoluteX(b.target),e.getAbsoluteY(b.target)-parseInt(e.getStyleValue(a.b,"height"),10)-2);return g});
d.addEventListener("controlblurred",function(b){if(!b.event)return g;b.isActivating||a.s();return g});a.p=function(){if("block"==a.b.style.display){var b=d.getLastActiveElement();a.q?a.h(e.getAbsoluteX(b)+b.offsetWidth+1,e.getAbsoluteY(b)+1):a.h(e.getAbsoluteX(b)+1,e.getAbsoluteY(b)+b.offsetHeight+1)}return g};window.addEventListener?window.addEventListener("resize",a.p,i):window.attachEvent("onresize",a.p);d.addEventListener("loaduserinterface",a.g);a.g()}})();
