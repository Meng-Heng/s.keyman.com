(function(){var e=window.tavultesoft.keymanweb,h=e.osk,g=e.util;if(!g.isTouchDevice()){e.ui={};var a=e.ui;a.name="button";a.init=!1;a.KeyboardSelector=null;a.KeymanWeb_DefaultKeyboardHelp='<span style="font-size:7.5pt">KeymanWeb is not running.  Choose a keyboard from the list</span>';a._KeymanWeb_KbdList=null;a._KMWSel=null;a._IsHelpVisible=!1;a._DefaultKeyboardID="";a.updateTimer=null;a.updateList=!0;a._ShowSelected=function(){for(var c,b=e.getActiveKeyboard(),d=e.getActiveLanguage(),f=a._KeymanWeb_KbdList.childNodes,
g=/^KMWSel_(.*)\$(.*)$/,i=1;i<f.length;i++)f[i].childNodes[0].className="";for(i=2;i<f.length&&(!(c=g.exec(f[i].childNodes[0].id))||!(c[1]==b&&c[2]==d));i++);i>=f.length&&(i=1);f[i].childNodes[0].className="selected"};a._SelectKeyboard=function(c){"undefined"!=typeof this.id&&(c=this.id);var b=/^KMWSel_(.*)\$(.*)$/.exec(c),d="",f="";if(null!==b){f=b[1].split("$")[0];d=c.split("$")[1];null!=a._KMWSel&&(a._KMWSel.className="");if(c=document.getElementById(c))c.className="selected";a._KMWSel=c;e.setActiveKeyboard(f,
d)}else f=null;e.focusLastActiveElement();h.isEnabled()&&h.show(!0);a._ShowKeyboardButton(f);return!1};a._SelectorMouseDown=function(){e.getLastActiveElement()?e.focusLastActiveElement():a._FocusFirstInput();e.activatingUI&&e.activatingUI(1)};a._SelectorMouseUp=function(){e.getLastActiveElement()?e.focusLastActiveElement():a._FocusFirstInput()};a._SelectorMouseOver=function(){a._ShowSelected();e.activatingUI&&e.activatingUI(1);document.getElementById("kmwico_li").className="sfhover";a._ShowKeyboardButton()};
a._FocusFirstInput=function(){var a,b=null,d=null,f=document.getElementsByTagName("input"),e=document.getElementsByTagName("textarea");for(a=0;a<f.length&&"text"!=f[a].type;a++);a<f.length&&(b=f[a]);0<e.length&&(d=e[0]);if(b||d)b&&!d?b.focus():d&&!b?d.focus():b.offsetTop<d.offsetTop?b.focus():b.offsetTop>d.offsetTop?d.focus():b.offsetLeft<d.offsetLeft?b.focus():d.focus()};a._SelectorMouseOut=function(){e.activatingUI&&e.activatingUI(0);document.getElementById("kmwico_li").className="sfunhover"};a._ShowKeyboardButton=
function(a){var b=e.getActiveKeyboard(),d=document.getElementById("KMW_Keyboard");0<arguments.length&&(b=a);d&&(d.className=""==b||e.isCJK()?"kmw_disabled":h.isEnabled()?"kmw_show":"kmw_hide")};h.addEventListener("show",function(c){var b=e.getLastActiveElement();b&&!c.userLocated&&(c.x=g.getAbsoluteX(b),c.y=g.getAbsoluteY(b)+b.offsetHeight);a._ShowKeyboardButton();return c});h.addEventListener("hide",function(a){if(0<arguments.length&&a){var b=document.getElementById("KMW_Keyboard");b&&(b.className=
"kmw_hide")}});a._ShowKeymanWebKeyboard=function(){"kmw_disabled"!=document.getElementById("KMW_Keyboard").className&&h.show&&(h.isEnabled()?h.hide():h.show(!0));window.event&&(window.event.returnValue=!1);e.focusLastActiveElement();return!1};a.Initialize=function(){if(e.initialized){if(!a.init&&!g.isTouchDevice()){a.init=!0;g.addStyleSheet(a._Appearance);a._KeymanWeb_KbdList=g.createElement("ul");a._KeymanWeb_KbdList.id="KeymanWeb_KbdList";var c=document.getElementById("KeymanWebControl");if(!c)for(var b=
document.getElementsByTagName("div"),d=0;d<b.length;d++)if("KeymanWebControl"==b[d].className){c=b[d];break}b=g.getOption("resources")+"ui/button/";if(c){d=document.createElement("DIV");d.style.clear="both";c.parentNode.insertBefore(d,c.nextSibling);var d=g.createElement("img"),f=g.createElement("ul"),j=g.createElement("li");d.id="kmwico_a";d.src=b+"kmw_button.gif";d.onclick=function(){return!1};j.appendChild(d);j.id="kmwico_li";f.appendChild(j);f.id="kmwico";f.style.display="block";c.appendChild(f)}e.iOS||
(c=g.createElement("li"),d=g.createElement("a"),f=g.createElement("img"),f.src=b+"kbdicon.gif",d.appendChild(f),f=document.createTextNode(" Hide Keyboard"),b=document.createTextNode(" Show Keyboard"),j=g.createElement("span"),j.id="KMW_KbdVisibleMsg",j.appendChild(f),d.appendChild(j),f=g.createElement("span"),f.id="KMW_KbdHiddenMsg",f.appendChild(b),d.appendChild(f),d.onmousedown=a._ShowKeymanWebKeyboard,d.href="#",d.id="KMW_Keyboard",c.id="KMW_ButtonUI_KbdIcon",c.appendChild(d),a._KMWSel=d,a._KeymanWeb_KbdList.appendChild(c));
b=g.createElement("li");b.id="KMW_ButtonUI_KbdList";c=g.createElement("a");c.appendChild(document.createTextNode("English"));c.onclick=a._SelectKeyboard;c.href="#";c.id="KMWSel_$";c.className="selected";b.appendChild(c);a._KMWSel=c;a._KeymanWeb_KbdList.appendChild(b);e.getKeyboards();a.updateKeyboardList();document.getElementById("kmwico_li").appendChild(a._KeymanWeb_KbdList);b=document.getElementById("kmwico_li");g.attachDOMEvent(b,"mousedown",a._SelectorMouseDown);g.attachDOMEvent(b,"mouseover",
a._SelectorMouseOver);g.attachDOMEvent(b,"mouseout",a._SelectorMouseOut);g.attachDOMEvent(b,"mouseup",a._SelectorMouseUp);e.focusLastActiveElement()}}else window.setTimeout(a.Initialize,250)};e.addEventListener("keyboardregistered",function(){a.updateList=!0;a.updateTimer&&clearTimeout(a.updateTimer);a.updateTimer=setTimeout(a.updateKeyboardList,200)});a.updateKeyboardList=function(){a.updateList=!1;var c=e.getKeyboards();if(0<c.length)for(var b=0;b<c.length;b++)a.registerKeyboard(c[b].InternalName,
c[b].LanguageName,c[b].Name,c[b].LanguageCode,c[b].RegionCode)};a.registerKeyboard=function(c,b,d,e){var j=g.createElement("li"),i=g.createElement("a"),h=d.replace(/\s?keyboard/i,"");b&&(b=b.split(",")[0],-1==d.search(b)&&(h=b+" ("+h+")"));26<h.length&&(h=h.substr(0,24)+"\u2026");i.appendChild(document.createTextNode(h));i.onclick=a._SelectKeyboard;i.href="#";i.id="KMWSel_"+c+"$"+e;j.appendChild(i);a._KeymanWeb_KbdList.appendChild(j)};a._Appearance="#kmwico, #kmwkbd {vertical-align: middle;} #KeymanWebControl {float:left;} #KeymanWebControl * {letter-spacing: 0px !important;line-height: 1li !important;white-space: nowrap !important;} #KeymanWebControl #kmwico img {vertical-align: top;padding: 0;margin: 0;border: none;} #KeymanWebControl #kmwico, #kmwico ul {padding: 0;margin: 0;list-style: none;} #KeymanWebControl #kmwico_a {display: block;width: 22px; height: 23px; } #KeymanWebControl #kmwico li { text-align: left;} #KeymanWebControl #kmwico li ul {display: block;position: absolute;left: -5999px;border: solid 2px #ad4a28;background: white;border-radius: 4px;box-shadow: 4px 4px 2px #666;z-index: 10011;} #KeymanWebControl #kmwico li.sfunhover ul {display: none; left: -5999px;} #KeymanWebControl #kmwico li:hover ul, #kmwico li.sfhover ul {display: block;left: auto;} #KeymanWebControl #kmwico ul li {float: none;padding: 0 !important;margin: 0 !important;width: 136px !important;} #KeymanWebControl #KMW_LanguageName {font-weight: bold;} #KeymanWebControl #kmwico ul li a, #kmwico ul li a:visited {display: block;padding: 2px 4px !important;border: none !important;color: #404040;font-family: Tahoma,Verdana,Arial,sans-serif;font-size: 8pt;text-decoration: none;} #KeymanWebControl #kmwico ul li a.selected {font-weight: bold;color: black;} #KeymanWebControl #kmwico ul li a:hover {color: white;background-color: #ad4a28;} #KeymanWebControl #kmwico ul li a.kmw_disabled, #KeymanWebControl #kmwico ul li a.kmw_disabled:hover {color: #c0c0c0; cursor: default;background-color: white;} #KeymanWebControl #kmwico ul li a.kmw_show span#KMW_KbdHiddenMsg, #KeymanWebControl #kmwico ul li a.kmw_disabled span#KMW_KbdVisibleMsg {display: none;} #KeymanWebControl #kmwico ul li a.kmw_show span#KMW_KbdVisibleMsg {display: inline;} #KeymanWebControl #kmwico ul li a.kmw_hide span#KMW_KbdHiddenMsg {display: inline;} #KeymanWebControl #kmwico ul li a.kmw_hide span#KMW_KbdVisibleMsg {display: none;} #KeymanWebControl #kmwico ul li#KMW_ButtonUI_KbdIcon {border-bottom: solid 1px #ad4a28;} ";
e.addEventListener("loaduserinterface",a.Initialize);a.Initialize()}})();
