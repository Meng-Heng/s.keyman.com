var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,h){b!=Array.prototype&&b!=Object.prototype&&(b[d]=h.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,d,h,k){if(d){h=$jscomp.global;b=b.split(".");for(k=0;k<b.length-1;k++){var g=b[k];g in h||(h[g]={});h=h[g]}b=b[b.length-1];k=h[b];d=d(k);d!=k&&null!=d&&$jscomp.defineProperty(h,b,{configurable:!0,writable:!0,value:d})}};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},d={};try{return d.__proto__=b,d.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,d){b.__proto__=d;if(b.__proto__!==d)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,h,k){var g=this.length||0;0>h&&(h=Math.max(0,g+h));if(null==k||k>g)k=g;k=Number(k);0>k&&(k=Math.max(0,g+k));for(h=Number(h||0);h<k;h++)this[h]=b;return this}},"es6","es3");var com;(function(b){(function(b){var d=function(){return function(b,g){this.keyboard=b;this.touchEnabled=g}}();b.AttachmentInfo=d;d=function(){return function(b,g){this.cmd=b;this.state=g}}();b.StyleCommand=d})(b.keyman||(b.keyman={}))})(com||(com={}));
function finallyConstructor(b){var d=this.constructor;return this.then(function(h){return d.resolve(b()).then(function(){return h})},function(h){return d.resolve(b()).then(function(){return d.reject(h)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(b,d){return function(){b.apply(d,arguments)}}
function Promise(b){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof b)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(b,this)}
function handle(b,d){for(;3===b._state;)b=b._value;0===b._state?b._deferreds.push(d):(b._handled=!0,Promise._immediateFn(function(){var h=1===b._state?d.onFulfilled:d.onRejected;if(null===h)(1===b._state?resolve:reject)(d.promise,b._value);else{try{var k=h(b._value)}catch(g){reject(d.promise,g);return}resolve(d.promise,k)}}))}
function resolve(b,d){try{if(d===b)throw new TypeError("A promise cannot be resolved with itself.");if(d&&("object"===typeof d||"function"===typeof d)){var h=d.then;if(d instanceof Promise){b._state=3;b._value=d;finale(b);return}if("function"===typeof h){doResolve(bind(h,d),b);return}}b._state=1;b._value=d;finale(b)}catch(k){reject(b,k)}}function reject(b,d){b._state=2;b._value=d;finale(b)}
function finale(b){2===b._state&&0===b._deferreds.length&&Promise._immediateFn(function(){b._handled||Promise._unhandledRejectionFn(b._value)});for(var d=0,h=b._deferreds.length;d<h;d++)handle(b,b._deferreds[d]);b._deferreds=null}function Handler(b,d,h){this.onFulfilled="function"===typeof b?b:null;this.onRejected="function"===typeof d?d:null;this.promise=h}
function doResolve(b,d){var h=!1;try{b(function(b){h||(h=!0,resolve(d,b))},function(b){h||(h=!0,reject(d,b))})}catch(k){h||(h=!0,reject(d,k))}}Promise.prototype["catch"]=function(b){return this.then(null,b)};Promise.prototype.then=function(b,d){var h=new this.constructor(noop);handle(this,new Handler(b,d,h));return h};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(b){return new Promise(function(d,h){function k(c,f){try{if(f&&("object"===typeof f||"function"===typeof f)){var l=f.then;if("function"===typeof l){l.call(f,function(a){k(c,a)},h);return}}g[c]=f;0===--a&&d(g)}catch(B){h(B)}}if(!b||"undefined"===typeof b.length)throw new TypeError("Promise.all accepts an array");var g=Array.prototype.slice.call(b);if(0===g.length)return d([]);for(var a=g.length,e=0;e<g.length;e++)k(e,g[e])})};
Promise.resolve=function(b){return b&&"object"===typeof b&&b.constructor===Promise?b:new Promise(function(d){d(b)})};Promise.reject=function(b){return new Promise(function(d,h){h(b)})};Promise.race=function(b){return new Promise(function(d,h){for(var k=0,g=b.length;k<g;k++)b[k].then(d,h)})};Promise._immediateFn="function"===typeof setImmediate&&function(b){setImmediate(b)}||function(b){setTimeoutFunc(b,0)};
Promise._unhandledRejectionFn=function(b){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
(function(b){b=b.keyman||(b.keyman={});(b.environment||(b.environment={})).VERSION="12.0"})(com||(com={}));(function(b){b.keyman||(b.keyman={})})(com||(com={}));
(function(b){b=b.keyman||(b.keyman={});(b.text||(b.text={})).Codes={modifierCodes:{LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384},modifierBitmasks:{ALL:127,ALT_GR_SIM:5,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112},stateBitmasks:{ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288},keyCodes:{K_BKSP:8,K_TAB:9,K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,K_SPACE:32,
K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,K_NP2:98,K_NP3:99,K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,K_NPPLUS:107,
K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,K_QUOTE:222,K_oE2:226,K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,K_CURRENCIES:50005,K_UPPER:50006,
K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012},codesUS:[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']]}})(com||(com={}));
(function(b){(function(d){(function(h){var k=function(){return function(){}}();h.KeyEvent=k;var g=function(){return function(){}}();h.LegacyKeyEvent=g;g=function(){function a(){this.stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};this.modStateFlags=0;this.swallowKeypress=!1}a.prototype.defaultKeyOutput=function(a,c,f,l,g){var e=b.keyman.singleton,B=e.domManager,d="",n=!1,k=g&&"undefined"!=typeof g.base;0==f?n=!0:f==h.Codes.modifierCodes.SHIFT?(n=!0,f=1):console.warn("KMW only defines default key output for the 'default' and 'shift' layers!");
if(k||l)switch((k=h.Codes.keyCodes[a])||(k=c),k){case h.Codes.keyCodes.K_BKSP:e.interface.defaultBackspace();break;case h.Codes.keyCodes.K_TAB:B.moveToNext(f);break;case h.Codes.keyCodes.K_TABBACK:B.moveToNext(!0);break;case h.Codes.keyCodes.K_TABFWD:B.moveToNext(!1);break;case h.Codes.keyCodes.K_ENTER:if("TEXTAREA"==g.nodeName||"undefined"!=typeof g.base&&"TEXTAREA"==g.base.nodeName)return"\n";if(l){if(b.keyman.Util.instanceof(g,"HTMLInputElement"))var q=g;else"undefined"!=typeof g.base&&b.keyman.Util.instanceof(g.base,
"HTMLInputElement")&&(q=g.base);!q||"search"!=q.type&&"submit"!=q.type?B.moveToNext(!1):(q.disabled=!1,q.form.submit())}break;case h.Codes.keyCodes.K_SPACE:return" "}if("U_"==a.substr(0,2))a=parseInt(a.substr(2,6),16),0<=a&&31>=a||128<=a&&159>=a?console.log("Suppressing Unicode control code: U_00"+a.toString(16)):d=String.kmwFromCharCode(a);else if(n)try{c>=h.Codes.keyCodes.K_0&&c<=h.Codes.keyCodes.K_9?d=h.Codes.codesUS[f][0][c-h.Codes.keyCodes.K_0]:c>=h.Codes.keyCodes.K_A&&c<=h.Codes.keyCodes.K_Z?
d=String.fromCharCode(c+(f?0:32)):c>=h.Codes.keyCodes.K_COLON&&c<=h.Codes.keyCodes.K_BKQUOTE?d=h.Codes.codesUS[f][1][c-h.Codes.keyCodes.K_COLON]:c>=h.Codes.keyCodes.K_LBRKT&&c<=h.Codes.keyCodes.K_QUOTE&&(d=h.Codes.codesUS[f][2][c-h.Codes.keyCodes.K_LBRKT])}catch(u){console.error("Error detected with default mapping for key:  code = "+c+", shift state = "+(1==f?"shift":"default"))}return d};a.prototype._GetKeyEventProperties=function(a,c){c=new k;var f=b.keyman.singleton;a=f._GetEventObject(a);c.Ltarg=
f.util.eventTarget(a);if(null==c.Ltarg||!0===a.cancelBubble)return null;3==c.Ltarg.nodeType&&(c.Ltarg=c.Ltarg.parentNode);c.Lcode=this._GetEventKeyCode(a);if(null==c.Lcode)return null;var l=this.modStateFlags,e=!1,g=!1;var m=h.Codes.keyCodes;switch(c.Lcode){case m.K_CTRL:case m.K_LCTRL:case m.K_RCTRL:case m.K_CONTROL:case m.K_LCONTROL:case m.K_RCONTROL:e=!0;break;case m.K_LMENU:case m.K_RMENU:case m.K_ALT:case m.K_LALT:case m.K_RALT:g=!0}m=0|(a.getModifierState("Shift")?16:0);var p=h.Codes.modifierCodes;
a.getModifierState("Control")&&(m|=0!=a.location&&e?1==a.location?p.LCTRL:p.RCTRL:l&3);a.getModifierState("Alt")&&(m|=0!=a.location&&g?1==a.location?p.LALT:p.RALT:l&12);c.Lstates=0;c.Lstates|=a.getModifierState("CapsLock")?p.CAPS:p.NO_CAPS;c.Lstates|=a.getModifierState("NumLock")?p.NUM_LOCK:p.NO_NUM_LOCK;c.Lstates|=a.getModifierState("ScrollLock")||a.getModifierState("Scroll")?p.SCROLL_LOCK:p.NO_SCROLL_LOCK;m|=c.Lstates;c.LmodifierChange=this.modStateFlags!=m;this.modStateFlags=m;e=p.RALT|p.LCTRL;
(l&e)==e&&(m&e)!=e&&(m&=~e);m&p.RALT&&(m&=~p.LCTRL);l=h.Codes.modifierBitmasks;f.keyboardManager.isChiral()?(c.Lmodifiers=m&l.CHIRAL,d.osk.Layouts.emulatesAltGr()&&(c.Lmodifiers&l.ALT_GR_SIM)==l.ALT_GR_SIM&&(c.Lmodifiers^=l.ALT_GR_SIM,c.Lmodifiers|=p.RALT)):c.Lmodifiers=m&16|(m&(p.LCTRL|p.RCTRL)?32:0)|(m&(p.LALT|p.RALT)?64:0);(f=f.keyboardManager.activeKeyboard)&&f.KM&&this.setMnemonicCode(c,a.getModifierState("Shift"),a.getModifierState("CapsLock"));c.LisVirtualKeyCode="undefined"!=typeof a.charCode&&
null!=a.charCode&&(0==a.charCode||0!=(c.Lmodifiers&111));c.LisVirtualKey=c.LisVirtualKeyCode||"keypress"!=a.type;return c};a.prototype.clickKey=function(a){var c=b.keyman.singleton,f=c.domManager.getLastActiveElement(),l=c.keyboardManager.activeKeyboard,e=c.interface,g=c.util.device.formFactor;if(null!=f){var k=a.key.spec.layer||"",p=a.keyId.toUpperCase();this.getModifierState(c.osk.vkbd.layerId);var n=a.key.spec.nextlayer;c.domManager.initActiveElement(f);if("K_LOPT"==p||"K_ROPT"==p)return c.osk.vkbd.optionKey(a,
p,!0),!0;c.osk.vkbd.highlightKey(a,!1);if("desktop"==g&&this.selectLayer(p,n))return!0;var r=f._KeymanWebSelectionStart;var q=f._KeymanWebSelectionEnd;c.uiManager.setActivatingUI(!0);b.keyman.DOMEventHandlers.states._IgnoreNextSelChange=100;c.domManager.focusLastActiveElement();c.domManager._IsMozillaEditableIframe(f,0)&&(f=f.contentDocument.documentElement);f._KeymanWebSelectionStart=r;f._KeymanWebSelectionEnd=q;b.keyman.DOMEventHandlers.states._IgnoreNextSelChange=0;c._CachedSelectionStart=null;
e._DeadkeyDeleteMatched();r={Ltarg:f,Lmodifiers:0,Lstates:0,Lcode:h.Codes.keyCodes[p],LisVirtualKey:!0,vkCode:0};r.Lstates|=this.stateKeys.K_CAPS?h.Codes.modifierCodes.CAPS:h.Codes.modifierCodes.NO_CAPS;r.Lstates|=this.stateKeys.K_NUMLOCK?h.Codes.modifierCodes.NUM_LOCK:h.Codes.modifierCodes.NO_NUM_LOCK;r.Lstates|=this.stateKeys.K_SCROLL?h.Codes.modifierCodes.SCROLL_LOCK:h.Codes.modifierCodes.NO_SCROLL_LOCK;"U_"==p.substr(0,2)&&(r.LisVirtualKey=!1);"undefined"==typeof r.Lcode&&(r.Lcode=this.getVKDictionaryCode(p),
r.Lcode||(r.Lcode=1));a=this.getModifierState(a.key.spec.layer||k);r.Lmodifiers=a;(r.Lmodifiers&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&d.osk.Layouts.emulatesAltGr()&&(r.Lmodifiers&=~h.Codes.modifierBitmasks.ALT_GR_SIM,r.Lmodifiers|=h.Codes.modifierCodes.RALT);!l||!l.KM||l.KVKL&&"desktop"!=g?r.vkCode=r.Lcode:r.Lcode!=h.Codes.keyCodes.K_SPACE&&(r.vkCode=r.Lcode,this.setMnemonicCode(r,-1!=k.indexOf("shift"),this.stateKeys.K_CAPS));"undefined"==typeof l.KM&&(r.Lcode=
c.keyMapManager._USKeyCodeToCharCode(r),r.LisVirtualKey=!1);if(!l||0!=r.Lcode&&!e.processKeystroke(c.util.device,f,r))switch(r.Lcode=r.vkCode,p){case "K_CAPS":case "K_NUMLOCK":case "K_SCROLL":this.stateKeys[p]=!this.stateKeys[p];b.keyman.singleton.osk._Show();break;default:(l=this.defaultKeyOutput(p,r.Lcode,a,!0,f))&&e.output(0,f,l)}this.selectLayer(p,n);f._KeymanWebSelectionStart=null;f._KeymanWebSelectionEnd=null}c.uiManager.setActivatingUI(!1);return!0};a.prototype.setMnemonicCode=function(a,c,
f){a.Lcode!=h.Codes.keyCodes.K_SPACE&&(c=this.defaultKeyOutput("K_xxxx",a.Lcode,c?16:0,!1,null))&&(a.Lcode=c.charCodeAt(0));f&&(65<=a.Lcode&&90>=a.Lcode||97<=a.Lcode&&122>=a.Lcode)&&(a.Lmodifiers^=16,a.Lcode^=32)};a.prototype.getModifierState=function(a){var c=0;0<=a.indexOf("shift")&&(c|=h.Codes.modifierCodes.SHIFT);var f=!1;0<=a.indexOf("leftctrl")&&(c|=h.Codes.modifierCodes.LCTRL,f=!0);0<=a.indexOf("rightctrl")&&(c|=h.Codes.modifierCodes.RCTRL,f=!0);0<=a.indexOf("ctrl")&&!f&&(c|=h.Codes.modifierCodes.CTRL);
f=!1;0<=a.indexOf("leftalt")&&(c|=h.Codes.modifierCodes.LALT,f=!0);0<=a.indexOf("rightalt")&&(c|=h.Codes.modifierCodes.RALT,f=!0);0<=a.indexOf("alt")&&!f&&(c|=h.Codes.modifierCodes.ALT);return c};a.prototype.getVKDictionaryCode=function(a){var c=b.keyman.singleton.keyboardManager.activeKeyboard;if(!c.VKDictionary){var f=[];if("string"==typeof c.KVKD)for(var l=c.KVKD.split(" "),e=0;e<l.length;e++)f[l[e].toUpperCase()]=e+256;c.VKDictionary=f}return(a=c.VKDictionary[a.toUpperCase()])?a:0};a.prototype._UpdateVKShift=
function(a,c,f){var l=0,e=b.keyman.singleton,g=["CAPS","NUM_LOCK","SCROLL_LOCK"],k=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(a)for(l=a.Lmodifiers,c=a.Lstates,e.keyboardManager.isChiral()&&d.osk.Layouts.emulatesAltGr()&&(this.modStateFlags&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&(l|=h.Codes.modifierBitmasks.ALT_GR_SIM,l&=~h.Codes.modifierCodes.RALT),a=0;a<g.length;a++)c&h.Codes.stateBitmasks[g[a]]&&(this.stateKeys[k[a]]=c&h.Codes.modifierCodes[g[a]]);else if(f)for(l|=
c,a=0;a<g.length;a++)c&h.Codes.stateBitmasks[g[a]]&&(this.stateKeys[k[a]]=!0);else for(l&=~c,a=0;a<g.length;a++)c&h.Codes.stateBitmasks[g[a]]&&(this.stateKeys[k[a]]=!1);e.osk.vkbd&&e.osk.vkbd.showLayer(this.getLayerId(l));e.osk._Visible&&e.osk._Show();return!0};a.prototype.getLayerId=function(a){return d.osk.Layouts.getLayerId(a)};a.prototype.selectLayer=function(a,c){var f=2>arguments.length?null:c,l=b.keyman.singleton.keyboardManager.isChiral();"number"==typeof f&&(f=this.getLayerId(16*f));if(!f)switch(a){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":f=
"shift";break;case "K_LCONTROL":case "K_LCTRL":if(l){f="leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(l){f="rightctrl";break}case "K_CTRL":f="ctrl";break;case "K_LMENU":case "K_LALT":if(l){f="leftalt";break}case "K_RMENU":case "K_RALT":if(l){f="rightalt";break}case "K_ALT":f="alt";break;case "K_ALTGR":f=l?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":f="default"}if(!f)return!1;this.updateLayer(f);b.keyman.singleton.osk._Show();
return!0};a.prototype.updateLayer=function(a){var c=b.keyman.singleton,f=c.osk.vkbd;if(f){var l=f.layerId,e=l;if(a==l&&"desktop"!=c.util.device.formFactor)return!1;var g=a;if("desktop"==c.util.device.formFactor){var d="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(c=0;c<d.length;c++)g=g.replace(d[c]+"-",""),g=g.replace(d[c],"");if("default"==l||"numeric"==l||"symbol"==l||"currency"==l||""!=g)e=a;else{l=this.getModifierState(e);for(c=0;c<d.length;c++)e=e.replace(d[c]+"-",""),e=
e.replace(d[c],"");switch(a){case "shift":l^=h.Codes.modifierCodes.SHIFT;break;case "leftctrl":l^=h.Codes.modifierCodes.LCTRL;break;case "rightctrl":l^=h.Codes.modifierCodes.RCTRL;break;case "ctrl":l^=h.Codes.modifierCodes.CTRL;break;case "leftalt":l^=h.Codes.modifierCodes.LALT;break;case "rightalt":l^=h.Codes.modifierCodes.RALT;break;case "alt":l^=h.Codes.modifierCodes.ALT;break;default:e=a}"default"!=e&&(e=""==e?this.getLayerId(l):this.getLayerId(l)+"-"+e)}""==e&&(e="default")}else e=a;f&&(f.showLayer(e)||
f.showLayer("default"))}};a.prototype._GetEventKeyCode=function(a){return a.keyCode?a.keyCode:a.which?a.which:null};a.prototype.doModifierPress=function(a,c){c=b.keyman.singleton;switch(a.Lcode){case 8:c.interface.clearDeadkeys();break;case 16:case 17:case 18:case 20:case 144:case 145:return c.keyboardManager.notifyKeyboard(a.Lcode,a.Ltarg,1),c.util.device.touchable?!0:this._UpdateVKShift(a,a.Lcode-15,1)}a.LmodifierChange&&(c.keyboardManager.notifyKeyboard(0,a.Ltarg,1),this._UpdateVKShift(a,0,1));
return!1};a.prototype.keyDown=function(a){var c=b.keyman.singleton,f=c.keyboardManager.activeKeyboard,l=c.util,e=c["interface"],g=c.keyMapManager;this.swallowKeypress=!1;c=this._GetKeyEventProperties(a,!0);if(null==c||this.doModifierPress(c,!0))return!0;!window.event&&g.browserMap.FF["k"+c.Lcode]&&(c.Lcode=g.browserMap.FF["k"+c.Lcode]);if(f.KM){if(8==c.Lcode)return this.swallowKeypress=!0,e.processKeystroke(l.physicalDevice,c.Ltarg,c)||e.defaultBackspace(),!1;this.swallowKeypress=!1;d=d||e.processKeystroke(l.physicalDevice,
c.Ltarg,c)}else{var d=0,k=g.languageMap[b.keyman.osk.Layouts._BaseLayout];k&&k["k"+c.Lcode]&&(c.Lcode=k["k"+c.Lcode]);"undefined"!=typeof f.KM||c.Lmodifiers&96||(g={Lcode:g._USKeyCodeToCharCode(c),Ltarg:c.Ltarg,Lmodifiers:0,LisVirtualKey:0},e.processKeystroke(l.physicalDevice,g.Ltarg,g)&&(d=1));d=d||e.processKeystroke(l.physicalDevice,c.Ltarg,c);8==c.Lcode&&!d&&null!=c.Ltarg.className&&0<=c.Ltarg.className.indexOf("keymanweb-input")&&e.defaultBackspace()}!d&&c.Lcode>=h.Codes.keyCodes.K_NP0&&c.Lcode<=
h.Codes.keyCodes.K_NPSLASH&&!f.KM&&(e.output(0,c.Ltarg,String._kmwFromCharCode(106>c.Lcode?c.Lcode-48:c.Lcode-64)),d=1);if(d)return a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),this.swallowKeypress=a?0!=this._GetEventKeyCode(a):!1,!1;this.swallowKeypress=!1;return 8==c.Lcode&&null!=c.Ltarg.className&&0<=c.Ltarg.className.indexOf("keymanweb-input")?!1:"undefined"!=typeof c.Ltarg.base&&(a=this.defaultKeyOutput("",c.Lcode,c.Lmodifiers,!1,c.Ltarg))?(e.output(0,c.Ltarg,a),!1):!0};a.prototype.keyUp=
function(a){a=this._GetKeyEventProperties(a,!1);return null==a?!0:this.doModifierPress(a,!1)};a.prototype.keyPress=function(a){var c=b.keyman.singleton,f=this._GetKeyEventProperties(a);if(null==f||f.LisVirtualKey)return!0;if(!c.keyboardManager.activeKeyboard.KM){if(!this.swallowKeypress||32>f.Lcode||c._BrowserIsSafari&&63232<f.Lcode&&63744>f.Lcode)return!0;if(a=c._GetEventObject(a))a.returnValue=!1;return!1}if(this.swallowKeypress||c["interface"].processKeystroke(c.util.physicalDevice,f.Ltarg,f))return this.swallowKeypress=
!1,a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),!1;this.swallowKeypress=!1;return!0};return a}();h.Processor=g})(d.text||(d.text={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
var __extends=this&&this.__extends||function(){var b=function(d,h){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,g){b.__proto__=g}||function(b,g){for(var a in g)g.hasOwnProperty(a)&&(b[a]=g[a])};return b(d,h)};return function(d,h){function k(){this.constructor=d}b(d,h);d.prototype=null===h?Object.create(h):(k.prototype=h.prototype,new k)}}();
(function(b){(function(b){var d=function(){function a(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._SelectionControl=this._Selection=null}a.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),1E3)};return a}();b.CommonDOMStates=d;var k=function(){function a(e){this.setFocus=function(a){}.bind(this);this.flashCaret=function(){}.bind(this);this.setBlur=function(a){}.bind(this);this._ControlFocus=function(c){var f=
this.keyman.util.device,l=this.keyman.osk;c=this.keyman._GetEventObject(c);c=this.keyman.util.eventTarget(c);if(null==c||f.touchable&&(null==c.className||0>c.className.indexOf("keymanweb-input")))return!0;c.nodeName.toLowerCase();if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLInputElement){var e=c.type.toLowerCase();if("text"!=e&&"search"!=e)return!0}else if(!(!f.touchable&&c.isContentEditable||c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement))return!0;
g.states.activeElement=c;3==c.nodeType&&(c=c.parentNode);e=c;(null==c.className||0>c.className.indexOf("keymanweb-input"))&&this instanceof g&&this.scrollBody(c);c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(c),c=c.contentWindow.document);var b=a.states.lastActiveElement;a.states.lastActiveElement=c;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings():this._FocusKeyboardSettings(b?!1:!0);if(this._CommonFocusHelper(c))return!0;
c._KeymanWebSelectionStart=c._KeymanWebSelectionEnd=null;c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(c);this.doControlFocused(e,a.states.lastActiveElement);f.touchable?l._Enabled=!0:l.ready&&(this.keyman.keyboardManager.isCJK()&&(l._Enabled=!0),l._Enabled?l._Show():l._Hide(!1));return!0}.bind(this);this._ControlBlur=function(c){c=this.keyman._GetEventObject(c);var f=this.keyman.util.eventTarget(c);if(null==f)return!0;a.states.activeElement=
null;this instanceof g&&this.hideCaret();3==f.nodeType&&(f=f.parentNode);f.ownerDocument&&(f instanceof f.ownerDocument.defaultView.HTMLIFrameElement&&(f=f.contentWindow.document),f instanceof f.ownerDocument.defaultView.HTMLInputElement||f instanceof f.ownerDocument.defaultView.HTMLTextAreaElement)&&(f._KeymanWebSelectionStart=f.value._kmwCodeUnitToCodePoint(f.selectionStart),f._KeymanWebSelectionEnd=f.value._kmwCodeUnitToCodePoint(f.selectionEnd));this._BlurKeyboardSettings();a.states.lastActiveElement=
f;this.keyman.uiManager.justActivated=!1;var l=this.keyman.uiManager.isActivating;l||this.keyman.keyboardManager.notifyKeyboard(0,f,0);this.doControlBlurred(f,c,l);this.keyman.osk.ready&&!l&&this.keyman.osk._Hide(!1);this.doChangeEvent(f);this.keyman.interface.resetContext();return!0}.bind(this);this._SelectionChange=function(){a.states._IgnoreNextSelChange&&a.states._IgnoreNextSelChange--;return!0}.bind(this);this._KeyDown=function(c){var f=this.keyman.keyboardManager.activeKeyboard,l=this.keyman.osk,
e=this.keyman.util;if(a.states._DisableInput||null==f)return!0;f=e.eventTarget(c);if(e.device.touchable){if(f&&"undefined"!=typeof f.kmwInput&&0==f.kmwInput)return!0}else if(f&&0<=f.className.indexOf("kmw-disabled"))return!0;return l.ready?this.keyman.textProcessor.keyDown(c):!0}.bind(this);this._KeyPress=function(c){return a.states._DisableInput||null==this.keyman.keyboardManager.activeKeyboard?!0:this.keyman.textProcessor.keyPress(c)}.bind(this);this._KeyUp=function(a){var c=this.keyman.textProcessor,
l=this.keyman.osk,e=c._GetKeyEventProperties(a,!1);return null!=e&&l.ready?13!=e.Lcode||(l=!1,e.Ltarg instanceof e.Ltarg.ownerDocument.defaultView.HTMLTextAreaElement&&(l=!0),e.Ltarg.base&&e.Ltarg.base instanceof e.Ltarg.base.ownerDocument.defaultView.HTMLTextAreaElement&&(l=!0),l)?c.keyUp(a):(e.Ltarg instanceof e.Ltarg.ownerDocument.defaultView.HTMLInputElement&&(a=e.Ltarg,"search"==a.type||"submit"==a.type?a.form.submit():this.keyman.domManager.moveToNext(!1)),!0):!0}.bind(this);this.keyman=e}a.prototype.getText=
function(a){return""};a.prototype.setText=function(a,c,f){};a.prototype.getTextBeforeCaret=function(a){return""};a.prototype.setTextBeforeCaret=function(a,c){};a.prototype.getTextCaret=function(a){return 0};a.prototype.setTextCaret=function(a,c){};a.prototype.hideCaret=function(){};a.prototype.updateInput=function(a){};a.prototype.doControlFocused=function(a,c){var f={};f.target=a;f.activeControl=c;return this.keyman.util.callEvent("kmw.controlfocused",f)};a.prototype.doControlBlurred=function(a,
c,f){var l={};l.target=a;l.event=c;l.isActivating=f;return this.keyman.util.callEvent("kmw.controlblurred",l)};a.prototype._BlurKeyboardSettings=function(e,c){var f=this.keyman.keyboardManager.activeKeyboard?this.keyman.keyboardManager.activeKeyboard.KI:"",l=this.keyman.keyboardManager.getActiveLanguage();void 0!==e&&void 0!==c&&(f=e,l=c);(e=a.states.lastActiveElement)&&null!=e._kmwAttachment.keyboard?(e._kmwAttachment.keyboard=f,e._kmwAttachment.languageCode=l):(this.keyman.globalKeyboard=f,this.keyman.globalLanguageCode=
l)};a.prototype._FocusKeyboardSettings=function(e){var c=a.states.lastActiveElement;c&&null!=c._kmwAttachment.keyboard?this.keyman.keyboardManager.setActiveKeyboard(c._kmwAttachment.keyboard,c._kmwAttachment.languageCode):e||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode)};a.prototype._CommonFocusHelper=function(e){var c=this.keyman.uiManager;if(e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(e,
1)||!this.keyman.domManager._IsMozillaEditableIframe(e,1)))return a.states._DisableInput=!0;a.states._DisableInput=!1;c.justActivated||(this.keyman["interface"]._DeadKeys=[],this.keyman.keyboardManager.notifyKeyboard(0,e,1));c.justActivated||a.states._SelectionControl==e||(c.isActivating=!1);c.justActivated=!1;a.states._SelectionControl=e;return!1};a.prototype.doChangeEvent=function(e){if(a.states.changed){if("function"==typeof Event)var c=new Event("change",{bubbles:!0,cancelable:!1});else c=document.createEvent("HTMLEvents"),
c.initEvent("change",!0,!1);e.base&&e.base.kmw_ip&&(e=e.base);e.dispatchEvent(c)}a.states.changed=!1};a.states=new d;return a}();b.DOMEventHandlers=k;var g=function(a){function e(c){c=a.call(this,c)||this;c.setFocus=function(a){var c=this.keyman.osk,f=this.keyman.util;k.states.setFocusTimer();if(b.Util.instanceof(a,"TouchEvent"))var e=a.touches[0];else e={clientX:0,clientY:0},e.target=k.states.lastActiveElement?k.states.lastActiveElement.kmw_ip:this.keyman.domManager.sortedInputs[0].kmw_ip;a=e.clientX;
var g=e.clientY,d=e.target;var n=b.Util.instanceof(d,"HTMLSpanElement")?d.parentNode:null!=d.className&&0<=d.className.indexOf("keymanweb-input")?d.firstChild:d;e=n.parentNode;k.states.activeElement!=e&&(this.hideCaret(),k.states.activeElement=e,e.focus());this.keyman.domManager._SetTargDir(e);c.ready&&!c._Visible&&c._Show();if(b.Util.instanceof(d,"HTMLDivElement"))g=f._GetAbsoluteX(n.firstChild),"rtl"==e.dir?(g+=n.firstChild.offsetWidth,c=a>g?0:1E5):c=a<g?0:1E5,this.setTextCaret(e,c),this.scrollInput(e);
else{var h;n=n.childNodes[1];d=0;var q=this.getText(e)._kmwLength();c=this.getTextCaret(e);var u=document.body.scrollTop;if(e.base instanceof e.base.ownerDocument.defaultView.HTMLTextAreaElement){var v=Math.round(e.base.offsetHeight/e.base.rows);for(h=0;16>h;h++){var y=f._GetAbsoluteY(n)-u;if(y>g&&c>d&&c!=q)q=c,c=Math.round((c+d)/2);else if(y<g-v&&c<q&&c!=d)d=c,c=Math.round((c+q)/2);else break;this.setTextCaret(e,c)}for(;f._GetAbsoluteY(n)-u>g&&c>d;)this.setTextCaret(e,--c);for(;f._GetAbsoluteY(n)-
u<g-v&&c<q;)this.setTextCaret(e,++c)}y="rtl"==e.dir?function(a,c){return a<c}:function(a,c){return a>c};for(h=0;16>h;h++){g=f._GetAbsoluteX(n);if(y(g,a)&&c>d&&c!=q)q=c,c=Math.round((c+d)/2);else if(!y(g,a)&&c<q&&c!=d)d=c,c=Math.round((c+q)/2);else break;this.setTextCaret(e,c)}for(;y(f._GetAbsoluteX(n),a)&&c>d;)this.setTextCaret(e,--c);for(;!y(f._GetAbsoluteX(n),a)&&c<q;)this.setTextCaret(e,++c)}this._BlurKeyboardSettings();k.states.lastActiveElement=e;this._FocusKeyboardSettings(!1);this._CommonFocusHelper(e)}.bind(c);
c.flashCaret=function(){if(this.keyman.util.device.touchable&&null!=k.states.activeElement){var a=this.caret.style;a.visibility="visible"!=a.visibility?"visible":"hidden"}}.bind(c);c.setBlur=function(a){this.keyman.interface.resetContext();if("relatedTarget"in a&&a.relatedTarget&&(a=a.relatedTarget,this.doChangeEvent(a),"DIV"!=a.nodeName||-1==a.className.indexOf("keymanweb-input"))){this.cancelInput();return}k.states.focusing||this.cancelInput()}.bind(c);c.dragInput=function(a){a.preventDefault();
a.stopPropagation();var c=b.Util.instanceof(a,"TouchEvent")?a.targetTouches[0].target:a.target;if(null!=c){if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=c.parentNode;if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=c.parentNode;if(!(null==c.className||0>c.className.indexOf("keymanweb-input"))){if(b.Util.instanceof(a,"TouchEvent")){var f=a.touches[0].screenX;var e=a.touches[0].screenY}else f=a.screenX,e=a.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch=
{x:f,y:e};else{var g=this.firstTouch.x,d=this.firstTouch.y;a=c.firstChild;if("TEXTAREA"==c.base.nodeName){if(f=parseInt(a.style.top,10),isNaN(f)&&(f=0),g=d-e,-4>g||4<g)a.style.top=(f<g?f-g:0)+"px",this.firstTouch.y=e}else{e=parseInt(a.style.left,10);isNaN(e)&&(e=0);var n=g-f;if(-4>n||4<n)g=0,d=this.keyman.util._GetAbsoluteX(c)+c.offsetWidth-a.offsetWidth-32,"rtl"==c.base.dir?g=16:d-=24,e-=n,e>g&&(e=g),e<d&&(e=d),a.style.left=e+"px",this.firstTouch.x=f}}this.setScrollBar(c)}}}.bind(c);c.initCaret();
return c}__extends(e,a);e.prototype.initCaret=function(){this.caret=document.createElement("DIV");var a=this.caret.style;a.position="absolute";a.height="16px";a.width="2px";a.backgroundColor="blue";a.border="none";a.left=a.top="0px";a.display="block";a.visibility="hidden";a.zIndex="9998";this.caretTimerId=window.setInterval(this.flashCaret,500)};e.prototype.getText=function(a){return null==a?"":a.textContent};e.prototype.setText=function(a,f,e){if(a&&0<a.childNodes.length){var c=a.firstChild,l=0;
if(3<=c.childNodes.length){var b=c.childNodes[0];c=c.childNodes[2];if(null===f){var g=b.textContent;f=c.textContent;f=g+f}0>e&&(e=0);l=f._kmwLength();if(null===e||e>l)e=l;g=f._kmwSubstr(0,e);f=f._kmwSubstr(e);b.textContent=g;c.textContent=f}}this.updateBaseElement(a,l)};e.prototype.getTextBeforeCaret=function(a){return a&&1<a.childNodes.length&&(a=a.firstChild,0<a.childNodes.length)?a.childNodes[0].textContent:""};e.prototype.setTextBeforeCaret=function(a,f){if(a&&0<a.childNodes.length){var c=a.firstChild,
e=0;1<c.childNodes.length&&(e=c.childNodes[0],c=c.childNodes[2],"TEXTAREA"!=a.base.nodeName&&(f=f.replace(/\s+$/," ")),e.textContent=f,e=f.length,e+=c.textContent.length)}this.updateBaseElement(a,e);this.scrollInput(a)};e.prototype.getTextCaret=function(a){return this.getTextBeforeCaret(a)._kmwLength()};e.prototype.setTextCaret=function(a,f){this.setText(a,null,f);this.showCaret(a)};e.prototype.hideCaret=function(){var a=k.states.lastActiveElement;if(a&&null!=a.className&&0<=a.className.indexOf("keymanweb-input")){if(a.base instanceof
a.base.ownerDocument.defaultView.HTMLTextAreaElement||a.base instanceof a.base.ownerDocument.defaultView.HTMLInputElement)a.base.value=this.getText(a);this.setText(a,null,1E5);var f=a.firstChild.style;"TEXTAREA"==a.base.nodeName?f.top="0":f.left="rtl"==a.base.dir?a.offsetWidth-a.firstChild.offsetWidth-8+"px":"0";this.caret.parentNode&&this.caret.parentNode.removeChild(this.caret);this.caret.style.visibility="hidden";1<a.childNodes.length&&(a.childNodes[1].style.visibility="hidden")}};e.prototype.showCaret=
function(a){if(a&&a.firstChild&&!(3>a.firstChild.childNodes.length)){var c=a.firstChild,e=this.caret.style,b=c.childNodes[1];this.caret.parentNode!=c&&c.appendChild(this.caret);e.left=b.offsetLeft+"px";e.top=b.offsetTop+"px";e.height=b.offsetHeight-1+"px";e.visibility="hidden";this.scrollBody(a);this.setScrollBar(a)}};e.prototype.updateInput=function(a){var c=this.keyman.util,e=a.style,b=a.base,g=window.getComputedStyle(b,null),d=parseInt(g.marginLeft,10),k=parseInt(g.marginTop,10),n=c._GetAbsoluteX(b),
h=c._GetAbsoluteY(b),q=a.offsetParent;q&&(n-=c._GetAbsoluteX(q),h-=c._GetAbsoluteY(q));isNaN(d)&&(d=0);isNaN(k)&&(k=0);e.left=n-d+"px";e.top=h-k+"px";"undefined"!=typeof g.MozBoxSizing&&(e.left=n+"px",e.top=h+"px");d=b.offsetWidth;b=b.offsetHeight;k=parseInt(g.paddingLeft,10);n=parseInt(g.paddingRight,10);h=parseInt(g.paddingTop,10);q=parseInt(g.paddingBottom,10);var u=parseInt(g.borderLeft,10),v=parseInt(g.borderRight,10),y=parseInt(g.borderTop,10),D=parseInt(g.borderBottom,10),w="undefined";"undefined"!=
typeof g.boxSizing?w=g.boxSizing:"undefined"!=typeof g.MozBoxSizing&&(w=g.MozBoxSizing);"content-box"==w&&(isNaN(k)||(d-=k),isNaN(n)||(d-=n),isNaN(u)||(d-=u),isNaN(v)||(d-=v),isNaN(h)||(b-=h),isNaN(q)||(b-=q),isNaN(y)||(b-=y),isNaN(D)||(b-=D));"Android"==c.device.OS&&("undefined"!=typeof g.MozBoxSizing?(e.paddingTop=h+1+"px",e.paddingLeft=k+"px","TEXTAREA"==a.base.nodeName?e.marginTop="1px":e.marginLeft="1px",d--,b--):(d++,b++));e.width=d+"px";e.height=b+"px"};e.prototype.updateBaseElement=function(a,
f){var c=a.base.ownerDocument.defaultView;a.base instanceof c.HTMLInputElement||a.base instanceof c.HTMLTextAreaElement?a.base.value=this.getText(a):a.base.textContent=this.getText(a);a.style.backgroundColor=0==f?"transparent":window.getComputedStyle(a.base,null).backgroundColor;"iOS"==this.keyman.util.device.OS&&(a.base.style.visibility=0==f?"visible":"hidden")};e.prototype.cancelInput=function(){k.states.activeElement=null;this.hideCaret();this.keyman.osk.hideNow()};e.prototype.setScrollBar=function(a){var c=
a.childNodes[0],e=a.childNodes[1].style;(c.offsetWidth>a.offsetWidth||0>c.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(e.height="4px",e.width=a.offsetWidth/c.offsetWidth*100+"%",e.left=-c.offsetLeft/c.offsetWidth*100+"%",e.top="0",e.visibility="visible"):c.offsetHeight>a.offsetHeight||0>c.offsetTop?(e.width="4px",e.height=a.offsetHeight/c.offsetHeight*100+"%",e.top=-c.offsetTop/c.offsetHeight*100+"%",e.left="0",e.visibility="visible"):e.visibility="hidden"};e.prototype.scrollInput=function(a){if(a&&
a.firstChild&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))){var c=a.firstChild;if(!(3>c.childNodes.length)){var e=this.keyman.util,b=c.childNodes[1],g=e._GetAbsoluteX(b);b=e._GetAbsoluteY(b);var d=e._GetAbsoluteX(a);e=e._GetAbsoluteY(a);var k=parseInt(c.style.left,10),n=parseInt(c.style.top,10),h=0,q=0;isNaN(k)&&(k=0);isNaN(n)&&(n=0);a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement?(g=Math.round(a.offsetHeight/a.base.rows),b<e&&(q=b-e),b>e+a.offsetHeight-g&&
(q=b-e-a.offsetHeight+g),0!=q&&(c.style.top=(n<q?n-q:0)+"px")):(g<d+8&&(h=g-d-12),g>d+a.offsetWidth-12&&(h=g-d-a.offsetWidth+12),0!=h&&(c.style.left=(k<h?k-h:0)+"px"));this.showCaret(a)}}};e.prototype.scrollBody=function(a){var c=this.keyman.osk,e=this.keyman.util;if(a&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))&&c.ready){a=a.firstChild.childNodes[1];e=e._GetAbsoluteY(a);var b=window.pageYOffset;e<b?c=e-b:(c=e-b-(window.innerHeight-c._Box.offsetHeight-a.offsetHeight-2),0>c&&(c=
0));0!=c&&window.scrollTo(0,c+window.pageYOffset)}};return e}(k);b.DOMTouchHandlers=g})(b.keyman||(b.keyman={}))})(com||(com={}));String.kmwFromCharCode=function(b){var d=[],h;for(h=0;h<arguments.length;h++){var k=Number(arguments[h]);if(!isFinite(k)||0>k||1114111<k||Math.floor(k)!==k)throw new RangeError("Invalid code point "+k);65536>k?d.push(k):(k-=65536,d.push((k>>10)+55296),d.push(k%1024+56320))}return String.fromCharCode.apply(void 0,d)};
String.prototype.kmwCharCodeAt=function(b){var d=String(this),h=0;if(0>b||b>=d.length)return NaN;for(var k=0;k<b;k++)if(h=d.kmwNextChar(h),null===h)return NaN;b=d.charCodeAt(h);return 55296<=b&&56319>=b&&d.length>h+1&&(d=d.charCodeAt(h+1),56320<=d&&57343>=d)?(b-55296<<10)+(d-56320)+65536:b};String.prototype.kmwIndexOf=function(b,d){var h=String(this);b=h.indexOf(b,d);if(0>b)return b;for(var k=d=0;null!==k&&k<b;k=h.kmwNextChar(k))d++;return d};
String.prototype.kmwLastIndexOf=function(b,d){var h=String(this);b=h.lastIndexOf(b,d);if(0>b)return b;for(var k=d=0;null!==k&&k<b;k=h.kmwNextChar(k))d++;return d};String.prototype.kmwLength=function(){var b=String(this);if(0==b.length)return 0;for(var d=0,h=0;null!==h;d++)h=b.kmwNextChar(h);return d};String.prototype.kmwSlice=function(b,d){var h=String(this);b=h.kmwCodePointToCodeUnit(b);d=h.kmwCodePointToCodeUnit(d);return null===b||null===d?"":h.slice(b,d)};
String.prototype.kmwSubstr=function(b,d){var h=String(this);0>b&&(b=h.kmwLength()+b);0>b&&(b=0);var k=h.kmwCodePointToCodeUnit(b),g=k;if(null===k)return"";if(2>arguments.length)g=h.length;else for(var a=0;a<d;a++)g=h.kmwNextChar(g);return null===g?h.substring(k):h.substring(k,g)};
String.prototype.kmwSubstring=function(b,d){var h=String(this);if("undefined"==typeof d)b=h.kmwCodePointToCodeUnit(b),d=h.length;else{if(b>d){var k=b;b=d;d=k}b=h.kmwCodePointToCodeUnit(b);d=h.kmwCodePointToCodeUnit(d)}if(isNaN(b)||null===b)b=0;if(isNaN(d)||null===d)d=h.length;return h.substring(b,d)};
String.prototype.kmwNextChar=function(b){var d=String(this);if(null===b||0>b||b>=d.length-1)return null;var h=d.charCodeAt(b);return 55296<=h&&56319>=h&&d.length>b+1&&(h=d.charCodeAt(b+1),56320<=h&&57343>=h)?b==d.length-2?null:b+2:b+1};String.prototype.kmwPrevChar=function(b){var d=String(this);if(null==b||0>=b||b>d.length)return null;var h=d.charCodeAt(b-1);return 56320<=h&&57343>=h&&1<b&&(d=d.charCodeAt(b-2),55296<=d&&56319>=d)?b-2:b-1};
String.prototype.kmwCodePointToCodeUnit=function(b){if(null===b)return null;var d=String(this),h=0;if(0>b){h=d.length;for(var k=0;k>b;k--)h=d.kmwPrevChar(h);return h}if(b==d.kmwLength())return d.length;for(k=0;k<b;k++)h=d.kmwNextChar(h);return h};String.prototype.kmwCodeUnitToCodePoint=function(b){var d=String(this);return null===b?null:0==b?0:0>b?d.substr(b).kmwLength():d.substr(0,b).kmwLength()};String.prototype.kmwCharAt=function(b){var d=String(this);return 0<=b?d.kmwSubstr(b,1):""};
String.prototype.kmwBMPNextChar=function(b){var d=String(this);return 0>b||b>=d.length-1?null:b+1};String.prototype.kmwBMPPrevChar=function(b){var d=String(this);return 0>=b||b>d.length?null:b-1};String.prototype.kmwBMPCodePointToCodeUnit=function(b){return b};String.prototype.kmwBMPCodeUnitToCodePoint=function(b){return b};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(b,d){var h=String(this);return-1<b?h.substr(b,d):h.substr(h.length+b,-b)};
String.kmwEnableSupplementaryPlane=function(b){var d=String.prototype;String._kmwFromCharCode=b?String.kmwFromCharCode:String.fromCharCode;d._kmwCharAt=b?d.kmwCharAt:d.charAt;d._kmwCharCodeAt=b?d.kmwCharCodeAt:d.charCodeAt;d._kmwIndexOf=b?d.kmwIndexOf:d.indexOf;d._kmwLastIndexOf=b?d.kmwLastIndexOf:d.lastIndexOf;d._kmwSlice=b?d.kmwSlice:d.slice;d._kmwSubstring=b?d.kmwSubstring:d.substring;d._kmwSubstr=b?d.kmwSubstr:d.kmwBMPSubstr;d._kmwLength=b?d.kmwLength:d.kmwBMPLength;d._kmwNextChar=b?d.kmwNextChar:
d.kmwBMPNextChar;d._kmwPrevChar=b?d.kmwPrevChar:d.kmwBMPPrevChar;d._kmwCodePointToCodeUnit=b?d.kmwCodePointToCodeUnit:d.kmwBMPCodePointToCodeUnit;d._kmwCodeUnitToCodePoint=b?d.kmwCodeUnitToCodePoint:d.kmwBMPCodeUnitToCodePoint};
(function(b){(function(b){var d=function(){function d(g){this.inputList=[];this.sortedInputs=[];this.nonKMWTouchHandler=function(a){b.DOMEventHandlers.states.focusing=!1;clearTimeout(b.DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);this._EnablementMutationObserverCore=function(a){for(var e=0;e<a.length;e++){var c=a[e],f=c.oldValue?0<=c.oldValue.indexOf("kmw-disabled"):!1,b=0<=c.target.className.indexOf("kmw-disabled");f&&!b?this._EnableControl(c.target):!f&&b&&this._DisableControl(c.target);
!b&&"readonly"==c.attributeName&&(f=c.oldValue?null!=c.oldValue:!1,b=c.target,b instanceof b.ownerDocument.defaultView.HTMLInputElement||b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement)&&(b=b.readOnly,f&&!b?this._EnableControl(c.target):!f&&b&&this._DisableControl(c.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var e=[],c=[],f=0;f<a.length;f++){for(var b=a[f],g=0;g<b.addedNodes.length;g++)e=e.concat(this._GetDocumentEditables(b.addedNodes[g]));for(g=0;g<b.removedNodes.length;g++)c=
c.concat(this._GetDocumentEditables(b.removedNodes[g]))}for(a=0;a<e.length;a++)this.isKMWInput(e[a])&&this._MutationAdditionObserved(e[a]);for(a=0;a<c.length;a++)this.isKMWInput(c[a])&&this._MutationRemovalObserved(c[a]);if(e.length||c.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var d=this;window.setTimeout(function(){d.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.keyman.touchAliasing.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),
1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var e=this,c=function(){e.attachToControl(a)};a.addEventListener("load",c);"complete"==a.contentDocument.readyState&&window.setTimeout(c,1)}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=
function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var e=a.className;0<=e.indexOf("kmw-disabled")&&(a.className=e.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk.ready&&(this.keyman.osk.shutdown(),this.keyman.osk._Unload());this.clearLastActiveElement()}.bind(this);
this.init=function(a){var e,c=this.keyman.osk;var f=this.keyman.util;var b=f.device,g=function(a){if(0==a.length)return a;"/"!=a.substr(a.length-1,1)&&(a+="/");return"http"==a.replace(/^(http)s?:.*/,"$1")||"file"==a.replace(/^(file):.*/,"$1")?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.rootPath+a.substr(1):this.keyman.srcPath+a}.bind(this);var d=this.keyman.options;if("object"==typeof a&&null!==a)for(e in d)a.hasOwnProperty(e)&&(d[e]=a[e]);""!=d.root&&(this.keyman.rootPath=
g(d.root));""==d.resources&&(d.resources=this.keyman.srcPath);d.resources=g(d.resources);d.keyboards=g(d.keyboards);d.fonts=g(d.fonts);""==d.attachType&&(d.attachType="auto");this.keyman.setDefaultDeviceOptions(d);if(this.keyman.initialized)return Promise.resolve();var h=this.keyman,k=this;if("complete"!==document.readyState)return new Promise(function(c){window.setTimeout(function(){k.init(a).then(function(){c()})},50)});this.keyman._MasterDocument=window.document;"Android"==b.OS&&(d=b.getDPI(),
b.formFactor=screen.height<4*d||screen.width<4*d?"phone":"tablet");this.keyman.setInitialized(1);c.prepare();f.prepareWait();this.keyman.keyboardManager.registerDeferredStubs();this.initializeUI();this.keyman.keyboardManager.registerDeferredKeyboards();if(this.keyman.isEmbedded)return this.keyman.keyboardManager.setDefaultKeyboard()||console.error("No keyboard stubs exist - cannot initialize keyboard!"),Promise.resolve();this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont();b.touchable&&
this.keyman.handleRotationEvents();"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement);this.listInputs();b.touchable&&(c._Box.addEventListener("touchend",function(a){a.stopPropagation()},!1),f=document.createElement("DIV"),d=f.style,d.width="100%",d.height=screen.width/2+"px",document.body.appendChild(f),"Android"==b.OS&&0<navigator.userAgent.indexOf("Chrome")?(this.keyman.hideOskWhileScrolling=function(a){if("undefined"!=typeof c._Box&&"undefined"!=typeof c._Box.style){e=
a.target.parentNode;if("undefined"!=typeof e&&null!=e&&(0<=e.className.indexOf("keymanweb-input")||0<=e.className.indexOf("kmw-key-")||"undefined"!=typeof e.parentNode&&(e=e.parentNode,0<=e.className.indexOf("keymanweb-input")||0<=e.className.indexOf("kmw-key-"))))return;c.hideNow()}},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskWhileScrolling,!1)):(this.keyman.conditionallyHideOsk=function(){h.hideOnRelease&&!c.lgList&&c.hideNow();h.hideOnRelease=!1},this.keyman.hideOskIfOnBody=
function(a){h.touchY=a.touches[0].screenY;h.hideOnRelease=!0},this.keyman.cancelHideIfScrolling=function(a){a=a.touches[0].screenY;var c=h.touchY;if(5<a-c||5>c-a)h.hideOnRelease=!1},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskIfOnBody,!1),this.keyman.util.attachDOMEvent(document.body,"touchmove",this.keyman.cancelHideIfScrolling,!1),this.keyman.util.attachDOMEvent(document.body,"touchend",this.keyman.conditionallyHideOsk,!1)));this.keyman.keyboardManager.restoreCurrentKeyboard();
MutationObserver?(b=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&(f={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(b,f)),f={subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(b,f)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements.");
this.keyman.setInitialized(2);return Promise.resolve()}.bind(this);this.keyman=g;g.util.device.touchable&&(this.touchHandlers=new b.DOMTouchHandlers(g));this.nonTouchHandlers=new b.DOMEventHandlers(g)}d.prototype.shutdown=function(){this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver&&this.attachmentObserver.disconnect();for(var b=0,a=this.inputList;b<a.length;b++)this.disableInputElement(a[b])};d.prototype.getHandlers=function(b){return(b=b.base?b.base._kmwAttachment:
b._kmwAttachment)?b.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};d.prototype.enableTouchElement=function(b){if("iframe"==b.tagName.toLowerCase())return!1;if(this.isKMWDisabled(b))return this.setupNonKMWTouchElement(b),!1;b.kmwInput=!0;b.removeEventListener("touchstart",this.nonKMWTouchHandler);if(b.kmw_ip){if(-1!=this.inputList.indexOf(b.kmw_ip))return!1;this.inputList.push(b.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");
return!0}var a=document.createElement("div");a.base=a.base=b;a._kmwAttachment=b._kmwAttachment;this.enableInputElement(a,!0);b.kmw_ip=a;b.disabled=!0;a.className="keymanweb-input";a.dir=a.base.dir;var e=document.createElement("div");var c=window.getComputedStyle(a.base,null);b=a.style;b.overflow="hidden";b.position="absolute";b.border="hidden";b.border="none";b.borderRadius="5px";var f=document.createElement("div");var g=f.style;g.position="absolute";g.height=g.width="4px";g.left=g.top="0";g.display=
"block";g.visibility="hidden";g.backgroundColor="#808080";g.borderRadius="2px";g=document.createElement("span");var d=document.createElement("span");var h=document.createElement("span");g.innerHTML=d.innerHTML=h.innerHTML="";g.className=d.className=h.className="keymanweb-font";e.appendChild(g);e.appendChild(h);e.appendChild(d);a.appendChild(e);a.appendChild(f);e=e.style;e.position="absolute";f=g.style;var k=d.style;h=h.style;f.border=k.border="none";f.height=k.height="100%";f.fontFamily=k.fontFamily=
e.fontFamily=c.fontFamily;"input"!=a.base.nodeName.toLowerCase()||isNaN(parseInt(c.height,10))||(f.lineHeight=k.lineHeight=c.height);h.border="1px solid red";h.visibility="hidden";h.marginLeft=h.marginRight="-1px";b.padding="8px";e.padding="0px 2px";e.backgroundColor="Android"==this.keyman.util.device.OS&&"transparent"==c.backgroundColor?"#fff":c.backgroundColor;a.tabIndex=0;a.style.msTouchAction="none";var p=this.touchHandlers;a.addEventListener("touchstart",p.setFocus);a.onmspointerdown=function(a){a.preventDefault();
a.stopPropagation();return p.setFocus(a)};a.addEventListener("touchend",function(a){a.stopPropagation()});a.onmspointerup=function(a){a.stopPropagation()};a.addEventListener("touchmove",p.dragInput,!1);a.onmspointermove=p.dragInput;a.onblur=p.setBlur;"textarea"==a.base.nodeName.toLowerCase()?g.style.whiteSpace=d.style.whiteSpace="pre-wrap":g.style.whiteSpace=d.style.whiteSpace="pre";a.base.parentNode.appendChild(a);p.updateInput(a);b=a.style;b.color=c.color;b.fontFamily=c.fontFamily;b.fontSize=c.fontSize;
b.fontWeight=c.fontWeight;b.textDecoration=c.textDecoration;b.padding=c.padding;b.margin=c.margin;b.border=c.border;b.borderRadius=c.borderRadius;"webkitTapHighlightColor"in b&&(b.webkitTapHighlightColor="rgba(0,0,0,0)");a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement?(2==a.base.rows&&(g=parseInt(c.height,10)-parseInt(c.paddingTop,10)-parseInt(c.paddingBottom,10),c=parseInt(c.fontSize,10),c=Math.round(g/c),c>a.base.rows+1&&(a.base.rows=c)),e.width=b.width,e.minHeight=b.height):
(e.minWidth=b.width,e.height=b.height);a.base.style.visibility="hidden";(function(a){a._kmwResizeHandler=function(c){window.setTimeout(function(){p.updateInput(a)},1)};a.base.addEventListener("resize",a._kmwResizeHandler,!1);a.base.addEventListener("orientationchange",a._kmwResizeHandler,!1)})(a);p.setText(a,a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement||a.base instanceof a.base.ownerDocument.defaultView.HTMLInputElement?a.base.value:a.base.textContent,null);return!0};d.prototype.disableTouchElement=
function(b){if("iframe"!=b.tagName.toLowerCase()){if(b.kmw_ip){var a=this.inputList.indexOf(b.kmw_ip);-1!=a&&this.inputList.splice(a,1);b.style.visibility="visible";b.disabled=!1;b.removeEventListener("resize",b.kmw_ip._kmwResizeHandler);this.disableInputElement(b.kmw_ip);b.parentNode&&b.parentNode.removeChild(b.kmw_ip);delete b.kmw_ip}this.setupNonKMWTouchElement(b)}};d.prototype.setupNonKMWTouchElement=function(b){this.keyman.util.attachDOMEvent(b,"touchstart",this.nonKMWTouchHandler,!1);this.isAttached(b)&&
(b._kmwAttachment.touchEnabled=!1)};d.prototype.enableInputElement=function(b,a){a=a?b.base:b;this.isKMWDisabled(a)||(b instanceof b.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(b):(a.className=a.className?a.className+" keymanweb-font":"keymanweb-font",this.inputList.push(b),this.keyman.util.attachDOMEvent(a,"focus",this.getHandlers(b)._ControlFocus),this.keyman.util.attachDOMEvent(a,"blur",this.getHandlers(b)._ControlBlur),b.onkeypress=this.getHandlers(b)._KeyPress,b.onkeydown=
this.getHandlers(b)._KeyDown,b.onkeyup=this.getHandlers(b)._KeyUp))};d.prototype.disableInputElement=function(b,a){var e=a?b.base:b;if(b instanceof b.ownerDocument.defaultView.HTMLIFrameElement)this._DetachFromIframe(b);else{0<e.className.indexOf("keymanweb-font")&&!a&&(e.className=e.className.replace("keymanweb-font","").trim());var c=this.inputList.indexOf(b);-1<c&&this.inputList.splice(c,1);a||(this.keyman.util.detachDOMEvent(e,"focus",this.getHandlers(b)._ControlFocus),this.keyman.util.detachDOMEvent(e,
"blur",this.getHandlers(b)._ControlBlur));b.onkeypress=null;b.onkeydown=null;b.onkeyup=null}a&&(this.inputList.push(e),e.onkeypress=this.getHandlers(b)._KeyPress,e.onkeydown=this.getHandlers(b)._KeyDown,e.onkeyup=this.getHandlers(b)._KeyUp);a=this.getLastActiveElement();if(a==b||a==b.kmw_ip)this.clearLastActiveElement(),this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode),this.keyman.osk._Hide(!1)};d.prototype.isKMWDisabled=function(b){var a=b.className;
return b.readOnly||a&&0<=a.indexOf("kmw-disabled")?!0:!1};d.prototype.attachToControl=function(b){var a=this.keyman.util.device.touchable;if(!this.isAttached(b)||b instanceof b.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(b)?(this.setupElementAttachment(b),this.isKMWDisabled(b)?a&&this.setupNonKMWTouchElement(b):a?this.enableTouchElement(b):this.enableInputElement(b)):a&&this.setupNonKMWTouchElement(b)};d.prototype.detachFromControl=function(b){this.isAttached(b)&&(this.isKMWInput(b)&&
(this.isKMWDisabled(b)||this._DisableControl(b)),this.clearElementAttachment(b))};d.prototype.isAttached=function(b){return b._kmwAttachment?!0:!1};d.prototype.isKMWInput=function(b){var a=this.keyman.util.device.touchable;if(b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement)return!0;if(b instanceof b.ownerDocument.defaultView.HTMLInputElement){if("text"==b.type||"search"==b.type)return!0}else if(b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&!a)try{if(b.contentWindow.document)return!0}catch(e){}else if(b.isContentEditable&&
!a)return!0;return!1};d.prototype.setupElementAttachment=function(g){g._kmwAttachment||(g._kmwAttachment=new b.AttachmentInfo(null,this.keyman.util.device.touchable))};d.prototype.clearElementAttachment=function(b){b._kmwAttachment=null};d.prototype._AttachToIframe=function(b){var a=this.keyman.util;try{var e=b.contentWindow.document;e&&("on"==e.designMode.toLowerCase()?(a.attachDOMEvent(e,"focus",this.getHandlers(b)._ControlFocus),a.attachDOMEvent(e,"blur",this.getHandlers(b)._ControlBlur),a.attachDOMEvent(e,
"keydown",this.getHandlers(b)._KeyDown),a.attachDOMEvent(e,"keypress",this.getHandlers(b)._KeyPress),a.attachDOMEvent(e,"keyup",this.getHandlers(b)._KeyUp)):this._SetupDocument(e))}catch(c){}};d.prototype._DetachFromIframe=function(b){var a=this.keyman.util;try{var e=b.contentWindow.document;e&&("on"==e.designMode.toLowerCase()?(a.detachDOMEvent(e,"focus",this.getHandlers(b)._ControlFocus),a.detachDOMEvent(e,"blur",this.getHandlers(b)._ControlBlur),a.detachDOMEvent(e,"keydown",this.getHandlers(b)._KeyDown),
a.detachDOMEvent(e,"keypress",this.getHandlers(b)._KeyPress),a.detachDOMEvent(e,"keyup",this.getHandlers(b)._KeyUp)):this._ClearDocument(e))}catch(c){}};d.prototype._GetDocumentEditables=function(b){var a=this.keyman.util,e=[];if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLElement){var c=b.ownerDocument.defaultView;b instanceof c.HTMLInputElement||b instanceof c.HTMLTextAreaElement?e.push(b):b instanceof c.HTMLIFrameElement&&e.push(b)}b.getElementsByTagName&&(e=e.concat(a.arrayFromNodeList(b.getElementsByTagName("INPUT")),
a.arrayFromNodeList(b.getElementsByTagName("TEXTAREA")),a.arrayFromNodeList(b.getElementsByTagName("IFRAME"))));b.querySelectorAll&&(e=e.concat(a.arrayFromNodeList(b.querySelectorAll("[contenteditable]"))));b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLElement&&b.isContentEditable&&e.push(b);return e};d.prototype._SetupDocument=function(b){b=this._GetDocumentEditables(b);for(var a=0;a<b.length;a++)this.attachToControl(b[a])};d.prototype._ClearDocument=function(b){b=this._GetDocumentEditables(b);
for(var a=0;a<b.length;a++)this.detachFromControl(b[a])};d.prototype._SetTargDir=function(b){var a=this.keyman.keyboardManager.isRTL()?"rtl":"ltr";b&&(this.keyman.util.device.touchable?0==b.textContent.length&&(b.base.dir=b.dir=a,this.getHandlers(b).setTextCaret(b,1E4)):b instanceof b.ownerDocument.defaultView.HTMLInputElement||b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement?0==b.value.length&&(b.dir=a):"string"==typeof b.textContent&&0==b.textContent.length&&(b.dir=a))};d.prototype._DisableControl=
function(b){this.isAttached(b)&&(this.keyman.util.device.touchable?(this.disableTouchElement(b),this.setupNonKMWTouchElement(b),window.setTimeout(function(){this.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.getHandlers(b).updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),1)):this.listInputs(),this.disableInputElement(b))};d.prototype._EnableControl=function(b){if(this.isAttached(b))if(this.keyman.util.device.touchable){this.enableTouchElement(b);var a=
this.keyman;window.setTimeout(function(){a.domManager.listInputs();for(var e=0;e<this.sortedInputs.length;e++)this.sortedInputs[e].kmw_ip&&this.getHandlers(b).updateInput(this.sortedInputs[e].kmw_ip)}.bind(this),1)}else this.enableInputElement(b)};d.prototype.listInputs=function(){var b,a=[],e=document.getElementsByTagName("input"),c=document.getElementsByTagName("textarea"),f=this.keyman.util;for(b=0;b<e.length;b++)switch(e[b].type){case "text":case "search":case "email":case "url":0>e[b].className.indexOf("kmw-disabled")&&
a.push({ip:e[b],x:f._GetAbsoluteX(e[b]),y:f._GetAbsoluteY(e[b])})}for(b=0;b<c.length;b++)0>c[b].className.indexOf("kmw-disabled")&&a.push({ip:c[b],x:f._GetAbsoluteX(c[b]),y:f._GetAbsoluteY(c[b])});a.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});e=[];for(b=0;b<a.length;b++)e.push(a[b].ip);this.sortedInputs=e};d.prototype.disableControl=function(b){this.isAttached(b)||console.warn("KeymanWeb is not attached to element "+b);var a=b.className;0>a.indexOf("kmw-disabled")&&(b.className=a?a+" kmw-disabled":
"kmw-disabled")};d.prototype.setKeyboardForControl=function(b,a,e){null!==a&&void 0!==a?0>a.indexOf("Keyboard_")&&""!=a&&(a="Keyboard_"+a):e=null;if(b instanceof b.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(b)){b._kmwAttachment.keyboard=a;b._kmwAttachment.languageCode=e;var c=this.getLastActiveElement();!c||c!=b&&c!=b.kmw_ip||(null!=a&&null!=e?this.keyman.keyboardManager.setActiveKeyboard(a,
e):this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode))}else console.error("KeymanWeb is not attached to element "+b)};d.prototype.getKeyboardForControl=function(b){if(this.isAttached(b))return b._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+b);return null};d.prototype.getLanguageForControl=function(b){if(this.isAttached(b))return b._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+
b);return null};d.prototype.focusLastActiveElement=function(){var b=this.getLastActiveElement();b&&(this.keyman.uiManager.justActivated=!0,b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&this.keyman.domManager._IsMozillaEditableIframe(b,0)?b.ownerDocument.defaultView.focus():b.focus&&b.focus())};d.prototype.getLastActiveElement=function(){return b.DOMEventHandlers.states.lastActiveElement};d.prototype.clearLastActiveElement=function(){b.DOMEventHandlers.states.lastActiveElement=
null};d.prototype.getActiveElement=function(){return b.DOMEventHandlers.states.activeElement};d.prototype._setActiveElement=function(d){b.DOMEventHandlers.states.activeElement=d};d.prototype.setActiveElement=function(d,a){"string"==typeof d&&(d=document.getElementById(d));this.isAttached(d)||this.keyman.isEmbedded?(d=d.kmw_ip?d.kmw_ip:d,this.keyman.isEmbedded||this.keyman.touchAliasing._BlurKeyboardSettings(),b.DOMEventHandlers.states.activeElement!=d&&this.keyman.interface.resetContext(),b.DOMEventHandlers.states.activeElement=
b.DOMEventHandlers.states.lastActiveElement=d,this.keyman.isEmbedded||this.keyman.touchAliasing._FocusKeyboardSettings(!1),1<arguments.length&&a&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocus():this.focusLastActiveElement())):console.warn("Cannot set an element KMW is not attached to as the active element.")};d.prototype.initActiveElement=function(d){null==b.DOMEventHandlers.states.activeElement&&(b.DOMEventHandlers.states.activeElement=d)};d.prototype.moveToNext=function(d){var a,
e=this.sortedInputs,c=this.getActiveElement(),f=this.keyman.util.device.touchable;if(0!=e.length){f&&(c=c.base);for(a=0;a<e.length&&e[a]!=c;a++);a=d?a-1:a+1;a=a>=e.length?a-e.length:a;a=0>a?a+e.length:a;f?(b.DOMEventHandlers.states.focusing=!0,d=e[a].kmw_ip,"undefined"==typeof d?e[a].focus():(this.keyman.domManager.setActiveElement(d),this.touchHandlers.setTextCaret(d,1E4),this.touchHandlers.scrollInput(d),d.focus())):e[a].focus()}};d.prototype.moveToElement=function(b){"string"==typeof b&&(b=document.getElementById(b));
this.keyman.util.device.touchable&&b.kmw_ip?b.kmw_ip.focus():b.focus()};d.prototype._IsIEEditableIframe=function(b,a){var e,c=b&&(e=b.tagName)&&"body"==e.toLowerCase()&&(e=b.ownerDocument)&&e.parentWindow;return!a&&c||a&&(!c||b.isContentEditable)};d.prototype._IsMozillaEditableIframe=function(b,a){var e;b=b&&(e=b.defaultView)&&e.frameElement;return!a&&b||a&&(!b||"on"==e.document.designMode.toLowerCase())};d.prototype.getBaseFont=function(){var b=this.keyman.util,a=document.getElementsByTagName("input"),
e=document.getElementsByTagName("textarea"),c=0;if(0==a.length&&0==e.length)c=0;else if(0<a.length&&0==e.length)c=1;else if(0==a.length&&0<e.length)c=2;else{var f=a[0],l=e[0];f.offsetTop<l.offsetTop?c=1:f.offsetTop>l.offsetTop?c=2:f.offsetLeft<l.offsetLeft?c=1:f.offsetLeft>l.offsetLeft&&(c=2)}switch(c){case 0:case 1:b.getStyleValue(a[0],"font-family");case 2:var d=b.getStyleValue(e[0],"font-family")}if("undefined"==typeof d||"monospace"==d)d="Arial,sans-serif";return d};d.prototype.initializeUI=function(){this.keyman.ui&&
this.keyman.ui.initialize instanceof Function?(this.keyman.ui.initialize(),this.keyman.osk._Show()):window.setTimeout(this.initializeUI.bind(this),1E3)};return d}();b.DOMManager=d})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(b){var d=function(){function b(){this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}b.prototype.getDPI=function(){var b=document.createElement("DIV"),a=b.style,e=96;if("complete"!==document.readyState)return e;b.id="calculateDPI";a.position="absolute";a.display="block";a.visibility="hidden";a.left="10px";a.top="10px";a.width="1in";a.height="10px";
document.body.appendChild(b);e="undefined"==typeof window.devicePixelRatio?b.offsetWidth:b.offsetWidth*window.devicePixelRatio;document.body.removeChild(b);return e};b.prototype.detect=function(){var d=b._GetIEVersion();if(navigator&&navigator.userAgent){var a=navigator.userAgent;if(0<=a.indexOf("iPad"))this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0;else if(0<=a.indexOf("iPhone"))this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=25;else if(0<=a.indexOf("Android")){this.OS=
"Android";this.formFactor="phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=a.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(e){}}else 0<=a.indexOf("Linux")?this.OS="Linux":0<=a.indexOf("Macintosh")?this.OS="MacOSX":0<=a.indexOf("Windows NT")&&(this.OS="Windows",0<=a.indexOf("Touch")&&(this.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}"tablet"==this.formFactor&&400>Math.min(screen.width,screen.height)&&(this.formFactor=
"phone");"phone"==this.formFactor&&720<Math.max(screen.width,screen.height)&&"iOS"!=this.OS&&(this.formFactor="tablet");"iOS"!=this.OS||"ongesturestart"in window||"Win32"==navigator.platform||(this.OS="Android");this.browser="web";if(999>d)this.browser="ie";else{if("iOS"==this.OS||"macosx"==this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR|Safari|Edge/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?
this.browser="opera":0<=navigator.userAgent.indexOf(" Edge/")?this.browser="edge":0<=navigator.userAgent.indexOf("Chrome")?this.browser="chrome":0<=navigator.userAgent.indexOf("Safari")&&(this.browser="safari"))}};b._GetIEVersion=function(){var b="";"userAgent"in navigator&&(b=navigator.userAgent);if("selection"in document){var a=navigator.appVersion;var e=a.indexOf("MSIE ");if(0<=e){if("BackCompat"==document.compatMode)return 6;a=a.substr(e+5);e=a.indexOf(".");if(0<e)return parseInt(a.substr(0,e),
10)}}e=b.indexOf("Trident/");if(0>e)return 999;b=b.substr(e+8);e=b.indexOf(".");return 0<e?parseInt(b.substr(0,e),10)+4:999};return b}();b.Device=d})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){var h=function(){function b(a,b,c,f){this.Pelem=a;this.Peventname=b.toLowerCase();this.Phandler=c;this.PuseCapture=f}b.prototype.equals=function(a){return this.Pelem==a.Pelem&&this.Peventname==a.Peventname&&this.Phandler==a.Phandler&&this.PuseCapture==a.PuseCapture};return b}(),k=function(){function g(a){this.linkedStylesheets=[];this.events={};this.currentEvents=[];this.domEvents=[];this.embeddedFonts=[];this.getAbsoluteX=this._GetAbsoluteX;this.getAbsoluteY=this._GetAbsoluteY;
this.getAbsolute=this._GetAbsolute;this.selectStartHandler=function(){return!1};this._CancelMouse=function(a){(a=b.keyman.singleton._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=a}g.prototype.getLanguageCodes=function(a){return-1==a.indexOf("-")?[a]:a.split("-")};g.prototype.initDevices=function(){this.device=new d.Device;this.physicalDevice=new d.Device;this.activeDevice=
this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=!1);this.physicalDevice=new d.Device;this.physicalDevice.touchable=!1;this.physicalDevice.browser=this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};g.prototype.arrayFromNodeList=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};g.prototype.addEventListener=function(a,b){this.removeEventListener(a,b);this.events[a].push(b);return!0};g.prototype.removeEventListener=
function(a,b){"undefined"==typeof this.events[a]&&(this.events[a]=[]);for(var c=0;c<this.events[a].length;c++)if(this.events[a][c]==b)return this.events[a].splice(c,1),!0;return!1};g.prototype.callEvent=function(a,b){if("undefined"==typeof this.events[a])return!0;if(-1!=this.currentEvents.indexOf(a))return!1;this.currentEvents.push(a);for(var c=0;c<this.events[a].length;c++){var f=this.events[a][c],e=!1;try{e=f(b)}catch(B){e=!1}if(!1===e)return this.currentEvents.pop(),!1}this.currentEvents.pop();
return!0};g.prototype.attachDOMEvent=function(a,b,c,f){this.detachDOMEvent(a,b,c,f);a.addEventListener(b,c,f?!0:!1);a=new h(a,b,c,f);this.domEvents.push(a)};g.prototype.detachDOMEvent=function(a,b,c,f){a.removeEventListener(b,c,f);a=new h(a,b,c,f);for(b=0;b<this.domEvents.length;b++)if(this.domEvents[b].equals(a)){this.domEvents.splice(b,1);break}};g.prototype.getOption=function(a,b){return a in this.keyman.options?this.keyman.options[a]:1<arguments.length?b:""};g.prototype.hasClass=function(a,b){b=
" "+b+" ";return 0<=(" "+a.className+" ").replace(/[\n\t\r\f]/g," ").indexOf(b)};g.prototype.setOption=function(a,b){this.keyman.options[a]=b};g.prototype._GetAbsoluteX=function(a){if(!a)return 0;var b=a.offsetLeft?a.offsetLeft:0;var c=a;if(c.offsetParent)for(;c.offsetParent;)c=c.offsetParent,b+=c.offsetLeft;return c&&c.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&(a=c.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+this._GetAbsoluteX(a.defaultView.frameElement)-a.documentElement.scrollLeft:
b};g.prototype._GetAbsoluteY=function(a){if(!a)return 0;var b=a.offsetTop?a.offsetTop:0;var c=a;if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement)for(;c.offsetParent;)c=c.offsetParent,b+=c.offsetTop;return c&&c.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&(a=c.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+this._GetAbsoluteY(a.defaultView.frameElement)-a.documentElement.scrollTop:b};g.prototype._GetAbsolute=function(a){return{x:this._GetAbsoluteX(a),
y:this._GetAbsoluteY(a)}};g.prototype.mouseDownPreventDefaultHandler=function(a){a&&a.preventDefault()};g.prototype._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?a.onselectstart=this.selectStartHandler:(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};g.prototype.getIEVersion=function(){return d.Device._GetIEVersion()};g.prototype.getFontSizeStyle=function(a){a="string"==typeof a?
a:a.style.fontSize;return-1!=a.indexOf("em")?(a=parseFloat(a.substr(0,a.indexOf("em"))),{val:a,absolute:!1}):-1!=a.indexOf("px")?(a=parseFloat(a.substr(0,a.indexOf("px"))),{val:a,absolute:!0}):-1!=a.indexOf("%")?(a=parseFloat(a.substr(0,a.indexOf("%"))),{val:a/100,absolute:!1}):null};g.prototype.getStyleValue=function(a,b){try{if(a&&"undefined"!=typeof window.getComputedStyle)return window.getComputedStyle(a,"").getPropertyValue(b)}catch(c){}return""};g.prototype.getStyleInt=function(a,b,c){a=parseInt(this.getStyleValue(a,
b),10);return isNaN(a)?"number"==typeof c?c:0:a};g.prototype.isTouchDevice=function(){return this.device.touchable};g.prototype.portraitView=function(){return!this.landscapeView()};g.prototype.landscapeView=function(){if("undefined"!=typeof window.orientation)var a=window.orientation;else"undefined"!=typeof window.screen.orientation&&(a=window.screen.orientation.angle);return void 0!==a?1==Math.abs(a/90):!1};g.prototype.getViewportScale=function(){try{if(screen.width>document.documentElement.clientWidth)return 1;
var a=screen.width;this.landscapeView()?screen.width<screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/window.innerWidth)/100}catch(e){return 1}};g.prototype.barHeight=function(){var a=0;"phone"==this.device.formFactor&&(a=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return a};g.prototype._EncodeEntities=function(a){return a.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};
g.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};g.prototype.showShim=function(a,b,c){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};g.prototype.hideShim=function(a){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};
g.prototype.rgba=function(a,b,c,f,l){a="transparent";try{a="rgba("+b+","+c+","+f+","+l+")"}catch(B){a="rgb("+b+","+c+","+f+")"}return a};g.prototype.addStyleSheet=function(a){var b=document.createElement("style");b.type="text/css";b.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");0<a.length?a[0].appendChild(b):document.body.appendChild(b);this.linkedStylesheets.push(b);return b};g.prototype.removeStyleSheet=function(a){if(null==a||"object"!=typeof a||"STYLE"!=a.nodeName||
"undefined"==typeof a.parentNode||null==a.parentNode)return!1;a.parentNode.removeChild(a);return!0};g.prototype.linkStyleSheet=function(a){var b=document.getElementsByTagName("head");if(0<b.length){var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=a;this.linkedStylesheets.push(c);b[0].appendChild(c)}};g.prototype.addFontFaceStyleSheet=function(a){if("undefined"!=typeof a&&("undefined"==typeof a.files&&(a.files=a.source),"undefined"!=typeof a.files)){var b,c="",f="",
l="",g="",h=[];for(b=0;b<this.embeddedFonts.length;b++)if(this.embeddedFonts[b]==a.family)return;"string"==typeof a.files?h[0]=a.files:h=a.files;for(b=0;b<h.length;b++)0<h[b].toLowerCase().indexOf(".ttf")&&(c=h[b]),0<h[b].toLowerCase().indexOf(".woff")&&(f=h[b]),0<h[b].toLowerCase().indexOf(".eot")&&(l=h[b]),0<h[b].toLowerCase().indexOf(".svg")&&(g=h[b]);""!=c&&0>c.indexOf("/")&&(c=this.keyman.options.fonts+c);""!=f&&0>f.indexOf("/")&&(f=this.keyman.options.fonts+f);""!=l&&0>l.indexOf("/")&&(l=this.keyman.options.fonts+
l);""!=g&&0>g.indexOf("/")&&(g=this.keyman.options.fonts+g);b="@font-face {\nfont-family:"+a.family+";\nfont-style:normal;\nfont-weight:normal;\n";if(9<=d.Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=c)c=this.unCached(c),b=b+"src:url('"+c+"') format('truetype');";else return;else{l=[];"Android"==this.device.OS?(""!=g&&l.push("url('"+g+"') format('svg')"),""!=f&&l.push("url('"+f+"') format('woff')"),""!=c&&l.push("url('"+c+"') format('truetype')")):(""!=f&&l.push("url('"+f+"') format('woff')"),
""!=c&&l.push("url('"+c+"') format('truetype')"),""!=g&&l.push("url('"+g+"') format('svg')"));if(0==l.length)return;b+="src:"+l.join(",")+";"}else if(""!=l)b=b+"src:url('"+l+"');";else return;this.addStyleSheet(b+"\n}\n");this.embeddedFonts.push(a.family)}};g.prototype.unCached=function(a){return a};g.prototype.loadCookie=function(a){var b={};if(0<arguments.length){var c=this.loadCookie(),f;for(f in c)if(f==a)for(var l=decodeURIComponent(c[f]).split(";"),d=0;d<l.length;d++){var g=l[d].split("=");
b[g[0]]=1<g.length?g[1]:""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(c=document.cookie.split(/;\s*/),d=0;d<c.length;d++)l=c[d].split("="),2==l.length&&(b[l[0]]=l[1]);return b};g.prototype.saveCookie=function(a,b){var c="",f;for(f in b)c=c+f+"="+b[f]+";";b=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=a+"="+encodeURIComponent(c)+"; path=/; expires="+b};g.prototype.toNumber=function(a,b){a=parseInt(a,10);return isNaN(a)?b:a};g.prototype.toFloat=function(a,
b){a=parseFloat(a);return isNaN(a)?b:a};g.prototype.nzString=function(a,b){var c="";1<arguments.length&&(c=b);return"undefined"==typeof a||null==a||0==a||""==a?c:""+a};g.prototype.deepCopy=function(a,b){b=b||{};for(var c in a)"object"===typeof a[c]?(b[c]=a[c].constructor===Array?[]:{},this.deepCopy(a[c],b[c])):b[c]=a[c];return b};g.prototype.eventTarget=function(a){return a?a.target?a.target:a.srcElement?a.srcElement:window.event?window.event.srcElement:null:null};g.prototype.eventType=function(a){return a&&
a.type?a.type:window.event?window.event.type:""};g.prototype.alert=function(a,b){var c=this.waiting,f=c.firstChild.childNodes;f[0].style.display="block";f[1].className="kmw-alert-text";f[1].innerHTML=a;f[2].style.display="none";c.style.display="block";c.dismiss=1<arguments.length?b:null};g.prototype.wait=function(a){};g.prototype.prepareWait=function(){var a=document.createElement("DIV"),b=document.createElement("DIV"),c=document.createElement("DIV"),f=document.createElement("DIV"),l=document.createElement("DIV");
a.className="kmw-wait-background";b.className="kmw-wait-box";a.dismiss=null;c.className="kmw-wait-text";f.className="kmw-wait-graphic";l.className="kmw-alert-close";b.onmousedown=b.onclick=function(b){"block"==l.style.display&&(a.style.display="none",a.dismiss&&a.dismiss())};b.addEventListener("touchstart",b.onclick,!1);a.onmousedown=a.onclick=function(a){a.preventDefault();a.stopPropagation()};a.addEventListener("touchstart",a.onclick,!1);b.appendChild(l);b.appendChild(c);b.appendChild(f);a.appendChild(b);
document.body.appendChild(a);this.waiting=a};g.prototype.shutdown=function(){this.events={};for(var a=0,b=this.domEvents;a<b.length;a++){var c=b[a];this.detachDOMEvent(c.Pelem,c.Peventname,c.Phandler,c.PuseCapture)}this.waiting.parentNode.removeChild(this.waiting);a=0;for(b=this.linkedStylesheets;a<b.length;a++)c=b[a],c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)};g.prototype.myPath=function(a){var b,c=document.getElementsByTagName("script");for(b=0;b<c.length;b++){var f=c[b];if(0<=
f.src.indexOf(a))return f.src.substr(0,f.src.lastIndexOf("/")+1)}return""};g.prototype.prependProtocol=function(a){return/^https?:/.test(a)?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.protocol+"/"+a:this.keyman.protocol+"//"+a};g.prototype.testString=function(a){var b=a.family;if("sample"in a&&"string"==typeof a.sample)return"BESbswy"+a.sample;var c="TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),
f="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");for(a=0;a<c.length;a++)if(b==c[a])return"BESbswy"+f[a];return"BESbswy"};g.prototype.checkFont=function(a){var b=a.family,c=document.createElement("DIV"),f=c.style,l=document.createElement("P"),d=document.createElement("P"),g=document.createElement("SPAN"),h=g.style,k=document.createElement("SPAN"),n=k.style;f.position="absolute";
f.top="10px";f.left="10px";f.visibility="hidden";document.body.appendChild(c);c.appendChild(l);c.appendChild(d);l.appendChild(g);d.appendChild(k);g.setAttribute("style","font-family:monospace !important");n.fontFamily=b+",monospace";h.fontSize=n.fontSize="24px";g.innerHTML=k.innerHTML=this.testString(a);g.offsetWidth!=k.offsetWidth&&(g.setAttribute("style","font-family:sans-serif !important"),n.fontFamily=b+",sans-serif",g.offsetWidth!=k.offsetWidth&&(g.setAttribute("style","font-family:serif !important"),
n.fontFamily=b+",serif"));a=g.offsetWidth!=k.offsetWidth;l.removeChild(g);d.removeChild(k);c.removeChild(l);c.removeChild(d);document.body.removeChild(c);return a};g.prototype.checkFontDescriptor=function(a){return"undefined"==typeof a||"string"!=typeof a.family?!0:this.checkFont(a)};g.instanceof=function(a,b){var c;if(a.Window)return"Window"==b;a.defaultView?c=a.defaultView[b]:a.ownerDocument?c=a.ownerDocument.defaultView[b]:a.target&&(this.instanceof(a.target,"Window")?c=a.target[b]:this.instanceof(a.target,
"Document")?c=a.target.defaultView[b]:this.instanceof(a.target,"HTMLElement")&&(c=a.target.ownerDocument.defaultView[b]));return c?a instanceof c:!1};return g}();d.Util=k})(b.keyman||(b.keyman={}))})(com||(com={}));var Util=com.keyman.Util;
(function(b){(function(d){var h=function(){return function(){}}();d.KeyInformation=h;(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();var k=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,b){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][b]?null:this._cache[a][b]};
a.prototype.set=function(a,b,c){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][b]=c};return a}(),g=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,b){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][b]?null:this._cache[a][b]};a.prototype.set=function(a,b,c){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][b]=c};return a}(),a=function(){function a(b,c){this.p=b;this.d=c;this.o=
a.ordinalSeed++}a.prototype.match=function(a,b){return this.p==a&&this.d==b};a.prototype.set=function(){this.matched=1};a.prototype.reset=function(){this.matched=0};a.prototype.before=function(a){return this.o<a.o};a.ordinalSeed=0;return a}(),e=function(){function a(a){this.e=a;this.c=a.style.backgroundColor}a.prototype.reset=function(){this.e.style.backgroundColor=this.c};return a}(),c=function(){function c(a){this.cachedContext=new k;this.cachedContextEx=new g;this.TSS_LAYER=33;this.TSS_PLATFORM=
31;this._AnyIndices=[];this._BeepObjects=[];this._BeepTimeout=0;this._DeadKeys=[];this._CacheCommands=function(a){var b=[new d.StyleCommand("backcolor",1),new d.StyleCommand("fontname",1),new d.StyleCommand("fontsize",1),new d.StyleCommand("forecolor",1),new d.StyleCommand("bold",0),new d.StyleCommand("italic",0),new d.StyleCommand("strikethrough",0),new d.StyleCommand("subscript",0),new d.StyleCommand("superscript",0),new d.StyleCommand("underline",0)];a.defaultView&&this.keymanweb._push(b,["hilitecolor",
1]);for(var c=0;c<b.length;c++)this.keymanweb._push(b[c],b[c][1]?a.queryCommandValue(b[c][0]):a.queryCommandState(b[c][0]));return b};this._CacheCommandsReset=function(a,b,c){for(var f=0;f<b.length;f++)b[f][1]?a.queryCommandValue(b[f][0])!=b[f][2]&&(c&&c(),a.execCommand(b[f][0],!1,b[f][2])):a.queryCommandState(b[f][0])!=b[f][2]&&(c&&c(),a.execCommand(b[f][0],!1,null))};this.clearDeadkeys=function(){this._DeadKeys=[]};this.keymanweb=a}c.prototype.saveFocus=function(){d.DOMEventHandlers.states._IgnoreNextSelChange=
1};c.prototype.insertText=function(a,b){this.resetContextCache();var c=this.keymanweb.domManager.getLastActiveElement();var f=!1;if(null!=c){f=c._KeymanWebSelectionStart;var e=c._KeymanWebSelectionEnd;this.keymanweb.uiManager.setActivatingUI(!0);d.DOMEventHandlers.states._IgnoreNextSelChange=100;this.keymanweb.domManager.focusLastActiveElement();c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&this.keymanweb.domManager._IsMozillaEditableIframe(c,0)&&(c=c.documentElement);
c._KeymanWebSelectionStart=f;c._KeymanWebSelectionEnd=e;d.DOMEventHandlers.states._IgnoreNextSelChange=0;null!=a&&this.output(0,c,a);"undefined"!==typeof b&&null!==b&&this.deadkeyOutput(0,c,b);c._KeymanWebSelectionStart=null;c._KeymanWebSelectionEnd=null;f=!0}return f};c.prototype.registerKeyboard=function(a){this.keymanweb.keyboardManager._registerKeyboard(a)};c.prototype.registerStub=function(a){return this.keymanweb.keyboardManager._registerStub(a)};c.prototype.context=function(a,b,c){var f=this.cachedContext.get(a,
b);if(null!==f)return f;c=this.keymanweb.KC_(a,b,c);this.cachedContext.set(a,b,c);return c};c.prototype.nul=function(a,b){return"\ufffe"===this.context(a+1,1,b)};c.prototype.contextMatch=function(a,b,c,f){if(this.context(a,f,b)===c)return!0;this._DeadkeyResetMatched();return!1};c.prototype._BuildExtendedContext=function(a,b,c){var f=this.cachedContextEx.get(a,b);if(null!==f)return f;f=this.cachedContextEx.get(a,a);if(null===f){this._DeadKeys.sort(function(a,b){return a.p!=b.p?b.p-a.p:b.o-a.o});var e=
[].concat(this._DeadKeys),l=0;for(f={valContext:[],deadContext:[]};f.valContext.length<a;){var d=this._SelPos(c)-l;0<e.length&&e[0].p==d?(f.deadContext[a-f.valContext.length-1]=e[0],f.valContext=[e[0].d].concat(f.valContext),e.splice(0,1)):(d=this.context(++l,1,c),f.valContext=[d].concat(f.valContext))}this.cachedContextEx.set(a,a,f)}c=f;c.valContext=c.valContext.slice(0,b);for(f=0;f<c.valContext.length;f++)"\ufffe"==c[f]&&(c.valContext.splice(0,1),c.deadContext.splice(0,1));0==c.valContext.length&&
(c.valContext=["\ufffe"],c.deadContext=[]);this.cachedContextEx.set(a,b,c);return c};c.prototype.fullContextMatch=function(a,b,c){b=this._BuildExtendedContext(a,c.length,b);a=b.valContext;b=b.deadContext;for(var f=!1,e=0;e<c.length;e++)if("string"==typeof c[e]){if(c[e]!==a[e]){f=!0;break}}else{var d=c[e];switch(d.t){case "d":d.d!==a[e]?f=!0:b[e].set();break;case "a":var l=this.any(e,"string"==typeof a[e]?a[e]:{t:"d",d:a[e]},d.a);d.n?d.n&&(l||"\ufffe"!==a[e])&&(f=!0):l?void 0!==b[e]&&b[e].set():f=
!0;break;case "i":d=this._Index(d.i,d.o);void 0!==d&&("string"==typeof d?d:d.d)!==a[e]?f=!0:void 0!==b[e]&&b[e].set();break;case "c":a[d.c-1]!==a[e]?f=!0:void 0!==b[e]&&b[e].set();break;case "n":"\ufffe"!=a[e]&&(f=!0);break;default:throw Error("Unexpected object in fullContextMatch specification: "+d);}}f&&(this._DeadkeyResetMatched(),this._AnyIndices=[]);return!f};c.prototype.isKeypress=function(a){return this.keymanweb.keyboardManager.activeKeyboard.KM?!a.LisVirtualKey:this.keymanweb.keyMapManager._USKeyCodeToCharCode(a)?
!0:!1};c.prototype.keyMatch=function(a,c,f){var e=!1,d=173==a.Lcode?189:a.Lcode,l=this.keymanweb.keyboardManager.getKeyboardModifierBitmask(),g=b.keyman.text.Codes,h=l&g.modifierBitmasks.ALL;l&=g.stateBitmasks.ALL;255<a.vkCode&&(d=a.vkCode);if(a.LisVirtualKey||255<d){if(16384==(c&16384)||255<d)e=(e=f==d&&(c&h)==a.Lmodifiers)&&this.stateMatch(a,c&l)}else 0==(c&16384)&&(e=d==f);e||this._DeadkeyResetMatched();return e};c.prototype.stateMatch=function(a,b){return(b&a.Lstates)==b};c.prototype.keyInformation=
function(a){var b=new h;b.vk=a.LisVirtualKey;b.code=a.Lcode;b.modifiers=a.Lmodifiers;return b};c.prototype.deadkeyMatch=function(a,b,c){if(0==this._DeadKeys.length)return!1;a=this._SelPos(b)-a;for(b=0;b<this._DeadKeys.length;b++)if(this._DeadKeys[b].match(a,c)&&!this._DeadKeys[b].matched)return this._DeadKeys[b].set(),!0;this._DeadkeyResetMatched();return!1};c.prototype.beepReset=function(){this.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();
this._BeepObjects=[]};c.prototype.beep=function(a){this.resetContextCache();var b=a;b.defaultView&&a instanceof b.defaultView.Document&&(a=b.body);if(a.style&&"undefined"!=typeof a.style.backgroundColor){for(b=0;b<this._BeepObjects.length;b++)if(this._BeepObjects[b].e==a)return;this._BeepObjects=this.keymanweb._push(this._BeepObjects,new e(a));a.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),50));"beepKeyboard"in this.keymanweb&&
this.keymanweb.beepKeyboard()}};c.prototype._ExplodeStore=function(a){if("string"==typeof a){var b=this.keymanweb.keyboardManager.getActiveKeyboardTag();if(b.stores[a])return b.stores[a];for(var c=[],f=0;f<a._kmwLength();f++)c.push(a._kmwCharAt(f));return b.stores[a]=c}return a};c.prototype.any=function(a,b,c){if(""==b)return!1;c=this._ExplodeStore(c);for(var f=-1,e=0;e<c.length;e++)if("string"==typeof c[e]){if(c[e]==b){f=e;break}}else if(c[e].d===b.d){f=e;break}this._AnyIndices[a]=f;return 0<=f};
c.prototype._Index=function(a,b){a=this._ExplodeStore(a);if(this._AnyIndices[b-1]<a.length)return a[this._AnyIndices[b-1]];console.warn("Unmatched contextual index() statement detected in rule with index "+b+"!");return""};c.prototype.indexOutput=function(a,b,c,f){this.resetContextCache();b=this._Index(b,c);if(""!==b)if("string"==typeof b)this.output(a,f,b);else if(b.t)switch(b.t){case "b":this.beep(f);break;case "d":this.deadkeyOutput(a,f,b.d);break;default:throw Error("Unexpected object in fullContextMatch specification: "+
b);}else this.deadkeyOutput(a,f,b.d)};c.prototype.deleteContext=function(a,b){if(0<a){var c=this._BuildExtendedContext(a,a,b);for(var f=0;f<c.deadContext.length;f++){var e=c.deadContext[f];e&&(e=this._DeadKeys.indexOf(e),this._DeadKeys.splice(e,1),a--)}}this._DeadkeyResetMatched();this.output(a,b,"")};c.prototype.output=function(a,b,c){this.resetContextCache();if("oninserttext"in this.keymanweb)this.keymanweb.oninserttext(a,c);var f=b.body?b:b.ownerDocument;var e;if(0<=b.className.indexOf("keymanweb-input"))f=
this.keymanweb.touchAliasing.getTextBeforeCaret(b),f=0<a?f._kmwSubstr(0,f._kmwLength()-a)+c:f+c,this.keymanweb.touchAliasing.setTextBeforeCaret(b,f),this._DeadkeyDeleteMatched(),0<=a&&this._DeadkeyAdjustPos(this._SelPos(b),-a+c._kmwLength());else{if(f&&(e=f.defaultView)&&e.getSelection&&("on"==f.designMode.toLowerCase()||"true"==b.contentEditable||"plaintext-only"==b.contentEditable||""===b.contentEditable)){var l="on"==f.designMode.toLowerCase();if(l)var g=this._CacheCommands(f);var h=e.getSelection();
e=h.focusNode.nodeValue?h.focusNode.substringData(0,h.focusOffset)._kmwLength():0;h.isCollapsed||h.deleteFromDocument();var k=h.getRangeAt(0);0<a&&(k.setStart(h.focusNode,h.focusOffset-h.focusNode.nodeValue.substr(0,h.focusOffset)._kmwSubstr(-a).length),k.deleteContents());if(0<c._kmwLength())if(3==h.focusNode.nodeType){k=h.focusOffset;h.focusNode.insertData(h.focusOffset,c);try{h.extend(h.focusNode,k+c.length)}catch(y){h.focusNode.parentNode.scrollIntoView(),h.extend(h.focusNode,k+c.length)}}else{var B=
f.createTextNode(c);k.insertNode(B);h.extend(B,c.length)}l&&this._CacheCommandsReset(f,g,null);h.collapseToEnd();0<=a&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(e,-a+c._kmwLength()))}else b.setSelectionRange&&(null!=b._KeymanWebSelectionStart?(e=b._KeymanWebSelectionStart,f=b._KeymanWebSelectionEnd):(e=b.value._kmwCodeUnitToCodePoint(b.selectionStart),f=b.value._kmwCodeUnitToCodePoint(b.selectionEnd)),"textarea"==b.type.toLowerCase()&&"undefined"!=typeof b.scrollTop&&(l=b.scrollTop,h=b.scrollLeft),
0>a?(b.value=b.value._kmwSubstring(0,e)+c+b.value._kmwSubstring(f),a=0):b.value=e<a?c+b.value._kmwSubstring(f):b.value._kmwSubstring(0,e-a)+c+b.value._kmwSubstring(f),0<=a&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(e,-a+c._kmwLength())),"undefined"!=typeof l&&(b.scrollTop=l,b.scrollLeft=h),f=e-a+c._kmwLength(),f=b.value._kmwCodePointToCodeUnit(f),b.setSelectionRange(f,f),b._KeymanWebSelectionStart=null,b._KeymanWebSelectionEnd=null);"function"==typeof this.keymanweb.refreshElementContent&&
this.keymanweb.refreshElementContent(b)}(0<=a||c)&&b==d.DOMEventHandlers.states.activeElement&&(d.DOMEventHandlers.states.changed=!0)};c.prototype.deadkeyOutput=function(b,c,f){this.resetContextCache();0<=b&&this.output(b,c,"");this._DeadKeys=[new a(this._SelPos(c),f)].concat(this._DeadKeys)};c.prototype.ifStore=function(a,b,c){c=!0;if(a==this.TSS_LAYER)c=this.keymanweb.osk.vkbd.layerId===b;else if(a==this.TSS_PLATFORM){var f=b.split(" ");for(a=0;a<f.length;a++)switch(b=f[a].toLowerCase(),b){case "touch":case "hardware":this.keymanweb.util.activeDevice.touchable!=
("touch"==b)&&(c=!1);break;case "macos":case "mac":b="macosx";case "macosx":case "windows":case "android":case "ios":case "linux":this.keymanweb.util.activeDevice.OS.toLowerCase()!=b&&(c=!1);break;case "tablet":case "phone":case "desktop":this.keymanweb.util.device.formFactor!=b&&(c=!1);break;case "web":"native"==this.keymanweb.util.device.browser&&(c=!1);break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "edge":case "opera":this.keymanweb.util.device.browser!=b&&(c=!1);
break;default:c=!1}}return c};c.prototype.setStore=function(a,b,c){this.resetContextCache();return a==this.TSS_LAYER?this.keymanweb.osk.vkbd.showLayer(b):!1};c.prototype.loadStore=function(a,b,c){this.resetContextCache();a=this.keymanweb.util.loadCookie("KeymanWeb_"+a+"_Option_"+b);return"undefined"!=typeof a[b]?decodeURIComponent(a[b]):c};c.prototype.saveStore=function(a,b){this.resetContextCache();var c=this.keymanweb.keyboardManager.activeKeyboard;if(!c||"undefined"==typeof c.KI||""==c.KI)return!1;
a="KeymanWeb_"+c.KI+"_Option_"+a;b=encodeURIComponent(b);this.keymanweb.util.saveCookie(a,b);return!0};c.prototype.resetContextCache=function(){this.cachedContext.reset();this.cachedContextEx.reset()};c.prototype._DeadkeyResetMatched=function(){for(var a=0,b=this._DeadKeys;a<b.length;a++)b[a].reset()};c.prototype._DeadkeyDeleteMatched=function(){for(var a=this._DeadKeys,b=0;b<a.length;b++)a[b].matched&&a.splice(b--,1)};c.prototype._DeadkeyAdjustPos=function(a,b){for(var c=0,f=this._DeadKeys;c<f.length;c++){var e=
f[c];e.p>a&&(e.p+=b)}};c.prototype.doInputEvent=function(a){var b;"function"==typeof window.InputEvent&&(b=new window.InputEvent("input",{bubbles:!0,cancelable:!1}));a.base&&a.base.kmw_ip&&(a=a.base);a&&b&&a.dispatchEvent(b)};c.prototype.defaultBackspace=function(a){a||(a=this.keymanweb.domManager.getLastActiveElement());this.output(1,a,"");this.doInputEvent(a)};c.prototype.processKeystroke=function(a,b,c){this.keymanweb._CachedSelectionStart=null;this._DeadkeyResetMatched();this.resetContextCache();
this.keymanweb.util.activeDevice=a;(a=this.keymanweb.keyboardManager.activeKeyboard.gs(b,c))&&this.doInputEvent(b);return a};c.prototype.getLastActiveElement=function(){return this.keymanweb.domManager.getLastActiveElement()};c.prototype.focusLastActiveElement=function(){this.keymanweb.domManager.focusLastActiveElement()};c.prototype.hideHelp=function(){this.keymanweb.osk._Hide(!0)};c.prototype.showHelp=function(a,b){this.keymanweb.osk._Show(a,b)};c.prototype.showPinnedHelp=function(){this.keymanweb.osk.userPositioned=
!0;this.keymanweb.osk._Show(-1,-1)};c.prototype.resetContext=function(){this.keymanweb.osk.vkbd&&(this.keymanweb.osk.vkbd.layerId="default");this.clearDeadkeys();this.resetContextCache();this.resetVKShift();this.keymanweb.osk._Show()};c.prototype.setNumericLayer=function(){var a,b=this.keymanweb.osk.vkbd;for(a=0;a<b.layers.length;a++)"numeric"==b.layers[a].id&&(b.layerId="numeric",this.keymanweb.osk._Show())};c.prototype._SelPos=function(a){var b,c;d.Device._GetIEVersion();if(this.keymanweb.isPositionSynthesized())return this.keymanweb.touchAliasing.getTextCaret(a);
if(a._KeymanWebSelectionStart)return a._KeymanWebSelectionStart;if((b=a.ownerDocument)&&(c=b.defaultView))if(a instanceof c.HTMLInputElement||a instanceof c.HTMLTextAreaElement){if(a.setSelectionRange)return a.value.substr(0,a.selectionStart)._kmwLength()}else if(c.getSelection&&"on"==a.ownerDocument.designMode.toLowerCase()&&(a=c.getSelection(),3==a.focusNode.nodeType))return a.focusNode.substringData(0,a.focusOffset)._kmwLength();return 0};c.prototype.resetVKShift=function(){var a=b.keyman.singleton.textProcessor;
!this.keymanweb.uiManager.isActivating&&this.keymanweb.osk.vkbd&&a._UpdateVKShift&&a._UpdateVKShift(null,15,0)};return c}();d.KeyboardInterface=c})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(b){var d=function(){function a(a,b){this.id=a;this.language=b}a.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};return a}(),k=function(){return function(a,b){this.family=a.family;this.files=a.source;this.path=b}}(),g=function(){return function(a,b){this.KI="Keyboard_"+a;this.KLC=b}}();b.KeyboardStub=g;var a=function(){return function(){this.stores={}}}();b.KeyboardTag=
a;var e=function(){function c(a){this.activeStub=null;this.keyboardStubs=[];this.deferredStubs=[];this.deferredKRS=[];this.deferredKR=[];this.dfltStub=null;this.keyboards=[];this.languageList=null;this.languagesPending=[];this.linkedScripts=[];this._GetKeyboardDetail=function(a){var b={};b.Name=a.KN;b.InternalName=a.KI;b.LanguageName=a.KL;b.LanguageCode=a.KLC;b.RegionName=a.KR;b.RegionCode=a.KRC;b.CountryName=a.KC;b.CountryCode=a.KCC;b.KeyboardID=a.KD;b.Font=a.KFont;b.OskFont=a.KOskFont;return b};
this.notifyKeyboard=function(a,b,c){var f=this.activeKeyboard;null!=f&&"function"==typeof f.KNS&&f.KNS(a,b,c)};this.keymanweb=a}c.prototype.getActiveKeyboardName=function(){return this.activeKeyboard?this.activeKeyboard.KI:""};c.prototype.getActiveKeyboardTag=function(){return this.activeKeyboard?this.activeKeyboard._kmw:null};c.prototype.getActiveLanguage=function(a){return null==this.activeStub?"":a?this.activeStub.KL:this.activeStub.KLC};c.prototype.getDetailedKeyboards=function(){var a=[],b;for(b=
0;b<this.keyboardStubs.length;b++){var c=this.keyboardStubs[b];c=this._GetKeyboardDetail(c);a=this.keymanweb._push(a,c)}return a};c.prototype.registerDeferredStubs=function(){this.addKeyboardArray(this.deferredStubs);for(var a=0;a<this.deferredKRS.length;a++)this._registerStub(this.deferredKRS[a])};c.prototype.registerDeferredKeyboards=function(){for(var a=0;a<this.deferredKR.length;a++)this._registerKeyboard(this.deferredKR[a])};c.prototype.addStub=function(a){if("string"!=typeof a.id)return!1;"undefined"!=
typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var b=a.languages,c=[];"undefined"==typeof b.length?c[0]=b:c=b;var f={keyboardBaseUri:this.keymanweb.options.keyboards,fontBaseUri:this.keymanweb.options.fonts};for(b=0;b<c.length;b++)this.mergeStub(a,
c[b],f);return!0};c.prototype.mergeStub=function(a,b,e){var f=this.findStub(a.id,b.id),d=!1;null==f&&(f=new g(a.id,b.id),this.keyboardStubs.push(f),d=!0);var l=b.region,h=0;if("number"==typeof l)h=1>l||9<l?0:l-1;else if("string"==typeof l)for(var r=2==l.length?c.regionCodes:c.regions,q=0;q<r.length;q++)if(l.toLowerCase()==r[q].toLowerCase()){h=q;break}f.KL="undefined"===typeof f.KL?b.name:f.KL;f.KR="undefined"===typeof f.KR?c.regions[h]:f.KR;f.KRC="undefined"===typeof f.KRC?c.regionCodes[h]:f.KRC;
f.KN="undefined"===typeof f.KN?a.name:f.KN;"undefined"==typeof f.KF&&(l=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,f.KF=a.filename,l.test(f.KF)||(f.KF=e.keyboardBaseUri+f.KF));a=e.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,l=/^https?\:/,l.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=a;"undefined"!=typeof b.font&&(f.KFont="undefined"===typeof f.KFont?
new k(b.font,a):f.KFont);"undefined"!=typeof b.oskFont&&(f.KOskFont="undefined"===typeof f.KOskFont?new k(b.oskFont,a):f.KOskFont);this.doKeyboardRegistered(f.KI,f.KL,f.KN,f.KLC,f.KP);!this.activeStub&&d&&1==this.keyboardStubs.length&&(this.doBeforeKeyboardChange(f.KI,f.KLC),this._SetActiveKeyboard(f.KI,f.KLC,!1),this.doKeyboardChange(f.KI,f.KLC))};c.prototype.findStub=function(a,b){var c;for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI=="Keyboard_"+a&&this.keyboardStubs[c].KLC==
b)return this.keyboardStubs[c];return null};c.prototype.setDefaultKeyboard=function(){return 0<this.keyboardStubs.length?(this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC),!0):!1};c.prototype.setActiveKeyboard=function(a,b){!this.keymanweb.isEmbedded&&a&&0!=a.indexOf("Keyboard_")&&(a="Keyboard_"+a);this.doBeforeKeyboardChange(a,b);var c=this._SetActiveKeyboard(a,b,!0);null!=this.keymanweb.domManager.getLastActiveElement()&&this.keymanweb.domManager.focusLastActiveElement();
this.doKeyboardChange(a,b);return c};c.prototype._SetActiveKeyboard=function(a,b,c){var f,e,d=this.keymanweb.util,g=this.keymanweb.osk;if(2>arguments.length||!b)b="---";for(f=0;f<this.keyboardStubs.length&&(a!=this.keyboardStubs[f].KI||b!=this.keyboardStubs[f].KLC&&"---"!=b);f++);d.device.touchable&&(""==a||null==a||f>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,b=this.keyboardStubs[0].KLC);2<arguments.length&&c&&this.saveCurrentKeyboard(a,b);if(this.activeStub&&
this.activeKeyboard&&this.activeKeyboard.KI==a&&this.activeStub.KI==a&&this.activeStub.KLC==b&&!this.keymanweb.mustReloadKeyboard)return Promise.resolve();if(this.activeKeyboard&&this.activeKeyboard.KI==a)for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&this.keyboardStubs[e].KLC==b)return this.activeStub=this.keyboardStubs[e],g.vkbd.appendStyleSheet(),this.keymanweb.mustReloadKeyboard&&g._Load(),Promise.resolve();this.activeStub=this.activeKeyboard=null;if(""==a)return g._Hide(!1),
this.keymanweb.isEmbedded||d.wait(!1),Promise.resolve();for(e=0;e<this.keyboards.length;e++)if(this.keyboards[e].KI==a){this.activeKeyboard=this.keyboards[e];this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement());for(f=0;f<this.keyboardStubs.length;f++)if(this.keyboardStubs[f].KI==a&&(this.keyboardStubs[f].KLC==b||"---"==b)){this.activeStub=this.keyboardStubs[f];break}break}if(null==this.activeKeyboard){for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==
a&&(this.keyboardStubs[e].KLC==b||"---"==b)){if(this.isCJK(this.keyboardStubs[e])||d.device.touchable)g._Enabled=!0;if(!this.keyboardStubs[e].asyncLoader){g.ready&&g._Hide(!1);var l=this.keyboardStubs[e];l.asyncLoader={};var h=l.KN,k=l.KL;h=h.replace(/\s*keyboard\s*/i,"");l.asyncLoader.callback=function(a,b){var c=a||"Sorry, the "+h+" keyboard for "+k+" is not currently available.";this.keymanweb.isEmbedded||(d.wait(!1),d.alert(a||c,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(b){case "err":console.error(c);
break;default:console.warn(c)}0<e&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);l.asyncLoader.timer=window.setTimeout(l.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||d.wait("Installing keyboard<br/>"+h);var B=this;l.asyncLoader.promise=new Promise(function(a,b){window.setTimeout(function(){B.installKeyboard(a,b,l)},0)})}this.activeStub=this.keyboardStubs[e];return this.keyboardStubs[e].asyncLoader.promise}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement())}f=
this.activeKeyboard;null!==f&&String.kmwEnableSupplementaryPlane(f&&(f.KS&&1==f.KS||"Hieroglyphic"==f.KN));g._Load();return Promise.resolve()};c.prototype.installKeyboard=function(a,b,c){var f=this.keymanweb.util,e=this.keymanweb.osk,d=f._CreateElement("script");d.charset="UTF-8";d.type="text/javascript";this.keymanweb.isEmbedded&&(d.id=c.KI);var g=c.KF,l=c.KL,h=c.KN,k=this;d.addEventListener("error",function(){null!==c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=
null);c.asyncLoader.callback("Cannot find the "+h+" keyboard for "+l+".","warn");c.asyncLoader=null;b()},!1);d.addEventListener("load",function(){null!==c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=null);var d=k.getKeyboardByID(c.KI);d?(c==k.activeStub&&(k.doBeforeKeyboardChange(d.KI,c.KLC),k.activeKeyboard=d,null!=k.keymanweb.domManager.getLastActiveElement()&&(k.keymanweb.uiManager.justActivated=!0,k.keymanweb.domManager._SetTargDir(k.keymanweb.domManager.getLastActiveElement())),
String.kmwEnableSupplementaryPlane(d&&(d.KS&&1==d.KS||"Hieroglyphic"==d.KN)),k.saveCurrentKeyboard(d.KI,c.KLC),e._Load()),k.keymanweb.isEmbedded||f.wait(!1),c.asyncLoader=null,a()):(c.asyncLoader.callback("Error registering the "+h+" keyboard for "+l+".","error"),c.asyncLoader=null,b())},!1);d.src=this.keymanweb.getKeyboardPath(g);try{document.body.appendChild(d),this.linkedScripts.push(d)}catch(v){try{document.getElementsByTagName("head")[0].appendChild(d)}catch(y){b()}}};c.prototype.saveCurrentKeyboard=
function(a,b){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b});this.keymanweb.isEmbedded||this.keymanweb.touchAliasing._BlurKeyboardSettings(a,b)};c.prototype.restoreCurrentKeyboard=function(){var a=this.keyboardStubs,b=a.length;if(!(1>a.length)){var c=this.getSavedKeyboard();c.split(":");var e=c.split(":");2>e.length&&(e[1]="");for(c=0;c<b&&(a[c].KI!=e[0]||a[c].KLC!=e[1]&&""!=e[1]);c++);if(c<b||null==this.activeKeyboard)this._SetActiveKeyboard(e[0],e[1],!1),this.keymanweb.globalKeyboard=
e[0],this.keymanweb.globalLanguageCode=e[1],this.doKeyboardChange(e[0],e[1])}};c.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");if("string"!=typeof a.current)return"Keyboard_us:eng";var b,c=this.keyboardStubs;for(b=0;b<c.length;b++){var e=c[b].KI+":"+c[b].KLC;if(e==a.current)return e}for(b=0;b<c.length;b++)if(e=c[b].KI+":"+c[b].KLC,"Keyboard_us:eng"==e)return e;return 0<c.length?c[0].KI+":"+c[0].KLC:"Keyboard_us:eng"};c.prototype.isCJK=function(a){var b=
this.activeKeyboard,c="";0<arguments.length&&(b=a);b&&("undefined"!=typeof b.KLC?c=b.KLC:"undefined"!=typeof b.LanguageCode&&(c=b.LanguageCode));return"cmn"==c||"jpn"==c||"kor"==c};c.prototype.isRTL=function(a){a=a||this.activeKeyboard;return null!=a&&a.KRTL};c.prototype.isChiral=function(a){"string"==typeof a&&(a=this.getKeyboardByID(a));return!!(this.getKeyboardModifierBitmask(a)&b.text.Codes.modifierBitmasks.IS_CHIRAL)};c.prototype.getKeyboardModifierBitmask=function(a){var c=this.activeKeyboard;
0<arguments.length&&"undefined"!=typeof a&&(c=a);return c?c.KMBM?c.KMBM:b.text.Codes.modifierBitmasks.NON_CHIRAL:0};c.prototype.getFont=function(a){return(a=a||this.activeKeyboard)&&a.KV?a.KV.F:null};c.prototype.getKeyboardByID=function(a){var b;for(b=0;b<this.keyboards.length;b++)if(a==this.keyboards[b].KI)return this.keyboards[b];return null};c.prototype.isUniqueRequest=function(a,b){var c;if(null==this.findStub(b.id,b.language)){for(c=0;c<a.length;c++)if(a[c].id==b.id&&a[c].language==b.language)return!1;
return!0}return!1};c.prototype.addKeyboardArray=function(a){if(!this.keymanweb.initialized)for(var b=0;b<a.length;b++)this.deferredStubs.push(a[b]);else if(0!=a.length){var c,e="",f=[];for(b=0;b<a.length;b++){if("string"==typeof a[b]&&0<a[b].length){var g=a[b].split("@"),h=[""];"english"==g[0].toLowerCase()&&(g[0]="us");1<g.length&&(h=g[1].split(","));for(c=0;c<h.length;c++){var k=new d(g[0]);""!=h[c]&&(k.language=h[c]);2<g.length&&(k.version=g[2]);this.isUniqueRequest(f,k)&&f.push(k)}}if("object"==
typeof a[b]&&null!=a[b])if("string"==typeof a[b].filename)this.addStub(a[b])||alert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");else if(a[b].language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[b].languages=a[b].language),h=a[b].languages,"number"==typeof h.length)for(c=0;c<h.length;c++)k=new d(a[b].id,a[b].languages[c].id),this.isUniqueRequest(f,
k)&&f.push(k);else k=new d(a[b].id,a[b].languages[c].id),this.isUniqueRequest(f,k)&&f.push(k)}if(0!=f.length){a="&keyboardid=";for(b=0;b<f.length;b++)a=a+e+f[b].toString(),e=",";this.keymanCloudRequest(a,!1)}}};c.prototype.registerLanguagesForKeyboard=function(a,b,c){var e,f=0;var d="";if("undefined"!=typeof a)if("string"==typeof b.keyboardid&&(d=b.keyboardid.split(",")[c]),"number"==typeof a.length)if(1==a.length||"$"==d.substr(-1,1)||""==d)for(d=0;d<a.length;d++)this.registerLanguagesForKeyboard(a[d],
b,c);else{for(d=0;d<a.length;d++){var g=a[d].id.toLowerCase();"us"==g&&(g="english");for(e=0;e<a[d].languages.length;e++)if(g==a[d].languages[e].name.toLowerCase()){f=d;break}}this.registerLanguagesForKeyboard(a[f],b,c)}else if(c=d.split("@")[1],"string"==typeof c&&(c=c.replace(/\$$/,"")),f=a.languages,"undefined"!=typeof f)if("number"==typeof f.length)for(d=0;d<f.length;d++)"undefined"!=typeof c&&f[d].id!=c||this.mergeStub(a,f[d],b);else this.mergeStub(a,f,b)};c.prototype.register=function(a){var b=
a.options;a.timerid&&window.clearTimeout(a.timerid);if("string"==typeof a.error)b="","string"==typeof a.keyboardid&&(b=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),this.serverUnavailable(b+" keyboard not found.");else if("undefined"!=typeof b&&"undefined"!=typeof b.context)if("keyboard"==b.context){var c=a.keyboard;if("number"==typeof c.length)for(a=0;a<c.length;a++)this.registerLanguagesForKeyboard(c[a],b,a);else this.registerLanguagesForKeyboard(c,b,0)}else"language"==b.context&&
(this.languageList=a.languages,this.languagesPending&&this.addLanguageKeyboards(this.languagesPending),this.languagesPending=[])};c.prototype.addLanguageKeyboards=function(a){var b,c;if(null==this.languageList){var e=0==this.languagesPending.length;for(b=0;b<a.length;b++)this.languagesPending.push(a[b]);e&&this.keymanCloudRequest("",!0)}else{var f="";for(b=0;b<a.length;b++){var d=a[b].toLowerCase();(c="$"==d.substr(-1,1))&&(d=d.substr(0,d.length-1));for(e=0;e<this.languageList.length;e++)if(d==this.languageList[e].name.toLowerCase()){""!=
f&&(f+=",");f=f+"@"+this.languageList[e].id;c&&(f+="$");break}}""==f?this.keymanweb.util.alert("No keyboards are available for "+a[0]+". Does it have another language name?"):this.keymanCloudRequest("&keyboardid="+f,!1)}};c.prototype.keymanCloudRequest=function(a,c){var e="https://api.keyman.com/cloud/4.0/",f=this.keymanweb.util._CreateElement("script");e=e+(1<arguments.length&&c?"languages":"keyboards")+"?jsonp=keyman.register&languageidtype=bcp47&version="+this.keymanweb.version+"."+b.KeymanBase.__BUILD__;
var d=this;var g="&timerid="+window.setTimeout(function(){d.serverUnavailable(a)},1E4);f.charset="UTF-8";f.src=e+a+g;f.type="text/javascript";try{document.body.appendChild(f)}catch(n){document.getElementsByTagName("head")[0].appendChild(f)}};c.prototype.serverUnavailable=function(a){this.keymanweb.util.alert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};c.prototype.removeKeyboards=function(a){if(0==arguments.length)return!1;var b,c,e=!0,f=!1,d=!1;for(b=0;b<arguments.length;b++){for(c=
this.keyboardStubs.length-1;0<=c;c--)if("Keyboard_"+arguments[b]==this.keyboardStubs[c].KI){"Keyboard_"+arguments[b]==this.getActiveKeyboardName()&&(f=!0);d=!0;this.keyboardStubs.splice(c,1);break}0>c&&(e=!1)}f&&(0<this.keyboardStubs.length?this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);d&&this.doKeyboardUnregistered();return e};c.prototype._registerKeyboard=function(b){if(this.keymanweb.initialized)if(b._kmw)console.error("The keyboard _kmw property is a reserved field for engine use only; this keyboard is invalid.");
else{b._kmw=new a;var c;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(b);var e=this.activeStub,f=this.activeStub;if(!(e&&"KI"in e)||e.KI!=b.KI)for(c=0;c<this.keyboardStubs.length;c++){e=this.keyboardStubs[c];if(b.KI==e.KI)break;e=null}null==this.activeStub&&null!=e&&(this.activeStub=e);for(c=0;c<this.keyboards.length;c++)if(b.KI==this.keyboards[c].KI)return;this.keyboards=this.keymanweb._push(this.keyboards,b);this.doKeyboardLoaded(b.KI);this.activeStub=f}else this.deferredKR.push(b)};c.prototype._registerStub=
function(a){var b;if(!this.keymanweb.initialized)return this.deferredKRS.push(a),null;null==this.dfltStub&&(this.dfltStub=a);this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==typeof a.KL&&(a.KL="undefined");for(b=0;b<this.keyboardStubs.length;b++)if(this.keyboardStubs[b].KI==a.KI&&(""==a.KLC||this.keyboardStubs[b].KLC==a.KLC))return 1;this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a);this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,
a.KP);this.activeStub||this.dfltStub!=a||1!=this.keyboardStubs.length||this.setActiveKeyboard(a.KI,a.KLC);return null};c.prototype.doKeyboardRegistered=function(a,b,c,e,d){a={internalName:a,language:b,keyboardName:c,languageCode:e};d&&(a["package"]=d);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};c.prototype.doKeyboardUnregistered=function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};c.prototype.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",
b)};c.prototype.doBeforeKeyboardChange=function(a,b){var c={};c.internalName=a;c.languageCode=b;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",c)};c.prototype.doKeyboardChange=function(a,b,c){var e={};e.internalName=a;e.languageCode=b;e.indirect=2<arguments.length?c:!1;return this.keymanweb.util.callEvent("kmw.keyboardchange",e)};c.prototype.shutdown=function(){for(var a=0,b=this.linkedScripts;a<b.length;a++){var c=b[a];c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)}};
c.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");c.regionCodes="un af as eu sa na oc ca me".split(" ");return c}();b.KeyboardManager=e})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(b){var d=function(){return function(){}}(),k=function(){return function(){this.FF=new d;this.Safari=new d;this.Opera=new d;this.FF.k61=187;this.FF.k59=186}}(),g=function(){return function(){this.se=new d;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new d;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),a=function(){function a(){this.browserMap=new k;this.languageMap=
new g;this._usCodeInit()}a.prototype._usCodeInit=function(){var a=new d,b=new d;a.k192=96;a.k49=49;a.k50=50;a.k51=51;a.k52=52;a.k53=53;a.k54=54;a.k55=55;a.k56=56;a.k57=57;a.k48=48;a.k189=45;a.k187=61;a.k81=113;a.k87=119;a.k69=101;a.k82=114;a.k84=116;a.k89=121;a.k85=117;a.k73=105;a.k79=111;a.k80=112;a.k219=91;a.k221=93;a.k220=92;a.k65=97;a.k83=115;a.k68=100;a.k70=102;a.k71=103;a.k72=104;a.k74=106;a.k75=107;a.k76=108;a.k186=59;a.k222=39;a.k90=122;a.k88=120;a.k67=99;a.k86=118;a.k66=98;a.k78=110;a.k77=
109;a.k188=44;a.k190=46;a.k191=47;b.k192=126;b.k49=33;b.k50=64;b.k51=35;b.k52=36;b.k53=37;b.k54=94;b.k55=38;b.k56=42;b.k57=40;b.k48=41;b.k189=95;b.k187=43;b.k81=81;b.k87=87;b.k69=69;b.k82=82;b.k84=84;b.k89=89;b.k85=85;b.k73=73;b.k79=79;b.k80=80;b.k219=123;b.k221=125;b.k220=124;b.k65=65;b.k83=83;b.k68=68;b.k70=70;b.k71=71;b.k72=72;b.k74=74;b.k75=75;b.k76=76;b.k186=58;b.k222=34;b.k90=90;b.k88=88;b.k67=67;b.k86=86;b.k66=66;b.k78=78;b.k77=77;b.k188=60;b.k190=62;b.k191=63;this._usCharCodes=[a,b]};a.prototype._USKeyCodeToCharCode=
function(a){return this._usCharCodes[a.Lmodifiers&16?1:0]["k"+a.Lcode]};return a}();b.KeyMapManager=a})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(b){var d=function(){function b(a,b,c){this.code=a;this.shift=b;this.handler=c}b.prototype.matches=function(a,b){return this.code==a&&this.shift==b};return b}(),k=function(){function b(a){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var b=this.keyman.textProcessor._GetEventKeyCode(a);if(null==b)return!1;for(var e=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),d=0;d<this.hotkeys.length;d++)if(this.hotkeys[d].matches(b,e))return this.hotkeys[d].handler(),a.returnValue=
!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=a}b.prototype.addHotKey=function(a,b,c){for(var e=0;e<this.hotkeys.length;e++)if(this.hotkeys[e].code==a&&this.hotkeys[e].shift==b){this.hotkeys[e].handler=c;return}this.hotkeys.push(new d(a,b,c))};b.prototype.removeHotkey=function(a,b){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].matches(a,b)){this.hotkeys.splice(c,1);break}};return b}();b.HotkeyManager=k})(b.keyman||(b.keyman={}))})(com||
(com={}));
(function(b){(function(b){var d=function(){return function(b,a){this.activationPending=b;this.activated=a}}();b.UIState=d;var k=function(){function b(a){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",{})};this.keyman=a}b.prototype.getUIState=function(){return new d(this.isActivating,this.justActivated)};b.prototype.setActivatingUI=function(a){this.isActivating=a?!0:!1};b.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};
return b}();b.UIManager=k})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){(function(d){var h=b.keyman.text.Codes,g=function(){function a(){}a.buildDefaultLayout=function(e,c,f){var g=b.keyman.singleton.util,k=f;"object"!=typeof a.dfltLayout[k]&&(k="desktop");k=g.deepCopy(a.dfltLayout[k]);var t,m=k.layer,p=e.KLS,n=e.K102,r,q=0!=(c&h.modifierBitmasks.IS_CHIRAL);(c=!("undefined"==typeof p||!p))||(p=e.KLS=a.processLegacyDefinitions(e.BK));e=Object.getOwnPropertyNames(p);var u=[];e.splice(e.indexOf("default"),1);e=["default"].concat(e);a.emulatesAltGr(p)&&
(-1==e.indexOf("leftctrl-leftalt")&&-1!=e.indexOf("rightalt")&&(e.push("leftctrl-leftalt"),p["leftctrl-leftalt"]=p.rightalt),-1==e.indexOf("leftctrl-leftalt-shift")&&-1!=e.indexOf("rightalt-shift")&&(e.push("leftctrl-leftalt-shift"),p["leftctrl-leftalt-shift"]=p["rightalt-shift"]));if("desktop"==f)for(u=a.generateLayerIds(q),t=0;t<u.length;t++)-1!=e.indexOf(u[t])&&u.splice(t--,1);var v=e.concat(u);if(c&&"desktop"!=f){c=null;u=m[0].row;for(t=0;t<u.length;t++){var y=u[t].key;for(var D=0;D<y.length;D++){var w=
y[D];"K_SHIFT"==w.id&&(c=w)}}if(c)for(r in c.sk=[],p)"default"!=r&&"shift"!=r&&(t=a.modifierSpecials[r],c.sk.push(new d.OSKKeySpec("K_"+t,t,null,"1",r)));else console.warn("Error in default layout - cannot find default Shift key!")}for(t=0;t<v.length;t++)0<t&&(m[t]=g.deepCopy(m[0])),m[t].id=v[t],m[t].nextlayer=v[t],a.formatDefaultLayer(m[t],q,f,!!n);for(t=0;t<m.length;t++){n=m[t];D=v=q=c=null;var K=p[n.id],L="shift"==n.id?1:0,N="default"==n.id||L?1:0;u=n.row;for(g=0;g<u.length;g++)for(y=u[g].key,
r=0;r<y.length;r++){w=y[r];var E=a.dfltCodes.indexOf(w.id);if(K||N)K&&0<=E&&E<K.length&&(w.text=K[E]),N&&"K_SPACE"!=w.id&&E+65*L<a.dfltText.length&&null!==w.text&&(w.text=w.text||a.dfltText[E+65*L]);null!==w.text&&(w.text=w.text||"");switch(w.id){case "K_SHIFT":c=w;break;case "K_CAPS":q=w;break;case "K_NUMLOCK":v=w;break;case "K_SCROLL":D=w}if(null!=w.sk){for(E=0;E<w.sk.length;E++)-1==e.indexOf(w.sk[E].nextlayer)&&w.sk.splice(E--,1);0==w.sk.length&&(w.sk=null)}}n.shiftKey=c;n.capsKey=q;n.numKey=v;
n.scrollKey=D;"desktop"!=f&&0<t&&null!=c&&(c.sp=a.buttonClasses["SHIFT-ON"],c.sk=null,c.text=a.modifierSpecials[m[t].id]?a.modifierSpecials[m[t].id]:"*Shift*")}return k};a.getLayerId=function(a){var b=h.modifierCodes,e="";if(0==a)return"default";a&b.LCTRL&&(e=(0<e.length?e+"-":"")+"leftctrl");a&b.RCTRL&&(e=(0<e.length?e+"-":"")+"rightctrl");a&b.LALT&&(e=(0<e.length?e+"-":"")+"leftalt");a&b.RALT&&(e=(0<e.length?e+"-":"")+"rightalt");a&b.SHIFT&&(e=(0<e.length?e+"-":"")+"shift");a&b.CTRL&&(e=(0<e.length?
e+"-":"")+"ctrl");a&b.ALT&&(e=(0<e.length?e+"-":"")+"alt");return e};a.emulatesAltGr=function(b){var c=window.keyman,e=h.modifierCodes;if(!c.keyboardManager.isChiral())return!1;if(!b){b=c.keyboardManager.activeKeyboard;if(null==b||null==b.KV)return!1;b=b.KV.KLS}var d=e.LCTRL|e.LALT,g=b[a.getLayerId(d)];d=b[a.getLayerId(e.SHIFT|d)];return null!=g&&g!=b[a.getLayerId(e.RALT)]||null!=d&&d!=b[a.getLayerId(e.RALT|e.SHIFT)]?!1:(c.keyboardManager.getKeyboardModifierBitmask(),!0)};a.generateLayerIds=function(b){if(b){b=
32;var c=1}else b=8,c=16;for(var e=[],d=0;d<b;d++)e.push(a.getLayerId(d*c));return e};a.formatDefaultLayer=function(b,c,d,g){for(var e=b.id,f=a.buttonClasses,h=0;h<b.row.length;h++)for(var k=b.row[h].key,l=0;l<k.length;l++){var r=k[l];switch(r.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=e.indexOf("shift")&&(r.sp=f["SHIFT-ON"]);"desktop"!=d&&"default"!=e&&(r.nextlayer="default");break;case "K_LCTRL":case "K_LCONTROL":if(c){-1!=e.indexOf("leftctrl")&&(r.sp=f["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(c){-1!=
e.indexOf("rightctrl")&&(r.sp=f["SHIFT-ON"]);break}case "K_CONTROL":-1==e.indexOf("ctrl")||c&&(-1==e.indexOf("leftctrl")||-1==e.indexOf("rightctrl"))||(r.sp=f["SHIFT-ON"]);break;case "K_LALT":if(c){-1!=e.indexOf("leftalt")&&(r.sp=f["SHIFT-ON"]);break}case "K_RALT":if(c){-1!=e.indexOf("rightalt")&&(r.sp=f["SHIFT-ON"]);break}case "K_ALT":-1==e.indexOf("alt")||c&&(-1==e.indexOf("leftalt")||-1==e.indexOf("rightalt"))||(r.sp=f["SHIFT-ON"]);break;case "K_oE2":"undefined"!=typeof g&&g||("desktop"==d?(k.splice(l--,
1),k[0].width="200"):k[l].sp=f.HIDDEN)}}};a.processLegacyDefinitions=function(b){for(var c=a.generateLayerIds(!1),e={},d=0;d<c.length;d++){for(var g=c[d],h=[],k=!1,p=0;65>p;p++){var n=p+65*d;h.push(b[n]);n<b.length&&""!=b[n]&&p!=a.dfltCodes.indexOf("K_SPACE")&&(k=!0)}k&&(e[g]=h)}"undefined"!=typeof e["default"]&&e["default"]||(e["default"]=[""]);"undefined"!=typeof e.shift&&e.shift||(e.shift=[""]);return e};a.dfltCodes="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
a.dfltText="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ ";a.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};a.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",alt:"*Alt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*",ctrl:"*Ctrl*","ctrl-alt":"*AltGr*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*","leftctrl-leftalt-shift":"*LAltCtrlShift*",
"rightctrl-rightalt-shift":"*RAltCtrlShift*",shift:"*Shift*","shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};a._BaseLayout="us";a._BaseLayoutEuro={se:"\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ",uk:"`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ "};a.dfltLayout={desktop:{font:"Tahoma,Helvetica",
layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",
sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",
width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},
{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"200"}]}]}]},phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},
{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"200",sp:"1"}]}]}]}};return a}();d.Layouts=g})(d.osk||(d.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){(function(d){var h=function(){function d(a){this.keyman=a;this.scrolling=!1;this.shim=this.constructShim()}d.prototype.constructShim=function(){var a=this,b=this.keyman.util._CreateElement("div"),c=this.keyman.osk;b.id="kmw-language-menu-background";b.addEventListener("touchstart",function(b){b.preventDefault();a.hide();if(2<b.touches.length){var e=b.touches[1].pageX;b=b.touches[1].pageY;var d=c.vkbd.spaceBar;e>d.offsetLeft&&e<d.offsetLeft+d.offsetWidth&&b>d.offsetTop&&b<
d.offsetTop+d.offsetHeight&&c.showBuild()}},!1);return b};d.prototype.show=function(){var a=this.keyman.keyboardManager.keyboardStubs,b=this.keyman.util;if(!(1>a.length)){var c=this.lgList=b._CreateElement("div");this.lgList.id="kmw-language-menu";var d=this;document.body.appendChild(this.shim);var g=b._CreateElement("div"),h=g.style,k=b._CreateElement("div");g.id="kmw-menu-scroll-container";k.id="kmw-menu-scroller";"WebkitOverflowScrolling"in h&&(h.WebkitOverflowScrolling="touch");g.appendChild(k);
c.appendChild(g);var m;h=b._CreateElement("div");h.id="kmw-menu-index";for(m=1;26>=m;m++){var p=b._CreateElement("p");p.innerHTML=String.fromCharCode(m+64);h.appendChild(p)}h.addEventListener("touchstart",function(a){d.scrollToLanguage(a,g,k)},!1);h.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},!1);c.appendChild(h);c.addEventListener("scroll",function(a){d.scrolling=!0},!1);g.addEventListener("scroll",function(a){1>g.scrollTop&&(g.scrollTop=1);g.scrollTop>g.scrollHeight-
g.offsetHeight-1&&(g.scrollTop=g.scrollHeight-g.offsetHeight-1)},!1);this.activeLgNo=this.addLanguages(k,a);this.lgList.style.visibility="hidden";document.body.appendChild(this.lgList);"Android"==b.device.OS&&"devicePixelRatio"in window&&(this.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==b.device.OS&&"tablet"==b.device.formFactor&&"devicePixelRatio"in window&&(m=parseInt(b.getStyleValue(c,"width"),10),a=c.style,isNaN(m)||(a.width=a.maxWidth=2*m/window.devicePixelRatio+"px"),m=
parseInt(b.getStyleValue(g,"width"),10),a=g.style,isNaN(m)||(a.width=a.maxWidth=2*m/window.devicePixelRatio+"px"),m=parseInt(b.getStyleValue(k,"width"),10),a=k.style,isNaN(m)||(a.width=a.maxWidth=2*m/window.devicePixelRatio+"px"));this.adjust(0);b=Math.floor(c.offsetHeight/26);a=Math.round(100*b/(h.childNodes[1].offsetTop-h.childNodes[0].offsetTop))/100;p=.6<a?1:2;1.25<a&&(a=1.25);for(m=0;26>m;m++){var n=h.childNodes[m].style;2==p&&1==m%2?n.display="none":(n.fontSize=a*p+"em",n.lineHeight=b*p+"px")}m=
g.offsetWidth;g.scrollHeight>g.offsetHeight+3?m+=h.offsetWidth:h.style.display="none";c.style.width=m+"px";this.lgList.style.visibility="";c=k.firstChild.offsetHeight*this.activeLgNo+1;g.scrollTop=c;g.scrollTop<c&&(g.scrollTop=g.scrollHeight-g.offsetHeight);g.scrollTop>g.scrollHeight-g.offsetHeight-1&&(g.scrollTop=g.scrollHeight-g.offsetHeight-1)}};d.prototype.adjust=function(a){var b=this.keyman.osk,c=this.keyman.util,d=c.device,g=this.lgList,h=g.firstChild,k=h.firstChild,m=g.style;g=g.childNodes[1];
var p=window.innerHeight-b.vkbd.lgKey.offsetHeight-16;a=(k.childNodes.length+a-1)*k.firstChild.firstChild.offsetHeight;"iOS"==d.OS&&("phone"==d.formFactor?(d=c.landscapeView()?36:0,p=(window.innerHeight-d-16)*c.getViewportScale()):"tablet"==d.formFactor&&(d=c.landscapeView()?16:0,p-=d));m.left=c._GetAbsoluteX(b.vkbd.lgKey)+"px";a>p&&(a=p);m.height=a+"px";m.top=c._GetAbsoluteY(b._Box)+b._Box.offsetHeight-a+window.pageYOffset-6+"px";m.bottom="auto";g.style.height=h.style.height=m.height};d.prototype.scrollToLanguage=
function(a,b,c){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();var e=a.touches[0].target;if("P"==e.nodeName){var d;a=0;e=e.innerHTML.charCodeAt(0);var g=c.childNodes;try{for(d=0;d<g.length-1;d++){var h=g[d].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(h>=e)break}}catch(m){}try{a=c.firstChild.offsetHeight*d+1,b.scrollTop=a}catch(m){a=0}try{b.scrollTop<a&&(b.scrollTop=b.scrollHeight-b.offsetHeight),b.scrollTop>b.scrollHeight-b.offsetHeight-1&&(b.scrollTop=b.scrollHeight-
b.offsetHeight-1)}catch(m){}}};d.prototype.addLanguages=function(a,b){var c=b.length,e=this.keyman.util,d=e.device,g,h,k=[];for(h=0;h<c;h++){var p=b[h].KL;-1==k.indexOf(p)&&k.push(p)}k.sort();var n=Math.round(100/e.getViewportScale())/100,r,q,u,v,y=-1;p=function(){r=e._CreateElement("div");r.className="kbd-list-closed";q=e._CreateElement("p");q.kList=[];for(h=0;h<c;h++)b[h].KL==k[g]&&q.kList.push(b[h]);"iOS"==d.OS&&(q.style.fontSize=n+"em");r.appendChild(q);a.appendChild(r);k[g]==D.keyman.keyboardManager.activeStub.KL&&
(y=g);var f=D;if(1<q.kList.length)for(q.className="kbd-list",q.innerHTML=k[g]+"...",q.scrolled=!1,q.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";f.adjust("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},q.addEventListener("touchstart",function(a){a.stopPropagation()},!1),q.addEventListener("touchmove",function(a){a.target.scrolled=
!0;a.stopPropagation()},!1),u=0;u<q.kList.length;u++)v=e._CreateElement("p"),v.className="kbd-list-entry","iOS"==d.OS&&(v.style.fontSize=n+"em"),D.addKeyboard(q.kList[u],v,!1),r.appendChild(v);else q.innerHTML=k[g],q.className="kbd-single-entry",D.addKeyboard(q.kList[0],q,!0);g==y&&(q.className+=" current")};var D=this;for(g=0;g<k.length;g++)p();p=e._CreateElement("div");p.id="kmw-menu-footer";var w=function(a){a.preventDefault();a.stopPropagation()};p.addEventListener("touchstart",w,!1);p.addEventListener("touchmove",
w,!1);p.addEventListener("touchend",w,!1);a.appendChild(p);return y};d.prototype.addKeyboard=function(a,e,c){e.kn=a.KI;e.kc=a.KLC;e.innerHTML=c?a.KL:a.KN.replace(" Keyboard","");var d=this;a=function(a){a.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");d.scrolling=!1;d.y0=a.touches[0].pageY;return!0};c=function(a){a.stopImmediatePropagation();var b=d.lgList.childNodes[0],c=b.scrollHeight-b.offsetHeight;if("undefined"!=typeof a.pageY)var e=a.pageY;else if("undefined"!=
typeof a.touches)e=a.touches[0].pageY;else return;var f=e-d.y0;if(0>f)b.scrollTop>=c-1&&(a.preventDefault(),d.y0=e);else if(0<f)2>b.scrollTop&&(a.preventDefault(),d.y0=e);else return;if(-5>f||5<f)d.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),d.y0=e;return!0};var g=function(a){a.preventDefault();"undefined"!=typeof a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation();d.scrolling?this.className=this.className.replace(/\s*selected/,""):(b.keyman.DOMEventHandlers.states.setFocusTimer(),
d.lgList.style.display="none",d.keyman.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),d.keyman.keyboardManager.doKeyboardChange(this.kn,this.kc),d.keyman.domManager.focusLastActiveElement(),d.hide(),d.keyman.osk._Show());return!0};e.onmspointerdown=a;e.addEventListener("touchstart",a,!1);e.onmspointermove=c;e.addEventListener("touchmove",c,!1);e.onmspointerout=g;e.addEventListener("touchend",g,!1)};d.prototype.hide=function(){var a=this.keyman.osk,b=this;this.lgList&&(a.vkbd.highlightKey(a.vkbd.lgKey,
!1),this.lgList.style.visibility="hidden",window.setTimeout(function(){b.shim.parentElement&&(document.body.removeChild(b.shim),document.body.removeChild(b.lgList))},500))};return d}();d.LanguageMenu=h})(d.osk||(d.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){(function(d){function h(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);return a}function g(a){return a&&"key"in a&&a.key instanceof l}function a(a){return g(a)?a:null}var e=b.keyman.text.Codes,c=function(){return function(a,b){this.key=a;this.keyId=b}}();d.isKey=g;d.getKeyFrom=a;var f=function(){return function(a,b,c,e,d,f){this.id=a;this.text=b;this.width=c?c:"50";this.sp=e;this.nextlayer=d;this.pad=f}}();d.OSKKeySpec=f;var l=function(){function a(a){this.spec=a}a.getTextWidth=
function(b,c,e){e.fontFamily||(e.fontFamily=getComputedStyle(document.body).fontFamily);e.fontSize&&""!=e.fontSize||(e.fontSize="1em");var d=e.fontFamily;b=b.getKeyEmFontSize();e=window.keyman.util.getFontSizeStyle(e.fontSize);e=e.absolute?e.val+"px":e.val*b+"px";b=(a.getTextWidth.canvas||(a.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");b.font=e+" "+d;return b.measureText(c).width};a.prototype.getKeyWidth=function(){var a=this.objectUnits();if("px"==a)return this.spec.widthpc;
if("%"==a)return a=b.keyman.singleton.osk.getWidthFromCookie(),Math.floor(a*this.spec.widthpc/100)};a.prototype.objectUnits=function(){return"desktop"==window.keyman.util.device.formFactor?"%":"px"};a.prototype.renameSpecialKey=function(a){return m.specialCharacters[a]?String.fromCharCode(57344+m.specialCharacters[a]):a};a.prototype.generateKeyText=function(b){var c=window.keyman.util,e=this.spec,d=c._CreateElement("span"),f=d.style;if(null==e.text||""==e.text){var g="\u00a0";"string"==typeof e.id&&
/^U_[0-9A-F]{4}$/i.test(e.id)&&(g=String.fromCharCode(parseInt(e.id.substr(2),16)))}else g=e.text;d.className="kmw-key-text";if("1"==e.sp||"2"==e.sp)g=this.renameSpecialKey("*Tab*"==e.text&&"shift"==e.layer?"*TabLeft*":e.text);f.fontSize=b.fontSize;"string"==typeof e.font&&""!=e.font&&(f.fontFamily=e.font);"string"==typeof e.fontsize&&0!=e.fontsize&&(f.fontSize=e.fontsize);var h=window.keyman.keyboardManager,k={fontSize:f.fontSize};k.fontFamily=f.fontFamily?f.fontFamily:b.fontFamily;e=a.getTextWidth(b,
g,k);0==e&&""!=g&&"\u00a0"!=g&&(g="\u25cc"+g,h.isRTL()&&(g="\u200f"+g),e=a.getTextWidth(b,g,k));b=c.getFontSizeStyle(f.fontSize);c=.9*this.getKeyWidth()/e;1>c&&(f.fontSize=b.absolute?c*b.val+"px":c*b.val+"em");d.innerHTML=g;return d};return a}();d.OSKKey=l;var B=function(a){function b(b){return a.call(this,b)||this}__extends(b,a);b.prototype.getId=function(a){return this.spec.layer+"-"+this.spec.id};b.prototype.generateKeyCapLabel=function(){var a=e.keyCodes[this.spec.id];switch(a){case 186:a=59;
break;case 187:a=61;break;case 188:a=44;break;case 189:a=45;break;case 190:a=46;break;case 191:a=47;break;case 192:a=96;break;case 219:a=91;break;case 220:a=92;break;case 221:a=93;break;case 222:a=39;break;default:if(48>a||90<a)a=0}if(0<a){var b=window.keyman.util._CreateElement("div");b.className="kmw-key-label";b.innerHTML=String.fromCharCode(a);return b}return null};b.prototype.processSubkeys=function(a){var b,c=a.subKeys=this.spec.sk;for(b=0;b<c.length;b++)if("1"==c[b].sp||"2"==c[b].sp)c[b].text=
this.renameSpecialKey(c[b].text);b=window.keyman.util._CreateElement("div");b.className="kmw-key-popup-icon";a.appendChild(b)};b.prototype.construct=function(a,b,e,d,f){var g=window.keyman.util,k=this.spec,l="desktop"==g.device.formFactor;k.layer=e;e=g._CreateElement("div");e.className="kmw-key-square";var n=e.style;n.width=this.objectGeometry(k.widthpc);var r=f,q=g._CreateElement("div");q=h(q,new c(this,k.id));a.setButtonClass(k,q,b);l?n.marginLeft=this.objectGeometry(k.padpc):(n.left=this.objectGeometry(f+
k.padpc),n.bottom=d.bottom,n.height=d.height,q.style.left=n.left,q.style.width=n.width);f=f+k.padpc+k.widthpc;(b.keyLabels||l)&&(b=this.generateKeyCapLabel())&&q.appendChild(b);q.id=this.getId(a);g.device.touchable||(q.onmouseover=q.onmousedown=a.mouseOverMouseDownHandler,q.onmouseup=q.onmouseout=a.mouseUpMouseOutHandler);q.appendChild(this.generateKeyText(a));"undefined"!=typeof k.sk&&null!=k.sk?this.processSubkeys(q):q.subKeys=null;e.appendChild(q);return{element:e,percent:f-r}};b.prototype.objectGeometry=
function(a){var b=this.objectUnits();return"%"==b?a+b:Math.round(a)+b};return b}(l);d.OSKBaseKey=B;var t=function(a){function b(b){return a.call(this,b)||this}__extends(b,a);b.prototype.getId=function(a){var b=this.spec;return"string"==typeof b.layer&&""!=b.layer?"popup-"+b.layer+"-"+b.id:"popup-"+a.layerId+"-"+b.id};b.prototype.construct=function(a,b,e){var d=this.spec,f=document.createElement("div"),g=a.getDefaultKeyObject(),k=f.style,l;for(l in g)"string"!=typeof d[l]&&(d[l]=g[l]);f.className=
"kmw-key-square-ex";e&&(k.marginTop="5px");k.width="undefined"!=typeof d.width?parseInt(d.width,10)*b.offsetWidth/100+"px":b.offsetWidth+"px";k.height=b.offsetHeight+"px";b=document.createElement("div");b=h(b,new c(this,d.id));a.setButtonClass(d,b);b.id=this.getId(a);d=b.style;d.height=k.height;d.width=k.width;d.position="absolute";b.appendChild(this.generateKeyText(a));f.appendChild(b);return f};return b}(l);d.OSKSubKey=t;var m=function(){function c(c,e,f,g){this.layerId="default";this.popupPending=
this.ddOSK=!1;this.popupDelay=500;this.highlightSubKeys=this.highlightSubKeys||function(a,b,c){};this.drawPreview=this.drawPreview||function(a,b,c,e){};this.addCallout=this.addCallout||function(a){return null};this.waitForFonts=this.waitForFonts||function(a,b){return!0};this.touch=function(a){var c=b.keyman.singleton.textProcessor,e=a.changedTouches[0].target,d=this.keyTarget(e);this.touchX=a.changedTouches[0].pageX;this.currentTarget=d;var f=document.getElementById("kmw-popup-keys");if(!(f&&"visible"==
f.style.visibility||this.popupVisible)){this.touchCount=a.touches.length;if(d&&0<=d.className.indexOf("key-hidden")||0<=e.className.indexOf("kmw-key-row"))d=this.findNearestKey(a,e);null!=d&&(a=d.keyId,this.highlightKey(d,!0),"K_LOPT"==a||"K_ROPT"==a?(window.setTimeout(function(){c.clickKey(d)}.bind(this),0),this.keyPending=null):"K_BKSP"==a?(c.clickKey(d),this.deleteKey=d,this.deleting=window.setTimeout(this.repeatDelete,500),this.keyPending=null):(this.keyPending?(this.highlightKey(this.keyPending,
!1),c.clickKey(this.keyPending),this.clearPopup(),this.touchCount--):this.touchHold(d),this.keyPending=d))}}.bind(this);this.release=function(a){var c=b.keyman.singleton.textProcessor,e=document.getElementById("kmw-popup-keys"),d=this.currentTarget;if(e&&"visible"==e.style.visibility||this.popupVisible){if(0<a.touches.length)return;if(null==d||0>d.id.indexOf("popup")&&d.id!=this.popupBaseKey.id)this.highlightKey(this.keyPending,!1),this.clearPopup(),this.keyPending=null}d&&d.id&&this.optionKey(d,
d.id,!1);d=a.changedTouches[0].pageX;d=2>d&&5<this.touchX||d>window.innerWidth-2&&this.touchX<window.innerWidth-5;e=this.touchCount;0<this.touchCount&&this.touchCount--;this.keyPending?(this.highlightKey(this.keyPending,!1),0>this.keyPending.className.indexOf("hidden")&&0<e&&!d&&c.clickKey(this.keyPending),this.clearPopup(),this.keyPending=null):(c=a.changedTouches[0],d=this.keyTarget(c.target),d||(c=document.elementFromPoint(c.clientX,c.clientY),d=this.findNearestKey(a,c)),this.highlightKey(d,!1));
this.deleting&&window.clearTimeout(this.deleting);this.deleting=0}.bind(this);this.moveOver=function(a){var c=b.keyman.singleton.util;a.preventDefault();a.cancelBubble=!0;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation();if(!(1<a.touches.length||0==this.touchCount)){var e="object"==typeof a.touches?a.touches[0].clientX:a.clientX,d="object"==typeof a.touches?a.touches[0].clientY:a.clientY,f=document.elementFromPoint(e,
d),g=this.keyPending,h=this.keyTarget(f);if(h&&0<=h.className.indexOf("key-hidden")||f&&!h&&0<=f.className.indexOf("key-row"))h=this.findNearestKey(a,f);h&&"string"==typeof h.id&&0>h.id.indexOf("BKSP")&&(this.deleting&&window.clearTimeout(this.deleting),this.deleting=0);if(this.popupVisible)null==h?(g&&this.highlightKey(g,!1),this.keyPending=null):h==this.popupBaseKey?(c.hasClass(h,"kmw-key-touched")||this.highlightKey(h,!0),this.keyPending=h):(g&&this.highlightKey(g,!1),this.keyPending=null);else{(f=
document.getElementById("kmw-popup-keys"))&&"visible"==f.style.visibility&&"phone"==c.device.formFactor&&h==this.popupBaseKey&&(h=f.childNodes[0].firstChild);this.currentTarget=h;g&&h&&h.id!=g.id&&this.highlightKey(g,!1);this.highlightSubKeys(h,e,d);if(f&&"visible"==f.style.visibility){if(h&&0>h.id.indexOf("popup")&&h!=this.popupBaseKey)return;h&&h==this.popupBaseKey&&0>h.className.indexOf("kmw-key-touched")&&this.highlightKey(h,!0)}else c=b.keyman.singleton.osk._Box,g&&a.touches[0].pageY<Math.max(5,
c.offsetTop-.25*c.offsetHeight)&&(this.highlightKey(g,!1),this.showKeyTip(null,!1),this.keyPending=null);h&&this.keyPending&&(this.keyPending=h);this.keyPending&&(g!=h||0>h.className.indexOf("kmw-key-touched"))&&this.highlightKey(h,!0);g&&h&&h!=g&&""!=h.id&&this.touchHold(h)}}}.bind(this);this.repeatDelete=function(){var a=b.keyman.singleton.textProcessor;this.deleting&&(a.clickKey(this.deleteKey),this.deleting=window.setTimeout(this.repeatDelete,100))}.bind(this);this.mouseOverMouseDownHandler=function(c){var e=
b.keyman.singleton.util,d=e.eventTarget(c);if(null!==d&&"desktop"==e.device.formFactor){"SPAN"==d.nodeName&&(d=d.parentNode);var f=a(d);"mousedown"==e.eventType(c)?(this.currentKey=f.id,e._CancelMouse(c),this.highlightKey(f,!0)):d.id==this.currentKey&&this.highlightKey(f,!0)}}.bind(this);this.mouseUpMouseOutHandler=function(c){var e=b.keyman.singleton,d=e.util,f=d.eventTarget(c);null!==f&&"desktop"==d.device.formFactor&&("SPAN"==f.nodeName&&(f=f.parentNode),f=a(f),this.highlightKey(f,!1),"mouseup"==
d.eventType(c)&&(f.id==this.currentKey&&e.textProcessor.clickKey(a(f)),this.currentKey=""))}.bind(this);var h=b.keyman.singleton;e=h.util;var k=f;f=e._CreateElement("div");h=h.keyboardManager.activeKeyboard;if("object"!=typeof k||null==k)k=d.Layouts.buildDefaultLayout(c,g,e.device.formFactor);this.layout=k;this.layers=k.layer;this.fontFamily="font"in k?k.font:"";k.keyLabels=h&&"undefined"!=typeof h.KDU&&h.KDU;c=this.deviceDependentLayout(k,e.device.formFactor);this.ddOSK=!0;f.appendChild(c);this.kbdHelpDiv=
this.kbdDiv=f;f.className=e.device.formFactor+" kmw-osk-inner-frame"}c.prototype.getDefaultKeyObject=function(){return new f(void 0,"","100","0",null,"15")};c.prototype.deviceDependentLayout=function(a,c){var e=b.keyman.singleton.util,d=b.keyman.singleton.osk,f=e._CreateElement("div"),g=f.style;f.className="kmw-key-layer-group";switch(c){case "phone":case "tablet":var h=d.getHeight();g.height=h+"px"}if(null==a)return f;h=a.fontsize;g.fontSize="undefined"==typeof h||null==h||""==h?"1em":a.fontsize;
this.fontSize=g.fontSize;var k;var l=a.layer;var n=this.getDefaultKeyObject();n.fontsize=g.fontSize;var r=/\*\w+\*/;for(h=0;h<l.length;h++){var p=l[h];var m=p.row;for(k=m.length;0<k&&!(0<m[k-1].key.length);k--);k<m.length&&m.splice(k-m.length,m.length-k)}var t=100/m.length;"desktop"==c&&(t=100/m.length);var I="desktop"==c?100:d.getWidth();e.device.touchable&&(f.addEventListener("touchstart",this.touch,!0),f.addEventListener("touchend",this.release,!0),f.addEventListener("touchmove",this.moveOver,
!1));for(h=0;h<l.length;h++){p=l[h];p.aligned=!1;d=e._CreateElement("div");m=d.style;d.className="kmw-key-layer";m.display=0==h?"block":"none";m.height=g.height;m.fontFamily="font"in a?a.font:"";d.layer=d.nextLayer=p.id;"string"==typeof p.nextlayer&&(d.nextLayer=p.nextlayer);m=p.row;var F=0;for(k=0;k<m.length;k++){var G=0;var z=m[k];var A=z.key;for(z=0;z<A.length;z++){var x=A[z];if(null==x)--A.length;else{var H="string"==typeof x.width&&""!=x.width?parseInt(x.width,10):100;if(isNaN(H)||0==H)H=100;
x.width=H.toString();var C="string"==typeof x.pad&&""!=x.pad?parseInt(x.pad,10):15;if(isNaN(C)||0==C)C=15;x.pad=C.toString();G+=H+C}}G>F&&(F=G)}F="desktop"==c?F+5:F+15;for(k=0;k<m.length;k++){G=e._CreateElement("div");G.className="kmw-key-row";G.onmousedown=e.mouseDownPreventDefaultHandler;z=m[k];H=G.style;H.maxHeight=H.height=t+"%";A=z.key;for(z=0;z<A.length;z++){x=A[z];for(var M in n)"string"!=typeof x[M]&&(x[M]=n[M]);switch(x.sp){case "1":r.test(x.text)||""==x.text||(x.sp="3");break;case "2":r.test(x.text)||
""==x.text||(x.sp="4")}}for(z=C=0;z<A.length-1;z++){x=Math.round(parseInt(A[z].width,10)*I/F);A[z].widthpc=x;var J=Math.round(parseInt(A[z].pad,10)*I/F);A[z].padpc=J;C+=J+x}C+=Math.round(15*I/F);1==A.length&&0>parseInt(A[0].pad,10)?(x=Math.round(parseInt(A[0].width,10)*I/F),A[0].widthpc=x,C+=x,A[0].padpc=I-C):0<A.length&&(z=A.length-1,J=Math.round(parseInt(A[z].pad,10)*I/F),A[z].padpc=J,C+=J,A[z].widthpc=I-C);for(z=C=0;z<A.length;z++)x=A[z],x=(new B(x)).construct(this,a,p.id,H,C),G.appendChild(x.element),
C+=x.percent;d.appendChild(G)}f.appendChild(d)}return f};c.prototype.keyTarget=function(c){var e=b.keyman.singleton.util;try{if(c){if(e.hasClass(c,"kmw-key"))return a(c);if(c.parentNode&&e.hasClass(c.parentNode,"kmw-key"))return a(c.parentNode);if(c.firstChild&&e.hasClass(c.firstChild,"kmw-key"))return a(c.firstChild)}}catch(q){}return null};c.prototype.findNearestKey=function(a,b){if(!a||"undefined"==typeof a.changedTouches||0==a.changedTouches.length)return null;for(a=a.changedTouches[0].pageX;b&&
0>b.className.indexOf("key-row");)b=b.parentNode;if(!b)return null;var c,e=0,d=24,f=1E5;for(c=0;c<b.childNodes.length;c++)if(!(0<=b.childNodes[c].firstChild.className.indexOf("key-hidden"))){var g=b.childNodes[c].offsetLeft;var h=g+b.childNodes[c].offsetWidth;g-=a;0<=g&&g<f&&(e=c,f=g);g=a-h;0<=g&&g<f&&(e=c,f=g)}return 1E5>f&&(b=b.childNodes[e],g=b.offsetLeft,h=g+b.offsetWidth,40<b.offsetWidth&&(d=.6*b.offsetWidth),0<=g-a&&g-a<d||0<=a-h&&a-h<d)?b.firstChild:null};c.prototype._UpdateVKShiftStyle=function(a){var c,
e=b.keyman.singleton.textProcessor;if(a)for(c=0;c<this.layers.length&&this.layers[c].id!=this.layerId;c++);else{c=this.layerIndex;a=this.layers[c].id;var f=this.layers[c];c=["K_CAPS","K_NUMLOCK","K_SCROLL"];var g=[f.capsKey,f.numKey,f.scrollKey];for(f=0;f<g.length;f++)if(null!=g[f]){g[f].sp=e.stateKeys[c[f]]?d.Layouts.buttonClasses["SHIFT-ON"]:d.Layouts.buttonClasses.SHIFT;var h=document.getElementById(a+"-"+c[f]);this.setButtonClass(g[f],h,this.layout)}}};c.prototype.setButtonClass=function(a,c,
e){var d=b.keyman.singleton,f=0,g="default shift shift-on special special-on    deadkey blank hidden".split(" ");"string"==typeof a.dk&&"1"==a.dk&&(f=8);"string"==typeof a.sp&&(f=parseInt(a.sp,10));if(0>f||10<f)f=0;e=e||this.layout;c.className=4<e.layer[0].row.length&&"phone"==d.util.device.formFactor?"kmw-key kmw-5rows kmw-key-"+g[f]:"kmw-key kmw-key-"+g[f]};c.prototype.clearPopup=function(){var a=b.keyman.singleton.osk,c=document.getElementById("kmw-popup-keys");null!=c&&(c.shim&&a._Box.removeChild(c.shim),
c.parentNode.removeChild(c));this.popupCallout&&a._Box.removeChild(this.popupCallout);this.popupCallout=null;this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);this.popupBaseKey=null};c.prototype.showSubKeys=function(a){if(null!=this.keyPending){var c=b.keyman.singleton,e=c.util,d=e.device,f=a.subKeys,g=document.createElement("DIV");this.getDefaultKeyObject();g.id="kmw-popup-keys";this.popupBaseKey=a;"phone"==d.formFactor&&this.prependBaseKey(a);var h=g.style;
h.bottom=parseInt(a.style.bottom,10)+parseInt(a.style.height,10)+4+"px";h.fontFamily=this.fontFamily;h.fontSize=c.util.getStyleValue(a,"font-size");h.visibility="hidden";var k=f.length;var l=Math.min(Math.ceil(k/9),2);var n=Math.ceil(k/l);1<l&&(h.width=n*a.offsetWidth+5*n+"px");for(h=0;h<k;h++){var m=!1,p=Math.floor(h/n);1<l&&0<p&&(m=!0);m=(new b.keyman.osk.OSKSubKey(f[h])).construct(this,a,m);g.appendChild(m)}this.showKeyTip(null,!1);c.osk._Box.appendChild(g);h=g.style;f=e._GetAbsoluteX(a)+.5*(a.offsetWidth-
g.offsetWidth);e=(e.landscapeView()?screen.height:screen.width)-g.offsetWidth;f>e&&(f=e);0>f&&(f=0);h.left=f+"px";this.popupCallout=this.addCallout(a);h.visibility="visible";g.shim=document.createElement("DIV");g.shim.id="kmw-popup-shim";c.osk._Box.appendChild(g.shim);"phone"==d.formFactor&&(this.keyPending=a=g.childNodes[0].firstChild,this.highlightKey(a,!0))}};c.prototype.prependBaseKey=function(a){var c=a.subKeys,e=b.keyman.singleton;if(a&&"undefined"!=typeof a.id){a.id.split("-");var d=a.keyId;
var g=a.key.spec.layer;var h=a.key.spec.sp,k=a.key.spec.nextlayer;if("undefined"!=typeof c&&0<c.length&&(c[0].id!=d||c[0].layer!=g)){d=new f(d,"",void 0,h,k);""!=g&&(d.layer=g);for(g=0;g<a.childNodes.length&&!e.util.hasClass(a.childNodes[g],"kmw-key-text");g++);g<a.childNodes.length&&(d.text=a.childNodes[g].textContent);c.splice(0,0,d)}}};c.prototype.showLanguage=function(){var a=b.keyman.singleton,c="",e=a.keyboardManager.activeStub;e?(a=e.KL,c=e.KN):a=a.getActiveLanguage(!0)?a.getActiveLanguage(!0):
"English";try{var d=this.spaceBar.firstChild.firstChild,f=d.parentNode;f.className="undefined"==typeof f.className||""==f.className?"kmw-spacebar":f.className+" kmw-spacebar";d.className="kmw-spacebar-caption";c=c.replace(/\s*keyboard\s*/i,"");e="";e=c==a?a:a+" ("+c+")";d.innerHTML!=e&&(d.innerHTML=e)}catch(y){}};c.prototype.highlightKey=function(a,b){if(a&&""!=a.className&&!(0<=a.className.indexOf("kmw-key-row"))){var c=a.className;null!=this.keytip&&0>c.indexOf("kmw-key-shift")&&0>c.indexOf("kmw-spacebar")&&
0>a.id.indexOf("popup")?this.showKeyTip(a,b):b&&0>c.indexOf(" kmw-key-touched")?(a.className=c+" kmw-key-touched",this.showKeyTip(null,!1)):a.className=c.replace(" kmw-key-touched","")}};c.prototype.getKeyEmFontSize=function(){var a=b.keyman.singleton,c=a.util;if("desktop"==c.device.formFactor)return.8*this.getFontSizeFromCookie();var e=getComputedStyle(document.body).fontSize;e=c.getFontSizeStyle(e).val;a=c.getFontSizeStyle(a.osk._Box).val;return e*a};c.prototype.getFontSizeFromCookie=function(){var a=
b.keyman.singleton.util,c=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof c||null==c)return 16;a=a.toNumber(c.height,.15*screen.height);a>.5*screen.height&&(a=.5*screen.height);return a/8};c.prototype.getSpecialKey=function(b,c){var e=this.kbdDiv.childNodes[0].childNodes;if(0<=b&&b<e.length)for(b=e[b].childNodes,b=b[b.length-1].childNodes,e=0;e<b.length;e++){var d=a(b[e].firstChild);if(d&&d.keyId==c)return d}return null};c.prototype.show=function(){var a=b.keyman.singleton.util.device,
c,e=-1,d=this.kbdDiv.childNodes[0].childNodes;for(c=0;c<d.length;c++){var f=d[c];f.layer==this.layerId?(f.style.display="block",this.nextLayer=this.layerId,this.layerIndex=e=c,"string"==typeof this.layers[c].nextlayer&&(this.nextLayer=this.layers[c].nextlayer),this._UpdateVKShiftStyle()):f.style.display="none"}a.touchable&&(this.lgKey=this.getSpecialKey(e,"K_LOPT"),this.hkKey=this.getSpecialKey(e,"K_ROPT"),"iOS"==a.OS&&"phone"==a.formFactor&&this.adjustHeights());this.spaceBar=this.getSpecialKey(e,
"K_SPACE")};c.prototype.showLayer=function(a){var c=b.keyman.singleton;if(a==this.layerId&&"desktop"!=c.util.device.formFactor)return!0;if(c.keyboardManager.activeKeyboard)for(var e=0;e<this.layers.length;e++)if(this.layers[e].id==a)return this.layerId=a,c.osk._Show(),!0;return!1};c.prototype.appendStyleSheet=function(){var a=b.keyman.singleton,c=a.util,e=a.keyboardManager.activeKeyboard,d=a.keyboardManager.activeStub;if(null!=d){this.styleSheet&&c.removeStyleSheet(this.styleSheet);var f=d.KFont;
d=d.KOskFont;c.addFontFaceStyleSheet(f);c.addFontFaceStyleSheet(d);a.hideInputs();var g=this.addFontStyle(f,d);null!=e&&"string"==typeof e.KCSS&&(g+=e.KCSS);this.styleSheet=c.addStyleSheet(g);this.waitForFonts(f,d)&&a.alignInputs()}};c.prototype.addFontStyle=function(a,c){var e=b.keyman.singleton,d=e.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(d=a.family);d=d.replace(/\u0022/g,"");var f=new RegExp("\\s?"+d+",?"),g=e.appliedFont.replace(/\u0022/g,"");g=g.replace(f,"");g=g.replace(/,$/,
"");g='"'+(""==g?d:d+","+g).replace(/,\s?/g,'","')+'"';d=".keymanweb-font{\nfont-family:"+g+" !important;\n}\n";"undefined"!=typeof c?d=d+'.kmw-key-text{\nfont-family:"'+c.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n':"undefined"!=typeof a&&(d=d+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');e.appliedFont=g;return d};c.prototype.buildDocumentationKeyboard=function(a,c,e,f){var g=b.keyman.singleton;c=g.keyboardManager.activeKeyboard;var h=
"undefined"==typeof e?"desktop":e;f="undefined"==typeof f?"default":f;e=g.keyboardManager.keyboards;if(null!=a){var k=a.toLowerCase().replace("keyboard_","");for(a=0;a<e.length;a++)if(k==e[a].KI.toLowerCase().replace("keyboard_","")){c=e[a];break}}if(!c)return null;a=c.KVKL;e=null;k=c.KV;"object"==typeof a&&("object"==typeof a[h]&&null!=a[h]?e=a[h]:"phone"==h&&"object"==typeof a.tablet&&null!=a.tablet?e=a.tablet:"tablet"==h&&"object"==typeof a.phone&&null!=a.phone?e=a.phone:"object"==typeof a.desktop&&
null!=a.desktop&&(e=a.desktop));null==e&&null!=k&&(e=d.Layouts.buildDefaultLayout(k,g.keyboardManager.getKeyboardModifierBitmask(c),h));null!=e&&(e.keyLabels="undefined"!=typeof c.KDU&&c.KDU);g=this.deviceDependentLayout(e,h);g.className=h+"-static kmw-osk-inner-frame";if(null!=e){var l,m;for(a=0;a<e.layer.length;a++){c=g.childNodes[a];for(l=0;l<c.childNodes.length;l++)for(h=c.childNodes[l],m=0;m<h.childNodes.length;m++)k=h.childNodes[m],k.style.height="100%";c.style.display="number"==typeof f?a==
f&&0<=f?"block":"none":"string"==typeof f?e.layer[a].id==f?"block":"none":0==a?"block":"none"}}else g.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+h+" layout is defined for "+c.KN+".</p>";g.style.border="1px solid #ccc";return g};c.prototype.onHide=function(){this.hkKey&&this.highlightKey(this.hkKey,!1)};c.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,
"*Shifted*":8,"*AltGr*":2,"*TabLeft*":7,"*LAlt*":86,"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112};return c}();d.VisualKeyboard=m})(d.osk||(d.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){(function(h){var k=function(){function g(){this.ready=!1;this.loadRetry=0;this._Visible=!1;this._Enabled=!0;this.vpScale=1;this.noDrag=this.userPositioned=!1;this.modifierCodes=d.text.Codes.modifierCodes;this.modifierBitmasks=d.text.Codes.modifierBitmasks;this.stateBitmasks=d.text.Codes.stateBitmasks;this.keyCodes=d.text.Codes.keyCodes;this.restorePosition=function(){this._Visible&&(b.keyman.singleton.domManager.focusLastActiveElement(),this.loadCookie(),this.userPositioned=
!1,this.saveCookie(),this._Show(),this.doResizeMove());this.pinImg&&(this.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)}.bind(this);this._VKbdMouseOver=function(a){b.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(this);this._VKbdMouseOut=function(a){b.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(this);this._VResizeMouseOver=this._VResizeMouseOut=function(a){a=b.keyman.singleton._GetEventObject(a);if(!a)return!1;a&&a.preventDefault&&a.preventDefault();var e=
this.getRect();this.width=e.width;this.height=e.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseDown=function(a){var e=b.keyman.singleton;e.uiManager.justActivated=!0;a=e._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var c=a.pageX;var d=a.pageY}else a.clientX&&(c=a.clientX+document.body.scrollLeft,d=a.clientY+document.body.scrollTop);this._ResizeMouseX=c;this._ResizeMouseY=d;document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&
(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth;this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight;document.onmousemove=this._VResizeMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="se-resize");a&&a.preventDefault&&a.preventDefault();
a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseMove=function(a){a=b.keyman.singleton._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);if(a.pageX){var e=a.pageX;var c=a.pageY}else a.clientX&&(e=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);e=this._VOriginalWidth+e-this._ResizeMouseX;c=this._VOriginalHeight+c-this._ResizeMouseY;e<.2*screen.width&&(e=
.2*screen.width);c<.1*screen.height&&(c=.1*screen.height);e>.9*screen.width&&(e=.9*screen.width);c>.5*screen.height&&(e=.5*screen.height);this.vkbd.kbdDiv.style.width=e+"px";this.vkbd.kbdDiv.style.height=c+"px";this.vkbd.kbdDiv.style.fontSize=c/8+"px";a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseDown=function(a){var e=b.keyman.singleton;e.uiManager.justActivated=!0;a=e._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var c=a.pageX;var d=
a.pageY}else a.clientX&&(c=a.clientX+document.body.scrollLeft,d=a.clientY+document.body.scrollTop);document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VMoveX=c-this._Box.offsetLeft;this._VMoveY=d-this._Box.offsetTop;e.keyboardManager.isCJK()&&(this.pinImg.style.left=
"15px");document.onmousemove=this._VMoveMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseMove=function(a){a=b.keyman.singleton._GetEventObject(a);if(!a||this.noDrag)return!0;this.userPositioned=this.resizing=!0;this.pinImg.style.display="block";if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);
if(a.pageX){var e=a.pageX;var c=a.pageY}else a.clientX&&(e=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);this._Box.style.left=e-this._VMoveX+"px";this._Box.style.top=c-this._VMoveY+"px";a&&a.preventDefault&&a.preventDefault();e=this.getRect();this.width=e.width;this.height=e.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMoveMouseUp=function(a){var e=b.keyman.singleton;a=e._GetEventObject(a);if(!a)return!0;this.resizing=!1;this.vkbd&&(this.vkbd.currentKey=null);
document.onmousemove=this._VPreviousMouseMove;document.onmouseup=this._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=this._VPreviousCursor);e.domManager.focusLastActiveElement();a&&a.preventDefault&&a.preventDefault();e.uiManager.justActivated=!1;e.uiManager.setActivatingUI(!1);this.vkbd&&(this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth,this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight);this.doResizeMove();a.cancelBubble=!0;this.saveCookie();return!1}.bind(this);this.hideNow=
function(){this._Box.removeEventListener("transitionend",this.hideNow,!1);this._Box.removeEventListener("webkitTransitionEnd",this.hideNow,!1);var a=this._Box.style;a.display="none";a.opacity="1";this._Visible=!1;a.transition=a.msTransition=a.MozTransition=a.WebkitTransition="";if(this.vkbd)this.vkbd.onHide()}.bind(this)}g.prototype.prepare=function(){var a=b.keyman.singleton,e=a.util;if(a.initialized){if(!this.ready&&(this._Box=e._CreateElement("div"),document.body.appendChild(this._Box),e.linkStyleSheet(a.getStyleSheetPath("kmwosk.css")),
e.attachDOMEvent(this._Box,"mousedown",function(b){a.uiManager.setActivatingUI(!0);return!1}),e.device.touchable)){var c=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();return!1};e.attachDOMEvent(this._Box,"touchstart",function(b){a.uiManager.setActivatingUI(!0);return c(b)});e.attachDOMEvent(this._Box,"touchend",c);e.attachDOMEvent(this._Box,"touchmove",c);e.attachDOMEvent(this._Box,"touchcancel",c);this.vpScale=e.getViewportScale()}this.loadCookie();this.ready=!0}else window.setTimeout(this.prepare.bind(this),
200)};g.prototype._Unload=function(){this._Box=this.vkbd=null};g.prototype._Load=function(){var a=b.keyman.singleton,e=a.util,c=e.device,d=a.keyboardManager.activeKeyboard;if(null==this._Box)99<=this.loadRetry||(window.setTimeout(this._Load.bind(this),100),this.loadRetry++);else{this.loadRetry=0;a._TitleElement&&(a._TitleElement.innerHTML="KeymanWeb");this._Visible=!1;var g=this._Box.style;g.zIndex="9999";g.display="none";g.width="auto";g.position="desktop"==c.formFactor?"absolute":"fixed";if(c.touchable){var k=
1;if("phone"==c.formFactor)k=1.92*(a.isEmbedded?.65:.6);else{var t=1;"Android"==c.OS&&"devicePixelRatio"in window&&(t=window.devicePixelRatio);k="Android"==c.OS&&"tablet"==c.formFactor&&this.getHeight()<300*t?1.2*k:2*k}g.fontSize=k+"em"}this.vkbd=null;this._Box.innerHTML="";this._Box.onmouseover=this._VKbdMouseOver;this._Box.onmouseout=this._VKbdMouseOut;if(null!=d||c.touchable){k=null;t=null;g="";this._Box.className="";if(null!=d){k=d.KV;g=d.KH;var m=d.KVKL;"undefined"!=typeof m&&null!=m&&(t=m[c.formFactor],
"undefined"==typeof t||null==t)&&("phone"==c.formFactor?t=m.tablet:"tablet"==c.formFactor&&(t=m.phone),"undefined"==typeof t||null==t)&&(t=m.desktop)}if(null!=k&&null!=k.BK){m=k.BK;for(var p=!0,n=0;n<m.length;n++)if(0<m[n].length){p=!1;break}p&&(k=null)}null!=k||""==g||c.touchable?(null==k&&(k={F:"Tahoma",BK:h.Layouts.dfltText}),this._GenerateVisualKeyboard(k,g,t,a.keyboardManager.getKeyboardModifierBitmask())):(c=e._CreateElement("div"),c.className="kmw-title-bar",c.appendChild(this._TitleBarInterior()),
c.onmousedown=this._VMoveMouseDown,this._Box.appendChild(c),c=e._CreateElement("div"),c.className="kmw-osk-static",c.innerHTML=g,this._Box.appendChild(c),d.KHF&&d.KHF(this._Box));a._TitleElement&&(a._TitleElement.innerHTML="<span style='font-weight:bold'>"+d.KN+"</span> - "+a._TitleElement.innerHTML,a._TitleElement.className="",a._TitleElement.style.color="#fff")}else c=e._CreateElement("div"),c.className="kmw-title-bar",c.appendChild(this._TitleBarInterior()),c.onmousedown=this._VMoveMouseDown,this._Box.appendChild(c),
c=e._CreateElement("div"),c.className="kmw-osk-none",this._Box.appendChild(c);a=this._Box.firstChild;d=" kmw-keyboard-"+(d?d.KI.replace("Keyboard_",""):"");"keymanweb_title_bar"==a.id&&(a=a.nextSibling);a.className="kmw-osk-inner-frame"+d;this.vkbd&&(this.vkbd.createKeyTip(),this.vkbd.appendStyleSheet());this._Enabled&&this._Show()}};g.prototype._GenerateVisualKeyboard=function(a,e,c,d){this.vkbd=new b.keyman.osk.VisualKeyboard(a,e,c,d);a=b.keyman.singleton.util;this._Box.className=a.device.formFactor+
" "+a.device.OS.toLowerCase()+" kmw-osk-frame";"desktop"==a.device.formFactor&&this._Box.appendChild(this.controlBar());this._Box.appendChild(this.vkbd.kbdDiv);"desktop"==a.device.formFactor?this._Box.appendChild(this.resizeBar()):this.vkbd.adjustHeights()};g.prototype.controlBar=function(){var a=b.keyman.singleton,e=a.util,c=e._CreateElement("div"),d="";c.id="keymanweb_title_bar";c.className="kmw-title-bar";c.onmousedown=this._VMoveMouseDown;a.keyboardManager.activeKeyboard&&(d=a.keyboardManager.activeKeyboard.KN);
a=e._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML=d;c.appendChild(a);d=this.closeButton=e._CreateElement("div");d.id="kmw-close-button";d.className="kmw-title-bar-image";d.onmousedown=e._CancelMouse;d.onclick=function(){this._Hide(!0)}.bind(this);c.appendChild(d);d=this.helpImg=e._CreateElement("div");d.id="kmw-help-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Help";d.onclick=function(){e.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=
!1);return!1};d.onmousedown=e._CancelMouse;c.appendChild(d);d=this.configImg=e._CreateElement("div");d.id="kmw-config-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Configuration Options";d.onclick=function(){e.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=e._CancelMouse;c.appendChild(d);d=this.pinImg=e._CreateElement("div");d.id="kmw-pin-image";d.className="kmw-title-bar-image";d.title="Pin the On Screen Keyboard to its default location on the active text box";
d.onclick=function(){this.loadCookie();this.userPositioned=!1;this.saveCookie();this._Show();this.doResizeMove();this.pinImg&&(this.pinImg.style.display="none");window.event&&(window.event.returnValue=!1);return!1}.bind(this);d.onmousedown=e._CancelMouse;c.appendChild(d);return c};g.prototype.resizeBar=function(){var a=b.keyman.singleton.util,e=a._CreateElement("div");e.className="kmw-footer";e.onmousedown=a._CancelMouse;var c=a._CreateElement("div");c.className="kmw-footer-caption";c.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';
c.id="keymanweb-osk-footer-caption";a.attachDOMEvent(c,"dblclick",function(a){a&&a.shiftKey&&this.showBuild();return!1},!1);"onselectstart"in c&&(c.onselectstart=a.selectStartHandler);e.appendChild(c);a=a._CreateElement("div");a.className="kmw-footer-resize";a.onmousedown=this._VResizeMouseDown;a.onmouseover=a.onmouseout=this._VResizeMouseOut;e.appendChild(a);this.resizeIcon=a;return e};g.prototype.showBuild=function(){var a=b.keyman.singleton;a.util.alert("KeymanWeb Version "+a.version+"."+a.build+
'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2017 SIL International</span>')};g.prototype._TitleBarInterior=function(){var a=b.keyman.singleton,e=a.util,c=e._CreateElement("div"),d=c.style;d.paddingLeft="2px";d.cursor="move";d.background="#ad4a28";d.font="8pt Tahoma,Arial,sans-serif";d=e._CreateElement("div");d.className="kmw-title-bar-actions";d.onmousedown=e._CancelMouse;var g=e._CreateElement("div");g.className="kmw-close-button";g.onmousedown=e._CancelMouse;g.onclick=function(){this._Hide(!0)}.bind(this);
this.closeButton=g;d.appendChild(g);g=this.pinImg=e._CreateElement("div");g.className="kmw-pin-image";g.title="Pin the On Screen Keyboard to its default location on the active text box";g.onclick=this.restorePosition;g.onmousedown=e._CancelMouse;g.style.display="none";e.device.touchable||d.appendChild(g);c.appendChild(d);a=a._TitleElement=e._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML="KeymanWeb";c.appendChild(a);return c};g.prototype.isEnabled=function(){return this._Enabled};
g.prototype.isVisible=function(){return this._Visible};g.prototype.saveCookie=function(){var a=b.keyman.singleton.util,e=a.loadCookie("KeymanWeb_OnScreenKeyboard"),c=this.getPos();e.visible=this._Enabled?1:0;e.userSet=this.userPositioned?1:0;e.left=c.left;e.top=c.top;this.vkbd&&(e.width=this.width,e.height=this.height);a.saveCookie("KeymanWeb_OnScreenKeyboard",e)};g.prototype.loadCookie=function(){var a=b.keyman.singleton.util,e=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof e||
null==e)return this.userPositioned=!1;this._Enabled=1==a.toNumber(e.visible,1);this.userPositioned=1==a.toNumber(e.userSet,0);this.x=a.toNumber(e.left,-1);this.y=a.toNumber(e.top,-1);var c=a.toNumber(e.width,.3*screen.width);a=a.toNumber(e.height,.15*screen.height);c<.2*screen.width&&(c=.2*screen.width);a<.1*screen.height&&(a=.1*screen.height);c>.9*screen.width&&(c=.9*screen.width);a>.5*screen.height&&(a=.5*screen.height);this.vkbd&&(this.vkbd.kbdDiv.style.width=c+"px",this.vkbd.kbdDiv.style.height=
a+"px",this.vkbd.kbdDiv.style.fontSize=a/8+"px");-1!=this.x&&-1!=this.y&&this._Box||(this.userPositioned=!1);this.x<window.pageXOffset-.8*c&&(this.x=window.pageXOffset-.8*c);0>this.y&&(this.y=this.x=-1,this.userPositioned=!1);this.userPositioned&&this._Box&&this.setPos({left:this.x,top:this.y});return!0};g.prototype.getWidthFromCookie=function(){var a=b.keyman.singleton.util,e=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof e||null==e)return.3*screen.width;a=a.toNumber(e.width,.3*
screen.width);a<.2*screen.width?a=.2*screen.width:a>.9*screen.width&&(a=.9*screen.width);return a};g.prototype.getHeight=function(){var a=b.keyman.singleton,e=a.util.device;if("function"==typeof a.getOskHeight)return a.getOskHeight();var c=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==e.formFactor){var d=Math.min(screen.height,screen.width),g=Math.max(screen.height,screen.width);c=a.util.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):g/d*c/1.6}"iOS"==
e.OS&&(c/=a.util.getViewportScale());"Android"==e.OS&&"phone"==e.formFactor&&"devicePixelRatio"in window&&/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(c*=window.devicePixelRatio);return c};g.prototype.getWidth=function(){var a=b.keyman.singleton,e=a.util.device;if("function"==typeof a.getOskWidth)return a.getOskWidth();if("iOS"==e.OS)var c=window.innerWidth;else if("Android"==e.OS)try{c=document.documentElement.clientWidth}catch(f){c=screen.availWidth}else c=screen.width;return c};g.prototype.doResizeMove=
function(a){return b.keyman.singleton.util.callEvent("osk.resizemove",a)};g.prototype.getRect=function(){var a=b.keyman.singleton.util,e={};this.vkbd?(e.left=e.left=a._GetAbsoluteX(this.vkbd.kbdDiv),e.top=e.top=a._GetAbsoluteY(this.vkbd.kbdDiv),e.width=e.width=a._GetAbsoluteX(this.vkbd.kbdHelpDiv)-a._GetAbsoluteX(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetWidth,e.height=e.height=a._GetAbsoluteY(this.vkbd.kbdHelpDiv)-a._GetAbsoluteY(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetHeight):(e.left=e.left=
a._GetAbsoluteX(this._Box),e.top=e.top=a._GetAbsoluteY(this._Box),e.width=e.width=a._GetAbsoluteX(this._Box)+this._Box.offsetWidth,e.height=e.height=a._GetAbsoluteY(this._Box)+this._Box.offsetHeight);return e};g.prototype.setRect=function(a){var e=b.keyman.singleton.util;if(null!=this._Box&&"desktop"==e.device.formFactor){var c=this._Box,d=c.style;"left"in a&&(d.left=a.left-e._GetAbsoluteX(c)+c.offsetLeft+"px",this.dfltX=d.left);"top"in a&&(d.top=a.top-e._GetAbsoluteY(c)+c.offsetTop+"px",this.dfltY=
d.top);if(null!=this.vkbd){d=this.vkbd.kbdDiv;e=d.style;if("width"in a){var g=a.width-(c.offsetWidth-d.offsetWidth);g<.2*screen.width&&(g=.2*screen.width);g>.9*screen.width&&(g=.9*screen.width);e.width=g+"px";this.width=g}"height"in a&&(c=a.height-(c.offsetHeight-d.offsetHeight),c<.1*screen.height&&(c=.1*screen.height),c>.5*screen.height&&(c=.5*screen.height),e.height=c+"px",e.fontSize=c/8+"px",this.height=c);"nosize"in a&&this.resizeIcon&&(this.resizeIcon.style.display=a.nosize?"none":"block")}"nomove"in
a&&(this.noDrag=a.nomove,this.pinImg&&(this.pinImg.style.display=a.nomove||!this.userPositioned?"none":"block"));this.saveCookie()}};g.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:this.x,top:this._Visible?a.offsetTop:this.y}};g.prototype.setPos=function(a){if("undefined"!=typeof this._Box&&!b.keyman.singleton.util.device.touchable){if(this.userPositioned){var e=a.left;a=a.top;"undefined"!=typeof e&&(e<-.8*this._Box.offsetWidth&&(e=-.8*this._Box.offsetWidth),this.userPositioned&&
(this._Box.style.left=e+"px",this.x=e));"undefined"!=typeof a&&(0>a&&(a=0),this.userPositioned&&(this._Box.style.top=a+"px",this.y=a))}this.pinImg&&(this.pinImg.style.display=this.userPositioned?"block":"none")}};g.prototype._Show=function(a,e){var c=b.keyman.singleton,d=c.util.device;if(null!=this._Box&&null!=c.domManager.getActiveElement()&&(d.touchable||null!=c.keyboardManager.activeKeyboard&&this._Enabled)){var g=this._Box.style;d.touchable&&""==g.bottom&&(g.visibility="hidden");d.touchable&&
(g.opacity="1");this.vkbd&&this.vkbd.ddOSK&&(this.vkbd.show(),d.touchable&&(g.position="fixed",g.left=g.bottom="0px",g.height=g.maxHeight=this.vkbd.kbdDiv.firstChild.style.height,g.border="none",g.borderTop="1px solid gray",this._Visible=this._Enabled=!0));g.display="block";this.vkbd&&this.vkbd.showLanguage();"desktop"==d.formFactor&&(g.position="absolute",g.display="block",g.left="0px",this.loadCookie(),0<=a?(g.left=a+"px",g.top=e+"px"):this.userPositioned?(g.left=this.x+"px",g.top=this.y+"px"):
(a=c.domManager.getActiveElement(),this.dfltX?g.left=this.dfltX:"undefined"!=typeof a&&null!=a&&(g.left=c.util._GetAbsoluteX(a)+"px"),this.dfltY?g.top=this.dfltY:"undefined"!=typeof a&&null!=a&&(g.top=c.util._GetAbsoluteY(a)+a.offsetHeight+"px")),this._Visible=this._Enabled=!0,this.vkbd&&this.vkbd.kbdDiv&&(this.width=this.vkbd.kbdDiv.offsetWidth,this.height=this.vkbd.kbdDiv.offsetHeight),this.saveCookie(),c=this.pinImg,"undefined"!=typeof c&&null!=c&&(c.style.display=this.userPositioned?"block":"none"));
"hidden"==g.visibility&&window.setTimeout(function(){this._Box.style.visibility="visible"}.bind(this),0);d.touchable||(d={},d.x=this._Box.offsetLeft,d.y=this._Box.offsetTop,d.userLocated=this.userPositioned,this.doShow(d))}};g.prototype._Hide=function(a){var e=b.keyman.singleton,c=e.util.device;this._Box&&"block"==this._Box.style.display&&this.vkbd&&this.vkbd.kbdDiv&&(this.width=this.vkbd.kbdDiv.offsetWidth,this.height=this.vkbd.kbdDiv.offsetHeight);if(a)this._Enabled=e.keyboardManager.isCJK()||c.touchable?
!0:!1,this.saveCookie();else if("desktop"==c.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;this._Visible=!1;this._Box&&c.touchable&&0<this._Box.offsetHeight?(c=this._Box.style,c.transition="string"==typeof c.MozBoxSizing?"opacity 0.8s linear":c.msTransition=c.WebkitTransition="opacity 0.5s linear 0",window.setTimeout(function(){var a=this._Box.style;this._Visible?a.transition=a.msTransition=a.MozTransition=a.WebkitTransition="":(a.opacity="0",this._Box.addEventListener("transitionend",
this.hideNow,!1),this._Box.addEventListener("webkitTransitionEnd",this.hideNow,!1))}.bind(this),200)):this._Box&&(this._Box.style.display="none");c={};c.HiddenByUser=a;this.doHide(c);a&&e.domManager.focusLastActiveElement()};g.prototype.hide=function(){this._Enabled=!1;this._Hide(!0)};g.prototype.doShow=function(a){return b.keyman.singleton.util.callEvent("osk.show",a)};g.prototype.doHide=function(a){return b.keyman.singleton.util.callEvent("osk.hide",a)};g.prototype.showLanguageMenu=function(){(new h.LanguageMenu(b.keyman.singleton)).show()};
g.prototype.userLocated=function(){return this.userPositioned};g.prototype.show=function(a){0<arguments.length?(this._Enabled=a)?this._Show():this._Hide(!0):this._Visible?this._Hide(!0):this._Show()};g.prototype.addEventListener=function(a,e){return b.keyman.singleton.util.addEventListener("osk."+a,e)};g.prototype.shutdown=function(){var a=this._Box;a.parentElement&&a.parentElement.removeChild(a)};return g}();h.OSKManager=k})(d.osk||(d.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){var h=function(){function h(){this._TitleElement=null;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=!1;this.refocusTimer=0;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null};this.refreshElementContent=
null;this.util=this.util=new d.Util(this);window.KeymanWeb=this.interface=this["interface"]=new d.KeyboardInterface(this);this.osk=this.osk=new b.keyman.osk.OSKManager;this.ui=this.ui={};this.keyboardManager=new d.KeyboardManager(this);this.domManager=new d.DOMManager(this);this.hotkeyManager=new d.HotkeyManager(this);this.uiManager=new d.UIManager(this);this.keyMapManager=new d.KeyMapManager;this.textProcessor=new d.text.Processor;this.build=h.__BUILD__;this.srcPath=h._srcPath;this.rootPath=h._rootPath;
this.protocol=h._protocol;this.version=b.keyman.environment.VERSION;this.helpURL="http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}h.prototype.setDefaultDeviceOptions=function(b){};h.prototype.getStyleSheetPath=function(b){return b};h.prototype.getKeyboardPath=function(b,a){return b};h.prototype.KC_=function(b,a,e){return""};h.prototype.handleRotationEvents=function(){};h.prototype.alignInputs=function(b){};h.prototype.hideInputs=function(){};h.prototype.namespaceID=function(b){};
h.prototype.preserveID=function(b){};h.prototype.setInitialized=function(b){this.initialized=this.initialized=b};h.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};h.prototype.shutdown=function(){this.util.detachDOMEvent(window,"focus",this.pageFocusHandler,!1);this.util.detachDOMEvent(window,"blur",this.pageFocusHandler,!1);this.domManager.shutdown();this.osk.shutdown();this.util.shutdown();this.keyboardManager.shutdown();
this.ui&&this.ui.shutdown&&this.ui.shutdown();d.DOMEventHandlers.states=new d.CommonDOMStates};h.prototype.isFontAvailable=function(b){return this.util.checkFont({family:b})};h.prototype.addEventListener=function(b,a){return this.util.addEventListener("kmw."+b,a)};h.prototype._GetEventObject=function(b){if(!b&&(b=window.event,!b)){var a=this.domManager.getLastActiveElement();if(a){a=a.ownerDocument;if(a)var e=a.defaultView;if(!e)return null;b=e.event}}return b};h.prototype._push=function(b,a){b.push?
b.push(a):b=b.concat(a);return b};h.prototype.attachToControl=function(b){this.domManager.attachToControl(b)};h.prototype.detachFromControl=function(b){this.domManager.detachFromControl(b)};h.prototype.addKeyboards=function(b){0==arguments.length?this.keyboardManager.keymanCloudRequest("",!1):this.keyboardManager.addKeyboardArray(arguments)};h.prototype.addKeyboardsForLanguage=function(b){this.keyboardManager.addLanguageKeyboards(arguments)};h.prototype.register=function(b){this.keyboardManager.register(b)};
h.prototype.removeKeyboards=function(b){return this.keyboardManager.removeKeyboards(b)};h.prototype.setActiveKeyboard=function(b,a){return this.keyboardManager.setActiveKeyboard(b,a)};h.prototype.getActiveKeyboard=function(){return this.keyboardManager.getActiveKeyboardName()};h.prototype.getActiveLanguage=function(b){return this.keyboardManager.getActiveLanguage(b)};h.prototype.isAttached=function(b){return this.domManager.isAttached(b)};h.prototype.isCJK=function(b){return this.keyboardManager.isCJK(b)};
h.prototype.isChiral=function(b){return this.keyboardManager.isChiral(b)};h.prototype.getKeyboard=function(b,a){var e,c=this.keyboardManager.getDetailedKeyboards();for(e=0;e<c.length;e++){var d=c[e];if(d.InternalName==b||d.InternalName=="Keyboard_"+b)if(2>arguments.length||d.LanguageCode==a)return d}return null};h.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};h.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};h.prototype.init=
function(b){return this.domManager.init(b)};h.prototype.resetContext=function(){this.interface.resetContext()};h.prototype.setNumericLayer=function(){this.interface.setNumericLayer()};h.prototype.disableControl=function(b){this.domManager.disableControl(b)};h.prototype.enableControl=function(b){this.domManager.enableControl(b)};h.prototype.setKeyboardForControl=function(b,a,d){this.domManager.setKeyboardForControl(b,a,d)};h.prototype.getKeyboardForControl=function(b){this.domManager.getKeyboardForControl(b)};
h.prototype.getLanguageForControl=function(b){this.domManager.getLanguageForControl(b)};h.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};h.prototype.getLastActiveElement=function(){return this.domManager.getLastActiveElement()};h.prototype.setActiveElement=function(b,a){return this.domManager.setActiveElement(b,a)};h.prototype.moveToElement=function(b){this.domManager.moveToElement(b)};h.prototype.addHotKey=function(b,a,d){this.hotkeyManager.addHotKey(b,a,d)};
h.prototype.removeHotKey=function(b,a){this.hotkeyManager.removeHotkey(b,a)};h.prototype.getUIState=function(){return this.uiManager.getUIState()};h.prototype.activatingUI=function(b){this.uiManager.setActivatingUI(b)};h.prototype.BuildVisualKeyboard=function(b,a,d,c){return this.osk.vkbd?this.osk.vkbd.buildDocumentationKeyboard(b,a,d,c):null};return h}();d.KeymanBase=h})(b.keyman||(b.keyman={}))})(com||(com={}));
var scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+1),KeymanBase=com.keyman.KeymanBase;KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");KeymanBase.__BUILD__=9;window.keyman&&window.keyman.loaded||function(){window.keyman=com.keyman.singleton=new KeymanBase}();
window.keyman.initialized||function(){var b=window.keyman,d=b.util;b.debug=b.debug=function(d){if(null==b.debugElement){var h=document.createElement("DIV");var g=h.style;g.position="absolute";g.width="30%";g.maxHeight="50%";g.top="0";g.right="0";g.minHeight="50px";g.border="1px solid blue";g.whiteSpace="pre-line";g.overflowY="scroll";g=document.createElement("P");g.id="debug_output";g.style.margin="2px";h.appendChild(g);document.body.appendChild(h);b.debugElement=g}if(null!=(g=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof g.textContent?g.textContent="":g.innerHTML="";else{h=(new Date).toTimeString().substr(3,5)+" ";var a,e;for(a=0;a<arguments.length;a++){0<a&&(h+="; ");var c=arguments[a];if("object"==typeof c)if(null==c)h+="null";else{var f="";for(e in c){0<f.length&&(f+=", ");f=f+e+":";switch(typeof c[e]){case "string":case "number":case "boolean":f+=c[e];break;default:f+=typeof c[e]}if(1024<f.length){f=f.substr(0,1E3)+"...";break}}0<f.length&&(h=h+"{"+f+"}")}else h+=c}1500<h.length&&
(h=h.substr(0,1500)+" (more)");"undefined"!=typeof g.textContent?g.textContent=h+"\n"+g.textContent:g.innerHTML=h+"<br />"+g.innerHTML}};b.debugElement=null;b.delayedInit();com.keyman.osk.Layouts._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";b._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");d.attachDOMEvent(window,"load",b.domManager._WindowLoad,!1);d.attachDOMEvent(window,"unload",b.domManager._WindowUnload,!1);d.attachDOMEvent(document,
"keyup",b.hotkeyManager._Process,!1);b.pageFocusHandler=b.interface.resetVKShift.bind(b.interface);d.attachDOMEvent(window,"focus",b.pageFocusHandler,!1);d.attachDOMEvent(window,"blur",b.pageFocusHandler,!1);String.kmwEnableSupplementaryPlane(!1)}();
(function(b){(function(b){var d=function(){function b(){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight}b.prototype.equals=function(a){return this.innerWidth==a.innerWidth&&this.innerHeight==a.innerHeight};return b}(),k=function(){function b(a){this.idlePermutationCounter=b.IDLE_PERMUTATION_CAP;this.keyman=a}b.prototype.resolve=function(){this.keyman.alignInputs();var a=this.keyman.osk;a._Load();this.oskVisible&&a._Show();this.isActive=!1;this.updateTimer&&(window.clearInterval(this.updateTimer),
this.rotState=null)};b.prototype.initNewRotation=function(){this.oskVisible=this.keyman.osk.isVisible();this.keyman.osk.hideNow();this.isActive=!0};b.prototype.init=function(){if(!this.keyman.isEmbedded){var a=this.keyman.util.device.OS,b=this.keyman.util,c=this;"iOS"==a?(b.attachDOMEvent(window,"orientationchange",function(){c.iOSEventHandler();return!1}),b.attachDOMEvent(window,"resize",function(){c.iOSEventHandler();return!1})):"Android"==a&&("onmozorientationchange"in screen?b.attachDOMEvent(screen,
"mozorientationchange",function(){c.initNewRotation();return!1}):b.attachDOMEvent(window,"orientationchange",function(){c.initNewRotation();return!1}),b.attachDOMEvent(window,"resize",function(){c.resolve();return!1}))}};b.prototype.iOSEventHandler=function(){this.isActive||(this.initNewRotation(),this.rotState=new d,this.updateTimer=window.setInterval(this.iOSEventUpdate.bind(this),b.UPDATE_INTERVAL));this.idlePermutationCounter=0};b.prototype.iOSEventUpdate=function(){var a=new d;this.rotState.equals(a)?
++this.idlePermutationCounter==b.IDLE_PERMUTATION_CAP&&this.resolve():(this.rotState=a,this.idlePermutationCounter=0)};b.IDLE_PERMUTATION_CAP=15;b.UPDATE_INTERVAL=20;return b}();b.RotationManager=k})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(d){(function(d){d.VisualKeyboard.prototype.touchHold=function(b){this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);"undefined"!=typeof b.subKeys&&null!=b.subKeys&&(this.subkeyDelayTimer=window.setTimeout(function(){this.clearPopup();this.showSubKeys(b)}.bind(this),this.popupDelay))};d.VisualKeyboard.prototype.optionKey=function(d,g,a){d=b.keyman.singleton;var e=d.osk;a&&(0<=g.indexOf("K_LOPT")?e.showLanguageMenu():0<=g.indexOf("K_ROPT")&&
(d.uiManager.setActivatingUI(!1),e._Hide(!0),d.touchAliasing.hideCaret(),d.domManager.clearLastActiveElement()))};d.VisualKeyboard.prototype.highlightSubKeys=function(d,g,a){var e=b.keyman.singleton.util;if(null!=d&&null!=d.subKeys){var c,f=document.getElementById("kmw-popup-keys");5<this.touchY-a&&null==f&&(this.subkeyDelayTimer&&window.clearTimeout(this.subkeyDelayTimer),this.showSubKeys(d),f=document.getElementById("kmw-popup-keys"));for(c=0;c<d.subKeys.length;c++)try{var h=f.childNodes[c].firstChild;
var k=e._GetAbsoluteX(h);var t=e._GetAbsoluteY(h);var m=k+h.offsetWidth;var p=t+h.offsetHeight;var n=g>k&&g<m&&a>t&&a<p;this.highlightKey(h,n);n&&this.highlightKey(d,!1)}catch(r){}}};d.VisualKeyboard.prototype.showKeyTip=function(d,g){var a=b.keyman.singleton,e=a.util,c=a.osk;a=this.keytip;if(null!=a&&(d!=a.key||g!=a.state)){var f=document.getElementById("kmw-popup-keys");f=f&&"visible"==f.style.visibility;if(g&&!f){var h=e._GetAbsoluteY(c._Box),k=c._Box.offsetHeight;c=e._GetAbsoluteX(d);var t=e._GetAbsoluteY(d);
f=d.offsetWidth;for(var m=d.offsetHeight,p=d.firstChild,n=a.element.style,r=a.element.childNodes[1],q=r.style,u=0,v=a.element.firstChild,y=0;y<d.childNodes.length&&(p=d.childNodes[y],!e.hasClass(p,"kmw-key-text"));y++);v.width=1.6*f;v.height=2.3*m;n.top="auto";n.bottom=h+k-t-m+"px";n.textAlign="center";n.overflow="visible";n.fontFamily=e.getStyleValue(p,"font-family");n.width=v.width+"px";n.height=v.height+"px";e=e.getStyleInt(p,"font-size");0!=e&&(e*=1.8,n.fontSize=e+"px",h=b.keyman.osk.OSKKey.getTextWidth(this,
r.textContent,n),h=.9*v.width/h,1>h&&(n.fontSize=e*h+"px"));r.textContent=p.textContent;q.display="block";q.position="absolute";q.textAlign="center";q.width="100%";q.top="2%";q.bottom="auto";e=(v.width-f)/2;c<e?(u=-1,c+=e):c>window.innerWidth-f-e&&(u=1,c-=e);this.drawPreview(v,f,m,u);n.left=c-e+"px";n.display="block"}else a.element.style.display="none";a.key=d;a.state=g}};d.VisualKeyboard.prototype.drawPreview=function(d,g,a,e){a=b.keyman.singleton.util.device;var c=d.getContext("2d"),f=(d.width-
g)/2,h=d.height,k=f,t=g+f;g+=2*f;var m=.5*h,p=.6*h,n=8;"Android"==a.OS&&(n=3);switch(e){case -1:k-=f;t-=f;break;case 1:k+=f,t+=f}c.clearRect(0,0,d.width,d.height);"Android"==a.OS?(k=t=(k+t)/2,c.fillStyle="#999"):c.fillStyle="#ffffff";c.lineWidth=1;c.strokeStyle="#cccccc";c.save();c.beginPath();c.moveTo(0+n,0);c.arcTo(g,0,g,n,n);"Android"==a.OS?(c.arcTo(g,m,t,p,n),c.arcTo(t,p,k,p,n)):(c.arcTo(g,m,t,p,n),c.arcTo(t,p,t-n,h,n),c.arcTo(t,h,k,h,n),c.arcTo(k,h,k,p-n,n));c.arcTo(k,p,0,m-n,n);c.arcTo(0,m,
0,n,n);c.arcTo(0,0,0+n,0,n);c.fill();c.stroke();c.restore()};d.VisualKeyboard.prototype.createKeyTip=function(){var d=b.keyman.singleton,g=d.util;if("phone"==d.util.device.formFactor){if(null==this.keytip){this.keytip={key:null,state:!1};var a=this.keytip.element=g._CreateElement("div");a.className="kmw-keytip";a.id="kmw-keytip";a.style.pointerEvents="none";a.appendChild(g._CreateElement("canvas"));a.appendChild(g._CreateElement("span"))}d.osk._Box.appendChild(this.keytip.element)}};d.VisualKeyboard.prototype.addCallout=
function(d){var g=b.keyman.singleton,a=g.util;if("phone"!=a.device.formFactor||"iOS"!=a.device.OS)return null;a=a._CreateElement("div");var e=a.style;a.id="kmw-popup-callout";g.osk._Box.appendChild(a);g=d.offsetLeft;var c=d.offsetWidth,f=d.offsetHeight;e.top=d.offsetTop-6+"px";e.left=g+"px";e.width=c+"px";e.height=f+6+"px";return a};d.VisualKeyboard.prototype.waitForFonts=function(d,g){var a=b.keyman.singleton,e=a.util;if("undefined"==typeof d&&"undefined"==typeof g||"undefined"==typeof d.files&&
"undefined"==typeof g.files)return!0;var c=e.checkFontDescriptor(d),f=e.checkFontDescriptor(g);if(c&&f)return!0;a.fontCheckTimer=window.setInterval(function(){e.checkFontDescriptor(d)&&e.checkFontDescriptor(g)&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},100);window.setTimeout(function(){a.fontCheckTimer&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},5E3);return!1};d.VisualKeyboard.prototype.adjustHeights=function(){var d=b.keyman.singleton,
g=d.osk,a=g._Box;d=d.util;var e=d.device;if(a&&this.kbdDiv&&this.kbdDiv.firstChild&&this.kbdDiv.firstChild.firstChild.childNodes){var c=this.kbdDiv.firstChild.childNodes,f=c[0].childNodes.length;g=g.getHeight();var h=Math.floor(g/(0==f?1:f)),B,t;var m=1;"Android"==e.OS&&"devicePixelRatio"in window&&(h/=window.devicePixelRatio);g=f*h;f=a;h=f.style;h.height=h.maxHeight=g+3+"px";f=f.firstChild.firstChild;h=f.style;h.height=h.maxHeight=g+3+"px";"iOS"==e.OS&&(m/=d.getViewportScale());h.fontSize=m+"em";
var p="iOS"==e.OS&&"phone"==e.formFactor&&d.landscapeView();for(e=0;e<c.length;e++){f=c[e].childNodes.length;h=Math.floor(g/(0==f?1:f));var n=Math.round(.15*h);c[e].style.height=g+3+"px";for(a=0;a<f;a++){m=c[e].childNodes[a].style;m.bottom=(f-a-1)*h+1+"px";m.maxHeight=m.height=h+"px";var r=c[e].childNodes[a].childNodes;var q=r.length;for(B=0;B<q;B++){var u=r[B];for(t=0;t<u.childNodes.length&&!d.hasClass(u.childNodes[t],"kmw-key");t++);var v=u.childNodes[t].style;v.bottom=m.bottom;v.height=v.minHeight=
h-n+"px";p&&0<t&&(u.childNodes[0].style.fontSize="6px")}}}}}})(d.osk||(d.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
window.keyman.initialized||function(){var b=window.keyman,d=b.util,h=d.device;b.isEmbedded=!1;b.setDefaultDeviceOptions=function(b){""==b.attachType&&(b.attachType=h.touchable?"manual":"auto")};d.wait=function(d){var g=this.waiting;if("undefined"!=typeof g&&null!=g&&!b.warned){var a=g.firstChild.childNodes;d?(g.pending=!0,window.setTimeout(function(){g.pending&&(window.scrollTo(0,0),a[0].style.display="none",a[1].className="kmw-wait-text",a[1].innerHTML=d,a[2].style.display="block",g.style.display=
"block")},1E3)):g.pending&&(a[1].innerHTML="",g.pending=!1,g.style.display="none")}};b.getStyleSheetPath=function(b){return d.getOption("resources")+"osk/"+b};b.getKeyboardPath=function(d){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(d)?"":b.options.keyboards)+d};b.KC_=function(d,g,a){var e,c="",f=a.body?a:a.ownerDocument;if(h.touchable)c=b.touchAliasing.getTextBeforeCaret(a);else if(f&&(e=f.defaultView)&&e.getSelection&&("on"==f.designMode.toLowerCase()||"true"==a.contentEditable||"plaintext-only"==
a.contentEditable||""===a.contentEditable))a=e.getSelection(),3==a.focusNode.nodeType&&(c=a.focusNode.substringData(0,a.focusOffset));else if(a.setSelectionRange){if(a._KeymanWebSelectionStart)c=a._KeymanWebSelectionStart;else{if(null===b._CachedSelectionStart||a.selectionStart!==b._LastCachedSelection)b._LastCachedSelection=a.selectionStart,b._CachedSelectionStart=a.value._kmwCodeUnitToCodePoint(a.selectionStart),b._CachedSelectionEnd=a.value._kmwCodeUnitToCodePoint(a.selectionEnd);c=b._CachedSelectionStart}c=
a.value._kmwSubstr(0,c)}c._kmwLength()<d&&(c=Array(d-c._kmwLength()+1).join("\ufffe")+c);return c._kmwSubstr(-d)._kmwSubstr(0,g)};b.alignInputs=function(d){if(h.touchable){var g=b.domManager,a=[];d?d.forEach(function(b){b.base?a.push(b):b.kmw_ip&&a.push(b.kmw_ip)}):a=g.inputList;a.forEach(function(a){g.touchHandlers.updateInput(a);a.style.visibility="visible";0<a.base.textContent.length&&(a.base.style.visibility="hidden")})}};b.hideInputs=function(){var d=b.domManager;if(h.touchable)for(var g=0;g<
d.inputList.length;g++)d.inputList[g].style.visibility="hidden",d.inputList[g].base.style.visibility="visible"};b.isPositionSynthesized=function(){return h.touchable};b.handleRotationEvents=function(){(new com.keyman.RotationManager(b)).init()}}();(function(){var b=window.keyman,d=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(d),b.init(null))},10)})();var CLOSURE_NO_DEPS=!0,COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(b){return void 0!==b};
goog.isString=function(b){return"string"==typeof b};goog.isBoolean=function(b){return"boolean"==typeof b};goog.isNumber=function(b){return"number"==typeof b};goog.exportPath_=function(b,d,h){b=b.split(".");h=h||goog.global;b[0]in h||!h.execScript||h.execScript("var "+b[0]);for(var k;b.length&&(k=b.shift());)!b.length&&goog.isDef(d)?h[k]=d:h=h[k]&&h[k]!==Object.prototype[k]?h[k]:h[k]={}};
goog.define=function(b,d){COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&void 0===goog.global.CLOSURE_UNCOMPILED_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,b)?d=goog.global.CLOSURE_UNCOMPILED_DEFINES[b]:goog.global.CLOSURE_DEFINES&&void 0===goog.global.CLOSURE_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,b)&&(d=goog.global.CLOSURE_DEFINES[b]));goog.exportPath_(b,d)};goog.DEBUG=!0;goog.LOCALE="en";
goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(b){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');goog.constructNamespace_(b)};
goog.constructNamespace_=function(b,d){if(!COMPILED){delete goog.implicitNamespaces_[b];for(var h=b;(h=h.substring(0,h.lastIndexOf(".")))&&!goog.getObjectByName(h);)goog.implicitNamespaces_[h]=!0}goog.exportPath_(b,d)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(b){if(!goog.isString(b)||!b||-1==b.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+b+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");
goog.moduleLoaderState_.moduleName=b;if(!COMPILED){if(goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');delete goog.implicitNamespaces_[b]}};goog.module.get=function(b){return goog.module.getInternal_(b)};goog.module.getInternal_=function(b){if(!COMPILED){if(b in goog.loadedModules_)return goog.loadedModules_[b];if(!goog.implicitNamespaces_[b])return b=goog.getObjectByName(b),null!=b?b:null}return null};goog.moduleLoaderState_=null;
goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(b){if(goog.DISALLOW_TEST_ONLY_CODE)throw b=b||"",Error("Importing test-only code into non-debug environment"+(b?": "+b:"."));};goog.forwardDeclare=function(b){};COMPILED||(goog.isProvided_=function(b){return b in goog.loadedModules_||!goog.implicitNamespaces_[b]&&goog.isDefAndNotNull(goog.getObjectByName(b))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(b,d){b=b.split(".");d=d||goog.global;for(var h=0;h<b.length;h++)if(d=d[b[h]],!goog.isDefAndNotNull(d))return null;return d};goog.globalize=function(b,d){d=d||goog.global;for(var h in b)d[h]=b[h]};goog.addDependency=function(b,d,h,k){if(goog.DEPENDENCIES_ENABLED){var g=goog.getLoader_();g&&g.addDependency(b,d,h,k)}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(b){goog.global.console&&goog.global.console.error(b)};
goog.require=function(b){goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_&&goog.getLoader_().earlyProcessLoad(b);if(!COMPILED){if(goog.isProvided_(b)){if(goog.isInModuleLoader_())return goog.module.getInternal_(b)}else if(goog.ENABLE_DEBUG_LOADER){var d=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{var h=goog.getLoader_();h?h.load(b):goog.logToConsole_("Could not load "+b+" because there is no debug loader.")}finally{goog.moduleLoaderState_=d}}return null}};goog.basePath="";
goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(b){b.instance_=void 0;b.getInstance=function(){if(b.instance_)return b.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=b);return b.instance_=new b}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.TRANSPILE="detect";goog.TRANSPILER="transpile.js";goog.DEBUG_LOADER="";goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var b=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(d){b=!1}goog.hasBadLetScoping=b}return goog.hasBadLetScoping};goog.workaroundSafari10EvalBug=function(b){return"(function(){"+b+"\n;})();\n"};
goog.loadModule=function(b){var d=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};if(goog.isFunction(b))var h=b.call(void 0,{});else if(goog.isString(b))goog.useSafari10Workaround()&&(b=goog.workaroundSafari10EvalBug(b)),h=goog.loadModuleFromSource_.call(void 0,b);else throw Error("Invalid module definition");var k=goog.moduleLoaderState_.moduleName;if(!goog.isString(k)||!k)throw Error('Invalid module name "'+k+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(k,h):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof h&&null!=h&&Object.seal(h);goog.loadedModules_[k]=h}finally{goog.moduleLoaderState_=d}};goog.loadModuleFromSource_=function(b){eval(b);return{}};goog.normalizePath_=function(b){b=b.split("/");for(var d=0;d<b.length;)"."==b[d]?b.splice(d,1):d&&".."==b[d]&&b[d-1]&&".."!=b[d-1]?b.splice(--d,2):d++;return b.join("/")};
goog.loadFileSync_=function(b){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(b);try{var d=new goog.global.XMLHttpRequest;d.open("get",b,!1);d.send();return 0==d.status||200==d.status?d.responseText:null}catch(h){return null}};
goog.transpile_=function(b,d){var h=goog.global.$jscomp;h||(goog.global.$jscomp=h={});var k=h.transpile;if(!k){var g=goog.basePath+goog.TRANSPILER,a=goog.loadFileSync_(g);if(a){(function(){eval(a+"\n//# sourceURL="+g)}).call(goog.global);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile;
h=goog.global.$jscomp;k=h.transpile}}k||(k=h.transpile=function(a,b){goog.logToConsole_(b+" requires transpilation but no transpiler was found.");return a});return k(b,d)};
goog.typeOf=function(b){var d=typeof b;if("object"==d)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return d;var h=Object.prototype.toString.call(b);if("[object Window]"==h)return"object";if("[object Array]"==h||"number"==typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==h||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==d&&"undefined"==typeof b.call)return"object";return d};goog.isNull=function(b){return null===b};goog.isDefAndNotNull=function(b){return null!=b};goog.isArray=function(b){return"array"==goog.typeOf(b)};goog.isArrayLike=function(b){var d=goog.typeOf(b);return"array"==d||"object"==d&&"number"==typeof b.length};goog.isDateLike=function(b){return goog.isObject(b)&&"function"==typeof b.getFullYear};goog.isFunction=function(b){return"function"==goog.typeOf(b)};
goog.isObject=function(b){var d=typeof b;return"object"==d&&null!=b||"function"==d};goog.getUid=function(b){return b[goog.UID_PROPERTY_]||(b[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(b){return!!b[goog.UID_PROPERTY_]};goog.removeUid=function(b){null!==b&&"removeAttribute"in b&&b.removeAttribute(goog.UID_PROPERTY_);try{delete b[goog.UID_PROPERTY_]}catch(d){}};goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;
goog.removeHashCode=goog.removeUid;goog.cloneObject=function(b){var d=goog.typeOf(b);if("object"==d||"array"==d){if(b.clone)return b.clone();d="array"==d?[]:{};for(var h in b)d[h]=goog.cloneObject(b[h]);return d}return b};goog.bindNative_=function(b,d,h){return b.call.apply(b.bind,arguments)};
goog.bindJs_=function(b,d,h){if(!b)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(g,k);return b.apply(d,g)}}return function(){return b.apply(d,arguments)}};goog.bind=function(b,d,h){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(b,d){var h=Array.prototype.slice.call(arguments,1);return function(){var d=h.slice();d.push.apply(d,arguments);return b.apply(this,d)}};goog.mixin=function(b,d){for(var h in d)b[h]=d[h]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(b){if(goog.global.execScript)goog.global.execScript(b,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(k){}if("undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(k){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(b);else{var d=goog.global.document,h=d.createElement("SCRIPT");h.type="text/javascript";h.defer=
!1;h.appendChild(d.createTextNode(b));d.head.appendChild(h);d.head.removeChild(h)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;
goog.getCssName=function(b,d){if("."==String(b).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+b);var h=function(b){return goog.cssNameMapping_[b]||b},k=function(b){b=b.split("-");for(var a=[],d=0;d<b.length;d++)a.push(h(b[d]));return a.join("-")};k=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?h:k:function(b){return b};b=d?b+"-"+k(d):k(b);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(b):b};
goog.setCssNameMapping=function(b,d){goog.cssNameMapping_=b;goog.cssNameMappingStyle_=d};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(b,d){d&&(b=b.replace(/\{\$([^}]+)}/g,function(b,k){return null!=d&&k in d?d[k]:b}));return b};goog.getMsgWithFallback=function(b,d){return b};goog.exportSymbol=function(b,d,h){goog.exportPath_(b,d,h)};goog.exportProperty=function(b,d,h){b[d]=h};
goog.inherits=function(b,d){function h(){}h.prototype=d.prototype;b.superClass_=d.prototype;b.prototype=new h;b.prototype.constructor=b;b.base=function(b,g,a){for(var e=Array(arguments.length-2),c=2;c<arguments.length;c++)e[c-2]=arguments[c];return d.prototype[g].apply(b,e)}};
goog.base=function(b,d,h){var k=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!k)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(k.superClass_){for(var g=Array(arguments.length-1),a=1;a<arguments.length;a++)g[a-1]=arguments[a];return k.superClass_.constructor.apply(b,g)}g=Array(arguments.length-2);for(a=2;a<arguments.length;a++)g[a-2]=arguments[a];a=!1;for(var e=b.constructor;e;e=
e.superClass_&&e.superClass_.constructor)if(e.prototype[d]===k)a=!0;else if(a)return e.prototype[d].apply(b,g);if(b[d]===k)return b.constructor.prototype[d].apply(b,g);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(b){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");b.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(b,d){var h=d.constructor,k=d.statics;h&&h!=Object.prototype.constructor||(h=function(){throw Error("cannot instantiate an interface (no constructor defined).");});h=goog.defineClass.createSealingConstructor_(h,b);b&&goog.inherits(h,b);delete d.constructor;delete d.statics;goog.defineClass.applyProperties_(h.prototype,d);null!=k&&(k instanceof Function?k(h):goog.defineClass.applyProperties_(h,k));return h};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(b,d){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return b;var h=!goog.defineClass.isUnsealable_(d),k=function(){var d=b.apply(this,arguments)||this;d[goog.UID_PROPERTY_]=d[goog.UID_PROPERTY_];this.constructor===k&&h&&Object.seal instanceof Function&&Object.seal(d);return d};return k};goog.defineClass.isUnsealable_=function(b){return b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(b,d){for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(b[h]=d[h]);for(var k=0;k<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;k++)h=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[k],Object.prototype.hasOwnProperty.call(d,h)&&(b[h]=d[h])};goog.tagUnsealableClass=function(b){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var b=goog.global.document;return null!=b&&"write"in b},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var b=goog.global.document,d=b.currentScript;b=d?[d]:b.getElementsByTagName("SCRIPT");for(d=b.length-1;0<=d;--d){var h=b[d].src,k=h.lastIndexOf("?");k=-1==k?h.length:k;if("base.js"==h.substr(k-
7,7)){goog.basePath=h.substr(0,k-7);break}}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function b(a,b){k?h[a]=!0:b()?h[a]=!1:k=h[a]=!0}function d(a){try{return!!eval(a)}catch(e){return!1}}var h={es3:!1},k=!1,g=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";b("es5",function(){return d("[1,].length==1")});b("es6",function(){var a=g.match(/Edge\/(\d+)(\.\d)*/i);
return a&&15>Number(a[1])?!1:d('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')});b("es6-impl",function(){return!0});b("es7",function(){return d("2 ** 2 == 4")});b("es8",function(){return d("async () => 1, true")});return h},goog.Transpiler.prototype.needsTranspile=
function(b){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;this.requiresTranspilation_||(this.requiresTranspilation_=this.createRequiresTranspilation_());if(b in this.requiresTranspilation_)return this.requiresTranspilation_[b];throw Error("Unknown language mode: "+b);},goog.Transpiler.prototype.transpile=function(b,d){return goog.transpile_(b,d)},goog.transpiler_=new goog.Transpiler,goog.DebugLoader=function(){this.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},
written:{},deferred:{}};this.oldIeWaiting_=!1;this.queuedModules_=[];this.lastNonModuleScriptIndex_=0},goog.DebugLoader.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader.prototype.earlyProcessLoad=function(b){goog.DebugLoader.IS_OLD_IE_&&this.maybeProcessDeferredDep_(b)},goog.DebugLoader.prototype.load=function(b){var d=this.getPathFromDeps_(b);if(d){var h=function(b){if(!(b in a.written||b in a.visited)){a.visited[b]=!0;if(b in a.requires)for(var c in a.requires[b])if(!e.isProvided(c))if(c in
a.nameToPath)h(a.nameToPath[c]);else throw Error("Undefined nameToPath for "+c);b in g||(g[b]=!0,k.push(b))}},k=[],g={},a=this.dependencies_,e=this;h(d);for(b=0;b<k.length;b++)d=k[b],this.dependencies_.written[d]=!0;for(b=0;b<k.length;b++)if(d=k[b]){var c=a.loadFlags[d]||{},f=c.lang||"es3";f=this.getTranspiler().needsTranspile(f);"goog"==c.module||f?this.importProcessedScript_(goog.basePath+d,"goog"==c.module,f):this.importScript_(goog.basePath+d)}else throw Error("Undefined script input");}else throw b=
"goog.require could not find: "+b,this.logToConsole(b),Error(b);},goog.DebugLoader.prototype.addDependency=function(b,d,h,k){var g;b=b.replace(/\\/g,"/");var a=this.dependencies_;k&&"boolean"!==typeof k||(k=k?{module:"goog"}:{});for(var e=0;g=d[e];e++)a.nameToPath[g]=b,a.loadFlags[b]=k;for(k=0;d=h[k];k++)b in a.requires||(a.requires[b]={}),a.requires[b][d]=!0},goog.DebugLoader.prototype.importScript_=function(b,d){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this))(b,d)&&(this.dependencies_.written[b]=
!0)},goog.DebugLoader.prototype.importProcessedScript_=function(b,d,h){this.importScript_("",'goog.debugLoader_.retrieveAndExec_("'+b+'", '+d+", "+h+");")},goog.DebugLoader.prototype.retrieveAndExec_=function(b,d,h){if(!COMPILED){var k=b;b=this.normalizePath(b);var g=goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this),a=this.loadFileSync(b);if(null==a)throw Error('Load of "'+b+'" failed');h&&(a=this.getTranspiler().transpile(a,b));a=d?this.wrapModule_(b,a):a+("\n//# sourceURL="+
b);goog.DebugLoader.IS_OLD_IE_&&this.oldIeWaiting_?(this.dependencies_.deferred[k]=a,this.queuedModules_.push(k)):g(b,a)}},goog.DebugLoader.prototype.wrapModule_=function(b,d){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(d+"\n//# sourceURL="+b+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+d+"\n;return exports});\n//# sourceURL="+b+"\n"},goog.DebugLoader.prototype.loadQueuedModules_=function(){var b=this.queuedModules_.length;
if(0<b){var d=this.queuedModules_;this.queuedModules_=[];for(var h=0;h<b;h++)this.maybeProcessDeferredPath_(d[h])}this.oldIeWaiting_=!1},goog.DebugLoader.prototype.maybeProcessDeferredDep_=function(b){this.isDeferredModule_(b)&&this.allDepsAreAvailable_(b)&&(b=this.getPathFromDeps_(b),this.maybeProcessDeferredPath_(goog.basePath+b))},goog.DebugLoader.prototype.isDeferredModule_=function(b){var d=(b=this.getPathFromDeps_(b))&&this.dependencies_.loadFlags[b]||{},h=d.lang||"es3";return b&&("goog"==d.module||
this.getTranspiler().needsTranspile(h))?goog.basePath+b in this.dependencies_.deferred:!1},goog.DebugLoader.prototype.allDepsAreAvailable_=function(b){if((b=this.getPathFromDeps_(b))&&b in this.dependencies_.requires)for(var d in this.dependencies_.requires[b])if(!this.isProvided(d)&&!this.isDeferredModule_(d))return!1;return!0},goog.DebugLoader.prototype.maybeProcessDeferredPath_=function(b){if(b in this.dependencies_.deferred){var d=this.dependencies_.deferred[b];delete this.dependencies_.deferred[b];
goog.globalEval(d)}},goog.DebugLoader.prototype.writeScriptSrcNode_=function(b){goog.global.document.write('<script type="text/javascript" src="'+b+'">\x3c/script>')},goog.DebugLoader.prototype.appendScriptSrcNode_=function(b){var d=goog.global.document,h=d.createElement("script");h.type="text/javascript";h.src=b;h.defer=!1;h.async=!1;d.head.appendChild(h)},goog.DebugLoader.prototype.writeScriptTag_=function(b,d){if(this.inHtmlDocument()){var h=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&
"complete"==h.readyState){if(/\bdeps.js$/.test(b))return!1;throw Error('Cannot write "'+b+'" after document load');}void 0===d?goog.DebugLoader.IS_OLD_IE_?(this.oldIeWaiting_=!0,d=" onreadystatechange='goog.debugLoader_.onScriptLoad_(this, "+ ++this.lastNonModuleScriptIndex_+")' ",h.write('<script type="text/javascript" src="'+b+'"'+d+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?this.appendScriptSrcNode_(b):this.writeScriptSrcNode_(b):h.write('<script type="text/javascript">'+this.protectScriptTag_(d)+
"\x3c/script>");return!0}return!1},goog.DebugLoader.prototype.protectScriptTag_=function(b){return b.replace(/<\/(SCRIPT)/ig,"\\x3c/$1")},goog.DebugLoader.prototype.onScriptLoad_=function(b,d){"complete"==b.readyState&&this.lastNonModuleScriptIndex_==d&&this.loadQueuedModules_();return!0},goog.DebugLoader.prototype.getPathFromDeps_=function(b){return b in this.dependencies_.nameToPath?this.dependencies_.nameToPath[b]:null},goog.DebugLoader.prototype.getTranspiler=function(){return goog.transpiler_},
goog.DebugLoader.prototype.isProvided=function(b){return goog.isProvided_(b)},goog.DebugLoader.prototype.inHtmlDocument=function(){return goog.inHtmlDocument_()},goog.DebugLoader.prototype.logToConsole=function(b){goog.logToConsole_(b)},goog.DebugLoader.prototype.loadFileSync=function(b){return goog.loadFileSync_(b)},goog.DebugLoader.prototype.normalizePath=function(b){return goog.normalizePath_(b)},goog.debugLoader_=null,goog.registerDebugLoader=function(b){if(goog.debugLoader_)throw Error("Debug loader already registered!");
if(!(b instanceof goog.DebugLoader))throw Error("Not a goog.DebugLoader.");goog.debugLoader_=b},goog.getLoader_=function(){if(!goog.debugLoader_&&goog.DEBUG_LOADER)throw Error("Loaded debug loader file but no loader was registered!");goog.debugLoader_||(goog.debugLoader_=new goog.DebugLoader);return goog.debugLoader_},function(){if(goog.DEBUG_LOADER){var b=new goog.DebugLoader;b.importScript_(goog.basePath+goog.DEBUG_LOADER)}goog.global.CLOSURE_NO_DEPS||(b=b||new goog.DebugLoader,goog.DEBUG_LOADER||
goog.registerDebugLoader(b),b.importScript_(goog.basePath+"deps.js"))}());goog.exportSymbol("com.keyman.Util.prototype.attachDOMEvent",com.keyman.Util.prototype.attachDOMEvent);goog.exportSymbol("com.keyman.Util.prototype.detachDOMEvent",com.keyman.Util.prototype.detachDOMEvent);goog.exportSymbol("com.keyman.Util.prototype.getOption",com.keyman.Util.prototype.getOption);goog.exportSymbol("com.keyman.Util.prototype.setOption",com.keyman.Util.prototype.setOption);
goog.exportSymbol("com.keyman.Util.prototype.getAbsoluteX",com.keyman.Util.prototype._GetAbsoluteX);goog.exportSymbol("com.keyman.Util.prototype.getAbsoluteY",com.keyman.Util.prototype._GetAbsoluteY);goog.exportSymbol("com.keyman.Util.prototype.getAbsolute",com.keyman.Util.prototype._GetAbsolute);goog.exportSymbol("com.keyman.Util.prototype.createElement",com.keyman.Util.prototype.createElement);goog.exportSymbol("com.keyman.Util.prototype.getIEVersion",com.keyman.Util.prototype.getIEVersion);
goog.exportSymbol("com.keyman.Util.prototype.isTouchDevice",com.keyman.Util.prototype.isTouchDevice);goog.exportSymbol("com.keyman.Util.prototype.createShim",com.keyman.Util.prototype.createShim);goog.exportSymbol("com.keyman.Util.prototype.showShim",com.keyman.Util.prototype.showShim);goog.exportSymbol("com.keyman.Util.prototype.hideShim",com.keyman.Util.prototype.hideShim);goog.exportSymbol("com.keyman.Util.prototype.rgba",com.keyman.Util.prototype.rgba);
goog.exportSymbol("com.keyman.Util.prototype.addStyleSheet",com.keyman.Util.prototype.addStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.removeStyleSheet",com.keyman.Util.prototype.removeStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.linkStyleSheet",com.keyman.Util.prototype.linkStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.addFontFaceStyleSheet",com.keyman.Util.prototype.addFontFaceStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.loadCookie",com.keyman.Util.prototype.loadCookie);
goog.exportSymbol("com.keyman.Util.prototype.saveCookie",com.keyman.Util.prototype.saveCookie);goog.exportSymbol("com.keyman.Util.prototype.toNumber",com.keyman.Util.prototype.toNumber);goog.exportSymbol("com.keyman.Util.prototype.toFloat",com.keyman.Util.prototype.toFloat);goog.exportSymbol("com.keyman.Util.prototype.toNzString",com.keyman.Util.prototype.nzString);goog.exportSymbol("com.keyman.Util.prototype.alert",com.keyman.Util.prototype.alert);
(function(){var b=function(b,d,g){goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+d,g);goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+b,g)},d=function(b,d,g){goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+d,g);goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+b,g)};b("KSF","saveFocus",com.keyman.KeyboardInterface.prototype.saveFocus);b("KBR","beepReset",com.keyman.KeyboardInterface.prototype.beepReset);d("KT","insertText",com.keyman.KeyboardInterface.prototype.insertText);
d("KR","registerKeyboard",com.keyman.KeyboardInterface.prototype.registerKeyboard);d("KRS","registerStub",com.keyman.KeyboardInterface.prototype.registerStub);d("KC","context",com.keyman.KeyboardInterface.prototype.context);d("KN","nul",com.keyman.KeyboardInterface.prototype.nul);d("KCM","contextMatch",com.keyman.KeyboardInterface.prototype.contextMatch);d("KFCM","fullContextMatch",com.keyman.KeyboardInterface.prototype.fullContextMatch);d("KIK","isKeypress",com.keyman.KeyboardInterface.prototype.isKeypress);
d("KKM","keyMatch",com.keyman.KeyboardInterface.prototype.keyMatch);d("KSM","stateMatch",com.keyman.KeyboardInterface.prototype.stateMatch);d("KKI","keyInformation",com.keyman.KeyboardInterface.prototype.keyInformation);d("KDM","deadkeyMatch",com.keyman.KeyboardInterface.prototype.deadkeyMatch);d("KB","beep",com.keyman.KeyboardInterface.prototype.beep);d("KA","any",com.keyman.KeyboardInterface.prototype.any);d("KDC","deleteContext",com.keyman.KeyboardInterface.prototype.deleteContext);d("KO","output",
com.keyman.KeyboardInterface.prototype.output);d("KDO","deadkeyOutput",com.keyman.KeyboardInterface.prototype.deadkeyOutput);d("KIO","indexOutput",com.keyman.KeyboardInterface.prototype.indexOutput);d("KIFS","ifStore",com.keyman.KeyboardInterface.prototype.ifStore);d("KSETS","setStore",com.keyman.KeyboardInterface.prototype.setStore);d("KLOAD","loadStore",com.keyman.KeyboardInterface.prototype.loadStore);d("KSAVE","saveStore",com.keyman.KeyboardInterface.prototype.saveStore)})();
//# sourceMappingURL=keymanweb.js.map
