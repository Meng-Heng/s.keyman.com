var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,f,k){d!=Array.prototype&&d!=Object.prototype&&(d[f]=k.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,f,k,h){if(f){k=$jscomp.global;d=d.split(".");for(h=0;h<d.length-1;h++){var c=d[h];c in k||(k[c]={});k=k[c]}d=d[d.length-1];h=k[d];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(k,d,{configurable:!0,writable:!0,value:f})}};$jscomp.underscoreProtoCanBeSet=function(){var d={a:!0},f={};try{return f.__proto__=d,f.a}catch(k){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(d,f){d.__proto__=f;if(d.__proto__!==f)throw new TypeError(d+" is not extensible");return d}:null;$jscomp.polyfill("Object.setPrototypeOf",function(d){return d||$jscomp.setPrototypeOf},"es6","es5");$jscomp.owns=function(d,f){return Object.prototype.hasOwnProperty.call(d,f)};
$jscomp.polyfill("Object.assign",function(d){return d?d:function(d,k){for(var f=1;f<arguments.length;f++){var c=arguments[f];if(c)for(var a in c)$jscomp.owns(c,a)&&(d[a]=c[a])}return d}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var f=0;return $jscomp.iteratorPrototype(function(){return f<d.length?{done:!1,value:d[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();var f=d[Symbol.iterator];return f?f.call(d):$jscomp.arrayIterator(d)};
$jscomp.polyfill("WeakMap",function(d){function f(a){$jscomp.owns(a,h)||$jscomp.defineProperty(a,h,{value:{}})}function k(a){var b=Object[a];b&&(Object[a]=function(a){f(a);return b(a)})}if(function(){if(!d||!Object.seal)return!1;try{var a=Object.seal({}),g=Object.seal({}),e=new d([[a,2],[g,3]]);if(2!=e.get(a)||3!=e.get(g))return!1;e.delete(a);e.set(g,4);return!e.has(a)&&4==e.get(g)}catch(m){return!1}}())return d;var h="$jscomp_hidden_"+Math.random().toString().substring(2);k("freeze");k("preventExtensions");
k("seal");var c=0,a=function(a){this.id_=(c+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};a.prototype.set=function(a,g){f(a);if(!$jscomp.owns(a,h))throw Error("WeakMap key fail: "+a);a[h][this.id_]=g;return this};a.prototype.get=function(a){return $jscomp.owns(a,h)?a[h][this.id_]:void 0};a.prototype.has=function(a){return $jscomp.owns(a,h)&&$jscomp.owns(a[h],this.id_)};a.prototype.delete=
function(a){return $jscomp.owns(a,h)&&$jscomp.owns(a[h],this.id_)?delete a[h][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(d){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new d($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var m=b.entries(),c=m.next();if(c.done||c.value[0]!=a||"s"!=c.value[1])return!1;c=m.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!m.next().done?!1:!0}catch(l){return!1}}())return d;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var f=new WeakMap,k=function(b){this.data_={};this.head_=a();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var e;!(e=b.next()).done;)e=e.value,this.set(e[0],e[1])}};k.prototype.set=function(a,b){var e=h(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=b:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};k.prototype.delete=
function(a){a=h(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};k.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=a();this.size=0};k.prototype.has=function(a){return!!h(this,a).entry};k.prototype.get=function(a){return(a=h(this,a).entry)&&a.value};k.prototype.entries=function(){return c(this,function(a){return[a.key,
a.value]})};k.prototype.keys=function(){return c(this,function(a){return a.key})};k.prototype.values=function(){return c(this,function(a){return a.value})};k.prototype.forEach=function(a,b){for(var e=this.entries(),g;!(g=e.next()).done;)g=g.value,a.call(b,g[1],g[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var h=function(a,e){var m=e&&typeof e;"object"==m||"function"==m?f.has(e)?m=f.get(e):(m=""+ ++b,f.set(e,m)):m="p_"+e;var g=a.data_[m];if(g&&$jscomp.owns(a.data_,m))for(a=0;a<g.length;a++){var c=
g[a];if(e!==e&&c.key!==c.key||e===c.key)return{id:m,list:g,index:a,entry:c}}return{id:m,list:g,index:-1,entry:void 0}},c=function(a,b){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:b(e)};e=null}return{done:!0,value:void 0}})},a=function(){var a={};return a.previous=a.next=a.head=a},b=0;return k},"es6","es3");$jscomp.polyfill("Number.MIN_SAFE_INTEGER",function(){return-9007199254740991},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(d){return d?d:function(d,k,h){var c=this.length||0;0>k&&(k=Math.max(0,c+k));if(null==h||h>c)h=c;h=Number(h);0>h&&(h=Math.max(0,c+h));for(k=Number(k||0);k<h;k++)this[k]=d;return this}},"es6","es3");
String.kmwFromCharCode=function(d){var f=[],k;for(k=0;k<arguments.length;k++){var h=Number(arguments[k]);if(!isFinite(h)||0>h||1114111<h||Math.floor(h)!==h)throw new RangeError("Invalid code point "+h);65536>h?f.push(h):(h-=65536,f.push((h>>10)+55296),f.push(h%1024+56320))}return String.fromCharCode.apply(void 0,f)};
String.prototype.kmwCharCodeAt=function(d){var f=String(this),k=0;if(0>d||d>=f.length)return NaN;for(var h=0;h<d;h++)if(k=f.kmwNextChar(k),null===k)return NaN;d=f.charCodeAt(k);return 55296<=d&&56319>=d&&f.length>k+1&&(f=f.charCodeAt(k+1),56320<=f&&57343>=f)?(d-55296<<10)+(f-56320)+65536:d};String.prototype.kmwIndexOf=function(d,f){var k=String(this);d=k.indexOf(d,f);if(0>d)return d;for(var h=f=0;null!==h&&h<d;h=k.kmwNextChar(h))f++;return f};
String.prototype.kmwLastIndexOf=function(d,f){var k=String(this);d=k.lastIndexOf(d,f);if(0>d)return d;for(var h=f=0;null!==h&&h<d;h=k.kmwNextChar(h))f++;return f};String.prototype.kmwLength=function(){var d=String(this);if(0==d.length)return 0;for(var f=0,k=0;null!==k;f++)k=d.kmwNextChar(k);return f};String.prototype.kmwSlice=function(d,f){var k=String(this);d=k.kmwCodePointToCodeUnit(d);f=k.kmwCodePointToCodeUnit(f);return null===d||null===f?"":k.slice(d,f)};
String.prototype.kmwSubstr=function(d,f){var k=String(this);0>d&&(d=k.kmwLength()+d);0>d&&(d=0);var h=k.kmwCodePointToCodeUnit(d),c=h;if(null===h)return"";if(2>arguments.length)c=k.length;else for(var a=0;a<f;a++)c=k.kmwNextChar(c);return null===c?k.substring(h):k.substring(h,c)};
String.prototype.kmwSubstring=function(d,f){var k=String(this);if("undefined"==typeof f)d=k.kmwCodePointToCodeUnit(d),f=k.length;else{if(d>f){var h=d;d=f;f=h}d=k.kmwCodePointToCodeUnit(d);f=k.kmwCodePointToCodeUnit(f)}if(isNaN(d)||null===d)d=0;if(isNaN(f)||null===f)f=k.length;return k.substring(d,f)};
String.prototype.kmwNextChar=function(d){var f=String(this);if(null===d||0>d||d>=f.length-1)return null;var k=f.charCodeAt(d);return 55296<=k&&56319>=k&&f.length>d+1&&(k=f.charCodeAt(d+1),56320<=k&&57343>=k)?d==f.length-2?null:d+2:d+1};String.prototype.kmwPrevChar=function(d){var f=String(this);if(null==d||0>=d||d>f.length)return null;var k=f.charCodeAt(d-1);return 56320<=k&&57343>=k&&1<d&&(f=f.charCodeAt(d-2),55296<=f&&56319>=f)?d-2:d-1};
String.prototype.kmwCodePointToCodeUnit=function(d){if(null===d)return null;var f=String(this),k=0;if(0>d){k=f.length;for(var h=0;h>d;h--)k=f.kmwPrevChar(k);return k}if(d==f.kmwLength())return f.length;for(h=0;h<d;h++)k=f.kmwNextChar(k);return k};String.prototype.kmwCodeUnitToCodePoint=function(d){var f=String(this);return null===d?null:0==d?0:0>d?f.substr(d).kmwLength():f.substr(0,d).kmwLength()};String.prototype.kmwCharAt=function(d){var f=String(this);return 0<=d?f.kmwSubstr(d,1):""};
String.prototype.kmwBMPNextChar=function(d){var f=String(this);return 0>d||d>=f.length-1?null:d+1};String.prototype.kmwBMPPrevChar=function(d){var f=String(this);return 0>=d||d>f.length?null:d-1};String.prototype.kmwBMPCodePointToCodeUnit=function(d){return d};String.prototype.kmwBMPCodeUnitToCodePoint=function(d){return d};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(d,f){var k=String(this);return-1<d?k.substr(d,f):k.substr(k.length+d,-d)};
String.kmwEnableSupplementaryPlane=function(d){var f=String.prototype;String._kmwFromCharCode=d?String.kmwFromCharCode:String.fromCharCode;f._kmwCharAt=d?f.kmwCharAt:f.charAt;f._kmwCharCodeAt=d?f.kmwCharCodeAt:f.charCodeAt;f._kmwIndexOf=d?f.kmwIndexOf:f.indexOf;f._kmwLastIndexOf=d?f.kmwLastIndexOf:f.lastIndexOf;f._kmwSlice=d?f.kmwSlice:f.slice;f._kmwSubstring=d?f.kmwSubstring:f.substring;f._kmwSubstr=d?f.kmwSubstr:f.kmwBMPSubstr;f._kmwLength=d?f.kmwLength:f.kmwBMPLength;f._kmwNextChar=d?f.kmwNextChar:
f.kmwBMPNextChar;f._kmwPrevChar=d?f.kmwPrevChar:f.kmwBMPPrevChar;f._kmwCodePointToCodeUnit=d?f.kmwCodePointToCodeUnit:f.kmwBMPCodePointToCodeUnit;f._kmwCodeUnitToCodePoint=d?f.kmwCodeUnitToCodePoint:f.kmwBMPCodeUnitToCodePoint};var com;
(function(d){(function(d){(function(d){var f=function(){function a(b,g){this.p=b;this.d=g;this.o=a.ordinalSeed++}a.prototype.match=function(a,g){return this.p==a&&this.d==g};a.prototype.set=function(){this.matched=1};a.prototype.reset=function(){this.matched=0};a.prototype.before=function(a){return this.o<a.o};a.prototype.clone=function(){var b=new a(this.p,this.d);b.o=this.o;return b};a.ordinalSeed=0;a.sortFunc=function(a,g){return a.p!=g.p?g.p-a.p:g.o-a.o};return a}();d.Deadkey=f;var c=function(){function a(){this.dks=
[]}a.prototype.toSortedArray=function(){this.dks=this.dks.sort(f.sortFunc);return[].concat(this.dks)};a.prototype.clone=function(){var b=new a,g=this.toSortedArray();b.dks=[];g.forEach(function(a){b.dks.push(a.clone())});return b};a.prototype.isMatch=function(a,g,e){if(0==this.dks.length)return!1;g=a-g;for(a=0;a<this.dks.length;a++)if(this.dks[a].match(g,e)&&!this.dks[a].matched)return this.dks[a].set(),!0;this.resetMatched();return!1};a.prototype.add=function(a){this.dks=this.dks.concat(a)};a.prototype.remove=
function(a){a=this.dks.indexOf(a);this.dks.splice(a,1)};a.prototype.clear=function(){this.dks=[]};a.prototype.resetMatched=function(){for(var a=0,g=this.dks;a<g.length;a++)g[a].reset()};a.prototype.deleteMatched=function(){for(var a=0;a<this.dks.length;a++)this.dks[a].matched&&this.dks.splice(a--,1)};a.prototype.adjustPositions=function(a,g){if(0!=g)for(var e=0,b=this.dks;e<b.length;e++){var c=b[e];c.p>a&&(c.p+=g)}};a.prototype.count=function(){return this.dks.length};return a}();d.DeadkeyTracker=
c})(d.text||(d.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));(function(d){(function(d){(function(d){var f=function(){return function(){}}();d.KeyEvent=f})(d.text||(d.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
var __extends=this&&this.__extends||function(){var d=function(f,k){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,c){d.__proto__=c}||function(d,c){for(var a in c)c.hasOwnProperty(a)&&(d[a]=c[a])};return d(f,k)};return function(f,k){function h(){this.constructor=f}d(f,k);f.prototype=null===k?Object.create(k):(h.prototype=k.prototype,new h)}}();
(function(d){(function(d){var f;(function(d){var c=function(){return function(a,b,g){this.insert=a;this.deleteLeft=b;this.deleteRight=g||0}}(),a=function(){function a(e,b,g,c,d){this.token=a.tokenSeed++;this.keystroke=e;this.transform=b;this.preInput=g;this.removedDks=c;this.insertedDks=d}a.tokenSeed=0;return a}();d.Transcription=a;var b=function(){function e(){this._dks=new f.DeadkeyTracker}e.prototype.deadkeys=function(){return this._dks};e.prototype.hasDeadkeyMatch=function(a,e){return this.deadkeys().isMatch(this.getDeadkeyCaret(),
a,e)};e.prototype.insertDeadkeyBeforeCaret=function(a){a=new d.Deadkey(this.getDeadkeyCaret(),a);this.deadkeys().add(a)};e.prototype.adjustDeadkeys=function(a){this.deadkeys().adjustPositions(this.getDeadkeyCaret(),a)};e.prototype.setDeadkeys=function(a){this._dks=a.clone()};e.prototype.buildTransformFrom=function(a){for(var e=this.getText(),b=a.getText(),g=a.getDeadkeyCaret(),m=this.getDeadkeyCaret(),d=0;d<g&&b._kmwCharAt(d)==e._kmwCharAt(d);d++);a=g-d;d=e._kmwSubstr(d,m-d);e=e._kmwLength()-m;b=
b._kmwLength()-g;return new c(d,a,b-e)};e.prototype.buildTranscriptionFrom=function(e,b){var m=this.buildTransformFrom(e),c=e.deadkeys().toSortedArray(),t=this.deadkeys().toSortedArray(),d=[],f=[],h=[];c.forEach(function(a){for(var e=0;e<t.length;e++)if(t[e].d==a.d&&t[e].o==a.o){d.push(a);return}f.push(a)});t.forEach(function(a){for(var e=0;e<d.length;e++)if(d[e].d==a.d&&d[e].o==a.o)return;h.push(a)});return new a(b,m,g.from(e),f,h)};e.prototype.saveProperties=function(){};e.prototype.restoreProperties=
function(){};return e}();d.OutputTarget=b;var g=function(a){function e(e,b){var g=a.call(this)||this;g.text=e?e:"";e=g.text._kmwLength();g.caretIndex=b?b:e;return g}__extends(e,a);e.from=function(a){var b=a.getTextBeforeCaret(),g=b._kmwLength();b=new e(b+a.getTextAfterCaret(),g);b.setDeadkeys(a.deadkeys());return b};e.prototype.getElement=function(){return null};e.prototype.clearSelection=function(){};e.prototype.invalidateSelection=function(){};e.prototype.hasSelection=function(){return!0};e.prototype.getDeadkeyCaret=
function(){return this.caretIndex};e.prototype.setDeadkeyCaret=function(a){if(0>a||a>this.text._kmwLength())throw Error("Provided caret index is out of range.");this.caretIndex=a};e.prototype.getTextBeforeCaret=function(){return this.text.kmwSubstr(0,this.caretIndex)};e.prototype.getTextAfterCaret=function(){return this.text.kmwSubstr(this.caretIndex)};e.prototype.getText=function(){return this.text};e.prototype.deleteCharsBeforeCaret=function(a){0<=a&&(this.text=this.text.kmwSubstr(0,this.caretIndex-
a)+this.getTextAfterCaret(),this.caretIndex-=a)};e.prototype.insertTextBeforeCaret=function(a){this.text=this.getTextBeforeCaret()+a+this.getTextAfterCaret();this.caretIndex+=a.kmwLength()};return e}(b);d.Mock=g})(f=d.text||(d.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));(function(d){(function(d){var f=function(){return function(d,c,a){this.interface=d;this.keyboard=c;this.touchEnabled=a||!1}}();d.AttachmentInfo=f})(d.keyman||(d.keyman={}))})(com||(com={}));
function finallyConstructor(d){var f=this.constructor;return this.then(function(k){return f.resolve(d()).then(function(){return k})},function(k){return f.resolve(d()).then(function(){return f.reject(k)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(d,f){return function(){d.apply(f,arguments)}}
function Promise(d){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof d)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(d,this)}
function handle(d,f){for(;3===d._state;)d=d._value;0===d._state?d._deferreds.push(f):(d._handled=!0,Promise._immediateFn(function(){var k=1===d._state?f.onFulfilled:f.onRejected;if(null===k)(1===d._state?resolve:reject)(f.promise,d._value);else{try{var h=k(d._value)}catch(c){reject(f.promise,c);return}resolve(f.promise,h)}}))}
function resolve(d,f){try{if(f===d)throw new TypeError("A promise cannot be resolved with itself.");if(f&&("object"===typeof f||"function"===typeof f)){var k=f.then;if(f instanceof Promise){d._state=3;d._value=f;finale(d);return}if("function"===typeof k){doResolve(bind(k,f),d);return}}d._state=1;d._value=f;finale(d)}catch(h){reject(d,h)}}function reject(d,f){d._state=2;d._value=f;finale(d)}
function finale(d){2===d._state&&0===d._deferreds.length&&Promise._immediateFn(function(){d._handled||Promise._unhandledRejectionFn(d._value)});for(var f=0,k=d._deferreds.length;f<k;f++)handle(d,d._deferreds[f]);d._deferreds=null}function Handler(d,f,k){this.onFulfilled="function"===typeof d?d:null;this.onRejected="function"===typeof f?f:null;this.promise=k}
function doResolve(d,f){var k=!1;try{d(function(d){k||(k=!0,resolve(f,d))},function(d){k||(k=!0,reject(f,d))})}catch(h){k||(k=!0,reject(f,h))}}Promise.prototype["catch"]=function(d){return this.then(null,d)};Promise.prototype.then=function(d,f){var k=new this.constructor(noop);handle(this,new Handler(d,f,k));return k};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(d){return new Promise(function(f,k){function h(b,e){try{if(e&&("object"===typeof e||"function"===typeof e)){var g=e.then;if("function"===typeof g){g.call(e,function(a){h(b,a)},k);return}}c[b]=e;0===--a&&f(c)}catch(t){k(t)}}if(!d||"undefined"===typeof d.length)throw new TypeError("Promise.all accepts an array");var c=Array.prototype.slice.call(d);if(0===c.length)return f([]);for(var a=c.length,b=0;b<c.length;b++)h(b,c[b])})};
Promise.resolve=function(d){return d&&"object"===typeof d&&d.constructor===Promise?d:new Promise(function(f){f(d)})};Promise.reject=function(d){return new Promise(function(f,k){k(d)})};Promise.race=function(d){return new Promise(function(f,k){for(var h=0,c=d.length;h<c;h++)d[h].then(f,k)})};Promise._immediateFn="function"===typeof setImmediate&&function(d){setImmediate(d)}||function(d){setTimeoutFunc(d,0)};
Promise._unhandledRejectionFn=function(d){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",d)};var globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
(function(d){d=d.keyman||(d.keyman={});(d.environment||(d.environment={})).VERSION="12.0"})(com||(com={}));(function(d){d.keyman||(d.keyman={})})(com||(com={}));
(function(d){d=d.keyman||(d.keyman={});(d.text||(d.text={})).Codes={modifierCodes:{LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384},modifierBitmasks:{ALL:127,ALT_GR_SIM:5,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112},stateBitmasks:{ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288},keyCodes:{K_BKSP:8,K_TAB:9,K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,K_SPACE:32,
K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,K_NP2:98,K_NP3:99,K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,K_NPPLUS:107,
K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,K_QUOTE:222,K_oE2:226,K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,K_CURRENCIES:50005,K_UPPER:50006,
K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012},codesUS:[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']]}})(com||(com={}));
(function(d){(function(f){(function(k){var h=function(){return function(){}}();k.LegacyKeyEvent=h;h=function(){function c(){this.stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};this.modStateFlags=0;this.swallowKeypress=!1}c.prototype.defaultKeyOutput=function(a,b,g,e,m){var c=d.keyman.singleton,l=c.domManager,h="",r=!1,n=m&&"undefined"!=typeof m.base;0==g?r=!0:g==k.Codes.modifierCodes.SHIFT?(r=!0,g=1):console.warn("KMW only defines default key output for the 'default' and 'shift' layers!");if(n||e)switch((n=
k.Codes.keyCodes[a])||(n=b),n){case k.Codes.keyCodes.K_BKSP:c.interface.defaultBackspace();break;case k.Codes.keyCodes.K_TAB:l.moveToNext(g);break;case k.Codes.keyCodes.K_TABBACK:l.moveToNext(!0);break;case k.Codes.keyCodes.K_TABFWD:l.moveToNext(!1);break;case k.Codes.keyCodes.K_ENTER:if("TEXTAREA"==m.nodeName||"undefined"!=typeof m.base&&"TEXTAREA"==m.base.nodeName)return"\n";if(e){if(f.dom.Utils.instanceof(m,"HTMLInputElement"))var q=m;else"undefined"!=typeof m.base&&f.dom.Utils.instanceof(m.base,
"HTMLInputElement")&&(q=m.base);!q||"search"!=q.type&&"submit"!=q.type?l.moveToNext(!1):(q.disabled=!1,q.form.submit())}break;case k.Codes.keyCodes.K_SPACE:return" "}if("U_"==a.substr(0,2))a=parseInt(a.substr(2,6),16),0<=a&&31>=a||128<=a&&159>=a?console.log("Suppressing Unicode control code: U_00"+a.toString(16)):h=String.kmwFromCharCode(a);else if(r)try{b>=k.Codes.keyCodes.K_0&&b<=k.Codes.keyCodes.K_9?h=k.Codes.codesUS[g][0][b-k.Codes.keyCodes.K_0]:b>=k.Codes.keyCodes.K_A&&b<=k.Codes.keyCodes.K_Z?
h=String.fromCharCode(b+(g?0:32)):b>=k.Codes.keyCodes.K_COLON&&b<=k.Codes.keyCodes.K_BKQUOTE?h=k.Codes.codesUS[g][1][b-k.Codes.keyCodes.K_COLON]:b>=k.Codes.keyCodes.K_LBRKT&&b<=k.Codes.keyCodes.K_QUOTE&&(h=k.Codes.codesUS[g][2][b-k.Codes.keyCodes.K_LBRKT])}catch(u){console.error("Error detected with default mapping for key:  code = "+b+", shift state = "+(1==g?"shift":"default"))}return h};c.prototype._GetKeyEventProperties=function(a,b){b=new k.KeyEvent;var g=d.keyman.singleton;a=g._GetEventObject(a);
b.Ltarg=g.util.eventTarget(a);if(null==b.Ltarg||!0===a.cancelBubble)return null;3==b.Ltarg.nodeType&&(b.Ltarg=b.Ltarg.parentNode);b.Lcode=this._GetEventKeyCode(a);if(null==b.Lcode)return null;var e=this.modStateFlags,m=!1,c=!1;var l=k.Codes.keyCodes;switch(b.Lcode){case l.K_CTRL:case l.K_LCTRL:case l.K_RCTRL:case l.K_CONTROL:case l.K_LCONTROL:case l.K_RCONTROL:m=!0;break;case l.K_LMENU:case l.K_RMENU:case l.K_ALT:case l.K_LALT:case l.K_RALT:c=!0}l=0|(a.getModifierState("Shift")?16:0);var h=k.Codes.modifierCodes;
a.getModifierState("Control")&&(l|=0!=a.location&&m?1==a.location?h.LCTRL:h.RCTRL:e&3);a.getModifierState("Alt")&&(l|=0!=a.location&&c?1==a.location?h.LALT:h.RALT:e&12);b.Lstates=0;b.Lstates|=a.getModifierState("CapsLock")?h.CAPS:h.NO_CAPS;b.Lstates|=a.getModifierState("NumLock")?h.NUM_LOCK:h.NO_NUM_LOCK;b.Lstates|=a.getModifierState("ScrollLock")||a.getModifierState("Scroll")?h.SCROLL_LOCK:h.NO_SCROLL_LOCK;l|=b.Lstates;b.LmodifierChange=this.modStateFlags!=l;this.modStateFlags=l;m=h.RALT|h.LCTRL;
(e&m)==m&&(l&m)!=m&&(l&=~m);l&h.RALT&&(l&=~h.LCTRL);e=k.Codes.modifierBitmasks;g.keyboardManager.isChiral()?(b.Lmodifiers=l&e.CHIRAL,f.osk.Layouts.emulatesAltGr()&&(b.Lmodifiers&e.ALT_GR_SIM)==e.ALT_GR_SIM&&(b.Lmodifiers^=e.ALT_GR_SIM,b.Lmodifiers|=h.RALT)):b.Lmodifiers=l&16|(l&(h.LCTRL|h.RCTRL)?32:0)|(l&(h.LALT|h.RALT)?64:0);(g=g.keyboardManager.activeKeyboard)&&g.KM&&this.setMnemonicCode(b,a.getModifierState("Shift"),a.getModifierState("CapsLock"));b.LisVirtualKeyCode="undefined"!=typeof a.charCode&&
null!=a.charCode&&(0==a.charCode||0!=(b.Lmodifiers&111));b.LisVirtualKey=b.LisVirtualKeyCode||"keypress"!=a.type;return b};c.getOutputTarget=function(a){var b=d.keyman.singleton;if(!a&&!b.isHeadless&&(a=b.domManager.getLastActiveElement(),!a))return null;if(a._kmwAttachment&&a._kmwAttachment.interface)return a._kmwAttachment.interface;throw Error("OSK could not find element output target data!");};c.prototype.clickKey=function(a){var b=d.keyman.singleton,g=b.domManager.getLastActiveElement(),e=b.keyboardManager.activeKeyboard,
m=b.interface,t=b.util.device.formFactor;if(null!=g){var l=a.key.spec.layer||"",h=a.keyId.toUpperCase();this.getModifierState(b.osk.vkbd.layerId);var r=a.key.spec.nextlayer;b.domManager.initActiveElement(g);if("K_LOPT"==h||"K_ROPT"==h)return b.osk.vkbd.optionKey(a,h,!0),!0;b.osk.vkbd.highlightKey(a,!1);if("desktop"==t&&this.selectLayer(h,r))return!0;b.uiManager.setActivatingUI(!0);d.keyman.DOMEventHandlers.states._IgnoreNextSelChange=100;b.domManager.focusLastActiveElement();b.domManager._IsMozillaEditableIframe(g,
0)&&(g=g.contentDocument.documentElement);d.keyman.DOMEventHandlers.states._IgnoreNextSelChange=0;var n=c.getOutputTarget(g);n.invalidateSelection();n.deadkeys().deleteMatched();var q={Ltarg:g,Lmodifiers:0,Lstates:0,Lcode:k.Codes.keyCodes[h],LisVirtualKey:!0,vkCode:0};q.Lstates|=this.stateKeys.K_CAPS?k.Codes.modifierCodes.CAPS:k.Codes.modifierCodes.NO_CAPS;q.Lstates|=this.stateKeys.K_NUMLOCK?k.Codes.modifierCodes.NUM_LOCK:k.Codes.modifierCodes.NO_NUM_LOCK;q.Lstates|=this.stateKeys.K_SCROLL?k.Codes.modifierCodes.SCROLL_LOCK:
k.Codes.modifierCodes.NO_SCROLL_LOCK;"U_"==h.substr(0,2)&&(q.LisVirtualKey=!1);"undefined"==typeof q.Lcode&&(q.Lcode=this.getVKDictionaryCode(h),q.Lcode||(q.Lcode=1));a=this.getModifierState(a.key.spec.layer||l);q.Lmodifiers=a;(q.Lmodifiers&k.Codes.modifierBitmasks.ALT_GR_SIM)==k.Codes.modifierBitmasks.ALT_GR_SIM&&f.osk.Layouts.emulatesAltGr()&&(q.Lmodifiers&=~k.Codes.modifierBitmasks.ALT_GR_SIM,q.Lmodifiers|=k.Codes.modifierCodes.RALT);!e||!e.KM||e.KVKL&&"desktop"!=t?q.vkCode=q.Lcode:q.Lcode!=k.Codes.keyCodes.K_SPACE&&
(q.vkCode=q.Lcode,this.setMnemonicCode(q,-1!=l.indexOf("shift"),this.stateKeys.K_CAPS));"undefined"==typeof e.KM&&(q.Lcode=b.keyMapManager._USKeyCodeToCharCode(q),q.LisVirtualKey=!1);if(!e||0!=q.Lcode&&!m.processKeystroke(b.util.device,n,q))switch(q.Lcode=q.vkCode,h){case "K_CAPS":case "K_NUMLOCK":case "K_SCROLL":this.stateKeys[h]=!this.stateKeys[h];d.keyman.singleton.osk._Show();break;default:(g=this.defaultKeyOutput(h,q.Lcode,a,!0,g))&&m.output(0,n,g)}this.selectLayer(h,r)}b.uiManager.setActivatingUI(!1);
return!0};c.prototype.setMnemonicCode=function(a,b,g){a.Lcode!=k.Codes.keyCodes.K_SPACE&&(b=this.defaultKeyOutput("K_xxxx",a.Lcode,b?16:0,!1,null))&&(a.Lcode=b.charCodeAt(0));g&&(65<=a.Lcode&&90>=a.Lcode||97<=a.Lcode&&122>=a.Lcode)&&(a.Lmodifiers^=16,a.Lcode^=32)};c.prototype.getModifierState=function(a){var b=0;0<=a.indexOf("shift")&&(b|=k.Codes.modifierCodes.SHIFT);var g=!1;0<=a.indexOf("leftctrl")&&(b|=k.Codes.modifierCodes.LCTRL,g=!0);0<=a.indexOf("rightctrl")&&(b|=k.Codes.modifierCodes.RCTRL,
g=!0);0<=a.indexOf("ctrl")&&!g&&(b|=k.Codes.modifierCodes.CTRL);g=!1;0<=a.indexOf("leftalt")&&(b|=k.Codes.modifierCodes.LALT,g=!0);0<=a.indexOf("rightalt")&&(b|=k.Codes.modifierCodes.RALT,g=!0);0<=a.indexOf("alt")&&!g&&(b|=k.Codes.modifierCodes.ALT);return b};c.prototype.getVKDictionaryCode=function(a){var b=d.keyman.singleton.keyboardManager.activeKeyboard;if(!b.VKDictionary){var g=[];if("string"==typeof b.KVKD)for(var e=b.KVKD.split(" "),m=0;m<e.length;m++)g[e[m].toUpperCase()]=m+256;b.VKDictionary=
g}return(a=b.VKDictionary[a.toUpperCase()])?a:0};c.prototype._UpdateVKShift=function(a,b,g){var e=0,m=d.keyman.singleton,c=["CAPS","NUM_LOCK","SCROLL_LOCK"],l=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(a)for(e=a.Lmodifiers,b=a.Lstates,m.keyboardManager.isChiral()&&f.osk.Layouts.emulatesAltGr()&&(this.modStateFlags&k.Codes.modifierBitmasks.ALT_GR_SIM)==k.Codes.modifierBitmasks.ALT_GR_SIM&&(e|=k.Codes.modifierBitmasks.ALT_GR_SIM,e&=~k.Codes.modifierCodes.RALT),a=0;a<c.length;a++)b&k.Codes.stateBitmasks[c[a]]&&
(this.stateKeys[l[a]]=b&k.Codes.modifierCodes[c[a]]);else if(g)for(e|=b,a=0;a<c.length;a++)b&k.Codes.stateBitmasks[c[a]]&&(this.stateKeys[l[a]]=!0);else for(e&=~b,a=0;a<c.length;a++)b&k.Codes.stateBitmasks[c[a]]&&(this.stateKeys[l[a]]=!1);m.osk.vkbd&&m.osk.vkbd.showLayer(this.getLayerId(e));m.osk._Visible&&m.osk._Show();return!0};c.prototype.getLayerId=function(a){return f.osk.Layouts.getLayerId(a)};c.prototype.selectLayer=function(a,b){var g=2>arguments.length?null:b,e=d.keyman.singleton.keyboardManager.isChiral();
"number"==typeof g&&(g=this.getLayerId(16*g));if(!g)switch(a){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":g="shift";break;case "K_LCONTROL":case "K_LCTRL":if(e){g="leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(e){g="rightctrl";break}case "K_CTRL":g="ctrl";break;case "K_LMENU":case "K_LALT":if(e){g="leftalt";break}case "K_RMENU":case "K_RALT":if(e){g="rightalt";break}case "K_ALT":g="alt";break;case "K_ALTGR":g=e?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":g=
"default"}if(!g)return!1;this.updateLayer(g);d.keyman.singleton.osk._Show();return!0};c.prototype.updateLayer=function(a){var b=d.keyman.singleton,g=b.osk.vkbd;if(g){var e=g.layerId,m=e;if(a==e&&"desktop"!=b.util.device.formFactor)return!1;var c=a;if("desktop"==b.util.device.formFactor){var l="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(b=0;b<l.length;b++)c=c.replace(l[b]+"-",""),c=c.replace(l[b],"");if("default"==e||"numeric"==e||"symbol"==e||"currency"==e||""!=c)m=a;else{e=
this.getModifierState(m);for(b=0;b<l.length;b++)m=m.replace(l[b]+"-",""),m=m.replace(l[b],"");switch(a){case "shift":e^=k.Codes.modifierCodes.SHIFT;break;case "leftctrl":e^=k.Codes.modifierCodes.LCTRL;break;case "rightctrl":e^=k.Codes.modifierCodes.RCTRL;break;case "ctrl":e^=k.Codes.modifierCodes.CTRL;break;case "leftalt":e^=k.Codes.modifierCodes.LALT;break;case "rightalt":e^=k.Codes.modifierCodes.RALT;break;case "alt":e^=k.Codes.modifierCodes.ALT;break;default:m=a}"default"!=m&&(m=""==m?this.getLayerId(e):
this.getLayerId(e)+"-"+m)}""==m&&(m="default")}else m=a;g&&(g.showLayer(m)||g.showLayer("default"))}};c.prototype._GetEventKeyCode=function(a){return a.keyCode?a.keyCode:a.which?a.which:null};c.prototype.doModifierPress=function(a,b){b=d.keyman.singleton;switch(a.Lcode){case 8:c.getOutputTarget(a.Ltarg).deadkeys().clear();break;case 16:case 17:case 18:case 20:case 144:case 145:return b.keyboardManager.notifyKeyboard(a.Lcode,a.Ltarg,1),b.util.device.touchable?!0:this._UpdateVKShift(a,a.Lcode-15,1)}a.LmodifierChange&&
(b.keyboardManager.notifyKeyboard(0,a.Ltarg,1),this._UpdateVKShift(a,0,1));return!1};c.prototype.keyDown=function(a){var b=d.keyman.singleton,g=b.keyboardManager.activeKeyboard,e=b.util,m=b["interface"],t=b.keyMapManager;this.swallowKeypress=!1;var l=this._GetKeyEventProperties(a,!0);if(null==l||this.doModifierPress(l,!0))return!0;!window.event&&t.browserMap.FF["k"+l.Lcode]&&(l.Lcode=t.browserMap.FF["k"+l.Lcode]);b=c.getOutputTarget(l.Ltarg);if(g.KM){if(8==l.Lcode)return this.swallowKeypress=!0,m.processKeystroke(e.physicalDevice,
b,l)||m.defaultBackspace(),!1;this.swallowKeypress=!1;f=f||m.processKeystroke(e.physicalDevice,b,l)}else{var f=0,h=t.languageMap[d.keyman.osk.Layouts._BaseLayout];h&&h["k"+l.Lcode]&&(l.Lcode=h["k"+l.Lcode]);"undefined"!=typeof g.KM||l.Lmodifiers&96||(t={Lcode:t._USKeyCodeToCharCode(l),Ltarg:l.Ltarg,Lmodifiers:0,LisVirtualKey:0},m.processKeystroke(e.physicalDevice,b,t)&&(f=1));f=f||m.processKeystroke(e.physicalDevice,b,l);8==l.Lcode&&!f&&null!=l.Ltarg.className&&0<=l.Ltarg.className.indexOf("keymanweb-input")&&
m.defaultBackspace()}!f&&l.Lcode>=k.Codes.keyCodes.K_NP0&&l.Lcode<=k.Codes.keyCodes.K_NPSLASH&&!g.KM&&(m.output(0,b,String._kmwFromCharCode(106>l.Lcode?l.Lcode-48:l.Lcode-64)),f=1);if(f)return a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),this.swallowKeypress=a?0!=this._GetEventKeyCode(a):!1,!1;this.swallowKeypress=!1;return 8==l.Lcode&&null!=l.Ltarg.className&&0<=l.Ltarg.className.indexOf("keymanweb-input")?!1:"undefined"!=typeof l.Ltarg.base&&(a=this.defaultKeyOutput("",l.Lcode,
l.Lmodifiers,!1,l.Ltarg))?(m.output(0,b,a),!1):!0};c.prototype.keyUp=function(a){a=this._GetKeyEventProperties(a,!1);return null==a?!0:this.doModifierPress(a,!1)};c.prototype.keyPress=function(a){var b=d.keyman.singleton,g=this._GetKeyEventProperties(a);if(null==g||g.LisVirtualKey)return!0;if(!b.keyboardManager.activeKeyboard.KM){if(!this.swallowKeypress||32>g.Lcode||b._BrowserIsSafari&&63232<g.Lcode&&63744>g.Lcode)return!0;if(a=b._GetEventObject(a))a.returnValue=!1;return!1}var e=c.getOutputTarget(g.Ltarg);
if(this.swallowKeypress||b["interface"].processKeystroke(b.util.physicalDevice,e,g))return this.swallowKeypress=!1,a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),!1;this.swallowKeypress=!1;return!0};return c}();k.Processor=h})(f.text||(f.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){var f=function(){function a(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._SelectionControl=this._Selection=null}a.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),1E3)};return a}();d.CommonDOMStates=f;var h=function(){function a(b){this.setFocus=function(a){}.bind(this);this.setBlur=function(a){}.bind(this);this._ControlFocus=function(b){var e=this.keyman.util.device,g=this.keyman.osk;
b=this.keyman._GetEventObject(b);b=this.keyman.util.eventTarget(b);if(null==b||e.touchable&&(null==b.className||0>b.className.indexOf("keymanweb-input")))return!0;b.nodeName.toLowerCase();if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLInputElement){var d=b.type.toLowerCase();if("text"!=d&&"search"!=d)return!0}else if(!(!e.touchable&&b.isContentEditable||b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement))return!0;c.states.activeElement=b;3==b.nodeType&&
(b=b.parentNode);d=b;(null==b.className||0>b.className.indexOf("keymanweb-input"))&&this instanceof c&&this.scrollBody(b);b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(b),b=b.contentWindow.document.body);var l=a.states.lastActiveElement;a.states.lastActiveElement=b;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings():this._FocusKeyboardSettings(l?!1:!0);if(this._CommonFocusHelper(b))return!0;b.ownerDocument&&b instanceof
b.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(b);this.doControlFocused(d,a.states.lastActiveElement);e.touchable?g._Enabled=!0:g.ready&&(this.keyman.keyboardManager.isCJK()&&(g._Enabled=!0),g._Enabled?g._Show():g._Hide(!1));return!0}.bind(this);this._ControlBlur=function(b){b=this.keyman._GetEventObject(b);var e=this.keyman.util.eventTarget(b);if(null==e)return!0;d.dom.Utils.instanceof(a.states.activeElement,"TouchAliasElement")&&a.states.activeElement.hideCaret();a.states.activeElement=
null;3==e.nodeType&&(e=e.parentNode);e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLIFrameElement&&(e=e.contentWindow.document);this._BlurKeyboardSettings();a.states.lastActiveElement=e;this.keyman.uiManager.justActivated=!1;var g=this.keyman.uiManager.isActivating;g||this.keyman.keyboardManager.notifyKeyboard(0,e,0);this.doControlBlurred(e,b,g);this.keyman.osk.ready&&!g&&this.keyman.osk._Hide(!1);this.doChangeEvent(e);this.keyman.interface.resetContext();return!0}.bind(this);this._SelectionChange=
function(){a.states._IgnoreNextSelChange&&a.states._IgnoreNextSelChange--;return!0}.bind(this);this._KeyDown=function(b){var e=this.keyman.keyboardManager.activeKeyboard,g=this.keyman.osk,c=this.keyman.util;if(a.states._DisableInput||null==e)return!0;e=c.eventTarget(b);if(c.device.touchable){if(e&&"undefined"!=typeof e.kmwInput&&0==e.kmwInput)return!0}else if(e&&0<=e.className.indexOf("kmw-disabled"))return!0;return g.ready?this.keyman.textProcessor.keyDown(b):!0}.bind(this);this._KeyPress=function(b){return a.states._DisableInput||
null==this.keyman.keyboardManager.activeKeyboard?!0:this.keyman.textProcessor.keyPress(b)}.bind(this);this._KeyUp=function(a){var b=this.keyman.textProcessor,g=this.keyman.osk,c=b._GetKeyEventProperties(a,!1);return null!=c&&g.ready?13!=c.Lcode||(g=!1,c.Ltarg instanceof c.Ltarg.ownerDocument.defaultView.HTMLTextAreaElement&&(g=!0),c.Ltarg.base&&c.Ltarg.base instanceof c.Ltarg.base.ownerDocument.defaultView.HTMLTextAreaElement&&(g=!0),g)?b.keyUp(a):(c.Ltarg instanceof c.Ltarg.ownerDocument.defaultView.HTMLInputElement&&
(a=c.Ltarg,"search"==a.type||"submit"==a.type?a.form.submit():this.keyman.domManager.moveToNext(!1)),!0):!0}.bind(this);this.keyman=b}a.prototype.doControlFocused=function(a,g){var b={};b.target=a;b.activeControl=g;return this.keyman.util.callEvent("kmw.controlfocused",b)};a.prototype.doControlBlurred=function(a,g,e){var b={};b.target=a;b.event=g;b.isActivating=e;return this.keyman.util.callEvent("kmw.controlblurred",b)};a.prototype._BlurKeyboardSettings=function(b,g){var e=this.keyman.keyboardManager.activeKeyboard?
this.keyman.keyboardManager.activeKeyboard.KI:"",m=this.keyman.keyboardManager.getActiveLanguage();void 0!==b&&void 0!==g&&(e=b,m=g);(b=a.states.lastActiveElement)&&null!=b._kmwAttachment.keyboard?(b._kmwAttachment.keyboard=e,b._kmwAttachment.languageCode=m):(this.keyman.globalKeyboard=e,this.keyman.globalLanguageCode=m)};a.prototype._FocusKeyboardSettings=function(b){var g=a.states.lastActiveElement;g&&null!=g._kmwAttachment.keyboard?this.keyman.keyboardManager.setActiveKeyboard(g._kmwAttachment.keyboard,
g._kmwAttachment.languageCode):b||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode)};a.prototype._CommonFocusHelper=function(b){var g=this.keyman.uiManager;if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(b,1)||!this.keyman.domManager._IsMozillaEditableIframe(b,1)))return a.states._DisableInput=!0;a.states._DisableInput=!1;g.justActivated||(b&&d.text.Processor.getOutputTarget(b)&&
d.text.Processor.getOutputTarget(b).deadkeys().clear(),this.keyman.keyboardManager.notifyKeyboard(0,b,1));g.justActivated||a.states._SelectionControl==b||(g.isActivating=!1);g.justActivated=!1;a.states._SelectionControl=b;return!1};a.prototype.doChangeEvent=function(b){if(a.states.changed){if("function"==typeof Event)var g=new Event("change",{bubbles:!0,cancelable:!1});else g=document.createEvent("HTMLEvents"),g.initEvent("change",!0,!1);b.base&&b.base.kmw_ip&&(b=b.base);b.dispatchEvent(g)}a.states.changed=
!1};a.states=new f;return a}();d.DOMEventHandlers=h;var c=function(a){function b(b){b=a.call(this,b)||this;b.setFocus=function(a){var b=this.keyman.osk;h.states.setFocusTimer();if(d.dom.Utils.instanceof(a,"TouchEvent"))var e=a.touches[0];else e={clientX:0,clientY:0},e.target=h.states.lastActiveElement?h.states.lastActiveElement.kmw_ip:this.keyman.domManager.sortedInputs[0].kmw_ip;a=e.clientX;var g=e.clientY,c=e.target;var f=d.dom.Utils.instanceof(c,"HTMLSpanElement")?c.parentNode:null!=c.className&&
0<=c.className.indexOf("keymanweb-input")?c.firstChild:c;e=f.parentNode;if(h.states.activeElement!=e){var n=h.states.activeElement;n&&n.hideCaret();h.states.activeElement=e;e.focus()}this.keyman.domManager._SetTargDir(e);b.ready&&!b._Visible&&b._Show();if(d.dom.Utils.instanceof(c,"TouchAliasElement"))g=d.dom.Utils.getAbsoluteX(f.firstChild),"rtl"==e.dir?(g+=f.firstChild.offsetWidth,b=a>g?0:1E5):b=a<g?0:1E5,e.setTextCaret(b),e.scrollInput();else{var k;f=f.childNodes[1];c=0;n=e.getText()._kmwLength();
b=e.getTextCaret();var u=document.body.scrollTop;if(e.base instanceof e.base.ownerDocument.defaultView.HTMLTextAreaElement){var w=Math.round(e.base.offsetHeight/e.base.rows);for(k=0;16>k;k++){var v=d.dom.Utils.getAbsoluteY(f)-u;if(v>g&&b>c&&b!=n)n=b,b=Math.round((b+c)/2);else if(v<g-w&&b<n&&b!=c)c=b,b=Math.round((b+n)/2);else break;e.setTextCaret(b)}for(;d.dom.Utils.getAbsoluteY(f)-u>g&&b>c;)e.setTextCaret(--b);for(;d.dom.Utils.getAbsoluteY(f)-u<g-w&&b<n;)e.setTextCaret(++b)}v="rtl"==e.dir?function(a,
b){return a<b}:function(a,b){return a>b};for(k=0;16>k;k++){g=d.dom.Utils.getAbsoluteX(f);if(v(g,a)&&b>c&&b!=n)n=b,b=Math.round((b+c)/2);else if(!v(g,a)&&b<n&&b!=c)c=b,b=Math.round((b+n)/2);else break;e.setTextCaret(b)}for(;v(d.dom.Utils.getAbsoluteX(f),a)&&b>c;)e.setTextCaret(--b);for(;!v(d.dom.Utils.getAbsoluteX(f),a)&&b<n;)e.setTextCaret(++b)}this._BlurKeyboardSettings();h.states.lastActiveElement=e;e.showCaret();this._FocusKeyboardSettings(!1);this._CommonFocusHelper(e)}.bind(b);b.setBlur=function(a){this.keyman.interface.resetContext();
if("relatedTarget"in a&&a.relatedTarget&&(a=a.relatedTarget,this.doChangeEvent(a),"DIV"!=a.nodeName||-1==a.className.indexOf("keymanweb-input"))){this.cancelInput();return}h.states.focusing||this.cancelInput()}.bind(b);b.dragInput=function(a){a.preventDefault();a.stopPropagation();var b=d.dom.Utils.instanceof(a,"TouchEvent")?a.targetTouches[0].target:a.target;if(null!=b){if(null==b.className||0>b.className.indexOf("keymanweb-input"))b=b.parentNode;if(null==b.className||0>b.className.indexOf("keymanweb-input"))b=
b.parentNode;if(!(null==b.className||0>b.className.indexOf("keymanweb-input"))){if(d.dom.Utils.instanceof(a,"TouchEvent")){var e=a.touches[0].screenX;var g=a.touches[0].screenY}else e=a.screenX,g=a.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch={x:e,y:g};else{var c=this.firstTouch.x,f=this.firstTouch.y;a=b.firstChild;if("TEXTAREA"==b.base.nodeName){if(e=parseInt(a.style.top,10),isNaN(e)&&(e=0),c=f-g,-4>c||4<c)a.style.top=(e<c?e-c:0)+"px",this.firstTouch.y=g}else{g=
parseInt(a.style.left,10);isNaN(g)&&(g=0);var h=c-e;if(-4>h||4<h)c=0,f=d.dom.Utils.getAbsoluteX(b)+b.offsetWidth-a.offsetWidth-32,"rtl"==b.base.dir?c=16:f-=24,g-=h,g>c&&(g=c),g<f&&(g=f),a.style.left=g+"px",this.firstTouch.x=e}}this.setScrollBar(b)}}}.bind(b);return b}__extends(b,a);b.prototype.cancelInput=function(){h.states.activeElement&&h.states.activeElement.hideCaret&&h.states.activeElement.hideCaret();h.states.activeElement=null;this.keyman.osk.hideNow()};b.prototype.setScrollBar=function(a){var b=
a.childNodes[0],g=a.childNodes[1].style;(b.offsetWidth>a.offsetWidth||0>b.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(g.height="4px",g.width=a.offsetWidth/b.offsetWidth*100+"%",g.left=-b.offsetLeft/b.offsetWidth*100+"%",g.top="0",g.visibility="visible"):b.offsetHeight>a.offsetHeight||0>b.offsetTop?(g.width="4px",g.height=a.offsetHeight/b.offsetHeight*100+"%",g.top=-b.offsetTop/b.offsetHeight*100+"%",g.left="0",g.visibility="visible"):g.visibility="hidden"};b.prototype.scrollBody=function(a){var b=this.keyman.osk;
if(a&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))&&b.ready){a=a.firstChild.childNodes[1];var g=d.dom.Utils.getAbsoluteY(a),c=window.pageYOffset;g<c?b=g-c:(b=g-c-(window.innerHeight-b._Box.offsetHeight-a.offsetHeight-2),0>b&&(b=0));0!=b&&window.scrollTo(0,b+window.pageYOffset)}};return b}(h);d.DOMTouchHandlers=c})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){var f=function(){function d(){this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}d.prototype.getDPI=function(){var c=document.createElement("DIV"),a=c.style,b=96;if("complete"!==document.readyState)return b;c.id="calculateDPI";a.position="absolute";a.display="block";a.visibility="hidden";a.left="10px";a.top="10px";a.width="1in";a.height="10px";
document.body.appendChild(c);b="undefined"==typeof window.devicePixelRatio?c.offsetWidth:c.offsetWidth*window.devicePixelRatio;document.body.removeChild(c);return b};d.prototype.detect=function(){var c=d._GetIEVersion();if(navigator&&navigator.userAgent){var a=navigator.userAgent;if(0<=a.indexOf("iPad"))this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0;else if(0<=a.indexOf("iPhone"))this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=25;else if(0<=a.indexOf("Android")){this.OS=
"Android";this.formFactor="phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=a.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(b){}}else 0<=a.indexOf("Linux")?this.OS="Linux":0<=a.indexOf("Macintosh")?this.OS="MacOSX":0<=a.indexOf("Windows NT")&&(this.OS="Windows",0<=a.indexOf("Touch")&&(this.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}"tablet"==this.formFactor&&400>Math.min(screen.width,screen.height)&&(this.formFactor=
"phone");"phone"==this.formFactor&&720<Math.max(screen.width,screen.height)&&"iOS"!=this.OS&&(this.formFactor="tablet");"iOS"!=this.OS||"ongesturestart"in window||"Win32"==navigator.platform||(this.OS="Android");this.browser="web";if(999>c)this.browser="ie";else{if("iOS"==this.OS||"macosx"==this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR|Safari|Edge/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?
this.browser="opera":0<=navigator.userAgent.indexOf(" Edge/")?this.browser="edge":0<=navigator.userAgent.indexOf("Chrome")?this.browser="chrome":0<=navigator.userAgent.indexOf("Safari")&&(this.browser="safari"))}};d._GetIEVersion=function(){var c="";"userAgent"in navigator&&(c=navigator.userAgent);if("selection"in document){var a=navigator.appVersion;var b=a.indexOf("MSIE ");if(0<=b){if("BackCompat"==document.compatMode)return 6;a=a.substr(b+5);b=a.indexOf(".");if(0<b)return parseInt(a.substr(0,b),
10)}}b=c.indexOf("Trident/");if(0>b)return 999;c=c.substr(b+8);b=c.indexOf(".");return 0<b?parseInt(c.substr(0,b),10)+4:999};return d}();d.Device=f})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(d){var f=function(){function c(){}c.getAbsoluteX=function(a){if(!a)return 0;var b=a.offsetLeft?a.offsetLeft:0;var g=a;if(g.offsetParent)for(;g.offsetParent;)g=g.offsetParent,b+=g.offsetLeft;return g&&g.ownerDocument&&a.ownerDocument!=window.document&&(a=g.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+c.getAbsoluteX(a.defaultView.frameElement)-a.documentElement.scrollLeft:b};c.getAbsoluteY=function(a){if(!a)return 0;var b=a.offsetTop?a.offsetTop:0;
var g=a;if(g.ownerDocument&&g instanceof g.ownerDocument.defaultView.HTMLElement)for(;g.offsetParent;)g=g.offsetParent,b+=g.offsetTop;return g&&g.ownerDocument&&a.ownerDocument!=window.document&&(a=g.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+c.getAbsoluteY(a.defaultView.frameElement)-a.documentElement.scrollTop:b};c.instanceof=function(a,b){if("TouchAliasElement"==b)return this.instanceof(a,"HTMLDivElement")?void 0!==a.base:!1;var g;if(a.Window)return"Window"==b;a.defaultView?g=
a.defaultView[b]:a.ownerDocument?g=a.ownerDocument.defaultView[b]:a.target&&(this.instanceof(a.target,"Window")?g=a.target[b]:this.instanceof(a.target,"Document")?g=a.target.defaultView[b]:this.instanceof(a.target,"HTMLElement")&&(g=a.target.ownerDocument.defaultView[b]));return g?a instanceof g:!1};return c}();d.Utils=f})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(f){f.constructTouchAlias=function(c){var a=document.createElement("div"),b=new h,g;for(g in b)a.hasOwnProperty(g)||(a[g]=b[g]);c?a.initWithBase(c):a.init();return a};var h=function(){function c(){this.base=null;this.__activeCaret=!1}c.getDevice=function(){if(!c.device){var a=new d.keyman.Device;a.detect();c.device=a}return c.device};c.getOS=function(){return this.getDevice().OS};c.prototype.isMultiline=function(){return this.base&&"TEXTAREA"==this.base.nodeName};
c.prototype.initCaret=function(){this.__caretDiv=document.createElement("DIV");var a=this.__caretDiv.style;a.position="absolute";a.height="16px";a.width="2px";a.backgroundColor="blue";a.border="none";a.left=a.top="0px";a.display="block";a.visibility="hidden";a.zIndex="9998";this.__caretTimerId=window.setInterval(this.flashCaret.bind(this),500)};c.prototype.init=function(){this.className="keymanweb-input";var a=this.__scrollDiv=document.createElement("div"),b=this.style;b.overflow="hidden";b.position=
"absolute";b.border="hidden";b.border="none";b.borderRadius="5px";var g=this.__scrollBar=document.createElement("div"),e=g.style;e.position="absolute";e.height=e.width="4px";e.left=e.top="0";e.display="block";e.visibility="hidden";e.backgroundColor="#808080";e.borderRadius="2px";this.__preCaret=document.createElement("span");this.__postCaret=document.createElement("span");this.__caretSpan=document.createElement("span");this.__preCaret.innerHTML=this.__postCaret.innerHTML=this.__caretSpan.innerHTML=
"";this.__preCaret.className=this.__postCaret.className=this.__caretSpan.className="keymanweb-font";a.appendChild(this.__preCaret);a.appendChild(this.__caretSpan);a.appendChild(this.__postCaret);this.appendChild(a);this.appendChild(g);a=a.style;a.position="absolute";g=this.__preCaret.style;e=this.__postCaret.style;var c=this.__caretSpan.style;g.border=e.border="none";g.height=e.height="100%";c.border="1px solid red";c.visibility="hidden";c.marginLeft=c.marginRight="-1px";b.padding="8px";a.padding=
"0px 2px";this.tabIndex=0;this.style.msTouchAction="none";a.minWidth=b.width;a.height=b.height;this.initCaret()};c.prototype.initWithBase=function(a){this.base=a;this.init();this.base.kmw_ip=this;a.disabled=!0;var b=window.getComputedStyle(a,null),g=this.__scrollDiv.style,e=this.__preCaret.style,m=this.__postCaret.style;this.dir=a.dir;e.fontFamily=m.fontFamily=g.fontFamily=b.fontFamily;"input"!=a.nodeName.toLowerCase()||isNaN(parseInt(b.height,10))||(e.lineHeight=m.lineHeight=b.height);"Android"==
c.getOS()&&"transparent"==b.backgroundColor?g.backgroundColor="#fff":g.backgroundColor=b.backgroundColor;"textarea"==this.base.nodeName.toLowerCase()?e.whiteSpace=m.whiteSpace="pre-wrap":e.whiteSpace=m.whiteSpace="pre";this.base.parentNode.appendChild(this);this.updateInput();e=this.style;e.color=b.color;e.fontFamily=b.fontFamily;e.fontSize=b.fontSize;e.fontWeight=b.fontWeight;e.textDecoration=b.textDecoration;e.padding=b.padding;e.margin=b.margin;e.border=b.border;e.borderRadius=b.borderRadius;"webkitTapHighlightColor"in
e&&(e.webkitTapHighlightColor="rgba(0,0,0,0)");a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement?(2==a.rows&&(m=parseInt(b.height,10)-parseInt(b.paddingTop,10)-parseInt(b.paddingBottom,10),b=parseInt(b.fontSize,10),b=Math.round(m/b),b>a.rows+1&&(a.rows=b)),g.width=e.width,g.minHeight=e.height):(g.minWidth=e.width,g.height=e.height);a.style.visibility="hidden";(function(a){a.__resizeHandler=function(){window.setTimeout(function(){a.updateInput()},1)};a.base.addEventListener("resize",a.__resizeHandler,
!1);a.base.addEventListener("orientationchange",a.__resizeHandler,!1)})(this);this.setText(a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement||a instanceof a.ownerDocument.defaultView.HTMLInputElement?a.value:a.textContent,null)};c.prototype.setText=function(a,b){if(null===a){var g=this.__preCaret.textContent;a=this.__postCaret.textContent;a=g+a}0>b&&(b=0);g=a._kmwLength();if(null===b||void 0===b||b>g)b=g;g=a._kmwSubstr(0,b);a=a._kmwSubstr(b);this.__preCaret.textContent=g;this.__postCaret.textContent=
a;this.updateBaseElement()};c.prototype.getTextBeforeCaret=function(){return this.__preCaret.textContent};c.prototype.getTextAfterCaret=function(){return this.__postCaret.textContent};c.prototype.setTextBeforeCaret=function(a){this.isMultiline()||(a=a.replace(/\s+$/," "));this.__preCaret.textContent=a;this.updateBaseElement();this.scrollInput()};c.prototype.getTextCaret=function(){return this.getTextBeforeCaret()._kmwLength()};c.prototype.setTextCaret=function(a){this.setText(null,a);this.showCaret()};
c.prototype.updateBaseElement=function(){if(this.base){var a=this.base.ownerDocument.defaultView;this.base instanceof a.HTMLInputElement||this.base instanceof a.HTMLTextAreaElement?this.base.value=this.getText():this.base.textContent=this.getText();a=this.getText()._kmwLength();this.style.backgroundColor=0==a?"transparent":window.getComputedStyle(this.base,null).backgroundColor;"iOS"==c.getOS()&&(this.base.style.visibility=0==a?"visible":"hidden")}};c.prototype.flashCaret=function(){if(this.__activeCaret){var a=
this.__caretDiv.style;a.visibility="visible"!=a.visibility?"visible":"hidden"}};c.prototype.showCaret=function(){var a=this.__scrollDiv,b=this.__caretDiv.style,g=this.__caretSpan;this.__caretDiv.parentNode!=a&&a.appendChild(this.__caretDiv);b.left=g.offsetLeft+"px";b.top=g.offsetTop+"px";b.height=g.offsetHeight-1+"px";b.visibility="hidden";this.__activeCaret=!0;this.scrollBody();this.setScrollBar()};c.prototype.hideCaret=function(){if(this.base instanceof this.base.ownerDocument.defaultView.HTMLTextAreaElement||
this.base instanceof this.base.ownerDocument.defaultView.HTMLInputElement)this.base.value=this.getText();this.setText(null,1E5);var a=this.__scrollDiv.style;this.isMultiline()?a.top="0":a.left="rtl"==this.base.dir?this.offsetWidth-this.__scrollDiv.offsetWidth-8+"px":"0";this.__caretDiv.parentNode&&this.__caretDiv.parentNode.removeChild(this.__caretDiv);this.__caretDiv.style.visibility="hidden";this.__scrollBar.style.visibility="hidden";this.__activeCaret=!1};c.prototype.getText=function(){return this.textContent};
c.prototype.updateInput=function(){if(this.base){var a=this.style,b=this.base,g=window.getComputedStyle(b,null),e=parseInt(g.marginLeft,10),m=parseInt(g.marginTop,10),d=f.Utils.getAbsoluteX(b),l=f.Utils.getAbsoluteY(b),h=this.offsetParent;h&&(d-=f.Utils.getAbsoluteX(h),l-=f.Utils.getAbsoluteY(h));isNaN(e)&&(e=0);isNaN(m)&&(m=0);a.left=d-e+"px";a.top=l-m+"px";"undefined"!=typeof g.MozBoxSizing&&(a.left=d+"px",a.top=l+"px");e=b.offsetWidth;b=b.offsetHeight;m=parseInt(g.paddingLeft,10);d=parseInt(g.paddingRight,
10);l=parseInt(g.paddingTop,10);h=parseInt(g.paddingBottom,10);var k=parseInt(g.borderLeft,10),n=parseInt(g.borderRight,10),q=parseInt(g.borderTop,10),u=parseInt(g.borderBottom,10),w="undefined";"undefined"!=typeof g.boxSizing?w=g.boxSizing:"undefined"!=typeof g.MozBoxSizing&&(w=g.MozBoxSizing);"content-box"==w&&(isNaN(m)||(e-=m),isNaN(d)||(e-=d),isNaN(k)||(e-=k),isNaN(n)||(e-=n),isNaN(l)||(b-=l),isNaN(h)||(b-=h),isNaN(q)||(b-=q),isNaN(u)||(b-=u));"Android"==c.getOS()&&("undefined"!=typeof g.MozBoxSizing?
(a.paddingTop=l+1+"px",a.paddingLeft=m+"px",this.isMultiline()?a.marginTop="1px":a.marginLeft="1px",e--,b--):(e++,b++));a.width=e+"px";a.height=b+"px"}};c.prototype.scrollInput=function(){var a=this.__scrollDiv,b=this.__caretSpan,g=f.Utils.getAbsoluteX(b);b=f.Utils.getAbsoluteY(b);var e=f.Utils.getAbsoluteX(this),c=f.Utils.getAbsoluteY(this),d=parseInt(a.style.left,10),l=parseInt(a.style.top,10),h=0,k=0;isNaN(d)&&(d=0);isNaN(l)&&(l=0);this.isMultiline()?(g=Math.round(this.offsetHeight/this.base.rows),
b<c&&(k=b-c),b>c+this.offsetHeight-g&&(k=b-c-this.offsetHeight+g),0!=k&&(a.style.top=(l<k?l-k:0)+"px")):(g<e+8&&(h=g-e-12),g>e+this.offsetWidth-12&&(h=g-e-this.offsetWidth+12),0!=h&&(a.style.left=(d<h?d-h:0)+"px"));this.showCaret()};c.prototype.scrollBody=function(){var a=0;window.keyman&&(a=window.keyman.osk._Box.offsetHeight);var b=this.__caretSpan,g=f.Utils.getAbsoluteY(b),e=window.pageYOffset;g<e?a=g-e:(a=g-e-(window.innerHeight-a-b.offsetHeight-2),0>a&&(a=0));0!=a&&window.scrollTo(0,a+window.pageYOffset)};
c.prototype.setScrollBar=function(){var a=this.__scrollDiv,b=this.__scrollBar.style;(a.offsetWidth>this.offsetWidth||0>a.offsetLeft)&&!this.isMultiline()?(b.height="4px",b.width=this.offsetWidth/a.offsetWidth*100+"%",b.left=-a.offsetLeft/a.offsetWidth*100+"%",b.top="0",b.visibility="visible"):a.offsetHeight>this.offsetHeight||0>a.offsetTop?(b.width="4px",b.height=this.offsetHeight/a.offsetHeight*100+"%",b.top=-a.offsetTop/a.offsetHeight*100+"%",b.left="0",b.visibility="visible"):b.visibility="hidden"};
return c}()})(f.dom||(f.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(f){var h=function(c){function a(a){var b=c.call(this)||this;b.root=a;b._cachedSelectionStart=-1;return b}__extends(a,c);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){var a=this.getCaret();this.root.value=this.root.value._kmwSubstring(0,a)+this.root.value._kmwSubstring(this.processedSelectionEnd);this.setCaret(a)};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=
-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a)};a.prototype.setSelection=
function(a,g){var b=this.root.value._kmwCodePointToCodeUnit(a),c=this.root.value._kmwCodePointToCodeUnit(g);this.root.setSelectionRange(b,c);this.processedSelectionStart=a;this.processedSelectionEnd=g};a.prototype.getTextBeforeCaret=function(){return this.getText()._kmwSubstring(0,this.getCaret())};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setCaret(b)};a.prototype.getTextAfterCaret=
function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret(),e=this.getCaret();this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,this.getCaret()-a));this.setCaret(e-a)}};a.prototype.insertTextBeforeCaret=function(a){if(a){var b=this.getCaret(),e=this.getTextBeforeCaret(),c=this.getText()._kmwSubstring(this.processedSelectionStart);
this.adjustDeadkeys(a._kmwLength());this.root.value=e+a+c;this.setCaret(b+a._kmwLength())}};return a}(d.text.OutputTarget);f.Input=h})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(f){var h=function(c){function a(a){var b=c.call(this)||this;b.root=a;b._cachedSelectionStart=-1;return b}__extends(a,c);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){var a=this.getCaret();this.root.value=this.root.value._kmwSubstring(0,a)+this.root.value._kmwSubstring(this.processedSelectionEnd);this.setCaret(a)};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=
-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a)};a.prototype.setSelection=
function(a,g){var b=this.root.value._kmwCodePointToCodeUnit(a),c=this.root.value._kmwCodePointToCodeUnit(g);this.root.setSelectionRange(b,c);this.processedSelectionStart=a;this.processedSelectionEnd=g};a.prototype.getTextBeforeCaret=function(){return this.getText()._kmwSubstring(0,this.getCaret())};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setCaret(b)};a.prototype.getTextAfterCaret=
function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.saveProperties=function(){this.scrollLeft=this.root.scrollLeft;this.scrollTop=this.root.scrollTop};a.prototype.restoreProperties=function(){void 0!==this.scrollLeft&&(this.root.scrollLeft=this.scrollLeft,this.root.scrollTop=this.scrollTop,delete this.scrollLeft,delete this.scrollTop)};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=
this.getTextBeforeCaret(),e=this.getCaret();this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,this.getCaret()-a));this.setCaret(e-a)}};a.prototype.insertTextBeforeCaret=function(a){if(a){var b=this.getCaret(),e=this.getTextBeforeCaret(),c=this.getText()._kmwSubstring(this.processedSelectionStart);this.adjustDeadkeys(a._kmwLength());this.root.value=e+a+c;this.setCaret(b+a._kmwLength())}};return a}(d.text.OutputTarget);f.TextArea=h})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||
(com={}));
(function(d){(function(d){(function(f){var h=function(){return function(a,g){this.node=a;this.offset=g}}(),c=function(){return function(a,g){this.start=a;this.end=g}}(),a=function(a){function b(b){if(b.isContentEditable){var e=a.call(this)||this;e.root=b}else throw"Specified element is not already content-editable!";return e}__extends(b,a);b.prototype.getElement=function(){return this.root};b.prototype.hasSelection=function(){var a=this.root.ownerDocument.getSelection(),b=function(a,b){return 3!=b.nodeType?
null:0!=(b.compareDocumentPosition(a)&8)};return this.root!=a.anchorNode&&!this.root.contains(a.anchorNode)&&!b(this.root,a.anchorNode)||this.root!=a.focusNode&&!this.root.contains(a.focusNode)&&!b(this.root,a.anchorNode)?!1:!0};b.prototype.clearSelection=function(){if(this.hasSelection()){var a=this.root.ownerDocument.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};b.prototype.invalidateSelection=function(){};b.prototype.getCarets=
function(){var a=this.root.ownerDocument.getSelection(),b=a.anchorNode.compareDocumentPosition(a.focusNode);if(a.isCollapsed)return b=new h(a.anchorNode,a.anchorOffset),new c(b,b);var g=new h(a.anchorNode,a.anchorOffset);a=new h(a.focusNode,a.focusOffset);g.node==a.node&&(b=0<a.offset-g.offset?2:4);return b&2?new c(g,a):new c(a,g)};b.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};b.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;
return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};b.prototype.getTextAfterCaret=function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};b.prototype.getText=function(){return this.root.innerText};b.prototype.deleteCharsBeforeCaret=function(a){if(this.hasSelection()&&!(0>=a)){var b=this.getCarets().start;if(3!=b.node.nodeType)console.warn("Deletion of characters requested without available context!");else{var e=
this.root.ownerDocument.createRange(),g=b.offset-b.node.nodeValue.substr(0,b.offset)._kmwSubstr(-a).length;e.setStart(b.node,g);e.setEnd(b.node,b.offset);this.adjustDeadkeys(-a);e.deleteContents()}}};b.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var b=this.getCarets().start,e=a._kmwLength(),g=this.root.ownerDocument.getSelection();if(0!=e){this.adjustDeadkeys(e);e=this.root.ownerDocument.createRange();if(3==b.node.nodeType){var c=b.node;c.insertData(b.offset,a);e.setStart(c,
b.offset+a.length)}else{c=b.node.ownerDocument.createTextNode(a);var d=this.root.ownerDocument.createRange();d.setStart(b.node,a.length);d.collapse(!0);d.insertNode(c)}e.collapse(!0);g.removeAllRanges();try{g.addRange(e)}catch(n){b.node.parentElement.scrollIntoView(),g.addRange(e)}g.collapseToEnd()}}};return b}(d.text.OutputTarget);f.ContentEditable=a})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(f){var h=function(){return function(a,b){this.node=a;this.offset=b}}(),c=function(){return function(a,b){this.start=a;this.end=b}}(),a=function(){return function(a,b){this.cmd=a;this.stateType=b}}(),b=function(b){function e(a){var e=b.call(this)||this;e.root=a;if(a.contentWindow&&a.contentWindow.document&&"on"==a.contentWindow.document.designMode)e.doc=a.contentWindow.document,e.docRoot=a.contentWindow.document.documentElement;else throw"Specified IFrame is not in design-mode!";
return e}__extends(e,b);e.prototype.getElement=function(){return this.root};e.prototype.hasSelection=function(){this.doc.getSelection();document.getSelection();return!0};e.prototype.clearSelection=function(){if(this.hasSelection()){var a=this.doc.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};e.prototype.invalidateSelection=function(){};e.prototype.getCarets=function(){var a=this.doc.getSelection(),b=a.anchorNode.compareDocumentPosition(a.focusNode);
if(a.isCollapsed)return b=new h(a.anchorNode,a.anchorOffset),new c(b,b);var e=new h(a.anchorNode,a.anchorOffset);a=new h(a.focusNode,a.focusOffset);e.node==a.node&&(b=0<a.offset-e.offset?2:4);return b&2?new c(e,a):new c(a,e)};e.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};e.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};e.prototype.getTextAfterCaret=
function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};e.prototype.getText=function(){return this.docRoot.innerText};e.prototype.deleteCharsBeforeCaret=function(a){if(this.hasSelection()&&!(0>=a)){var b=this.getCarets().start;if(3!=b.node.nodeType)console.warn("Deletion of characters requested without available context!");else{var e=this.doc.createRange(),g=b.offset-b.node.nodeValue.substr(0,b.offset)._kmwSubstr(-a).length;
e.setStart(b.node,g);e.setEnd(b.node,b.offset);this.adjustDeadkeys(-a);e.deleteContents()}}};e.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var b=this.getCarets().start,e=a._kmwLength(),g=this.doc.getSelection();if(0!=e){this.adjustDeadkeys(e);e=this.root.ownerDocument.createRange();if(3==b.node.nodeType){var c=b.node;c.insertData(b.offset,a);e.setStart(c,b.offset+a.length)}else{c=this.doc.createTextNode(a);var m=this.doc.createRange();m.setStart(b.node,a.length);m.collapse(!0);
m.insertNode(c)}e.collapse(!0);g.removeAllRanges();try{g.addRange(e)}catch(q){b.node.parentElement.scrollIntoView(),g.addRange(e)}g.collapseToEnd()}}};e.prototype.saveProperties=function(){var b=[new a("backcolor",1),new a("fontname",1),new a("fontsize",1),new a("forecolor",1),new a("bold",0),new a("italic",0),new a("strikethrough",0),new a("subscript",0),new a("superscript",0),new a("underline",0)];this.doc.defaultView&&b.push(new a("hilitecolor",1));for(var e=0;e<b.length;e++){var g=b[e];g.cache=
1==g.stateType?this.doc.queryCommandValue(g.cmd):this.doc.queryCommandState(g.cmd)}this.commandCache=b};e.prototype.restoreProperties=function(a){this.commandCache||console.error("No command cache exists to restore!");for(var b=0;b<this.commandCache.length;b++){var e=this.commandCache[b];1==e.stateType?this.doc.queryCommandValue(e.cmd)!=e.cache&&(a&&a(),this.doc.execCommand(e.cmd,!1,e.cache)):this.doc.queryCommandState(e.cmd)!=e.cache&&(a&&a(),this.doc.execCommand(e.cmd,!1,null))}};return e}(d.text.OutputTarget);
f.DesignIFrame=b})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(f){var h=function(c){function a(a){var b=c.call(this)||this;b.root=a;return b}__extends(a,c);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){};a.prototype.invalidateSelection=function(){};a.prototype.hasSelection=function(){return!0};a.prototype.getDeadkeyCaret=function(){return this.root.getTextCaret()};a.prototype.getTextBeforeCaret=function(){return this.root.getTextBeforeCaret()};a.prototype.getTextAfterCaret=function(){return this.root.getTextAfterCaret()};
a.prototype.getText=function(){return this.root.getText()};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret();this.adjustDeadkeys(-a);this.root.setTextBeforeCaret(b.kmwSubstring(0,this.root.getTextCaret()-a))}};a.prototype.insertTextBeforeCaret=function(a){this.adjustDeadkeys(a._kmwLength());this.root.setTextBeforeCaret(this.root.getTextBeforeCaret()+a)};return a}(d.text.OutputTarget);f.TouchAlias=h})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(d){d.wrapElement=function(f){return d.Utils.instanceof(f,"HTMLInputElement")?new d.Input(f):d.Utils.instanceof(f,"HTMLTextAreaElement")?new d.TextArea(f):d.Utils.instanceof(f,"TouchAliasElement")?new d.TouchAlias(f):d.Utils.instanceof(f,"HTMLIFrameElement")&&f.contentWindow&&f.contentWindow.document&&"on"==f.contentWindow.document.designMode?new d.DesignIFrame(f):f.isContentEditable?new d.ContentEditable(f):null}})(d.dom||(d.dom={}))})(d.keyman||(d.keyman={}))})(com||
(com={}));
(function(d){(function(d){var f=function(){function f(c){this.inputList=[];this.sortedInputs=[];this.nonKMWTouchHandler=function(a){d.DOMEventHandlers.states.focusing=!1;clearTimeout(d.DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);this._EnablementMutationObserverCore=function(a){for(var b=0;b<a.length;b++){var g=a[b],e=g.oldValue?0<=g.oldValue.indexOf("kmw-disabled"):!1,c=0<=g.target.className.indexOf("kmw-disabled");e&&!c?this._EnableControl(g.target):!e&&c&&this._DisableControl(g.target);
!c&&"readonly"==g.attributeName&&(e=g.oldValue?null!=g.oldValue:!1,c=g.target,c instanceof c.ownerDocument.defaultView.HTMLInputElement||c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement)&&(c=c.readOnly,e&&!c?this._EnableControl(g.target):!e&&c&&this._DisableControl(g.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var b=[],g=[],e=0;e<a.length;e++){for(var c=a[e],d=0;d<c.addedNodes.length;d++)b=b.concat(this._GetDocumentEditables(c.addedNodes[d]));for(d=0;d<c.removedNodes.length;d++)g=
g.concat(this._GetDocumentEditables(c.removedNodes[d]))}for(a=0;a<b.length;a++)this.isKMWInput(b[a])&&this._MutationAdditionObserved(b[a]);for(a=0;a<g.length;a++)this.isKMWInput(g[a])&&this._MutationRemovalObserved(g[a]);if(b.length||g.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var f=this;window.setTimeout(function(){f.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput()}.bind(this),
1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var b=this;a.addEventListener("load",function(){window.setTimeout(function(){b.attachToControl(a)},1)})}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=function(a){this.isAttached(a)||
console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0<=b.indexOf("kmw-disabled")&&(a.className=b.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk.ready&&(this.keyman.osk.shutdown(),this.keyman.osk._Unload());this.clearLastActiveElement()}.bind(this);this.init=function(a){var b,
g=this.keyman.osk;var e=this.keyman.util;var c=e.device,d=function(a){if(0==a.length)return a;"/"!=a.substr(a.length-1,1)&&(a+="/");return"http"==a.replace(/^(http)s?:.*/,"$1")||"file"==a.replace(/^(file):.*/,"$1")?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.rootPath+a.substr(1):this.keyman.srcPath+a}.bind(this);var f=this.keyman.options;if("object"==typeof a&&null!==a)for(b in f)a.hasOwnProperty(b)&&(f[b]=a[b]);""!=f.root&&(this.keyman.rootPath=d(f.root));""==f.resources&&
(f.resources=this.keyman.srcPath);f.resources=d(f.resources);f.keyboards=d(f.keyboards);f.fonts=d(f.fonts);""==f.attachType&&(f.attachType="auto");this.keyman.setDefaultDeviceOptions(f);if(this.keyman.initialized)return Promise.resolve();var h=this.keyman,k=this;if("complete"!==document.readyState)return new Promise(function(b){window.setTimeout(function(){k.init(a).then(function(){b()})},50)});this.keyman._MasterDocument=window.document;"Android"==c.OS&&(f=c.getDPI(),c.formFactor=screen.height<4*
f||screen.width<4*f?"phone":"tablet");this.keyman.setInitialized(1);g.prepare();e.prepareWait();this.keyman.keyboardManager.registerDeferredStubs();this.initializeUI();this.keyman.keyboardManager.registerDeferredKeyboards();if(this.keyman.isEmbedded)return this.keyman.keyboardManager.setDefaultKeyboard()||console.error("No keyboard stubs exist - cannot initialize keyboard!"),Promise.resolve();this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont();c.touchable&&this.keyman.handleRotationEvents();
"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement);this.listInputs();c.touchable&&(g._Box.addEventListener("touchend",function(a){a.stopPropagation()},!1),e=document.createElement("DIV"),f=e.style,f.width="100%",f.height=screen.width/2+"px",document.body.appendChild(e),"Android"==c.OS&&0<navigator.userAgent.indexOf("Chrome")?(this.keyman.hideOskWhileScrolling=function(a){if("undefined"!=typeof g._Box&&"undefined"!=typeof g._Box.style){b=a.target.parentNode;if("undefined"!=
typeof b&&null!=b&&(0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-")||"undefined"!=typeof b.parentNode&&(b=b.parentNode,0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-"))))return;g.hideNow()}},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskWhileScrolling,!1)):(this.keyman.conditionallyHideOsk=function(){h.hideOnRelease&&!g.lgList&&g.hideNow();h.hideOnRelease=!1},this.keyman.hideOskIfOnBody=function(a){h.touchY=
a.touches[0].screenY;h.hideOnRelease=!0},this.keyman.cancelHideIfScrolling=function(a){a=a.touches[0].screenY;var b=h.touchY;if(5<a-b||5>b-a)h.hideOnRelease=!1},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskIfOnBody,!1),this.keyman.util.attachDOMEvent(document.body,"touchmove",this.keyman.cancelHideIfScrolling,!1),this.keyman.util.attachDOMEvent(document.body,"touchend",this.keyman.conditionallyHideOsk,!1)));this.keyman.keyboardManager.restoreCurrentKeyboard();MutationObserver?
(c=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&(e={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(c,e)),e={subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(c,e)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements.");
this.keyman.setInitialized(2);return Promise.resolve()}.bind(this);this.keyman=c;c.util.device.touchable&&(this.touchHandlers=new d.DOMTouchHandlers(c));this.nonTouchHandlers=new d.DOMEventHandlers(c)}f.prototype.shutdown=function(){this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver&&this.attachmentObserver.disconnect();for(var c=0,a=this.inputList;c<a.length;c++)this.disableInputElement(a[c])};f.prototype.getHandlers=function(c){return(c=c.base?c.base._kmwAttachment:
c._kmwAttachment)?c.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};f.prototype.enableTouchElement=function(c){if("iframe"==c.tagName.toLowerCase())return!1;if(this.isKMWDisabled(c))return this.setupNonKMWTouchElement(c),!1;c.kmwInput=!0;c.removeEventListener("touchstart",this.nonKMWTouchHandler);if(c.kmw_ip){if(-1!=this.inputList.indexOf(c.kmw_ip))return!1;this.inputList.push(c.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");
return!0}var a=d.dom.constructTouchAlias(c);this.isAttached(a)?a._kmwAttachment.interface=d.dom.wrapElement(a):this.setupElementAttachment(a);c._kmwAttachment=a._kmwAttachment;this.enableInputElement(a,!0);var b=this.touchHandlers;a.addEventListener("touchstart",b.setFocus);a.onmspointerdown=function(a){a.preventDefault();a.stopPropagation();return b.setFocus(a)};a.addEventListener("touchend",function(a){a.stopPropagation()});a.onmspointerup=function(a){a.stopPropagation()};a.addEventListener("touchmove",
b.dragInput,!1);a.onmspointermove=b.dragInput;a.onblur=b.setBlur;return!0};f.prototype.disableTouchElement=function(c){if("iframe"!=c.tagName.toLowerCase()){if(c.kmw_ip){var a=this.inputList.indexOf(c.kmw_ip);-1!=a&&this.inputList.splice(a,1);c.style.visibility="visible";c.disabled=!1;c.removeEventListener("resize",c.kmw_ip._kmwResizeHandler);this.disableInputElement(c.kmw_ip);c._kmwAttachment.interface=d.dom.wrapElement(c);c.parentNode&&c.parentNode.removeChild(c.kmw_ip);delete c.kmw_ip}this.setupNonKMWTouchElement(c)}};
f.prototype.setupNonKMWTouchElement=function(c){this.keyman.util.attachDOMEvent(c,"touchstart",this.nonKMWTouchHandler,!1);this.isAttached(c)&&(c._kmwAttachment.touchEnabled=!1)};f.prototype.enableInputElement=function(c,a){var b=a?c.base:c;this.isKMWDisabled(b)||(c instanceof c.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(c):(a||this.setupElementAttachment(c),b.className=b.className?b.className+" keymanweb-font":"keymanweb-font",this.inputList.push(c),this.keyman.util.attachDOMEvent(b,
"focus",this.getHandlers(c)._ControlFocus),this.keyman.util.attachDOMEvent(b,"blur",this.getHandlers(c)._ControlBlur),c.onkeypress=this.getHandlers(c)._KeyPress,c.onkeydown=this.getHandlers(c)._KeyDown,c.onkeyup=this.getHandlers(c)._KeyUp))};f.prototype.disableInputElement=function(c,a){var b=a?c.base:c;if(c instanceof c.ownerDocument.defaultView.HTMLIFrameElement)this._DetachFromIframe(c);else{0<b.className.indexOf("keymanweb-font")&&!a&&(b.className=b.className.replace("keymanweb-font","").trim());
var g=this.inputList.indexOf(c);-1<g&&this.inputList.splice(g,1);a||(this.keyman.util.detachDOMEvent(b,"focus",this.getHandlers(c)._ControlFocus),this.keyman.util.detachDOMEvent(b,"blur",this.getHandlers(c)._ControlBlur));c.onkeypress=null;c.onkeydown=null;c.onkeyup=null}a&&(this.inputList.push(b),b.onkeypress=this.getHandlers(c)._KeyPress,b.onkeydown=this.getHandlers(c)._KeyDown,b.onkeyup=this.getHandlers(c)._KeyUp);a=this.getLastActiveElement();if(a==c||a==c.kmw_ip)this.clearLastActiveElement(),
this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode),this.keyman.osk._Hide(!1)};f.prototype.isKMWDisabled=function(c){var a=c.className;return c.readOnly||a&&0<=a.indexOf("kmw-disabled")?!0:!1};f.prototype.attachToControl=function(c){var a=this.keyman.util.device.touchable;if(!this.isAttached(c)||c instanceof c.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(c)?this.isKMWDisabled(c)?a&&this.setupNonKMWTouchElement(c):a?this.enableTouchElement(c):
this.enableInputElement(c):a&&this.setupNonKMWTouchElement(c)};f.prototype.detachFromControl=function(c){if(this.isAttached(c)||c instanceof c.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(c)&&(this.isKMWDisabled(c)||this._DisableControl(c)),this.clearElementAttachment(c)};f.prototype.isAttached=function(c){return c._kmwAttachment?!0:!1};f.prototype.isKMWInput=function(c){var a=this.keyman.util.device.touchable;if(c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement)return!0;
if(c instanceof c.ownerDocument.defaultView.HTMLInputElement){if("text"==c.type||"search"==c.type)return!0}else if(c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&!a)try{if(c.contentWindow.document)return!0}catch(b){}else if(c.isContentEditable&&!a)return!0;return!1};f.prototype.setupElementAttachment=function(c){if(!c._kmwAttachment){var a=d.dom.wrapElement(c);a||d.dom.Utils.instanceof(c,"HTMLIFrameElement")||console.warn("Could not create processing interface for newly-attached element!");
c._kmwAttachment=new d.AttachmentInfo(a,null,this.keyman.util.device.touchable)}};f.prototype.clearElementAttachment=function(c){c._kmwAttachment=null};f.prototype._AttachToIframe=function(c){var a=this.keyman.util;try{var b=c.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?(a.attachDOMEvent(b,"focus",this.getHandlers(c)._ControlFocus),a.attachDOMEvent(b,"blur",this.getHandlers(c)._ControlBlur),a.attachDOMEvent(b,"keydown",this.getHandlers(c)._KeyDown),a.attachDOMEvent(b,"keypress",this.getHandlers(c)._KeyPress),
a.attachDOMEvent(b,"keyup",this.getHandlers(c)._KeyUp),this.setupElementAttachment(c),b.body._kmwAttachment=c._kmwAttachment):this._SetupDocument(b))}catch(g){}};f.prototype._DetachFromIframe=function(c){var a=this.keyman.util;try{var b=c.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?(a.detachDOMEvent(b,"focus",this.getHandlers(c)._ControlFocus),a.detachDOMEvent(b,"blur",this.getHandlers(c)._ControlBlur),a.detachDOMEvent(b,"keydown",this.getHandlers(c)._KeyDown),a.detachDOMEvent(b,"keypress",
this.getHandlers(c)._KeyPress),a.detachDOMEvent(b,"keyup",this.getHandlers(c)._KeyUp),b.body._kmwAttachment=null):this._ClearDocument(b))}catch(g){}};f.prototype._GetDocumentEditables=function(c){var a=this.keyman.util,b=[];if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement){var g=c.ownerDocument.defaultView;c instanceof g.HTMLInputElement||c instanceof g.HTMLTextAreaElement?b.push(c):c instanceof g.HTMLIFrameElement&&b.push(c)}c.getElementsByTagName&&(b=b.concat(a.arrayFromNodeList(c.getElementsByTagName("INPUT")),
a.arrayFromNodeList(c.getElementsByTagName("TEXTAREA")),a.arrayFromNodeList(c.getElementsByTagName("IFRAME"))));c.querySelectorAll&&(b=b.concat(a.arrayFromNodeList(c.querySelectorAll("[contenteditable]"))));c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement&&c.isContentEditable&&b.push(c);return b};f.prototype._SetupDocument=function(c){c=this._GetDocumentEditables(c);for(var a=0;a<c.length;a++)this.attachToControl(c[a])};f.prototype._ClearDocument=function(c){c=this._GetDocumentEditables(c);
for(var a=0;a<c.length;a++)this.detachFromControl(c[a])};f.prototype._SetTargDir=function(c){var a=this.keyman.keyboardManager.isRTL()?"rtl":"ltr";c&&(this.keyman.util.device.touchable?0==c.textContent.length&&(c.base.dir=c.dir=a,c.setTextCaret(1E4)):c instanceof c.ownerDocument.defaultView.HTMLInputElement||c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement?0==c.value.length&&(c.dir=a):"string"==typeof c.textContent&&0==c.textContent.length&&(c.dir=a))};f.prototype._DisableControl=function(c){if(this.isAttached(c)||
c instanceof c.ownerDocument.defaultView.HTMLIFrameElement)this.keyman.util.device.touchable?(this.disableTouchElement(c),this.setupNonKMWTouchElement(c),window.setTimeout(function(){this.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),1)):this.listInputs(),this.disableInputElement(c)};f.prototype._EnableControl=function(c){if(this.isAttached(c))if(this.keyman.util.device.touchable){this.enableTouchElement(c);
var a=this.keyman;window.setTimeout(function(){a.domManager.listInputs();for(var b=0;b<this.sortedInputs.length;b++)this.sortedInputs[b].kmw_ip&&this.sortedInputs[b].kmw_ip.updateInput(this.sortedInputs[b].kmw_ip)}.bind(this),1)}else this.enableInputElement(c)};f.prototype.listInputs=function(){var c,a=[],b=document.getElementsByTagName("input"),g=document.getElementsByTagName("textarea");for(c=0;c<b.length;c++)switch(b[c].type){case "text":case "search":case "email":case "url":0>b[c].className.indexOf("kmw-disabled")&&
a.push({ip:b[c],x:d.dom.Utils.getAbsoluteX(b[c]),y:d.dom.Utils.getAbsoluteY(b[c])})}for(c=0;c<g.length;c++)0>g[c].className.indexOf("kmw-disabled")&&a.push({ip:g[c],x:d.dom.Utils.getAbsoluteX(g[c]),y:d.dom.Utils.getAbsoluteY(g[c])});a.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});b=[];for(c=0;c<a.length;c++)b.push(a[c].ip);this.sortedInputs=b};f.prototype.disableControl=function(c){this.isAttached(c)||console.warn("KeymanWeb is not attached to element "+c);var a=c.className;0>a.indexOf("kmw-disabled")&&
(c.className=a?a+" kmw-disabled":"kmw-disabled")};f.prototype.setKeyboardForControl=function(c,a,b){null!==a&&void 0!==a?0>a.indexOf("Keyboard_")&&""!=a&&(a="Keyboard_"+a):b=null;if(c instanceof c.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(c)){c._kmwAttachment.keyboard=a;c._kmwAttachment.languageCode=b;var g=this.getLastActiveElement();!g||g!=c&&g!=c.kmw_ip||(null!=a&&null!=b?this.keyman.keyboardManager.setActiveKeyboard(a,
b):this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode))}else console.error("KeymanWeb is not attached to element "+c)};f.prototype.getKeyboardForControl=function(c){if(this.isAttached(c))return c._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+c);return null};f.prototype.getLanguageForControl=function(c){if(this.isAttached(c))return c._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+
c);return null};f.prototype.focusLastActiveElement=function(){var c=this.getLastActiveElement();c&&(this.keyman.uiManager.justActivated=!0,c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&this.keyman.domManager._IsMozillaEditableIframe(c,0)?c.ownerDocument.defaultView.focus():c.focus&&c.focus())};f.prototype.getLastActiveElement=function(){return d.DOMEventHandlers.states.lastActiveElement};f.prototype.clearLastActiveElement=function(){d.DOMEventHandlers.states.lastActiveElement=
null};f.prototype.getActiveElement=function(){return d.DOMEventHandlers.states.activeElement};f.prototype._setActiveElement=function(c){d.DOMEventHandlers.states.activeElement=c};f.prototype.setActiveElement=function(c,a){"string"==typeof c&&(c=document.getElementById(c));if(this.keyman.isEmbedded)this.isAttached(c)||this.attachToControl(c);else if(!this.isAttached(c)){console.warn("Cannot set an element KMW is not attached to as the active element.");return}c=c.kmw_ip?c.kmw_ip:c;this.keyman.isEmbedded||
this.keyman.touchAliasing._BlurKeyboardSettings();d.DOMEventHandlers.states.activeElement!=c&&this.keyman.interface.resetContext();d.DOMEventHandlers.states.activeElement=d.DOMEventHandlers.states.lastActiveElement=c;this.keyman.isEmbedded||this.keyman.touchAliasing._FocusKeyboardSettings(!1);1<arguments.length&&a&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocus():this.focusLastActiveElement())};f.prototype.initActiveElement=function(c){null==d.DOMEventHandlers.states.activeElement&&
(d.DOMEventHandlers.states.activeElement=c)};f.prototype.moveToNext=function(c){var a,b=this.sortedInputs,g=this.getActiveElement(),e=this.keyman.util.device.touchable;if(0!=b.length){e&&(g=g.base);for(a=0;a<b.length&&b[a]!=g;a++);a=c?a-1:a+1;a=a>=b.length?a-b.length:a;a=0>a?a+b.length:a;e?(d.DOMEventHandlers.states.focusing=!0,c=b[a].kmw_ip,"undefined"==typeof c?b[a].focus():(this.keyman.domManager.setActiveElement(c),c.setTextCaret(1E4),c.scrollInput(),c.focus())):b[a].focus()}};f.prototype.moveToElement=
function(c){"string"==typeof c&&(c=document.getElementById(c));this.keyman.util.device.touchable&&c.kmw_ip?c.kmw_ip.focus():c.focus()};f.prototype._IsIEEditableIframe=function(c,a){var b,g=c&&(b=c.tagName)&&"body"==b.toLowerCase()&&(b=c.ownerDocument)&&b.parentWindow;return!a&&g||a&&(!g||c.isContentEditable)};f.prototype._IsMozillaEditableIframe=function(c,a){var b;c=c&&(b=c.defaultView)&&b.frameElement;return!a&&c||a&&(!c||"on"==b.document.designMode.toLowerCase())};f.prototype.getBaseFont=function(){var c=
this.keyman.util,a=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),g=0;if(0==a.length&&0==b.length)g=0;else if(0<a.length&&0==b.length)g=1;else if(0==a.length&&0<b.length)g=2;else{var e=a[0],d=b[0];e.offsetTop<d.offsetTop?g=1:e.offsetTop>d.offsetTop?g=2:e.offsetLeft<d.offsetLeft?g=1:e.offsetLeft>d.offsetLeft&&(g=2)}switch(g){case 0:case 1:c.getStyleValue(a[0],"font-family");case 2:var f=c.getStyleValue(b[0],"font-family")}if("undefined"==typeof f||"monospace"==f)f=
"Arial,sans-serif";return f};f.prototype.initializeUI=function(){this.keyman.ui&&this.keyman.ui.initialize instanceof Function?(this.keyman.ui.initialize(),this.keyman.osk._Show()):window.setTimeout(this.initializeUI.bind(this),1E3)};return f}();d.DOMManager=f})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){var k=function(){function c(a,b,c,e){this.Pelem=a;this.Peventname=b.toLowerCase();this.Phandler=c;this.PuseCapture=e}c.prototype.equals=function(a){return this.Pelem==a.Pelem&&this.Peventname==a.Peventname&&this.Phandler==a.Phandler&&this.PuseCapture==a.PuseCapture};return c}(),h=function(){function c(a){this.linkedStylesheets=[];this.events={};this.currentEvents=[];this.domEvents=[];this.embeddedFonts=[];this.getAbsolute=this._GetAbsolute;this.selectStartHandler=function(){return!1};
this._CancelMouse=function(a){(a=d.keyman.singleton._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=a}c.prototype.getLanguageCodes=function(a){return-1==a.indexOf("-")?[a]:a.split("-")};c.prototype.initDevices=function(){this.device=new f.Device;this.physicalDevice=new f.Device;this.activeDevice=this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=
!1);this.physicalDevice=new f.Device;this.physicalDevice.touchable=!1;this.physicalDevice.browser=this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};c.prototype.arrayFromNodeList=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};c.prototype.addEventListener=function(a,b){this.removeEventListener(a,b);this.events[a].push(b);return!0};c.prototype.removeEventListener=function(a,b){"undefined"==typeof this.events[a]&&(this.events[a]=[]);
for(var c=0;c<this.events[a].length;c++)if(this.events[a][c]==b)return this.events[a].splice(c,1),!0;return!1};c.prototype.callEvent=function(a,b){if("undefined"==typeof this.events[a])return!0;if(-1!=this.currentEvents.indexOf(a))return!1;this.currentEvents.push(a);for(var c=0;c<this.events[a].length;c++){var e=this.events[a][c],d=!1;try{d=e(b)}catch(t){d=!1}if(!1===d)return this.currentEvents.pop(),!1}this.currentEvents.pop();return!0};c.prototype.attachDOMEvent=function(a,b,c,e){this.detachDOMEvent(a,
b,c,e);a.addEventListener(b,c,e?!0:!1);a=new k(a,b,c,e);this.domEvents.push(a)};c.prototype.detachDOMEvent=function(a,b,c,e){a.removeEventListener(b,c,e);a=new k(a,b,c,e);for(b=0;b<this.domEvents.length;b++)if(this.domEvents[b].equals(a)){this.domEvents.splice(b,1);break}};c.prototype.getOption=function(a,b){return a in this.keyman.options?this.keyman.options[a]:1<arguments.length?b:""};c.prototype.hasClass=function(a,b){b=" "+b+" ";return 0<=(" "+a.className+" ").replace(/[\n\t\r\f]/g," ").indexOf(b)};
c.prototype.setOption=function(a,b){this.keyman.options[a]=b};c.prototype.getAbsoluteX=function(a){return f.dom.Utils.getAbsoluteX(a)};c.prototype.getAbsoluteY=function(a){return f.dom.Utils.getAbsoluteY(a)};c.prototype._GetAbsolute=function(a){return{x:this.getAbsoluteX(a),y:this.getAbsoluteY(a)}};c.prototype.mouseDownPreventDefaultHandler=function(a){a&&a.preventDefault()};c.prototype._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?a.onselectstart=this.selectStartHandler:
(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};c.prototype.getIEVersion=function(){return f.Device._GetIEVersion()};c.prototype.getFontSizeStyle=function(a){a="string"==typeof a?a:a.style.fontSize;return-1!=a.indexOf("em")?(a=parseFloat(a.substr(0,a.indexOf("em"))),{val:a,absolute:!1}):-1!=a.indexOf("px")?(a=parseFloat(a.substr(0,a.indexOf("px"))),{val:a,absolute:!0}):-1!=a.indexOf("%")?(a=parseFloat(a.substr(0,a.indexOf("%"))),
{val:a/100,absolute:!1}):null};c.prototype.getStyleValue=function(a,b){try{if(a&&"undefined"!=typeof window.getComputedStyle)return window.getComputedStyle(a,"").getPropertyValue(b)}catch(g){}return""};c.prototype.getStyleInt=function(a,b,c){a=parseInt(this.getStyleValue(a,b),10);return isNaN(a)?"number"==typeof c?c:0:a};c.prototype.isTouchDevice=function(){return this.device.touchable};c.prototype.portraitView=function(){return!this.landscapeView()};c.prototype.landscapeView=function(){if("undefined"!=
typeof window.orientation)var a=window.orientation;else"undefined"!=typeof window.screen.orientation&&(a=window.screen.orientation.angle);return void 0!==a?1==Math.abs(a/90):!1};c.prototype.getViewportScale=function(){try{if(screen.width>document.documentElement.clientWidth)return 1;var a=screen.width;this.landscapeView()?screen.width<screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/window.innerWidth)/100}catch(b){return 1}};c.prototype.barHeight=
function(){var a=0;"phone"==this.device.formFactor&&(a=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return a};c.prototype._EncodeEntities=function(a){return a.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};c.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};c.prototype.showShim=
function(a,b,c){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};c.prototype.hideShim=function(a){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};c.prototype.rgba=function(a,b,c,e,d){a="transparent";try{a="rgba("+b+","+c+","+e+","+d+")"}catch(t){a="rgb("+b+","+c+","+e+")"}return a};c.prototype.addStyleSheet=function(a){var b=document.createElement("style");
b.type="text/css";b.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");0<a.length?a[0].appendChild(b):document.body.appendChild(b);this.linkedStylesheets.push(b);return b};c.prototype.removeStyleSheet=function(a){if(null==a||"object"!=typeof a||"STYLE"!=a.nodeName||"undefined"==typeof a.parentNode||null==a.parentNode)return!1;a.parentNode.removeChild(a);return!0};c.prototype.linkStyleSheet=function(a){var b=document.getElementsByTagName("head");if(0<b.length){var c=document.createElement("link");
c.type="text/css";c.rel="stylesheet";c.href=a;this.linkedStylesheets.push(c);b[0].appendChild(c)}};c.prototype.addFontFaceStyleSheet=function(a){if("undefined"!=typeof a&&("undefined"==typeof a.files&&(a.files=a.source),"undefined"!=typeof a.files)){var b,c="",e="",d="",t="",l=[];for(b=0;b<this.embeddedFonts.length;b++)if(this.embeddedFonts[b]==a.family)return;"string"==typeof a.files?l[0]=a.files:l=a.files;for(b=0;b<l.length;b++)0<l[b].toLowerCase().indexOf(".ttf")&&(c=l[b]),0<l[b].toLowerCase().indexOf(".woff")&&
(e=l[b]),0<l[b].toLowerCase().indexOf(".eot")&&(d=l[b]),0<l[b].toLowerCase().indexOf(".svg")&&(t=l[b]);""!=c&&0>c.indexOf("/")&&(c=this.keyman.options.fonts+c);""!=e&&0>e.indexOf("/")&&(e=this.keyman.options.fonts+e);""!=d&&0>d.indexOf("/")&&(d=this.keyman.options.fonts+d);""!=t&&0>t.indexOf("/")&&(t=this.keyman.options.fonts+t);b="@font-face {\nfont-family:"+a.family+";\nfont-style:normal;\nfont-weight:normal;\n";if(9<=f.Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=c)c=this.unCached(c),
b=b+"src:url('"+c+"') format('truetype');";else return;else{d=[];"Android"==this.device.OS?(""!=t&&d.push("url('"+t+"') format('svg')"),""!=e&&d.push("url('"+e+"') format('woff')"),""!=c&&d.push("url('"+c+"') format('truetype')")):(""!=e&&d.push("url('"+e+"') format('woff')"),""!=c&&d.push("url('"+c+"') format('truetype')"),""!=t&&d.push("url('"+t+"') format('svg')"));if(0==d.length)return;b+="src:"+d.join(",")+";"}else if(""!=d)b=b+"src:url('"+d+"');";else return;this.addStyleSheet(b+"\n}\n");this.embeddedFonts.push(a.family)}};
c.prototype.unCached=function(a){return a};c.prototype.loadCookie=function(a){var b={};if(0<arguments.length){var c=this.loadCookie(),e;for(e in c)if(e==a)for(var d=decodeURIComponent(c[e]).split(";"),f=0;f<d.length;f++){var l=d[f].split("=");b[l[0]]=1<l.length?l[1]:""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(c=document.cookie.split(/;\s*/),f=0;f<c.length;f++)d=c[f].split("="),2==d.length&&(b[d[0]]=d[1]);return b};c.prototype.saveCookie=function(a,b){var c="",e;for(e in b)c=
c+e+"="+b[e]+";";b=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=a+"="+encodeURIComponent(c)+"; path=/; expires="+b};c.prototype.toNumber=function(a,b){a=parseInt(a,10);return isNaN(a)?b:a};c.prototype.toFloat=function(a,b){a=parseFloat(a);return isNaN(a)?b:a};c.prototype.nzString=function(a,b){var c="";1<arguments.length&&(c=b);return"undefined"==typeof a||null==a||0==a||""==a?c:""+a};c.prototype.deepCopy=function(a,b){b=b||{};for(var c in a)"object"===typeof a[c]?(b[c]=a[c].constructor===
Array?[]:{},this.deepCopy(a[c],b[c])):b[c]=a[c];return b};c.prototype.eventTarget=function(a){return a?a.target?a.target:a.srcElement?a.srcElement:window.event?window.event.srcElement:null:null};c.prototype.eventType=function(a){return a&&a.type?a.type:window.event?window.event.type:""};c.prototype.alert=function(a,b){var c=this.waiting,e=c.firstChild.childNodes;e[0].style.display="block";e[1].className="kmw-alert-text";e[1].innerHTML=a;e[2].style.display="none";c.style.display="block";c.dismiss=
1<arguments.length?b:null};c.prototype.wait=function(a){};c.prototype.prepareWait=function(){var a=document.createElement("DIV"),b=document.createElement("DIV"),c=document.createElement("DIV"),e=document.createElement("DIV"),d=document.createElement("DIV");a.className="kmw-wait-background";b.className="kmw-wait-box";a.dismiss=null;c.className="kmw-wait-text";e.className="kmw-wait-graphic";d.className="kmw-alert-close";b.onmousedown=b.onclick=function(b){"block"==d.style.display&&(a.style.display=
"none",a.dismiss&&a.dismiss())};b.addEventListener("touchstart",b.onclick,!1);a.onmousedown=a.onclick=function(a){a.preventDefault();a.stopPropagation()};a.addEventListener("touchstart",a.onclick,!1);b.appendChild(d);b.appendChild(c);b.appendChild(e);a.appendChild(b);document.body.appendChild(a);this.waiting=a};c.prototype.shutdown=function(){this.events={};for(var a=0,b=this.domEvents;a<b.length;a++){var c=b[a];this.detachDOMEvent(c.Pelem,c.Peventname,c.Phandler,c.PuseCapture)}this.waiting.parentNode.removeChild(this.waiting);
a=0;for(b=this.linkedStylesheets;a<b.length;a++)c=b[a],c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)};c.prototype.myPath=function(a){var b,c=document.getElementsByTagName("script");for(b=0;b<c.length;b++){var e=c[b];if(0<=e.src.indexOf(a))return e.src.substr(0,e.src.lastIndexOf("/")+1)}return""};c.prototype.prependProtocol=function(a){return/^https?:/.test(a)?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.protocol+"/"+a:this.keyman.protocol+"//"+a};c.prototype.testString=
function(a){var b=a.family;if("sample"in a&&"string"==typeof a.sample)return"BESbswy"+a.sample;var c="TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),e="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");for(a=0;a<c.length;a++)if(b==c[a])return"BESbswy"+e[a];return"BESbswy"};c.prototype.checkFont=function(a){var b=
a.family,c=document.createElement("DIV"),e=c.style,d=document.createElement("P"),f=document.createElement("P"),l=document.createElement("SPAN"),h=l.style,k=document.createElement("SPAN"),n=k.style;e.position="absolute";e.top="10px";e.left="10px";e.visibility="hidden";document.body.appendChild(c);c.appendChild(d);c.appendChild(f);d.appendChild(l);f.appendChild(k);l.setAttribute("style","font-family:monospace !important");n.fontFamily=b+",monospace";h.fontSize=n.fontSize="24px";l.innerHTML=k.innerHTML=
this.testString(a);l.offsetWidth!=k.offsetWidth&&(l.setAttribute("style","font-family:sans-serif !important"),n.fontFamily=b+",sans-serif",l.offsetWidth!=k.offsetWidth&&(l.setAttribute("style","font-family:serif !important"),n.fontFamily=b+",serif"));a=l.offsetWidth!=k.offsetWidth;d.removeChild(l);f.removeChild(k);c.removeChild(d);c.removeChild(f);document.body.removeChild(c);return a};c.prototype.checkFontDescriptor=function(a){return"undefined"==typeof a||"string"!=typeof a.family?!0:this.checkFont(a)};
return c}();f.Util=h})(d.keyman||(d.keyman={}))})(com||(com={}));var Util=com.keyman.Util;
(function(d){(function(f){(function(k){var h=function(){return function(){}}();k.KeyInformation=h;(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();var c=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,b){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][b]?null:
this._cache[a][b]};a.prototype.set=function(a,b,e){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][b]=e};return a}(),a=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,b){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][b]?null:this._cache[a][b]};a.prototype.set=function(a,b,e){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][b]=e};return a}(),b=function(){function a(a){this.e=
a;this.c=a.style.backgroundColor}a.prototype.reset=function(){this.e.style.backgroundColor=this.c};return a}(),g=function(){function e(){this.cachedContext=new c;this.cachedContextEx=new a;this.TSS_LAYER=33;this.TSS_PLATFORM=31;this._AnyIndices=[];this._BeepObjects=[];this._BeepTimeout=0}e.prototype.saveFocus=function(){d.keyman.singleton.isHeadless||(f.DOMEventHandlers.states._IgnoreNextSelChange=1)};e.prototype.insertText=function(a,b){var e=d.keyman.singleton;this.resetContextCache();var c=this.activeTargetOutput?
this.activeTargetOutput:k.Processor.getOutputTarget();return null!=c?(e.isHeadless||(e.uiManager.setActivatingUI(!0),f.DOMEventHandlers.states._IgnoreNextSelChange=100,e.domManager.focusLastActiveElement(),f.DOMEventHandlers.states._IgnoreNextSelChange=0),null!=a&&this.output(0,c,a),"undefined"!==typeof b&&null!==b&&this.deadkeyOutput(0,c,b),c.invalidateSelection(),!0):!1};e.prototype.registerKeyboard=function(a){d.keyman.singleton.keyboardManager._registerKeyboard(a)};e.prototype.registerStub=function(a){return d.keyman.singleton.keyboardManager._registerStub(a)};
e.prototype.context=function(a,b,e){var c=this.cachedContext.get(a,b);if(null!==c)return c;e=this.KC_(a,b,e);this.cachedContext.set(a,b,e);return e};e.prototype.KC_=function(a,b,e){e=e.getTextBeforeCaret();e._kmwLength()<a&&(e=Array(a-e._kmwLength()+1).join("\ufffe")+e);return e._kmwSubstr(-a)._kmwSubstr(0,b)};e.prototype.nul=function(a,b){return"\ufffe"===this.context(a+1,1,b)};e.prototype.contextMatch=function(a,b,e,c){if(this.context(a,c,b)===e)return!0;b.deadkeys().resetMatched();return!1};e.prototype._BuildExtendedContext=
function(a,b,e){var c=this.cachedContextEx.get(a,b);if(null!==c)return c;c=this.cachedContextEx.get(a,a);if(null===c){var d=e.deadkeys().toSortedArray(),g=0;for(c={valContext:[],deadContext:[]};c.valContext.length<a;){var m=e.getDeadkeyCaret()-g;0<d.length&&d[0].p>m?d.splice(0,1):0<d.length&&d[0].p==m?(c.deadContext[a-c.valContext.length-1]=d[0],c.valContext=[d[0].d].concat(c.valContext),d.splice(0,1)):(m=this.context(++g,1,e),c.valContext=[m].concat(c.valContext))}this.cachedContextEx.set(a,a,c)}e=
c;e.valContext=e.valContext.slice(0,b);for(c=0;c<e.valContext.length;c++)"\ufffe"==e[c]&&(e.valContext.splice(0,1),e.deadContext.splice(0,1));0==e.valContext.length&&(e.valContext=["\ufffe"],e.deadContext=[]);this.cachedContextEx.set(a,b,e);return e};e.prototype.fullContextMatch=function(a,b,e){var c=this._BuildExtendedContext(a,e.length,b);a=c.valContext;c=c.deadContext;for(var d=!1,g=0;g<e.length;g++)if("string"==typeof e[g]){if(e[g]!==a[g]){d=!0;break}}else{var m=e[g];switch(m.t){case "d":m.d!==
a[g]?d=!0:c[g].set();break;case "a":var f=this.any(g,"string"==typeof a[g]?a[g]:{t:"d",d:a[g]},m.a);m.n?m.n&&(f||"\ufffe"!==a[g])&&(d=!0):f?void 0!==c[g]&&c[g].set():d=!0;break;case "i":m=this._Index(m.i,m.o);void 0!==m&&("string"==typeof m?m:m.d)!==a[g]?d=!0:void 0!==c[g]&&c[g].set();break;case "c":a[m.c-1]!==a[g]?d=!0:void 0!==c[g]&&c[g].set();break;case "n":"\ufffe"!=a[g]&&(d=!0);break;default:throw Error("Unexpected object in fullContextMatch specification: "+m);}}d&&(b.deadkeys().resetMatched(),
this._AnyIndices=[]);return!d};e.prototype.isKeypress=function(a){var b=d.keyman.singleton;return b.keyboardManager.activeKeyboard.KM?!a.LisVirtualKey:b.keyMapManager._USKeyCodeToCharCode(a)?!0:!1};e.prototype.keyMatch=function(a,b,e){var c=!1,g=173==a.Lcode?189:a.Lcode,m=d.keyman.singleton.keyboardManager.getKeyboardModifierBitmask(),f=d.keyman.text.Codes,h=m&f.modifierBitmasks.ALL;m&=f.stateBitmasks.ALL;255<a.vkCode&&(g=a.vkCode);if(a.LisVirtualKey||255<g){if(16384==(b&16384)||255<g)c=(c=e==g&&
(b&h)==a.Lmodifiers)&&this.stateMatch(a,b&m)}else 0==(b&16384)&&(c=g==e);c||this.activeTargetOutput.deadkeys().resetMatched();return c};e.prototype.stateMatch=function(a,b){return(b&a.Lstates)==b};e.prototype.keyInformation=function(a){var b=new h;b.vk=a.LisVirtualKey;b.code=a.Lcode;b.modifiers=a.Lmodifiers;return b};e.prototype.deadkeyMatch=function(a,b,e){return b.hasDeadkeyMatch(a,e)};e.prototype.beepReset=function(){this.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();
this._BeepObjects=[]};e.prototype.beep=function(a){this.resetContextCache();var e=d.keyman.singleton;"beepKeyboard"in e&&e.beepKeyboard();var c=a.getElement();a instanceof f.dom.DesignIFrame&&(c=a.docRoot);if(c&&c.style&&"undefined"!=typeof c.style.backgroundColor){for(a=0;a<this._BeepObjects.length;a++)if(this._BeepObjects[a].e==c)return;this._BeepObjects=e._push(this._BeepObjects,new b(c));c.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),
50))}};e.prototype._ExplodeStore=function(a){if("string"==typeof a){var b=d.keyman.singleton.keyboardManager.getActiveKeyboardTag();if(b.stores[a])return b.stores[a];for(var e=[],c=0;c<a._kmwLength();c++)e.push(a._kmwCharAt(c));return b.stores[a]=e}return a};e.prototype.any=function(a,b,e){if(""==b)return!1;e=this._ExplodeStore(e);for(var c=-1,g=0;g<e.length;g++)if("string"==typeof e[g]){if(e[g]==b){c=g;break}}else if(e[g].d===b.d){c=g;break}this._AnyIndices[a]=c;return 0<=c};e.prototype._Index=function(a,
b){a=this._ExplodeStore(a);if(this._AnyIndices[b-1]<a.length)return a[this._AnyIndices[b-1]];console.warn("Unmatched contextual index() statement detected in rule with index "+b+"!");return""};e.prototype.indexOutput=function(a,b,e,c){this.resetContextCache();b=this._Index(b,e);if(""!==b)if("string"==typeof b)this.output(a,c,b);else if(b.t)switch(b.t){case "b":this.beep(c);break;case "d":this.deadkeyOutput(a,c,b.d);break;default:throw Error("Unexpected object in fullContextMatch specification: "+
b);}else this.deadkeyOutput(a,c,b.d)};e.prototype.deleteContext=function(a,b){if(0<a){var e=this._BuildExtendedContext(a,a,b);for(var c=0;c<e.deadContext.length;c++){var g=e.deadContext[c];g&&(b.deadkeys().remove(g),a--)}}b.deadkeys().resetMatched();this.output(a,b,"")};e.prototype.output=function(a,b,e){this.resetContextCache();var c=d.keyman.singleton;if("oninserttext"in c)c.oninserttext(a,e);b.saveProperties();b.clearSelection();b.deadkeys().deleteMatched();0<=a&&b.deleteCharsBeforeCaret(a);b.insertTextBeforeCaret(e);
b.restoreProperties();"function"==typeof c.refreshElementContent&&c.refreshElementContent(b.getElement());(0<=a||e)&&b.getElement()==f.DOMEventHandlers.states.activeElement&&(f.DOMEventHandlers.states.changed=!0)};e.prototype.deadkeyOutput=function(a,b,e){this.resetContextCache();0<=a&&this.output(a,b,"");b.insertDeadkeyBeforeCaret(e)};e.prototype.ifStore=function(a,b,e){e=d.keyman.singleton;var c=!0;if(a==this.TSS_LAYER)c=e.osk.vkbd.layerId===b;else if(a==this.TSS_PLATFORM){var g=b.split(" ");for(a=
0;a<g.length;a++)switch(b=g[a].toLowerCase(),b){case "touch":case "hardware":e.util.activeDevice.touchable!=("touch"==b)&&(c=!1);break;case "macos":case "mac":b="macosx";case "macosx":case "windows":case "android":case "ios":case "linux":e.util.activeDevice.OS.toLowerCase()!=b&&(c=!1);break;case "tablet":case "phone":case "desktop":e.util.device.formFactor!=b&&(c=!1);break;case "web":"native"==e.util.device.browser&&(c=!1);break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "edge":case "opera":e.util.device.browser!=
b&&(c=!1);break;default:c=!1}}return c};e.prototype.setStore=function(a,b,e){e=d.keyman.singleton;this.resetContextCache();return a==this.TSS_LAYER?e.osk.vkbd.showLayer(b):!1};e.prototype.loadStore=function(a,b,e){var c=d.keyman.singleton;this.resetContextCache();a=c.util.loadCookie("KeymanWeb_"+a+"_Option_"+b);return"undefined"!=typeof a[b]?decodeURIComponent(a[b]):e};e.prototype.saveStore=function(a,b){var e=d.keyman.singleton;this.resetContextCache();var c=e.keyboardManager.activeKeyboard;if(!c||
"undefined"==typeof c.KI||""==c.KI)return!1;a="KeymanWeb_"+c.KI+"_Option_"+a;b=encodeURIComponent(b);e.util.saveCookie(a,b);return!0};e.prototype.resetContextCache=function(){this.cachedContext.reset();this.cachedContextEx.reset()};e.prototype.doInputEvent=function(a){var b;"function"==typeof window.InputEvent&&(b=new window.InputEvent("input",{bubbles:!0,cancelable:!1}));a.base&&a.base.kmw_ip&&(a=a.base);a&&b&&a.dispatchEvent(b)};e.prototype.defaultBackspace=function(a){a||(a=this.activeTargetOutput?
this.activeTargetOutput:k.Processor.getOutputTarget());this.output(1,a,"");a.getElement()&&this.doInputEvent(a.getElement())};e.prototype.processKeystroke=function(a,b,e){var c=d.keyman.singleton;if(!b)throw"No target specified for keyboard output!";b.invalidateSelection();b.deadkeys().resetMatched();this.resetContextCache();c.util.activeDevice=a;this.activeTargetOutput=b;a=c.keyboardManager.activeKeyboard.gs(b,e);this.activeTargetOutput=null;a&&b.getElement()&&this.doInputEvent(b.getElement());return a};
e.prototype.getLastActiveElement=function(){var a=d.keyman.singleton;return a.isHeadless?null:a.domManager.getLastActiveElement()};e.prototype.focusLastActiveElement=function(){var a=d.keyman.singleton;a.isHeadless||a.domManager.focusLastActiveElement()};e.prototype.hideHelp=function(){var a=d.keyman.singleton;a.isHeadless||a.osk._Hide(!0)};e.prototype.showHelp=function(a,b){var e=d.keyman.singleton;e.isHeadless||e.osk._Show(a,b)};e.prototype.showPinnedHelp=function(){var a=d.keyman.singleton;a.isHeadless||
(a.osk.userPositioned=!0,a.osk._Show(-1,-1))};e.prototype.resetContext=function(){var a=d.keyman.singleton;!a.isHeadless&&a.osk.vkbd&&(a.osk.vkbd.layerId="default");var b=this.activeTargetOutput?this.activeTargetOutput:k.Processor.getOutputTarget();b&&b.deadkeys().clear();this.resetContextCache();this.resetVKShift();a.isHeadless||a.osk._Show()};e.prototype.setNumericLayer=function(){var a=d.keyman.singleton,b;if(!a.isHeadless){var e=a.osk.vkbd;for(b=0;b<e.layers.length;b++)"numeric"==e.layers[b].id&&
(e.layerId="numeric",a.osk._Show())}};e.prototype.resetVKShift=function(){var a=d.keyman.singleton,b=d.keyman.singleton.textProcessor;a.isHeadless||a.uiManager.isActivating||!a.osk.vkbd||b._UpdateVKShift&&b._UpdateVKShift(null,15,0)};return e}();k.KeyboardInterface=g})(f.text||(f.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){var f=function(){function a(a,b){this.id=a;this.language=b}a.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};return a}(),h=function(){return function(a,b){this.family=a.family;this.files=a.source;this.path=b}}(),c=function(){return function(a,b){this.KI="Keyboard_"+a;this.KLC=b}}();d.KeyboardStub=c;var a=function(){return function(){this.stores={}}}();d.KeyboardTag=
a;var b=function(){function b(a){this.activeStub=null;this.keyboardStubs=[];this.deferredStubs=[];this.deferredKRS=[];this.deferredKR=[];this.dfltStub=null;this.keyboards=[];this.languageList=null;this.languagesPending=[];this.linkedScripts=[];this._GetKeyboardDetail=function(a){var b={};b.Name=a.KN;b.InternalName=a.KI;b.LanguageName=a.KL;b.LanguageCode=a.KLC;b.RegionName=a.KR;b.RegionCode=a.KRC;b.CountryName=a.KC;b.CountryCode=a.KCC;b.KeyboardID=a.KD;b.Font=a.KFont;b.OskFont=a.KOskFont;return b};
this.notifyKeyboard=function(a,b,e){var c=this.activeKeyboard;null!=c&&"function"==typeof c.KNS&&c.KNS(a,b,e)};this.keymanweb=a}b.prototype.getActiveKeyboardName=function(){return this.activeKeyboard?this.activeKeyboard.KI:""};b.prototype.getActiveKeyboardTag=function(){return this.activeKeyboard?this.activeKeyboard._kmw:null};b.prototype.getActiveLanguage=function(a){return null==this.activeStub?"":a?this.activeStub.KL:this.activeStub.KLC};b.prototype.getDetailedKeyboards=function(){var a=[],b;for(b=
0;b<this.keyboardStubs.length;b++){var c=this.keyboardStubs[b];c=this._GetKeyboardDetail(c);a=this.keymanweb._push(a,c)}return a};b.prototype.registerDeferredStubs=function(){this.addKeyboardArray(this.deferredStubs);for(var a=0;a<this.deferredKRS.length;a++)this._registerStub(this.deferredKRS[a])};b.prototype.registerDeferredKeyboards=function(){for(var a=0;a<this.deferredKR.length;a++)this._registerKeyboard(this.deferredKR[a])};b.prototype.addStub=function(a){if("string"!=typeof a.id)return!1;"undefined"!=
typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var b=a.languages,c=[];"undefined"==typeof b.length?c[0]=b:c=b;var e={keyboardBaseUri:this.keymanweb.options.keyboards,fontBaseUri:this.keymanweb.options.fonts};for(b=0;b<c.length;b++)this.mergeStub(a,
c[b],e);return!0};b.prototype.mergeStub=function(a,d,g){var e=this.findStub(a.id,d.id),f=!1;null==e&&(e=new c(a.id,d.id),this.keyboardStubs.push(e),f=!0);var m=d.region,k=0;if("number"==typeof m)k=1>m||9<m?0:m-1;else if("string"==typeof m)for(var q=2==m.length?b.regionCodes:b.regions,t=0;t<q.length;t++)if(m.toLowerCase()==q[t].toLowerCase()){k=t;break}e.KL="undefined"===typeof e.KL?d.name:e.KL;e.KR="undefined"===typeof e.KR?b.regions[k]:e.KR;e.KRC="undefined"===typeof e.KRC?b.regionCodes[k]:e.KRC;
e.KN="undefined"===typeof e.KN?a.name:e.KN;"undefined"==typeof e.KF&&(m=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,e.KF=a.filename,m.test(e.KF)||(e.KF=g.keyboardBaseUri+e.KF));a=g.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,m=/^https?\:/,m.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=a;"undefined"!=typeof d.font&&(e.KFont="undefined"===typeof e.KFont?
new h(d.font,a):e.KFont);"undefined"!=typeof d.oskFont&&(e.KOskFont="undefined"===typeof e.KOskFont?new h(d.oskFont,a):e.KOskFont);this.doKeyboardRegistered(e.KI,e.KL,e.KN,e.KLC,e.KP);!this.activeStub&&f&&1==this.keyboardStubs.length&&(this.doBeforeKeyboardChange(e.KI,e.KLC),this._SetActiveKeyboard(e.KI,e.KLC,!1),this.doKeyboardChange(e.KI,e.KLC))};b.prototype.findStub=function(a,b){var e;for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI=="Keyboard_"+a&&this.keyboardStubs[e].KLC==
b)return this.keyboardStubs[e];return null};b.prototype.setDefaultKeyboard=function(){return 0<this.keyboardStubs.length?(this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC),!0):!1};b.prototype.setActiveKeyboard=function(a,b){!this.keymanweb.isEmbedded&&a&&0!=a.indexOf("Keyboard_")&&(a="Keyboard_"+a);this.doBeforeKeyboardChange(a,b);var e=this._SetActiveKeyboard(a,b,!0);null!=this.keymanweb.domManager.getLastActiveElement()&&this.keymanweb.domManager.focusLastActiveElement();
this.doKeyboardChange(a,b);return e};b.prototype._SetActiveKeyboard=function(a,b,c){var e,d,g=this.keymanweb.util,f=this.keymanweb.osk;if(2>arguments.length||!b)b="---";for(e=0;e<this.keyboardStubs.length&&(a!=this.keyboardStubs[e].KI||b!=this.keyboardStubs[e].KLC&&"---"!=b);e++);g.device.touchable&&(""==a||null==a||e>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,b=this.keyboardStubs[0].KLC);2<arguments.length&&c&&this.saveCurrentKeyboard(a,b);if(this.activeStub&&
this.activeKeyboard&&this.activeKeyboard.KI==a&&this.activeStub.KI==a&&this.activeStub.KLC==b&&!this.keymanweb.mustReloadKeyboard)return Promise.resolve();if(this.activeKeyboard&&this.activeKeyboard.KI==a)for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==a&&this.keyboardStubs[d].KLC==b)return this.activeStub=this.keyboardStubs[d],f.vkbd.appendStyleSheet(),this.keymanweb.mustReloadKeyboard&&f._Load(),Promise.resolve();this.activeStub=this.activeKeyboard=null;if(""==a)return f._Hide(!1),
this.keymanweb.isEmbedded||g.wait(!1),Promise.resolve();for(d=0;d<this.keyboards.length;d++)if(this.keyboards[d].KI==a){this.activeKeyboard=this.keyboards[d];this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement());for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&(this.keyboardStubs[e].KLC==b||"---"==b)){this.activeStub=this.keyboardStubs[e];break}break}if(null==this.activeKeyboard){for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==
a&&(this.keyboardStubs[d].KLC==b||"---"==b)){if(this.isCJK(this.keyboardStubs[d])||g.device.touchable)f._Enabled=!0;if(!this.keyboardStubs[d].asyncLoader){f.ready&&f._Hide(!1);var m=this.keyboardStubs[d];m.asyncLoader={};var h=m.KN,k=m.KL;h=h.replace(/\s*keyboard\s*/i,"");m.asyncLoader.callback=function(a,b){var e=a||"Sorry, the "+h+" keyboard for "+k+" is not currently available.";this.keymanweb.isEmbedded||(g.wait(!1),g.alert(a||e,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(b){case "err":console.error(e);
break;default:console.warn(e)}0<d&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);m.asyncLoader.timer=window.setTimeout(m.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||g.wait("Installing keyboard<br/>"+h);var t=this;m.asyncLoader.promise=new Promise(function(a,b){window.setTimeout(function(){t.installKeyboard(a,b,m)},0)})}this.activeStub=this.keyboardStubs[d];return this.keyboardStubs[d].asyncLoader.promise}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement())}e=
this.activeKeyboard;null!==e&&String.kmwEnableSupplementaryPlane(e&&(e.KS&&1==e.KS||"Hieroglyphic"==e.KN));f._Load();return Promise.resolve()};b.prototype.installKeyboard=function(a,b,c){var e=this.keymanweb.util,d=this.keymanweb.osk,g=e._CreateElement("script");g.charset="UTF-8";g.type="text/javascript";this.keymanweb.isEmbedded&&(g.id=c.KI);var f=c.KF,m=c.KL,h=c.KN,k=this;g.addEventListener("error",function(){null!==c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=
null);c.asyncLoader.callback("Cannot find the "+h+" keyboard for "+m+".","warn");c.asyncLoader=null;b()},!1);g.addEventListener("load",function(){null!==c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=null);var g=k.getKeyboardByID(c.KI);g?(c==k.activeStub&&(k.doBeforeKeyboardChange(g.KI,c.KLC),k.activeKeyboard=g,null!=k.keymanweb.domManager.getLastActiveElement()&&(k.keymanweb.uiManager.justActivated=!0,k.keymanweb.domManager._SetTargDir(k.keymanweb.domManager.getLastActiveElement())),
String.kmwEnableSupplementaryPlane(g&&(g.KS&&1==g.KS||"Hieroglyphic"==g.KN)),k.saveCurrentKeyboard(g.KI,c.KLC),d._Load()),k.keymanweb.isEmbedded||e.wait(!1),c.asyncLoader=null,a()):(c.asyncLoader.callback("Error registering the "+h+" keyboard for "+m+".","error"),c.asyncLoader=null,b())},!1);g.src=this.keymanweb.getKeyboardPath(f);try{document.body.appendChild(g),this.linkedScripts.push(g)}catch(v){try{document.getElementsByTagName("head")[0].appendChild(g)}catch(B){b()}}};b.prototype.saveCurrentKeyboard=
function(a,b){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b});this.keymanweb.isEmbedded||this.keymanweb.touchAliasing._BlurKeyboardSettings(a,b)};b.prototype.restoreCurrentKeyboard=function(){var a=this.keyboardStubs,b=a.length;if(!(1>a.length)){var c=this.getSavedKeyboard();c.split(":");var d=c.split(":");2>d.length&&(d[1]="");for(c=0;c<b&&(a[c].KI!=d[0]||a[c].KLC!=d[1]&&""!=d[1]);c++);if(c<b||null==this.activeKeyboard)this._SetActiveKeyboard(d[0],d[1],!1),this.keymanweb.globalKeyboard=
d[0],this.keymanweb.globalLanguageCode=d[1],this.doKeyboardChange(d[0],d[1])}};b.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");if("string"!=typeof a.current)return"Keyboard_us:eng";var b,c=this.keyboardStubs;for(b=0;b<c.length;b++){var d=c[b].KI+":"+c[b].KLC;if(d==a.current)return d}for(b=0;b<c.length;b++)if(d=c[b].KI+":"+c[b].KLC,"Keyboard_us:eng"==d)return d;return 0<c.length?c[0].KI+":"+c[0].KLC:"Keyboard_us:eng"};b.prototype.isCJK=function(a){var b=
this.activeKeyboard,c="";0<arguments.length&&(b=a);b&&("undefined"!=typeof b.KLC?c=b.KLC:"undefined"!=typeof b.LanguageCode&&(c=b.LanguageCode));return"cmn"==c||"jpn"==c||"kor"==c};b.prototype.isRTL=function(a){a=a||this.activeKeyboard;return null!=a&&a.KRTL};b.prototype.isChiral=function(a){"string"==typeof a&&(a=this.getKeyboardByID(a));return!!(this.getKeyboardModifierBitmask(a)&d.text.Codes.modifierBitmasks.IS_CHIRAL)};b.prototype.getKeyboardModifierBitmask=function(a){var b=this.activeKeyboard;
0<arguments.length&&"undefined"!=typeof a&&(b=a);return b?b.KMBM?b.KMBM:d.text.Codes.modifierBitmasks.NON_CHIRAL:0};b.prototype.getFont=function(a){return(a=a||this.activeKeyboard)&&a.KV?a.KV.F:null};b.prototype.getKeyboardByID=function(a){var b;for(b=0;b<this.keyboards.length;b++)if(a==this.keyboards[b].KI)return this.keyboards[b];return null};b.prototype.isUniqueRequest=function(a,b){var c;if(null==this.findStub(b.id,b.language)){for(c=0;c<a.length;c++)if(a[c].id==b.id&&a[c].language==b.language)return!1;
return!0}return!1};b.prototype.addKeyboardArray=function(a){if(!this.keymanweb.initialized)for(var b=0;b<a.length;b++)this.deferredStubs.push(a[b]);else if(0!=a.length){var c,e="",d=[];for(b=0;b<a.length;b++){if("string"==typeof a[b]&&0<a[b].length){var g=a[b].split("@"),h=[""];"english"==g[0].toLowerCase()&&(g[0]="us");1<g.length&&(h=g[1].split(","));for(c=0;c<h.length;c++){var k=new f(g[0]);""!=h[c]&&(k.language=h[c]);2<g.length&&(k.version=g[2]);this.isUniqueRequest(d,k)&&d.push(k)}}if("object"==
typeof a[b]&&null!=a[b])if("string"==typeof a[b].filename)this.addStub(a[b])||alert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");else if(a[b].language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[b].languages=a[b].language),h=a[b].languages,"number"==typeof h.length)for(c=0;c<h.length;c++)k=new f(a[b].id,a[b].languages[c].id),this.isUniqueRequest(d,
k)&&d.push(k);else k=new f(a[b].id,a[b].languages[c].id),this.isUniqueRequest(d,k)&&d.push(k)}if(0!=d.length){a="&keyboardid=";for(b=0;b<d.length;b++)a=a+e+d[b].toString(),e=",";this.keymanCloudRequest(a,!1)}}};b.prototype.registerLanguagesForKeyboard=function(a,b,c){var e,d=0;var g="";if("undefined"!=typeof a)if("string"==typeof b.keyboardid&&(g=b.keyboardid.split(",")[c]),"number"==typeof a.length)if(1==a.length||"$"==g.substr(-1,1)||""==g)for(g=0;g<a.length;g++)this.registerLanguagesForKeyboard(a[g],
b,c);else{for(g=0;g<a.length;g++){var f=a[g].id.toLowerCase();"us"==f&&(f="english");for(e=0;e<a[g].languages.length;e++)if(f==a[g].languages[e].name.toLowerCase()){d=g;break}}this.registerLanguagesForKeyboard(a[d],b,c)}else if(c=g.split("@")[1],"string"==typeof c&&(c=c.replace(/\$$/,"")),d=a.languages,"undefined"!=typeof d)if("number"==typeof d.length)for(g=0;g<d.length;g++)"undefined"!=typeof c&&d[g].id!=c||this.mergeStub(a,d[g],b);else this.mergeStub(a,d,b)};b.prototype.register=function(a){var b=
a.options;a.timerid&&window.clearTimeout(a.timerid);if("string"==typeof a.error)b="","string"==typeof a.keyboardid&&(b=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),this.serverUnavailable(b+" keyboard not found.");else if("undefined"!=typeof b&&"undefined"!=typeof b.context)if("keyboard"==b.context){var c=a.keyboard;if("number"==typeof c.length)for(a=0;a<c.length;a++)this.registerLanguagesForKeyboard(c[a],b,a);else this.registerLanguagesForKeyboard(c,b,0)}else"language"==b.context&&
(this.languageList=a.languages,this.languagesPending&&this.addLanguageKeyboards(this.languagesPending),this.languagesPending=[])};b.prototype.addLanguageKeyboards=function(a){var b,c;if(null==this.languageList){var e=0==this.languagesPending.length;for(b=0;b<a.length;b++)this.languagesPending.push(a[b]);e&&this.keymanCloudRequest("",!0)}else{var d="";for(b=0;b<a.length;b++){var g=a[b].toLowerCase();(c="$"==g.substr(-1,1))&&(g=g.substr(0,g.length-1));for(e=0;e<this.languageList.length;e++)if(g==this.languageList[e].name.toLowerCase()){""!=
d&&(d+=",");d=d+"@"+this.languageList[e].id;c&&(d+="$");break}}""==d?this.keymanweb.util.alert("No keyboards are available for "+a[0]+". Does it have another language name?"):this.keymanCloudRequest("&keyboardid="+d,!1)}};b.prototype.keymanCloudRequest=function(a,b){var c="https://api.keyman.com/cloud/4.0/",e=this.keymanweb.util._CreateElement("script");c=c+(1<arguments.length&&b?"languages":"keyboards")+"?jsonp=keyman.register&languageidtype=bcp47&version="+this.keymanweb.version+"."+d.KeymanBase.__BUILD__;
var g=this;var f="&timerid="+window.setTimeout(function(){g.serverUnavailable(a)},1E4);e.charset="UTF-8";e.src=c+a+f;e.type="text/javascript";try{document.body.appendChild(e)}catch(n){document.getElementsByTagName("head")[0].appendChild(e)}};b.prototype.serverUnavailable=function(a){this.keymanweb.util.alert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};b.prototype.removeKeyboards=function(a){if(0==arguments.length)return!1;var b,c,e=!0,d=!1,g=!1;for(b=0;b<arguments.length;b++){for(c=
this.keyboardStubs.length-1;0<=c;c--)if("Keyboard_"+arguments[b]==this.keyboardStubs[c].KI){"Keyboard_"+arguments[b]==this.getActiveKeyboardName()&&(d=!0);g=!0;this.keyboardStubs.splice(c,1);break}0>c&&(e=!1)}d&&(0<this.keyboardStubs.length?this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);g&&this.doKeyboardUnregistered();return e};b.prototype._registerKeyboard=function(b){if(this.keymanweb.initialized)if(b._kmw)console.error("The keyboard _kmw property is a reserved field for engine use only; this keyboard is invalid.");
else{b._kmw=new a;var c;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(b);var e=this.activeStub,d=this.activeStub;if(!(e&&"KI"in e)||e.KI!=b.KI)for(c=0;c<this.keyboardStubs.length;c++){e=this.keyboardStubs[c];if(b.KI==e.KI)break;e=null}null==this.activeStub&&null!=e&&(this.activeStub=e);for(c=0;c<this.keyboards.length;c++)if(b.KI==this.keyboards[c].KI)return;this.keyboards=this.keymanweb._push(this.keyboards,b);this.doKeyboardLoaded(b.KI);this.activeStub=d}else this.deferredKR.push(b)};b.prototype._registerStub=
function(a){var b;if(!this.keymanweb.initialized)return this.deferredKRS.push(a),null;null==this.dfltStub&&(this.dfltStub=a);this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==typeof a.KL&&(a.KL="undefined");for(b=0;b<this.keyboardStubs.length;b++)if(this.keyboardStubs[b].KI==a.KI&&(""==a.KLC||this.keyboardStubs[b].KLC==a.KLC))return 1;this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a);this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,
a.KP);this.activeStub||this.dfltStub!=a||1!=this.keyboardStubs.length||this.setActiveKeyboard(a.KI,a.KLC);return null};b.prototype.doKeyboardRegistered=function(a,b,c,d,g){a={internalName:a,language:b,keyboardName:c,languageCode:d};g&&(a["package"]=g);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};b.prototype.doKeyboardUnregistered=function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};b.prototype.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",
b)};b.prototype.doBeforeKeyboardChange=function(a,b){var c={};c.internalName=a;c.languageCode=b;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",c)};b.prototype.doKeyboardChange=function(a,b,c){var e={};e.internalName=a;e.languageCode=b;e.indirect=2<arguments.length?c:!1;return this.keymanweb.util.callEvent("kmw.keyboardchange",e)};b.prototype.shutdown=function(){for(var a=0,b=this.linkedScripts;a<b.length;a++){var c=b[a];c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)}};
b.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");b.regionCodes="un af as eu sa na oc ca me".split(" ");return b}();d.KeyboardManager=b})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){var f=function(){return function(){}}(),h=function(){return function(){this.FF=new f;this.Safari=new f;this.Opera=new f;this.FF.k61=187;this.FF.k59=186}}(),c=function(){return function(){this.se=new f;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new f;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),a=function(){function a(){this.browserMap=new h;this.languageMap=
new c;this._usCodeInit()}a.prototype._usCodeInit=function(){var a=new f,b=new f;a.k192=96;a.k49=49;a.k50=50;a.k51=51;a.k52=52;a.k53=53;a.k54=54;a.k55=55;a.k56=56;a.k57=57;a.k48=48;a.k189=45;a.k187=61;a.k81=113;a.k87=119;a.k69=101;a.k82=114;a.k84=116;a.k89=121;a.k85=117;a.k73=105;a.k79=111;a.k80=112;a.k219=91;a.k221=93;a.k220=92;a.k65=97;a.k83=115;a.k68=100;a.k70=102;a.k71=103;a.k72=104;a.k74=106;a.k75=107;a.k76=108;a.k186=59;a.k222=39;a.k90=122;a.k88=120;a.k67=99;a.k86=118;a.k66=98;a.k78=110;a.k77=
109;a.k188=44;a.k190=46;a.k191=47;b.k192=126;b.k49=33;b.k50=64;b.k51=35;b.k52=36;b.k53=37;b.k54=94;b.k55=38;b.k56=42;b.k57=40;b.k48=41;b.k189=95;b.k187=43;b.k81=81;b.k87=87;b.k69=69;b.k82=82;b.k84=84;b.k89=89;b.k85=85;b.k73=73;b.k79=79;b.k80=80;b.k219=123;b.k221=125;b.k220=124;b.k65=65;b.k83=83;b.k68=68;b.k70=70;b.k71=71;b.k72=72;b.k74=74;b.k75=75;b.k76=76;b.k186=58;b.k222=34;b.k90=90;b.k88=88;b.k67=67;b.k86=86;b.k66=66;b.k78=78;b.k77=77;b.k188=60;b.k190=62;b.k191=63;this._usCharCodes=[a,b]};a.prototype._USKeyCodeToCharCode=
function(a){return this._usCharCodes[a.Lmodifiers&16?1:0]["k"+a.Lcode]};return a}();d.KeyMapManager=a})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){var f=function(){function c(a,b,c){this.code=a;this.shift=b;this.handler=c}c.prototype.matches=function(a,b){return this.code==a&&this.shift==b};return c}(),h=function(){function c(a){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var b=this.keyman.textProcessor._GetEventKeyCode(a);if(null==b)return!1;for(var c=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),d=0;d<this.hotkeys.length;d++)if(this.hotkeys[d].matches(b,c))return this.hotkeys[d].handler(),a.returnValue=
!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=a}c.prototype.addHotKey=function(a,b,c){for(var e=0;e<this.hotkeys.length;e++)if(this.hotkeys[e].code==a&&this.hotkeys[e].shift==b){this.hotkeys[e].handler=c;return}this.hotkeys.push(new f(a,b,c))};c.prototype.removeHotkey=function(a,b){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].matches(a,b)){this.hotkeys.splice(c,1);break}};return c}();d.HotkeyManager=h})(d.keyman||(d.keyman={}))})(com||
(com={}));
(function(d){(function(d){var f=function(){return function(c,a){this.activationPending=c;this.activated=a}}();d.UIState=f;var h=function(){function c(a){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",{})};this.keyman=a}c.prototype.getUIState=function(){return new f(this.isActivating,this.justActivated)};c.prototype.setActivatingUI=function(a){this.isActivating=a?!0:!1};c.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};
return c}();d.UIManager=h})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(f){var h=d.keyman.text.Codes,c=function(){function a(){}a.buildDefaultLayout=function(b,c,e){var g=d.keyman.singleton.util,k=e;"object"!=typeof a.dfltLayout[k]&&(k="desktop");k=g.deepCopy(a.dfltLayout[k]);var l,p=k.layer,r=b.KLS,n=b.K102,q,u=0!=(c&h.modifierBitmasks.IS_CHIRAL);(c=!("undefined"==typeof r||!r))||(r=b.KLS=a.processLegacyDefinitions(b.BK));b=Object.getOwnPropertyNames(r);var w=[];b.splice(b.indexOf("default"),1);b=["default"].concat(b);a.emulatesAltGr(r)&&
(-1==b.indexOf("leftctrl-leftalt")&&-1!=b.indexOf("rightalt")&&(b.push("leftctrl-leftalt"),r["leftctrl-leftalt"]=r.rightalt),-1==b.indexOf("leftctrl-leftalt-shift")&&-1!=b.indexOf("rightalt-shift")&&(b.push("leftctrl-leftalt-shift"),r["leftctrl-leftalt-shift"]=r["rightalt-shift"]));if("desktop"==e)for(w=a.generateLayerIds(u),l=0;l<w.length;l++)-1!=b.indexOf(w[l])&&w.splice(l--,1);var v=b.concat(w);if(c&&"desktop"!=e){c=null;w=p[0].row;for(l=0;l<w.length;l++){var B=w[l].key;for(var D=0;D<B.length;D++){var y=
B[D];"K_SHIFT"==y.id&&(c=y)}}if(c)for(q in c.sk=[],r)"default"!=q&&"shift"!=q&&(l=a.modifierSpecials[q],c.sk.push(new f.OSKKeySpec("K_"+l,l,null,"1",q)));else console.warn("Error in default layout - cannot find default Shift key!")}for(l=0;l<v.length;l++)0<l&&(p[l]=g.deepCopy(p[0])),p[l].id=v[l],p[l].nextlayer=v[l],a.formatDefaultLayer(p[l],u,e,!!n);for(l=0;l<p.length;l++){n=p[l];D=v=u=c=null;var K=r[n.id],L="shift"==n.id?1:0,N="default"==n.id||L?1:0;w=n.row;for(g=0;g<w.length;g++)for(B=w[g].key,
q=0;q<B.length;q++){y=B[q];var E=a.dfltCodes.indexOf(y.id);if(K||N)K&&0<=E&&E<K.length&&(y.text=K[E]),N&&"K_SPACE"!=y.id&&E+65*L<a.dfltText.length&&null!==y.text&&(y.text=y.text||a.dfltText[E+65*L]);null!==y.text&&(y.text=y.text||"");switch(y.id){case "K_SHIFT":c=y;break;case "K_CAPS":u=y;break;case "K_NUMLOCK":v=y;break;case "K_SCROLL":D=y}if(null!=y.sk){for(E=0;E<y.sk.length;E++)-1==b.indexOf(y.sk[E].nextlayer)&&y.sk.splice(E--,1);0==y.sk.length&&(y.sk=null)}}n.shiftKey=c;n.capsKey=u;n.numKey=v;
n.scrollKey=D;"desktop"!=e&&0<l&&null!=c&&(c.sp=a.buttonClasses["SHIFT-ON"],c.sk=null,c.text=a.modifierSpecials[p[l].id]?a.modifierSpecials[p[l].id]:"*Shift*")}return k};a.getLayerId=function(a){var b=h.modifierCodes,c="";if(0==a)return"default";a&b.LCTRL&&(c=(0<c.length?c+"-":"")+"leftctrl");a&b.RCTRL&&(c=(0<c.length?c+"-":"")+"rightctrl");a&b.LALT&&(c=(0<c.length?c+"-":"")+"leftalt");a&b.RALT&&(c=(0<c.length?c+"-":"")+"rightalt");a&b.SHIFT&&(c=(0<c.length?c+"-":"")+"shift");a&b.CTRL&&(c=(0<c.length?
c+"-":"")+"ctrl");a&b.ALT&&(c=(0<c.length?c+"-":"")+"alt");return c};a.emulatesAltGr=function(b){var c=window.keyman,e=h.modifierCodes;if(!c.keyboardManager.isChiral())return!1;if(!b){b=c.keyboardManager.activeKeyboard;if(null==b||null==b.KV)return!1;b=b.KV.KLS}var d=e.LCTRL|e.LALT,f=b[a.getLayerId(d)];d=b[a.getLayerId(e.SHIFT|d)];return null!=f&&f!=b[a.getLayerId(e.RALT)]||null!=d&&d!=b[a.getLayerId(e.RALT|e.SHIFT)]?!1:(c.keyboardManager.getKeyboardModifierBitmask(),!0)};a.generateLayerIds=function(b){if(b){b=
32;var c=1}else b=8,c=16;for(var e=[],d=0;d<b;d++)e.push(a.getLayerId(d*c));return e};a.formatDefaultLayer=function(b,c,e,d){for(var g=b.id,f=a.buttonClasses,h=0;h<b.row.length;h++)for(var k=b.row[h].key,n=0;n<k.length;n++){var m=k[n];switch(m.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=g.indexOf("shift")&&(m.sp=f["SHIFT-ON"]);"desktop"!=e&&"default"!=g&&(m.nextlayer="default");break;case "K_LCTRL":case "K_LCONTROL":if(c){-1!=g.indexOf("leftctrl")&&(m.sp=f["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(c){-1!=
g.indexOf("rightctrl")&&(m.sp=f["SHIFT-ON"]);break}case "K_CONTROL":-1==g.indexOf("ctrl")||c&&(-1==g.indexOf("leftctrl")||-1==g.indexOf("rightctrl"))||(m.sp=f["SHIFT-ON"]);break;case "K_LALT":if(c){-1!=g.indexOf("leftalt")&&(m.sp=f["SHIFT-ON"]);break}case "K_RALT":if(c){-1!=g.indexOf("rightalt")&&(m.sp=f["SHIFT-ON"]);break}case "K_ALT":-1==g.indexOf("alt")||c&&(-1==g.indexOf("leftalt")||-1==g.indexOf("rightalt"))||(m.sp=f["SHIFT-ON"]);break;case "K_oE2":"undefined"!=typeof d&&d||("desktop"==e?(k.splice(n--,
1),k[0].width="200"):k[n].sp=f.HIDDEN)}}};a.processLegacyDefinitions=function(b){for(var c=a.generateLayerIds(!1),e={},d=0;d<c.length;d++){for(var f=c[d],h=[],k=!1,r=0;65>r;r++){var n=r+65*d;h.push(b[n]);n<b.length&&""!=b[n]&&r!=a.dfltCodes.indexOf("K_SPACE")&&(k=!0)}k&&(e[f]=h)}"undefined"!=typeof e["default"]&&e["default"]||(e["default"]=[""]);"undefined"!=typeof e.shift&&e.shift||(e.shift=[""]);return e};a.dfltCodes="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
a.dfltText="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ ";a.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};a.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",alt:"*Alt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*",ctrl:"*Ctrl*","ctrl-alt":"*AltGr*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*","leftctrl-leftalt-shift":"*LAltCtrlShift*",
"rightctrl-rightalt-shift":"*RAltCtrlShift*",shift:"*Shift*","shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};a._BaseLayout="us";a._BaseLayoutEuro={se:"\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ",uk:"`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ "};a.dfltLayout={desktop:{font:"Tahoma,Helvetica",
layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",
sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",
width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},
{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"200"}]}]}]},phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},
{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"200",sp:"1"}]}]}]}};return a}();f.Layouts=c})(f.osk||(f.osk={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(k){var h=function(){function c(a){this.keyman=a;this.scrolling=!1;this.shim=this.constructShim()}c.prototype.constructShim=function(){var a=this,b=this.keyman.util._CreateElement("div"),c=this.keyman.osk;b.id="kmw-language-menu-background";b.addEventListener("touchstart",function(b){b.preventDefault();a.hide();if(2<b.touches.length){var e=b.touches[1].pageX;b=b.touches[1].pageY;var d=c.vkbd.spaceBar;e>d.offsetLeft&&e<d.offsetLeft+d.offsetWidth&&b>d.offsetTop&&b<
d.offsetTop+d.offsetHeight&&c.showBuild()}},!1);return b};c.prototype.show=function(){var a=this.keyman.keyboardManager.keyboardStubs,b=this.keyman.util;if(!(1>a.length)){var c=this.lgList=b._CreateElement("div");this.lgList.id="kmw-language-menu";var d=this;document.body.appendChild(this.shim);var f=b._CreateElement("div"),h=f.style,k=b._CreateElement("div");f.id="kmw-menu-scroll-container";k.id="kmw-menu-scroller";"WebkitOverflowScrolling"in h&&(h.WebkitOverflowScrolling="touch");f.appendChild(k);
c.appendChild(f);var p;h=b._CreateElement("div");h.id="kmw-menu-index";for(p=1;26>=p;p++){var r=b._CreateElement("p");r.innerHTML=String.fromCharCode(p+64);h.appendChild(r)}h.addEventListener("touchstart",function(a){d.scrollToLanguage(a,f,k)},!1);h.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},!1);c.appendChild(h);c.addEventListener("scroll",function(a){d.scrolling=!0},!1);f.addEventListener("scroll",function(a){1>f.scrollTop&&(f.scrollTop=1);f.scrollTop>f.scrollHeight-
f.offsetHeight-1&&(f.scrollTop=f.scrollHeight-f.offsetHeight-1)},!1);this.activeLgNo=this.addLanguages(k,a);this.lgList.style.visibility="hidden";document.body.appendChild(this.lgList);"Android"==b.device.OS&&"devicePixelRatio"in window&&(this.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==b.device.OS&&"tablet"==b.device.formFactor&&"devicePixelRatio"in window&&(p=parseInt(b.getStyleValue(c,"width"),10),a=c.style,isNaN(p)||(a.width=a.maxWidth=2*p/window.devicePixelRatio+"px"),p=
parseInt(b.getStyleValue(f,"width"),10),a=f.style,isNaN(p)||(a.width=a.maxWidth=2*p/window.devicePixelRatio+"px"),p=parseInt(b.getStyleValue(k,"width"),10),a=k.style,isNaN(p)||(a.width=a.maxWidth=2*p/window.devicePixelRatio+"px"));this.adjust(0);b=Math.floor(c.offsetHeight/26);a=Math.round(100*b/(h.childNodes[1].offsetTop-h.childNodes[0].offsetTop))/100;r=.6<a?1:2;1.25<a&&(a=1.25);for(p=0;26>p;p++){var n=h.childNodes[p].style;2==r&&1==p%2?n.display="none":(n.fontSize=a*r+"em",n.lineHeight=b*r+"px")}p=
f.offsetWidth;f.scrollHeight>f.offsetHeight+3?p+=h.offsetWidth:h.style.display="none";c.style.width=p+"px";this.lgList.style.visibility="";c=k.firstChild.offsetHeight*this.activeLgNo+1;f.scrollTop=c;f.scrollTop<c&&(f.scrollTop=f.scrollHeight-f.offsetHeight);f.scrollTop>f.scrollHeight-f.offsetHeight-1&&(f.scrollTop=f.scrollHeight-f.offsetHeight-1)}};c.prototype.adjust=function(a){var b=this.keyman.osk,c=this.keyman.util,d=c.device,h=this.lgList,k=h.firstChild,l=k.firstChild,p=h.style;h=h.childNodes[1];
var r=window.innerHeight-b.vkbd.lgKey.offsetHeight-16;a=(l.childNodes.length+a-1)*l.firstChild.firstChild.offsetHeight;"iOS"==d.OS&&("phone"==d.formFactor?(d=c.landscapeView()?36:0,r=(window.innerHeight-d-16)*c.getViewportScale()):"tablet"==d.formFactor&&(d=c.landscapeView()?16:0,r-=d));p.left=f.dom.Utils.getAbsoluteX(b.vkbd.lgKey)+"px";a>r&&(a=r);p.height=a+"px";p.top=f.dom.Utils.getAbsoluteY(b._Box)+b._Box.offsetHeight-a+window.pageYOffset-6+"px";p.bottom="auto";h.style.height=k.style.height=p.height};
c.prototype.scrollToLanguage=function(a,b,c){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();var d=a.touches[0].target;if("P"==d.nodeName){var g;a=0;d=d.innerHTML.charCodeAt(0);var f=c.childNodes;try{for(g=0;g<f.length-1;g++){var h=f[g].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(h>=d)break}}catch(p){}try{a=c.firstChild.offsetHeight*g+1,b.scrollTop=a}catch(p){a=0}try{b.scrollTop<a&&(b.scrollTop=b.scrollHeight-b.offsetHeight),b.scrollTop>b.scrollHeight-b.offsetHeight-1&&
(b.scrollTop=b.scrollHeight-b.offsetHeight-1)}catch(p){}}};c.prototype.addLanguages=function(a,b){var c=b.length,d=this.keyman.util,f=d.device,h,k,p=[];for(k=0;k<c;k++){var r=b[k].KL;-1==p.indexOf(r)&&p.push(r)}p.sort();var n=Math.round(100/d.getViewportScale())/100,q,u,w,v,B=-1;r=function(){q=d._CreateElement("div");q.className="kbd-list-closed";u=d._CreateElement("p");u.kList=[];for(k=0;k<c;k++)b[k].KL==p[h]&&u.kList.push(b[k]);"iOS"==f.OS&&(u.style.fontSize=n+"em");q.appendChild(u);a.appendChild(q);
p[h]==D.keyman.keyboardManager.activeStub.KL&&(B=h);var e=D;if(1<u.kList.length)for(u.className="kbd-list",u.innerHTML=p[h]+"...",u.scrolled=!1,u.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";e.adjust("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},u.addEventListener("touchstart",function(a){a.stopPropagation()},!1),u.addEventListener("touchmove",
function(a){a.target.scrolled=!0;a.stopPropagation()},!1),w=0;w<u.kList.length;w++)v=d._CreateElement("p"),v.className="kbd-list-entry","iOS"==f.OS&&(v.style.fontSize=n+"em"),D.addKeyboard(u.kList[w],v,!1),q.appendChild(v);else u.innerHTML=p[h],u.className="kbd-single-entry",D.addKeyboard(u.kList[0],u,!0);h==B&&(u.className+=" current")};var D=this;for(h=0;h<p.length;h++)r();r=d._CreateElement("div");r.id="kmw-menu-footer";var y=function(a){a.preventDefault();a.stopPropagation()};r.addEventListener("touchstart",
y,!1);r.addEventListener("touchmove",y,!1);r.addEventListener("touchend",y,!1);a.appendChild(r);return B};c.prototype.addKeyboard=function(a,b,c){b.kn=a.KI;b.kc=a.KLC;b.innerHTML=c?a.KL:a.KN.replace(" Keyboard","");var e=this;a=function(a){a.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");e.scrolling=!1;e.y0=a.touches[0].pageY;return!0};c=function(a){a.stopImmediatePropagation();var b=e.lgList.childNodes[0],c=b.scrollHeight-b.offsetHeight;if("undefined"!=typeof a.pageY)var d=
a.pageY;else if("undefined"!=typeof a.touches)d=a.touches[0].pageY;else return;var g=d-e.y0;if(0>g)b.scrollTop>=c-1&&(a.preventDefault(),e.y0=d);else if(0<g)2>b.scrollTop&&(a.preventDefault(),e.y0=d);else return;if(-5>g||5<g)e.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),e.y0=d;return!0};var g=function(a){a.preventDefault();"undefined"!=typeof a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation();e.scrolling?this.className=this.className.replace(/\s*selected/,
""):(d.keyman.DOMEventHandlers.states.setFocusTimer(),e.lgList.style.display="none",e.keyman.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),e.keyman.keyboardManager.doKeyboardChange(this.kn,this.kc),e.keyman.domManager.focusLastActiveElement(),e.hide(),e.keyman.osk._Show());return!0};b.onmspointerdown=a;b.addEventListener("touchstart",a,!1);b.onmspointermove=c;b.addEventListener("touchmove",c,!1);b.onmspointerout=g;b.addEventListener("touchend",g,!1)};c.prototype.hide=function(){var a=this.keyman.osk,
b=this;this.lgList&&(a.vkbd.highlightKey(a.vkbd.lgKey,!1),this.lgList.style.visibility="hidden",window.setTimeout(function(){b.shim.parentElement&&(document.body.removeChild(b.shim),document.body.removeChild(b.lgList))},500))};return c}();k.LanguageMenu=h})(f.osk||(f.osk={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(k){function h(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);return a}function c(a){return a&&"key"in a&&a.key instanceof m}function a(a){return c(a)?a:null}var b=d.keyman.text.Codes,g=function(){return function(a,b){this.key=a;this.keyId=b}}();k.isKey=c;k.getKeyFrom=a;var e=function(){return function(a,b,c,d,e,g){this.id=a;this.text=b;this.width=c?c:"50";this.sp=d;this.nextlayer=e;this.pad=g}}();k.OSKKeySpec=e;var m=function(){function a(a){this.spec=a}a.getTextWidth=
function(b,c,d){d.fontFamily||(d.fontFamily=getComputedStyle(document.body).fontFamily);d.fontSize&&""!=d.fontSize||(d.fontSize="1em");var e=d.fontFamily;b=b.getKeyEmFontSize();d=window.keyman.util.getFontSizeStyle(d.fontSize);d=d.absolute?d.val+"px":d.val*b+"px";b=(a.getTextWidth.canvas||(a.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");b.font=d+" "+e;return b.measureText(c).width};a.prototype.getKeyWidth=function(){var a=this.objectUnits();if("px"==a)return this.spec.widthpc;
if("%"==a)return a=d.keyman.singleton.osk.getWidthFromCookie(),Math.floor(a*this.spec.widthpc/100)};a.prototype.objectUnits=function(){return"desktop"==window.keyman.util.device.formFactor?"%":"px"};a.prototype.renameSpecialKey=function(a){return p.specialCharacters[a]?String.fromCharCode(57344+p.specialCharacters[a]):a};a.prototype.generateKeyText=function(b){var c=window.keyman.util,d=this.spec,e=c._CreateElement("span"),g=e.style;if(null==d.text||""==d.text){var f="\u00a0";"string"==typeof d.id&&
/^U_[0-9A-F]{4}$/i.test(d.id)&&(f=String.fromCharCode(parseInt(d.id.substr(2),16)))}else f=d.text;e.className="kmw-key-text";if("1"==d.sp||"2"==d.sp)f=this.renameSpecialKey("*Tab*"==d.text&&"shift"==d.layer?"*TabLeft*":d.text);g.fontSize=b.fontSize;"string"==typeof d.font&&""!=d.font&&(g.fontFamily=d.font);"string"==typeof d.fontsize&&0!=d.fontsize&&(g.fontSize=d.fontsize);var h=window.keyman.keyboardManager,k={fontSize:g.fontSize};k.fontFamily=g.fontFamily?g.fontFamily:b.fontFamily;d=a.getTextWidth(b,
f,k);0==d&&""!=f&&"\u00a0"!=f&&(f="\u25cc"+f,h.isRTL()&&(f="\u200f"+f),d=a.getTextWidth(b,f,k));b=c.getFontSizeStyle(g.fontSize);c=.9*this.getKeyWidth()/d;1>c&&(g.fontSize=b.absolute?c*b.val+"px":c*b.val+"em");e.innerHTML=f;return e};return a}();k.OSKKey=m;var t=function(a){function c(b){return a.call(this,b)||this}__extends(c,a);c.prototype.getId=function(a){return this.spec.layer+"-"+this.spec.id};c.prototype.generateKeyCapLabel=function(){var a=b.keyCodes[this.spec.id];switch(a){case 186:a=59;
break;case 187:a=61;break;case 188:a=44;break;case 189:a=45;break;case 190:a=46;break;case 191:a=47;break;case 192:a=96;break;case 219:a=91;break;case 220:a=92;break;case 221:a=93;break;case 222:a=39;break;default:if(48>a||90<a)a=0}if(0<a){var c=window.keyman.util._CreateElement("div");c.className="kmw-key-label";c.innerHTML=String.fromCharCode(a);return c}return null};c.prototype.processSubkeys=function(a){var b,c=a.subKeys=this.spec.sk;for(b=0;b<c.length;b++)if("1"==c[b].sp||"2"==c[b].sp)c[b].text=
this.renameSpecialKey(c[b].text);b=window.keyman.util._CreateElement("div");b.className="kmw-key-popup-icon";a.appendChild(b)};c.prototype.construct=function(a,b,c,d,e){var f=window.keyman.util,k=this.spec,n="desktop"==f.device.formFactor;k.layer=c;c=f._CreateElement("div");c.className="kmw-key-square";var m=c.style;m.width=this.objectGeometry(k.widthpc);var q=e,l=f._CreateElement("div");l=h(l,new g(this,k.id));a.setButtonClass(k,l,b);n?m.marginLeft=this.objectGeometry(k.padpc):(m.left=this.objectGeometry(e+
k.padpc),m.bottom=d.bottom,m.height=d.height,l.style.left=m.left,l.style.width=m.width);e=e+k.padpc+k.widthpc;(b.keyLabels||n)&&(b=this.generateKeyCapLabel())&&l.appendChild(b);l.id=this.getId(a);f.device.touchable||(l.onmouseover=l.onmousedown=a.mouseOverMouseDownHandler,l.onmouseup=l.onmouseout=a.mouseUpMouseOutHandler);l.appendChild(this.generateKeyText(a));"undefined"!=typeof k.sk&&null!=k.sk?this.processSubkeys(l):l.subKeys=null;c.appendChild(l);return{element:c,percent:e-q}};c.prototype.objectGeometry=
function(a){var b=this.objectUnits();return"%"==b?a+b:Math.round(a)+b};return c}(m);k.OSKBaseKey=t;var l=function(a){function b(b){return a.call(this,b)||this}__extends(b,a);b.prototype.getId=function(a){var b=this.spec;return"string"==typeof b.layer&&""!=b.layer?"popup-"+b.layer+"-"+b.id:"popup-"+a.layerId+"-"+b.id};b.prototype.construct=function(a,b,c){var d=this.spec,e=document.createElement("div"),f=a.getDefaultKeyObject(),k=e.style,m;for(m in f)"string"!=typeof d[m]&&(d[m]=f[m]);e.className=
"kmw-key-square-ex";c&&(k.marginTop="5px");k.width="undefined"!=typeof d.width?parseInt(d.width,10)*b.offsetWidth/100+"px":b.offsetWidth+"px";k.height=b.offsetHeight+"px";b=document.createElement("div");b=h(b,new g(this,d.id));a.setButtonClass(d,b);b.id=this.getId(a);d=b.style;d.height=k.height;d.width=k.width;d.position="absolute";b.appendChild(this.generateKeyText(a));e.appendChild(b);return e};return b}(m);k.OSKSubKey=l;var p=function(){function b(b,c,e,g){this.layerId="default";this.popupPending=
this.ddOSK=!1;this.popupDelay=500;this.highlightSubKeys=this.highlightSubKeys||function(a,b,c){};this.drawPreview=this.drawPreview||function(a,b,c,d){};this.addCallout=this.addCallout||function(a){return null};this.waitForFonts=this.waitForFonts||function(a,b){return!0};this.touch=function(a){var b=d.keyman.singleton.textProcessor,c=a.changedTouches[0].target,e=this.keyTarget(c);this.touchX=a.changedTouches[0].pageX;this.currentTarget=e;var g=document.getElementById("kmw-popup-keys");if(!(g&&"visible"==
g.style.visibility||this.popupVisible)){this.touchCount=a.touches.length;if(e&&0<=e.className.indexOf("key-hidden")||0<=c.className.indexOf("kmw-key-row"))e=this.findNearestKey(a,c);null!=e&&(a=e.keyId,this.highlightKey(e,!0),"K_LOPT"==a||"K_ROPT"==a?(window.setTimeout(function(){b.clickKey(e)}.bind(this),0),this.keyPending=null):"K_BKSP"==a?(b.clickKey(e),this.deleteKey=e,this.deleting=window.setTimeout(this.repeatDelete,500),this.keyPending=null):(this.keyPending?(this.highlightKey(this.keyPending,
!1),b.clickKey(this.keyPending),this.clearPopup(),this.touchCount--):this.touchHold(e),this.keyPending=e))}}.bind(this);this.release=function(a){var b=d.keyman.singleton.textProcessor,c=document.getElementById("kmw-popup-keys"),e=this.currentTarget;if(c&&"visible"==c.style.visibility||this.popupVisible){if(0<a.touches.length)return;if(null==e||0>e.id.indexOf("popup")&&e.id!=this.popupBaseKey.id)this.highlightKey(this.keyPending,!1),this.clearPopup(),this.keyPending=null}e&&e.id&&this.optionKey(e,
e.id,!1);e=a.changedTouches[0].pageX;e=2>e&&5<this.touchX||e>window.innerWidth-2&&this.touchX<window.innerWidth-5;c=this.touchCount;0<this.touchCount&&this.touchCount--;this.keyPending?(this.highlightKey(this.keyPending,!1),0>this.keyPending.className.indexOf("hidden")&&0<c&&!e&&b.clickKey(this.keyPending),this.clearPopup(),this.keyPending=null):(b=a.changedTouches[0],e=this.keyTarget(b.target),e||(b=document.elementFromPoint(b.clientX,b.clientY),e=this.findNearestKey(a,b)),this.highlightKey(e,!1));
this.deleting&&window.clearTimeout(this.deleting);this.deleting=0}.bind(this);this.moveOver=function(a){var b=d.keyman.singleton.util;a.preventDefault();a.cancelBubble=!0;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation();if(!(1<a.touches.length||0==this.touchCount)){var c="object"==typeof a.touches?a.touches[0].clientX:a.clientX,e="object"==typeof a.touches?a.touches[0].clientY:a.clientY,g=document.elementFromPoint(c,
e),f=this.keyPending,h=this.keyTarget(g);if(h&&0<=h.className.indexOf("key-hidden")||g&&!h&&0<=g.className.indexOf("key-row"))h=this.findNearestKey(a,g);h&&"string"==typeof h.id&&0>h.id.indexOf("BKSP")&&(this.deleting&&window.clearTimeout(this.deleting),this.deleting=0);if(this.popupVisible)null==h?(f&&this.highlightKey(f,!1),this.keyPending=null):h==this.popupBaseKey?(b.hasClass(h,"kmw-key-touched")||this.highlightKey(h,!0),this.keyPending=h):(f&&this.highlightKey(f,!1),this.keyPending=null);else{(g=
document.getElementById("kmw-popup-keys"))&&"visible"==g.style.visibility&&"phone"==b.device.formFactor&&h==this.popupBaseKey&&(h=g.childNodes[0].firstChild);this.currentTarget=h;f&&h&&h.id!=f.id&&this.highlightKey(f,!1);this.highlightSubKeys(h,c,e);if(g&&"visible"==g.style.visibility){if(h&&0>h.id.indexOf("popup")&&h!=this.popupBaseKey)return;h&&h==this.popupBaseKey&&0>h.className.indexOf("kmw-key-touched")&&this.highlightKey(h,!0)}else b=d.keyman.singleton.osk._Box,f&&a.touches[0].pageY<Math.max(5,
b.offsetTop-.25*b.offsetHeight)&&(this.highlightKey(f,!1),this.showKeyTip(null,!1),this.keyPending=null);h&&this.keyPending&&(this.keyPending=h);this.keyPending&&(f!=h||0>h.className.indexOf("kmw-key-touched"))&&this.highlightKey(h,!0);f&&h&&h!=f&&""!=h.id&&this.touchHold(h)}}}.bind(this);this.repeatDelete=function(){var a=d.keyman.singleton.textProcessor;this.deleting&&(a.clickKey(this.deleteKey),this.deleting=window.setTimeout(this.repeatDelete,100))}.bind(this);this.mouseOverMouseDownHandler=function(b){var c=
d.keyman.singleton.util,e=c.eventTarget(b);if(null!==e&&"desktop"==c.device.formFactor){"SPAN"==e.nodeName&&(e=e.parentNode);var g=a(e);"mousedown"==c.eventType(b)?(this.currentKey=g.id,c._CancelMouse(b),this.highlightKey(g,!0)):e.id==this.currentKey&&this.highlightKey(g,!0)}}.bind(this);this.mouseUpMouseOutHandler=function(b){var c=d.keyman.singleton,e=c.util,g=e.eventTarget(b);null!==g&&"desktop"==e.device.formFactor&&("SPAN"==g.nodeName&&(g=g.parentNode),g=a(g),this.highlightKey(g,!1),"mouseup"==
e.eventType(b)&&(g.id==this.currentKey&&c.textProcessor.clickKey(a(g)),this.currentKey=""))}.bind(this);var f=d.keyman.singleton;c=f.util;var h=e;e=c._CreateElement("div");f=f.keyboardManager.activeKeyboard;if("object"!=typeof h||null==h)h=k.Layouts.buildDefaultLayout(b,g,c.device.formFactor);this.layout=h;this.layers=h.layer;this.fontFamily="font"in h?h.font:"";h.keyLabels=f&&"undefined"!=typeof f.KDU&&f.KDU;b=this.deviceDependentLayout(h,c.device.formFactor);this.ddOSK=!0;e.appendChild(b);this.kbdHelpDiv=
this.kbdDiv=e;e.className=c.device.formFactor+" kmw-osk-inner-frame"}b.prototype.getDefaultKeyObject=function(){return new e(void 0,"","100","0",null,"15")};b.prototype.deviceDependentLayout=function(a,b){var c=d.keyman.singleton.util,e=d.keyman.singleton.osk,g=c._CreateElement("div"),f=g.style;g.className="kmw-key-layer-group";switch(b){case "phone":case "tablet":var h=e.getHeight();f.height=h+"px"}if(null==a)return g;h=a.fontsize;f.fontSize="undefined"==typeof h||null==h||""==h?"1em":a.fontsize;
this.fontSize=f.fontSize;var k;var m=a.layer;var n=this.getDefaultKeyObject();n.fontsize=f.fontSize;var l=/\*\w+\*/;for(h=0;h<m.length;h++){var q=m[h];var p=q.row;for(k=p.length;0<k&&!(0<p[k-1].key.length);k--);k<p.length&&p.splice(k-p.length,p.length-k)}var r=100/p.length;"desktop"==b&&(r=100/p.length);var I="desktop"==b?100:e.getWidth();c.device.touchable&&(g.addEventListener("touchstart",this.touch,!0),g.addEventListener("touchend",this.release,!0),g.addEventListener("touchmove",this.moveOver,
!1));for(h=0;h<m.length;h++){q=m[h];q.aligned=!1;e=c._CreateElement("div");p=e.style;e.className="kmw-key-layer";p.display=0==h?"block":"none";p.height=f.height;p.fontFamily="font"in a?a.font:"";e.layer=e.nextLayer=q.id;"string"==typeof q.nextlayer&&(e.nextLayer=q.nextlayer);p=q.row;var F=0;for(k=0;k<p.length;k++){var G=0;var z=p[k];var A=z.key;for(z=0;z<A.length;z++){var x=A[z];if(null==x)--A.length;else{var H="string"==typeof x.width&&""!=x.width?parseInt(x.width,10):100;if(isNaN(H)||0==H)H=100;
x.width=H.toString();var C="string"==typeof x.pad&&""!=x.pad?parseInt(x.pad,10):15;if(isNaN(C)||0==C)C=15;x.pad=C.toString();G+=H+C}}G>F&&(F=G)}F="desktop"==b?F+5:F+15;for(k=0;k<p.length;k++){G=c._CreateElement("div");G.className="kmw-key-row";G.onmousedown=c.mouseDownPreventDefaultHandler;z=p[k];H=G.style;H.maxHeight=H.height=r+"%";A=z.key;for(z=0;z<A.length;z++){x=A[z];for(var M in n)"string"!=typeof x[M]&&(x[M]=n[M]);switch(x.sp){case "1":l.test(x.text)||""==x.text||(x.sp="3");break;case "2":l.test(x.text)||
""==x.text||(x.sp="4")}}for(z=C=0;z<A.length-1;z++){x=Math.round(parseInt(A[z].width,10)*I/F);A[z].widthpc=x;var J=Math.round(parseInt(A[z].pad,10)*I/F);A[z].padpc=J;C+=J+x}C+=Math.round(15*I/F);1==A.length&&0>parseInt(A[0].pad,10)?(x=Math.round(parseInt(A[0].width,10)*I/F),A[0].widthpc=x,C+=x,A[0].padpc=I-C):0<A.length&&(z=A.length-1,J=Math.round(parseInt(A[z].pad,10)*I/F),A[z].padpc=J,C+=J,A[z].widthpc=I-C);for(z=C=0;z<A.length;z++)x=A[z],x=(new t(x)).construct(this,a,q.id,H,C),G.appendChild(x.element),
C+=x.percent;e.appendChild(G)}g.appendChild(e)}return g};b.prototype.keyTarget=function(b){var c=d.keyman.singleton.util;try{if(b){if(c.hasClass(b,"kmw-key"))return a(b);if(b.parentNode&&c.hasClass(b.parentNode,"kmw-key"))return a(b.parentNode);if(b.firstChild&&c.hasClass(b.firstChild,"kmw-key"))return a(b.firstChild)}}catch(u){}return null};b.prototype.findNearestKey=function(a,b){if(!a||"undefined"==typeof a.changedTouches||0==a.changedTouches.length)return null;for(a=a.changedTouches[0].pageX;b&&
0>b.className.indexOf("key-row");)b=b.parentNode;if(!b)return null;var c,d=0,e=24,g=1E5;for(c=0;c<b.childNodes.length;c++)if(!(0<=b.childNodes[c].firstChild.className.indexOf("key-hidden"))){var f=b.childNodes[c].offsetLeft;var h=f+b.childNodes[c].offsetWidth;f-=a;0<=f&&f<g&&(d=c,g=f);f=a-h;0<=f&&f<g&&(d=c,g=f)}return 1E5>g&&(b=b.childNodes[d],f=b.offsetLeft,h=f+b.offsetWidth,40<b.offsetWidth&&(e=.6*b.offsetWidth),0<=f-a&&f-a<e||0<=a-h&&a-h<e)?b.firstChild:null};b.prototype._UpdateVKShiftStyle=function(a){var b,
c=d.keyman.singleton.textProcessor;if(a)for(b=0;b<this.layers.length&&this.layers[b].id!=this.layerId;b++);else{b=this.layerIndex;a=this.layers[b].id;var e=this.layers[b];b=["K_CAPS","K_NUMLOCK","K_SCROLL"];var g=[e.capsKey,e.numKey,e.scrollKey];for(e=0;e<g.length;e++)if(null!=g[e]){g[e].sp=c.stateKeys[b[e]]?k.Layouts.buttonClasses["SHIFT-ON"]:k.Layouts.buttonClasses.SHIFT;var f=document.getElementById(a+"-"+b[e]);this.setButtonClass(g[e],f,this.layout)}}};b.prototype.setButtonClass=function(a,b,
c){var e=d.keyman.singleton,g=0,f="default shift shift-on special special-on    deadkey blank hidden".split(" ");"string"==typeof a.dk&&"1"==a.dk&&(g=8);"string"==typeof a.sp&&(g=parseInt(a.sp,10));if(0>g||10<g)g=0;c=c||this.layout;b.className=4<c.layer[0].row.length&&"phone"==e.util.device.formFactor?"kmw-key kmw-5rows kmw-key-"+f[g]:"kmw-key kmw-key-"+f[g]};b.prototype.clearPopup=function(){var a=d.keyman.singleton.osk,b=document.getElementById("kmw-popup-keys");null!=b&&(b.shim&&a._Box.removeChild(b.shim),
b.parentNode.removeChild(b));this.popupCallout&&a._Box.removeChild(this.popupCallout);this.popupCallout=null;this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);this.popupBaseKey=null};b.prototype.showSubKeys=function(a){if(null!=this.keyPending){var b=d.keyman.singleton,c=b.util,e=c.device,g=a.subKeys,h=document.createElement("DIV");this.getDefaultKeyObject();h.id="kmw-popup-keys";this.popupBaseKey=a;"phone"==e.formFactor&&this.prependBaseKey(a);var k=h.style;
k.bottom=parseInt(a.style.bottom,10)+parseInt(a.style.height,10)+4+"px";k.fontFamily=this.fontFamily;k.fontSize=b.util.getStyleValue(a,"font-size");k.visibility="hidden";var m=g.length;var l=Math.min(Math.ceil(m/9),2);var n=Math.ceil(m/l);1<l&&(k.width=n*a.offsetWidth+5*n+"px");for(k=0;k<m;k++){var p=!1,t=Math.floor(k/n);1<l&&0<t&&(p=!0);p=(new d.keyman.osk.OSKSubKey(g[k])).construct(this,a,p);h.appendChild(p)}this.showKeyTip(null,!1);b.osk._Box.appendChild(h);k=h.style;g=f.dom.Utils.getAbsoluteX(a)+
.5*(a.offsetWidth-h.offsetWidth);c=(c.landscapeView()?screen.height:screen.width)-h.offsetWidth;g>c&&(g=c);0>g&&(g=0);k.left=g+"px";this.popupCallout=this.addCallout(a);k.visibility="visible";h.shim=document.createElement("DIV");h.shim.id="kmw-popup-shim";b.osk._Box.appendChild(h.shim);"phone"==e.formFactor&&(this.keyPending=a=h.childNodes[0].firstChild,this.highlightKey(a,!0))}};b.prototype.prependBaseKey=function(a){var b=a.subKeys,c=d.keyman.singleton;if(a&&"undefined"!=typeof a.id){a.id.split("-");
var g=a.keyId;var f=a.key.spec.layer;var h=a.key.spec.sp,k=a.key.spec.nextlayer;if("undefined"!=typeof b&&0<b.length&&(b[0].id!=g||b[0].layer!=f)){g=new e(g,"",void 0,h,k);""!=f&&(g.layer=f);for(f=0;f<a.childNodes.length&&!c.util.hasClass(a.childNodes[f],"kmw-key-text");f++);f<a.childNodes.length&&(g.text=a.childNodes[f].textContent);b.splice(0,0,g)}}};b.prototype.showLanguage=function(){var a=d.keyman.singleton,b="",c=a.keyboardManager.activeStub;c?(a=c.KL,b=c.KN):a=a.getActiveLanguage(!0)?a.getActiveLanguage(!0):
"English";try{var e=this.spaceBar.firstChild.firstChild,g=e.parentNode;g.className="undefined"==typeof g.className||""==g.className?"kmw-spacebar":g.className+" kmw-spacebar";e.className="kmw-spacebar-caption";b=b.replace(/\s*keyboard\s*/i,"");c="";c=b==a?a:a+" ("+b+")";e.innerHTML!=c&&(e.innerHTML=c)}catch(B){}};b.prototype.highlightKey=function(a,b){if(a&&""!=a.className&&!(0<=a.className.indexOf("kmw-key-row"))){var c=a.className;null!=this.keytip&&0>c.indexOf("kmw-key-shift")&&0>c.indexOf("kmw-spacebar")&&
0>a.id.indexOf("popup")?this.showKeyTip(a,b):b&&0>c.indexOf(" kmw-key-touched")?(a.className=c+" kmw-key-touched",this.showKeyTip(null,!1)):a.className=c.replace(" kmw-key-touched","")}};b.prototype.getKeyEmFontSize=function(){var a=d.keyman.singleton,b=a.util;if("desktop"==b.device.formFactor)return.8*this.getFontSizeFromCookie();var c=getComputedStyle(document.body).fontSize;c=b.getFontSizeStyle(c).val;a=b.getFontSizeStyle(a.osk._Box).val;return c*a};b.prototype.getFontSizeFromCookie=function(){var a=
d.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return 16;a=a.toNumber(b.height,.15*screen.height);a>.5*screen.height&&(a=.5*screen.height);return a/8};b.prototype.getSpecialKey=function(b,c){var d=this.kbdDiv.childNodes[0].childNodes;if(0<=b&&b<d.length)for(b=d[b].childNodes,b=b[b.length-1].childNodes,d=0;d<b.length;d++){var e=a(b[d].firstChild);if(e&&e.keyId==c)return e}return null};b.prototype.show=function(){var a=d.keyman.singleton.util.device,
b,c=-1,e=this.kbdDiv.childNodes[0].childNodes;for(b=0;b<e.length;b++){var g=e[b];g.layer==this.layerId?(g.style.display="block",this.nextLayer=this.layerId,this.layerIndex=c=b,"string"==typeof this.layers[b].nextlayer&&(this.nextLayer=this.layers[b].nextlayer),this._UpdateVKShiftStyle()):g.style.display="none"}a.touchable&&(this.lgKey=this.getSpecialKey(c,"K_LOPT"),this.hkKey=this.getSpecialKey(c,"K_ROPT"),"iOS"==a.OS&&"phone"==a.formFactor&&this.adjustHeights());this.spaceBar=this.getSpecialKey(c,
"K_SPACE")};b.prototype.showLayer=function(a){var b=d.keyman.singleton;if(a==this.layerId&&"desktop"!=b.util.device.formFactor)return!0;if(b.keyboardManager.activeKeyboard)for(var c=0;c<this.layers.length;c++)if(this.layers[c].id==a)return this.layerId=a,b.osk._Show(),!0;return!1};b.prototype.appendStyleSheet=function(){var a=d.keyman.singleton,b=a.util,c=a.keyboardManager.activeKeyboard,e=a.keyboardManager.activeStub;if(null!=e){this.styleSheet&&b.removeStyleSheet(this.styleSheet);var g=e.KFont;
e=e.KOskFont;b.addFontFaceStyleSheet(g);b.addFontFaceStyleSheet(e);a.hideInputs();var f=this.addFontStyle(g,e);null!=c&&"string"==typeof c.KCSS&&(f+=c.KCSS);this.styleSheet=b.addStyleSheet(f);this.waitForFonts(g,e)&&a.alignInputs()}};b.prototype.addFontStyle=function(a,b){var c=d.keyman.singleton,e=c.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(e=a.family);e=e.replace(/\u0022/g,"");var g=new RegExp("\\s?"+e+",?"),f=c.appliedFont.replace(/\u0022/g,"");f=f.replace(g,"");f=f.replace(/,$/,
"");f='"'+(""==f?e:e+","+f).replace(/,\s?/g,'","')+'"';e=".keymanweb-font{\nfont-family:"+f+" !important;\n}\n";"undefined"!=typeof b?e=e+'.kmw-key-text{\nfont-family:"'+b.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n':"undefined"!=typeof a&&(e=e+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');c.appliedFont=f;return e};b.prototype.buildDocumentationKeyboard=function(a,b,c,e){var g=d.keyman.singleton;b=g.keyboardManager.activeKeyboard;var f=
"undefined"==typeof c?"desktop":c;e="undefined"==typeof e?"default":e;c=g.keyboardManager.keyboards;if(null!=a){var h=a.toLowerCase().replace("keyboard_","");for(a=0;a<c.length;a++)if(h==c[a].KI.toLowerCase().replace("keyboard_","")){b=c[a];break}}if(!b)return null;a=b.KVKL;c=null;h=b.KV;"object"==typeof a&&("object"==typeof a[f]&&null!=a[f]?c=a[f]:"phone"==f&&"object"==typeof a.tablet&&null!=a.tablet?c=a.tablet:"tablet"==f&&"object"==typeof a.phone&&null!=a.phone?c=a.phone:"object"==typeof a.desktop&&
null!=a.desktop&&(c=a.desktop));null==c&&null!=h&&(c=k.Layouts.buildDefaultLayout(h,g.keyboardManager.getKeyboardModifierBitmask(b),f));null!=c&&(c.keyLabels="undefined"!=typeof b.KDU&&b.KDU);g=this.deviceDependentLayout(c,f);g.className=f+"-static kmw-osk-inner-frame";if(null!=c){var m,l;for(a=0;a<c.layer.length;a++){b=g.childNodes[a];for(m=0;m<b.childNodes.length;m++)for(f=b.childNodes[m],l=0;l<f.childNodes.length;l++)h=f.childNodes[l],h.style.height="100%";b.style.display="number"==typeof e?a==
e&&0<=e?"block":"none":"string"==typeof e?c.layer[a].id==e?"block":"none":0==a?"block":"none"}}else g.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+f+" layout is defined for "+b.KN+".</p>";g.style.border="1px solid #ccc";return g};b.prototype.onHide=function(){this.hkKey&&this.highlightKey(this.hkKey,!1)};b.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,
"*Shifted*":8,"*AltGr*":2,"*TabLeft*":7,"*LAlt*":86,"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112};return b}();k.VisualKeyboard=p})(f.osk||(f.osk={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(k){var h=function(){function c(){this.ready=!1;this.loadRetry=0;this._Visible=!1;this._Enabled=!0;this.vpScale=1;this.noDrag=this.userPositioned=!1;this.modifierCodes=f.text.Codes.modifierCodes;this.modifierBitmasks=f.text.Codes.modifierBitmasks;this.stateBitmasks=f.text.Codes.stateBitmasks;this.keyCodes=f.text.Codes.keyCodes;this.restorePosition=function(){this._Visible&&(d.keyman.singleton.domManager.focusLastActiveElement(),this.loadCookie(),this.userPositioned=
!1,this.saveCookie(),this._Show(),this.doResizeMove());this.pinImg&&(this.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)}.bind(this);this._VKbdMouseOver=function(a){d.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(this);this._VKbdMouseOut=function(a){d.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(this);this._VResizeMouseOver=this._VResizeMouseOut=function(a){a=d.keyman.singleton._GetEventObject(a);if(!a)return!1;a&&a.preventDefault&&a.preventDefault();var b=
this.getRect();this.width=b.width;this.height=b.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseDown=function(a){var b=d.keyman.singleton;b.uiManager.justActivated=!0;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var c=a.pageX;var e=a.pageY}else a.clientX&&(c=a.clientX+document.body.scrollLeft,e=a.clientY+document.body.scrollTop);this._ResizeMouseX=c;this._ResizeMouseY=e;document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&
(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth;this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight;document.onmousemove=this._VResizeMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="se-resize");a&&a.preventDefault&&a.preventDefault();
a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseMove=function(a){a=d.keyman.singleton._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);if(a.pageX){var b=a.pageX;var c=a.pageY}else a.clientX&&(b=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);b=this._VOriginalWidth+b-this._ResizeMouseX;c=this._VOriginalHeight+c-this._ResizeMouseY;b<.2*screen.width&&(b=
.2*screen.width);c<.1*screen.height&&(c=.1*screen.height);b>.9*screen.width&&(b=.9*screen.width);c>.5*screen.height&&(b=.5*screen.height);this.vkbd.kbdDiv.style.width=b+"px";this.vkbd.kbdDiv.style.height=c+"px";this.vkbd.kbdDiv.style.fontSize=c/8+"px";a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseDown=function(a){var b=d.keyman.singleton;b.uiManager.justActivated=!0;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var c=a.pageX;var e=
a.pageY}else a.clientX&&(c=a.clientX+document.body.scrollLeft,e=a.clientY+document.body.scrollTop);document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VMoveX=c-this._Box.offsetLeft;this._VMoveY=e-this._Box.offsetTop;b.keyboardManager.isCJK()&&(this.pinImg.style.left=
"15px");document.onmousemove=this._VMoveMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseMove=function(a){a=d.keyman.singleton._GetEventObject(a);if(!a||this.noDrag)return!0;this.userPositioned=this.resizing=!0;this.pinImg.style.display="block";if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);
if(a.pageX){var b=a.pageX;var c=a.pageY}else a.clientX&&(b=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);this._Box.style.left=b-this._VMoveX+"px";this._Box.style.top=c-this._VMoveY+"px";a&&a.preventDefault&&a.preventDefault();b=this.getRect();this.width=b.width;this.height=b.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMoveMouseUp=function(a){var b=d.keyman.singleton;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!1;this.vkbd&&(this.vkbd.currentKey=null);
document.onmousemove=this._VPreviousMouseMove;document.onmouseup=this._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=this._VPreviousCursor);b.domManager.focusLastActiveElement();a&&a.preventDefault&&a.preventDefault();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);this.vkbd&&(this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth,this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight);this.doResizeMove();a.cancelBubble=!0;this.saveCookie();return!1}.bind(this);this.hideNow=
function(){this._Box.removeEventListener("transitionend",this.hideNow,!1);this._Box.removeEventListener("webkitTransitionEnd",this.hideNow,!1);var a=this._Box.style;a.display="none";a.opacity="1";this._Visible=!1;a.transition=a.msTransition=a.MozTransition=a.WebkitTransition="";if(this.vkbd)this.vkbd.onHide()}.bind(this)}c.prototype.prepare=function(){var a=d.keyman.singleton,b=a.util;if(a.initialized){if(!this.ready&&(this._Box=b._CreateElement("div"),document.body.appendChild(this._Box),b.linkStyleSheet(a.getStyleSheetPath("kmwosk.css")),
b.attachDOMEvent(this._Box,"mousedown",function(b){a.uiManager.setActivatingUI(!0);return!1}),b.device.touchable)){var c=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();return!1};b.attachDOMEvent(this._Box,"touchstart",function(b){a.uiManager.setActivatingUI(!0);return c(b)});b.attachDOMEvent(this._Box,"touchend",c);b.attachDOMEvent(this._Box,"touchmove",c);b.attachDOMEvent(this._Box,"touchcancel",c);this.vpScale=b.getViewportScale()}this.loadCookie();this.ready=!0}else window.setTimeout(this.prepare.bind(this),
200)};c.prototype._Unload=function(){this._Box=this.vkbd=null};c.prototype._Load=function(){var a=d.keyman.singleton,b=a.util,c=b.device,e=a.keyboardManager.activeKeyboard;if(null==this._Box)99<=this.loadRetry||(window.setTimeout(this._Load.bind(this),100),this.loadRetry++);else{this.loadRetry=0;a._TitleElement&&(a._TitleElement.innerHTML="KeymanWeb");this._Visible=!1;var f=this._Box.style;f.zIndex="9999";f.display="none";f.width="auto";f.position="desktop"==c.formFactor?"absolute":"fixed";if(c.touchable){var h=
1;if("phone"==c.formFactor)h=1.92*(a.isEmbedded?.65:.6);else{var l=1;"Android"==c.OS&&"devicePixelRatio"in window&&(l=window.devicePixelRatio);h="Android"==c.OS&&"tablet"==c.formFactor&&this.getHeight()<300*l?1.2*h:2*h}f.fontSize=h+"em"}this.vkbd=null;this._Box.innerHTML="";this._Box.onmouseover=this._VKbdMouseOver;this._Box.onmouseout=this._VKbdMouseOut;if(null!=e||c.touchable){h=null;l=null;f="";this._Box.className="";if(null!=e){h=e.KV;f=e.KH;var p=e.KVKL;"undefined"!=typeof p&&null!=p&&(l=p[c.formFactor],
"undefined"==typeof l||null==l)&&("phone"==c.formFactor?l=p.tablet:"tablet"==c.formFactor&&(l=p.phone),"undefined"==typeof l||null==l)&&(l=p.desktop)}if(null!=h&&null!=h.BK){p=h.BK;for(var r=!0,n=0;n<p.length;n++)if(0<p[n].length){r=!1;break}r&&(h=null)}null!=h||""==f||c.touchable?(null==h&&(h={F:"Tahoma",BK:k.Layouts.dfltText}),this._GenerateVisualKeyboard(h,f,l,a.keyboardManager.getKeyboardModifierBitmask())):(c=b._CreateElement("div"),c.className="kmw-title-bar",c.appendChild(this._TitleBarInterior()),
c.onmousedown=this._VMoveMouseDown,this._Box.appendChild(c),c=b._CreateElement("div"),c.className="kmw-osk-static",c.innerHTML=f,this._Box.appendChild(c),e.KHF&&e.KHF(this._Box));a._TitleElement&&(a._TitleElement.innerHTML="<span style='font-weight:bold'>"+e.KN+"</span> - "+a._TitleElement.innerHTML,a._TitleElement.className="",a._TitleElement.style.color="#fff")}else c=b._CreateElement("div"),c.className="kmw-title-bar",c.appendChild(this._TitleBarInterior()),c.onmousedown=this._VMoveMouseDown,this._Box.appendChild(c),
c=b._CreateElement("div"),c.className="kmw-osk-none",this._Box.appendChild(c);a=this._Box.firstChild;e=" kmw-keyboard-"+(e?e.KI.replace("Keyboard_",""):"");"keymanweb_title_bar"==a.id&&(a=a.nextSibling);a.className="kmw-osk-inner-frame"+e;this.vkbd&&(this.vkbd.createKeyTip(),this.vkbd.appendStyleSheet());this._Enabled&&this._Show()}};c.prototype._GenerateVisualKeyboard=function(a,b,c,e){this.vkbd=new d.keyman.osk.VisualKeyboard(a,b,c,e);a=d.keyman.singleton.util;this._Box.className=a.device.formFactor+
" "+a.device.OS.toLowerCase()+" kmw-osk-frame";"desktop"==a.device.formFactor&&this._Box.appendChild(this.controlBar());this._Box.appendChild(this.vkbd.kbdDiv);"desktop"==a.device.formFactor?this._Box.appendChild(this.resizeBar()):this.vkbd.adjustHeights()};c.prototype.controlBar=function(){var a=d.keyman.singleton,b=a.util,c=b._CreateElement("div"),e="";c.id="keymanweb_title_bar";c.className="kmw-title-bar";c.onmousedown=this._VMoveMouseDown;a.keyboardManager.activeKeyboard&&(e=a.keyboardManager.activeKeyboard.KN);
a=b._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML=e;c.appendChild(a);e=this.closeButton=b._CreateElement("div");e.id="kmw-close-button";e.className="kmw-title-bar-image";e.onmousedown=b._CancelMouse;e.onclick=function(){this._Hide(!0)}.bind(this);c.appendChild(e);e=this.helpImg=b._CreateElement("div");e.id="kmw-help-image";e.className="kmw-title-bar-image";e.title="KeymanWeb Help";e.onclick=function(){b.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=
!1);return!1};e.onmousedown=b._CancelMouse;c.appendChild(e);e=this.configImg=b._CreateElement("div");e.id="kmw-config-image";e.className="kmw-title-bar-image";e.title="KeymanWeb Configuration Options";e.onclick=function(){b.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};e.onmousedown=b._CancelMouse;c.appendChild(e);e=this.pinImg=b._CreateElement("div");e.id="kmw-pin-image";e.className="kmw-title-bar-image";e.title="Pin the On Screen Keyboard to its default location on the active text box";
e.onclick=function(){this.loadCookie();this.userPositioned=!1;this.saveCookie();this._Show();this.doResizeMove();this.pinImg&&(this.pinImg.style.display="none");window.event&&(window.event.returnValue=!1);return!1}.bind(this);e.onmousedown=b._CancelMouse;c.appendChild(e);return c};c.prototype.resizeBar=function(){var a=d.keyman.singleton.util,b=a._CreateElement("div");b.className="kmw-footer";b.onmousedown=a._CancelMouse;var c=a._CreateElement("div");c.className="kmw-footer-caption";c.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';
c.id="keymanweb-osk-footer-caption";a.attachDOMEvent(c,"dblclick",function(a){a&&a.shiftKey&&this.showBuild();return!1},!1);"onselectstart"in c&&(c.onselectstart=a.selectStartHandler);b.appendChild(c);a=a._CreateElement("div");a.className="kmw-footer-resize";a.onmousedown=this._VResizeMouseDown;a.onmouseover=a.onmouseout=this._VResizeMouseOut;b.appendChild(a);this.resizeIcon=a;return b};c.prototype.showBuild=function(){var a=d.keyman.singleton;a.util.alert("KeymanWeb Version "+a.version+"."+a.build+
'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2017 SIL International</span>')};c.prototype._TitleBarInterior=function(){var a=d.keyman.singleton,b=a.util,c=b._CreateElement("div"),e=c.style;e.paddingLeft="2px";e.cursor="move";e.background="#ad4a28";e.font="8pt Tahoma,Arial,sans-serif";e=b._CreateElement("div");e.className="kmw-title-bar-actions";e.onmousedown=b._CancelMouse;var f=b._CreateElement("div");f.className="kmw-close-button";f.onmousedown=b._CancelMouse;f.onclick=function(){this._Hide(!0)}.bind(this);
this.closeButton=f;e.appendChild(f);f=this.pinImg=b._CreateElement("div");f.className="kmw-pin-image";f.title="Pin the On Screen Keyboard to its default location on the active text box";f.onclick=this.restorePosition;f.onmousedown=b._CancelMouse;f.style.display="none";b.device.touchable||e.appendChild(f);c.appendChild(e);a=a._TitleElement=b._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML="KeymanWeb";c.appendChild(a);return c};c.prototype.isEnabled=function(){return this._Enabled};
c.prototype.isVisible=function(){return this._Visible};c.prototype.saveCookie=function(){var a=d.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard"),c=this.getPos();b.visible=this._Enabled?1:0;b.userSet=this.userPositioned?1:0;b.left=c.left;b.top=c.top;this.vkbd&&(b.width=this.width,b.height=this.height);a.saveCookie("KeymanWeb_OnScreenKeyboard",b)};c.prototype.loadCookie=function(){var a=d.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||
null==b)return this.userPositioned=!1;this._Enabled=1==a.toNumber(b.visible,1);this.userPositioned=1==a.toNumber(b.userSet,0);this.x=a.toNumber(b.left,-1);this.y=a.toNumber(b.top,-1);var c=a.toNumber(b.width,.3*screen.width);a=a.toNumber(b.height,.15*screen.height);c<.2*screen.width&&(c=.2*screen.width);a<.1*screen.height&&(a=.1*screen.height);c>.9*screen.width&&(c=.9*screen.width);a>.5*screen.height&&(a=.5*screen.height);this.vkbd&&(this.vkbd.kbdDiv.style.width=c+"px",this.vkbd.kbdDiv.style.height=
a+"px",this.vkbd.kbdDiv.style.fontSize=a/8+"px");-1!=this.x&&-1!=this.y&&this._Box||(this.userPositioned=!1);this.x<window.pageXOffset-.8*c&&(this.x=window.pageXOffset-.8*c);0>this.y&&(this.y=this.x=-1,this.userPositioned=!1);this.userPositioned&&this._Box&&this.setPos({left:this.x,top:this.y});return!0};c.prototype.getWidthFromCookie=function(){var a=d.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return.3*screen.width;a=a.toNumber(b.width,.3*
screen.width);a<.2*screen.width?a=.2*screen.width:a>.9*screen.width&&(a=.9*screen.width);return a};c.prototype.getHeight=function(){var a=d.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskHeight)return a.getOskHeight();var c=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==b.formFactor){var e=Math.min(screen.height,screen.width),f=Math.max(screen.height,screen.width);c=a.util.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):f/e*c/1.6}"iOS"==
b.OS&&(c/=a.util.getViewportScale());"Android"==b.OS&&"phone"==b.formFactor&&"devicePixelRatio"in window&&/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(c*=window.devicePixelRatio);return c};c.prototype.getWidth=function(){var a=d.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskWidth)return a.getOskWidth();if("iOS"==b.OS)var c=window.innerWidth;else if("Android"==b.OS)try{c=document.documentElement.clientWidth}catch(e){c=screen.availWidth}else c=screen.width;return c};c.prototype.doResizeMove=
function(a){return d.keyman.singleton.util.callEvent("osk.resizemove",a)};c.prototype.getRect=function(){var a={};this.vkbd?(a.left=a.left=f.dom.Utils.getAbsoluteX(this.vkbd.kbdDiv),a.top=a.top=f.dom.Utils.getAbsoluteY(this.vkbd.kbdDiv),a.width=a.width=f.dom.Utils.getAbsoluteX(this.vkbd.kbdHelpDiv)-f.dom.Utils.getAbsoluteX(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetWidth,a.height=a.height=f.dom.Utils.getAbsoluteY(this.vkbd.kbdHelpDiv)-f.dom.Utils.getAbsoluteY(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetHeight):
(a.left=a.left=f.dom.Utils.getAbsoluteX(this._Box),a.top=a.top=f.dom.Utils.getAbsoluteY(this._Box),a.width=a.width=f.dom.Utils.getAbsoluteX(this._Box)+this._Box.offsetWidth,a.height=a.height=f.dom.Utils.getAbsoluteY(this._Box)+this._Box.offsetHeight);return a};c.prototype.setRect=function(a){var b=d.keyman.singleton.util;if(null!=this._Box&&"desktop"==b.device.formFactor){b=this._Box;var c=b.style;"left"in a&&(c.left=a.left-f.dom.Utils.getAbsoluteX(b)+b.offsetLeft+"px",this.dfltX=c.left);"top"in a&&
(c.top=a.top-f.dom.Utils.getAbsoluteY(b)+b.offsetTop+"px",this.dfltY=c.top);if(null!=this.vkbd){var e=this.vkbd.kbdDiv;c=e.style;if("width"in a){var h=a.width-(b.offsetWidth-e.offsetWidth);h<.2*screen.width&&(h=.2*screen.width);h>.9*screen.width&&(h=.9*screen.width);c.width=h+"px";this.width=h}"height"in a&&(b=a.height-(b.offsetHeight-e.offsetHeight),b<.1*screen.height&&(b=.1*screen.height),b>.5*screen.height&&(b=.5*screen.height),c.height=b+"px",c.fontSize=b/8+"px",this.height=b);"nosize"in a&&this.resizeIcon&&
(this.resizeIcon.style.display=a.nosize?"none":"block")}"nomove"in a&&(this.noDrag=a.nomove,this.pinImg&&(this.pinImg.style.display=a.nomove||!this.userPositioned?"none":"block"));this.saveCookie()}};c.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:this.x,top:this._Visible?a.offsetTop:this.y}};c.prototype.setPos=function(a){if("undefined"!=typeof this._Box&&!d.keyman.singleton.util.device.touchable){if(this.userPositioned){var b=a.left;a=a.top;"undefined"!=typeof b&&
(b<-.8*this._Box.offsetWidth&&(b=-.8*this._Box.offsetWidth),this.userPositioned&&(this._Box.style.left=b+"px",this.x=b));"undefined"!=typeof a&&(0>a&&(a=0),this.userPositioned&&(this._Box.style.top=a+"px",this.y=a))}this.pinImg&&(this.pinImg.style.display=this.userPositioned?"block":"none")}};c.prototype._Show=function(a,b){var c=d.keyman.singleton,e=c.util.device;if(null!=this._Box&&null!=c.domManager.getActiveElement()&&(e.touchable||null!=c.keyboardManager.activeKeyboard&&this._Enabled)){var h=
this._Box.style;e.touchable&&""==h.bottom&&(h.visibility="hidden");e.touchable&&(h.opacity="1");this.vkbd&&this.vkbd.ddOSK&&(this.vkbd.show(),e.touchable&&(h.position="fixed",h.left=h.bottom="0px",h.height=h.maxHeight=this.vkbd.kbdDiv.firstChild.style.height,h.border="none",h.borderTop="1px solid gray",this._Visible=this._Enabled=!0));h.display="block";this.vkbd&&this.vkbd.showLanguage();"desktop"==e.formFactor&&(h.position="absolute",h.display="block",h.left="0px",this.loadCookie(),0<=a?(h.left=
a+"px",h.top=b+"px"):this.userPositioned?(h.left=this.x+"px",h.top=this.y+"px"):(a=c.domManager.getActiveElement(),this.dfltX?h.left=this.dfltX:"undefined"!=typeof a&&null!=a&&(h.left=f.dom.Utils.getAbsoluteX(a)+"px"),this.dfltY?h.top=this.dfltY:"undefined"!=typeof a&&null!=a&&(h.top=f.dom.Utils.getAbsoluteY(a)+a.offsetHeight+"px")),this._Visible=this._Enabled=!0,this.vkbd&&this.vkbd.kbdDiv&&(this.width=this.vkbd.kbdDiv.offsetWidth,this.height=this.vkbd.kbdDiv.offsetHeight),this.saveCookie(),a=this.pinImg,
"undefined"!=typeof a&&null!=a&&(a.style.display=this.userPositioned?"block":"none"));"hidden"==h.visibility&&window.setTimeout(function(){this._Box.style.visibility="visible"}.bind(this),0);e.touchable||(e={},e.x=this._Box.offsetLeft,e.y=this._Box.offsetTop,e.userLocated=this.userPositioned,this.doShow(e))}};c.prototype._Hide=function(a){var b=d.keyman.singleton,c=b.util.device;this._Box&&"block"==this._Box.style.display&&this.vkbd&&this.vkbd.kbdDiv&&(this.width=this.vkbd.kbdDiv.offsetWidth,this.height=
this.vkbd.kbdDiv.offsetHeight);if(a)this._Enabled=b.keyboardManager.isCJK()||c.touchable?!0:!1,this.saveCookie();else if("desktop"==c.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;this._Visible=!1;this._Box&&c.touchable&&0<this._Box.offsetHeight?(c=this._Box.style,c.transition="string"==typeof c.MozBoxSizing?"opacity 0.8s linear":c.msTransition=c.WebkitTransition="opacity 0.5s linear 0",window.setTimeout(function(){var a=this._Box.style;this._Visible?a.transition=a.msTransition=
a.MozTransition=a.WebkitTransition="":(a.opacity="0",this._Box.addEventListener("transitionend",this.hideNow,!1),this._Box.addEventListener("webkitTransitionEnd",this.hideNow,!1))}.bind(this),200)):this._Box&&(this._Box.style.display="none");c={};c.HiddenByUser=a;this.doHide(c);a&&b.domManager.focusLastActiveElement()};c.prototype.hide=function(){this._Enabled=!1;this._Hide(!0)};c.prototype.doShow=function(a){return d.keyman.singleton.util.callEvent("osk.show",a)};c.prototype.doHide=function(a){return d.keyman.singleton.util.callEvent("osk.hide",
a)};c.prototype.showLanguageMenu=function(){(new k.LanguageMenu(d.keyman.singleton)).show()};c.prototype.userLocated=function(){return this.userPositioned};c.prototype.show=function(a){0<arguments.length?(this._Enabled=a)?this._Show():this._Hide(!0):this._Visible?this._Hide(!0):this._Show()};c.prototype.addEventListener=function(a,b){return d.keyman.singleton.util.addEventListener("osk."+a,b)};c.prototype.shutdown=function(){var a=this._Box;a.parentElement&&a.parentElement.removeChild(a)};return c}();
k.OSKManager=h})(f.osk||(f.osk={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
function LMLayerWorkerCode(){var d=this&&this.__assign||function(){d=Object.assign||function(d){for(var f,c=1,a=arguments.length;c<a;c++){f=arguments[c];for(var b in f)Object.prototype.hasOwnProperty.call(f,b)&&(d[b]=f[b])}return d};return d.apply(this,arguments)},f=function(){function f(d){void 0===d&&(d={postMessage:null});this._postMessage=d.postMessage||postMessage;this.setupInitialState()}f.prototype.onMessage=function(d){if(!d.data.message)throw Error("Missing required 'message' property: "+d.data);
this.state.handleMessage(d.data)};f.prototype.cast=function(f,c){var a=this._postMessage;a(d({message:f},c))};f.prototype.loadModel=function(d,c){var a={leftContextCodeUnits:0,rightContextCodeUnits:0};if("dummy"===d.type)d=new f.models.DummyModel(c,{futureSuggestions:d.futureSuggestions});else if("wordlist"===d.type)d=new f.models.WordListModel(c,d.wordlist);else throw Error("Invalid model");a.leftContextCodeUnits||(a.leftContextCodeUnits=c.maxLeftContextCodeUnits);a.rightContextCodeUnits||(a.rightContextCodeUnits=
c.maxRightContextCodeUnits||0);return{model:d,configuration:a}};f.prototype.setupInitialState=function(){var d=this;this.state={name:"uninitialized",handleMessage:function(c){if("initialize"!==c.message)throw Error("invalid message; expected 'initialize' but got "+c.message);c=d.loadModel(c.model,c.capabilities);var a=c.configuration;d.transitionToReadyState(c.model);d.cast("ready",{configuration:a})}}};f.prototype.transitionToReadyState=function(d){var c=this;this.state={name:"ready",handleMessage:function(a){if("predict"!==
a.message)throw Error("invalid message; expected 'predict' but got "+a.message);c.cast("suggestions",{token:a.token,suggestions:d.predict(a.transform,a.context)})}}};f.install=function(d){var c=new f({postMessage:d.postMessage});d.onmessage=c.onMessage.bind(c);return c};f.models={};return f}();"undefined"!==typeof module&&"undefined"!==typeof module.exports?module.exports=f:"undefined"!==typeof self&&"postMessage"in self?f.install(self):window.LMLayerWorker=f;f.models.DummyModel=function(){function d(d,
c){c=c||{};this.configuration=c.configuration||{};this._futureSuggestions=c.futureSuggestions?c.futureSuggestions.slice():[]}d.prototype.predict=function(d,c,a){return a?a:this._futureSuggestions.shift()};return d}();f.models.WordListModel=function(){return function(){function d(d,c){this._wordlist=c}d.prototype.predict=function(d,c){var a=(c.left||"").split(/\s+/).pop()||"",b=a+(d.insert||""),f=[];if(!d.insert&&c.startOfBuffer&&c.endOfBuffer)return this._wordlist.slice(0,3).map(function(a){return{transform:{insert:a+
" ",deleteLeft:0},displayAs:a}});d=0;for(c=this._wordlist;d<c.length;d++){var e=c[d],h=e.substr(0,b.length);if(b===h&&(f.push({transform:{insert:e.substr(a.length)+" ",deleteLeft:0},displayAs:e}),3<=f.length))break}return f};return d}()}()}function finallyConstructor(d){var f=this.constructor;return this.then(function(k){return f.resolve(d()).then(function(){return k})},function(k){return f.resolve(d()).then(function(){return f.reject(k)})})}setTimeoutFunc=setTimeout;function noop(){}
function bind(d,f){return function(){d.apply(f,arguments)}}function Promise(d){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof d)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(d,this)}
function handle(d,f){for(;3===d._state;)d=d._value;0===d._state?d._deferreds.push(f):(d._handled=!0,Promise._immediateFn(function(){var k=1===d._state?f.onFulfilled:f.onRejected;if(null===k)(1===d._state?resolve:reject)(f.promise,d._value);else{var h;try{h=k(d._value)}catch(c){reject(f.promise,c);return}resolve(f.promise,h)}}))}
function resolve(d,f){try{if(f===d)throw new TypeError("A promise cannot be resolved with itself.");if(f&&("object"===typeof f||"function"===typeof f)){var k=f.then;if(f instanceof Promise){d._state=3;d._value=f;finale(d);return}if("function"===typeof k){doResolve(bind(k,f),d);return}}d._state=1;d._value=f;finale(d)}catch(h){reject(d,h)}}function reject(d,f){d._state=2;d._value=f;finale(d)}
function finale(d){2===d._state&&0===d._deferreds.length&&Promise._immediateFn(function(){d._handled||Promise._unhandledRejectionFn(d._value)});for(var f=0,k=d._deferreds.length;f<k;f++)handle(d,d._deferreds[f]);d._deferreds=null}function Handler(d,f,k){this.onFulfilled="function"===typeof d?d:null;this.onRejected="function"===typeof f?f:null;this.promise=k}
function doResolve(d,f){var k=!1;try{d(function(d){k||(k=!0,resolve(f,d))},function(d){k||(k=!0,reject(f,d))})}catch(h){k||(k=!0,reject(f,h))}}Promise.prototype["catch"]=function(d){return this.then(null,d)};Promise.prototype.then=function(d,f){var k=new this.constructor(noop);handle(this,new Handler(d,f,k));return k};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(d){return new Promise(function(f,k){function h(b,d){try{if(d&&("object"===typeof d||"function"===typeof d)){var e=d.then;if("function"===typeof e){e.call(d,function(a){h(b,a)},k);return}}c[b]=d;0===--a&&f(c)}catch(t){k(t)}}if(!d||"undefined"===typeof d.length)throw new TypeError("Promise.all accepts an array");var c=Array.prototype.slice.call(d);if(0===c.length)return f([]);for(var a=c.length,b=0;b<c.length;b++)h(b,c[b])})};
Promise.resolve=function(d){return d&&"object"===typeof d&&d.constructor===Promise?d:new Promise(function(f){f(d)})};Promise.reject=function(d){return new Promise(function(f,k){k(d)})};Promise.race=function(d){return new Promise(function(f,k){for(var h=0,c=d.length;h<c;h++)d[h].then(f,k)})};Promise._immediateFn="function"===typeof setImmediate&&function(d){setImmediate(d)}||function(d){setTimeoutFunc(d,0)};
Promise._unhandledRejectionFn=function(d){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",d)};globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
(function(d){(function(d){(function(d){(function(d){var c=function(){function a(){this._promises=new Map}Object.defineProperty(a.prototype,"length",{get:function(){return this._promises.size},enumerable:!0,configurable:!0});a.prototype.make=function(a,c,d){if(this._promises.has(a))return d("Existing request with token "+a);this._promises.set(a,{reject:d,resolve:c})};a.prototype.keep=function(a,c){var b=this._promises.get(a);if(!b)throw Error("No promise associated with token: "+a);b=b.resolve;this._promises.delete(a);
return b(c)};a.prototype.break=function(a,c){var b=this._promises.get(a);if(!b)throw Error("No promise associated with token: "+a);this._promises.delete(a);b.reject(c)};return a}();d.PromiseStore=c})(d.prediction||(d.prediction={}))})(d.text||(d.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(d){(function(d){(function(d){var c=function(){function a(b){this._worker=b||new Worker(a.asBlobURI(LMLayerWorkerCode));this._worker.onmessage=this.onMessage.bind(this);this._declareLMLayerReady=null;this._promises=new d.PromiseStore;this._nextToken=Number.MIN_SAFE_INTEGER}a.prototype.initialize=function(a,c){var b=this;return new Promise(function(d,e){b._worker.postMessage({message:"initialize",capabilities:a,model:c});b._declareLMLayerReady=d})};a.prototype.predict=function(a,
c){var b=this,d=this._nextToken++;return new Promise(function(e,f){b._promises.make(d,e,f);b._worker.postMessage({message:"predict",token:d,transform:a,context:c})})};a.prototype.onMessage=function(a){var b=a.data;if("ready"===b.message)this._declareLMLayerReady(a.data.configuration);else if("suggestions"===b.message)this._promises.keep(b.token,b.suggestions);else throw Error("Message not implemented: "+b.message);};a.unwrap=function(a){return a.toString().match(/function[^{]+{((?:.|\r|\n)+)}[^}]*$/)[1]};
a.asBlobURI=function(b){b=a.unwrap(b);b=new Blob([b],{type:"text/javascript"});return URL.createObjectURL(b)};return a}();d.LMLayer=c})(d.prediction||(d.prediction={}))})(d.text||(d.text={}))})(d.keyman||(d.keyman={}))})(com||(com={}));(function(){var d=com.keyman.text.prediction;"undefined"!==typeof module&&"undefined"!==typeof module.exports?(module.exports=d.LMLayer,d.LMLayer.PromiseStore=d.PromiseStore):window.LMLayer=d.LMLayer})();
(function(d){(function(f){var k=function(){function h(){this._TitleElement=null;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=!1;this.refocusTimer=0;this.isHeadless=!1;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null};this.refreshElementContent=
null;this.util=this.util=new f.Util(this);window.KeymanWeb=this.interface=this["interface"]=new f.text.KeyboardInterface;this.osk=this.osk=new d.keyman.osk.OSKManager;this.ui=this.ui={};this.keyboardManager=new f.KeyboardManager(this);this.domManager=new f.DOMManager(this);this.hotkeyManager=new f.HotkeyManager(this);this.uiManager=new f.UIManager(this);this.keyMapManager=new f.KeyMapManager;this.textProcessor=new f.text.Processor;this.build=h.__BUILD__;this.srcPath=h._srcPath;this.rootPath=h._rootPath;
this.protocol=h._protocol;this.version=d.keyman.environment.VERSION;this.helpURL="http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}h.prototype.setDefaultDeviceOptions=function(c){};h.prototype.getStyleSheetPath=function(c){return c};h.prototype.getKeyboardPath=function(c,a){return c};h.prototype.KC_=function(c,a,b){return""};h.prototype.handleRotationEvents=function(){};h.prototype.alignInputs=function(c){};h.prototype.hideInputs=function(){};h.prototype.namespaceID=function(c){};
h.prototype.preserveID=function(c){};h.prototype.setInitialized=function(c){this.initialized=this.initialized=c};h.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};h.prototype.shutdown=function(){this.util.detachDOMEvent(window,"focus",this.pageFocusHandler,!1);this.util.detachDOMEvent(window,"blur",this.pageFocusHandler,!1);this.domManager.shutdown();this.osk.shutdown();this.util.shutdown();this.keyboardManager.shutdown();
this.ui&&this.ui.shutdown&&this.ui.shutdown();f.DOMEventHandlers.states=new f.CommonDOMStates};h.prototype.isFontAvailable=function(c){return this.util.checkFont({family:c})};h.prototype.addEventListener=function(c,a){return this.util.addEventListener("kmw."+c,a)};h.prototype._GetEventObject=function(c){if(!c&&(c=window.event,!c)){var a=this.domManager.getLastActiveElement();if(a){a=a.ownerDocument;if(a)var b=a.defaultView;if(!b)return null;c=b.event}}return c};h.prototype._push=function(c,a){c.push?
c.push(a):c=c.concat(a);return c};h.prototype.attachToControl=function(c){this.domManager.attachToControl(c)};h.prototype.detachFromControl=function(c){this.domManager.detachFromControl(c)};h.prototype.addKeyboards=function(c){0==arguments.length?this.keyboardManager.keymanCloudRequest("",!1):this.keyboardManager.addKeyboardArray(arguments)};h.prototype.addKeyboardsForLanguage=function(c){this.keyboardManager.addLanguageKeyboards(arguments)};h.prototype.register=function(c){this.keyboardManager.register(c)};
h.prototype.removeKeyboards=function(c){return this.keyboardManager.removeKeyboards(c)};h.prototype.setActiveKeyboard=function(c,a){return this.keyboardManager.setActiveKeyboard(c,a)};h.prototype.getActiveKeyboard=function(){return this.keyboardManager.getActiveKeyboardName()};h.prototype.getActiveLanguage=function(c){return this.keyboardManager.getActiveLanguage(c)};h.prototype.isAttached=function(c){return this.domManager.isAttached(c)};h.prototype.isCJK=function(c){return this.keyboardManager.isCJK(c)};
h.prototype.isChiral=function(c){return this.keyboardManager.isChiral(c)};h.prototype.getKeyboard=function(c,a){var b,d=this.keyboardManager.getDetailedKeyboards();for(b=0;b<d.length;b++){var e=d[b];if(e.InternalName==c||e.InternalName=="Keyboard_"+c)if(2>arguments.length||e.LanguageCode==a)return e}return null};h.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};h.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};h.prototype.init=
function(c){return this.domManager.init(c)};h.prototype.resetContext=function(){this.interface.resetContext()};h.prototype.setNumericLayer=function(){this.interface.setNumericLayer()};h.prototype.disableControl=function(c){this.domManager.disableControl(c)};h.prototype.enableControl=function(c){this.domManager.enableControl(c)};h.prototype.setKeyboardForControl=function(c,a,b){this.domManager.setKeyboardForControl(c,a,b)};h.prototype.getKeyboardForControl=function(c){this.domManager.getKeyboardForControl(c)};
h.prototype.getLanguageForControl=function(c){this.domManager.getLanguageForControl(c)};h.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};h.prototype.getLastActiveElement=function(){return this.domManager.getLastActiveElement()};h.prototype.setActiveElement=function(c,a){return this.domManager.setActiveElement(c,a)};h.prototype.moveToElement=function(c){this.domManager.moveToElement(c)};h.prototype.addHotKey=function(c,a,b){this.hotkeyManager.addHotKey(c,a,b)};
h.prototype.removeHotKey=function(c,a){this.hotkeyManager.removeHotkey(c,a)};h.prototype.getUIState=function(){return this.uiManager.getUIState()};h.prototype.activatingUI=function(c){this.uiManager.setActivatingUI(c)};h.prototype.BuildVisualKeyboard=function(c,a,b,d){return this.osk.vkbd?this.osk.vkbd.buildDocumentationKeyboard(c,a,b,d):null};return h}();f.KeymanBase=k})(d.keyman||(d.keyman={}))})(com||(com={}));
var scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+1),KeymanBase=com.keyman.KeymanBase;KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");KeymanBase.__BUILD__=15;window.keyman&&window.keyman.loaded||function(){window.keyman=com.keyman.singleton=new KeymanBase}();
window.keyman.initialized||function(){var d=window.keyman,f=d.util;d.debug=d.debug=function(f){if(null==d.debugElement){var h=document.createElement("DIV");var c=h.style;c.position="absolute";c.width="30%";c.maxHeight="50%";c.top="0";c.right="0";c.minHeight="50px";c.border="1px solid blue";c.whiteSpace="pre-line";c.overflowY="scroll";c=document.createElement("P");c.id="debug_output";c.style.margin="2px";h.appendChild(c);document.body.appendChild(h);d.debugElement=c}if(null!=(c=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof c.textContent?c.textContent="":c.innerHTML="";else{h=(new Date).toTimeString().substr(3,5)+" ";var a,b;for(a=0;a<arguments.length;a++){0<a&&(h+="; ");var g=arguments[a];if("object"==typeof g)if(null==g)h+="null";else{var e="";for(b in g){0<e.length&&(e+=", ");e=e+b+":";switch(typeof g[b]){case "string":case "number":case "boolean":e+=g[b];break;default:e+=typeof g[b]}if(1024<e.length){e=e.substr(0,1E3)+"...";break}}0<e.length&&(h=h+"{"+e+"}")}else h+=g}1500<h.length&&
(h=h.substr(0,1500)+" (more)");"undefined"!=typeof c.textContent?c.textContent=h+"\n"+c.textContent:c.innerHTML=h+"<br />"+c.innerHTML}};d.debugElement=null;d.delayedInit();com.keyman.osk.Layouts._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";d._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");f.attachDOMEvent(window,"load",d.domManager._WindowLoad,!1);f.attachDOMEvent(window,"unload",d.domManager._WindowUnload,!1);f.attachDOMEvent(document,
"keyup",d.hotkeyManager._Process,!1);d.pageFocusHandler=d.interface.resetVKShift.bind(d.interface);f.attachDOMEvent(window,"focus",d.pageFocusHandler,!1);f.attachDOMEvent(window,"blur",d.pageFocusHandler,!1);String.kmwEnableSupplementaryPlane(!1)}();
(function(d){(function(d){var f=function(){function c(){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight}c.prototype.equals=function(a){return this.innerWidth==a.innerWidth&&this.innerHeight==a.innerHeight};return c}(),h=function(){function c(a){this.idlePermutationCounter=c.IDLE_PERMUTATION_CAP;this.keyman=a}c.prototype.resolve=function(){this.keyman.alignInputs();var a=this.keyman.osk;a._Load();this.oskVisible&&a._Show();this.isActive=!1;this.updateTimer&&(window.clearInterval(this.updateTimer),
this.rotState=null)};c.prototype.initNewRotation=function(){this.oskVisible=this.keyman.osk.isVisible();this.keyman.osk.hideNow();this.isActive=!0};c.prototype.init=function(){if(!this.keyman.isEmbedded){var a=this.keyman.util.device.OS,b=this.keyman.util,c=this;"iOS"==a?(b.attachDOMEvent(window,"orientationchange",function(){c.iOSEventHandler();return!1}),b.attachDOMEvent(window,"resize",function(){c.iOSEventHandler();return!1})):"Android"==a&&("onmozorientationchange"in screen?b.attachDOMEvent(screen,
"mozorientationchange",function(){c.initNewRotation();return!1}):b.attachDOMEvent(window,"orientationchange",function(){c.initNewRotation();return!1}),b.attachDOMEvent(window,"resize",function(){c.resolve();return!1}))}};c.prototype.iOSEventHandler=function(){this.isActive||(this.initNewRotation(),this.rotState=new f,this.updateTimer=window.setInterval(this.iOSEventUpdate.bind(this),c.UPDATE_INTERVAL));this.idlePermutationCounter=0};c.prototype.iOSEventUpdate=function(){var a=new f;this.rotState.equals(a)?
++this.idlePermutationCounter==c.IDLE_PERMUTATION_CAP&&this.resolve():(this.rotState=a,this.idlePermutationCounter=0)};c.IDLE_PERMUTATION_CAP=15;c.UPDATE_INTERVAL=20;return c}();d.RotationManager=h})(d.keyman||(d.keyman={}))})(com||(com={}));
(function(d){(function(f){(function(k){k.VisualKeyboard.prototype.touchHold=function(d){this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);"undefined"!=typeof d.subKeys&&null!=d.subKeys&&(this.subkeyDelayTimer=window.setTimeout(function(){this.clearPopup();this.showSubKeys(d)}.bind(this),this.popupDelay))};k.VisualKeyboard.prototype.optionKey=function(h,c,a){h=d.keyman.singleton;var b=h.osk;a&&(0<=c.indexOf("K_LOPT")?b.showLanguageMenu():0<=c.indexOf("K_ROPT")&&
(h.uiManager.setActivatingUI(!1),b._Hide(!0),c=h.domManager.getActiveElement(),f.dom.Utils.instanceof(c,"TouchAliasElement")&&c.hideCaret(),h.domManager.clearLastActiveElement()))};k.VisualKeyboard.prototype.highlightSubKeys=function(d,c,a){if(null!=d&&null!=d.subKeys){var b,g=document.getElementById("kmw-popup-keys");5<this.touchY-a&&null==g&&(this.subkeyDelayTimer&&window.clearTimeout(this.subkeyDelayTimer),this.showSubKeys(d),g=document.getElementById("kmw-popup-keys"));for(b=0;b<d.subKeys.length;b++)try{var e=
g.childNodes[b].firstChild;var h=f.dom.Utils.getAbsoluteX(e);var k=f.dom.Utils.getAbsoluteY(e);var l=h+e.offsetWidth;var p=k+e.offsetHeight;var r=c>h&&c<l&&a>k&&a<p;this.highlightKey(e,r);r&&this.highlightKey(d,!1)}catch(n){}}};k.VisualKeyboard.prototype.showKeyTip=function(h,c){var a=d.keyman.singleton,b=a.util,g=a.osk;a=this.keytip;if(null!=a&&(h!=a.key||c!=a.state)){var e=document.getElementById("kmw-popup-keys");e=e&&"visible"==e.style.visibility;if(c&&!e){var k=f.dom.Utils.getAbsoluteY(g._Box),
t=g._Box.offsetHeight;g=f.dom.Utils.getAbsoluteX(h);var l=f.dom.Utils.getAbsoluteY(h);e=h.offsetWidth;for(var p=h.offsetHeight,r=h.firstChild,n=a.element.style,q=a.element.childNodes[1],u=q.style,w=0,v=a.element.firstChild,B=0;B<h.childNodes.length&&(r=h.childNodes[B],!b.hasClass(r,"kmw-key-text"));B++);v.width=1.6*e;v.height=2.3*p;n.top="auto";n.bottom=k+t-l-p+"px";n.textAlign="center";n.overflow="visible";n.fontFamily=b.getStyleValue(r,"font-family");n.width=v.width+"px";n.height=v.height+"px";
b=b.getStyleInt(r,"font-size");0!=b&&(b*=1.8,n.fontSize=b+"px",k=d.keyman.osk.OSKKey.getTextWidth(this,q.textContent,n),k=.9*v.width/k,1>k&&(n.fontSize=b*k+"px"));q.textContent=r.textContent;u.display="block";u.position="absolute";u.textAlign="center";u.width="100%";u.top="2%";u.bottom="auto";b=(v.width-e)/2;g<b?(w=-1,g+=b):g>window.innerWidth-e-b&&(w=1,g-=b);this.drawPreview(v,e,p,w);n.left=g-b+"px";n.display="block"}else a.element.style.display="none";a.key=h;a.state=c}};k.VisualKeyboard.prototype.drawPreview=
function(f,c,a,b){a=d.keyman.singleton.util.device;var g=f.getContext("2d"),e=(f.width-c)/2,h=f.height,k=e,l=c+e;c+=2*e;var p=.5*h,r=.6*h,n=8;"Android"==a.OS&&(n=3);switch(b){case -1:k-=e;l-=e;break;case 1:k+=e,l+=e}g.clearRect(0,0,f.width,f.height);"Android"==a.OS?(k=l=(k+l)/2,g.fillStyle="#999"):g.fillStyle="#ffffff";g.lineWidth=1;g.strokeStyle="#cccccc";g.save();g.beginPath();g.moveTo(0+n,0);g.arcTo(c,0,c,n,n);"Android"==a.OS?(g.arcTo(c,p,l,r,n),g.arcTo(l,r,k,r,n)):(g.arcTo(c,p,l,r,n),g.arcTo(l,
r,l-n,h,n),g.arcTo(l,h,k,h,n),g.arcTo(k,h,k,r-n,n));g.arcTo(k,r,0,p-n,n);g.arcTo(0,p,0,n,n);g.arcTo(0,0,0+n,0,n);g.fill();g.stroke();g.restore()};k.VisualKeyboard.prototype.createKeyTip=function(){var f=d.keyman.singleton,c=f.util;if("phone"==f.util.device.formFactor){if(null==this.keytip){this.keytip={key:null,state:!1};var a=this.keytip.element=c._CreateElement("div");a.className="kmw-keytip";a.id="kmw-keytip";a.style.pointerEvents="none";a.appendChild(c._CreateElement("canvas"));a.appendChild(c._CreateElement("span"))}f.osk._Box.appendChild(this.keytip.element)}};
k.VisualKeyboard.prototype.addCallout=function(f){var c=d.keyman.singleton,a=c.util;if("phone"!=a.device.formFactor||"iOS"!=a.device.OS)return null;a=a._CreateElement("div");var b=a.style;a.id="kmw-popup-callout";c.osk._Box.appendChild(a);c=f.offsetLeft;var g=f.offsetWidth,e=f.offsetHeight;b.top=f.offsetTop-6+"px";b.left=c+"px";b.width=g+"px";b.height=e+6+"px";return a};k.VisualKeyboard.prototype.waitForFonts=function(f,c){var a=d.keyman.singleton,b=a.util;if("undefined"==typeof f&&"undefined"==typeof c||
"undefined"==typeof f.files&&"undefined"==typeof c.files)return!0;var g=b.checkFontDescriptor(f),e=b.checkFontDescriptor(c);if(g&&e)return!0;a.fontCheckTimer=window.setInterval(function(){b.checkFontDescriptor(f)&&b.checkFontDescriptor(c)&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},100);window.setTimeout(function(){a.fontCheckTimer&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},5E3);return!1};k.VisualKeyboard.prototype.adjustHeights=
function(){var f=d.keyman.singleton,c=f.osk,a=c._Box;f=f.util;var b=f.device;if(a&&this.kbdDiv&&this.kbdDiv.firstChild&&this.kbdDiv.firstChild.firstChild.childNodes){var g=this.kbdDiv.firstChild.childNodes,e=g[0].childNodes.length;c=c.getHeight();var k=Math.floor(c/(0==e?1:e)),t,l;var p=1;"Android"==b.OS&&"devicePixelRatio"in window&&(k/=window.devicePixelRatio);c=e*k;e=a;k=e.style;k.height=k.maxHeight=c+3+"px";e=e.firstChild.firstChild;k=e.style;k.height=k.maxHeight=c+3+"px";"iOS"==b.OS&&(p/=f.getViewportScale());
k.fontSize=p+"em";var r="iOS"==b.OS&&"phone"==b.formFactor&&f.landscapeView();for(b=0;b<g.length;b++){e=g[b].childNodes.length;k=Math.floor(c/(0==e?1:e));var n=Math.round(.15*k);g[b].style.height=c+3+"px";for(a=0;a<e;a++){p=g[b].childNodes[a].style;p.bottom=(e-a-1)*k+1+"px";p.maxHeight=p.height=k+"px";var q=g[b].childNodes[a].childNodes;var u=q.length;for(t=0;t<u;t++){var w=q[t];for(l=0;l<w.childNodes.length&&!f.hasClass(w.childNodes[l],"kmw-key");l++);var v=w.childNodes[l].style;v.bottom=p.bottom;
v.height=v.minHeight=k-n+"px";r&&0<l&&(w.childNodes[0].style.fontSize="6px")}}}}}})(f.osk||(f.osk={}))})(d.keyman||(d.keyman={}))})(com||(com={}));
window.keyman.initialized||function(){var d=window.keyman,f=d.util,k=f.device,h=com.keyman.dom;d.isEmbedded=!1;d.setDefaultDeviceOptions=function(c){""==c.attachType&&(c.attachType=k.touchable?"manual":"auto")};f.wait=function(c){var a=this.waiting;if("undefined"!=typeof a&&null!=a&&!d.warned){var b=a.firstChild.childNodes;c?(a.pending=!0,window.setTimeout(function(){a.pending&&(window.scrollTo(0,0),b[0].style.display="none",b[1].className="kmw-wait-text",b[1].innerHTML=c,b[2].style.display="block",
a.style.display="block")},1E3)):a.pending&&(b[1].innerHTML="",a.pending=!1,a.style.display="none")}};d.getStyleSheetPath=function(c){return f.getOption("resources")+"osk/"+c};d.getKeyboardPath=function(c){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(c)?"":d.options.keyboards)+c};d.alignInputs=function(c){if(k.touchable){var a=d.domManager,b=[];c?c.forEach(function(a){a.base?b.push(a):a.kmw_ip&&b.push(a.kmw_ip)}):b=a.inputList;b.forEach(function(a){h.Utils.instanceof(a,"TouchAliasElement")&&a.updateInput();
a.style.visibility="visible";0<a.base.textContent.length&&(a.base.style.visibility="hidden")})}};d.hideInputs=function(){var c=d.domManager;if(k.touchable)for(var a=0;a<c.inputList.length;a++)c.inputList[a].style.visibility="hidden",c.inputList[a].base.style.visibility="visible"};d.isPositionSynthesized=function(){return k.touchable};d.handleRotationEvents=function(){(new com.keyman.RotationManager(d)).init()}}();
(function(){var d=window.keyman,f=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(f),d.init(null))},10)})();(function(){var d=com.keyman.Util.prototype;d.getAbsoluteX=d._GetAbsoluteX;d.getAbsoluteY=d._GetAbsoluteY;d.getAbsolute=d._GetAbsolute;d.toNzString=d.nzString})();
(function(){var d=com.keyman.text.KeyboardInterface.prototype,f=function(f,h){d[f]=d[h]};f("KSF","saveFocus");f("KBR","beepReset");f("KT","insertText");f("KR","registerKeyboard");f("KRS","registerStub");f("KC","context");f("KN","nul");f("KCM","contextMatch");f("KFCM","fullContextMatch");f("KIK","isKeypress");f("KKM","keyMatch");f("KSM","stateMatch");f("KKI","keyInformation");f("KDM","deadkeyMatch");f("KB","beep");f("KA","any");f("KDC","deleteContext");f("KO","output");f("KDO","deadkeyOutput");f("KIO",
"indexOutput");f("KIFS","ifStore");f("KSETS","setStore");f("KLOAD","loadStore");f("KSAVE","saveStore")})();
//# sourceMappingURL=keymanweb.js.map
