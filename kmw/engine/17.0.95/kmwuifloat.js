if(!window.keyman.ui.name)try{var keymanweb=window.keyman,util=keymanweb.util,dbg=keymanweb.debug;if(util.isTouchDevice())throw"";keymanweb.ui={};var ui=keymanweb.ui;ui.name="float";ui.KeyboardSelector=null;ui.outerDiv=null;ui.innerDiv=null;ui.oskButton=null;ui.kbdIcon=null;ui.selecting=!1;ui.updateList=!0;ui.updateTimer=null;ui.floatRight=!1;ui.initialized=!1;ui.initTimer=null;ui.toggleOSK=function(){keymanweb.activatingUI(!0);var a=keymanweb.osk;a&&a.show&&(a.isEnabled()?a.hide():a.show(!0));window.event&&
(window.event.returnValue=!1);keymanweb.focusLastActiveElement();keymanweb.activatingUI(!1);return!1};ui.initialize=ui.Initialize=function(){ui.initTimer&&(window.clearTimeout(ui.initTimer),ui.initTimer=null);if(!keymanweb.initialized)ui.initTimer=window.setTimeout(ui.Initialize,50);else if(!ui.initialized&&!util.isTouchDevice()){var a=util.getOption("resources")+"ui/float/";ui.outerDiv=util.createElement("DIV");ui.innerDiv=util.createElement("DIV");ui.kbdIcon=util.createElement("IMG");ui.outerDiv.innerHTML=
"<a href='http://keyman.com/web/' target='KeymanWebHelp'><img src='"+a+"kmicon.gif' border='0' style='padding: 0px 2px 0 1px; margin:0px;' title='KeymanWeb' alt='KeymanWeb' /></a>";var b=ui.outerDiv.style;b.backgroundColor="white";b.border="solid 1px black";b.position="absolute";b.height="18px";b.font="bold 8pt sans-serif";b.display="none";b.textAlign="left";b.overflow="hidden";util.attachDOMEvent(ui.outerDiv,"mousedown",ui._SelectorMouseDown);util.attachDOMEvent(ui.outerDiv,"mouseover",ui._SelectorMouseOver);
util.attachDOMEvent(ui.outerDiv,"mouseout",ui._SelectorMouseOut);ui.registerEvents();ui.kbdIcon.src=a+"kbdicon.gif";ui.kbdIcon.title="Display visual keyboard";ui.oskButtonState(!1);a=util.createElement("DIV");ui.oskButton=a;a.onclick=ui.toggleOSK;a.appendChild(ui.kbdIcon);ui.innerDiv.appendChild(a);ui.outerDiv.appendChild(ui.innerDiv);document.body.appendChild(ui.outerDiv);ui.KeyboardSelector=util.createElement("SELECT");b=ui.KeyboardSelector.style;b.font="8pt sans-serif";b.backgroundColor="#f3e5de";
b.border="solid 1px #7B9EBD";b.height="16px";b.margin="1px 2px 0px 2px";b.left="20px";b.top="0px";b.position="absolute";b.maxWidth="150px";util.attachDOMEvent(ui.KeyboardSelector,"change",ui.SelectKeyboardChange);util.attachDOMEvent(ui.KeyboardSelector,"blur",ui.SelectBlur);ui.innerDiv.appendChild(ui.KeyboardSelector);b=util.getOption("ui");a="(System keyboard)";b&&"object"==typeof b&&("string"==typeof b.position&&"right"==b.position&&(ui.floatRight=!0),"string"==typeof b["default"]&&(a=b["default"]));
b=util.createElement("OPTION");b.value="-";b.innerHTML=a;ui.KeyboardSelector.appendChild(b);ui.initialized=!0;ui.updateKeyboardList()}};ui._UnloadUserInterface=function(){ui.KeyboardSelector=ui.innerDiv=ui.outerDiv=ui.kbdIcon=null};keymanweb.addEventListener("unloaduserinterface",ui._UnloadUserInterface);ui.shutdown=function(){var a=ui.outerDiv;a&&a.parentNode.removeChild(a);ui._UnloadUserInterface();window.removeEventListener&&window.removeEventListener("resize",ui._Resize,!1)};ui.updateKeyboardList=
function(){if(ui.updateList){ui.initialized||ui.Initialize();var a,b=ui.KeyboardSelector.getElementsByTagName("OPTION");for(a=b.length;1<a;a--)ui.KeyboardSelector.removeChild(b[a-1]);var c=keymanweb.getKeyboards();for(a=0;a<c.length;a++){b=util.createElement("OPTION");b.value=c[a].InternalName+":"+c[a].LanguageCode;b.innerHTML=c[a].Name.replace(/\s?keyboard/i,"");if(c[a].LanguageName){var d=c[a].LanguageName;d=d.split(",")[0];-1==c[a].Name.search(d)&&(b.innerHTML=d+" ("+b.innerHTML+")")}ui.KeyboardSelector.appendChild(b)}}ui.updateList=
!1;a=keymanweb.getSavedKeyboard().split(":");2>a.length&&(a[1]="");ui.updateMenu(a[0],a[1]);keymanweb.getLastActiveElement()&&(ui.HideInterface(),ui.ShowInterface())};ui.updateMenu=function(a,b){if(ui.initialized){var c=a;""!=b&&(c+=":"+b);if(""==a)ui.KeyboardSelector.selectedIndex=0;else{var d=ui.KeyboardSelector.getElementsByTagName("OPTION");for(a=0;a<d.length;a++){var e=d[a].value;""==b&&(e=e.split(":")[0]);if(e==c){ui.KeyboardSelector.selectedIndex=a;break}}}}};ui.oskButtonState=function(a){var b=
ui.kbdIcon.style;b.width="24px";b.height="13px";b.top="1px";b.verticalAlign="bottom";b.padding="2px 2px 1px 2px";b.position="absolute";b.border=a?"inset 1px #808080":"none";b.background=a?"#f7e7de":"white";b.display="block";ui.initialized&&(ui.oskButton.style.display="block")};ui.registerEvents=function(){keymanweb.addEventListener("keyboardregistered",function(a){ui.updateList=!0;ui.updateTimer&&clearTimeout(ui.updateTimer);ui.updateTimer=setTimeout(ui.updateKeyboardList,200)});keymanweb.addEventListener("keyboardloaded",
function(a){a=keymanweb.getSavedKeyboard().split(":");1<a.length&&ui.updateMenu(a[0],a[1])});keymanweb.addEventListener("keyboardchange",function(a){ui.updateMenu(a.internalName,a.languageCode);ui.addButtonOSK()});var a=keymanweb.osk;a&&(a.addEventListener("show",function(a){ui.addButtonOSK();return a}),a.addEventListener("hide",function(a){ui.initialized&&ui.oskButtonState(!1)}))};ui._SelectorMouseDown=function(a){keymanweb.activatingUI&&keymanweb.activatingUI(1)};ui._SelectorMouseOver=function(a){keymanweb.activatingUI&&
keymanweb.activatingUI(1)};ui._SelectorMouseOut=function(a){keymanweb.activatingUI&&keymanweb.activatingUI(0)};ui.SelectKeyboardChange=function(a){keymanweb.activatingUI(!0);"-"!=ui.KeyboardSelector.value?(a=ui.KeyboardSelector.options[ui.KeyboardSelector.selectedIndex].value.split(":"),keymanweb.setActiveKeyboard(a[0],a[1])):keymanweb.setActiveKeyboard("");keymanweb.focusLastActiveElement();keymanweb.activatingUI(!1);ui.selecting=!0};ui.SelectBlur=function(a){ui.selecting||keymanweb.focusLastActiveElement();
ui.selecting=!1};ui.ShowInterface=function(a,b){if(ui.initialized){var c=ui.outerDiv.style;a&&b&&(c.left=a+"px",c.top=b+"px");c.display="block";ui.kbdIcon.style.left=ui.KeyboardSelector.offsetWidth+24+"px";ui.addButtonOSK();ui.updateMenu(keymanweb.getActiveKeyboard(),keymanweb.getActiveLanguage())}};ui.HideInterface=function(){ui.initialized&&(ui.outerDiv.style.display="none")};ui.addButtonOSK=function(){if(null!=ui.oskButton)if(keymanweb.isCJK()||0==ui.KeyboardSelector.selectedIndex)ui.oskButton.style.display=
"none",ui.outerDiv.style.width=ui.KeyboardSelector.offsetWidth+30+"px";else{ui.oskButton.style.display="block";var a=keymanweb.osk;a?ui.oskButtonState(a.isEnabled()):ui.oskButtonState(!1);ui.outerDiv.style.width=ui.KeyboardSelector.offsetWidth+56+"px"}};keymanweb.addEventListener("controlfocused",function(a){if(null==a.activeControl||a.activeControl._kmwAttachment)ui.floatRight?ui.ShowInterface(util.getAbsoluteX(a.target)+a.target.offsetWidth+1,util.getAbsoluteY(a.target)+1):ui.ShowInterface(util.getAbsoluteX(a.target),
util.getAbsoluteY(a.target)-parseInt(util.getStyleValue(ui.outerDiv,"height"),10)-2);return!0});keymanweb.addEventListener("controlblurred",function(a){if(!a.event)return!0;a.isActivating||ui.HideInterface();return!0});ui._Resize=function(a){"block"==ui.outerDiv.style.display&&(a=keymanweb.getLastActiveElement(),ui.floatRight?ui.ShowInterface(util.getAbsoluteX(a)+a.offsetWidth+1,util.getAbsoluteY(a)+1):ui.ShowInterface(util.getAbsoluteX(a)+1,util.getAbsoluteY(a)+a.offsetHeight+1));return!0};window.addEventListener&&
window.addEventListener("resize",ui._Resize,!1);ui.Initialize()}catch(a){};
//# sourceMappingURL=kmwuifloat.js.map
