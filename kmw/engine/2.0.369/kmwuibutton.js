(function() {try{var keymanweb=window.tavultesoft.keymanweb,osk=keymanweb.osk,util=keymanweb.util,dbg=keymanweb.debug;if(util.isTouchDevice())throw"";keymanweb.ui={};var ui=keymanweb.ui;ui.name="button";ui.init=!1;ui.KeyboardSelector=null;ui.KeymanWeb_DefaultKeyboardHelp='<span style="font-size:7.5pt">KeymanWeb is not running.  Choose a keyboard from the list</span>';ui._KeymanWeb_KbdList=null;ui._KMWSel=null;ui._IsHelpVisible=!1;ui._DefaultKeyboardID="";ui.updateTimer=null;ui.updateList=!0;ui._ShowSelected=function(){for(var a,
b=keymanweb.getActiveKeyboard(),c=keymanweb.getActiveLanguage(),d=ui._KeymanWeb_KbdList.childNodes,f=/^KMWSel_(.*)\$(.*)$/,e=1;e<d.length;e++)d[e].childNodes[0].className="";for(e=2;e<d.length&&(!(a=f.exec(d[e].childNodes[0].id))||!(a[1]==b&&a[2]==c));e++);e>=d.length&&(e=1);d[e].childNodes[0].className="selected"};ui._SelectKeyboard=function(a){if("object"==typeof a){var b=null;"undefined"!=typeof a.target&&a.target?b=a.target:"undefined"!=typeof a.srcElement&&a.srcElement&&(b=a.srcElement);b&&(a=
b.id)}var c=/^KMWSel_(.*)\$(.*)$/.exec(a),d=b="";if(null!==c){d=c[1].split("$")[0];b=a.split("$")[1];null!=ui._KMWSel&&(ui._KMWSel.className="");if(a=document.getElementById(a))a.className="selected";ui._KMWSel=a;keymanweb.setActiveKeyboard(d,b)}else d=null;keymanweb.focusLastActiveElement();osk.isEnabled()&&osk.show(!0);ui._ShowKeyboardButton(d);return!1};ui._SelectorMouseDown=function(){keymanweb.getLastActiveElement()?keymanweb.focusLastActiveElement():ui._FocusFirstInput();keymanweb.activatingUI&&
keymanweb.activatingUI(1)};ui._SelectorMouseUp=function(){keymanweb.getLastActiveElement()?keymanweb.focusLastActiveElement():ui._FocusFirstInput()};ui._SelectorMouseOver=function(){ui._ShowSelected();keymanweb.activatingUI&&keymanweb.activatingUI(1);document.getElementById("kmwico_li").className="sfhover";ui._ShowKeyboardButton()};ui._FocusFirstInput=function(){var a,b=null,c=null,d=document.getElementsByTagName("input"),f=document.getElementsByTagName("textarea");for(a=0;a<d.length&&"text"!=d[a].type;a++);
a<d.length&&(b=d[a]);0<f.length&&(c=f[0]);if(b||c)b&&!c?b.focus():c&&!b?c.focus():b.offsetTop<c.offsetTop?b.focus():b.offsetTop>c.offsetTop?c.focus():b.offsetLeft<c.offsetLeft?b.focus():c.focus()};ui._SelectorMouseOut=function(){keymanweb.activatingUI&&keymanweb.activatingUI(0);document.getElementById("kmwico_li").className="sfunhover"};ui._ShowKeyboardButton=function(a){var b=keymanweb.getActiveKeyboard(),c=document.getElementById("KMW_Keyboard");0<arguments.length&&(b=a);c&&(c.className=""==b||
keymanweb.isCJK()?"kmw_disabled":osk.isEnabled()?"kmw_show":"kmw_hide")};osk.addEventListener("show",function(a){var b=keymanweb.getLastActiveElement();b&&!a.userLocated&&(a.x=util.getAbsoluteX(b),a.y=util.getAbsoluteY(b)+b.offsetHeight);ui._ShowKeyboardButton();return a});osk.addEventListener("hide",function(a){if(0<arguments.length&&a){var b=document.getElementById("KMW_Keyboard");b&&(b.className="kmw_hide")}});ui._ShowKeymanWebKeyboard=function(){"kmw_disabled"!=document.getElementById("KMW_Keyboard").className&&
osk.show&&(osk.isEnabled()?osk.hide():osk.show(!0));window.event&&(window.event.returnValue=!1);keymanweb.focusLastActiveElement();return!1};ui.Initialize=function(){if(keymanweb.initialized){if(!ui.init&&!util.isTouchDevice()){ui.init=!0;util.addStyleSheet(ui._Appearance);ui._KeymanWeb_KbdList=util.createElement("ul");ui._KeymanWeb_KbdList.id="KeymanWeb_KbdList";var a=document.getElementById("KeymanWebControl");if(!a)for(var b=document.getElementsByTagName("div"),c=0;c<b.length;c++)if("KeymanWebControl"==
b[c].className){a=b[c];break}!a&&null!=document.body&&(a=document.createElement("DIV"),a.id="KeymanWebControl",document.body.insertBefore(a,document.body.firstChild));b=util.getOption("resources")+"ui/button/";if(a){c=document.createElement("DIV");c.style.clear="both";a.parentNode.insertBefore(c,a.nextSibling);var c=util.createElement("img"),d=util.createElement("ul"),f=util.createElement("li");c.id="kmwico_a";c.src=b+"kmw_button.gif";c.onclick=function(){return false};f.appendChild(c);f.id="kmwico_li";
d.appendChild(f);d.id="kmwico";d.style.display="block";a.appendChild(d);keymanweb.iOS||(a=util.createElement("li"),c=util.createElement("a"),d=util.createElement("img"),d.src=b+"kbdicon.gif",c.appendChild(d),d=document.createTextNode(" Hide Keyboard"),b=document.createTextNode(" Show Keyboard"),f=util.createElement("span"),f.id="KMW_KbdVisibleMsg",f.appendChild(d),c.appendChild(f),d=util.createElement("span"),d.id="KMW_KbdHiddenMsg",d.appendChild(b),c.appendChild(d),c.onmousedown=ui._ShowKeymanWebKeyboard,
c.href="#",c.id="KMW_Keyboard",a.id="KMW_ButtonUI_KbdIcon",a.appendChild(c),ui._KMWSel=c,ui._KeymanWeb_KbdList.appendChild(a));b=util.createElement("li");b.id="KMW_ButtonUI_KbdList";a=util.createElement("a");a.appendChild(document.createTextNode("English"));a.onclick=ui._SelectKeyboard;a.href="#";a.id="KMWSel_$";a.className="selected";b.appendChild(a);ui._KMWSel=a;ui._KeymanWeb_KbdList.appendChild(b);keymanweb.getKeyboards();ui.updateKeyboardList();document.getElementById("kmwico_li").appendChild(ui._KeymanWeb_KbdList);
b=document.getElementById("kmwico_li");util.attachDOMEvent(b,"mousedown",ui._SelectorMouseDown);util.attachDOMEvent(b,"mouseover",ui._SelectorMouseOver);util.attachDOMEvent(b,"mouseout",ui._SelectorMouseOut);util.attachDOMEvent(b,"mouseup",ui._SelectorMouseUp);keymanweb.focusLastActiveElement()}}}else window.setTimeout(ui.Initialize,250)};keymanweb.addEventListener("keyboardregistered",function(){ui.updateList=!0;ui.updateTimer&&clearTimeout(ui.updateTimer);ui.updateTimer=setTimeout(ui.updateKeyboardList,
20)});ui.updateKeyboardList=function(){ui.updateList=!1;if(ui.init){for(var a=ui._KeymanWeb_KbdList.childNodes.length;2<a;a--)ui._KeymanWeb_KbdList.removeChild(ui._KeymanWeb_KbdList.childNodes[a-1]);var b=keymanweb.getKeyboards();if(0<b.length)for(a=0;a<b.length;a++)ui.registerKeyboard(b[a].InternalName,b[a].LanguageName,b[a].Name,b[a].LanguageCode,b[a].RegionCode)}};ui.registerKeyboard=function(a,b,c,d){var f=util.createElement("li"),e=util.createElement("a"),g=c.replace(/\s?keyboard/i,"");b&&(b=
b.split(",")[0],-1==c.search(b)&&(g=b+" ("+g+")"));26<g.length&&(g=g.substr(0,24)+"\u2026");e.appendChild(document.createTextNode(g));e.onclick=ui._SelectKeyboard;e.href="#";e.id="KMWSel_"+a+"$"+d;f.appendChild(e);ui._KeymanWeb_KbdList.appendChild(f)};ui._Appearance="#kmwico, #kmwkbd {vertical-align: middle;} #KeymanWebControl {float:left;} #KeymanWebControl * {letter-spacing: 0px !important;line-height: 1li !important;white-space: nowrap !important;} #KeymanWebControl #kmwico img {vertical-align: top;padding: 0;margin: 0;border: none;} #KeymanWebControl #kmwico, #kmwico ul {padding: 0;margin: 0;list-style: none;} #KeymanWebControl #kmwico_a {display: block;width: 22px; height: 23px; } #KeymanWebControl #kmwico li { text-align: left;} #KeymanWebControl #kmwico li ul {display: block;position: absolute;left: -5999px;border: solid 2px #ad4a28;background: white;border-radius: 4px;box-shadow: 4px 4px 2px #666;z-index: 10011;} #KeymanWebControl #kmwico li.sfunhover ul {display: none; left: -5999px;} #KeymanWebControl #kmwico li:hover ul, #kmwico li.sfhover ul {display: block;left: auto;} #KeymanWebControl #kmwico ul li {float: none;padding: 0 !important;margin: 0 !important;width: 136px !important;} #KeymanWebControl #KMW_LanguageName {font-weight: bold;} #KeymanWebControl #kmwico ul li a, #kmwico ul li a:visited {display: block;padding: 2px 4px !important;border: none !important;color: #404040;font-family: Tahoma,Verdana,Arial,sans-serif;font-size: 8pt;text-decoration: none;} #KeymanWebControl #kmwico ul li a.selected {font-weight: bold;color: black;} #KeymanWebControl #kmwico ul li a:hover {color: white;background-color: #ad4a28;} #KeymanWebControl #kmwico ul li a.kmw_disabled, #KeymanWebControl #kmwico ul li a.kmw_disabled:hover {color: #c0c0c0; cursor: default;background-color: white;} #KeymanWebControl #kmwico ul li a.kmw_show span#KMW_KbdHiddenMsg, #KeymanWebControl #kmwico ul li a.kmw_disabled span#KMW_KbdVisibleMsg {display: none;} #KeymanWebControl #kmwico ul li a.kmw_show span#KMW_KbdVisibleMsg {display: inline;} #KeymanWebControl #kmwico ul li a.kmw_hide span#KMW_KbdHiddenMsg {display: inline;} #KeymanWebControl #kmwico ul li a.kmw_hide span#KMW_KbdVisibleMsg {display: none;} #KeymanWebControl #kmwico ul li#KMW_ButtonUI_KbdIcon {border-bottom: solid 1px #ad4a28;} ";
keymanweb.addEventListener("loaduserinterface",ui.Initialize);ui.Initialize()}catch(err){};}());
