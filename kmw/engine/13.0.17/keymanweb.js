var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,g,h){f!=Array.prototype&&f!=Object.prototype&&(f[g]=h.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(f,g,h,l){if(g){h=$jscomp.global;f=f.split(".");for(l=0;l<f.length-1;l++){var d=f[l];d in h||(h[d]={});h=h[d]}f=f[f.length-1];l=h[f];g=g(l);g!=l&&null!=g&&$jscomp.defineProperty(h,f,{configurable:!0,writable:!0,value:g})}};$jscomp.underscoreProtoCanBeSet=function(){var f={a:!0},g={};try{return g.__proto__=f,g.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(f,g){f.__proto__=g;if(f.__proto__!==g)throw new TypeError(f+" is not extensible");return f}:null;$jscomp.polyfill("Object.setPrototypeOf",function(f){return f||$jscomp.setPrototypeOf},"es6","es5");$jscomp.owns=function(f,g){return Object.prototype.hasOwnProperty.call(f,g)};
$jscomp.polyfill("Object.assign",function(f){return f?f:function(f,h){for(var g=1;g<arguments.length;g++){var d=arguments[g];if(d)for(var a in d)$jscomp.owns(d,a)&&(f[a]=d[a])}return f}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var f=0;return function(g){return $jscomp.SYMBOL_PREFIX+(g||"")+f++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(f){var g=0;return $jscomp.iteratorPrototype(function(){return g<f.length?{done:!1,value:f[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};$jscomp.iteratorFromArray=function(f,g){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var h=0,l={next:function(){if(h<f.length){var d=h++;return{value:g(d,f[d]),done:!1}}l.next=function(){return{done:!0,value:void 0}};return l.next()}};l[Symbol.iterator]=function(){return l};return l};
$jscomp.polyfill("Array.prototype.entries",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f,h){return[f,h]})}},"es6","es3");$jscomp.checkStringArgs=function(f,g,h){if(null==f)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(g instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return f+""};
$jscomp.polyfill("String.prototype.startsWith",function(f){return f?f:function(f,h){var g=$jscomp.checkStringArgs(this,f,"startsWith");f+="";var d=g.length,a=f.length;h=Math.max(0,Math.min(h|0,g.length));for(var b=0;b<a&&h<d;)if(g[h++]!=f[b++])return!1;return b>=a}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f,h){return h})}},"es8","es3");
$jscomp.polyfill("Array.from",function(f){return f?f:function(f,h,l){$jscomp.initSymbolIterator();h=null!=h?h:function(a){return a};var d=[],a=f[Symbol.iterator];if("function"==typeof a)for(f=a.call(f);!(a=f.next()).done;)d.push(h.call(l,a.value));else{a=f.length;for(var b=0;b<a;b++)d.push(h.call(l,f[b]))}return d}},"es6","es3");
$jscomp.polyfill("String.prototype.codePointAt",function(f){return f?f:function(f){var g=$jscomp.checkStringArgs(this,null,"codePointAt"),l=g.length;f=Number(f)||0;if(0<=f&&f<l){f|=0;var d=g.charCodeAt(f);if(55296>d||56319<d||f+1===l)return d;f=g.charCodeAt(f+1);return 56320>f||57343<f?d:1024*(d-55296)+f+9216}}},"es6","es3");$jscomp.makeIterator=function(f){$jscomp.initSymbolIterator();var g=f[Symbol.iterator];return g?g.call(f):$jscomp.arrayIterator(f)};
$jscomp.polyfill("WeakMap",function(f){function g(a){$jscomp.owns(a,l)||$jscomp.defineProperty(a,l,{value:{}})}function h(a){var e=Object[a];e&&(Object[a]=function(a){g(a);return e(a)})}if(function(){if(!f||!Object.seal)return!1;try{var a=Object.seal({}),e=Object.seal({}),c=new f([[a,2],[e,3]]);if(2!=c.get(a)||3!=c.get(e))return!1;c.delete(a);c.set(e,4);return!c.has(a)&&4==c.get(e)}catch(k){return!1}}())return f;var l="$jscomp_hidden_"+Math.random().toString().substring(2);h("freeze");h("preventExtensions");
h("seal");var d=0,a=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};a.prototype.set=function(a,e){g(a);if(!$jscomp.owns(a,l))throw Error("WeakMap key fail: "+a);a[l][this.id_]=e;return this};a.prototype.get=function(a){return $jscomp.owns(a,l)?a[l][this.id_]:void 0};a.prototype.has=function(a){return $jscomp.owns(a,l)&&$jscomp.owns(a[l],this.id_)};a.prototype.delete=
function(a){return $jscomp.owns(a,l)&&$jscomp.owns(a[l],this.id_)?delete a[l][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(f){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!f||!f.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new f($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var k=c.entries(),b=k.next();if(b.done||b.value[0]!=a||"s"!=b.value[1])return!1;b=k.next();return b.done||4!=b.value[0].x||"t"!=b.value[1]||!k.next().done?!1:!0}catch(u){return!1}}())return f;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var g=new WeakMap,h=function(e){this.data_={};this.head_=a();this.size=0;if(e){e=$jscomp.makeIterator(e);for(var c;!(c=e.next()).done;)c=c.value,this.set(c[0],c[1])}};h.prototype.set=function(a,c){var e=l(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=c:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:c},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};h.prototype.delete=
function(a){a=l(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};h.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=a();this.size=0};h.prototype.has=function(a){return!!l(this,a).entry};h.prototype.get=function(a){return(a=l(this,a).entry)&&a.value};h.prototype.entries=function(){return d(this,function(a){return[a.key,
a.value]})};h.prototype.keys=function(){return d(this,function(a){return a.key})};h.prototype.values=function(){return d(this,function(a){return a.value})};h.prototype.forEach=function(a,c){for(var e=this.entries(),b;!(b=e.next()).done;)b=b.value,a.call(c,b[1],b[0],this)};h.prototype[Symbol.iterator]=h.prototype.entries;var l=function(a,c){var e=c&&typeof c;"object"==e||"function"==e?g.has(c)?e=g.get(c):(e=""+ ++b,g.set(c,e)):e="p_"+c;var n=a.data_[e];if(n&&$jscomp.owns(a.data_,e))for(a=0;a<n.length;a++){var d=
n[a];if(c!==c&&d.key!==d.key||c===d.key)return{id:e,list:n,index:a,entry:d}}return{id:e,list:n,index:-1,entry:void 0}},d=function(a,c){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:c(e)};e=null}return{done:!0,value:void 0}})},a=function(){var a={};return a.previous=a.next=a.head=a},b=0;return h},"es6","es3");$jscomp.polyfill("Number.MIN_SAFE_INTEGER",function(){return-9007199254740991},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(f){return f?f:function(f,h,l){var d=this.length||0;0>h&&(h=Math.max(0,d+h));if(null==l||l>d)l=d;l=Number(l);0>l&&(l=Math.max(0,d+l));for(h=Number(h||0);h<l;h++)this[h]=f;return this}},"es6","es3");
String.kmwFromCharCode=function(f){var g=[],h;for(h=0;h<arguments.length;h++){var l=Number(arguments[h]);if(!isFinite(l)||0>l||1114111<l||Math.floor(l)!==l)throw new RangeError("Invalid code point "+l);65536>l?g.push(l):(l-=65536,g.push((l>>10)+55296),g.push(l%1024+56320))}return String.fromCharCode.apply(void 0,g)};
String.prototype.kmwCharCodeAt=function(f){var g=String(this),h=0;if(0>f||f>=g.length)return NaN;for(var l=0;l<f;l++)if(h=g.kmwNextChar(h),null===h)return NaN;f=g.charCodeAt(h);return 55296<=f&&56319>=f&&g.length>h+1&&(g=g.charCodeAt(h+1),56320<=g&&57343>=g)?(f-55296<<10)+(g-56320)+65536:f};String.prototype.kmwIndexOf=function(f,g){var h=String(this);f=h.indexOf(f,g);if(0>f)return f;for(var l=g=0;null!==l&&l<f;l=h.kmwNextChar(l))g++;return g};
String.prototype.kmwLastIndexOf=function(f,g){var h=String(this);f=h.lastIndexOf(f,g);if(0>f)return f;for(var l=g=0;null!==l&&l<f;l=h.kmwNextChar(l))g++;return g};String.prototype.kmwLength=function(){var f=String(this);if(0==f.length)return 0;for(var g=0,h=0;null!==h;g++)h=f.kmwNextChar(h);return g};String.prototype.kmwSlice=function(f,g){var h=String(this);f=h.kmwCodePointToCodeUnit(f);g=h.kmwCodePointToCodeUnit(g);return null===f||null===g?"":h.slice(f,g)};
String.prototype.kmwSubstr=function(f,g){var h=String(this);0>f&&(f=h.kmwLength()+f);0>f&&(f=0);var l=h.kmwCodePointToCodeUnit(f),d=l;if(null===l)return"";if(2>arguments.length)d=h.length;else for(var a=0;a<g;a++)d=h.kmwNextChar(d);return null===d?h.substring(l):h.substring(l,d)};
String.prototype.kmwSubstring=function(f,g){var h=String(this);if("undefined"==typeof g)f=h.kmwCodePointToCodeUnit(f),g=h.length;else{if(f>g){var l=f;f=g;g=l}f=h.kmwCodePointToCodeUnit(f);g=h.kmwCodePointToCodeUnit(g)}if(isNaN(f)||null===f)f=0;if(isNaN(g)||null===g)g=h.length;return h.substring(f,g)};
String.prototype.kmwNextChar=function(f){var g=String(this);if(null===f||0>f||f>=g.length-1)return null;var h=g.charCodeAt(f);return 55296<=h&&56319>=h&&g.length>f+1&&(h=g.charCodeAt(f+1),56320<=h&&57343>=h)?f==g.length-2?null:f+2:f+1};String.prototype.kmwPrevChar=function(f){var g=String(this);if(null==f||0>=f||f>g.length)return null;var h=g.charCodeAt(f-1);return 56320<=h&&57343>=h&&1<f&&(g=g.charCodeAt(f-2),55296<=g&&56319>=g)?f-2:f-1};
String.prototype.kmwCodePointToCodeUnit=function(f){if(null===f)return null;var g=String(this),h=0;if(0>f){h=g.length;for(var l=0;l>f;l--)h=g.kmwPrevChar(h);return h}if(f==g.kmwLength())return g.length;for(l=0;l<f;l++)h=g.kmwNextChar(h);return h};String.prototype.kmwCodeUnitToCodePoint=function(f){var g=String(this);return null===f?null:0==f?0:0>f?g.substr(f).kmwLength():g.substr(0,f).kmwLength()};String.prototype.kmwCharAt=function(f){var g=String(this);return 0<=f?g.kmwSubstr(f,1):""};
String.prototype.kmwBMPNextChar=function(f){var g=String(this);return 0>f||f>=g.length-1?null:f+1};String.prototype.kmwBMPPrevChar=function(f){var g=String(this);return 0>=f||f>g.length?null:f-1};String.prototype.kmwBMPCodePointToCodeUnit=function(f){return f};String.prototype.kmwBMPCodeUnitToCodePoint=function(f){return f};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(f,g){var h=String(this);return-1<f?h.substr(f,g):h.substr(h.length+f,-f)};
String.kmwEnableSupplementaryPlane=function(f){var g=String.prototype;String._kmwFromCharCode=f?String.kmwFromCharCode:String.fromCharCode;g._kmwCharAt=f?g.kmwCharAt:g.charAt;g._kmwCharCodeAt=f?g.kmwCharCodeAt:g.charCodeAt;g._kmwIndexOf=f?g.kmwIndexOf:g.indexOf;g._kmwLastIndexOf=f?g.kmwLastIndexOf:g.lastIndexOf;g._kmwSlice=f?g.kmwSlice:g.slice;g._kmwSubstring=f?g.kmwSubstring:g.substring;g._kmwSubstr=f?g.kmwSubstr:g.kmwBMPSubstr;g._kmwLength=f?g.kmwLength:g.kmwBMPLength;g._kmwNextChar=f?g.kmwNextChar:
g.kmwBMPNextChar;g._kmwPrevChar=f?g.kmwPrevChar:g.kmwBMPPrevChar;g._kmwCodePointToCodeUnit=f?g.kmwCodePointToCodeUnit:g.kmwBMPCodePointToCodeUnit;g._kmwCodeUnitToCodePoint=f?g.kmwCodeUnitToCodePoint:g.kmwBMPCodeUnitToCodePoint};var com;
(function(f){(function(f){(function(f){var g=function(){function a(b,e){this.p=b;this.d=e;this.o=a.ordinalSeed++}a.prototype.match=function(a,e){return this.p==a&&this.d==e};a.prototype.set=function(){this.matched=1};a.prototype.reset=function(){this.matched=0};a.prototype.before=function(a){return this.o<a.o};a.prototype.clone=function(){var b=new a(this.p,this.d);b.o=this.o;return b};a.ordinalSeed=0;a.sortFunc=function(a,e){return a.p!=e.p?e.p-a.p:e.o-a.o};return a}();f.Deadkey=g;var d=function(){function a(){this.dks=
[]}a.prototype.toSortedArray=function(){this.dks=this.dks.sort(g.sortFunc);return[].concat(this.dks)};a.prototype.clone=function(){var b=new a,e=this.toSortedArray();b.dks=[];e.forEach(function(a){b.dks.push(a.clone())});return b};a.prototype.isMatch=function(a,e,c){if(0==this.dks.length)return!1;e=a-e;for(a=0;a<this.dks.length;a++)if(this.dks[a].match(e,c)&&!this.dks[a].matched)return this.dks[a].set(),!0;this.resetMatched();return!1};a.prototype.add=function(a){this.dks=this.dks.concat(a)};a.prototype.remove=
function(a){a=this.dks.indexOf(a);this.dks.splice(a,1)};a.prototype.clear=function(){this.dks=[]};a.prototype.resetMatched=function(){for(var a=0,e=this.dks;a<e.length;a++)e[a].reset()};a.prototype.deleteMatched=function(){for(var a=0;a<this.dks.length;a++)this.dks[a].matched&&this.dks.splice(a--,1)};a.prototype.adjustPositions=function(a,e){if(0!=e)for(var c=0,b=this.dks;c<b.length;c++){var n=b[c];n.p>a&&(n.p+=e)}};a.prototype.count=function(){return this.dks.length};return a}();f.DeadkeyTracker=
d})(f.text||(f.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));(function(f){(function(f){(function(f){var g=function(){return function(){}}();f.KeyEvent=g})(f.text||(f.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
var __extends=this&&this.__extends||function(){var f=function(g,h){f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var a in d)d.hasOwnProperty(a)&&(f[a]=d[a])};return f(g,h)};return function(g,h){function l(){this.constructor=g}f(g,h);g.prototype=null===h?Object.create(h):(l.prototype=h.prototype,new l)}}();
(function(f){(function(f){var g;(function(f){var d=function(){function a(a,c,e){this.insert=a;this.deleteLeft=c;this.deleteRight=e||0}a.nil=new a("",0,0);return a}();f.TextTransform=d;var a=function(){function a(c,e,b,d){var k=this.token=a.tokenSeed++;this.keystroke=c;this.transform=e;this.alternates=d;this.preInput=b;this.transform.id=this.token;d&&d.forEach(function(a){a.sample.id=k})}a.tokenSeed=0;return a}();f.Transcription=a;var b=function(){function c(){this._dks=new g.DeadkeyTracker}c.prototype.deadkeys=
function(){return this._dks};c.prototype.hasDeadkeyMatch=function(a,c){return this.deadkeys().isMatch(this.getDeadkeyCaret(),a,c)};c.prototype.insertDeadkeyBeforeCaret=function(a){a=new f.Deadkey(this.getDeadkeyCaret(),a);this.deadkeys().add(a)};c.prototype.adjustDeadkeys=function(a){this.deadkeys().adjustPositions(this.getDeadkeyCaret(),a)};c.prototype.setDeadkeys=function(a){this._dks=a.clone()};c.prototype.buildTransformFrom=function(a){for(var c=this.getText(),e=a.getText(),b=a.getDeadkeyCaret(),
k=this.getDeadkeyCaret(),f=0;f<b&&e._kmwCharAt(f)==c._kmwCharAt(f);f++);a=b-f;f=c._kmwSubstr(f,k-f);c=c._kmwLength()-k;e=e._kmwLength()-b;return new d(f,a,e-c)};c.prototype.buildTranscriptionFrom=function(c,b,d){var k=this.buildTransformFrom(c);return new a(b,k,e.from(c),d)};c.prototype.restoreTo=function(a){this.setTextBeforeCaret(a.getTextBeforeCaret());this.setTextAfterCaret(a.getTextAfterCaret());this._dks=a._dks.clone()};c.prototype.apply=function(a){a.deleteRight&&this.setTextAfterCaret(this.getTextAfterCaret()._kmwSubstr(a.deleteRight));
a.deleteLeft&&this.deleteCharsBeforeCaret(a.deleteLeft);a.insert&&this.insertTextBeforeCaret(a.insert);this._dks.clear()};c.prototype.setTextBeforeCaret=function(a){this.deleteCharsBeforeCaret(this.getTextBeforeCaret()._kmwLength());this.insertTextBeforeCaret(a)};c.prototype.saveProperties=function(){};c.prototype.restoreProperties=function(){};return c}();f.OutputTarget=b;var e=function(a){function c(c,e){var b=a.call(this)||this;b.text=c?c:"";c=b.text._kmwLength();b.caretIndex=e?e:c;return b}__extends(c,
a);c.from=function(a){var e=a.getTextBeforeCaret(),b=e._kmwLength();e=new c(e+a.getTextAfterCaret(),b);e.setDeadkeys(a.deadkeys());return e};c.prototype.getElement=function(){return null};c.prototype.clearSelection=function(){};c.prototype.invalidateSelection=function(){};c.prototype.hasSelection=function(){return!0};c.prototype.getDeadkeyCaret=function(){return this.caretIndex};c.prototype.setDeadkeyCaret=function(a){if(0>a||a>this.text._kmwLength())throw Error("Provided caret index is out of range.");
this.caretIndex=a};c.prototype.getTextBeforeCaret=function(){return this.text.kmwSubstr(0,this.caretIndex)};c.prototype.getTextAfterCaret=function(){return this.text.kmwSubstr(this.caretIndex)};c.prototype.getText=function(){return this.text};c.prototype.deleteCharsBeforeCaret=function(a){0<=a&&(a>this.caretIndex&&(a=this.caretIndex),this.text=this.text.kmwSubstr(0,this.caretIndex-a)+this.getTextAfterCaret(),this.caretIndex-=a)};c.prototype.insertTextBeforeCaret=function(a){this.text=this.getTextBeforeCaret()+
a+this.getTextAfterCaret();this.caretIndex+=a.kmwLength()};c.prototype.setTextAfterCaret=function(a){this.text=this.getTextBeforeCaret()+a};return c}(b);f.Mock=e})(g=f.text||(f.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));(function(f){(function(f){var g=function(){return function(f,d,a){this.interface=f;this.keyboard=d;this.touchEnabled=a||!1}}();f.AttachmentInfo=g})(f.keyman||(f.keyman={}))})(com||(com={}));
function finallyConstructor(f){var g=this.constructor;return this.then(function(h){return g.resolve(f()).then(function(){return h})},function(h){return g.resolve(f()).then(function(){return g.reject(h)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(f,g){return function(){f.apply(g,arguments)}}
function Promise(f){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof f)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(f,this)}
function handle(f,g){for(;3===f._state;)f=f._value;0===f._state?f._deferreds.push(g):(f._handled=!0,Promise._immediateFn(function(){var h=1===f._state?g.onFulfilled:g.onRejected;if(null===h)(1===f._state?resolve:reject)(g.promise,f._value);else{try{var l=h(f._value)}catch(d){reject(g.promise,d);return}resolve(g.promise,l)}}))}
function resolve(f,g){try{if(g===f)throw new TypeError("A promise cannot be resolved with itself.");if(g&&("object"===typeof g||"function"===typeof g)){var h=g.then;if(g instanceof Promise){f._state=3;f._value=g;finale(f);return}if("function"===typeof h){doResolve(bind(h,g),f);return}}f._state=1;f._value=g;finale(f)}catch(l){reject(f,l)}}function reject(f,g){f._state=2;f._value=g;finale(f)}
function finale(f){2===f._state&&0===f._deferreds.length&&Promise._immediateFn(function(){f._handled||Promise._unhandledRejectionFn(f._value)});for(var g=0,h=f._deferreds.length;g<h;g++)handle(f,f._deferreds[g]);f._deferreds=null}function Handler(f,g,h){this.onFulfilled="function"===typeof f?f:null;this.onRejected="function"===typeof g?g:null;this.promise=h}
function doResolve(f,g){var h=!1;try{f(function(f){h||(h=!0,resolve(g,f))},function(f){h||(h=!0,reject(g,f))})}catch(l){h||(h=!0,reject(g,l))}}Promise.prototype["catch"]=function(f){return this.then(null,f)};Promise.prototype.then=function(f,g){var h=new this.constructor(noop);handle(this,new Handler(f,g,h));return h};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(f){return new Promise(function(g,h){function l(e,c){try{if(c&&("object"===typeof c||"function"===typeof c)){var b=c.then;if("function"===typeof b){b.call(c,function(a){l(e,a)},h);return}}d[e]=c;0===--a&&g(d)}catch(n){h(n)}}if(!f||"undefined"===typeof f.length)throw new TypeError("Promise.all accepts an array");var d=Array.prototype.slice.call(f);if(0===d.length)return g([]);for(var a=d.length,b=0;b<d.length;b++)l(b,d[b])})};
Promise.resolve=function(f){return f&&"object"===typeof f&&f.constructor===Promise?f:new Promise(function(g){g(f)})};Promise.reject=function(f){return new Promise(function(g,h){h(f)})};Promise.race=function(f){return new Promise(function(g,h){for(var l=0,d=f.length;l<d;l++)f[l].then(g,h)})};Promise._immediateFn="function"===typeof setImmediate&&function(f){setImmediate(f)}||function(f){setTimeoutFunc(f,0)};
Promise._unhandledRejectionFn=function(f){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",f)};var globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
(function(f){f=f.keyman||(f.keyman={});(f.environment||(f.environment={})).VERSION="13.0"})(com||(com={}));(function(f){f.keyman||(f.keyman={})})(com||(com={}));
(function(f){f=f.keyman||(f.keyman={});(f.text||(f.text={})).Codes={modifierCodes:{LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384},modifierBitmasks:{ALL:127,ALT_GR_SIM:5,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112},stateBitmasks:{ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288},keyCodes:{K_BKSP:8,K_TAB:9,K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,K_SPACE:32,
K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,K_NP2:98,K_NP3:99,K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,K_NPPLUS:107,
K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,K_QUOTE:222,K_oE2:226,K_OE2:226,K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,K_CURRENCIES:50005,
K_UPPER:50006,K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012},codesUS:[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']]}})(com||(com={}));
(function(f){(function(g){(function(h){var l=function(){return function(){}}();h.LegacyKeyEvent=l;l=function(){function d(){this.stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};this.modStateFlags=0;this.swallowKeypress=!1}d.prototype.defaultKeyOutput=function(a,b,e,c){var k=a.kName,n=a.Lcode,d=a.Ltarg,p=f.keyman.singleton,l=p.domManager,m=p.keyboardManager.activeKeyboard,q="",r=!1,t=d&&"undefined"!=typeof d.base;0==b?r=!0:b==h.Codes.modifierCodes.SHIFT?(r=!0,b=1):console.warn("KMW only defines default key output for the 'default' and 'shift' layers!");
if(t||e)switch((t=h.Codes.keyCodes[k])||(t=n),t){case h.Codes.keyCodes.K_BKSP:if(c)return"\b";p.interface.defaultBackspace();return"";case h.Codes.keyCodes.K_TAB:c||l.moveToNext(b);break;case h.Codes.keyCodes.K_TABBACK:c||l.moveToNext(!0);break;case h.Codes.keyCodes.K_TABFWD:c||l.moveToNext(!1);break;case h.Codes.keyCodes.K_ENTER:if("TEXTAREA"==d.nodeName||"undefined"!=typeof d.base&&"TEXTAREA"==d.base.nodeName)return"\n";if(e){if(p.isEmbedded)return"\n";if(g.dom.Utils.instanceof(d,"HTMLInputElement"))var w=
d;else"undefined"!=typeof d.base&&g.dom.Utils.instanceof(d.base,"HTMLInputElement")&&(w=d.base);c||(!w||"search"!=w.type&&"submit"!=w.type?l.moveToNext(!1):(w.disabled=!1,w.form.submit()))}break;case h.Codes.keyCodes.K_SPACE:return" "}else if(8==a.Lcode){if(c)return"\b";p.interface.defaultBackspace();return""}if(a.Lcode>=h.Codes.keyCodes.K_NP0&&a.Lcode<=h.Codes.keyCodes.K_NPSLASH&&m&&!m.KM)return q=String._kmwFromCharCode(106>a.Lcode?a.Lcode-48:a.Lcode-64);if(k&&"U_"==k.substr(0,2))a=parseInt(k.substr(2,
6),16),0<=a&&31>=a||128<=a&&159>=a?console.log("Suppressing Unicode control code: U_00"+a.toString(16)):q=String.kmwFromCharCode(a);else if(r)try{n>=h.Codes.keyCodes.K_0&&n<=h.Codes.keyCodes.K_9?q=h.Codes.codesUS[b][0][n-h.Codes.keyCodes.K_0]:n>=h.Codes.keyCodes.K_A&&n<=h.Codes.keyCodes.K_Z?q=String.fromCharCode(n+(b?0:32)):n>=h.Codes.keyCodes.K_COLON&&n<=h.Codes.keyCodes.K_BKQUOTE?q=h.Codes.codesUS[b][1][n-h.Codes.keyCodes.K_COLON]:n>=h.Codes.keyCodes.K_LBRKT&&n<=h.Codes.keyCodes.K_QUOTE&&(q=h.Codes.codesUS[b][2][n-
h.Codes.keyCodes.K_LBRKT])}catch(z){console.error("Error detected with default mapping for key:  code = "+n+", shift state = "+(1==b?"shift":"default"))}return q};d.getOutputTarget=function(a){var b=f.keyman.singleton;if(!a&&!b.isHeadless&&(a=b.domManager.getLastActiveElement(),!a))return null;if(a._kmwAttachment&&a._kmwAttachment.interface)return a._kmwAttachment.interface;throw Error("OSK could not find element output target data!");};d.prototype._GetClickEventProperties=function(a,b){var e=f.keyman.singleton,
c=e.keyboardManager.activeKeyboard,k=e.util.device.formFactor,n=a.layer||a.displayLayer||"",d=a.id.toUpperCase(),g=this.getModifierState(n);a={Ltarg:b,Lmodifiers:g,Lstates:0,Lcode:h.Codes.keyCodes[d],LisVirtualKey:!0,vkCode:0,kName:d,kLayer:n,kbdLayer:a.displayLayer,kNextLayer:a.nextlayer};switch(d){case "K_CAPS":case "K_NUMLOCK":case "K_SCROLL":this.stateKeys[d]=!this.stateKeys[d]}this.commonClickEventPreprocessing(a);!c||!c.KM||c.KVKL&&"desktop"!=k?a.vkCode=a.Lcode:a.Lcode!=h.Codes.keyCodes.K_SPACE&&
(a.vkCode=a.Lcode,this.setMnemonicCode(a,-1!=n.indexOf("shift"),this.stateKeys.K_CAPS));"undefined"==typeof c.KM&&(a.Lcode=e.keyMapManager._USKeyCodeToCharCode(a),a.LisVirtualKey=!1);return a};d.prototype.commonClickEventPreprocessing=function(a){a.Lstates|=this.stateKeys.K_CAPS?h.Codes.modifierCodes.CAPS:h.Codes.modifierCodes.NO_CAPS;a.Lstates|=this.stateKeys.K_NUMLOCK?h.Codes.modifierCodes.NUM_LOCK:h.Codes.modifierCodes.NO_NUM_LOCK;a.Lstates|=this.stateKeys.K_SCROLL?h.Codes.modifierCodes.SCROLL_LOCK:
h.Codes.modifierCodes.NO_SCROLL_LOCK;"U_"==a.kName.substr(0,2)&&(a.LisVirtualKey=!1);"undefined"==typeof a.Lcode&&(a.Lcode=this.getVKDictionaryCode(a.kName),a.Lcode||(a.Lcode=1));(a.Lmodifiers&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&g.osk.Layouts.emulatesAltGr()&&(a.Lmodifiers&=~h.Codes.modifierBitmasks.ALT_GR_SIM,a.Lmodifiers|=h.Codes.modifierCodes.RALT)};d.prototype.processKeystroke=function(a,b,e,c){var k=f.keyman.singleton,n=k.keyboardManager.activeKeyboard,
d=k.interface,g=k.keyMapManager;k.isEmbedded||e||"firefox"!=k.util.device.browser||!g.browserMap.FF["k"+a.Lcode]||(a.Lcode=g.browserMap.FF["k"+a.Lcode]);g=0;this.swallowKeypress=!1;n&&0!=a.Lcode&&(g=g||d.processKeystroke(e?k.util.device:k.util.physicalDevice,b,a));g||(a.Lcode=a.vkCode||a.Lcode,(e=this.defaultKeyOutput(a,a.Lmodifiers,!0,c))?("\b"==e?d.defaultBackspace(b):d.output(0,b,e),g=1):8==a.Lcode&&(g=1));return 1==g};d.prototype.processKeyEvent=function(a,b){var e=f.keyman.singleton,c=!!b;"boolean"==
typeof b&&(b=null);var k=e.util.device.formFactor,n=e.keyMapManager;this.swallowKeypress=!1;c&&!e.isEmbedded&&(e.domManager.initActiveElement(a.Ltarg),e.osk.vkbd.highlightKey(b,!1));if("K_LOPT"==a.kName||"K_ROPT"==a.kName)return e.osk.vkbd.optionKey(b,a.kName,!0),!0;if(("desktop"==k||e.keyboardManager.layoutIsDesktopBased())&&c&&this.selectLayer(a.kName,a.kNextLayer)||!c&&this.doModifierPress(a,!c))return!0;e.isEmbedded||c||"firefox"!=e.util.device.browser||!n.browserMap.FF["k"+a.Lcode]||(a.Lcode=
n.browserMap.FF["k"+a.Lcode]);if(!e.modelManager.enabled||("K_BKSP"!=a.kName&&a.Lcode!=h.Codes.keyCodes.K_BKSP||!e.modelManager.tryRevertSuggestion())&&("K_SPACE"!=a.kName&&a.Lcode!=h.Codes.keyCodes.K_SPACE||!e.modelManager.tryAcceptSuggestion("space"))){c&&!e.isEmbedded&&(e.uiManager.setActivatingUI(!0),f.keyman.DOMEventHandlers.states._IgnoreNextSelChange=100,e.domManager.focusLastActiveElement(),f.keyman.DOMEventHandlers.states._IgnoreNextSelChange=0);k=d.getOutputTarget(a.Ltarg);n=h.Mock.from(k);
var u=this.processKeystroke(a,k,c,!1);a.kNextLayer&&this.selectLayer(a.kName,a.kNextLayer);if(u){u=void 0;if(a.keyDistribution&&a.kbdLayer){var g=e.osk.vkbd.layout;u=[];for(var l=0,m=a.keyDistribution;l<m.length;l++){var q=m[l],r=h.Mock.from(n),t=g.getLayer(a.kbdLayer).getKey(q.keyId);t?(t=this._GetClickEventProperties(t,a.Ltarg),this.processKeystroke(t,r,c,!0)&&u.push({sample:r.buildTransformFrom(n),p:q.p})):console.warn("Potential fat-finger key could not be found in layer!")}}c=k.buildTranscriptionFrom(n,
a,u);e.modelManager.predict(c);k.getElement()&&e["interface"].doInputEvent(k.getElement());this.swallowKeypress=b&&8!=a.Lcode?0!=a.Lcode:!1;8==a.Lcode&&(this.swallowKeypress=!1);return!1}this.swallowKeypress=!1;c&&!e.isEmbedded&&e.uiManager.setActivatingUI(!1);return!u}};d.prototype.clickKey=function(a,b,e,c){e=f.keyman.singleton;var k=e.domManager.getLastActiveElement();if(null!=k){var n=d.getOutputTarget(k);e.domManager.initActiveElement(k);e.osk.vkbd.highlightKey(a,!1);n.invalidateSelection();
n.deadkeys().deleteMatched();k=this._GetClickEventProperties(a.key.spec,k);e.modelManager.enabled&&(k.source=b,k.keyDistribution=c);return this.processKeyEvent(k,a)}return!0};d.prototype.setMnemonicCode=function(a,b,e){if(a.Lcode!=h.Codes.keyCodes.K_SPACE){var c=new h.KeyEvent,k;for(k in a)c[k]=a[k];c.kName="K_xxxx";c.Ltarg=null;b=this.defaultKeyOutput(c,b?16:0,!1,!0);a.vkCode=a.Lcode;b?a.Lcode=b.charCodeAt(0):delete a.Lcode}e&&(65<=a.Lcode&&90>=a.Lcode||97<=a.Lcode&&122>=a.Lcode)&&(a.Lmodifiers^=
16,a.Lcode^=32)};d.prototype.getModifierState=function(a){var b=0;0<=a.indexOf("shift")&&(b|=h.Codes.modifierCodes.SHIFT);var e=!1;0<=a.indexOf("leftctrl")&&(b|=h.Codes.modifierCodes.LCTRL,e=!0);0<=a.indexOf("rightctrl")&&(b|=h.Codes.modifierCodes.RCTRL,e=!0);0<=a.indexOf("ctrl")&&!e&&(b|=h.Codes.modifierCodes.CTRL);e=!1;0<=a.indexOf("leftalt")&&(b|=h.Codes.modifierCodes.LALT,e=!0);0<=a.indexOf("rightalt")&&(b|=h.Codes.modifierCodes.RALT,e=!0);0<=a.indexOf("alt")&&!e&&(b|=h.Codes.modifierCodes.ALT);
return b};d.prototype.getVKDictionaryCode=function(a){var b=f.keyman.singleton.keyboardManager.activeKeyboard;if(!b.VKDictionary){var e=[];if("string"==typeof b.KVKD)for(var c=b.KVKD.split(" "),k=0;k<c.length;k++)e[c[k].toUpperCase()]=k+256;b.VKDictionary=e}return(a=b.VKDictionary[a.toUpperCase()])?a:0};d.prototype._UpdateVKShift=function(a,b,e){var c=0,k=f.keyman.singleton,n=["CAPS","NUM_LOCK","SCROLL_LOCK"],d=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(a)for(c=a.Lmodifiers,b=a.Lstates,k.keyboardManager.isChiral()&&
g.osk.Layouts.emulatesAltGr()&&(this.modStateFlags&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&(c|=h.Codes.modifierBitmasks.ALT_GR_SIM,c&=~h.Codes.modifierCodes.RALT),a=0;a<n.length;a++)b&h.Codes.stateBitmasks[n[a]]&&(this.stateKeys[d[a]]=b&h.Codes.modifierCodes[n[a]]);else if(e)for(c|=b,a=0;a<n.length;a++)b&h.Codes.stateBitmasks[n[a]]&&(this.stateKeys[d[a]]=!0);else for(c&=~b,a=0;a<n.length;a++)b&h.Codes.stateBitmasks[n[a]]&&(this.stateKeys[d[a]]=!1);k.osk.vkbd&&k.osk.vkbd.showLayer(this.getLayerId(c));
k.osk._Visible&&k.osk._Show();return!0};d.prototype.getLayerId=function(a){return g.osk.Layouts.getLayerId(a)};d.prototype.selectLayer=function(a,b){var e=2>arguments.length?null:b,c=f.keyman.singleton.keyboardManager.isChiral();"number"==typeof e&&(e=this.getLayerId(16*e));if(!e)switch(a){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":e="shift";break;case "K_LCONTROL":case "K_LCTRL":if(c){e="leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(c){e="rightctrl";break}case "K_CTRL":e="ctrl";break;case "K_LMENU":case "K_LALT":if(c){e=
"leftalt";break}case "K_RMENU":case "K_RALT":if(c){e="rightalt";break}case "K_ALT":e="alt";break;case "K_ALTGR":e=c?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":e="default"}if(!e)return!1;this.updateLayer(e);f.keyman.singleton.osk._Show();return!0};d.prototype.updateLayer=function(a){var b=f.keyman.singleton,e=b.osk.vkbd;if(e){var c=e.layerId,k=c;if(a==c&&"desktop"!=b.util.device.formFactor)return!1;var n=
a;if("desktop"==b.util.device.formFactor){var d="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(b=0;b<d.length;b++)n=n.replace(d[b]+"-",""),n=n.replace(d[b],"");if("default"==c||"numeric"==c||"symbol"==c||"currency"==c||""!=n)k=a;else{c=this.getModifierState(k);for(b=0;b<d.length;b++)k=k.replace(d[b]+"-",""),k=k.replace(d[b],"");switch(a){case "shift":c^=h.Codes.modifierCodes.SHIFT;break;case "leftctrl":c^=h.Codes.modifierCodes.LCTRL;break;case "rightctrl":c^=h.Codes.modifierCodes.RCTRL;
break;case "ctrl":c^=h.Codes.modifierCodes.CTRL;break;case "leftalt":c^=h.Codes.modifierCodes.LALT;break;case "rightalt":c^=h.Codes.modifierCodes.RALT;break;case "alt":c^=h.Codes.modifierCodes.ALT;break;default:k=a}"default"!=k&&(k=""==k?this.getLayerId(c):this.getLayerId(c)+"-"+k)}""==k&&(k="default")}else k=a;e&&(e.showLayer(k)||e.showLayer("default"))}};d.prototype._GetEventKeyCode=function(a){return a.keyCode?a.keyCode:a.which?a.which:null};d.prototype.doModifierPress=function(a,b){var e=f.keyman.singleton;
switch(a.Lcode){case 8:d.getOutputTarget(a.Ltarg).deadkeys().clear();break;case 16:case 17:case 18:case 20:case 144:case 145:return e["interface"].notifyKeyboard(a.Lcode,a.Ltarg,b?1:0),e.util.device.touchable?!0:this._UpdateVKShift(a,a.Lcode-15,1)}a.LmodifierChange&&(e["interface"].notifyKeyboard(0,a.Ltarg,1),this._UpdateVKShift(a,0,1));return!1};d.prototype._GetKeyEventProperties=function(a,b){var e=f.keyman.singleton;b=new h.KeyEvent;a=e._GetEventObject(a);if(!0===a.cancelBubble)return null;b.Ltarg=
e.util.eventTarget(a);if(null==b.Ltarg)return null;3==b.Ltarg.nodeType&&(b.Ltarg=b.Ltarg.parentNode);b.Lcode=this._GetEventKeyCode(a);if(null==b.Lcode)return null;var c=this.modStateFlags,k=!1,n=!1;var d=h.Codes.keyCodes;switch(b.Lcode){case d.K_CTRL:case d.K_LCTRL:case d.K_RCTRL:case d.K_CONTROL:case d.K_LCONTROL:case d.K_RCONTROL:k=!0;break;case d.K_LMENU:case d.K_RMENU:case d.K_ALT:case d.K_LALT:case d.K_RALT:n=!0}d=0|(a.getModifierState("Shift")?16:0);var p=h.Codes.modifierCodes;a.getModifierState("Control")&&
(d|=0!=a.location&&k?1==a.location?p.LCTRL:p.RCTRL:c&3);a.getModifierState("Alt")&&(d|=0!=a.location&&n?1==a.location?p.LALT:p.RALT:c&12);b.Lstates=0;b.Lstates|=a.getModifierState("CapsLock")?p.CAPS:p.NO_CAPS;b.Lstates|=a.getModifierState("NumLock")?p.NUM_LOCK:p.NO_NUM_LOCK;b.Lstates|=a.getModifierState("ScrollLock")||a.getModifierState("Scroll")?p.SCROLL_LOCK:p.NO_SCROLL_LOCK;d|=b.Lstates;b.LmodifierChange=this.modStateFlags!=d;this.modStateFlags=d;k=p.RALT|p.LCTRL;(c&k)==k&&(d&k)!=k&&(d&=~k);d&
p.RALT&&(d&=~p.LCTRL);c=h.Codes.modifierBitmasks;e.keyboardManager.isChiral()?(b.Lmodifiers=d&c.CHIRAL,g.osk.Layouts.emulatesAltGr()&&(b.Lmodifiers&c.ALT_GR_SIM)==c.ALT_GR_SIM&&(b.Lmodifiers^=c.ALT_GR_SIM,b.Lmodifiers|=p.RALT)):b.Lmodifiers=d&16|(d&(p.LCTRL|p.RCTRL)?32:0)|(d&(p.LALT|p.RALT)?64:0);(c=e.keyboardManager.activeKeyboard)&&c.KM&&this.setMnemonicCode(b,a.getModifierState("Shift"),a.getModifierState("CapsLock"));b.LisVirtualKey="undefined"!=typeof a.charCode&&null!=a.charCode&&(0==a.charCode||
0!=(b.Lmodifiers&111))||"keypress"!=a.type;a=e.keyMapManager;c&&!c.KM&&((e=a.languageMap[f.keyman.osk.Layouts._BaseLayout])&&e["k"+b.Lcode]&&(b.Lcode=e["k"+b.Lcode]),"undefined"!=typeof c.KM||b.Lmodifiers&96||(b={Lcode:a._USKeyCodeToCharCode(b),Ltarg:b.Ltarg,Lmodifiers:0,LisVirtualKey:!1,vkCode:b.Lcode,Lstates:b.Lstates,kName:""}));return b};d.prototype.keyDown=function(a){this.swallowKeypress=!1;var b=this._GetKeyEventProperties(a,!0);if(null==b)return!0;(b=!this.processKeyEvent(b))&&a&&a.preventDefault&&
(a.preventDefault(),a.stopPropagation());return!b};d.prototype.keyUp=function(a){a=this._GetKeyEventProperties(a,!1);return null==a?!0:this.doModifierPress(a,!1)};d.prototype.keyPress=function(a){var b=f.keyman.singleton,e=this._GetKeyEventProperties(a);if(null==e||e.LisVirtualKey)return!0;if(!b.keyboardManager.activeKeyboard.KM){if(!this.swallowKeypress||32>e.Lcode||b._BrowserIsSafari&&63232<e.Lcode&&63744>e.Lcode)return!0;if(a=b._GetEventObject(a))a.returnValue=!1;return!1}var c=d.getOutputTarget(e.Ltarg);
if(this.swallowKeypress||b["interface"].processKeystroke(b.util.physicalDevice,c,e))return this.swallowKeypress=!1,a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),!1;this.swallowKeypress=!1;return!0};return d}();h.Processor=l})(g.text||(g.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){var g=function(){function a(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._SelectionControl=this._Selection=null}a.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),1E3)};return a}();f.CommonDOMStates=g;var l=function(){function a(b){this.setFocus=function(a){}.bind(this);this.setBlur=function(a){}.bind(this);this._ControlFocus=function(e){var c=this.keyman.util.device,b=this.keyman.osk;
e=this.keyman._GetEventObject(e);e=this.keyman.util.eventTarget(e);if(null==e||c.touchable&&(null==e.className||0>e.className.indexOf("keymanweb-input")))return!0;e.nodeName.toLowerCase();if(e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLInputElement){var n=e.type.toLowerCase();if("text"!=n&&"search"!=n)return!0}else if(!(!c.touchable&&e.isContentEditable||e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLTextAreaElement))return!0;d.states.activeElement=e;3==e.nodeType&&
(e=e.parentNode);n=e;(null==e.className||0>e.className.indexOf("keymanweb-input"))&&this instanceof d&&this.scrollBody(e);e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(e),e=e.contentWindow.document.body);var f=a.states.lastActiveElement;a.states.lastActiveElement=e;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings():this._FocusKeyboardSettings(f?!1:!0);if(this._CommonFocusHelper(e))return!0;e.ownerDocument&&e instanceof
e.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(e);this.doControlFocused(n,a.states.lastActiveElement);c.touchable?b._Enabled=!0:b.ready&&(this.keyman.keyboardManager.isCJK()&&(b._Enabled=!0),b._Enabled?b._Show():b._Hide(!1));return!0}.bind(this);this._ControlBlur=function(e){e=this.keyman._GetEventObject(e);var c=this.keyman.util.eventTarget(e);if(null==c)return!0;f.dom.Utils.instanceof(a.states.activeElement,"TouchAliasElement")&&a.states.activeElement.hideCaret();a.states.activeElement=
null;3==c.nodeType&&(c=c.parentNode);c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(c=c.contentWindow.document);this._BlurKeyboardSettings();a.states.lastActiveElement=c;this.keyman.uiManager.justActivated=!1;var b=this.keyman.uiManager.isActivating;b||this.keyman["interface"].notifyKeyboard(0,c,0);this.doControlBlurred(c,e,b);this.keyman.osk.ready&&!b&&this.keyman.osk._Hide(!1);this.doChangeEvent(c);this.keyman.interface.resetContext();return!0}.bind(this);this._SelectionChange=
function(){a.states._IgnoreNextSelChange&&a.states._IgnoreNextSelChange--;return!0}.bind(this);this._KeyDown=function(e){var c=this.keyman.keyboardManager.activeKeyboard,b=this.keyman.osk,n=this.keyman.util;if(a.states._DisableInput||null==c)return!0;c=n.eventTarget(e);if(n.device.touchable){if(c&&"undefined"!=typeof c.kmwInput&&0==c.kmwInput)return!0}else if(c&&0<=c.className.indexOf("kmw-disabled"))return!0;return b.ready?this.keyman.textProcessor.keyDown(e):!0}.bind(this);this._KeyPress=function(e){return a.states._DisableInput||
null==this.keyman.keyboardManager.activeKeyboard?!0:this.keyman.textProcessor.keyPress(e)}.bind(this);this._KeyUp=function(a){var c=this.keyman.textProcessor,e=this.keyman.osk,b=c._GetKeyEventProperties(a,!1);return null!=b&&e.ready?13!=b.Lcode||(e=!1,b.Ltarg instanceof b.Ltarg.ownerDocument.defaultView.HTMLTextAreaElement&&(e=!0),b.Ltarg.base&&b.Ltarg.base instanceof b.Ltarg.base.ownerDocument.defaultView.HTMLTextAreaElement&&(e=!0),e)?c.keyUp(a):(b.Ltarg instanceof b.Ltarg.ownerDocument.defaultView.HTMLInputElement&&
(a=b.Ltarg,"search"==a.type||"submit"==a.type?a.form.submit():this.keyman.domManager.moveToNext(!1)),!0):!0}.bind(this);this.keyman=b}a.prototype.doControlFocused=function(a,e){var c={};c.target=a;c.activeControl=e;return this.keyman.util.callEvent("kmw.controlfocused",c)};a.prototype.doControlBlurred=function(a,e,c){var b={};b.target=a;b.event=e;b.isActivating=c;return this.keyman.util.callEvent("kmw.controlblurred",b)};a.prototype._BlurKeyboardSettings=function(b,e){var c=this.keyman.keyboardManager.activeKeyboard?
this.keyman.keyboardManager.activeKeyboard.KI:"",k=this.keyman.keyboardManager.getActiveLanguage();void 0!==b&&void 0!==e&&(c=b,k=e);(b=a.states.lastActiveElement)&&null!=b._kmwAttachment.keyboard?(b._kmwAttachment.keyboard=c,b._kmwAttachment.languageCode=k):(this.keyman.globalKeyboard=c,this.keyman.globalLanguageCode=k)};a.prototype._FocusKeyboardSettings=function(b){var e=a.states.lastActiveElement;e&&null!=e._kmwAttachment.keyboard?this.keyman.keyboardManager.setActiveKeyboard(e._kmwAttachment.keyboard,
e._kmwAttachment.languageCode):b||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode);this.keyman.modelManager&&this.keyman.modelManager.invalidateContext()};a.prototype._CommonFocusHelper=function(b){var e=this.keyman.uiManager;if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(b,1)||!this.keyman.domManager._IsMozillaEditableIframe(b,1)))return a.states._DisableInput=!0;
a.states._DisableInput=!1;e.justActivated||(b&&f.text.Processor.getOutputTarget(b)&&f.text.Processor.getOutputTarget(b).deadkeys().clear(),this.keyman["interface"].notifyKeyboard(0,b,1));e.justActivated||a.states._SelectionControl==b||(e.isActivating=!1);e.justActivated=!1;a.states._SelectionControl=b;return!1};a.prototype.doChangeEvent=function(b){if(a.states.changed){if("function"==typeof Event)var e=new Event("change",{bubbles:!0,cancelable:!1});else e=document.createEvent("HTMLEvents"),e.initEvent("change",
!0,!1);b.base&&b.base.kmw_ip&&(b=b.base);b.dispatchEvent(e)}a.states.changed=!1};a.states=new g;return a}();f.DOMEventHandlers=l;var d=function(a){function b(e){e=a.call(this,e)||this;e.setFocus=function(a){l.states.setFocusTimer();a&&f.dom.Utils.instanceof(a,"TouchEvent")?a=a.touches[0]:(a={clientX:0,clientY:0},a.target=l.states.lastActiveElement?l.states.lastActiveElement.kmw_ip:this.keyman.domManager.sortedInputs[0].kmw_ip);this.setFocusWithTouch(a)}.bind(e);e.setBlur=function(a){this.keyman.interface.resetContext();
if("relatedTarget"in a&&a.relatedTarget&&(a=a.relatedTarget,this.doChangeEvent(a),"DIV"!=a.nodeName||-1==a.className.indexOf("keymanweb-input"))){this.cancelInput();return}l.states.focusing||this.cancelInput()}.bind(e);e.dragInput=function(a){a.preventDefault();a.stopPropagation();var c=f.dom.Utils.instanceof(a,"TouchEvent")?a.targetTouches[0].target:a.target;if(null!=c){if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=c.parentNode;if(null==c.className||0>c.className.indexOf("keymanweb-input"))c=
c.parentNode;if(!(null==c.className||0>c.className.indexOf("keymanweb-input"))){if(f.dom.Utils.instanceof(a,"TouchEvent")){var e=a.touches[0].screenX;var b=a.touches[0].screenY}else e=a.screenX,b=a.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch={x:e,y:b};else{var d=this.firstTouch.x,g=this.firstTouch.y;a=c.firstChild;if("TEXTAREA"==c.base.nodeName){if(e=parseInt(a.style.top,10),isNaN(e)&&(e=0),d=g-b,-4>d||4<d)a.style.top=(e<d?e-d:0)+"px",this.firstTouch.y=b}else{b=
parseInt(a.style.left,10);isNaN(b)&&(b=0);var m=d-e;if(-4>m||4<m)d=0,g=f.dom.Utils.getAbsoluteX(c)+c.offsetWidth-a.offsetWidth-32,"rtl"==c.base.dir?d=16:g-=24,b-=m,b>d&&(b=d),b<g&&(b=g),a.style.left=b+"px",this.firstTouch.x=e}}this.setScrollBar(c)}}}.bind(e);return e}__extends(b,a);b.prototype.setFocusWithTouch=function(a){var c=this.keyman.osk,b=a.clientX,e=a.clientY,d=a.target;var g=d&&f.dom.Utils.instanceof(d,"HTMLSpanElement")?d.parentNode:d&&null!=d.className&&0<=d.className.indexOf("keymanweb-input")?
d.firstChild:d;a=g.parentNode;if(l.states.activeElement!=a){var h=l.states.activeElement;h&&h.hideCaret();l.states.activeElement=a;a.focus()}this.keyman.domManager._SetTargDir(a);c.ready&&!c._Visible&&c._Show();if(d&&f.dom.Utils.instanceof(d,"TouchAliasElement"))e=f.dom.Utils.getAbsoluteX(g.firstChild),"rtl"==a.dir?(e+=g.firstChild.offsetWidth,c=b>e?0:1E5):c=b<e?0:1E5,a.setTextCaret(c),a.scrollInput();else{var m;g=g.childNodes[1];d=0;h=a.getText()._kmwLength();c=a.getTextCaret();var q=document.body.scrollTop;
if(a.base instanceof a.base.ownerDocument.defaultView.HTMLTextAreaElement){var r=Math.round(a.base.offsetHeight/a.base.rows);for(m=0;16>m;m++){var t=f.dom.Utils.getAbsoluteY(g)-q;if(t>e&&c>d&&c!=h)h=c,c=Math.round((c+d)/2);else if(t<e-r&&c<h&&c!=d)d=c,c=Math.round((c+h)/2);else break;a.setTextCaret(c)}for(;f.dom.Utils.getAbsoluteY(g)-q>e&&c>d;)a.setTextCaret(--c);for(;f.dom.Utils.getAbsoluteY(g)-q<e-r&&c<h;)a.setTextCaret(++c)}t="rtl"==a.dir?function(a,c){return a<c}:function(a,c){return a>c};for(m=
0;16>m;m++){e=f.dom.Utils.getAbsoluteX(g);if(t(e,b)&&c>d&&c!=h)h=c,c=Math.round((c+d)/2);else if(!t(e,b)&&c<h&&c!=d)d=c,c=Math.round((c+h)/2);else break;a.setTextCaret(c)}for(;t(f.dom.Utils.getAbsoluteX(g),b)&&c>d;)a.setTextCaret(--c);for(;!t(f.dom.Utils.getAbsoluteX(g),b)&&c<h;)a.setTextCaret(++c)}this._BlurKeyboardSettings();l.states.lastActiveElement=a;a.showCaret();this._FocusKeyboardSettings(!1);this._CommonFocusHelper(a)};b.prototype.cancelInput=function(){l.states.activeElement&&l.states.activeElement.hideCaret&&
l.states.activeElement.hideCaret();l.states.activeElement=null;this.keyman.osk.hideNow()};b.prototype.setScrollBar=function(a){var c=a.childNodes[0],b=a.childNodes[1].style;(c.offsetWidth>a.offsetWidth||0>c.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(b.height="4px",b.width=a.offsetWidth/c.offsetWidth*100+"%",b.left=-c.offsetLeft/c.offsetWidth*100+"%",b.top="0",b.visibility="visible"):c.offsetHeight>a.offsetHeight||0>c.offsetTop?(b.width="4px",b.height=a.offsetHeight/c.offsetHeight*100+"%",b.top=-c.offsetTop/
c.offsetHeight*100+"%",b.left="0",b.visibility="visible"):b.visibility="hidden"};b.prototype.scrollBody=function(a){var c=this.keyman.osk;if(a&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))&&c.ready){a=a.firstChild.childNodes[1];var b=f.dom.Utils.getAbsoluteY(a),e=window.pageYOffset;b<e?c=b-e:(c=b-e-(window.innerHeight-c._Box.offsetHeight-a.offsetHeight-2),0>c&&(c=0));0!=c&&window.scrollTo(0,c+window.pageYOffset)}};return b}(l);f.DOMTouchHandlers=d})(f.keyman||(f.keyman={}))})(com||
(com={}));
(function(f){(function(f){(function(f){var g=function(){function d(a){if(void 0===a||null===a)this.components=[].concat(d.DEVELOPER_VERSION_FALLBACK.components);else if(Array.isArray(a)){if(2>a.length)throw Error("Version string must have at least a major and minor component!");this.components=[].concat(a)}else{a=a.split(".");var b=[];if(2>a.length)throw Error("Version string must have at least a major and minor component!");for(var e=0;e<a.length;e++){var c=parseInt(a[e],10);if(isNaN(c))throw Error("Version string components must be numerical!");b.push(c)}this.components=
b}}Object.defineProperty(d.prototype,"major",{get:function(){return this.components[0]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"minor",{get:function(){return this.components[1]},enumerable:!0,configurable:!0});d.prototype.toString=function(){return this.components.join(".")};d.prototype.equals=function(a){return 0==this.compareTo(a)};d.prototype.precedes=function(a){return 0>this.compareTo(a)};d.prototype.compareTo=function(a){var b=this.components.length<a.components.length,
e=this.components.length<a.components.length?this.components.length:a.components.length,c;for(c=0;c<e;c++){var k=this.components[c]-a.components[c];if(0!=k)return k}a=b?a.components:this.components;do{if(0<a[c])return b?-1:1;c++}while(c<a.length);return 0};d.DEVELOPER_VERSION_FALLBACK=new d([9,0,0]);d.NO_DEFAULT_KEYCAPS=new d([12,0]);d.MAC_POSSIBLE_IPAD_ALIAS=new d([10,15]);return d}();f.Version=g})(f.utils||(f.utils={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){var g=function(){function g(){this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}g.prototype.getDPI=function(){var d=document.createElement("DIV"),a=d.style,b=96;if("complete"!==document.readyState)return b;d.id="calculateDPI";a.position="absolute";a.display="block";a.visibility="hidden";a.left="10px";a.top="10px";a.width="1in";a.height="10px";
document.body.appendChild(d);b="undefined"==typeof window.devicePixelRatio?d.offsetWidth:d.offsetWidth*window.devicePixelRatio;document.body.removeChild(d);return b};g.prototype.detect=function(){var d=g._GetIEVersion(),a=!1;if(navigator&&navigator.userAgent){var b=navigator.userAgent;if(0<=b.indexOf("iPad"))this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0;else if(0<=b.indexOf("iPhone"))this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=25;else if(0<=b.indexOf("Android")){this.OS=
"Android";this.formFactor="phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=b.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(e){}}else 0<=b.indexOf("Linux")?this.OS="Linux":0<=b.indexOf("Macintosh")?(b=/Intel Mac OS X (10(?:[_\.]\d+)+)/i.exec(b),1<b.length&&b[1]&&(a=b[1].replace("_","."),a=new f.utils.Version(a),a=0>=f.utils.Version.MAC_POSSIBLE_IPAD_ALIAS.compareTo(a),this.OS="MacOSX")):0<=b.indexOf("Windows NT")&&(this.OS="Windows",0<=b.indexOf("Touch")&&(this.formFactor="phone"),
"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}"tablet"==this.formFactor&&400>Math.min(screen.width,screen.height)&&(this.formFactor="phone");"phone"==this.formFactor&&720<Math.max(screen.width,screen.height)&&"iOS"!=this.OS&&(this.formFactor="tablet");b="Win32"==navigator.platform||"MacIntel"==navigator.platform;"iOS"!=this.OS||"ongesturestart"in window||b||(this.OS="Android");this.browser="web";if(999>d)this.browser="ie";else{if("iOS"==this.OS||"macosx"==
this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR|Safari|Edge/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?this.browser="opera":0<=navigator.userAgent.indexOf(" Edge/")?this.browser="edge":0<=navigator.userAgent.indexOf("Chrome")?this.browser="chrome":0<=navigator.userAgent.indexOf("Safari")&&(this.browser="safari"))}a&&"safari"==this.browser&&window.TouchEvent&&
(this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0,d=screen.height/screen.width,1>d&&(d=1/d),1.6<d&&(this.formFactor="phone",this.dyPortrait=this.dyLandscape=25))};g._GetIEVersion=function(){var d="";"userAgent"in navigator&&(d=navigator.userAgent);if("selection"in document){var a=navigator.appVersion;var b=a.indexOf("MSIE ");if(0<=b){if("BackCompat"==document.compatMode)return 6;a=a.substr(b+5);b=a.indexOf(".");if(0<b)return parseInt(a.substr(0,b),10)}}b=d.indexOf("Trident/");
if(0>b)return 999;d=d.substr(b+8);b=d.indexOf(".");return 0<b?parseInt(d.substr(0,b),10)+4:999};return g}();f.Device=g})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(f){var g=function(){function d(){}d.getAbsoluteX=function(a){if(!a)return 0;var b=a.offsetLeft?a.offsetLeft:0;var e=a;if(e.offsetParent){for(;e.offsetParent;)e=e.offsetParent,b+=e.offsetLeft;"fixed"==e.style.position&&(b+=e.ownerDocument.scrollingElement.scrollLeft)}return e&&e.ownerDocument&&a.ownerDocument!=window.document&&(a=e.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+d.getAbsoluteX(a.defaultView.frameElement)-a.documentElement.scrollLeft:
b};d.getAbsoluteY=function(a){if(!a)return 0;var b=a.offsetTop?a.offsetTop:0;var e=a;if(e.ownerDocument&&e instanceof e.ownerDocument.defaultView.HTMLElement){for(;e.offsetParent;)e=e.offsetParent,b+=e.offsetTop;"fixed"==e.style.position&&(b+=e.ownerDocument.scrollingElement.scrollTop)}return e&&e.ownerDocument&&a.ownerDocument!=window.document&&(a=e.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+d.getAbsoluteY(a.defaultView.frameElement)-a.documentElement.scrollTop:b};d.instanceof=function(a,
b){if("TouchAliasElement"==b)return this.instanceof(a,"HTMLDivElement")?void 0!==a.base:!1;var e;if(a.Window)return"Window"==b;a.defaultView?e=a.defaultView[b]:a.ownerDocument?e=a.ownerDocument.defaultView[b]:a.target&&(this.instanceof(a.target,"Window")?e=a.target[b]:this.instanceof(a.target,"Document")?e=a.target.defaultView[b]:this.instanceof(a.target,"HTMLElement")&&(e=a.target.ownerDocument.defaultView[b]));return e?a instanceof e:!1};return d}();f.Utils=g})(f.dom||(f.dom={}))})(f.keyman||(f.keyman=
{}))})(com||(com={}));
(function(f){(function(g){(function(g){g.constructTouchAlias=function(d){var a=document.createElement("div"),b=new h,e;for(e in b)a.hasOwnProperty(e)||(a[e]=b[e]);d?a.initWithBase(d):a.init();return a};var h=function(){function d(){this.base=null;this.__activeCaret=!1}d.getDevice=function(){if(!d.device){var a=new f.keyman.Device;a.detect();d.device=a}return d.device};d.getOS=function(){return this.getDevice().OS};d.prototype.isMultiline=function(){return this.base&&"TEXTAREA"==this.base.nodeName};
d.prototype.initCaret=function(){this.__caretDiv=document.createElement("DIV");var a=this.__caretDiv.style;a.position="absolute";a.height="16px";a.width="2px";a.backgroundColor="blue";a.border="none";a.left=a.top="0px";a.display="block";a.visibility="hidden";a.zIndex="9998";this.__caretTimerId=window.setInterval(this.flashCaret.bind(this),500)};d.prototype.init=function(){this.className="keymanweb-input";var a=this.__scrollDiv=document.createElement("div"),b=this.style;b.overflow="hidden";b.position=
"absolute";b.border="hidden";b.border="none";b.borderRadius="5px";var e=this.__scrollBar=document.createElement("div"),c=e.style;c.position="absolute";c.height=c.width="4px";c.left=c.top="0";c.display="block";c.visibility="hidden";c.backgroundColor="#808080";c.borderRadius="2px";this.__preCaret=document.createElement("span");this.__postCaret=document.createElement("span");this.__caretSpan=document.createElement("span");this.__preCaret.innerHTML=this.__postCaret.innerHTML=this.__caretSpan.innerHTML=
"";this.__preCaret.className=this.__postCaret.className=this.__caretSpan.className="keymanweb-font";a.appendChild(this.__preCaret);a.appendChild(this.__caretSpan);a.appendChild(this.__postCaret);this.appendChild(a);this.appendChild(e);a=a.style;a.position="absolute";e=this.__preCaret.style;c=this.__postCaret.style;var k=this.__caretSpan.style;e.border=c.border="none";e.height=c.height="100%";k.border="1px solid red";k.visibility="hidden";k.marginLeft=k.marginRight="-1px";b.padding="8px";a.padding=
"0px 2px";this.tabIndex=0;this.style.msTouchAction="none";a.minWidth=b.width;a.height=b.height;this.initCaret()};d.prototype.initWithBase=function(a){this.base=a;this.init();this.base.kmw_ip=this;a.disabled=!0;var b=window.getComputedStyle(a,null),e=this.__scrollDiv.style,c=this.__preCaret.style,k=this.__postCaret.style;this.dir=a.dir;c.fontFamily=k.fontFamily=e.fontFamily=b.fontFamily;"input"!=a.nodeName.toLowerCase()||isNaN(parseInt(b.height,10))||(c.lineHeight=k.lineHeight=b.height);"Android"==
d.getOS()&&"transparent"==b.backgroundColor?e.backgroundColor="#fff":e.backgroundColor=b.backgroundColor;"textarea"==this.base.nodeName.toLowerCase()?c.whiteSpace=k.whiteSpace="pre-wrap":c.whiteSpace=k.whiteSpace="pre";this.base.parentNode.appendChild(this);this.updateInput();c=this.style;c.color=b.color;c.fontFamily=b.fontFamily;c.fontSize=b.fontSize;c.fontWeight=b.fontWeight;c.textDecoration=b.textDecoration;c.padding=b.padding;c.margin=b.margin;c.border=b.border;c.borderRadius=b.borderRadius;"webkitTapHighlightColor"in
c&&(c.webkitTapHighlightColor="rgba(0,0,0,0)");a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement?(2==a.rows&&(k=parseInt(b.height,10)-parseInt(b.paddingTop,10)-parseInt(b.paddingBottom,10),b=parseInt(b.fontSize,10),b=Math.round(k/b),b>a.rows+1&&(a.rows=b)),e.width=c.width,e.minHeight=c.height):(e.minWidth=c.width,e.height=c.height);a.style.visibility="hidden";(function(a){a.__resizeHandler=function(){window.setTimeout(function(){a.updateInput()},1)};a.base.addEventListener("resize",a.__resizeHandler,
!1);a.base.addEventListener("orientationchange",a.__resizeHandler,!1)})(this);this.setText(a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement||a instanceof a.ownerDocument.defaultView.HTMLInputElement?a.value:a.textContent,null)};d.prototype.setText=function(a,b){if(null===a){var e=this.__preCaret.textContent;a=this.__postCaret.textContent;a=e+a}0>b&&(b=0);e=a._kmwLength();if(null===b||void 0===b||b>e)b=e;e=a._kmwSubstr(0,b);a=a._kmwSubstr(b);this.__preCaret.textContent=e;this.__postCaret.textContent=
a;this.updateBaseElement()};d.prototype.getTextBeforeCaret=function(){return this.__preCaret.textContent};d.prototype.getTextAfterCaret=function(){return this.__postCaret.textContent};d.prototype.setTextBeforeCaret=function(a){this.isMultiline()||(a=a.replace(/\s+$/," "));this.__preCaret.textContent=a;this.updateBaseElement();this.scrollInput()};d.prototype.getTextCaret=function(){return this.getTextBeforeCaret()._kmwLength()};d.prototype.setTextCaret=function(a){this.setText(null,a);this.showCaret()};
d.prototype.updateBaseElement=function(){if(this.base){var a=this.base.ownerDocument.defaultView;this.base instanceof a.HTMLInputElement||this.base instanceof a.HTMLTextAreaElement?this.base.value=this.getText():this.base.textContent=this.getText();a=this.getText()._kmwLength();this.style.backgroundColor=0==a?"transparent":window.getComputedStyle(this.base,null).backgroundColor;"iOS"==d.getOS()&&(this.base.style.visibility=0==a?"visible":"hidden")}};d.prototype.flashCaret=function(){if(this.__activeCaret){var a=
this.__caretDiv.style;a.visibility="visible"!=a.visibility?"visible":"hidden"}};d.prototype.showCaret=function(){var a=this.__scrollDiv,b=this.__caretDiv.style,e=this.__caretSpan;this.__caretDiv.parentNode!=a&&a.appendChild(this.__caretDiv);b.left=e.offsetLeft+"px";b.top=e.offsetTop+"px";b.height=e.offsetHeight-1+"px";b.visibility="hidden";this.__activeCaret=!0;this.scrollBody();this.setScrollBar()};d.prototype.hideCaret=function(){if(this.base instanceof this.base.ownerDocument.defaultView.HTMLTextAreaElement||
this.base instanceof this.base.ownerDocument.defaultView.HTMLInputElement)this.base.value=this.getText();this.setText(null,1E5);var a=this.__scrollDiv.style;this.isMultiline()?a.top="0":a.left="rtl"==this.base.dir?this.offsetWidth-this.__scrollDiv.offsetWidth-8+"px":"0";this.__caretDiv.parentNode&&this.__caretDiv.parentNode.removeChild(this.__caretDiv);this.__caretDiv.style.visibility="hidden";this.__scrollBar.style.visibility="hidden";this.__activeCaret=!1};d.prototype.getText=function(){return this.textContent};
d.prototype.updateInput=function(){if(this.base){var a=this.style,b=this.base,e=window.getComputedStyle(b,null),c=parseInt(e.marginLeft,10),k=parseInt(e.marginTop,10),n=g.Utils.getAbsoluteX(b),f=g.Utils.getAbsoluteY(b),p=this.offsetParent;p&&(n-=g.Utils.getAbsoluteX(p),f-=g.Utils.getAbsoluteY(p));isNaN(c)&&(c=0);isNaN(k)&&(k=0);a.left=n-c+"px";a.top=f-k+"px";"undefined"!=typeof e.MozBoxSizing&&(a.left=n+"px",a.top=f+"px");c=b.offsetWidth;b=b.offsetHeight;k=parseInt(e.paddingLeft,10);n=parseInt(e.paddingRight,
10);f=parseInt(e.paddingTop,10);p=parseInt(e.paddingBottom,10);var h=parseInt(e.borderLeft,10),m=parseInt(e.borderRight,10),q=parseInt(e.borderTop,10),l=parseInt(e.borderBottom,10),t="undefined";"undefined"!=typeof e.boxSizing?t=e.boxSizing:"undefined"!=typeof e.MozBoxSizing&&(t=e.MozBoxSizing);"content-box"==t&&(isNaN(k)||(c-=k),isNaN(n)||(c-=n),isNaN(h)||(c-=h),isNaN(m)||(c-=m),isNaN(f)||(b-=f),isNaN(p)||(b-=p),isNaN(q)||(b-=q),isNaN(l)||(b-=l));"Android"==d.getOS()&&("undefined"!=typeof e.MozBoxSizing?
(a.paddingTop=f+1+"px",a.paddingLeft=k+"px",this.isMultiline()?a.marginTop="1px":a.marginLeft="1px",c--,b--):(c++,b++));a.width=c+"px";a.height=b+"px"}};d.prototype.scrollInput=function(){var a=this.__scrollDiv,b=this.__caretSpan,e=g.Utils.getAbsoluteX(b);b=g.Utils.getAbsoluteY(b);var c=g.Utils.getAbsoluteX(this),k=g.Utils.getAbsoluteY(this),d=parseInt(a.style.left,10),f=parseInt(a.style.top,10),p=0,h=0;isNaN(d)&&(d=0);isNaN(f)&&(f=0);this.isMultiline()?(e=Math.round(this.offsetHeight/this.base.rows),
b<k&&(h=b-k),b>k+this.offsetHeight-e&&(h=b-k-this.offsetHeight+e),0!=h&&(a.style.top=(f<h?f-h:0)+"px")):(e<c+8&&(p=e-c-12),e>c+this.offsetWidth-12&&(p=e-c-this.offsetWidth+12),0!=p&&(a.style.left=(d<p?d-p:0)+"px"));this.showCaret()};d.prototype.scrollBody=function(){var a=0;window.keyman&&(a=window.keyman.osk._Box.offsetHeight);var b=this.__caretSpan,e=g.Utils.getAbsoluteY(b),c=window.pageYOffset;e<c?a=e-c:(a=e-c-(window.innerHeight-a-b.offsetHeight-2),0>a&&(a=0));0!=a&&window.scrollTo(0,a+window.pageYOffset)};
d.prototype.setScrollBar=function(){var a=this.__scrollDiv,b=this.__scrollBar.style;(a.offsetWidth>this.offsetWidth||0>a.offsetLeft)&&!this.isMultiline()?(b.height="4px",b.width=this.offsetWidth/a.offsetWidth*100+"%",b.left=-a.offsetLeft/a.offsetWidth*100+"%",b.top="0",b.visibility="visible"):a.offsetHeight>this.offsetHeight||0>a.offsetTop?(b.width="4px",b.height=this.offsetHeight/a.offsetHeight*100+"%",b.top=-a.offsetTop/a.offsetHeight*100+"%",b.left="0",b.visibility="visible"):b.visibility="hidden"};
return d}()})(g.dom||(g.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(g){var h=function(d){function a(a){var b=d.call(this)||this;b.root=a;b._cachedSelectionStart=-1;return b}__extends(a,d);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){var a=this.getCaret();this.root.value=this.root.value._kmwSubstring(0,a)+this.root.value._kmwSubstring(this.processedSelectionEnd);this.setCaret(a)};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=
-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a)};a.prototype.setSelection=
function(a,e){var c=this.root.value._kmwCodePointToCodeUnit(a),b=this.root.value._kmwCodePointToCodeUnit(e);this.root.setSelectionRange(c,b);this.processedSelectionStart=a;this.processedSelectionEnd=e};a.prototype.getTextBeforeCaret=function(){return this.getText()._kmwSubstring(0,this.getCaret())};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setCaret(b)};a.prototype.setTextAfterCaret=
function(a){var b=this.getCaret();this.root.value=this.getTextBeforeCaret()+a;this.setCaret(b)};a.prototype.getTextAfterCaret=function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret(),c=this.getCaret();a>c&&(a=c);this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,this.getCaret()-a));this.setCaret(c-a)}};a.prototype.insertTextBeforeCaret=
function(a){if(a){var b=this.getCaret(),c=this.getTextBeforeCaret(),k=this.getText()._kmwSubstring(this.processedSelectionStart);this.adjustDeadkeys(a._kmwLength());this.root.value=c+a+k;this.setCaret(b+a._kmwLength())}};return a}(f.text.OutputTarget);g.Input=h})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(g){var h=function(d){function a(a){var b=d.call(this)||this;b.root=a;b._cachedSelectionStart=-1;return b}__extends(a,d);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){var a=this.getCaret();this.root.value=this.root.value._kmwSubstring(0,a)+this.root.value._kmwSubstring(this.processedSelectionEnd);this.setCaret(a)};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=
-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a)};a.prototype.setSelection=
function(a,e){var c=this.root.value._kmwCodePointToCodeUnit(a),b=this.root.value._kmwCodePointToCodeUnit(e);this.root.setSelectionRange(c,b);this.processedSelectionStart=a;this.processedSelectionEnd=e};a.prototype.getTextBeforeCaret=function(){return this.getText()._kmwSubstring(0,this.getCaret())};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setCaret(b)};a.prototype.setTextAfterCaret=
function(a){var b=this.getCaret();this.root.value=this.getTextBeforeCaret()+a;this.setCaret(b)};a.prototype.getTextAfterCaret=function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.saveProperties=function(){this.scrollLeft=this.root.scrollLeft;this.scrollTop=this.root.scrollTop};a.prototype.restoreProperties=function(){void 0!==this.scrollLeft&&(this.root.scrollLeft=this.scrollLeft,this.root.scrollTop=
this.scrollTop,delete this.scrollLeft,delete this.scrollTop)};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret(),c=this.getCaret();a>c&&(a=c);this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,this.getCaret()-a));this.setCaret(c-a)}};a.prototype.insertTextBeforeCaret=function(a){if(a){var b=this.getCaret(),c=this.getTextBeforeCaret(),k=this.getText()._kmwSubstring(this.processedSelectionStart);this.adjustDeadkeys(a._kmwLength());this.root.value=c+
a+k;this.setCaret(b+a._kmwLength())}};return a}(f.text.OutputTarget);g.TextArea=h})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(g){var h=function(){return function(a,e){this.node=a;this.offset=e}}(),d=function(){return function(a,e){this.start=a;this.end=e}}(),a=function(a){function b(c){if(c.isContentEditable){var b=a.call(this)||this;b.root=c}else throw"Specified element is not already content-editable!";return b}__extends(b,a);b.prototype.getElement=function(){return this.root};b.prototype.hasSelection=function(){var a=this.root.ownerDocument.getSelection(),b=function(a,c){return 3!=
c.nodeType?null:0!=(c.compareDocumentPosition(a)&8)};return this.root!=a.anchorNode&&!this.root.contains(a.anchorNode)&&!b(this.root,a.anchorNode)||this.root!=a.focusNode&&!this.root.contains(a.focusNode)&&!b(this.root,a.anchorNode)?!1:!0};b.prototype.clearSelection=function(){if(this.hasSelection()){var a=this.root.ownerDocument.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};b.prototype.invalidateSelection=function(){};b.prototype.getCarets=
function(){var a=this.root.ownerDocument.getSelection(),b=a.anchorNode.compareDocumentPosition(a.focusNode);if(a.isCollapsed)return b=new h(a.anchorNode,a.anchorOffset),new d(b,b);var e=new h(a.anchorNode,a.anchorOffset);a=new h(a.focusNode,a.focusOffset);e.node==a.node&&(b=0<a.offset-e.offset?2:4);return b&2?new d(e,a):new d(a,e)};b.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};b.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;
return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};b.prototype.getTextAfterCaret=function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};b.prototype.getText=function(){return this.root.innerText};b.prototype.deleteCharsBeforeCaret=function(a){if(this.hasSelection()&&!(0>=a)){var c=this.getCarets().start;a>c.offset&&(a=c.offset);if(3!=c.node.nodeType)console.warn("Deletion of characters requested without available context!");
else{var b=this.root.ownerDocument.createRange(),e=c.offset-c.node.nodeValue.substr(0,c.offset)._kmwSubstr(-a).length;b.setStart(c.node,e);b.setEnd(c.node,c.offset);this.adjustDeadkeys(-a);b.deleteContents()}}};b.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var c=this.getCarets().start,b=a._kmwLength(),e=this.root.ownerDocument.getSelection();if(0!=b){this.adjustDeadkeys(b);b=this.root.ownerDocument.createRange();if(3==c.node.nodeType){var d=c.node;d.insertData(c.offset,a);
b.setStart(d,c.offset+a.length)}else a=c.node.ownerDocument.createTextNode(a),d=this.root.ownerDocument.createRange(),d.setStart(c.node,c.offset),d.collapse(!0),d.insertNode(a);b.collapse(!0);e.removeAllRanges();try{e.addRange(b)}catch(v){c.node.parentElement.scrollIntoView(),e.addRange(b)}e.collapseToEnd()}}};b.prototype.setTextAfterCaret=function(a){if(this.hasSelection()){var c=this.getCarets().end,b=a._kmwLength();this.root.ownerDocument.getSelection();0!=b&&(3==c.node.nodeType?(b=c.node,b.replaceData(c.offset,
b.length,a)):(a=c.node.ownerDocument.createTextNode(a),b=this.root.ownerDocument.createRange(),b.setStart(c.node,c.offset),b.collapse(!0),b.insertNode(a)))}};return b}(f.text.OutputTarget);g.ContentEditable=a})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(g){var h=function(){return function(a,c){this.node=a;this.offset=c}}(),d=function(){return function(a,c){this.start=a;this.end=c}}(),a=function(){return function(a,c){this.cmd=a;this.stateType=c}}(),b=function(b){function c(a){var c=b.call(this)||this;c.root=a;if(a.contentWindow&&a.contentWindow.document&&"on"==a.contentWindow.document.designMode)c.doc=a.contentWindow.document,c.docRoot=a.contentWindow.document.documentElement;else throw"Specified IFrame is not in design-mode!";
return c}__extends(c,b);c.prototype.getElement=function(){return this.root};c.prototype.hasSelection=function(){this.doc.getSelection();document.getSelection();return!0};c.prototype.clearSelection=function(){if(this.hasSelection()){var a=this.doc.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};c.prototype.invalidateSelection=function(){};c.prototype.getCarets=function(){var a=this.doc.getSelection(),c=a.anchorNode.compareDocumentPosition(a.focusNode);
if(a.isCollapsed)return c=new h(a.anchorNode,a.anchorOffset),new d(c,c);var b=new h(a.anchorNode,a.anchorOffset);a=new h(a.focusNode,a.focusOffset);b.node==a.node&&(c=0<a.offset-b.offset?2:4);return c&2?new d(b,a):new d(a,b)};c.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};c.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};c.prototype.getTextAfterCaret=
function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};c.prototype.getText=function(){return this.docRoot.innerText};c.prototype.deleteCharsBeforeCaret=function(a){if(this.hasSelection()&&!(0>=a)){var c=this.getCarets().start;a>c.offset&&(a=c.offset);if(3!=c.node.nodeType)console.warn("Deletion of characters requested without available context!");else{var b=this.doc.createRange(),e=c.offset-c.node.nodeValue.substr(0,c.offset)._kmwSubstr(-a).length;
b.setStart(c.node,e);b.setEnd(c.node,c.offset);this.adjustDeadkeys(-a);b.deleteContents()}}};c.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var c=this.getCarets().start,b=a._kmwLength(),e=this.doc.getSelection();if(0!=b){this.adjustDeadkeys(b);b=this.root.ownerDocument.createRange();if(3==c.node.nodeType){var k=c.node;k.insertData(c.offset,a);b.setStart(k,c.offset+a.length)}else a=this.doc.createTextNode(a),k=this.doc.createRange(),k.setStart(c.node,c.offset),k.collapse(!0),
k.insertNode(a);b.collapse(!0);e.removeAllRanges();try{e.addRange(b)}catch(m){c.node.parentElement.scrollIntoView(),e.addRange(b)}e.collapseToEnd()}}};c.prototype.setTextAfterCaret=function(a){if(this.hasSelection()){var c=this.getCarets().end,b=a._kmwLength();this.doc.getSelection();0!=b&&(3==c.node.nodeType?(b=c.node,b.replaceData(c.offset,b.length,a)):(a=c.node.ownerDocument.createTextNode(a),b=this.root.ownerDocument.createRange(),b.setStart(c.node,c.offset),b.collapse(!0),b.insertNode(a)))}};
c.prototype.saveProperties=function(){var c=[new a("backcolor",1),new a("fontname",1),new a("fontsize",1),new a("forecolor",1),new a("bold",0),new a("italic",0),new a("strikethrough",0),new a("subscript",0),new a("superscript",0),new a("underline",0)];this.doc.defaultView&&c.push(new a("hilitecolor",1));for(var b=0;b<c.length;b++){var e=c[b];e.cache=1==e.stateType?this.doc.queryCommandValue(e.cmd):this.doc.queryCommandState(e.cmd)}this.commandCache=c};c.prototype.restoreProperties=function(a){this.commandCache||
console.error("No command cache exists to restore!");for(var c=0;c<this.commandCache.length;c++){var b=this.commandCache[c];1==b.stateType?this.doc.queryCommandValue(b.cmd)!=b.cache&&(a&&a(),this.doc.execCommand(b.cmd,!1,b.cache)):this.doc.queryCommandState(b.cmd)!=b.cache&&(a&&a(),this.doc.execCommand(b.cmd,!1,null))}};return c}(f.text.OutputTarget);g.DesignIFrame=b})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(g){var h=function(d){function a(a){var b=d.call(this)||this;b.root=a;return b}__extends(a,d);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){};a.prototype.invalidateSelection=function(){};a.prototype.hasSelection=function(){return!0};a.prototype.getDeadkeyCaret=function(){return this.root.getTextCaret()};a.prototype.getTextBeforeCaret=function(){return this.root.getTextBeforeCaret()};a.prototype.getTextAfterCaret=function(){return this.root.getTextAfterCaret()};
a.prototype.getText=function(){return this.root.getText()};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret();this.getDeadkeyCaret()<a&&(a=this.getDeadkeyCaret());this.adjustDeadkeys(-a);this.root.setTextBeforeCaret(b.kmwSubstring(0,this.root.getTextCaret()-a))}};a.prototype.insertTextBeforeCaret=function(a){this.adjustDeadkeys(a._kmwLength());this.root.setTextBeforeCaret(this.root.getTextBeforeCaret()+a)};a.prototype.setTextAfterCaret=function(a){this.root.setText(this.getTextBeforeCaret()+
a,this.getTextBeforeCaret()._kmwLength())};return a}(f.text.OutputTarget);g.TouchAlias=h})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(f){f.wrapElement=function(g){return f.Utils.instanceof(g,"HTMLInputElement")?new f.Input(g):f.Utils.instanceof(g,"HTMLTextAreaElement")?new f.TextArea(g):f.Utils.instanceof(g,"TouchAliasElement")?new f.TouchAlias(g):f.Utils.instanceof(g,"HTMLIFrameElement")&&g.contentWindow&&g.contentWindow.document&&"on"==g.contentWindow.document.designMode?new f.DesignIFrame(g):g.isContentEditable?new f.ContentEditable(g):null}})(f.dom||(f.dom={}))})(f.keyman||(f.keyman={}))})(com||
(com={}));
(function(f){(function(f){var g=function(){function g(d){this.inputList=[];this.sortedInputs=[];this.nonKMWTouchHandler=function(a){f.DOMEventHandlers.states.focusing=!1;clearTimeout(f.DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);this._EnablementMutationObserverCore=function(a){for(var b=0;b<a.length;b++){var e=a[b],c=e.oldValue?0<=e.oldValue.indexOf("kmw-disabled"):!1,k=0<=e.target.className.indexOf("kmw-disabled");c&&!k?this._EnableControl(e.target):!c&&k&&this._DisableControl(e.target);
!k&&"readonly"==e.attributeName&&(c=e.oldValue?null!=e.oldValue:!1,k=e.target,k instanceof k.ownerDocument.defaultView.HTMLInputElement||k instanceof k.ownerDocument.defaultView.HTMLTextAreaElement)&&(k=k.readOnly,c&&!k?this._EnableControl(e.target):!c&&k&&this._DisableControl(e.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var b=[],e=[],c=0;c<a.length;c++){for(var k=a[c],d=0;d<k.addedNodes.length;d++)b=b.concat(this._GetDocumentEditables(k.addedNodes[d]));for(d=0;d<k.removedNodes.length;d++)e=
e.concat(this._GetDocumentEditables(k.removedNodes[d]))}for(a=0;a<b.length;a++)this.isKMWInput(b[a])&&this._MutationAdditionObserved(b[a]);for(a=0;a<e.length;a++)this.isKMWInput(e[a])&&this._MutationRemovalObserved(e[a]);if(b.length||e.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var f=this;window.setTimeout(function(){f.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput()}.bind(this),
1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var b=this;a.addEventListener("load",function(){window.setTimeout(function(){b.attachToControl(a)},1)})}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=function(a){this.isAttached(a)||
console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0<=b.indexOf("kmw-disabled")&&(a.className=b.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk.ready&&(this.keyman.osk.shutdown(),this.keyman.osk._Unload());this.clearLastActiveElement()}.bind(this);this.init=function(a){var b,
e=this.keyman.osk;var c=this.keyman.util;var k=c.device,d=function(a){if(0==a.length)return a;"/"!=a.substr(a.length-1,1)&&(a+="/");return"http"==a.replace(/^(http)s?:.*/,"$1")||"file"==a.replace(/^(file):.*/,"$1")?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.rootPath+a.substr(1):this.keyman.srcPath+a}.bind(this);var f=this.keyman.options;if("object"==typeof a&&null!==a)for(b in f)a.hasOwnProperty(b)&&(f[b]=a[b]);""!=f.root&&(this.keyman.rootPath=d(f.root));""==f.resources&&
(f.resources=this.keyman.srcPath);f.resources=d(f.resources);f.keyboards=d(f.keyboards);f.fonts=d(f.fonts);""==f.attachType&&(f.attachType="auto");this.keyman.setDefaultDeviceOptions(f);if(this.keyman.initialized)return Promise.resolve();var g=this.keyman,h=this;if("complete"!==document.readyState)return new Promise(function(c){window.setTimeout(function(){h.init(a).then(function(){c()})},50)});g.modelManager.init();this.keyman._MasterDocument=window.document;"Android"==k.OS&&(f=k.getDPI(),k.formFactor=
screen.height<4*f||screen.width<4*f?"phone":"tablet");this.keyman.setInitialized(1);e.prepare();c.prepareWait();this.keyman.keyboardManager.registerDeferredStubs();this.initializeUI();this.keyman.keyboardManager.registerDeferredKeyboards();if(this.keyman.isEmbedded)return this.keyman.keyboardManager.setDefaultKeyboard()||console.error("No keyboard stubs exist - cannot initialize keyboard!"),Promise.resolve();this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont();k.touchable&&this.keyman.handleRotationEvents();
"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement);this.listInputs();k.touchable&&(e._Box.addEventListener("touchend",function(a){a.stopPropagation()},!1),c=document.createElement("DIV"),f=c.style,f.width="100%",f.height=screen.width/2+"px",document.body.appendChild(c),"Android"==k.OS&&0<navigator.userAgent.indexOf("Chrome")?(this.keyman.hideOskWhileScrolling=function(a){if("undefined"!=typeof e._Box&&"undefined"!=typeof e._Box.style){b=a.target.parentNode;if("undefined"!=
typeof b&&null!=b&&(0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-")||"undefined"!=typeof b.parentNode&&(b=b.parentNode,0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-"))))return;e.hideNow()}},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskWhileScrolling,!1)):(this.keyman.conditionallyHideOsk=function(){g.hideOnRelease&&!e.lgList&&e.hideNow();g.hideOnRelease=!1},this.keyman.hideOskIfOnBody=function(a){g.touchY=
a.touches[0].screenY;g.hideOnRelease=!0},this.keyman.cancelHideIfScrolling=function(a){a=a.touches[0].screenY;var c=g.touchY;if(5<a-c||5>c-a)g.hideOnRelease=!1},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskIfOnBody,!1),this.keyman.util.attachDOMEvent(document.body,"touchmove",this.keyman.cancelHideIfScrolling,!1),this.keyman.util.attachDOMEvent(document.body,"touchend",this.keyman.conditionallyHideOsk,!1)));this.keyman.keyboardManager.restoreCurrentKeyboard();MutationObserver?
(k=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&(c={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(k,c)),c={subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(k,c)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements.");
this.keyman.setInitialized(2);return Promise.resolve()}.bind(this);this.keyman=d;d.util.device.touchable&&(this.touchHandlers=new f.DOMTouchHandlers(d));this.nonTouchHandlers=new f.DOMEventHandlers(d)}g.prototype.shutdown=function(){this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver&&this.attachmentObserver.disconnect();for(var d=0,a=this.inputList;d<a.length;d++)this.disableInputElement(a[d])};g.prototype.getHandlers=function(d){return(d=d.base?d.base._kmwAttachment:
d._kmwAttachment)?d.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};g.prototype.enableTouchElement=function(d){if("iframe"==d.tagName.toLowerCase())return!1;if(this.isKMWDisabled(d))return this.setupNonKMWTouchElement(d),!1;d.kmwInput=!0;d.removeEventListener("touchstart",this.nonKMWTouchHandler);if(d.kmw_ip){if(-1!=this.inputList.indexOf(d.kmw_ip))return!1;this.inputList.push(d.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");
return!0}var a=f.dom.constructTouchAlias(d);this.isAttached(a)?a._kmwAttachment.interface=f.dom.wrapElement(a):this.setupElementAttachment(a);d._kmwAttachment=a._kmwAttachment;this.enableInputElement(a,!0);var b=this.touchHandlers;a.addEventListener("touchstart",b.setFocus);a.onmspointerdown=function(a){a.preventDefault();a.stopPropagation();return b.setFocus(a)};a.addEventListener("touchend",function(a){a.stopPropagation()});a.onmspointerup=function(a){a.stopPropagation()};a.addEventListener("touchmove",
b.dragInput,!1);a.onmspointermove=b.dragInput;a.onblur=b.setBlur;return!0};g.prototype.disableTouchElement=function(d){if("iframe"!=d.tagName.toLowerCase()){if(d.kmw_ip){var a=this.inputList.indexOf(d.kmw_ip);-1!=a&&this.inputList.splice(a,1);d.style.visibility="visible";d.disabled=!1;d.removeEventListener("resize",d.kmw_ip._kmwResizeHandler);this.disableInputElement(d.kmw_ip);d._kmwAttachment.interface=f.dom.wrapElement(d);d.parentNode&&d.parentNode.removeChild(d.kmw_ip);delete d.kmw_ip}this.setupNonKMWTouchElement(d)}};
g.prototype.setupNonKMWTouchElement=function(d){this.keyman.util.attachDOMEvent(d,"touchstart",this.nonKMWTouchHandler,!1);this.isAttached(d)&&(d._kmwAttachment.touchEnabled=!1)};g.prototype.enableInputElement=function(d,a){var b=a?d.base:d;this.isKMWDisabled(b)||(d instanceof d.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(d):(a||this.setupElementAttachment(d),b.className=b.className?b.className+" keymanweb-font":"keymanweb-font",this.inputList.push(d),this.keyman.util.attachDOMEvent(b,
"focus",this.getHandlers(d)._ControlFocus),this.keyman.util.attachDOMEvent(b,"blur",this.getHandlers(d)._ControlBlur),d.onkeypress=this.getHandlers(d)._KeyPress,d.onkeydown=this.getHandlers(d)._KeyDown,d.onkeyup=this.getHandlers(d)._KeyUp))};g.prototype.disableInputElement=function(d,a){if(d){var b=a?d.base:d;if(d.ownerDocument.defaultView&&d instanceof d.ownerDocument.defaultView.HTMLIFrameElement||d instanceof HTMLIFrameElement)this._DetachFromIframe(d);else{0<b.className.indexOf("keymanweb-font")&&
!a&&(b.className=b.className.replace("keymanweb-font","").trim());var e=this.inputList.indexOf(d);-1<e&&this.inputList.splice(e,1);a||(this.keyman.util.detachDOMEvent(b,"focus",this.getHandlers(d)._ControlFocus),this.keyman.util.detachDOMEvent(b,"blur",this.getHandlers(d)._ControlBlur));d.onkeypress=null;d.onkeydown=null;d.onkeyup=null}a&&(this.inputList.push(b),b.onkeypress=this.getHandlers(d)._KeyPress,b.onkeydown=this.getHandlers(d)._KeyDown,b.onkeyup=this.getHandlers(d)._KeyUp);a=this.getLastActiveElement();
if(a==d||a==d.kmw_ip)this.clearLastActiveElement(),this.keyman.osk._Hide(!1)}};g.prototype.isKMWDisabled=function(d){var a=d.className;return d.readOnly||a&&0<=a.indexOf("kmw-disabled")?!0:!1};g.prototype.attachToControl=function(d){var a=this.keyman.util.device.touchable;if(!this.isAttached(d)||d instanceof d.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(d)?this.isKMWDisabled(d)?a&&this.setupNonKMWTouchElement(d):a&&!this.keyman.isEmbedded?this.enableTouchElement(d):this.enableInputElement(d):
a&&this.setupNonKMWTouchElement(d)};g.prototype.detachFromControl=function(d){if(this.isAttached(d)||d instanceof d.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(d)&&(this.isKMWDisabled(d)||this._DisableControl(d)),this.clearElementAttachment(d)};g.prototype.isAttached=function(d){return d._kmwAttachment?!0:!1};g.prototype.isKMWInput=function(d){var a=this.keyman.util.device.touchable;if(d instanceof d.ownerDocument.defaultView.HTMLTextAreaElement)return!0;if(d instanceof d.ownerDocument.defaultView.HTMLInputElement){if("text"==
d.type||"search"==d.type)return!0}else if(d instanceof d.ownerDocument.defaultView.HTMLIFrameElement&&!a)try{if(d.contentWindow&&d.contentWindow.document)return!0}catch(b){console.warn("Error during attachment to / detachment from iframe: "),console.warn(b)}else if(d.isContentEditable&&!a)return!0;return!1};g.prototype.setupElementAttachment=function(d){if(!d._kmwAttachment){var a=f.dom.wrapElement(d);a||f.dom.Utils.instanceof(d,"HTMLIFrameElement")||console.warn("Could not create processing interface for newly-attached element!");
d._kmwAttachment=new f.AttachmentInfo(a,null,this.keyman.util.device.touchable)}};g.prototype.clearElementAttachment=function(d){d._kmwAttachment=null};g.prototype._AttachToIframe=function(d){var a=this.keyman.util;try{var b=d.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?(a.attachDOMEvent(b,"focus",this.getHandlers(d)._ControlFocus),a.attachDOMEvent(b,"blur",this.getHandlers(d)._ControlBlur),a.attachDOMEvent(b,"keydown",this.getHandlers(d)._KeyDown),a.attachDOMEvent(b,"keypress",this.getHandlers(d)._KeyPress),
a.attachDOMEvent(b,"keyup",this.getHandlers(d)._KeyUp),this.setupElementAttachment(d),b.body._kmwAttachment=d._kmwAttachment):this._SetupDocument(b))}catch(e){}};g.prototype._DetachFromIframe=function(d){var a=this.keyman.util;try{var b=d.contentWindow.document;b&&("on"==b.designMode.toLowerCase()?(a.detachDOMEvent(b,"focus",this.getHandlers(d)._ControlFocus),a.detachDOMEvent(b,"blur",this.getHandlers(d)._ControlBlur),a.detachDOMEvent(b,"keydown",this.getHandlers(d)._KeyDown),a.detachDOMEvent(b,"keypress",
this.getHandlers(d)._KeyPress),a.detachDOMEvent(b,"keyup",this.getHandlers(d)._KeyUp),b.body._kmwAttachment=null):this._ClearDocument(b))}catch(e){}};g.prototype._GetDocumentEditables=function(d){var a=this.keyman.util,b=[];if(d.ownerDocument&&d instanceof d.ownerDocument.defaultView.HTMLElement){var e=d.ownerDocument.defaultView;d instanceof e.HTMLInputElement||d instanceof e.HTMLTextAreaElement?b.push(d):d instanceof e.HTMLIFrameElement&&b.push(d)}d.getElementsByTagName&&(b=b.concat(a.arrayFromNodeList(d.getElementsByTagName("INPUT")),
a.arrayFromNodeList(d.getElementsByTagName("TEXTAREA")),a.arrayFromNodeList(d.getElementsByTagName("IFRAME"))));d.querySelectorAll&&(b=b.concat(a.arrayFromNodeList(d.querySelectorAll("[contenteditable]"))));d.ownerDocument&&d instanceof d.ownerDocument.defaultView.HTMLElement&&d.isContentEditable&&b.push(d);return b};g.prototype._SetupDocument=function(d){d=this._GetDocumentEditables(d);for(var a=0;a<d.length;a++)this.attachToControl(d[a])};g.prototype._ClearDocument=function(d){d=this._GetDocumentEditables(d);
for(var a=0;a<d.length;a++)this.detachFromControl(d[a])};g.prototype._SetTargDir=function(d){var a=this.keyman.keyboardManager.isRTL()?"rtl":"ltr";d&&(this.keyman.util.device.touchable?0==d.textContent.length&&(d.base.dir=d.dir=a,d.setTextCaret(1E4)):d instanceof d.ownerDocument.defaultView.HTMLInputElement||d instanceof d.ownerDocument.defaultView.HTMLTextAreaElement?0==d.value.length&&(d.dir=a):"string"==typeof d.textContent&&0==d.textContent.length&&(d.dir=a))};g.prototype._DisableControl=function(d){if(this.isAttached(d)||
d instanceof d.ownerDocument.defaultView.HTMLIFrameElement)this.keyman.util.device.touchable?(this.disableTouchElement(d),this.setupNonKMWTouchElement(d),window.setTimeout(function(){this.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),1)):this.listInputs(),this.disableInputElement(d)};g.prototype._EnableControl=function(d){if(this.isAttached(d))if(this.keyman.util.device.touchable){this.enableTouchElement(d);
var a=this.keyman;window.setTimeout(function(){a.domManager.listInputs();for(var b=0;b<this.sortedInputs.length;b++)this.sortedInputs[b].kmw_ip&&this.sortedInputs[b].kmw_ip.updateInput(this.sortedInputs[b].kmw_ip)}.bind(this),1)}else this.enableInputElement(d)};g.prototype.listInputs=function(){var d,a=[],b=document.getElementsByTagName("input"),e=document.getElementsByTagName("textarea");for(d=0;d<b.length;d++)switch(b[d].type){case "text":case "search":case "email":case "url":0>b[d].className.indexOf("kmw-disabled")&&
a.push({ip:b[d],x:f.dom.Utils.getAbsoluteX(b[d]),y:f.dom.Utils.getAbsoluteY(b[d])})}for(d=0;d<e.length;d++)0>e[d].className.indexOf("kmw-disabled")&&a.push({ip:e[d],x:f.dom.Utils.getAbsoluteX(e[d]),y:f.dom.Utils.getAbsoluteY(e[d])});a.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});b=[];for(d=0;d<a.length;d++)b.push(a[d].ip);this.sortedInputs=b};g.prototype.disableControl=function(d){this.isAttached(d)||console.warn("KeymanWeb is not attached to element "+d);var a=d.className;0>a.indexOf("kmw-disabled")&&
(d.className=a?a+" kmw-disabled":"kmw-disabled")};g.prototype.setKeyboardForControl=function(d,a,b){null!==a&&void 0!==a?0>a.indexOf("Keyboard_")&&""!=a&&(a="Keyboard_"+a):b=null;if(d instanceof d.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(d)){d._kmwAttachment.keyboard=a;d._kmwAttachment.languageCode=b;var e=this.getLastActiveElement();!e||e!=d&&e!=d.kmw_ip||(null!=a&&null!=b?this.keyman.keyboardManager.setActiveKeyboard(a,
b):this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode))}else console.error("KeymanWeb is not attached to element "+d)};g.prototype.getKeyboardForControl=function(d){if(this.isAttached(d))return d._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+d);return null};g.prototype.getLanguageForControl=function(d){if(this.isAttached(d))return d._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+
d);return null};g.prototype.focusLastActiveElement=function(){var d=this.getLastActiveElement();d&&(this.keyman.uiManager.justActivated=!0,d.ownerDocument&&d instanceof d.ownerDocument.defaultView.HTMLIFrameElement&&this.keyman.domManager._IsMozillaEditableIframe(d,0)?d.ownerDocument.defaultView.focus():d.focus&&d.focus())};g.prototype.getLastActiveElement=function(){return f.DOMEventHandlers.states.lastActiveElement};g.prototype.clearLastActiveElement=function(){f.DOMEventHandlers.states.lastActiveElement=
null};g.prototype.getActiveElement=function(){return f.DOMEventHandlers.states.activeElement};g.prototype._setActiveElement=function(d){f.DOMEventHandlers.states.activeElement=d};g.prototype.setActiveElement=function(d,a){"string"==typeof d&&(d=document.getElementById(d));if(this.keyman.isEmbedded)this.isAttached(d)||this.attachToControl(d);else if(!this.isAttached(d)){console.warn("Cannot set an element KMW is not attached to as the active element.");return}d=d.kmw_ip?d.kmw_ip:d;this.keyman.isEmbedded||
this.keyman.touchAliasing._BlurKeyboardSettings();f.DOMEventHandlers.states.activeElement!=d&&this.keyman.interface.resetContext();f.DOMEventHandlers.states.activeElement=f.DOMEventHandlers.states.lastActiveElement=d;this.keyman.isEmbedded||this.keyman.touchAliasing._FocusKeyboardSettings(!1);1<arguments.length&&a&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocusWithTouch({clientX:0,clientY:0,target:d}):this.focusLastActiveElement())};g.prototype.initActiveElement=function(d){null==
f.DOMEventHandlers.states.activeElement&&(f.DOMEventHandlers.states.activeElement=d)};g.prototype.moveToNext=function(d){var a,b=this.sortedInputs,e=this.getActiveElement(),c=this.keyman.util.device.touchable;if(0!=b.length){c&&(e=e.base);for(a=0;a<b.length&&b[a]!=e;a++);a=d?a-1:a+1;a=a>=b.length?a-b.length:a;a=0>a?a+b.length:a;c?(f.DOMEventHandlers.states.focusing=!0,d=b[a].kmw_ip,"undefined"==typeof d?b[a].focus():(this.keyman.domManager.setActiveElement(d),d.setTextCaret(1E4),d.scrollInput(),d.focus())):
b[a].focus()}};g.prototype.moveToElement=function(d){"string"==typeof d&&(d=document.getElementById(d));this.keyman.util.device.touchable&&d.kmw_ip?d.kmw_ip.focus():d.focus()};g.prototype._IsIEEditableIframe=function(d,a){var b,e=d&&(b=d.tagName)&&"body"==b.toLowerCase()&&(b=d.ownerDocument)&&b.parentWindow;return!a&&e||a&&(!e||d.isContentEditable)};g.prototype._IsMozillaEditableIframe=function(d,a){var b;d=d&&(b=d.defaultView)&&b.frameElement;return!a&&d||a&&(!d||"on"==b.document.designMode.toLowerCase())};
g.prototype.getBaseFont=function(){var d=this.keyman.util,a=document.getElementsByTagName("input"),b=document.getElementsByTagName("textarea"),e=0;if(0==a.length&&0==b.length)e=0;else if(0<a.length&&0==b.length)e=1;else if(0==a.length&&0<b.length)e=2;else{var c=a[0],k=b[0];c.offsetTop<k.offsetTop?e=1:c.offsetTop>k.offsetTop?e=2:c.offsetLeft<k.offsetLeft?e=1:c.offsetLeft>k.offsetLeft&&(e=2)}switch(e){case 0:case 1:d.getStyleValue(a[0],"font-family");case 2:var f=d.getStyleValue(b[0],"font-family")}if("undefined"==
typeof f||"monospace"==f)f="Arial,sans-serif";return f};g.prototype.initializeUI=function(){this.keyman.ui&&this.keyman.ui.initialize instanceof Function?(this.keyman.ui.initialize(),this.keyman.osk._Show()):window.setTimeout(this.initializeUI.bind(this),1E3)};return g}();f.DOMManager=g})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){var h=function(){function d(a,b,e,c){this.Pelem=a;this.Peventname=b.toLowerCase();this.Phandler=e;this.PuseCapture=c}d.prototype.equals=function(a){return this.Pelem==a.Pelem&&this.Peventname==a.Peventname&&this.Phandler==a.Phandler&&this.PuseCapture==a.PuseCapture};return d}(),l=function(){function d(a){this.linkedStylesheets=[];this.events={};this.currentEvents=[];this.domEvents=[];this.embeddedFonts=[];this._GetAbsolute=this.getAbsolute;this.selectStartHandler=function(){return!1};
this._CancelMouse=function(a){(a=f.keyman.singleton._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=a}d.prototype.getLanguageCodes=function(a){return-1==a.indexOf("-")?[a]:a.split("-")};d.prototype.initDevices=function(){this.device=new g.Device;this.physicalDevice=new g.Device;this.activeDevice=this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=
!1);this.physicalDevice=new g.Device;this.physicalDevice.touchable=!1;this.physicalDevice.browser=this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};d.prototype.arrayFromNodeList=function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e]);return b};d.prototype.addEventListener=function(a,b){this.removeEventListener(a,b);this.events[a].push(b);return!0};d.prototype.removeEventListener=function(a,b){"undefined"==typeof this.events[a]&&(this.events[a]=[]);
for(var e=0;e<this.events[a].length;e++)if(this.events[a][e]==b)return this.events[a].splice(e,1),!0;return!1};d.prototype.callEvent=function(a,b){if("undefined"==typeof this.events[a])return!0;if(-1!=this.currentEvents.indexOf(a))return!1;this.currentEvents.push(a);for(var e=0;e<this.events[a].length;e++){var c=this.events[a][e],k=!1;try{k=c(b)}catch(n){console.error(n),k=!1}if(!1===k)return this.currentEvents.pop(),!1}this.currentEvents.pop();return!0};d.prototype.attachDOMEvent=function(a,b,e,
c){this.detachDOMEvent(a,b,e,c);a.addEventListener(b,e,c?!0:!1);a=new h(a,b,e,c);this.domEvents.push(a)};d.prototype.detachDOMEvent=function(a,b,e,c){a.removeEventListener(b,e,c);a=new h(a,b,e,c);for(b=0;b<this.domEvents.length;b++)if(this.domEvents[b].equals(a)){this.domEvents.splice(b,1);break}};d.prototype.getOption=function(a,b){return a in this.keyman.options?this.keyman.options[a]:1<arguments.length?b:""};d.prototype.hasClass=function(a,b){b=" "+b+" ";return 0<=(" "+a.className+" ").replace(/[\n\t\r\f]/g,
" ").indexOf(b)};d.prototype.setOption=function(a,b){this.keyman.options[a]=b};d.prototype.getAbsoluteX=function(a){return g.dom.Utils.getAbsoluteX(a)};d.prototype.getAbsoluteY=function(a){return g.dom.Utils.getAbsoluteY(a)};d.prototype.getAbsolute=function(a){return{x:this.getAbsoluteX(a),y:this.getAbsoluteY(a)}};d.prototype.mouseDownPreventDefaultHandler=function(a){a&&a.preventDefault()};d.prototype._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?a.onselectstart=
this.selectStartHandler:(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};d.prototype.getIEVersion=function(){return g.Device._GetIEVersion()};d.prototype.getFontSizeStyle=function(a){var b="string"==typeof a?a:a.style.fontSize;return-1!=b.indexOf("em")?(a=parseFloat(b.substr(0,b.indexOf("em"))),{val:a,absolute:!1}):-1!=b.indexOf("px")?(a=parseFloat(b.substr(0,b.indexOf("px"))),{val:a,absolute:!0}):-1!=b.indexOf("pt")?
(a=parseFloat(b.substr(0,b.indexOf("pt"))),{val:4*a/3,absolute:!0}):-1!=b.indexOf("%")?(a=parseFloat(b.substr(0,b.indexOf("%"))),{val:a/100,absolute:!1}):isNaN(a=Number(b))?(console.error("Could not properly parse specified fontsize info: '"+b+"'."),null):{val:4*a/3,absolute:!0}};d.prototype.getStyleValue=function(a,b){try{if(a&&"undefined"!=typeof window.getComputedStyle)return window.getComputedStyle(a,"").getPropertyValue(b)}catch(e){}return""};d.prototype.getStyleInt=function(a,b,e){a=parseInt(this.getStyleValue(a,
b),10);return isNaN(a)?"number"==typeof e?e:0:a};d.prototype.isTouchDevice=function(){return this.device.touchable};d.prototype.portraitView=function(){return!this.landscapeView()};d.prototype.landscapeView=function(){if("undefined"!=typeof window.orientation)var a=window.orientation;else"undefined"!=typeof window.screen.orientation&&(a=window.screen.orientation.angle);return void 0!==a?1==Math.abs(a/90):!1};d.prototype.getViewportScale=function(){try{if(screen.width>document.documentElement.clientWidth)return 1;
var a=screen.width;this.landscapeView()?screen.width<screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/window.innerWidth)/100}catch(b){return 1}};d.prototype.barHeight=function(){var a=0;"phone"==this.device.formFactor&&(a=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return a};d.prototype._EncodeEntities=function(a){return a.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};
d.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};d.prototype.showShim=function(a,b,e){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};d.prototype.hideShim=function(a){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};
d.prototype.rgba=function(a,b,e,c,k){a="transparent";try{a="rgba("+b+","+e+","+c+","+k+")"}catch(n){a="rgb("+b+","+e+","+c+")"}return a};d.prototype.addStyleSheet=function(a){var b=document.createElement("style");b.type="text/css";b.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");0<a.length?a[0].appendChild(b):document.body.appendChild(b);this.linkedStylesheets.push(b);return b};d.prototype.removeStyleSheet=function(a){if(null==a||"object"!=typeof a||"STYLE"!=a.nodeName||
"undefined"==typeof a.parentNode||null==a.parentNode)return!1;a.parentNode.removeChild(a);return!0};d.prototype.linkStyleSheet=function(a){var b=document.getElementsByTagName("head");if(0<b.length){var e=document.createElement("link");e.type="text/css";e.rel="stylesheet";e.href=a;this.linkedStylesheets.push(e);b[0].appendChild(e)}};d.prototype.addFontFaceStyleSheet=function(a){if("undefined"!=typeof a&&("undefined"==typeof a.files&&(a.files=a.source),"undefined"!=typeof a.files)){var b,e="",c="",
k="",d="",f=[];for(b=0;b<this.embeddedFonts.length;b++)if(this.embeddedFonts[b]==a.family)return;"string"==typeof a.files?f[0]=a.files:f=a.files;for(b=0;b<f.length;b++)0<f[b].toLowerCase().indexOf(".ttf")&&(e=f[b]),0<f[b].toLowerCase().indexOf(".woff")&&(c=f[b]),0<f[b].toLowerCase().indexOf(".eot")&&(k=f[b]),0<f[b].toLowerCase().indexOf(".svg")&&(d=f[b]);""!=e&&0>e.indexOf("/")&&(e=this.keyman.options.fonts+e);""!=c&&0>c.indexOf("/")&&(c=this.keyman.options.fonts+c);""!=k&&0>k.indexOf("/")&&(k=this.keyman.options.fonts+
k);""!=d&&0>d.indexOf("/")&&(d=this.keyman.options.fonts+d);b="@font-face {\nfont-family:"+a.family+";\nfont-style:normal;\nfont-weight:normal;\n";if(9<=g.Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=e)e=this.unCached(e),b=b+"src:url('"+e+"') format('truetype');";else return;else{k=[];"Android"==this.device.OS?(""!=d&&k.push("url('"+d+"') format('svg')"),""!=c&&k.push("url('"+c+"') format('woff')"),""!=e&&k.push("url('"+e+"') format('truetype')")):(""!=c&&k.push("url('"+c+"') format('woff')"),
""!=e&&k.push("url('"+e+"') format('truetype')"),""!=d&&k.push("url('"+d+"') format('svg')"));if(0==k.length)return;b+="src:"+k.join(",")+";"}else if(""!=k)b=b+"src:url('"+k+"');";else return;this.addStyleSheet(b+"\n}\n");this.embeddedFonts.push(a.family)}};d.prototype.unCached=function(a){return a};d.prototype.loadCookie=function(a){var b={};if(0<arguments.length){var e=this.loadCookie(),c;for(c in e)if(c==a)for(var k=decodeURIComponent(e[c]).split(";"),d=0;d<k.length;d++){var f=k[d].split("=");
b[f[0]]=1<f.length?f[1]:""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(e=document.cookie.split(/;\s*/),d=0;d<e.length;d++)k=e[d].split("="),2==k.length&&(b[k[0]]=k[1]);return b};d.prototype.saveCookie=function(a,b){var e="",c;for(c in b)e=e+c+"="+b[c]+";";b=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=a+"="+encodeURIComponent(e)+"; path=/; expires="+b};d.prototype.toNumber=function(a,b){a=parseInt(a,10);return isNaN(a)?b:a};d.prototype.toFloat=function(a,
b){a=parseFloat(a);return isNaN(a)?b:a};d.prototype.nzString=function(a,b){var e="";1<arguments.length&&(e=b);return"undefined"==typeof a||null==a||0==a||""==a?e:""+a};d.prototype.deepCopy=function(a,b){b=b||{};for(var e in a)"object"===typeof a[e]?(b[e]=a[e].constructor===Array?[]:{},this.deepCopy(a[e],b[e])):b[e]=a[e];return b};d.prototype.eventTarget=function(a){return a?a.target?a.target:a.srcElement?a.srcElement:window.event?window.event.srcElement:null:null};d.prototype.eventType=function(a){return a&&
a.type?a.type:window.event?window.event.type:""};d.prototype.alert=function(a,b){var e=this.waiting,c=e.firstChild.childNodes;c[0].style.display="block";c[1].className="kmw-alert-text";c[1].innerHTML=a;c[2].style.display="none";e.style.display="block";e.dismiss=1<arguments.length?b:null};d.prototype.wait=function(a){};d.prototype.prepareWait=function(){var a=document.createElement("DIV"),b=document.createElement("DIV"),e=document.createElement("DIV"),c=document.createElement("DIV"),k=document.createElement("DIV");
a.className="kmw-wait-background";b.className="kmw-wait-box";a.dismiss=null;e.className="kmw-wait-text";c.className="kmw-wait-graphic";k.className="kmw-alert-close";b.onmousedown=b.onclick=function(c){"block"==k.style.display&&(a.style.display="none",a.dismiss&&a.dismiss())};b.addEventListener("touchstart",b.onclick,!1);a.onmousedown=a.onclick=function(a){a.preventDefault();a.stopPropagation()};a.addEventListener("touchstart",a.onclick,!1);b.appendChild(k);b.appendChild(e);b.appendChild(c);a.appendChild(b);
document.body.appendChild(a);this.waiting=a};d.prototype.shutdown=function(){this.events={};for(var a=0,b=this.domEvents;a<b.length;a++){var e=b[a];this.detachDOMEvent(e.Pelem,e.Peventname,e.Phandler,e.PuseCapture)}this.waiting.parentNode.removeChild(this.waiting);a=0;for(b=this.linkedStylesheets;a<b.length;a++)e=b[a],e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)};d.prototype.myPath=function(a){var b,e=document.getElementsByTagName("script");for(b=0;b<e.length;b++){var c=e[b];if(0<=
c.src.indexOf(a))return c.src.substr(0,c.src.lastIndexOf("/")+1)}return""};d.prototype.prependProtocol=function(a){return/^https?:/.test(a)?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.protocol+"/"+a:this.keyman.protocol+"//"+a};d.prototype.testString=function(a){var b=a.family;if("sample"in a&&"string"==typeof a.sample)return"BESbswy"+a.sample;var e="TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),
c="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");for(a=0;a<e.length;a++)if(b==e[a])return"BESbswy"+c[a];return"BESbswy"};d.prototype.checkFont=function(a){var b=a.family,e=document.createElement("DIV"),c=e.style,k=document.createElement("P"),d=document.createElement("P"),f=document.createElement("SPAN"),g=f.style,h=document.createElement("SPAN"),m=h.style;c.position="absolute";
c.top="10px";c.left="10px";c.visibility="hidden";document.body.appendChild(e);e.appendChild(k);e.appendChild(d);k.appendChild(f);d.appendChild(h);f.setAttribute("style","font-family:monospace !important");m.fontFamily=b+",monospace";g.fontSize=m.fontSize="24px";f.innerHTML=h.innerHTML=this.testString(a);f.offsetWidth!=h.offsetWidth&&(f.setAttribute("style","font-family:sans-serif !important"),m.fontFamily=b+",sans-serif",f.offsetWidth!=h.offsetWidth&&(f.setAttribute("style","font-family:serif !important"),
m.fontFamily=b+",serif"));a=f.offsetWidth!=h.offsetWidth;k.removeChild(f);d.removeChild(h);e.removeChild(k);e.removeChild(d);document.body.removeChild(e);return a};d.prototype.checkFontDescriptor=function(a){return"undefined"==typeof a||"string"!=typeof a.family?!0:this.checkFont(a)};return d}();g.Util=l})(f.keyman||(f.keyman={}))})(com||(com={}));var Util=com.keyman.Util;
(function(f){(function(g){(function(h){var l=function(){return function(){}}();h.KeyInformation=l;(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();var d=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:
this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};return a}(),a=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};return a}(),b=function(){function a(a){this.e=
a;this.c=a.style.backgroundColor}a.prototype.reset=function(){this.e.style.backgroundColor=this.c};return a}(),e=function(){function c(){this.cachedContext=new d;this.cachedContextEx=new a;this.TSS_LAYER=33;this.TSS_PLATFORM=31;this._AnyIndices=[];this._BeepObjects=[];this._BeepTimeout=0;this.GetLastActiveElement=this.getLastActiveElement;this.FocusLastActiveElement=this.focusLastActiveElement;this.HideHelp=this.hideHelp;this.ShowHelp=this.showHelp;this.ShowPinnedHelp=this.showPinnedHelp}c.prototype.saveFocus=
function(){f.keyman.singleton.isHeadless||(g.DOMEventHandlers.states._IgnoreNextSelChange=1)};c.prototype.notifyKeyboard=function(a,c,b){var e=f.keyman.singleton.keyboardManager.activeKeyboard;c=c instanceof h.OutputTarget?c:h.Processor.getOutputTarget(c);null!=e&&"function"==typeof e.KNS&&e.KNS(a,c,b)};c.prototype.insertText=function(a,c){var b=f.keyman.singleton;this.resetContextCache();var e=this.activeTargetOutput?this.activeTargetOutput:h.Processor.getOutputTarget();return null!=e?(b.isHeadless||
(b.uiManager.setActivatingUI(!0),g.DOMEventHandlers.states._IgnoreNextSelChange=100,b.domManager.focusLastActiveElement(),g.DOMEventHandlers.states._IgnoreNextSelChange=0),null!=a&&this.output(0,e,a),"undefined"!==typeof c&&null!==c&&this.deadkeyOutput(0,e,c),e.invalidateSelection(),!0):!1};c.prototype.registerKeyboard=function(a){f.keyman.singleton.keyboardManager._registerKeyboard(a)};c.prototype.registerStub=function(a){return f.keyman.singleton.keyboardManager._registerStub(a)};c.prototype.context=
function(a,c,b){var e=this.cachedContext.get(a,c);if(null!==e)return e;b=this.KC_(a,c,b);this.cachedContext.set(a,c,b);return b};c.prototype.KC_=function(a,c,b){b=b.getTextBeforeCaret();b._kmwLength()<a&&(b=Array(a-b._kmwLength()+1).join("\ufffe")+b);return b._kmwSubstr(-a)._kmwSubstr(0,c)};c.prototype.nul=function(a,c){return"\ufffe"===this.context(a+1,1,c)};c.prototype.contextMatch=function(a,c,b,e){if(this.context(a,e,c)===b)return!0;c.deadkeys().resetMatched();return!1};c.prototype._BuildExtendedContext=
function(a,c,b){var e=this.cachedContextEx.get(a,c);if(null!==e)return e;e=this.cachedContextEx.get(a,a);if(null===e){var d=b.deadkeys().toSortedArray(),k=0;for(e={valContext:[],deadContext:[]};e.valContext.length<a;){var f=b.getDeadkeyCaret()-k;0<d.length&&d[0].p>f?d.splice(0,1):0<d.length&&d[0].p==f?(e.deadContext[a-e.valContext.length-1]=d[0],e.valContext=[d[0].d].concat(e.valContext),d.splice(0,1)):(f=this.context(++k,1,b),e.valContext=[f].concat(e.valContext))}this.cachedContextEx.set(a,a,e)}b=
e;b.valContext=b.valContext.slice(0,c);for(e=0;e<b.valContext.length;e++)"\ufffe"==b[e]&&(b.valContext.splice(0,1),b.deadContext.splice(0,1));0==b.valContext.length&&(b.valContext=["\ufffe"],b.deadContext=[]);this.cachedContextEx.set(a,c,b);return b};c.prototype.fullContextMatch=function(a,c,b){var e=this._BuildExtendedContext(a,b.length,c);a=e.valContext;e=e.deadContext;for(var d=!1,f=0;f<b.length;f++)if("string"==typeof b[f]){if(b[f]!==a[f]){d=!0;break}}else{var k=b[f];switch(k.t){case "d":k.d!==
a[f]?d=!0:e[f].set();break;case "a":var n=this.any(f,"string"==typeof a[f]?a[f]:{t:"d",d:a[f]},k.a);k.n?k.n&&(n||"\ufffe"!==a[f])&&(d=!0):n?void 0!==e[f]&&e[f].set():d=!0;break;case "i":k=this._Index(k.i,k.o);void 0!==k&&("string"==typeof k?k:k.d)!==a[f]?d=!0:void 0!==e[f]&&e[f].set();break;case "c":a[k.c-1]!==a[f]?d=!0:void 0!==e[f]&&e[f].set();break;case "n":"\ufffe"!=a[f]&&(d=!0);break;default:throw Error("Unexpected object in fullContextMatch specification: "+k);}}d&&(c.deadkeys().resetMatched(),
this._AnyIndices=[]);return!d};c.prototype.isKeypress=function(a){var c=f.keyman.singleton;return c.keyboardManager.activeKeyboard.KM?!a.LisVirtualKey:c.keyMapManager._USKeyCodeToCharCode(a)?!0:!1};c.prototype.keyMatch=function(a,c,b){var e=!1,d=173==a.Lcode?189:a.Lcode,k=f.keyman.singleton.keyboardManager.getKeyboardModifierBitmask(),n=f.keyman.text.Codes,g=k&n.modifierBitmasks.ALL;k&=n.stateBitmasks.ALL;255<a.vkCode&&(d=a.vkCode);if(a.LisVirtualKey||255<d){if(16384==(c&16384)||255<d)e=(e=b==d&&
(c&g)==a.Lmodifiers)&&this.stateMatch(a,c&k)}else 0==(c&16384)&&(e=d==b);e||this.activeTargetOutput.deadkeys().resetMatched();return e};c.prototype.stateMatch=function(a,c){return(c&a.Lstates)==c};c.prototype.keyInformation=function(a){var c=new l;c.vk=a.LisVirtualKey;c.code=a.Lcode;c.modifiers=a.Lmodifiers;return c};c.prototype.deadkeyMatch=function(a,c,b){return c.hasDeadkeyMatch(a,b)};c.prototype.beepReset=function(){this.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();
this._BeepObjects=[]};c.prototype.beep=function(a){this.resetContextCache();if(!(a instanceof h.Mock)){var c=f.keyman.singleton;"beepKeyboard"in c&&c.beepKeyboard();var e=a.getElement();a instanceof g.dom.DesignIFrame&&(e=a.docRoot);if(e&&e.style&&"undefined"!=typeof e.style.backgroundColor){for(a=0;a<this._BeepObjects.length;a++)if(this._BeepObjects[a].e==e)return;this._BeepObjects=c._push(this._BeepObjects,new b(e));e.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),
50))}}};c.prototype._ExplodeStore=function(a){if("string"==typeof a){var c=f.keyman.singleton.keyboardManager.getActiveKeyboardTag();if(c.stores[a])return c.stores[a];for(var b=[],e=0;e<a._kmwLength();e++)b.push(a._kmwCharAt(e));return c.stores[a]=b}return a};c.prototype.any=function(a,c,b){if(""==c)return!1;b=this._ExplodeStore(b);for(var e=-1,d=0;d<b.length;d++)if("string"==typeof b[d]){if(b[d]==c){e=d;break}}else if(b[d].d===c.d){e=d;break}this._AnyIndices[a]=e;return 0<=e};c.prototype._Index=
function(a,c){a=this._ExplodeStore(a);if(this._AnyIndices[c-1]<a.length)return a[this._AnyIndices[c-1]];console.warn("Unmatched contextual index() statement detected in rule with index "+c+"!");return""};c.prototype.indexOutput=function(a,c,b,e){this.resetContextCache();c=this._Index(c,b);if(""!==c)if("string"==typeof c)this.output(a,e,c);else if(c.t)switch(c.t){case "b":this.beep(e);break;case "d":this.deadkeyOutput(a,e,c.d);break;default:throw Error("Unexpected object in fullContextMatch specification: "+
c);}else this.deadkeyOutput(a,e,c.d)};c.prototype.deleteContext=function(a,c){if(0<a){var b=this._BuildExtendedContext(a,a,c);for(var e=0,d=0;d<b.valContext.length;d++){var f=b.deadContext[d];f?(c.deadkeys().remove(f),a--):"\ufffe"==b.valContext[d]&&e++}b=b.valContext.length-e;a>b&&(a=b)}c.deadkeys().resetMatched();this.output(a,c,"")};c.prototype.output=function(a,c,b){this.resetContextCache();var e=f.keyman.singleton;if("oninserttext"in e&&!(c instanceof h.Mock))e.oninserttext(a,b);c.saveProperties();
c.clearSelection();c.deadkeys().deleteMatched();0<=a&&c.deleteCharsBeforeCaret(a);c.insertTextBeforeCaret(b);c.restoreProperties();"function"==typeof e.refreshElementContent&&e.refreshElementContent(c.getElement());(0<=a||b)&&c.getElement()==g.DOMEventHandlers.states.activeElement&&(g.DOMEventHandlers.states.changed=!0)};c.prototype.deadkeyOutput=function(a,c,b){this.resetContextCache();0<=a&&this.output(a,c,"");c.insertDeadkeyBeforeCaret(b)};c.prototype.ifStore=function(a,c,b){b=f.keyman.singleton;
var e=!0;if(a==this.TSS_LAYER)e=b.osk.vkbd.layerId===c;else if(a==this.TSS_PLATFORM){var d=c.split(" ");for(a=0;a<d.length;a++)switch(c=d[a].toLowerCase(),c){case "touch":case "hardware":b.util.activeDevice.touchable!=("touch"==c)&&(e=!1);break;case "macos":case "mac":c="macosx";case "macosx":case "windows":case "android":case "ios":case "linux":b.util.activeDevice.OS.toLowerCase()!=c&&(e=!1);break;case "tablet":case "phone":case "desktop":b.util.device.formFactor!=c&&(e=!1);break;case "web":"native"==
b.util.device.browser&&(e=!1);break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "edge":case "opera":b.util.device.browser!=c&&(e=!1);break;default:e=!1}}return e};c.prototype.setStore=function(a,c,b){var e=f.keyman.singleton;this.resetContextCache();return a==this.TSS_LAYER?b instanceof h.Mock?void 0:e.osk.vkbd.showLayer(c):!1};c.prototype.loadStore=function(a,c,b){var e=f.keyman.singleton;this.resetContextCache();a=e.util.loadCookie("KeymanWeb_"+a+"_Option_"+c);return"undefined"!=
typeof a[c]?decodeURIComponent(a[c]):b};c.prototype.saveStore=function(a,c){var b=f.keyman.singleton;this.resetContextCache();var e=b.keyboardManager.activeKeyboard;if(!e||"undefined"==typeof e.KI||""==e.KI)return!1;a="KeymanWeb_"+e.KI+"_Option_"+a;c=encodeURIComponent(c);b.util.saveCookie(a,c);return!0};c.prototype.resetContextCache=function(){this.cachedContext.reset();this.cachedContextEx.reset()};c.prototype.doInputEvent=function(a){var c;"function"==typeof window.InputEvent&&(c=new window.InputEvent("input",
{bubbles:!0,cancelable:!1}));a.base&&a.base.kmw_ip&&(a=a.base);a&&c&&a.dispatchEvent(c)};c.prototype.defaultBackspace=function(a){a||(a=this.activeTargetOutput?this.activeTargetOutput:h.Processor.getOutputTarget());this.output(1,a,"");a.getElement()&&this.doInputEvent(a.getElement())};c.prototype.processKeystroke=function(a,c,b){var e=f.keyman.singleton;if(!c)throw"No target specified for keyboard output!";c.invalidateSelection();c.deadkeys().resetMatched();this.resetContextCache();e.util.activeDevice=
a;this.activeTargetOutput=c;a=e.keyboardManager.activeKeyboard.gs(c,b);this.activeTargetOutput=null;return a};c.prototype.getLastActiveElement=function(){return h.Processor.getOutputTarget()};c.prototype.focusLastActiveElement=function(){var a=f.keyman.singleton;a.isHeadless||a.domManager.focusLastActiveElement()};c.prototype.hideHelp=function(){var a=f.keyman.singleton;a.isHeadless||a.osk._Hide(!0)};c.prototype.showHelp=function(a,c){var b=f.keyman.singleton;b.isHeadless||b.osk._Show(a,c)};c.prototype.showPinnedHelp=
function(){var a=f.keyman.singleton;a.isHeadless||(a.osk.userPositioned=!0,a.osk._Show(-1,-1))};c.prototype.resetContext=function(){var a=f.keyman.singleton;!a.isHeadless&&a.osk.vkbd&&(a.osk.vkbd.layerId="default");var c=this.activeTargetOutput?this.activeTargetOutput:h.Processor.getOutputTarget();c&&c.deadkeys().clear();this.resetContextCache();this.resetVKShift();a.modelManager&&a.modelManager.invalidateContext();a.isHeadless||a.osk._Show()};c.prototype.setNumericLayer=function(){var a=f.keyman.singleton,
c;if(!a.isHeadless){var b=a.osk.vkbd;for(c=0;c<b.layers.length;c++)"numeric"==b.layers[c].id&&(b.layerId="numeric",a.osk._Show())}};c.prototype.resetVKShift=function(){var a=f.keyman.singleton,c=f.keyman.singleton.textProcessor;a.isHeadless||a.uiManager.isActivating||!a.osk.vkbd||c._UpdateVKShift&&c._UpdateVKShift(null,15,0)};return c}();h.KeyboardInterface=e})(g.text||(g.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){var h=function(){function a(a,b){this.id=a;this.language=b}a.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};return a}(),l=function(){return function(a,c){this.family=a.family;this.files=a.source;this.path=c}}(),d=function(){return function(a,c){this.KI="Keyboard_"+a;this.KLC=c}}();g.KeyboardStub=d;var a=function(){return function(){this.stores={}}}();g.KeyboardTag=
a;var b=function(){function b(a){this.activeStub=null;this.keyboardStubs=[];this.deferredStubs=[];this.deferredKRS=[];this.deferredKR=[];this.dfltStub=null;this.keyboards=[];this.languageList=null;this.languagesPending=[];this.linkedScripts=[];this._GetKeyboardDetail=function(a){var c={};c.Name=a.KN;c.InternalName=a.KI;c.LanguageName=a.KL;c.LanguageCode=a.KLC;c.RegionName=a.KR;c.RegionCode=a.KRC;c.CountryName=a.KC;c.CountryCode=a.KCC;c.KeyboardID=a.KD;c.Font=a.KFont;c.OskFont=a.KOskFont;return c};
this.keymanweb=a}b.prototype.getActiveKeyboardName=function(){return this.activeKeyboard?this.activeKeyboard.KI:""};b.prototype.getActiveKeyboardTag=function(){return this.activeKeyboard?this.activeKeyboard._kmw:null};b.prototype.getActiveLanguage=function(a){return null==this.activeStub?"":a?this.activeStub.KL:this.activeStub.KLC};b.prototype.getDetailedKeyboards=function(){var a=[],b;for(b=0;b<this.keyboardStubs.length;b++){var e=this.keyboardStubs[b];e=this._GetKeyboardDetail(e);a=this.keymanweb._push(a,
e)}return a};b.prototype.registerDeferredStubs=function(){this.addKeyboardArray(this.deferredStubs);for(var a=0;a<this.deferredKRS.length;a++)this._registerStub(this.deferredKRS[a])};b.prototype.registerDeferredKeyboards=function(){for(var a=0;a<this.deferredKR.length;a++)this._registerKeyboard(this.deferredKR[a])};b.prototype.addStub=function(a){if("string"!=typeof a.id)return!1;"undefined"!=typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),
a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var c=a.languages,b=[];"undefined"==typeof c.length?b[0]=c:b=c;var e={keyboardBaseUri:this.keymanweb.options.keyboards,fontBaseUri:this.keymanweb.options.fonts};for(c=0;c<b.length;c++)this.mergeStub(a,b[c],e);return!0};b.prototype.mergeStub=function(a,e,f){var c=this.findStub(a.id,e.id),k=!1;null==c&&(c=new d(a.id,e.id),
this.keyboardStubs.push(c),k=!0);var g=e.region,n=0;if("number"==typeof g)n=1>g||9<g?0:g-1;else if("string"==typeof g)for(var h=2==g.length?b.regionCodes:b.regions,r=0;r<h.length;r++)if(g.toLowerCase()==h[r].toLowerCase()){n=r;break}c.KL="undefined"===typeof c.KL?e.name:c.KL;c.KR="undefined"===typeof c.KR?b.regions[n]:c.KR;c.KRC="undefined"===typeof c.KRC?b.regionCodes[n]:c.KRC;c.KN="undefined"===typeof c.KN?a.name:c.KN;"undefined"==typeof c.KF&&(g=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,c.KF=a.filename,
g.test(c.KF)||(c.KF=f.keyboardBaseUri+c.KF));a=f.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,g=/^https?\:/,g.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=a;"undefined"!=typeof e.font&&(c.KFont="undefined"===typeof c.KFont?new l(e.font,a):c.KFont);"undefined"!=typeof e.oskFont&&(c.KOskFont="undefined"===typeof c.KOskFont?new l(e.oskFont,a):c.KOskFont);
this.doKeyboardRegistered(c.KI,c.KL,c.KN,c.KLC,c.KP);!this.activeStub&&k&&1==this.keyboardStubs.length&&(this.doBeforeKeyboardChange(c.KI,c.KLC),this._SetActiveKeyboard(c.KI,c.KLC,!1),this.doKeyboardChange(c.KI,c.KLC))};b.prototype.findStub=function(a,b){var c;for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI=="Keyboard_"+a&&this.keyboardStubs[c].KLC==b)return this.keyboardStubs[c];return null};b.prototype.setDefaultKeyboard=function(){return 0<this.keyboardStubs.length?(this._SetActiveKeyboard(this.keyboardStubs[0].KI,
this.keyboardStubs[0].KLC),!0):!1};b.prototype.setActiveKeyboard=function(a,b){!this.keymanweb.isEmbedded&&a&&0!=a.indexOf("Keyboard_")&&(a="Keyboard_"+a);this.doBeforeKeyboardChange(a,b);var c=this._SetActiveKeyboard(a,b,!0);null!=this.keymanweb.domManager.getLastActiveElement()&&this.keymanweb.domManager.focusLastActiveElement();this.doKeyboardChange(a,b);return c};b.prototype._SetActiveKeyboard=function(a,b,e){var c,d,f=this.keymanweb.util,k=this.keymanweb.osk;if(2>arguments.length||!b)b="---";
for(c=0;c<this.keyboardStubs.length&&(a!=this.keyboardStubs[c].KI||b!=this.keyboardStubs[c].KLC&&"---"!=b);c++);f.device.touchable&&(""==a||null==a||c>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,b=this.keyboardStubs[0].KLC);2<arguments.length&&e&&this.saveCurrentKeyboard(a,b);if(this.activeStub&&this.activeKeyboard&&this.activeKeyboard.KI==a&&this.activeStub.KI==a&&this.activeStub.KLC==b&&!this.keymanweb.mustReloadKeyboard)return Promise.resolve();if(this.activeKeyboard&&
this.activeKeyboard.KI==a)for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==a&&this.keyboardStubs[d].KLC==b)return this.activeStub=this.keyboardStubs[d],k.vkbd.appendStyleSheet(),this.keymanweb.mustReloadKeyboard&&k._Load(),Promise.resolve();this.activeStub=this.activeKeyboard=null;if(""==a)return k._Hide(!1),this.keymanweb.isEmbedded||f.wait(!1),Promise.resolve();for(d=0;d<this.keyboards.length;d++)if(this.keyboards[d].KI==a){this.activeKeyboard=this.keyboards[d];this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement());
for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI==a&&(this.keyboardStubs[c].KLC==b||"---"==b)){this.activeStub=this.keyboardStubs[c];break}break}if(null==this.activeKeyboard){for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==a&&(this.keyboardStubs[d].KLC==b||"---"==b)){if(this.isCJK(this.keyboardStubs[d])||f.device.touchable)k._Enabled=!0;if(!this.keyboardStubs[d].asyncLoader){k.ready&&k._Hide(!1);var g=this.keyboardStubs[d];g.asyncLoader={};var n=g.KN,h=g.KL;
n=n.replace(/\s*keyboard\s*/i,"");g.asyncLoader.callback=function(a,c){var b=a||"Sorry, the "+n+" keyboard for "+h+" is not currently available.";this.keymanweb.isEmbedded||(f.wait(!1),f.alert(a||b,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(c){case "err":console.error(b);break;default:console.warn(b)}0<d&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);g.asyncLoader.timer=window.setTimeout(g.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||
f.wait("Installing keyboard<br/>"+n);var l=this;g.asyncLoader.promise=new Promise(function(a,c){window.setTimeout(function(){l.installKeyboard(a,c,g)},0)})}this.activeStub=this.keyboardStubs[d];return this.keyboardStubs[d].asyncLoader.promise}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement())}c=this.activeKeyboard;null!==c&&String.kmwEnableSupplementaryPlane(c&&(c.KS&&1==c.KS||"Hieroglyphic"==c.KN));k._Load();return Promise.resolve()};b.prototype.installKeyboard=
function(a,b,e){var c=this.keymanweb.util,d=this.keymanweb.osk,f=c._CreateElement("script");f.charset="UTF-8";f.type="text/javascript";this.keymanweb.isEmbedded&&(f.id=e.KI);var k=e.KF,g=e.KL,n=e.KN,h=this;f.addEventListener("error",function(){null!==e.asyncLoader.timer&&(window.clearTimeout(e.asyncLoader.timer),e.asyncLoader.timer=null);e.asyncLoader.callback("Cannot find the "+n+" keyboard for "+g+".","warn");e.asyncLoader=null;b()},!1);f.addEventListener("load",function(){null!==e.asyncLoader.timer&&
(window.clearTimeout(e.asyncLoader.timer),e.asyncLoader.timer=null);var f=h.getKeyboardByID(e.KI);f?(e==h.activeStub&&(h.doBeforeKeyboardChange(f.KI,e.KLC),h.activeKeyboard=f,null!=h.keymanweb.domManager.getLastActiveElement()&&(h.keymanweb.uiManager.justActivated=!0,h.keymanweb.domManager._SetTargDir(h.keymanweb.domManager.getLastActiveElement())),String.kmwEnableSupplementaryPlane(f&&(f.KS&&1==f.KS||"Hieroglyphic"==f.KN)),h.saveCurrentKeyboard(f.KI,e.KLC),d._Load()),h.keymanweb.isEmbedded||c.wait(!1),
e.asyncLoader=null,a()):(e.asyncLoader.callback("Error registering the "+n+" keyboard for "+g+".","error"),e.asyncLoader=null,b())},!1);f.src=this.keymanweb.getKeyboardPath(k);try{document.body.appendChild(f),this.linkedScripts.push(f)}catch(w){try{document.getElementsByTagName("head")[0].appendChild(f)}catch(z){b()}}};b.prototype.saveCurrentKeyboard=function(a,b){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b});this.keymanweb.isEmbedded||this.keymanweb.touchAliasing._BlurKeyboardSettings(a,
b)};b.prototype.restoreCurrentKeyboard=function(){var a=this.keyboardStubs,b=a.length;if(!(1>a.length)){var e=this.getSavedKeyboard();e.split(":");var d=e.split(":");2>d.length&&(d[1]="");for(e=0;e<b&&(a[e].KI!=d[0]||a[e].KLC!=d[1]&&""!=d[1]);e++);if(e<b||null==this.activeKeyboard)this._SetActiveKeyboard(d[0],d[1],!1),this.keymanweb.globalKeyboard=d[0],this.keymanweb.globalLanguageCode=d[1],this.doKeyboardChange(d[0],d[1])}};b.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");
if("string"!=typeof a.current)return"Keyboard_us:eng";var b,e=this.keyboardStubs;for(b=0;b<e.length;b++){var d=e[b].KI+":"+e[b].KLC;if(d==a.current)return d}for(b=0;b<e.length;b++)if(d=e[b].KI+":"+e[b].KLC,"Keyboard_us:eng"==d)return d;return 0<e.length?e[0].KI+":"+e[0].KLC:"Keyboard_us:eng"};b.prototype.isCJK=function(a){var c=this.activeKeyboard,b="";0<arguments.length&&(c=a);c&&("undefined"!=typeof c.KLC?b=c.KLC:"undefined"!=typeof c.LanguageCode&&(b=c.LanguageCode));return"cmn"==b||"jpn"==b||
"kor"==b};b.prototype.isRTL=function(a){a=a||this.activeKeyboard;return null!=a&&a.KRTL};b.prototype.isChiral=function(a){"string"==typeof a&&(a=this.getKeyboardByID(a));return!!(this.getKeyboardModifierBitmask(a)&g.text.Codes.modifierBitmasks.IS_CHIRAL)};b.prototype.getKeyboardModifierBitmask=function(a){var c=this.activeKeyboard;0<arguments.length&&"undefined"!=typeof a&&(c=a);return c?c.KMBM?c.KMBM:g.text.Codes.modifierBitmasks.NON_CHIRAL:0};b.prototype.getFont=function(a){return(a=a||this.activeKeyboard)&&
a.KV?a.KV.F:null};b.prototype.layoutIsDesktopBased=function(a){var c=f.keyman.singleton;return(a=a||this.activeKeyboard)&&a.KVKL?"desktop"==c.util.device.formFactor:!0};b.prototype.getKeyboardByID=function(a){var c;for(c=0;c<this.keyboards.length;c++)if(a==this.keyboards[c].KI)return this.keyboards[c];return null};b.prototype.isUniqueRequest=function(a,b){var c;if(null==this.findStub(b.id,b.language)){for(c=0;c<a.length;c++)if(a[c].id==b.id&&a[c].language==b.language)return!1;return!0}return!1};b.prototype.addKeyboardArray=
function(a){if(!this.keymanweb.initialized)for(var c=0;c<a.length;c++)this.deferredStubs.push(a[c]);else if(0!=a.length){var b,e="",d=[];for(c=0;c<a.length;c++){if("string"==typeof a[c]&&0<a[c].length){var f=a[c].split("@"),g=[""];"english"==f[0].toLowerCase()&&(f[0]="us");1<f.length&&(g=f[1].split(","));for(b=0;b<g.length;b++){var q=new h(f[0]);""!=g[b]&&(q.language=g[b]);2<f.length&&(q.version=f[2]);this.isUniqueRequest(d,q)&&d.push(q)}}if("object"==typeof a[c]&&null!=a[c])if("string"==typeof a[c].filename)this.addStub(a[c])||
alert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");else if(a[c].language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[c].languages=a[c].language),g=a[c].languages,"number"==typeof g.length)for(b=0;b<g.length;b++)q=new h(a[c].id,a[c].languages[b].id),this.isUniqueRequest(d,q)&&d.push(q);else q=new h(a[c].id,a[c].languages[b].id),this.isUniqueRequest(d,
q)&&d.push(q)}if(0!=d.length){a="&keyboardid=";for(c=0;c<d.length;c++)a=a+e+d[c].toString(),e=",";this.keymanCloudRequest(a,!1)}}};b.prototype.registerLanguagesForKeyboard=function(a,b,e){var c,d=0;var f="";if("undefined"!=typeof a)if("string"==typeof b.keyboardid&&(f=b.keyboardid.split(",")[e]),"number"==typeof a.length)if(1==a.length||"$"==f.substr(-1,1)||""==f)for(f=0;f<a.length;f++)this.registerLanguagesForKeyboard(a[f],b,e);else{for(f=0;f<a.length;f++){var k=a[f].id.toLowerCase();"us"==k&&(k=
"english");for(c=0;c<a[f].languages.length;c++)if(k==a[f].languages[c].name.toLowerCase()){d=f;break}}this.registerLanguagesForKeyboard(a[d],b,e)}else if(e=f.split("@")[1],"string"==typeof e&&(e=e.replace(/\$$/,"")),d=a.languages,"undefined"!=typeof d)if("number"==typeof d.length)for(f=0;f<d.length;f++)"undefined"!=typeof e&&d[f].id!=e||this.mergeStub(a,d[f],b);else this.mergeStub(a,d,b)};b.prototype.register=function(a){var b=a.options;a.timerid&&window.clearTimeout(a.timerid);if("string"==typeof a.error)b=
"","string"==typeof a.keyboardid&&(b=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),this.serverUnavailable(b+" keyboard not found.");else if("undefined"!=typeof b&&"undefined"!=typeof b.context)if("keyboard"==b.context){var c=a.keyboard;if("number"==typeof c.length)for(a=0;a<c.length;a++)this.registerLanguagesForKeyboard(c[a],b,a);else this.registerLanguagesForKeyboard(c,b,0)}else"language"==b.context&&(this.languageList=a.languages,this.languagesPending&&this.addLanguageKeyboards(this.languagesPending),
this.languagesPending=[])};b.prototype.addLanguageKeyboards=function(a){var b,c;if(null==this.languageList){var e=0==this.languagesPending.length;for(b=0;b<a.length;b++)this.languagesPending.push(a[b]);e&&this.keymanCloudRequest("",!0)}else{var d="";for(b=0;b<a.length;b++){var f=a[b].toLowerCase();(c="$"==f.substr(-1,1))&&(f=f.substr(0,f.length-1));for(e=0;e<this.languageList.length;e++)if(f==this.languageList[e].name.toLowerCase()){""!=d&&(d+=",");d=d+"@"+this.languageList[e].id;c&&(d+="$");break}}""==
d?this.keymanweb.util.alert("No keyboards are available for "+a[0]+". Does it have another language name?"):this.keymanCloudRequest("&keyboardid="+d,!1)}};b.prototype.keymanCloudRequest=function(a,b){var c="https://api.keyman.com/cloud/4.0/",e=this.keymanweb.util._CreateElement("script");c=c+(1<arguments.length&&b?"languages":"keyboards")+"?jsonp=keyman.register&languageidtype=bcp47&version="+this.keymanweb.version+"."+g.KeymanBase.__BUILD__;var d=this;var f="&timerid="+window.setTimeout(function(){d.serverUnavailable(a)},
1E4);e.charset="UTF-8";e.src=c+a+f;e.type="text/javascript";try{document.body.appendChild(e)}catch(m){document.getElementsByTagName("head")[0].appendChild(e)}};b.prototype.serverUnavailable=function(a){this.keymanweb.util.alert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};b.prototype.removeKeyboards=function(a){if(0==arguments.length)return!1;var b,c,e=!0,d=!1,f=!1;for(b=0;b<arguments.length;b++){for(c=this.keyboardStubs.length-1;0<=c;c--)if("Keyboard_"+arguments[b]==
this.keyboardStubs[c].KI){"Keyboard_"+arguments[b]==this.getActiveKeyboardName()&&(d=!0);f=!0;this.keyboardStubs.splice(c,1);break}0>c&&(e=!1)}d&&(0<this.keyboardStubs.length?this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);f&&this.doKeyboardUnregistered();return e};b.prototype._registerKeyboard=function(b){if(this.keymanweb.initialized)if(b._kmw)console.error("The keyboard _kmw property is a reserved field for engine use only; this keyboard is invalid.");
else{b._kmw=new a;var c;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(b);var e=this.activeStub,d=this.activeStub;if(!(e&&"KI"in e)||e.KI!=b.KI)for(c=0;c<this.keyboardStubs.length;c++){e=this.keyboardStubs[c];if(b.KI==e.KI)break;e=null}null==this.activeStub&&null!=e&&(this.activeStub=e);for(c=0;c<this.keyboards.length;c++)if(b.KI==this.keyboards[c].KI)return;this.keyboards=this.keymanweb._push(this.keyboards,b);this.doKeyboardLoaded(b.KI);this.activeStub=d}else this.deferredKR.push(b)};b.prototype._registerStub=
function(a){var b;if(!this.keymanweb.initialized)return this.deferredKRS.push(a),null;null==this.dfltStub&&(this.dfltStub=a);this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==typeof a.KL&&(a.KL="undefined");for(b=0;b<this.keyboardStubs.length;b++)if(this.keyboardStubs[b].KI==a.KI&&(""==a.KLC||this.keyboardStubs[b].KLC==a.KLC))return 1;this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a);this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,
a.KP);this.activeStub||this.dfltStub!=a||1!=this.keyboardStubs.length||this.setActiveKeyboard(a.KI,a.KLC);return null};b.prototype.doKeyboardRegistered=function(a,b,e,d,f){a={internalName:a,language:b,keyboardName:e,languageCode:d};f&&(a["package"]=f);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};b.prototype.doKeyboardUnregistered=function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};b.prototype.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",
b)};b.prototype.doBeforeKeyboardChange=function(a,b){var c={};c.internalName=a;c.languageCode=b;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",c)};b.prototype.doKeyboardChange=function(a,b,e){return this.keymanweb.util.callEvent("kmw.keyboardchange",{internalName:a,languageCode:b,indirect:2<arguments.length?e:!1})};b.prototype.shutdown=function(){for(var a=0,b=this.linkedScripts;a<b.length;a++){var e=b[a];e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}};b.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");
b.regionCodes="un af as eu sa na oc ca me".split(" ");return b}();g.KeyboardManager=b})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){var g=function(){return function(){}}(),l=function(){return function(){this.FF=new g;this.Safari=new g;this.Opera=new g;this.FF.k61=187;this.FF.k59=186}}(),d=function(){return function(){this.se=new g;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new g;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),a=function(){function a(){this.browserMap=new l;this.languageMap=
new d;this._usCodeInit()}a.prototype._usCodeInit=function(){var a=new g,b=new g;a.k192=96;a.k49=49;a.k50=50;a.k51=51;a.k52=52;a.k53=53;a.k54=54;a.k55=55;a.k56=56;a.k57=57;a.k48=48;a.k189=45;a.k187=61;a.k81=113;a.k87=119;a.k69=101;a.k82=114;a.k84=116;a.k89=121;a.k85=117;a.k73=105;a.k79=111;a.k80=112;a.k219=91;a.k221=93;a.k220=92;a.k65=97;a.k83=115;a.k68=100;a.k70=102;a.k71=103;a.k72=104;a.k74=106;a.k75=107;a.k76=108;a.k186=59;a.k222=39;a.k90=122;a.k88=120;a.k67=99;a.k86=118;a.k66=98;a.k78=110;a.k77=
109;a.k188=44;a.k190=46;a.k191=47;b.k192=126;b.k49=33;b.k50=64;b.k51=35;b.k52=36;b.k53=37;b.k54=94;b.k55=38;b.k56=42;b.k57=40;b.k48=41;b.k189=95;b.k187=43;b.k81=81;b.k87=87;b.k69=69;b.k82=82;b.k84=84;b.k89=89;b.k85=85;b.k73=73;b.k79=79;b.k80=80;b.k219=123;b.k221=125;b.k220=124;b.k65=65;b.k83=83;b.k68=68;b.k70=70;b.k71=71;b.k72=72;b.k74=74;b.k75=75;b.k76=76;b.k186=58;b.k222=34;b.k90=90;b.k88=88;b.k67=67;b.k86=86;b.k66=66;b.k78=78;b.k77=77;b.k188=60;b.k190=62;b.k191=63;this._usCharCodes=[a,b]};a.prototype._USKeyCodeToCharCode=
function(a){return this._usCharCodes[a.Lmodifiers&16?1:0]["k"+a.Lcode]};return a}();f.KeyMapManager=a})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){var g=function(){function d(a,b,e){this.code=a;this.shift=b;this.handler=e}d.prototype.matches=function(a,b){return this.code==a&&this.shift==b};return d}(),l=function(){function d(a){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var b=this.keyman.textProcessor._GetEventKeyCode(a);if(null==b)return!1;for(var c=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),d=0;d<this.hotkeys.length;d++)if(this.hotkeys[d].matches(b,c))return this.hotkeys[d].handler(),a.returnValue=
!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=a}d.prototype.addHotKey=function(a,b,e){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].code==a&&this.hotkeys[c].shift==b){this.hotkeys[c].handler=e;return}this.hotkeys.push(new g(a,b,e))};d.prototype.removeHotkey=function(a,b){for(var e=0;e<this.hotkeys.length;e++)if(this.hotkeys[e].matches(a,b)){this.hotkeys.splice(e,1);break}};return d}();f.HotkeyManager=l})(f.keyman||(f.keyman={}))})(com||
(com={}));
(function(f){(function(f){var g=function(){return function(d,a){this.activationPending=d;this.activated=a}}();f.UIState=g;var l=function(){function d(a){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",{})};this.keyman=a}d.prototype.getUIState=function(){return new g(this.isActivating,this.justActivated)};d.prototype.setActivatingUI=function(a){this.isActivating=a?!0:!1};d.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};
return d}();f.UIManager=l})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){var l=f.keyman.text.Codes,d=function(){function a(){}a.buildDefaultLayout=function(b,e,c,d){var k=f.keyman.singleton.util,u=d;"object"!=typeof a.dfltLayout[u]&&(u="desktop");u=k.deepCopy(a.dfltLayout[u]);var p,v=u.layer,m=b.KLS,q=b.K102,r,t=0!=(c&l.modifierBitmasks.IS_CHIRAL);(c=!("undefined"==typeof m||!m))||(m=b.KLS=a.processLegacyDefinitions(b.BK));b=Object.getOwnPropertyNames(m);var w=[];b.splice(b.indexOf("default"),1);b=["default"].concat(b);a.emulatesAltGr(m)&&
(-1==b.indexOf("leftctrl-leftalt")&&-1!=b.indexOf("rightalt")&&(b.push("leftctrl-leftalt"),m["leftctrl-leftalt"]=m.rightalt),-1==b.indexOf("leftctrl-leftalt-shift")&&-1!=b.indexOf("rightalt-shift")&&(b.push("leftctrl-leftalt-shift"),m["leftctrl-leftalt-shift"]=m["rightalt-shift"]));if("desktop"==d)for(w=a.generateLayerIds(t),p=0;p<w.length;p++)-1!=b.indexOf(w[p])&&w.splice(p--,1);var z=b.concat(w);if(c&&"desktop"!=d){c=null;w=v[0].row;for(p=0;p<w.length;p++){var C=w[p].key;for(var E=0;E<C.length;E++){var x=
C[E];"K_SHIFT"==x.id&&(c=x)}}if(c)for(r in c.sk=[],m)"default"!=r&&"shift"!=r&&(p=a.modifierSpecials[r],c.sk.push(new h.OSKKeySpec("K_"+p,p,null,"1",r)));else console.warn("Error in default layout - cannot find default Shift key!")}for(p=0;p<z.length;p++)0<p&&(v[p]=k.deepCopy(v[0])),v[p].id=z[p],v[p].nextlayer=z[p],a.formatDefaultLayer(v[p],t,d,!!q);for(p=0;p<v.length;p++){q=v[p];E=z=t=c=null;var H=m[q.id],I="shift"==q.id?1:0,L="default"==q.id||I?1:0;w=q.row;for(k=0;k<w.length;k++)for(C=w[k].key,
r=0;r<C.length;r++){x=C[r];var F=a.dfltCodes.indexOf(x.id);if(H||L)H&&0<=F&&F<H.length&&(x.text=H[F]),L&&e.precedes(g.utils.Version.NO_DEFAULT_KEYCAPS)&&"K_SPACE"!=x.id&&F+65*I<a.dfltText.length&&null!==x.text&&(x.text=x.text||a.dfltText[F+65*I]);null!==x.text&&(x.text=x.text||"");switch(x.id){case "K_SHIFT":c=x;break;case "K_CAPS":t=x;break;case "K_NUMLOCK":z=x;break;case "K_SCROLL":E=x}if(null!=x.sk){for(F=0;F<x.sk.length;F++)-1==b.indexOf(x.sk[F].nextlayer)&&x.sk.splice(F--,1);0==x.sk.length&&
(x.sk=null)}}q.shiftKey=c;q.capsKey=t;q.numKey=z;q.scrollKey=E;"desktop"!=d&&0<p&&null!=c&&(c.sp=a.buttonClasses["SHIFT-ON"],c.sk=null,c.text=a.modifierSpecials[v[p].id]?a.modifierSpecials[v[p].id]:"*Shift*")}return u};a.getLayerId=function(a){var b=l.modifierCodes,c="";if(0==a)return"default";a&b.LCTRL&&(c=(0<c.length?c+"-":"")+"leftctrl");a&b.RCTRL&&(c=(0<c.length?c+"-":"")+"rightctrl");a&b.LALT&&(c=(0<c.length?c+"-":"")+"leftalt");a&b.RALT&&(c=(0<c.length?c+"-":"")+"rightalt");a&b.SHIFT&&(c=(0<
c.length?c+"-":"")+"shift");a&b.CTRL&&(c=(0<c.length?c+"-":"")+"ctrl");a&b.ALT&&(c=(0<c.length?c+"-":"")+"alt");return c};a.emulatesAltGr=function(b){var e=window.keyman,c=l.modifierCodes;if(!e.keyboardManager.isChiral())return!1;if(!b){b=e.keyboardManager.activeKeyboard;if(null==b||null==b.KV)return!1;b=b.KV.KLS}var d=c.LCTRL|c.LALT,f=b[a.getLayerId(d)];d=b[a.getLayerId(c.SHIFT|d)];return null!=f&&f!=b[a.getLayerId(c.RALT)]||null!=d&&d!=b[a.getLayerId(c.RALT|c.SHIFT)]?!1:(e.keyboardManager.getKeyboardModifierBitmask(),
!0)};a.generateLayerIds=function(b){if(b){b=32;var e=1}else b=8,e=16;for(var c=[],d=0;d<b;d++)c.push(a.getLayerId(d*e));return c};a.formatDefaultLayer=function(b,e,c,d){for(var f=b.id,k=a.buttonClasses,g=0;g<b.row.length;g++)for(var h=b.row[g].key,m=0;m<h.length;m++){var q=h[m];switch(q.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=f.indexOf("shift")&&(q.sp=k["SHIFT-ON"]);"desktop"!=c&&"default"!=f&&(q.nextlayer="default");break;case "K_LCTRL":case "K_LCONTROL":if(e){-1!=f.indexOf("leftctrl")&&
(q.sp=k["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(e){-1!=f.indexOf("rightctrl")&&(q.sp=k["SHIFT-ON"]);break}case "K_CONTROL":-1==f.indexOf("ctrl")||e&&(-1==f.indexOf("leftctrl")||-1==f.indexOf("rightctrl"))||(q.sp=k["SHIFT-ON"]);break;case "K_LALT":if(e){-1!=f.indexOf("leftalt")&&(q.sp=k["SHIFT-ON"]);break}case "K_RALT":if(e){-1!=f.indexOf("rightalt")&&(q.sp=k["SHIFT-ON"]);break}case "K_ALT":-1==f.indexOf("alt")||e&&(-1==f.indexOf("leftalt")||-1==f.indexOf("rightalt"))||(q.sp=k["SHIFT-ON"]);
break;case "K_oE2":"undefined"!=typeof d&&d||("desktop"==c?(h.splice(m--,1),h[0].width="200"):h[m].sp=k.HIDDEN)}}};a.processLegacyDefinitions=function(b){for(var e=a.generateLayerIds(!1),c={},d=0;d<e.length;d++){for(var f=e[d],g=[],h=!1,l=0;65>l;l++){var m=l+65*d;g.push(b[m]);m<b.length&&""!=b[m]&&l!=a.dfltCodes.indexOf("K_SPACE")&&(h=!0)}h&&(c[f]=g)}"undefined"!=typeof c["default"]&&c["default"]||(c["default"]=[""]);"undefined"!=typeof c.shift&&c.shift||(c.shift=[""]);return c};a.dfltCodes="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
a.dfltText="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ ";a.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};a.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",alt:"*Alt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*",ctrl:"*Ctrl*","ctrl-alt":"*AltGr*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*","leftctrl-leftalt-shift":"*LAltCtrlShift*",
"rightctrl-rightalt-shift":"*RAltCtrlShift*",shift:"*Shift*","shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};a._BaseLayout="us";a._BaseLayoutEuro={se:"\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ",uk:"`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ "};a.dfltLayout={desktop:{font:"Tahoma,Helvetica",
layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",
sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",
width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},
{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"200"}]}]}]},phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},
{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",
text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},
{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"200",sp:"1"}]}]}]}};return a}();h.Layouts=d})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){var l=function(){function d(a){this.keyman=a;this.scrolling=!1;this.shim=this.constructShim()}d.prototype.constructShim=function(){var a=this,b=this.keyman.util._CreateElement("div"),e=this.keyman.osk;b.id="kmw-language-menu-background";b.addEventListener("touchstart",function(b){b.preventDefault();a.hide();if(2<b.touches.length){var c=b.touches[1].pageX;b=b.touches[1].pageY;var d=e.vkbd.spaceBar;c>d.offsetLeft&&c<d.offsetLeft+d.offsetWidth&&b>d.offsetTop&&b<
d.offsetTop+d.offsetHeight&&e.showBuild()}},!1);return b};d.prototype.show=function(){var a=this.keyman.keyboardManager.keyboardStubs,b=this.keyman.util;if(!(1>a.length)){var e=this.lgList=b._CreateElement("div");this.lgList.id="kmw-language-menu";var c=this;document.body.appendChild(this.shim);var d=b._CreateElement("div"),f=d.style,g=b._CreateElement("div");d.id="kmw-menu-scroll-container";g.id="kmw-menu-scroller";"WebkitOverflowScrolling"in f&&(f.WebkitOverflowScrolling="touch");d.appendChild(g);
e.appendChild(d);var h;f=b._CreateElement("div");f.id="kmw-menu-index";for(h=1;26>=h;h++){var l=b._CreateElement("p");l.innerHTML=String.fromCharCode(h+64);f.appendChild(l)}f.addEventListener("touchstart",function(a){c.scrollToLanguage(a,d,g)},!1);f.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},!1);e.appendChild(f);e.addEventListener("scroll",function(a){c.scrolling=!0},!1);d.addEventListener("scroll",function(a){1>d.scrollTop&&(d.scrollTop=1);d.scrollTop>d.scrollHeight-
d.offsetHeight-1&&(d.scrollTop=d.scrollHeight-d.offsetHeight-1)},!1);this.activeLgNo=this.addLanguages(g,a);this.lgList.style.visibility="hidden";document.body.appendChild(this.lgList);"Android"==b.device.OS&&"devicePixelRatio"in window&&(this.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==b.device.OS&&"tablet"==b.device.formFactor&&"devicePixelRatio"in window&&(h=parseInt(b.getStyleValue(e,"width"),10),a=e.style,isNaN(h)||(a.width=a.maxWidth=2*h/window.devicePixelRatio+"px"),h=
parseInt(b.getStyleValue(d,"width"),10),a=d.style,isNaN(h)||(a.width=a.maxWidth=2*h/window.devicePixelRatio+"px"),h=parseInt(b.getStyleValue(g,"width"),10),a=g.style,isNaN(h)||(a.width=a.maxWidth=2*h/window.devicePixelRatio+"px"));this.adjust(0);b=Math.floor(e.offsetHeight/26);a=Math.round(100*b/(f.childNodes[1].offsetTop-f.childNodes[0].offsetTop))/100;l=.6<a?1:2;1.25<a&&(a=1.25);for(h=0;26>h;h++){var m=f.childNodes[h].style;2==l&&1==h%2?m.display="none":(m.fontSize=a*l+"em",m.lineHeight=b*l+"px")}h=
d.offsetWidth;d.scrollHeight>d.offsetHeight+3?h+=f.offsetWidth:f.style.display="none";e.style.width=h+"px";this.lgList.style.visibility="";e=g.firstChild.offsetHeight*this.activeLgNo+1;d.scrollTop=e;d.scrollTop<e&&(d.scrollTop=d.scrollHeight-d.offsetHeight);d.scrollTop>d.scrollHeight-d.offsetHeight-1&&(d.scrollTop=d.scrollHeight-d.offsetHeight-1)}};d.prototype.adjust=function(a){var b=this.keyman.osk,e=this.keyman.util,c=e.device,d=this.lgList,f=d.firstChild,h=f.firstChild,l=d.style;d=d.childNodes[1];
var v=window.innerHeight-b.vkbd.lgKey.offsetHeight-16;a=(h.childNodes.length+a-1)*h.firstChild.firstChild.offsetHeight;"iOS"==c.OS&&("phone"==c.formFactor?(c=e.landscapeView()?36:0,v=(window.innerHeight-c-16)*e.getViewportScale()):"tablet"==c.formFactor&&(c=e.landscapeView()?16:0,v-=c));l.left=g.dom.Utils.getAbsoluteX(b.vkbd.lgKey)+"px";a>v&&(a=v);l.height=a+"px";l.top=g.dom.Utils.getAbsoluteY(b._Box)+b._Box.offsetHeight-a+window.pageYOffset-6+"px";l.bottom="auto";d.style.height=f.style.height=l.height};
d.prototype.scrollToLanguage=function(a,b,e){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();var c=a.touches[0].target;if("P"==c.nodeName){var d;a=0;c=c.innerHTML.charCodeAt(0);var f=e.childNodes;try{for(d=0;d<f.length-1;d++){var g=f[d].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(g>=c)break}}catch(p){}try{a=e.firstChild.offsetHeight*d+1,b.scrollTop=a}catch(p){a=0}try{b.scrollTop<a&&(b.scrollTop=b.scrollHeight-b.offsetHeight),b.scrollTop>b.scrollHeight-b.offsetHeight-1&&
(b.scrollTop=b.scrollHeight-b.offsetHeight-1)}catch(p){}}};d.prototype.addLanguages=function(a,b){var e=b.length,c=this.keyman.util,d=c.device,f,g,h=[];for(g=0;g<e;g++){var l=b[g].KL;-1==h.indexOf(l)&&h.push(l)}h.sort();var m=Math.round(100/c.getViewportScale())/100,q,r,t,w,z=-1;l=function(){q=c._CreateElement("div");q.className="kbd-list-closed";r=c._CreateElement("p");r.kList=[];for(g=0;g<e;g++)b[g].KL==h[f]&&r.kList.push(b[g]);"iOS"==d.OS&&(r.style.fontSize=m+"em");q.appendChild(r);a.appendChild(q);
h[f]==C.keyman.keyboardManager.activeStub.KL&&(z=f);var k=C;if(1<r.kList.length)for(r.className="kbd-list",r.innerHTML=h[f]+"...",r.scrolled=!1,r.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";k.adjust("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},r.addEventListener("touchstart",function(a){a.stopPropagation()},!1),r.addEventListener("touchmove",
function(a){a.target.scrolled=!0;a.stopPropagation()},!1),t=0;t<r.kList.length;t++)w=c._CreateElement("p"),w.className="kbd-list-entry","iOS"==d.OS&&(w.style.fontSize=m+"em"),C.addKeyboard(r.kList[t],w,!1),q.appendChild(w);else r.innerHTML=h[f],r.className="kbd-single-entry",C.addKeyboard(r.kList[0],r,!0);f==z&&(r.className+=" current")};var C=this;for(f=0;f<h.length;f++)l();l=c._CreateElement("div");l.id="kmw-menu-footer";var E=function(a){a.preventDefault();a.stopPropagation()};l.addEventListener("touchstart",
E,!1);l.addEventListener("touchmove",E,!1);l.addEventListener("touchend",E,!1);a.appendChild(l);return z};d.prototype.addKeyboard=function(a,b,e){b.kn=a.KI;b.kc=a.KLC;b.innerHTML=e?a.KL:a.KN.replace(" Keyboard","");var c=this;a=function(a){a.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");c.scrolling=!1;c.y0=a.touches[0].pageY;return!0};e=function(a){a.stopImmediatePropagation();var b=c.lgList.childNodes[0],e=b.scrollHeight-b.offsetHeight;if("undefined"!=typeof a.pageY)var d=
a.pageY;else if("undefined"!=typeof a.touches)d=a.touches[0].pageY;else return;var f=d-c.y0;if(0>f)b.scrollTop>=e-1&&(a.preventDefault(),c.y0=d);else if(0<f)2>b.scrollTop&&(a.preventDefault(),c.y0=d);else return;if(-5>f||5<f)c.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),c.y0=d;return!0};var d=function(a){a.preventDefault();"undefined"!=typeof a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation();c.scrolling?this.className=this.className.replace(/\s*selected/,
""):(f.keyman.DOMEventHandlers.states.setFocusTimer(),c.lgList.style.display="none",c.keyman.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),c.keyman.keyboardManager.doKeyboardChange(this.kn,this.kc),c.keyman.domManager.focusLastActiveElement(),c.hide(),c.keyman.osk._Show());return!0};b.onmspointerdown=a;b.addEventListener("touchstart",a,!1);b.onmspointermove=e;b.addEventListener("touchmove",e,!1);b.onmspointerout=d;b.addEventListener("touchend",d,!1)};d.prototype.hide=function(){var a=this.keyman.osk,
b=this;this.lgList&&(a.vkbd.highlightKey(a.vkbd.lgKey,!1),this.lgList.style.visibility="hidden",window.setTimeout(function(){b.shim.parentElement&&(document.body.removeChild(b.shim),document.body.removeChild(b.lgList))},500))};return d}();h.LanguageMenu=l})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(f){var g=function(){function a(){}a.polyfill=function(b,e){var c=new a,d;for(d in c)b.hasOwnProperty(d)||(b[d]=c[d]);b.displayLayer=e;b.layer=b.layer||e};a.DEFAULT_PAD=15;a.DEFAULT_RIGHT_MARGIN=15;a.DEFAULT_KEY_WIDTH=100;a.DEFAULT_KEY={text:"",width:a.DEFAULT_KEY_WIDTH.toString(),sp:"0",pad:a.DEFAULT_PAD.toString()};return a}();f.ActiveKey=g;var d=function(){function a(){}a.polyfill=function(b,e,d,f){for(var c=b.key,k=0;k<c.length;k++){var h=c[k];for(n in g.DEFAULT_KEY)"string"!=
typeof h[n]&&(h[n]=g.DEFAULT_KEY[n]);switch(h.sp){case "1":a.SPECIAL_LABEL.test(h.text)||""==h.text||(h.sp="3");break;case "2":a.SPECIAL_LABEL.test(h.text)||""==h.text||(h.sp="4")}g.polyfill(h,e)}var q=0;for(k=0;k<c.length-1;k++){e=parseInt(c[k].width,10)/d;c[k].widthpc=e;var n=parseInt(c[k].pad,10)/d;c[k].padpc=n;c[k].proportionalX=q+n+e/2;c[k].proportionalWidth=e;q+=n+e}var l=g.DEFAULT_RIGHT_MARGIN/d;q+=l;1==c.length&&0>parseInt(c[0].pad,10)?(e=parseInt(c[0].width,10)/d,c[0].widthpc=e,q+=e,c[0].padpc=
1-q,c[0].proportionalX=q-l-e/2,c[0].proportionalWidth=e):0<c.length&&(k=c.length-1,n=parseInt(c[k].pad,10)/d,c[k].padpc=n,c[k].widthpc=e=1-(q+n),c[k].proportionalX=1-l-e/2,c[k].proportionalWidth=e);d=new a;for(h in d)b.hasOwnProperty(h)||(b[h]=d[h]);b.proportionalY=f};a.prototype.populateKeyMap=function(a){this.key.forEach(function(b){b.id&&(a[b.id]=b)})};a.SPECIAL_LABEL=/\*\w+\*/;return a}(),a=function(){function a(){}a.polyfill=function(b,e){b.aligned=!1;for(var c=b.row,f=0,k=0;k<b.row.length;k++){for(var h=
0,m=c[k].key,q=0;q<m.length;q++){var l=m[q];if(null==l)--m.length;else{var t="string"==typeof l.width&&""!=l.width?parseInt(l.width,10):g.DEFAULT_KEY_WIDTH;if(isNaN(t)||0==t)t=g.DEFAULT_KEY_WIDTH;l.width=t.toString();var w="string"==typeof l.pad&&""!=l.pad?parseInt(l.pad,10):g.DEFAULT_PAD;if(isNaN(w)||0==w)w=g.DEFAULT_PAD;l.pad=w.toString();h+=t+w}}h>f&&(f=h)}f="desktop"==e?f+5:f+g.DEFAULT_RIGHT_MARGIN;e=b.row.length;for(k=0;k<e;k++)d.polyfill(b.row[k],b.id,f,(k+.5)/e);k=new a;for(l in k)b.hasOwnProperty(l)||
(b[l]=k[l]);b.totalWidth=f;b.defaultKeyProportionalWidth=parseInt(g.DEFAULT_KEY.width,10)/f;b.rowProportionalHeight=1/e;b.keyMap=b.constructKeyMap()};a.prototype.constructKeyMap=function(){var a={};this.row.forEach(function(b){b.populateKeyMap(a)});return a};a.prototype.getTouchProbabilities=function(a,b){a=this.simpleTouchDistribution(a,b);b=[];for(var c in a)b.push({keyId:c,p:a[c]});return b.sort(function(a,b){return b.p-a.p})};a.prototype.simpleTouchDistribution=function(a,b){a=this.keyTouchDistances(a,
b);b={};var c=0,e;for(e in a)c+=b[e]=1/(a[e]+1E-6);for(e in b)b[e]/=c;return b};a.prototype.keyTouchDistances=function(a,b){var c=this,e={};this.row.forEach(function(d){d.key.forEach(function(f){if(f.id){var g=Math.abs(a.x-f.proportionalX),k=Math.abs(a.y-d.proportionalY);if(g>.5*f.proportionalWidth){var h=g-.5*f.proportionalWidth;g=.5}else h=0,g/=f.proportionalWidth;if(k>.5*c.rowProportionalHeight){var l=k-.5*c.rowProportionalHeight;k=.5}else l=0,k/=c.rowProportionalHeight;h*=b;h+=g*c.rowProportionalHeight;
l+=k*c.rowProportionalHeight;e[f.id]=h*h+l*l}})});return e};a.prototype.getKey=function(a){0==a.indexOf(this.id+"-")&&(a=a.replace(this.id+"-",""));return this.keyMap[a]};return a}();f.ActiveLayer=a;var b=function(){function b(){}b.prototype.getLayer=function(a){return this.layerMap[a]};b.polyfill=function(c,e){if(null==c)throw Error("Cannot build an ActiveLayout for a null specification.");var d,f={};var g=c.layer;for(d=0;d<g.length;d++){var k=g[d];var h=k.row;for(k=h.length;0<k&&!(0<h[k-1].key.length);k--);
k<h.length&&h.splice(k-h.length,h.length-k)}for(d=0;d<g.length;d++)a.polyfill(g[d],e),f[g[d].id]=g[d];e=new b;for(var l in e)c.hasOwnProperty(l)||(c[l]=e[l]);c.layerMap=f;return c};return b}();f.ActiveLayout=b})(f.osk||(f.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){function l(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);return a}function d(a){return a&&"key"in a&&a.key instanceof k}function a(a){return d(a)?a:null}var b=f.keyman.text.Codes,e=function(){return function(a,b){this.key=a;this.keyId=b}}();h.isKey=d;h.getKeyFrom=a;var c=function(){return function(a,b,c,e,d,f){this.id=a;this.text=b;this.width=c?c:"50";this.sp=e;this.nextlayer=d;this.pad=f}}();h.OSKKeySpec=c;var k=function(){function a(a,b){this.spec=a;
this.layer=b}a.getTextWidth=function(b,c,e){e.fontFamily||(e.fontFamily=getComputedStyle(document.body).fontFamily);e.fontSize&&""!=e.fontSize||(e.fontSize="1em");var d=e.fontFamily;b=b.getKeyEmFontSize();e=window.keyman.util.getFontSizeStyle(e.fontSize);e=e.absolute?e.val+"px":e.val*b+"px";b=(a.getTextWidth.canvas||(a.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");b.font=e+" "+d;return b.measureText(c).width};a.prototype.getKeyWidth=function(){var a=this.objectUnits();if("px"==
a)return this.spec.widthpc;if("%"==a)return a=f.keyman.singleton.osk.getWidthFromCookie(),Math.floor(a*this.spec.widthpc/100)};a.prototype.objectUnits=function(){return"desktop"==window.keyman.util.device.formFactor?"%":"px"};a.prototype.renameSpecialKey=function(a){return p.specialCharacters[a]?String.fromCharCode(57344+p.specialCharacters[a]):a};a.prototype.generateKeyText=function(b){var c=window.keyman.util,e=this.spec,d=c._CreateElement("span"),f=d.style;if(null==e.text||""==e.text){var g="\u00a0";
"string"==typeof e.id&&/^U_[0-9A-F]{4}$/i.test(e.id)&&(g=String.fromCharCode(parseInt(e.id.substr(2),16)))}else g=e.text;d.className="kmw-key-text";if("1"==e.sp||"2"==e.sp)g=this.renameSpecialKey("*Tab*"==e.text&&"shift"==this.layer?"*TabLeft*":e.text);f.fontSize=b.fontSize;"string"==typeof e.font&&""!=e.font&&(f.fontFamily=e.font);"string"==typeof e.fontsize&&""!=e.fontsize&&(f.fontSize=e.fontsize);var k=window.keyman.keyboardManager,h={fontSize:f.fontSize};h.fontFamily=f.fontFamily?f.fontFamily:
b.fontFamily;e=a.getTextWidth(b,g,h);0==e&&""!=g&&"\u00a0"!=g&&(g="\u25cc"+g,k.isRTL()&&(g="\u200f"+g),e=a.getTextWidth(b,g,h));b=c.getFontSizeStyle(f.fontSize);c=.9*this.getKeyWidth()/e;1>c&&(f.fontSize=b.absolute?c*b.val+"px":c*b.val+"em");d.innerHTML=g;return d};return a}();h.OSKKey=k;var n=function(a){function c(b,c){return a.call(this,b,c)||this}__extends(c,a);c.prototype.getId=function(a){return this.layer+"-"+this.spec.id};c.prototype.generateKeyCapLabel=function(){var a=b.keyCodes[this.spec.id];
switch(a){case 186:a=59;break;case 187:a=61;break;case 188:a=44;break;case 189:a=45;break;case 190:a=46;break;case 191:a=47;break;case 192:a=96;break;case 219:a=91;break;case 220:a=92;break;case 221:a=93;break;case 222:a=39;break;default:if(48>a||90<a)a=0}if(0<a){var c=window.keyman.util._CreateElement("div");c.className="kmw-key-label";c.innerHTML=String.fromCharCode(a);return c}return null};c.prototype.processSubkeys=function(a){var b,c=a.subKeys=this.spec.sk;for(b=0;b<c.length;b++)if("1"==c[b].sp||
"2"==c[b].sp)c[b].text=this.renameSpecialKey(c[b].text);b=window.keyman.util._CreateElement("div");b.className="kmw-key-popup-icon";a.appendChild(b)};c.prototype.construct=function(a,b,c,d){var f=window.keyman.util,g=this.spec,k="desktop"==f.device.formFactor,h=f._CreateElement("div");h.className="kmw-key-square";var m=h.style;m.width=this.objectGeometry(g.widthpc);var n=d,q=f._CreateElement("div");q=l(q,new e(this,g.id));a.setButtonClass(g,q,b);k?m.marginLeft=this.objectGeometry(g.padpc):(m.left=
this.objectGeometry(d+g.padpc),m.bottom=c.bottom,m.height=c.height,q.style.left=m.left,q.style.width=m.width);d=d+g.padpc+g.widthpc;(b.keyLabels||k)&&(b=this.generateKeyCapLabel())&&q.appendChild(b);q.id=this.getId(a);f.device.touchable||(q.onmouseover=q.onmousedown=a.mouseOverMouseDownHandler,q.onmouseup=q.onmouseout=a.mouseUpMouseOutHandler);q.appendChild(this.generateKeyText(a));"undefined"!=typeof g.sk&&null!=g.sk?this.processSubkeys(q):q.subKeys=null;h.appendChild(q);return{element:h,percent:d-
n}};c.prototype.objectGeometry=function(a){var b=this.objectUnits();return"%"==b?a+b:Math.round(100*a)/100+b};return c}(k);h.OSKBaseKey=n;var u=function(a){function b(b,c){return a.call(this,b,c)||this}__extends(b,a);b.prototype.getId=function(a){var b=this.spec;return"string"==typeof this.layer&&""!=this.layer?"popup-"+this.layer+"-"+b.id:"popup-"+a.layerId+"-"+b.id};b.prototype.construct=function(a,b,c){var d=this.spec,f=document.createElement("div"),g=a.getDefaultKeyObject(),k=f.style,h;for(h in g)"string"!=
typeof d[h]&&(d[h]=g[h]);f.className="kmw-key-square-ex";c&&(k.marginTop="5px");k.width="undefined"!=typeof d.width?parseInt(d.width,10)*b.offsetWidth/100+"px":b.offsetWidth+"px";k.height=b.offsetHeight+"px";b=document.createElement("div");b=l(b,new e(this,d.id));a.setButtonClass(d,b);b.id=this.getId(a);d=b.style;d.height=k.height;d.width=k.width;d.position="absolute";b.appendChild(this.generateKeyText(a));f.appendChild(b);return f};return b}(k);h.OSKSubKey=u;var p=function(){function b(a,b,c,e){this.layerId=
"default";this.popupPending=this.ddOSK=!1;this.popupDelay=500;this.touch=function(a){var b=f.keyman.singleton.textProcessor,c=a.changedTouches[0].target,e=this.keyTarget(c);this.touchX=a.changedTouches[0].pageX;this.currentTarget=e;this.cancelDelete();var d=document.getElementById("kmw-popup-keys");if(!(d&&"visible"==d.style.visibility||this.popupVisible)){this.touchCount=a.touches.length;if(e&&0<=e.className.indexOf("key-hidden")||0<=c.className.indexOf("kmw-key-row"))e=this.findNearestKey(a,c);
null!=e&&(c=e.keyId,this.highlightKey(e,!0),"K_LOPT"==c||"K_ROPT"==c?(window.setTimeout(function(){b.clickKey(e)}.bind(this),0),this.touchPending=this.keyPending=null):"K_BKSP"==c?(c=this.getTouchProbabilities(a.changedTouches[0]),b.clickKey(e,a.changedTouches[0],this.layerId,c),this.deleteKey=e,this.deleting=window.setTimeout(this.repeatDelete,500),this.touchPending=this.keyPending=null):(this.keyPending?(this.highlightKey(this.keyPending,!1),c=this.getTouchProbabilities(this.touchPending),b.clickKey(this.keyPending,
this.touchPending,this.layerId,c),this.clearPopup(),this.touchCount--):this.touchHold(e),this.keyPending=e,this.touchPending=a.changedTouches[0]))}}.bind(this);this.release=function(a){var b=f.keyman.singleton.textProcessor,c=document.getElementById("kmw-popup-keys"),e=this.currentTarget;this.cancelDelete();if(c&&"visible"==c.style.visibility||this.popupVisible){if(0<a.touches.length)return;if(null==e||0>e.id.indexOf("popup")&&e.id!=this.popupBaseKey.id)this.highlightKey(this.keyPending,!1),this.clearPopup(),
this.touchPending=this.keyPending=null}e&&e.id&&this.optionKey(e,e.id,!1);e=a.changedTouches[0].pageX;e=2>e&&5<this.touchX||e>window.innerWidth-2&&this.touchX<window.innerWidth-5;c=this.touchCount;0<this.touchCount&&this.touchCount--;this.keyPending?(this.highlightKey(this.keyPending,!1),0>this.keyPending.className.indexOf("hidden")&&0<c&&!e&&(e=this.getTouchProbabilities(a.changedTouches[0]),b.clickKey(this.keyPending,a.changedTouches[0],this.layerId,e)),this.clearPopup(),this.touchPending=this.keyPending=
null):(b=a.changedTouches[0],e=this.keyTarget(b.target),e||(b=document.elementFromPoint(b.clientX,b.clientY),e=this.findNearestKey(a,b)),this.highlightKey(e,!1))}.bind(this);this.moveOver=function(a){var b=f.keyman.singleton.util;a.preventDefault();a.cancelBubble=!0;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation();if(0==this.touchCount)this.cancelDelete();else{var c="object"==typeof a.touches?a.touches[0].clientX:
a.clientX,e="object"==typeof a.touches?a.touches[0].clientY:a.clientY;this.touchPending=a.changedTouches[0];var d=document.elementFromPoint(c,e),g=this.keyPending,k=this.keyTarget(d);if(k&&0<=k.className.indexOf("key-hidden")||d&&!k&&0<=d.className.indexOf("key-row"))k=this.findNearestKey(a,d);k&&"string"==typeof k.id&&0>k.id.indexOf("-K_BKSP")&&this.cancelDelete();if(!(1<a.touches.length))if(this.popupVisible)null==k?(g&&this.highlightKey(g,!1),this.touchPending=this.keyPending=null):k==this.popupBaseKey?
(b.hasClass(k,"kmw-key-touched")||this.highlightKey(k,!0),this.keyPending=k,this.touchPending=a.touches[0]):(g&&this.highlightKey(g,!1),this.touchPending=this.keyPending=null);else{(d=document.getElementById("kmw-popup-keys"))&&"visible"==d.style.visibility&&"phone"==b.device.formFactor&&k==this.popupBaseKey&&(k=d.childNodes[0].firstChild);this.currentTarget=k;g&&k&&k!==g&&this.highlightKey(g,!1);this.highlightSubKeys(k,c,e);if(d&&"visible"==d.style.visibility){if(k&&0>k.id.indexOf("popup")&&k!=this.popupBaseKey)return;
k&&k==this.popupBaseKey&&0>k.className.indexOf("kmw-key-touched")&&this.highlightKey(k,!0)}else b=Math.max(5,this.kbdDiv.offsetTop+this.kbdDiv.offsetParent.offsetTop-.25*this.kbdDiv.firstChild.offsetHeight),g&&a.touches[0].pageY<b&&(this.highlightKey(g,!1),this.showKeyTip(null,!1),this.touchPending=this.keyPending=null);k&&this.keyPending&&(this.keyPending=k,this.touchPending=a.touches[0]);this.keyPending&&(g!=k||0>k.className.indexOf("kmw-key-touched"))&&this.highlightKey(k,!0);g&&k&&k!=g&&""!=k.id&&
this.touchHold(k)}}}.bind(this);this.repeatDelete=function(){var a=f.keyman.singleton.textProcessor;this.deleting&&(a.clickKey(this.deleteKey),this.deleting=window.setTimeout(this.repeatDelete,100))}.bind(this);this.mouseOverMouseDownHandler=function(a){var b=f.keyman.singleton.util,c=b.eventTarget(a);null!==c&&"desktop"==b.device.formFactor&&("SPAN"==c.nodeName&&(c=c.parentNode),c=this.keyTarget(c),"mousedown"==b.eventType(a)?(this.currentKey=c.id,b._CancelMouse(a),this.highlightKey(c,!0)):c.id==
this.currentKey&&this.highlightKey(c,!0))}.bind(this);this.mouseUpMouseOutHandler=function(a){var b=f.keyman.singleton,c=b.util,e=c.eventTarget(a);null!==e&&"desktop"==c.device.formFactor&&("SPAN"==e.nodeName&&(e=e.parentNode),e=this.keyTarget(e),this.highlightKey(e,!1),"mouseup"==c.eventType(a)&&(e.id==this.currentKey&&b.textProcessor.clickKey(e),this.currentKey=""))}.bind(this);this.highlightSubKeys=this.highlightSubKeys||function(a,b,c){};this.drawPreview=this.drawPreview||function(a,b,c,e){};
this.addCallout=this.addCallout||function(a){return null};this.waitForFonts=this.waitForFonts||function(a,b){return!0};var d=f.keyman.singleton;b=d.util;var k=b.device.formFactor,m=c;c=b._CreateElement("div");var l=d.keyboardManager.activeKeyboard;if("object"!=typeof m||null==m)d=l?new g.utils.Version(l.KVER):new g.utils.Version(d.version),m=h.Layouts.buildDefaultLayout(a,d,e,k);this.layout=h.ActiveLayout.polyfill(m,k);this.layers=m.layer;this.fontFamily="font"in m?m.font:"";m.keyLabels="undefined"!=
typeof m.displayUnderlying?1==m.displayUnderlying:l&&"undefined"!=typeof l.KDU&&l.KDU;a=this.deviceDependentLayout(m,b.device.formFactor);this.ddOSK=!0;c.appendChild(a);this.kbdHelpDiv=this.kbdDiv=c;c.className=b.device.formFactor+" kmw-osk-inner-frame"}b.prototype.getDefaultKeyObject=function(){return new c(void 0,"",h.ActiveKey.DEFAULT_KEY.width,h.ActiveKey.DEFAULT_KEY.sp,null,h.ActiveKey.DEFAULT_KEY.pad)};b.prototype.deviceDependentLayout=function(a,b){var c=f.keyman.singleton.util,e=f.keyman.singleton.osk,
d=100,g=c._CreateElement("div"),k=g.style;g.className="kmw-key-layer-group";switch(b){case "phone":case "tablet":var m=e.getHeight();k.height=m+"px";d=Math.round(100*e.getKeyboardHeight()/m)}if(null==a)return g;m=a.fontsize;k.fontSize="undefined"==typeof m||null==m||""==m?"1em":a.fontsize;this.fontSize=k.fontSize;var l;var q=a.layer;this.getDefaultKeyObject().fontsize=k.fontSize;for(m=0;m<q.length;m++){var p=q[m],u=p.row;for(l=u.length;0<l&&!(0<u[l-1].key.length);l--);l<u.length&&u.splice(l-u.length,
u.length-l)}var v=d/q[0].row.length;"desktop"==b&&(v=d/q[0].row.length);e="desktop"==b?100:e.getWidth();c.device.touchable&&(g.addEventListener("touchstart",this.touch,!0),g.addEventListener("touchend",this.release,!0),g.addEventListener("touchmove",this.moveOver,!1));for(m=0;m<q.length;m++){p=q[m];b=c._CreateElement("div");l=b.style;b.className="kmw-key-layer";l.display=0==m?"block":"none";l.height=k.height;l.fontFamily="font"in a?a.font:"";b.layer=b.nextLayer=p.id;"string"==typeof p.nextlayer&&
(b.nextLayer=p.nextlayer);u=p.row;for(l=0;l<u.length;l++){d=c._CreateElement("div");d.className="kmw-key-row";d.onmousedown=c.mouseDownPreventDefaultHandler;var A=u[l];var J=d.style;J.maxHeight=J.height=v+"%";var y=A.key;var D=0;for(A=0;A<y.length-1;A++){var B=y[A].widthpc*e;y[A].widthpc=B;var G=y[A].padpc*e;y[A].padpc=G;y[A].proportionalX=(D+G+B/2)/e;y[A].proportionalWidth=B/e;D+=G+B}var K=h.ActiveKey.DEFAULT_RIGHT_MARGIN*e/p.totalWidth;D+=K;1==y.length&&0>parseInt(y[0].pad,10)?(B=y[0].widthpc*e,
y[0].widthpc=B,D+=B,y[0].padpc=e-D,y[0].proportionalX=(D-K-B/2)/e,y[0].proportionalWidth=B/e):0<y.length&&(A=y.length-1,G=y[A].padpc*e,y[A].padpc=G,D+=G,y[A].widthpc=B=e-D,y[A].proportionalX=(e-K-B/2)/e,y[A].proportionalWidth=B/e);for(A=D=0;A<y.length;A++)B=y[A],B=(new n(B,p.id)).construct(this,a,J,D),d.appendChild(B.element),D+=B.percent;b.appendChild(d)}g.appendChild(b)}return g};b.prototype.getTouchCoordinatesOnKeyboard=function(a){var b=f.keyman.singleton.util.getAbsolute(this.kbdDiv.firstChild);
a={x:a.pageX-b.x,y:a.pageY-b.y};b=this.kbdDiv.firstChild;a.x/=b.offsetWidth;a.y/=b.offsetHeight;return a};b.prototype.getTouchProbabilities=function(a){if(!f.keyman.singleton.modelManager.mayCorrect)return null;a=this.getTouchCoordinatesOnKeyboard(a);var b=this.kbdDiv.firstChild;return this.layout.layer[this.layerIndex].getTouchProbabilities(a,b.offsetWidth/b.offsetHeight)};b.prototype.keyTarget=function(b){var c=f.keyman.singleton.util;try{if(b){if(c.hasClass(b,"kmw-key"))return a(b);if(b.parentNode&&
c.hasClass(b.parentNode,"kmw-key"))return a(b.parentNode);if(b.firstChild&&c.hasClass(b.firstChild,"kmw-key"))return a(b.firstChild)}}catch(r){}return null};b.prototype.findNearestKey=function(a,b){if(!a||"undefined"==typeof a.changedTouches||0==a.changedTouches.length)return null;for(a=a.changedTouches[0].pageX;b&&void 0!==b.className&&0>b.className.indexOf("key-row");)b=b.parentNode;if(!b)return null;var c,e=0,d=24,f=1E5;for(c=0;c<b.childNodes.length;c++){var g=b.childNodes[c];if(!(void 0!==g.className&&
0<=g.className.indexOf("key-hidden"))){var k=g.offsetLeft;var h=k+g.offsetWidth;if(a>=k&&a<=h)return g.firstChild;k-=a;0<=k&&k<f&&(e=c,f=k);k=a-h;0<=k&&k<f&&(e=c,f=k)}}return 1E5>f&&(b=b.childNodes[e],k=b.offsetLeft,h=k+b.offsetWidth,40<b.offsetWidth&&(d=.6*b.offsetWidth),0<=k-a&&k-a<d||0<=a-h&&a-h<d)?b.firstChild:null};b.prototype.cancelDelete=function(){this.deleting&&window.clearTimeout(this.deleting);this.deleting=0};b.prototype._UpdateVKShiftStyle=function(a){var b,c=f.keyman.singleton.textProcessor;
if(a)for(b=0;b<this.layers.length&&this.layers[b].id!=this.layerId;b++);else{b=this.layerIndex;a=this.layers[b].id;var e=this.layers[b];b=["K_CAPS","K_NUMLOCK","K_SCROLL"];var d=[e.capsKey,e.numKey,e.scrollKey];for(e=0;e<d.length;e++)if(null!=d[e]){d[e].sp=c.stateKeys[b[e]]?h.Layouts.buttonClasses["SHIFT-ON"]:h.Layouts.buttonClasses.SHIFT;var g=document.getElementById(a+"-"+b[e]);this.setButtonClass(d[e],g,this.layout)}}};b.prototype.setButtonClass=function(a,b,c){var e=f.keyman.singleton,d=0,g="default shift shift-on special special-on    deadkey blank hidden".split(" ");
"string"==typeof a.dk&&"1"==a.dk&&(d=8);"string"==typeof a.sp&&(d=parseInt(a.sp,10));if(0>d||10<d)d=0;c=c||this.layout;b.className=4<c.layer[0].row.length&&"phone"==e.util.device.formFactor?"kmw-key kmw-5rows kmw-key-"+g[d]:"kmw-key kmw-key-"+g[d]};b.prototype.clearPopup=function(){var a=f.keyman.singleton.osk,b=document.getElementById("kmw-popup-keys");null!=b&&(b.shim&&a._Box.removeChild(b.shim),b.parentNode.removeChild(b));this.popupCallout&&a._Box.removeChild(this.popupCallout);this.popupCallout=
null;this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);this.popupBaseKey=null};b.prototype.showSubKeys=function(a){if(null!=this.keyPending){var b=f.keyman.singleton,c=b.util,e=c.device,d=a.subKeys,k=document.createElement("DIV");this.getDefaultKeyObject();k.id="kmw-popup-keys";this.popupBaseKey=a;"phone"==e.formFactor&&this.prependBaseKey(a);var h=k.style;h.bottom=parseInt(a.style.bottom,10)+parseInt(a.style.height,10)+4+"px";h.fontFamily=this.fontFamily;
h.fontSize=b.util.getStyleValue(a,"font-size");h.visibility="hidden";var l=d.length;var n=Math.min(Math.ceil(l/9),2);var m=Math.ceil(l/n);1<n&&(h.width=m*a.offsetWidth+5*m+"px");for(h=0;h<l;h++){var p=!1,u=Math.floor(h/m);1<n&&0<u&&(p=!0);p=(new f.keyman.osk.OSKSubKey(d[h],a.key.layer)).construct(this,a,p);k.appendChild(p)}this.showKeyTip(null,!1);b.osk._Box.appendChild(k);h=k.style;d=g.dom.Utils.getAbsoluteX(a)+.5*(a.offsetWidth-k.offsetWidth);c=(c.landscapeView()?screen.height:screen.width)-k.offsetWidth;
d>c&&(d=c);0>d&&(d=0);h.left=d+"px";this.popupCallout=this.addCallout(a);h.visibility="visible";k.shim=document.createElement("DIV");k.shim.id="kmw-popup-shim";b.osk._Box.appendChild(k.shim);"phone"==e.formFactor&&(this.keyPending=a=k.childNodes[0].firstChild,this.highlightKey(a,!0))}};b.prototype.prependBaseKey=function(a){var b=a.subKeys,e=f.keyman.singleton;if(a&&"undefined"!=typeof a.id){a.id.split("-");var d=a.keyId;var g=a.key.spec.layer;var k=a.key.spec.sp,h=a.key.spec.nextlayer;if("undefined"!=
typeof b&&0<b.length&&(b[0].id!=d||b[0].layer!=g)){d=new c(d,"",void 0,k,h);""!=g&&(d.layer=g);for(g=0;g<a.childNodes.length&&!e.util.hasClass(a.childNodes[g],"kmw-key-text");g++);g<a.childNodes.length&&(d.text=a.childNodes[g].textContent);b.splice(0,0,d)}}};b.prototype.showLanguage=function(){var a=f.keyman.singleton,b="",c=a.keyboardManager.activeStub;c?(a=c.KL,b=c.KN):a=a.getActiveLanguage(!0)?a.getActiveLanguage(!0):"English";try{var e=this.spaceBar.firstChild,d=e.parentNode;"undefined"==typeof d.className||
""==d.className?d.className="kmw-spacebar":-1==d.className.indexOf("kmw-spacebar")&&(d.className+=" kmw-spacebar");e.className="kmw-spacebar-caption";b=b.replace(/\s*keyboard\s*/i,"");c="";c=b==a?a:a+" ("+b+")";e.innerHTML!=c&&(e.innerHTML=c)}catch(z){}};b.prototype.highlightKey=function(a,b){if(a&&""!=a.className&&!(0<=a.className.indexOf("kmw-key-row"))){var c=a.className;null!=this.keytip&&0>c.indexOf("kmw-key-shift")&&0>c.indexOf("kmw-spacebar")&&0>a.id.indexOf("popup")?this.showKeyTip(a,b):b&&
0>c.indexOf(" kmw-key-touched")?(a.className=c+" kmw-key-touched",this.showKeyTip(null,!1)):a.className=c.replace(" kmw-key-touched","")}};b.prototype.getKeyEmFontSize=function(){var a=f.keyman.singleton,b=a.util;if("desktop"==b.device.formFactor)return.8*this.getFontSizeFromCookie();var c=getComputedStyle(document.body).fontSize;c=b.getFontSizeStyle(c).val;a=b.getFontSizeStyle(a.osk._Box).val;return c*a};b.prototype.getFontSizeFromCookie=function(){var a=f.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");
if("undefined"==typeof b||null==b)return 16;a=a.toNumber(b.height,.15*screen.height);a>.5*screen.height&&(a=.5*screen.height);return a/8};b.prototype.getSpecialKey=function(b,c){var e=this.kbdDiv.childNodes[0].childNodes;if(0<=b&&b<e.length)for(b=e[b].childNodes,b=b[b.length-1].childNodes,e=0;e<b.length;e++){var d=a(b[e].firstChild);if(d&&d.keyId==c)return d}return null};b.prototype.show=function(){var a=f.keyman.singleton.util.device,b,c=-1,e=this.kbdDiv.childNodes[0].childNodes;for(b=0;b<e.length;b++){var d=
e[b];d.layer==this.layerId?(d.style.display="block",this.nextLayer=this.layerId,this.layerIndex=c=b,"string"==typeof this.layers[b].nextlayer&&(this.nextLayer=this.layers[b].nextlayer),this._UpdateVKShiftStyle()):d.style.display="none"}a.touchable&&(this.lgKey=this.getSpecialKey(c,"K_LOPT"),this.hkKey=this.getSpecialKey(c,"K_ROPT"),"iOS"==a.OS&&"phone"==a.formFactor&&this.adjustHeights());this.spaceBar=this.getSpecialKey(c,"K_SPACE")};b.prototype.showLayer=function(a){var b=f.keyman.singleton;if(a==
this.layerId&&"desktop"!=b.util.device.formFactor)return!0;if(b.keyboardManager.activeKeyboard)for(var c=0;c<this.layers.length;c++)if(this.layers[c].id==a)return this.layerId=a,b.osk._Show(),!0;return!1};b.prototype.adjustHeights=function(){var a=f.keyman.singleton,b=a.osk._Box;if(!(b&&this.kbdDiv&&this.kbdDiv.firstChild&&this.kbdDiv.firstChild.firstChild.childNodes))return!1;var c=1;"iOS"!=a.util.device.OS||a.isEmbedded||(c/=a.util.getViewportScale());a=this.computedAdjustedOskHeight();var e=b.style;
e.height=e.maxHeight=a+"px";b=b.childNodes.item(1).firstChild;e=b.style;e.height=e.maxHeight=a+"px";e.fontSize=c+"em";this.adjustLayerHeights(a);return!0};b.prototype.computedAdjustedOskHeight=function(){for(var a=f.keyman.singleton.util.device,b=this.kbdDiv.firstChild.childNodes,c=f.keyman.singleton.osk.getKeyboardHeight(),e=0,d=0;d<b.length;d++){var g=b[d].childNodes.length;g*=Math.floor(c/(0==g?1:g));g>e&&(e=g)}b=e+0;"Android"==a.OS&&"devicePixelRatio"in window&&(b/=window.devicePixelRatio);return b};
b.prototype.adjustLayerHeights=function(a){for(var b=f.keyman.singleton.osk,c=f.keyman.singleton.util.device,e=this.kbdDiv.firstChild.childNodes,d=0;d<e.length;d++){var g=e[d],k=e[d].childNodes.length;e[d].style.height=a+"px";var h=Math.floor(b.getKeyboardHeight()/(0==k?1:k));"Android"==c.OS&&"devicePixelRatio"in window&&(g.style.height=g.style.maxHeight=a+"px",h/=window.devicePixelRatio);g=Math.round(.15*h);for(var l=0;l<k;l++){var n=e[d].childNodes[l].style,m=(k-l-1)*h+1;n.bottom=m+"px";n.maxHeight=
n.height=h+"px";this.layout.layer[d].row[l].proportionalY=(a-m-h/2)/a;this.adjustRowHeights(e[d].childNodes[l].childNodes,h,m,g)}}};b.prototype.adjustRowHeights=function(a,b,c,e){var d=f.keyman.singleton.util,g=d.device;g="iOS"==g.OS&&"phone"==g.formFactor&&d.landscapeView();for(var k=a.length,h=0;h<k;h++){var l=a[h],n;for(n=0;n<l.childNodes.length&&!d.hasClass(l.childNodes[n],"kmw-key");n++);var m=l.style;m.bottom=c-e/2+"px";m.height=m.minHeight=b+"px";m=l.childNodes[n].style;m.bottom=c+"px";m.height=
m.minHeight=b-e+"px";g&&0<n&&(l.childNodes[0].style.fontSize="6px")}};b.prototype.appendStyleSheet=function(){var a=f.keyman.singleton,b=a.util,c=a.keyboardManager.activeKeyboard,e=a.keyboardManager.activeStub;if(null!=e){this.styleSheet&&b.removeStyleSheet(this.styleSheet);var d=e.KFont;e=e.KOskFont;b.addFontFaceStyleSheet(d);b.addFontFaceStyleSheet(e);a.hideInputs();var g=this.addFontStyle(d,e);null!=c&&"string"==typeof c.KCSS&&(g+=c.KCSS);this.styleSheet=b.addStyleSheet(g);this.waitForFonts(d,
e)&&a.alignInputs()}};b.prototype.addFontStyle=function(a,b){var c=f.keyman.singleton,e=c.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(e=a.family);e=e.replace(/\u0022/g,"");var d=new RegExp("\\s?"+e+",?"),g=c.appliedFont.replace(/\u0022/g,"");g=g.replace(d,"");g=g.replace(/,$/,"");g='"'+(""==g?e:e+","+g).replace(/,\s?/g,'","')+'"';e=".keymanweb-font{\nfont-family:"+g+" !important;\n}\n";"undefined"!=typeof b?e=e+'.kmw-key-text{\nfont-family:"'+b.family.replace(/\u0022/g,"").replace(/,/g,
'","')+'";\n}\n':"undefined"!=typeof a&&(e=e+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');c.appliedFont=g;return e};b.prototype.buildDocumentationKeyboard=function(a,b,c,e){var d=f.keyman.singleton;b=d.keyboardManager.activeKeyboard;c="undefined"==typeof c?"desktop":c;e="undefined"==typeof e?"default":e;var k=d.keyboardManager.keyboards;if(null!=a){var l=a.toLowerCase().replace("keyboard_","");for(a=0;a<k.length;a++)if(l==k[a].KI.toLowerCase().replace("keyboard_",
"")){b=k[a];break}}if(!b)return null;l=b.KVKL;k=null;a=b.KV;"object"==typeof l&&("object"==typeof l[c]&&null!=l[c]?k=l[c]:"phone"==c&&"object"==typeof l.tablet&&null!=l.tablet?k=l.tablet:"tablet"==c&&"object"==typeof l.phone&&null!=l.phone?k=l.phone:"object"==typeof l.desktop&&null!=l.desktop&&(k=l.desktop));null==k&&null!=a&&(k=new g.utils.Version(b.KVER),k=h.Layouts.buildDefaultLayout(a,k,d.keyboardManager.getKeyboardModifierBitmask(b),c));null!=k&&(k.keyLabels="undefined"!=typeof k.displayUnderlying?
1==k.displayUnderlying:"undefined"!=typeof b.KDU&&b.KDU);d=this.deviceDependentLayout(k,c);d.className=c+"-static kmw-osk-inner-frame";if(null!=k){var n,m;for(a=0;a<k.layer.length;a++){b=d.childNodes[a];for(n=0;n<b.childNodes.length;n++)for(c=b.childNodes[n],m=0;m<c.childNodes.length;m++)l=c.childNodes[m],l.style.height="100%";b.style.display="number"==typeof e?a==e&&0<=e?"block":"none":"string"==typeof e?k.layer[a].id==e?"block":"none":0==a?"block":"none"}}else d.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+
c+" layout is defined for "+b.KN+".</p>";d.style.border="1px solid #ccc";return d};b.prototype.onHide=function(){this.hkKey&&this.highlightKey(this.hkKey,!1)};b.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,"*Shifted*":8,"*AltGr*":2,"*TabLeft*":7,"*LAlt*":86,"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,
"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112};return b}();h.VisualKeyboard=p})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(g){var h=function(){function a(a){this.totalLength=0;this.x=a.pageX;this.totalLength=0}a.prototype.updateTo=function(a){var b=this.x;this.x=a.pageX;a={deltaX:this.x-b};this.totalLength+=Math.abs(a.deltaX);return a};Object.defineProperty(a.prototype,"hasScrolled",{get:function(){return this.totalLength>a.HAS_SCROLLED_FUDGE_FACTOR},enumerable:!0,configurable:!0});a.HAS_SCROLLED_FUDGE_FACTOR=10;return a}(),d=function(){function a(a,e,c){this.baseElement=a;this.rowClassMatch=
e;this.selectedTargetMatch=c}a.prototype.findTargetFromTouch=function(a,e,c){c=c?a.touches:a.changedTouches;if(!a||"undefined"==typeof c||0==c.length)return null;for(a=c[0].pageX;e&&void 0!==e.className&&0>e.className.indexOf(this.rowClassMatch);)e=e.parentNode;if(!e)return null;var b=0,d=24,f=1E5;for(c=0;c<e.childNodes.length;c++){var g=e.childNodes[c];if(!this.isInvalidTarget(this.findTargetFrom(g))){var h=g.offsetLeft;var l=h+g.offsetWidth;h-=a;0<=h&&h<f&&(b=c,f=h);l=a-l;0<=l&&l<f&&(b=c,f=l);if(0>
l&&0>h)return this.findTargetFrom(g)}}return 1E5>f&&(e=e.childNodes[b],h=e.offsetLeft,l=h+e.offsetWidth,40<e.offsetWidth&&(d=.6*e.offsetWidth),0<=h-a&&h-a<d||0<=a-l&&a-l<d)?this.findTargetFrom(e):null};a.prototype.findBestTarget=function(a,e){var b=e?document.elementFromPoint(a.touches[0].clientX,a.touches[0].clientY):a.changedTouches[0].target;var d=this.findTargetFrom(b);d||(d=this.findTargetFromTouch(a,b,e));return d};a.prototype.isInvalidTarget=function(a){return!1};a.prototype.touchStart=function(a){this.currentTarget=
this.findBestTarget(a);this.touchX=a.changedTouches[0].pageX;this.touchY=a.changedTouches[0].pageY;this.touchCount=a.touches.length;this.currentTarget&&(this.scrollTouchState=this.currentTarget.clientWidth<this.currentTarget.scrollWidth?new h(a.changedTouches[0]):null,this.highlight(this.currentTarget,!0),this.pendingTarget?(this.highlight(this.pendingTarget,!1),this.select(this.pendingTarget),this.clearHolds(),this.touchCount--):this.hold(this.currentTarget),this.pendingTarget=this.currentTarget)};
a.prototype.touchEnd=function(a){var b=this.currentTarget;if(this.isSubmenuActive()||this.hasModalPopup()){if(0<a.touches.length)return;if(null==b||0>b.id.indexOf("popup")&&b.id!=this.popupBaseTarget.id)this.highlight(this.pendingTarget,!1),this.clearHolds(),this.pendingTarget=null}b=a.changedTouches[0].pageX;b=2>b&&5<this.touchX||b>window.innerWidth-2&&this.touchX<window.innerWidth-5;this.scrollTouchState&&(b=b||this.scrollTouchState.hasScrolled);var c=this.touchCount;0<this.touchCount&&this.touchCount--;
this.pendingTarget?(this.highlight(this.pendingTarget,!1),0>this.pendingTarget.className.indexOf("hidden")&&0<c&&!b&&this.select(this.pendingTarget),this.clearHolds(),this.pendingTarget=null):(b=this.findBestTarget(a))&&this.highlight(b,!1)};a.prototype.touchMove=function(a){var b=f.keyman.singleton,c=b.util;a.preventDefault();a.cancelBubble=!0;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation();if(!(1<a.touches.length||
0==this.touchCount))if(this.currentTarget&&null!=this.scrollTouchState)a=this.scrollTouchState.updateTo(a.changedTouches[0]).deltaX,this.currentTarget.scrollLeft-=window.devicePixelRatio*a;else{var d="object"==typeof a.touches?a.touches[0].clientY:a.clientY,g=this.pendingTarget,h=this.findBestTarget(a,!0);if(this.hasModalPopup())null==h?(g&&this.highlight(g,!1),this.pendingTarget=null):h==this.popupBaseTarget?(c.hasClass(h,this.selectedTargetMatch)||this.highlight(h,!0),this.pendingTarget=h):(g&&
this.highlight(g,!1),this.pendingTarget=null);else{this.currentTarget=h=this.dealiasSubTarget(h);g&&h&&h!==g&&this.highlight(g,!1);if(h&&this.hasSubmenu(h)){!b.isEmbedded&&5<this.touchY-d&&!this.isSubmenuActive()&&this.displaySubmenuFor(h);if(h&&0>h.id.indexOf("popup")&&h!=this.popupBaseTarget)return;h&&h==this.popupBaseTarget&&0>h.className.indexOf(this.selectedTargetMatch)&&this.highlight(h,!0)}else c=this.baseElement,b=c.offsetParent.offsetTop+c.offsetTop,c=c.offsetHeight,d=Math.max(5,b-.25*c),
g&&(a.touches[0].pageY<d||a.touches[0].pageY>b+c+.25*c)&&(this.highlight(g,!1),this.clearHolds(),this.pendingTarget=null);h&&this.pendingTarget&&(this.pendingTarget=h);this.pendingTarget&&h&&(g!=h||0>h.className.indexOf(this.selectedTargetMatch))&&this.highlight(h,!0);g&&h&&h!=g&&""!=h.id&&this.hold(h)}}};return a}();g.UITouchHandlerBase=d})(g.dom||(g.dom={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){var l=function(){function a(b){var c=f.keyman.singleton.util._CreateElement("div");c.id=a.BANNER_ID;c.className=a.BANNER_CLASS;this.div=c;this.height=b;this.update()}Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(a){this._height=0<a?a:0;this.update()},enumerable:!0,configurable:!0});a.prototype.update=function(){var a=this.div.style,b=a.height,c=a.display;0<this._height?(a.height=this._height+"px",a.display="block"):
(a.height="0px",a.display="none");return b!==a.height||c!==a.display};a.prototype.appendStyleSheet=function(){};a.prototype.getDiv=function(){return this.div};a.prototype.activate=function(){};a.prototype.deactivate=function(){};a.DEFAULT_HEIGHT=37;a.BANNER_CLASS="kmw-banner-bar";a.BANNER_ID="kmw-banner-bar";return a}();h.Banner=l;var d=function(a){function b(){return a.call(this,0)||this}__extends(b,a);return b}(l);h.BlankBanner=d;d=function(a){function b(b,c){if(0<b.length){var e=a.call(this)||
this;c&&(e.height=c)}else e=a.call(this,0)||this;console.log("Loading img with src '"+b+"'");e.img=document.createElement("img");e.img.setAttribute("src",b);b=e.img.style;b.width="100%";b.height="100%";e.getDiv().appendChild(e.img);console.log("Image loaded.");return e}__extends(b,a);b.prototype.setImagePath=function(a){this.img&&this.img.setAttribute("src",a)};return b}(l);h.ImageBanner=d;var a=function(){function a(a){this._applyFunctor=null;var b=f.keyman.singleton;this.index=a;this.constructRoot();
a=this.display=b.util._CreateElement("span");this.div.appendChild(a)}a.prototype.constructRoot=function(){var c=f.keyman.singleton,e=this.div=c.util._CreateElement("div"),d=e.style;e.className="kmw-suggest-option";e.id=a.BASE_ID+this.index;if(c=c.keyboardManager.activeStub)c.KLC&&(e.lang=c.KLC),(e=c.KFont)&&e.family&&""!=e.family&&(d.fontFamily=this.fontFamily=e.family);d.width=(100-b.MARGIN*(b.SUGGESTION_LIMIT+1))/b.SUGGESTION_LIMIT+"%";d.marginLeft=b.MARGIN+"%";this.div.suggestion=this};Object.defineProperty(a.prototype,
"suggestion",{get:function(){return this._suggestion},enumerable:!0,configurable:!0});a.prototype.update=function(a,b){this._suggestion=a;this._applyFunctor=b||null;this.updateText()};a.prototype.updateText=function(){var a=this.generateSuggestionText();this.div.replaceChild(a,this.display);this.display=a};a.prototype.apply=function(a){var b=f.keyman.singleton;if(this.isEmpty())return[null,null];if(this._applyFunctor)return this._applyFunctor(),[null,null];var c=b.modelManager.getPredictionState(this._suggestion.transformId);
if(c){a||(a=g.text.Processor.getOutputTarget());var e=g.text.Mock.from(c.preInput);e.apply(this._suggestion.transform);var d=e.buildTransformFrom(a);e=b.modelManager.wordbreak(a);a.apply(d);if(b.oninserttext&&b.isEmbedded)b.oninserttext(d.deleteLeft,d.insert,d.deleteRight);b=g.text.Mock.from(c.preInput);b.apply(c.transform);return[b.buildTranscriptionFrom(a,null),e]}console.warn("Could not apply the Suggestion!");return[null,null]};a.prototype.isEmpty=function(){return!this._suggestion};a.prototype.generateSuggestionText=
function(){var a=this._suggestion,b=f.keyman.singleton.util._CreateElement("span");b.className="kmw-suggestion-text";if(null==a)return b;a=null==a.displayAs||""==a.displayAs?"\u00a0":a.displayAs;window.keyman.keyboardManager.isRTL()&&(a="\u200f"+a);b.innerHTML=a;return b};a.BASE_ID="kmw-suggestion-";return a}();h.BannerSuggestion=a;var b=function(b){function c(d){d=b.call(this,d||l.DEFAULT_HEIGHT)||this;d.options=[];for(var f=0;f<c.SUGGESTION_LIMIT;f++){var g=new a(f);d.options[f]=g;d.getDiv().appendChild(g.div)}d.manager=
new e(d.getDiv(),d.options);d.setupTouchHandling();return d}__extends(c,b);c.prototype.setupTouchHandling=function(){var a=f.keyman.singleton,b=this.getDiv(),c=this.manager;a.util.device.touchable&&(b.addEventListener("touchstart",function(a){c.touchStart(a)},!0),b.addEventListener("touchend",function(a){c.touchEnd(a)},!0),b.addEventListener("touchmove",function(a){c.touchMove(a)},!1))};c.prototype.activate=function(){var a=f.keyman.singleton,b=this.manager;a.modelManager.addEventListener("invalidatesuggestions",
b.invalidateSuggestions);a.modelManager.addEventListener("suggestionsready",b.updateSuggestions);a.modelManager.addEventListener("tryaccept",b.tryAccept);a.modelManager.addEventListener("tryrevert",b.tryRevert);a.modelManager.predict()};c.prototype.deactivate=function(){var a=f.keyman.singleton,b=this.manager;a.modelManager.removeEventListener("invalidatesuggestions",b.invalidateSuggestions);a.modelManager.removeEventListener("suggestionsready",b.updateSuggestions);a.modelManager.removeEventListener("tryaccept",
b.tryAccept);a.modelManager.removeEventListener("tryrevert",b.tryRevert)};c.prototype.rotateSuggestions=function(){this.manager.rotateSuggestions()};c.SUGGESTION_LIMIT=3;c.MARGIN=1;c.TOUCHED_CLASS="kmw-suggest-touched";return c}(l);h.SuggestionBanner=b;var e=function(c){function e(a,e){a=c.call(this,a,l.BANNER_CLASS,b.TOUCHED_CLASS)||this;a.initNewContext=!0;a.currentSuggestions=[];a.recentAccept=!1;a.preAccept=null;a.swallowPrediction=!1;a.doRevert=!1;a.recentRevert=!1;a.rejectedSuggestions=[];a._applyReversion=
function(){var a=f.keyman.singleton,b=g.text.Processor.getOutputTarget(),c=this.preAccept,e=g.text.Mock.from(c.preInput);e.apply(c.transform);c=e.buildTransformFrom(b);b.apply(c);if(a.oninserttext&&a.isEmbedded)a.oninserttext(c.deleteLeft,c.insert,c.deleteRight);this.currentSuggestions=this.previousSuggestions;this.currentTranscriptionID=this.previousTranscriptionID;a=this.currentSuggestions.indexOf(this.recentAccepted);-1!=a&&(this.rejectedSuggestions.push(this.recentAccepted),this.currentSuggestions.splice(a,
1));this.doRevert=this.recentAccept=!1;this.recentRevert=!0;this.doUpdate()}.bind(a);a.tryAccept=function(a){return!this.recentAccept&&this.selected?(this.doAccept(this.selected),!1):this.recentAccept&&"space"==a?this.recentAccept=!1:!0}.bind(a);a.tryRevert=function(){this.doRevert?this.recentAccept=this.doRevert=!1:this.recentAccept&&(this.showRevert(),this.swallowPrediction=!0);return!0}.bind(a);a.invalidateSuggestions=function(a){this.initNewContext=!1;this.swallowPrediction&&"context"!=a||(this.recentRevert=
this.doRevert=this.recentAccept=!1,this.rejectedSuggestions=[],"context"==a&&(this.swallowPrediction=!1,this.initNewContext=!0));this.options.forEach(function(a){a.update(null)})}.bind(a);a.updateSuggestions=function(a){var b=a.suggestions;this.currentSuggestions=b;this.currentTranscriptionID=a.transcriptionID;for(a=0;a<b.length;a++){var c=b[a];"keep"==c.tag&&(this.keepSuggestion=c)}this.keepSuggestion&&this.currentSuggestions.splice(this.currentSuggestions.indexOf(this.keepSuggestion),1);this.swallowPrediction?
this.swallowPrediction=!1:(this.recentRevert=this.doRevert=this.recentAccept=!1,this.rejectedSuggestions=[]);this.doUpdate()}.bind(a);a.options=e;return a}__extends(e,c);e.prototype.findTargetFrom=function(a){var b=f.keyman.singleton.util;try{if(a){if(b.hasClass(a,"kmw-suggest-option"))return a;if(a.parentNode&&b.hasClass(a.parentNode,"kmw-suggest-option"))return a.parentNode}}catch(p){}return null};e.prototype.highlight=function(c,e){var d=c.className,f=" "+b.TOUCHED_CLASS;-1==c.id.indexOf(a.BASE_ID)?
console.warn("Cannot find BannerSuggestion object for element to highlight!"):(this.selected=c.suggestion).isEmpty()&&(e=!1,this.selected=null);e&&0>d.indexOf(f)?c.className=d+f:c.className=d.replace(f,"")};e.prototype.select=function(a){this.doAccept(a.suggestion)};e.prototype.hold=function(a){a=a.suggestion;var b=-1==this.currentSuggestions.indexOf(a.suggestion);this.platformHold&&this.platformHold(a,b)};e.prototype.clearHolds=function(){};e.prototype.hasModalPopup=function(){return f.keyman.singleton.osk.vkbd.popupVisible};
e.prototype.dealiasSubTarget=function(a){return a};e.prototype.hasSubmenu=function(a){return!1};e.prototype.isSubmenuActive=function(){return!1};e.prototype.displaySubmenuFor=function(a){throw Error("Method not implemented.");};e.prototype.doAccept=function(a){var b=a.apply(),c=b[0];b=b[1];var e=this;c&&(this.preAccept=c,b.then(function(a){e.preAcceptText=a}),this.selected=null,this.recentAccept=!0,this.recentRevert=this.doRevert=!1,this.recentAccepted=a.suggestion,this.previousSuggestions=this.currentSuggestions,
this.previousTranscriptionID=this.currentTranscriptionID,a=f.keyman.singleton,this.swallowPrediction=!0,a.modelManager.predict())};e.prototype.showRevert=function(){this.revertSuggestion={transform:null,displayAs:'"'+this.preAcceptText+'"'};this.doRevert=!0;this.doUpdate()};e.prototype.activateKeep=function(){return!this.recentAccept&&!this.recentRevert&&!this.initNewContext};e.prototype.doUpdate=function(){var a=this,b=[];this.activateKeep()&&this.keepSuggestion?b.push(this.keepSuggestion):this.doRevert&&
b.push(this.revertSuggestion);b=b.concat(this.currentSuggestions);this.options.forEach(function(c,e){e<b.length?c.update(b[e],0==e&&a.doRevert?a._applyReversion:null):c.update(null)})};e.prototype.rotateSuggestions=function(){if(0<this.currentSuggestions.length){var a=b.SUGGESTION_LIMIT-(this.activateKeep()?1:0);a=this.currentSuggestions.splice(0,a);this.rejectedSuggestions=this.rejectedSuggestions.concat(a)}0==this.currentSuggestions.length&&(this.currentSuggestions=this.rejectedSuggestions,this.rejectedSuggestions=
[]);this.doUpdate()};return e}(g.dom.UITouchHandlerBase);h.SuggestionManager=e})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(g){var h=function(){function d(){this._options={};this.imagePath="";this.constructContainer();this.setOptions(d.DEFAULT_OPTIONS);f.keyman.singleton.modelManager.addEventListener("modelchange",this.selectBanner.bind(this))}d.prototype.constructContainer=function(){var a=f.keyman.singleton.util._CreateElement("div");a.id="keymanweb_banner_container";a.className="kmw-banner-container";return this.bannerContainer=a};Object.defineProperty(d.prototype,"element",{get:function(){return this.bannerContainer},
enumerable:!0,configurable:!0});d.prototype.getOptions=function(){var a={},b;for(b in this._options)a[b]=this._options[b];return a};d.prototype.setOptions=function(a){var b=f.keyman.singleton,e;for(e in a){switch(e){case "alwaysShow":this.alwaysShow=a[e];break;case "mayPredict":b.modelManager.mayPredict=a[e];break;case "mayCorrect":b.modelManager.mayCorrect=a[e];break;case "imagePath":this.imagePath=a[e]}this._options[e]=a[e]}this.selectBanner()};d.prototype.appendStyles=function(){this.activeBanner&&
this.activeBanner.appendStyleSheet()};d.prototype.setBanner=function(a,b){switch(a){case "blank":b=new g.BlankBanner;break;case "image":b=new g.ImageBanner(this.imagePath,g.Banner.DEFAULT_HEIGHT);break;case "suggestion":b=new g.SuggestionBanner(b);break;default:throw Error("Invalid type specified for the banner!");}this._activeType=a;b&&(this._setBanner(b),b.activate())};d.prototype.selectBanner=function(a){f.keyman.singleton.modelManager.activeModel?this.setBanner("suggestion"):this.alwaysShow?this.setBanner("image"):
this.setBanner("blank")};d.prototype._setBanner=function(a){if(this.activeBanner){if(a==this.activeBanner)return;var b=this.activeBanner;b.deactivate();this.bannerContainer.replaceChild(a.getDiv(),b.getDiv())}this.activeBanner=a;this.bannerContainer.appendChild(a.getDiv());f.keyman.singleton.osk._Show()};Object.defineProperty(d.prototype,"activeType",{get:function(){return this._activeType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this.activeBanner?
this.activeBanner.height:0},set:function(a){this.activeBanner&&(this.activeBanner.height=a)},enumerable:!0,configurable:!0});d.DEFAULT_OPTIONS={alwaysShow:!1,mayPredict:!0,mayCorrect:!0,imagePath:""};return d}();g.BannerManager=h})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){var l=function(){function d(){this.ready=!1;this.loadRetry=0;this._Visible=!1;this._Enabled=!0;this.vpScale=1;this.noDrag=this.userPositioned=!1;this.modifierCodes=g.text.Codes.modifierCodes;this.modifierBitmasks=g.text.Codes.modifierBitmasks;this.stateBitmasks=g.text.Codes.stateBitmasks;this.keyCodes=g.text.Codes.keyCodes;this.restorePosition=function(){this._Visible&&(f.keyman.singleton.domManager.focusLastActiveElement(),this.loadCookie(),this.userPositioned=
!1,this.saveCookie(),this._Show(),this.doResizeMove());this.pinImg&&(this.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)}.bind(this);this._VKbdMouseOver=function(a){f.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(this);this._VKbdMouseOut=function(a){f.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(this);this._VResizeMouseOver=this._VResizeMouseOut=function(a){a=f.keyman.singleton._GetEventObject(a);if(!a)return!1;a&&a.preventDefault&&a.preventDefault();var b=
this.getRect();this.width=b.width;this.height=b.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseDown=function(a){var b=f.keyman.singleton;b.uiManager.justActivated=!0;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var e=a.pageX;var c=a.pageY}else a.clientX&&(e=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);this._ResizeMouseX=e;this._ResizeMouseY=c;document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&
(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth;this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight;document.onmousemove=this._VResizeMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="se-resize");a&&a.preventDefault&&a.preventDefault();
a.cancelBubble=!0;return!1}.bind(this);this._VResizeMouseMove=function(a){a=f.keyman.singleton._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);if(a.pageX){var b=a.pageX;var e=a.pageY}else a.clientX&&(b=a.clientX+document.body.scrollLeft,e=a.clientY+document.body.scrollTop);b=this._VOriginalWidth+b-this._ResizeMouseX;e=this._VOriginalHeight+e-this._ResizeMouseY;b<.2*screen.width&&(b=
.2*screen.width);e<.1*screen.height&&(e=.1*screen.height);b>.9*screen.width&&(b=.9*screen.width);e>.5*screen.height&&(b=.5*screen.height);this.vkbd.kbdDiv.style.width=b+"px";this.vkbd.kbdDiv.style.height=e+"px";this.vkbd.kbdDiv.style.fontSize=e/8+"px";a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseDown=function(a){var b=f.keyman.singleton;b.uiManager.justActivated=!0;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!0;if(a.pageX){var e=a.pageX;var c=
a.pageY}else a.clientX&&(e=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop);document.onmousemove!=this._VResizeMouseMove&&document.onmousemove!=this._VMoveMouseMove&&(this._VPreviousMouseMove=document.onmousemove,this._VPreviousMouseUp=document.onmouseup);this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which;this._VMoveX=e-this._Box.offsetLeft;this._VMoveY=c-this._Box.offsetTop;b.keyboardManager.isCJK()&&(this.pinImg.style.left=
"15px");document.onmousemove=this._VMoveMouseMove;document.onmouseup=this._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");a&&a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return!1}.bind(this);this._VMoveMouseMove=function(a){a=f.keyman.singleton._GetEventObject(a);if(!a||this.noDrag)return!0;this.userPositioned=this.resizing=!0;this.pinImg.style.display="block";if(this._VPreviousMouseButton!=("undefined"==typeof a.which?a.button:a.which))return this._VResizeMoveMouseUp(a);
if(a.pageX){var b=a.pageX;var e=a.pageY}else a.clientX&&(b=a.clientX+document.body.scrollLeft,e=a.clientY+document.body.scrollTop);this._Box.style.left=b-this._VMoveX+"px";this._Box.style.top=e-this._VMoveY+"px";a&&a.preventDefault&&a.preventDefault();b=this.getRect();this.width=b.width;this.height=b.height;a.cancelBubble=!0;return!1}.bind(this);this._VResizeMoveMouseUp=function(a){var b=f.keyman.singleton;a=b._GetEventObject(a);if(!a)return!0;this.resizing=!1;this.vkbd&&(this.vkbd.currentKey=null);
document.onmousemove=this._VPreviousMouseMove;document.onmouseup=this._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=this._VPreviousCursor);b.domManager.focusLastActiveElement();a&&a.preventDefault&&a.preventDefault();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);this.vkbd&&(this._VOriginalWidth=this.vkbd.kbdDiv.offsetWidth,this._VOriginalHeight=this.vkbd.kbdDiv.offsetHeight);this.doResizeMove();a.cancelBubble=!0;this.saveCookie();return!1}.bind(this);this.hideNow=
function(){this._Box.removeEventListener("transitionend",this.hideNow,!1);this._Box.removeEventListener("webkitTransitionEnd",this.hideNow,!1);if(!(0<=document.body.className.indexOf("osk-always-visible"))){var a=this._Box.style;a.display="none";a.opacity="1";this._Visible=!1;a.transition=a.msTransition=a.MozTransition=a.WebkitTransition="";if(this.vkbd)this.vkbd.onHide()}}.bind(this)}d.prototype.prepare=function(){var a=f.keyman.singleton,b=a.util;if(a.initialized){if(!this.ready&&(this._Box=b._CreateElement("div"),
document.body.appendChild(this._Box),b.linkStyleSheet(a.getStyleSheetPath("kmwosk.css")),b.attachDOMEvent(this._Box,"mousedown",function(b){a.uiManager.setActivatingUI(!0);return!1}),b.device.touchable)){var e=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();return!1};b.attachDOMEvent(this._Box,"touchstart",function(b){a.uiManager.setActivatingUI(!0);return e(b)});b.attachDOMEvent(this._Box,"touchend",e);b.attachDOMEvent(this._Box,"touchmove",e);b.attachDOMEvent(this._Box,"touchcancel",
e);this.vpScale=b.getViewportScale()}this.loadCookie();this.banner=new h.BannerManager;this.ready=!0}else window.setTimeout(this.prepare.bind(this),200)};d.prototype._Unload=function(){this._Box=this.banner=this.vkbd=null};d.prototype._Load=function(){var a=f.keyman.singleton,b=a.util,e=b.device,c=a.keyboardManager.activeKeyboard;if(null==this._Box)99<=this.loadRetry||(window.setTimeout(this._Load.bind(this),100),this.loadRetry++);else{this.loadRetry=0;a._TitleElement&&(a._TitleElement.innerHTML=
"KeymanWeb");this._Visible=!1;var d=this._Box.style;d.zIndex="9999";d.display="none";d.width=e.touchable?"100%":"auto";d.position="desktop"==e.formFactor?"absolute":"fixed";if(e.touchable){var g=1;if("phone"==e.formFactor)g=1.92*(a.isEmbedded?.65:.6);else{var l=1;"Android"==e.OS&&"devicePixelRatio"in window&&(l=window.devicePixelRatio);g="Android"==e.OS&&"tablet"==e.formFactor&&this.getHeight()<300*l?1.2*g:2*g}d.fontSize=g+"em"}this.vkbd=null;this._Box.innerHTML="";this._Box.onmouseover=this._VKbdMouseOver;
this._Box.onmouseout=this._VKbdMouseOut;if(null!=c||e.touchable){g=null;l=null;d="";this._Box.className="";if(null!=c){g=c.KV;d=c.KH;var p=c.KVKL;"undefined"!=typeof p&&null!=p&&(l=p[e.formFactor],"undefined"==typeof l||null==l)&&("phone"==e.formFactor?l=p.tablet:"tablet"==e.formFactor&&(l=p.phone),"undefined"==typeof l||null==l)&&(l=p.desktop)}if(null!=g&&null!=g.BK){p=g.BK;for(var v=!0,m=0;m<p.length;m++)if(0<p[m].length){v=!1;break}v&&(g=null)}null!=g||""==d||e.touchable?(null==g&&(g={F:"Tahoma",
BK:h.Layouts.dfltText}),this._GenerateVisualKeyboard(g,d,l,a.keyboardManager.getKeyboardModifierBitmask())):(e=b._CreateElement("div"),e.className="kmw-title-bar",e.appendChild(this._TitleBarInterior()),e.onmousedown=this._VMoveMouseDown,this._Box.appendChild(e),e=b._CreateElement("div"),e.className="kmw-osk-static",e.innerHTML=d,this._Box.appendChild(e),c.KHF&&c.KHF(this._Box));a._TitleElement&&(a._TitleElement.innerHTML="<span style='font-weight:bold'>"+c.KN+"</span> - "+a._TitleElement.innerHTML,
a._TitleElement.className="",a._TitleElement.style.color="#fff")}else e=b._CreateElement("div"),e.className="kmw-title-bar",e.appendChild(this._TitleBarInterior()),e.onmousedown=this._VMoveMouseDown,this._Box.appendChild(e),e=b._CreateElement("div"),e.className="kmw-osk-none",this._Box.appendChild(e);a=this._Box.firstChild;c=" kmw-keyboard-"+(c?c.KI.replace("Keyboard_",""):"");"keymanweb_title_bar"==a.id?a=a.nextSibling.nextSibling:"keymanweb_banner_container"==a.id&&(a=a.nextSibling);a.className=
"kmw-osk-inner-frame"+c;this.banner.appendStyles();this.vkbd&&(this.vkbd.createKeyTip(),this.vkbd.appendStyleSheet());this._Enabled&&this._Show()}};d.prototype._GenerateVisualKeyboard=function(a,b,e,c){this.vkbd=new f.keyman.osk.VisualKeyboard(a,b,e,c);a=f.keyman.singleton.util;this._Box.className=a.device.formFactor+" "+a.device.OS.toLowerCase()+" kmw-osk-frame";"desktop"==a.device.formFactor&&this._Box.appendChild(this.controlBar());this.banner&&this._Box.appendChild(this.banner.element);this._Box.appendChild(this.vkbd.kbdDiv);
"desktop"==a.device.formFactor?this._Box.appendChild(this.resizeBar()):this.vkbd.adjustHeights()};d.prototype.controlBar=function(){var a=f.keyman.singleton,b=a.util,e=b._CreateElement("div"),c="";e.id="keymanweb_title_bar";e.className="kmw-title-bar";e.onmousedown=this._VMoveMouseDown;a.keyboardManager.activeKeyboard&&(c=a.keyboardManager.activeKeyboard.KN);a=b._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML=c;e.appendChild(a);c=this.closeButton=b._CreateElement("div");c.id=
"kmw-close-button";c.className="kmw-title-bar-image";c.onmousedown=b._CancelMouse;c.onclick=function(){this._Hide(!0)}.bind(this);e.appendChild(c);c=this.helpImg=b._CreateElement("div");c.id="kmw-help-image";c.className="kmw-title-bar-image";c.title="KeymanWeb Help";c.onclick=function(){b.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=!1);return!1};c.onmousedown=b._CancelMouse;e.appendChild(c);c=this.configImg=b._CreateElement("div");c.id="kmw-config-image";c.className="kmw-title-bar-image";
c.title="KeymanWeb Configuration Options";c.onclick=function(){b.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};c.onmousedown=b._CancelMouse;e.appendChild(c);c=this.pinImg=b._CreateElement("div");c.id="kmw-pin-image";c.className="kmw-title-bar-image";c.title="Pin the On Screen Keyboard to its default location on the active text box";c.onclick=function(){this.loadCookie();this.userPositioned=!1;this.saveCookie();this._Show();this.doResizeMove();this.pinImg&&(this.pinImg.style.display=
"none");window.event&&(window.event.returnValue=!1);return!1}.bind(this);c.onmousedown=b._CancelMouse;e.appendChild(c);return e};d.prototype.resizeBar=function(){var a=f.keyman.singleton.util,b=a._CreateElement("div");b.className="kmw-footer";b.onmousedown=a._CancelMouse;var e=a._CreateElement("div");e.className="kmw-footer-caption";e.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';e.id="keymanweb-osk-footer-caption";a.attachDOMEvent(e,"dblclick",function(a){a&&a.shiftKey&&
this.showBuild();return!1}.bind(this),!1);"onselectstart"in e&&(e.onselectstart=a.selectStartHandler);b.appendChild(e);a=a._CreateElement("div");a.className="kmw-footer-resize";a.onmousedown=this._VResizeMouseDown;a.onmouseover=a.onmouseout=this._VResizeMouseOut;b.appendChild(a);this.resizeIcon=a;return b};d.prototype.showBuild=function(){var a=f.keyman.singleton;a.util.alert("KeymanWeb Version "+a.version+"."+a.build+'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2017 SIL International</span>')};
d.prototype._TitleBarInterior=function(){var a=f.keyman.singleton,b=a.util,e=b._CreateElement("div"),c=e.style;c.paddingLeft="2px";c.cursor="move";c.background="#ad4a28";c.font="8pt Tahoma,Arial,sans-serif";c=b._CreateElement("div");c.className="kmw-title-bar-actions";c.onmousedown=b._CancelMouse;var d=b._CreateElement("div");d.className="kmw-close-button";d.onmousedown=b._CancelMouse;d.onclick=function(){this._Hide(!0)}.bind(this);this.closeButton=d;c.appendChild(d);d=this.pinImg=b._CreateElement("div");
d.className="kmw-pin-image";d.title="Pin the On Screen Keyboard to its default location on the active text box";d.onclick=this.restorePosition;d.onmousedown=b._CancelMouse;d.style.display="none";b.device.touchable||c.appendChild(d);e.appendChild(c);a=a._TitleElement=b._CreateElement("span");a.className="kmw-title-bar-caption";a.innerHTML="KeymanWeb";e.appendChild(a);return e};d.prototype.isEnabled=function(){return this._Enabled};d.prototype.isVisible=function(){return this._Visible};d.prototype.saveCookie=
function(){var a=f.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard"),e=this.getPos();b.visible=this._Enabled?1:0;b.userSet=this.userPositioned?1:0;b.left=e.left;b.top=e.top;this.vkbd&&(b.width=this.width,b.height=this.height);a.saveCookie("KeymanWeb_OnScreenKeyboard",b)};d.prototype.loadCookie=function(){var a=f.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return this.userPositioned=!1;this._Enabled=1==a.toNumber(b.visible,1);
this.userPositioned=1==a.toNumber(b.userSet,0);this.x=a.toNumber(b.left,-1);this.y=a.toNumber(b.top,-1);var e=a.toNumber(b.width,.3*screen.width);a=a.toNumber(b.height,.15*screen.height);e<.2*screen.width&&(e=.2*screen.width);a<.1*screen.height&&(a=.1*screen.height);e>.9*screen.width&&(e=.9*screen.width);a>.5*screen.height&&(a=.5*screen.height);this.vkbd&&(this.vkbd.kbdDiv.style.width=e+"px",this.vkbd.kbdDiv.style.height=a+"px",this.vkbd.kbdDiv.style.fontSize=a/8+"px");-1!=this.x&&-1!=this.y&&this._Box||
(this.userPositioned=!1);this.x<window.pageXOffset-.8*e&&(this.x=window.pageXOffset-.8*e);0>this.y&&(this.y=this.x=-1,this.userPositioned=!1);this.userPositioned&&this._Box&&this.setPos({left:this.x,top:this.y});return!0};d.prototype.getWidthFromCookie=function(){var a=f.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return.3*screen.width;a=a.toNumber(b.width,.3*screen.width);a<.2*screen.width?a=.2*screen.width:a>.9*screen.width&&(a=.9*screen.width);
return a};d.prototype.getBannerHeight=function(){return null!=this.banner?this.banner.height:0};d.prototype.getKeyboardHeight=function(){var a=f.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskHeight)return a.getOskHeight();var e=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==b.formFactor){var c=Math.min(screen.height,screen.width),d=Math.max(screen.height,screen.width);e=a.util.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):d/
c*e/1.6}"iOS"==b.OS&&(e/=a.util.getViewportScale());"Android"==b.OS&&"phone"==b.formFactor&&"devicePixelRatio"in window&&/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(e*=window.devicePixelRatio);return e};d.prototype.getHeight=function(){return this.getBannerHeight()+this.getKeyboardHeight()};d.prototype.getWidth=function(){var a=f.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskWidth)return a.getOskWidth();if("iOS"==b.OS)var e=window.innerWidth;else if("Android"==b.OS)try{e=document.documentElement.clientWidth}catch(c){e=
screen.availWidth}else e=screen.width;return e};d.prototype.doResizeMove=function(a){return f.keyman.singleton.util.callEvent("osk.resizemove",a)};d.prototype.getRect=function(){var a={};this.vkbd?(a.left=a.left=g.dom.Utils.getAbsoluteX(this.vkbd.kbdDiv),a.top=a.top=g.dom.Utils.getAbsoluteY(this.vkbd.kbdDiv),a.width=a.width=g.dom.Utils.getAbsoluteX(this.vkbd.kbdHelpDiv)-g.dom.Utils.getAbsoluteX(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetWidth,a.height=a.height=g.dom.Utils.getAbsoluteY(this.vkbd.kbdHelpDiv)-
g.dom.Utils.getAbsoluteY(this.vkbd.kbdDiv)+this.vkbd.kbdHelpDiv.offsetHeight):(a.left=a.left=g.dom.Utils.getAbsoluteX(this._Box),a.top=a.top=g.dom.Utils.getAbsoluteY(this._Box),a.width=a.width=g.dom.Utils.getAbsoluteX(this._Box)+this._Box.offsetWidth,a.height=a.height=g.dom.Utils.getAbsoluteY(this._Box)+this._Box.offsetHeight);return a};d.prototype.setRect=function(a){var b=f.keyman.singleton.util;if(null!=this._Box&&"desktop"==b.device.formFactor){b=this._Box;var e=b.style;"left"in a&&(e.left=a.left-
g.dom.Utils.getAbsoluteX(b)+b.offsetLeft+"px",this.dfltX=e.left);"top"in a&&(e.top=a.top-g.dom.Utils.getAbsoluteY(b)+b.offsetTop+"px",this.dfltY=e.top);if(null!=this.vkbd){var c=this.vkbd.kbdDiv;e=c.style;if("width"in a){var d=a.width-(b.offsetWidth-c.offsetWidth);d<.2*screen.width&&(d=.2*screen.width);d>.9*screen.width&&(d=.9*screen.width);e.width=d+"px";this.width=d}"height"in a&&(b=a.height-(b.offsetHeight-c.offsetHeight),b<.1*screen.height&&(b=.1*screen.height),b>.5*screen.height&&(b=.5*screen.height),
e.height=b+"px",e.fontSize=b/8+"px",this.height=b);"nosize"in a&&this.resizeIcon&&(this.resizeIcon.style.display=a.nosize?"none":"block")}"nomove"in a&&(this.noDrag=a.nomove,this.pinImg&&(this.pinImg.style.display=a.nomove||!this.userPositioned?"none":"block"));this.saveCookie()}};d.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:this.x,top:this._Visible?a.offsetTop:this.y}};d.prototype.setPos=function(a){if("undefined"!=typeof this._Box&&!f.keyman.singleton.util.device.touchable){if(this.userPositioned){var b=
a.left;a=a.top;"undefined"!=typeof b&&(b<-.8*this._Box.offsetWidth&&(b=-.8*this._Box.offsetWidth),this.userPositioned&&(this._Box.style.left=b+"px",this.x=b));"undefined"!=typeof a&&(0>a&&(a=0),this.userPositioned&&(this._Box.style.top=a+"px",this.y=a))}this.pinImg&&(this.pinImg.style.display=this.userPositioned?"block":"none")}};d.prototype._Show=function(a,b){var e=f.keyman.singleton,c=e.util.device;if(null!=this._Box&&null!=e.domManager.getActiveElement()&&(c.touchable||null!=e.keyboardManager.activeKeyboard&&
this._Enabled)){var d=this._Box.style;c.touchable&&""==d.bottom&&(d.visibility="hidden");c.touchable&&(d.opacity="1");if(this.vkbd&&this.vkbd.ddOSK&&(this.vkbd.show(),c.touchable)){d.position="fixed";d.left=d.bottom="0px";var h=this.vkbd.kbdDiv.firstChild.style.height;h=h.substr(0,h.indexOf("px"));d.height=d.maxHeight=this.getBannerHeight()+parseInt(h,10)+5+"px";d.border="none";d.borderTop="1px solid gray";this._Visible=this._Enabled=!0}d.display="block";this.vkbd&&this.vkbd.showLanguage();"desktop"==
c.formFactor&&(d.position="absolute",d.display="block",d.left="0px",this.loadCookie(),0<=a?(d.left=a+"px",d.top=b+"px"):this.userPositioned?(d.left=this.x+"px",d.top=this.y+"px"):(a=e.domManager.getActiveElement(),this.dfltX?d.left=this.dfltX:"undefined"!=typeof a&&null!=a&&(d.left=g.dom.Utils.getAbsoluteX(a)+"px"),this.dfltY?d.top=this.dfltY:"undefined"!=typeof a&&null!=a&&(d.top=g.dom.Utils.getAbsoluteY(a)+a.offsetHeight+"px")),this._Visible=this._Enabled=!0,this.vkbd&&this.vkbd.kbdDiv&&(this.width=
this.vkbd.kbdDiv.offsetWidth,this.height=this.vkbd.kbdDiv.offsetHeight),this.saveCookie(),a=this.pinImg,"undefined"!=typeof a&&null!=a&&(a.style.display=this.userPositioned?"block":"none"));"hidden"==d.visibility&&window.setTimeout(function(){this._Box.style.visibility="visible"}.bind(this),0);c.touchable||(c={},c.x=this._Box.offsetLeft,c.y=this._Box.offsetTop,c.userLocated=this.userPositioned,this.doShow(c))}};d.prototype._Hide=function(a){var b=f.keyman.singleton,e=b.util.device;this._Box&&"block"==
this._Box.style.display&&this.vkbd&&this.vkbd.kbdDiv&&(this.width=this.vkbd.kbdDiv.offsetWidth,this.height=this.vkbd.kbdDiv.offsetHeight);if(a)this._Enabled=b.keyboardManager.isCJK()||e.touchable?!0:!1,this.saveCookie();else if("desktop"==e.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;this._Visible=!1;this._Box&&e.touchable&&0<this._Box.offsetHeight?(e=this._Box.style,e.transition="string"==typeof e.MozBoxSizing?"opacity 0.8s linear":e.msTransition=e.WebkitTransition=
"opacity 0.5s linear 0",window.setTimeout(function(){var a=this._Box.style;this._Visible?a.transition=a.msTransition=a.MozTransition=a.WebkitTransition="":(a.opacity="0",this._Box.addEventListener("transitionend",this.hideNow,!1),this._Box.addEventListener("webkitTransitionEnd",this.hideNow,!1))}.bind(this),200)):this._Box&&(this._Box.style.display="none");e={};e.HiddenByUser=a;this.doHide(e);a&&b.domManager.focusLastActiveElement()};d.prototype.hide=function(){this._Enabled=!1;this._Hide(!0)};d.prototype.doShow=
function(a){return f.keyman.singleton.util.callEvent("osk.show",a)};d.prototype.doHide=function(a){return f.keyman.singleton.util.callEvent("osk.hide",a)};d.prototype.showLanguageMenu=function(){(new h.LanguageMenu(f.keyman.singleton)).show()};d.prototype.userLocated=function(){return this.userPositioned};d.prototype.show=function(a){0<arguments.length?(this._Enabled=a)?this._Show():this._Hide(!0):this._Visible?this._Hide(!0):this._Show()};d.prototype.addEventListener=function(a,b){return f.keyman.singleton.util.addEventListener("osk."+
a,b)};d.prototype.shutdown=function(){var a=this._Box;a.parentElement&&a.parentElement.removeChild(a)};return d}();h.OSKManager=l})(g.osk||(g.osk={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
function LMLayerWorkerCode(){var f;(function(a){var b=function(){function a(a){a=a||{};this._futureSuggestions=a.futureSuggestions?a.futureSuggestions.slice():[];a.punctuation&&(this.punctuation=a.punctuation)}a.prototype.configure=function(a){return this.configuration={leftContextCodeUnits:a.maxLeftContextCodeUnits,rightContextCodeUnits:a.maxRightContextCodeUnits}};a.prototype.predict=function(a,b,c){a=function(a){for(var b=[],c=0;c<a.length;c++)b.push({sample:a[c],p:1});return b};return c?a(c):
(c=this._futureSuggestions.shift())?a(c):[]};a.prototype.wordbreak=function(a){a=g.default_(a.left);return 0<a.length?a.pop().text:""};return a}();a.DummyModel=b})(f||(f={}));var g;(function(a){var b=function(){function a(a,b){this.text=a;this.start=b}Object.defineProperty(a.prototype,"length",{get:function(){return this.text.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"end",{get:function(){return this.start+this.text.length},enumerable:!0,configurable:!0});return a}();
a.ascii=function(a){for(var c=/[A-Za-z0-9']+/g,e=[],d;null!==(d=c.exec(a));)e.push(new b(d[0],d.index));return e}})(g||(g={}));var h=function(){function a(b){this.lexicalModel=b;this.punctuation=a.determinePunctuationFromModel(b)}a.prototype.isWhitespace=function(a){if(""==a.insert)return!1;a=a.insert;a=a.replace(/.*[\u0009\u000A\u000D\u0020\u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u202f\u205f\u3000]/i,"");return""==a};a.prototype.isBackspace=
function(a){return""==a.insert&&0<a.deleteLeft};a.prototype.predict=function(b,c){var e=[],d=this.punctuation,g={};b instanceof Array||(b=[{sample:b,p:1}]);var h=b.sort(function(a,b){return b.p-a.p})[0].sample,l=this.isWhitespace(h),m=this.isBackspace(h),q=f.applyTransform(h,c),r=this.lexicalModel.wordbreak(q),t=null;q=function(a){var b=a.sample;if(w.isWhitespace(b)&&!l||w.isBackspace(b)&&!m)return"continue";var e=!1;if(w.isWhitespace(b)){var h=f.applyTransform(b,c);e=""==w.lexicalModel.wordbreak(h)}w.lexicalModel.predict(b,
c).forEach(function(c){void 0!==b.id&&(c.sample.transformId=b.id);e&&f.prependTransform(c.sample.transform,b);0<c.sample.transform.insert.length&&(c.sample.transform.insert+=d.insertAfterWord);var h=c.sample.displayAs;if(h==r)t=c.sample,t.tag="keep";else{var k=g[h];k?k.p+=c.p*a.p:g[h]={sample:c.sample,p:c.p*a.p}}})};for(var w=this,z=0;z<b.length;z++)q(b[z]);t||""==r||(t={displayAs:r,transformId:h.id,transform:{insert:h.insert+d.insertAfterWord,deleteLeft:h.deleteLeft,deleteRight:h.deleteRight,id:h.id},
tag:"keep"});t&&(h=d.quotesForKeepSuggestion,t.displayAs=h.open+t.displayAs+h.close);for(var C in g)e.push(g[C]);e=e.sort(function(a,b){return b.p-a.p});e=e.splice(0,a.MAX_SUGGESTIONS).map(function(a){return a.sample});t&&(e=[t].concat(e));return e};a.determinePunctuationFromModel=function(a){var b=l;if(!a.punctuation)return b;var e=a.punctuation;a=e.insertAfterWord;""===a||a||(a=b.insertAfterWord);e=e.quotesForKeepSuggestion;e||(e=b.quotesForKeepSuggestion);return{insertAfterWord:a,quotesForKeepSuggestion:e}};
a.MAX_SUGGESTIONS=12;return a}(),l={quotesForKeepSuggestion:{open:"\u201c",close:"\u201d"},insertAfterWord:" "},d=this&&this.__assign||function(){d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&(a[f]=b[f])}return a};return d.apply(this,arguments)},a=function(){function a(a){void 0===a&&(a={importScripts:null,postMessage:null});this._postMessage=a.postMessage||postMessage;this._importScripts=a.importScripts||
importScripts;this.setupConfigState()}a.prototype.onMessage=function(a){if(!a.data.message)throw Error("Missing required 'message' property: "+a.data);a=a.data;if("load"==a.message){if(a.model==this._currentModelSource){console.warn("Duplicate model load message detected - squashing!");return}this._currentModelSource=a.model}else"unload"==a.message&&(this._currentModelSource=null);this.state.handleMessage(a)};a.prototype.cast=function(a,b){var c=this._postMessage;c(d({message:a},b))};a.prototype.loadModel=
function(a){var b=a.configure(this._platformCapabilities);b.leftContextCodeUnits||(b.leftContextCodeUnits=this._platformCapabilities.maxLeftContextCodeUnits);b.rightContextCodeUnits||(b.rightContextCodeUnits=this._platformCapabilities.maxRightContextCodeUnits||0);this.transitionToReadyState(a);this.cast("ready",{configuration:b})};a.prototype.loadModelFile=function(a){this._importScripts(a)};a.prototype.unloadModel=function(){this.transitionToLoadingState()};a.prototype.setupConfigState=function(){var a=
this;this.state={name:"unconfigured",handleMessage:function(b){if("config"!==b.message)throw Error("invalid message; expected 'config' but got "+b.message);a._platformCapabilities=b.capabilities;a.transitionToLoadingState()}}};a.prototype.transitionToLoadingState=function(){var a=this;this.state={name:"modelless",handleMessage:function(b){if("load"!==b.message)throw Error("invalid message; expected 'load' but got "+b.message);a.loadModelFile(b.model)}}};a.prototype.transitionToReadyState=function(a){var b=
this;this.state={name:"ready",handleMessage:function(c){switch(c.message){case "predict":var e=c.transform,d=c.context;e=(new h(a)).predict(e,d);b.cast("suggestions",{token:c.token,suggestions:e});break;case "wordbreak":e=a.wordbreak(c.context);b.cast("currentword",{token:c.token,word:e});break;case "unload":b.unloadModel();break;default:throw Error("invalid message; expected one of {'predict', 'unload'} but got "+c.message);}}}};a.install=function(b){var c=new a({postMessage:b.postMessage,importScripts:b.importScripts.bind(b)});
b.onmessage=c.onMessage.bind(c);b.LMLayerWorker=c;b.models=f;b.wordBreakers=g;return c};return a}();"undefined"!==typeof module&&"undefined"!==typeof module.exports?(module.exports=a,module.exports.models=f,module.exports.wordBreakers=g,module.exports.ModelCompositor=h):"undefined"!==typeof self&&"postMessage"in self?a.install(self):window.LMLayerWorker=a;(function(a){a.applyTransform=function(a,b){var c=b.left||"",e=c.length;c=c.substring(0,e-(e<a.deleteLeft?e:a.deleteLeft))+(a.insert||"");e=b.right||
"";var d=e.length;a=e.substring(d<a.deleteRight?d:a.deleteRight);return{left:c,right:a,startOfBuffer:b.startOfBuffer,endOfBuffer:b.endOfBuffer}};a.prependTransform=function(a,b){a.insert=b.insert+a.insert;a.deleteLeft+=b.deleteLeft;b.deleteRight&&(a.deleteRight=(a.deleteRight||0)+b.deleteRight)}})(f||(f={}));(function(a){a.placeholder=function(a){var b=0;return a.split(/\s+/).map(function(a){a={start:b,end:b+a.length,text:a,length:a.length};b=a.end;return a})}})(g||(g={}));(function(a){function b(a,
c,e){void 0===e&&(e=0);if("leaf"===a.type||e===c.length)return a;var d=c[e];return a.children[d]?b(a.children[d],c,e+1):null}function c(a,b,c,e){void 0===e&&(e=12);var d=new l,f=[];if("leaf"===a.type){var g=0;for(a=a.entries;g<a.length;g++){var h=a[g];if(h.key.startsWith(b)&&(f.push({text:h.content,p:h.weight/c}),f.length>=e))break}}else{d.enqueue(a);var k=void 0;b=function(){if("type"in k)if("leaf"===k.type)d.enqueueAll(k.entries);else{var a=k;d.enqueueAll(k.values.map(function(b){return a.children[b]}))}else if(f.push({text:k.content,
p:k.weight/c}),f.length>=e)return{value:f}};for(;k=d.pop();)if(g=b(),"object"===typeof g)return g.value}return f}function d(a){return a.replace(/[\u0100-\u2200]/g,function(a){return a in v?v[a]:a}).toLowerCase()}var f=function(){function b(a,b){void 0===b&&(b={});this._trie=new h(a.root,a.totalWeight,b.searchTermToKey||d);this.breakWords=b.wordBreaker||g.placeholder;this.punctuation=b.punctuation}b.prototype.configure=function(a){return this.configuration={leftContextCodeUnits:a.maxLeftContextCodeUnits,
rightContextCodeUnits:a.maxRightContextCodeUnits}};b.prototype.predict=function(b,c){function e(a){for(var b=[],c=0;c<a.length;c++){var e=a[c];b.push({sample:e,p:e.p})}return b}if(!b.insert&&c.startOfBuffer&&c.endOfBuffer)return e(this._trie.firstN(12).map(function(a){var b=a.text;return{transform:{insert:b,deleteLeft:0},displayAs:b,p:a.p}}));c=a.applyTransform(b,c);var d=b.deleteLeft-b.insert.length,f=this.getLastWord(c.left);return e(this._trie.lookup(f).map(function(a){var b=a.text;return{transform:{insert:b,
deleteLeft:d+f.length},displayAs:b,p:a.p}}))};b.prototype.getLastWord=function(a){a=this.breakWords(a);return 0<a.length?a.pop().text:""};b.prototype.wordbreak=function(a){return this.getLastWord(a.left)};return b}();a.TrieModel=f;var h=function(){function a(a,b,c){this.root=a;this.toKey=c;this.totalWeight=b}a.prototype.lookup=function(a){a=this.toKey(a);var e=b(this.root,a);return null===e?[]:c(e,a,this.totalWeight)};a.prototype.firstN=function(a){return c(this.root,"",this.totalWeight,a)};return a}(),
l=function(){function a(){this._storage=[]}a.prototype.enqueue=function(a){this._storage.push(a)};a.prototype.enqueueAll=function(a){this._storage=this._storage.concat(a)};a.prototype.pop=function(){this._storage.sort(function(a,b){return b.weight-a.weight});return this._storage.shift()};return a}(),v={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00c7":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00d1":"N",
"\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00e7":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a",
"\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u011d":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I",
"\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u015f":"s","\u0160":"S",
"\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U",
"\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u01de":"A","\u01df":"a","\u01e0":"A","\u01e1":"a","\u01e2":"\u00c6","\u01e3":"\u00e6","\u01e6":"G","\u01e7":"g","\u01e8":"K","\u01e9":"k","\u01ea":"O","\u01eb":"o","\u01ec":"O","\u01ed":"o","\u01ee":"\u01b7","\u01ef":"\u0292","\u01f0":"j","\u01f4":"G","\u01f5":"g","\u01f8":"N","\u01f9":"n","\u01fa":"A","\u01fb":"a","\u01fc":"\u00c6","\u01fd":"\u00e6","\u01fe":"\u00d8","\u01ff":"\u00f8",
"\u0200":"A","\u0201":"a","\u0202":"A","\u0203":"a","\u0204":"E","\u0205":"e","\u0206":"E","\u0207":"e","\u0208":"I","\u0209":"i","\u020a":"I","\u020b":"i","\u020c":"O","\u020d":"o","\u020e":"O","\u020f":"o","\u0210":"R","\u0211":"r","\u0212":"R","\u0213":"r","\u0214":"U","\u0215":"u","\u0216":"U","\u0217":"u","\u0218":"S","\u0219":"s","\u021a":"T","\u021b":"t","\u021e":"H","\u021f":"h","\u0226":"A","\u0227":"a","\u0228":"E","\u0229":"e","\u022a":"O","\u022b":"o","\u022c":"O","\u022d":"o","\u022e":"O",
"\u022f":"o","\u0230":"O","\u0231":"o","\u0232":"Y","\u0233":"y","\u0340":"\u0300","\u0341":"\u0301","\u0343":"\u0313","\u0344":"\u0308","\u0374":"\u02b9","\u037e":";","\u0385":"\u00a8","\u0386":"\u0391","\u0387":"\u00b7","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u038f":"\u03a9","\u0390":"\u03b9","\u03aa":"\u0399","\u03ab":"\u03a5","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03b0":"\u03c5","\u03ca":"\u03b9","\u03cb":"\u03c5",
"\u03cc":"\u03bf","\u03cd":"\u03c5","\u03ce":"\u03c9","\u03d3":"\u03d2","\u03d4":"\u03d2","\u0400":"\u0415","\u0401":"\u0415","\u0403":"\u0413","\u0407":"\u0406","\u040c":"\u041a","\u040d":"\u0418","\u040e":"\u0423","\u0419":"\u0418","\u0439":"\u0438","\u0450":"\u0435","\u0451":"\u0435","\u0453":"\u0433","\u0457":"\u0456","\u045c":"\u043a","\u045d":"\u0438","\u045e":"\u0443","\u0476":"\u0474","\u0477":"\u0475","\u04c1":"\u0416","\u04c2":"\u0436","\u04d0":"\u0410","\u04d1":"\u0430","\u04d2":"\u0410",
"\u04d3":"\u0430","\u04d6":"\u0415","\u04d7":"\u0435","\u04da":"\u04d8","\u04db":"\u04d9","\u04dc":"\u0416","\u04dd":"\u0436","\u04de":"\u0417","\u04df":"\u0437","\u04e2":"\u0418","\u04e3":"\u0438","\u04e4":"\u0418","\u04e5":"\u0438","\u04e6":"\u041e","\u04e7":"\u043e","\u04ea":"\u04e8","\u04eb":"\u04e9","\u04ec":"\u042d","\u04ed":"\u044d","\u04ee":"\u0423","\u04ef":"\u0443","\u04f0":"\u0423","\u04f1":"\u0443","\u04f2":"\u0423","\u04f3":"\u0443","\u04f4":"\u0427","\u04f5":"\u0447","\u04f8":"\u042b",
"\u04f9":"\u044b","\u1e00":"A","\u1e01":"a","\u1e02":"B","\u1e03":"b","\u1e04":"B","\u1e05":"b","\u1e06":"B","\u1e07":"b","\u1e08":"C","\u1e09":"c","\u1e0a":"D","\u1e0b":"d","\u1e0c":"D","\u1e0d":"d","\u1e0e":"D","\u1e0f":"d","\u1e10":"D","\u1e11":"d","\u1e12":"D","\u1e13":"d","\u1e14":"E","\u1e15":"e","\u1e16":"E","\u1e17":"e","\u1e18":"E","\u1e19":"e","\u1e1a":"E","\u1e1b":"e","\u1e1c":"E","\u1e1d":"e","\u1e1e":"F","\u1e1f":"f","\u1e20":"G","\u1e21":"g","\u1e22":"H","\u1e23":"h","\u1e24":"H","\u1e25":"h",
"\u1e26":"H","\u1e27":"h","\u1e28":"H","\u1e29":"h","\u1e2a":"H","\u1e2b":"h","\u1e2c":"I","\u1e2d":"i","\u1e2e":"I","\u1e2f":"i","\u1e30":"K","\u1e31":"k","\u1e32":"K","\u1e33":"k","\u1e34":"K","\u1e35":"k","\u1e36":"L","\u1e37":"l","\u1e38":"L","\u1e39":"l","\u1e3a":"L","\u1e3b":"l","\u1e3c":"L","\u1e3d":"l","\u1e3e":"M","\u1e3f":"m","\u1e40":"M","\u1e41":"m","\u1e42":"M","\u1e43":"m","\u1e44":"N","\u1e45":"n","\u1e46":"N","\u1e47":"n","\u1e48":"N","\u1e49":"n","\u1e4a":"N","\u1e4b":"n","\u1e4c":"O",
"\u1e4d":"o","\u1e4e":"O","\u1e4f":"o","\u1e50":"O","\u1e51":"o","\u1e52":"O","\u1e53":"o","\u1e54":"P","\u1e55":"p","\u1e56":"P","\u1e57":"p","\u1e58":"R","\u1e59":"r","\u1e5a":"R","\u1e5b":"r","\u1e5c":"R","\u1e5d":"r","\u1e5e":"R","\u1e5f":"r","\u1e60":"S","\u1e61":"s","\u1e62":"S","\u1e63":"s","\u1e64":"S","\u1e65":"s","\u1e66":"S","\u1e67":"s","\u1e68":"S","\u1e69":"s","\u1e6a":"T","\u1e6b":"t","\u1e6c":"T","\u1e6d":"t","\u1e6e":"T","\u1e6f":"t","\u1e70":"T","\u1e71":"t","\u1e72":"U","\u1e73":"u",
"\u1e74":"U","\u1e75":"u","\u1e76":"U","\u1e77":"u","\u1e78":"U","\u1e79":"u","\u1e7a":"U","\u1e7b":"u","\u1e7c":"V","\u1e7d":"v","\u1e7e":"V","\u1e7f":"v","\u1e80":"W","\u1e81":"w","\u1e82":"W","\u1e83":"w","\u1e84":"W","\u1e85":"w","\u1e86":"W","\u1e87":"w","\u1e88":"W","\u1e89":"w","\u1e8a":"X","\u1e8b":"x","\u1e8c":"X","\u1e8d":"x","\u1e8e":"Y","\u1e8f":"y","\u1e90":"Z","\u1e91":"z","\u1e92":"Z","\u1e93":"z","\u1e94":"Z","\u1e95":"z","\u1e96":"h","\u1e97":"t","\u1e98":"w","\u1e99":"y","\u1e9b":"\u017f",
"\u1ea0":"A","\u1ea1":"a","\u1ea2":"A","\u1ea3":"a","\u1ea4":"A","\u1ea5":"a","\u1ea6":"A","\u1ea7":"a","\u1ea8":"A","\u1ea9":"a","\u1eaa":"A","\u1eab":"a","\u1eac":"A","\u1ead":"a","\u1eae":"A","\u1eaf":"a","\u1eb0":"A","\u1eb1":"a","\u1eb2":"A","\u1eb3":"a","\u1eb4":"A","\u1eb5":"a","\u1eb6":"A","\u1eb7":"a","\u1eb8":"E","\u1eb9":"e","\u1eba":"E","\u1ebb":"e","\u1ebc":"E","\u1ebd":"e","\u1ebe":"E","\u1ebf":"e","\u1ec0":"E","\u1ec1":"e","\u1ec2":"E","\u1ec3":"e","\u1ec4":"E","\u1ec5":"e","\u1ec6":"E",
"\u1ec7":"e","\u1ec8":"I","\u1ec9":"i","\u1eca":"I","\u1ecb":"i","\u1ecc":"O","\u1ecd":"o","\u1ece":"O","\u1ecf":"o","\u1ed0":"O","\u1ed1":"o","\u1ed2":"O","\u1ed3":"o","\u1ed4":"O","\u1ed5":"o","\u1ed6":"O","\u1ed7":"o","\u1ed8":"O","\u1ed9":"o","\u1eda":"O","\u1edb":"o","\u1edc":"O","\u1edd":"o","\u1ede":"O","\u1edf":"o","\u1ee0":"O","\u1ee1":"o","\u1ee2":"O","\u1ee3":"o","\u1ee4":"U","\u1ee5":"u","\u1ee6":"U","\u1ee7":"u","\u1ee8":"U","\u1ee9":"u","\u1eea":"U","\u1eeb":"u","\u1eec":"U","\u1eed":"u",
"\u1eee":"U","\u1eef":"u","\u1ef0":"U","\u1ef1":"u","\u1ef2":"Y","\u1ef3":"y","\u1ef4":"Y","\u1ef5":"y","\u1ef6":"Y","\u1ef7":"y","\u1ef8":"Y","\u1ef9":"y","\u1f00":"\u03b1","\u1f01":"\u03b1","\u1f02":"\u03b1","\u1f03":"\u03b1","\u1f04":"\u03b1","\u1f05":"\u03b1","\u1f06":"\u03b1","\u1f07":"\u03b1","\u1f08":"\u0391","\u1f09":"\u0391","\u1f0a":"\u0391","\u1f0b":"\u0391","\u1f0c":"\u0391","\u1f0d":"\u0391","\u1f0e":"\u0391","\u1f0f":"\u0391","\u1f10":"\u03b5","\u1f11":"\u03b5","\u1f12":"\u03b5","\u1f13":"\u03b5",
"\u1f14":"\u03b5","\u1f15":"\u03b5","\u1f18":"\u0395","\u1f19":"\u0395","\u1f1a":"\u0395","\u1f1b":"\u0395","\u1f1c":"\u0395","\u1f1d":"\u0395","\u1f20":"\u03b7","\u1f21":"\u03b7","\u1f22":"\u03b7","\u1f23":"\u03b7","\u1f24":"\u03b7","\u1f25":"\u03b7","\u1f26":"\u03b7","\u1f27":"\u03b7","\u1f28":"\u0397","\u1f29":"\u0397","\u1f2a":"\u0397","\u1f2b":"\u0397","\u1f2c":"\u0397","\u1f2d":"\u0397","\u1f2e":"\u0397","\u1f2f":"\u0397","\u1f30":"\u03b9","\u1f31":"\u03b9","\u1f32":"\u03b9","\u1f33":"\u03b9",
"\u1f34":"\u03b9","\u1f35":"\u03b9","\u1f36":"\u03b9","\u1f37":"\u03b9","\u1f38":"\u0399","\u1f39":"\u0399","\u1f3a":"\u0399","\u1f3b":"\u0399","\u1f3c":"\u0399","\u1f3d":"\u0399","\u1f3e":"\u0399","\u1f3f":"\u0399","\u1f40":"\u03bf","\u1f41":"\u03bf","\u1f42":"\u03bf","\u1f43":"\u03bf","\u1f44":"\u03bf","\u1f45":"\u03bf","\u1f48":"\u039f","\u1f49":"\u039f","\u1f4a":"\u039f","\u1f4b":"\u039f","\u1f4c":"\u039f","\u1f4d":"\u039f","\u1f50":"\u03c5","\u1f51":"\u03c5","\u1f52":"\u03c5","\u1f53":"\u03c5",
"\u1f54":"\u03c5","\u1f55":"\u03c5","\u1f56":"\u03c5","\u1f57":"\u03c5","\u1f59":"\u03a5","\u1f5b":"\u03a5","\u1f5d":"\u03a5","\u1f5f":"\u03a5","\u1f60":"\u03c9","\u1f61":"\u03c9","\u1f62":"\u03c9","\u1f63":"\u03c9","\u1f64":"\u03c9","\u1f65":"\u03c9","\u1f66":"\u03c9","\u1f67":"\u03c9","\u1f68":"\u03a9","\u1f69":"\u03a9","\u1f6a":"\u03a9","\u1f6b":"\u03a9","\u1f6c":"\u03a9","\u1f6d":"\u03a9","\u1f6e":"\u03a9","\u1f6f":"\u03a9","\u1f70":"\u03b1","\u1f71":"\u03b1","\u1f72":"\u03b5","\u1f73":"\u03b5",
"\u1f74":"\u03b7","\u1f75":"\u03b7","\u1f76":"\u03b9","\u1f77":"\u03b9","\u1f78":"\u03bf","\u1f79":"\u03bf","\u1f7a":"\u03c5","\u1f7b":"\u03c5","\u1f7c":"\u03c9","\u1f7d":"\u03c9","\u1f80":"\u03b1","\u1f81":"\u03b1","\u1f82":"\u03b1","\u1f83":"\u03b1","\u1f84":"\u03b1","\u1f85":"\u03b1","\u1f86":"\u03b1","\u1f87":"\u03b1","\u1f88":"\u0391","\u1f89":"\u0391","\u1f8a":"\u0391","\u1f8b":"\u0391","\u1f8c":"\u0391","\u1f8d":"\u0391","\u1f8e":"\u0391","\u1f8f":"\u0391","\u1f90":"\u03b7","\u1f91":"\u03b7",
"\u1f92":"\u03b7","\u1f93":"\u03b7","\u1f94":"\u03b7","\u1f95":"\u03b7","\u1f96":"\u03b7","\u1f97":"\u03b7","\u1f98":"\u0397","\u1f99":"\u0397","\u1f9a":"\u0397","\u1f9b":"\u0397","\u1f9c":"\u0397","\u1f9d":"\u0397","\u1f9e":"\u0397","\u1f9f":"\u0397","\u1fa0":"\u03c9","\u1fa1":"\u03c9","\u1fa2":"\u03c9","\u1fa3":"\u03c9","\u1fa4":"\u03c9","\u1fa5":"\u03c9","\u1fa6":"\u03c9","\u1fa7":"\u03c9","\u1fa8":"\u03a9","\u1fa9":"\u03a9","\u1faa":"\u03a9","\u1fab":"\u03a9","\u1fac":"\u03a9","\u1fad":"\u03a9",
"\u1fae":"\u03a9","\u1faf":"\u03a9","\u1fb0":"\u03b1","\u1fb1":"\u03b1","\u1fb2":"\u03b1","\u1fb3":"\u03b1","\u1fb4":"\u03b1","\u1fb6":"\u03b1","\u1fb7":"\u03b1","\u1fb8":"\u0391","\u1fb9":"\u0391","\u1fba":"\u0391","\u1fbb":"\u0391","\u1fbc":"\u0391","\u1fbe":"\u03b9","\u1fc1":"\u00a8","\u1fc2":"\u03b7","\u1fc3":"\u03b7","\u1fc4":"\u03b7","\u1fc6":"\u03b7","\u1fc7":"\u03b7","\u1fc8":"\u0395","\u1fc9":"\u0395","\u1fca":"\u0397","\u1fcb":"\u0397","\u1fcc":"\u0397","\u1fcd":"\u1fbf","\u1fce":"\u1fbf",
"\u1fcf":"\u1fbf","\u1fd0":"\u03b9","\u1fd1":"\u03b9","\u1fd2":"\u03b9","\u1fd3":"\u03b9","\u1fd6":"\u03b9","\u1fd7":"\u03b9","\u1fd8":"\u0399","\u1fd9":"\u0399","\u1fda":"\u0399","\u1fdb":"\u0399","\u1fdd":"\u1ffe","\u1fde":"\u1ffe","\u1fdf":"\u1ffe","\u1fe0":"\u03c5","\u1fe1":"\u03c5","\u1fe2":"\u03c5","\u1fe3":"\u03c5","\u1fe4":"\u03c1","\u1fe5":"\u03c1","\u1fe6":"\u03c5","\u1fe7":"\u03c5","\u1fe8":"\u03a5","\u1fe9":"\u03a5","\u1fea":"\u03a5","\u1feb":"\u03a5","\u1fec":"\u03a1","\u1fed":"\u00a8",
"\u1fee":"\u00a8","\u1fef":"`","\u1ff2":"\u03c9","\u1ff3":"\u03c9","\u1ff4":"\u03c9","\u1ff6":"\u03c9","\u1ff7":"\u03c9","\u1ff8":"\u039f","\u1ff9":"\u039f","\u1ffa":"\u03a9","\u1ffb":"\u03a9","\u1ffc":"\u03a9","\u1ffd":"\u00b4","\u2000":"\u2002","\u2001":"\u2003","\u2126":"\u03a9","\u212a":"K","\u212b":"A"}})(f||(f={}));(function(a){(a.data||(a.data={})).WORD_BREAK_PROPERTY=[[10,10,1],[11,12,2],[13,13,3],[32,32,4],[34,34,5],[39,39,6],[44,44,7],[46,46,8],[48,57,9],[58,58,10],[59,59,7],[65,90,11],
[95,95,12],[97,122,11],[133,133,2],[170,170,11],[173,173,13],[181,181,11],[183,183,10],[186,186,11],[192,214,11],[216,246,11],[248,442,11],[443,443,11],[444,447,11],[448,451,11],[452,659,11],[660,660,11],[661,687,11],[688,705,11],[706,709,11],[710,721,11],[722,727,11],[734,735,11],[736,740,11],[748,748,11],[749,749,11],[750,750,11],[751,767,11],[768,879,14],[880,883,11],[884,884,11],[886,887,11],[890,890,11],[891,893,11],[894,894,7],[895,895,11],[902,902,11],[903,903,10],[904,906,11],[908,908,11],
[910,929,11],[931,1013,11],[1015,1153,11],[1155,1159,14],[1160,1161,14],[1162,1327,11],[1329,1366,11],[1369,1369,11],[1371,1372,11],[1374,1374,11],[1376,1416,11],[1417,1417,7],[1425,1469,14],[1471,1471,14],[1473,1474,14],[1476,1477,14],[1479,1479,14],[1488,1514,15],[1519,1522,15],[1523,1523,11],[1524,1524,10],[1536,1541,13],[1548,1549,7],[1552,1562,14],[1564,1564,13],[1568,1599,11],[1600,1600,11],[1601,1610,11],[1611,1631,14],[1632,1641,9],[1643,1643,9],[1644,1644,7],[1646,1647,11],[1648,1648,14],
[1649,1747,11],[1749,1749,11],[1750,1756,14],[1757,1757,13],[1759,1764,14],[1765,1766,11],[1767,1768,14],[1770,1773,14],[1774,1775,11],[1776,1785,9],[1786,1788,11],[1791,1791,11],[1807,1807,13],[1808,1808,11],[1809,1809,14],[1810,1839,11],[1840,1866,14],[1869,1957,11],[1958,1968,14],[1969,1969,11],[1984,1993,9],[1994,2026,11],[2027,2035,14],[2036,2037,11],[2040,2040,7],[2042,2042,11],[2045,2045,14],[2048,2069,11],[2070,2073,14],[2074,2074,11],[2075,2083,14],[2084,2084,11],[2085,2087,14],[2088,2088,
11],[2089,2093,14],[2112,2136,11],[2137,2139,14],[2144,2154,11],[2208,2228,11],[2230,2237,11],[2259,2273,14],[2274,2274,13],[2275,2306,14],[2307,2307,14],[2308,2361,11],[2362,2362,14],[2363,2363,14],[2364,2364,14],[2365,2365,11],[2366,2368,14],[2369,2376,14],[2377,2380,14],[2381,2381,14],[2382,2383,14],[2384,2384,11],[2385,2391,14],[2392,2401,11],[2402,2403,14],[2406,2415,9],[2417,2417,11],[2418,2432,11],[2433,2433,14],[2434,2435,14],[2437,2444,11],[2447,2448,11],[2451,2472,11],[2474,2480,11],[2482,
2482,11],[2486,2489,11],[2492,2492,14],[2493,2493,11],[2494,2496,14],[2497,2500,14],[2503,2504,14],[2507,2508,14],[2509,2509,14],[2510,2510,11],[2519,2519,14],[2524,2525,11],[2527,2529,11],[2530,2531,14],[2534,2543,9],[2544,2545,11],[2556,2556,11],[2558,2558,14],[2561,2562,14],[2563,2563,14],[2565,2570,11],[2575,2576,11],[2579,2600,11],[2602,2608,11],[2610,2611,11],[2613,2614,11],[2616,2617,11],[2620,2620,14],[2622,2624,14],[2625,2626,14],[2631,2632,14],[2635,2637,14],[2641,2641,14],[2649,2652,11],
[2654,2654,11],[2662,2671,9],[2672,2673,14],[2674,2676,11],[2677,2677,14],[2689,2690,14],[2691,2691,14],[2693,2701,11],[2703,2705,11],[2707,2728,11],[2730,2736,11],[2738,2739,11],[2741,2745,11],[2748,2748,14],[2749,2749,11],[2750,2752,14],[2753,2757,14],[2759,2760,14],[2761,2761,14],[2763,2764,14],[2765,2765,14],[2768,2768,11],[2784,2785,11],[2786,2787,14],[2790,2799,9],[2809,2809,11],[2810,2815,14],[2817,2817,14],[2818,2819,14],[2821,2828,11],[2831,2832,11],[2835,2856,11],[2858,2864,11],[2866,2867,
11],[2869,2873,11],[2876,2876,14],[2877,2877,11],[2878,2878,14],[2879,2879,14],[2880,2880,14],[2881,2884,14],[2887,2888,14],[2891,2892,14],[2893,2893,14],[2902,2902,14],[2903,2903,14],[2908,2909,11],[2911,2913,11],[2914,2915,14],[2918,2927,9],[2929,2929,11],[2946,2946,14],[2947,2947,11],[2949,2954,11],[2958,2960,11],[2962,2965,11],[2969,2970,11],[2972,2972,11],[2974,2975,11],[2979,2980,11],[2984,2986,11],[2990,3001,11],[3006,3007,14],[3008,3008,14],[3009,3010,14],[3014,3016,14],[3018,3020,14],[3021,
3021,14],[3024,3024,11],[3031,3031,14],[3046,3055,9],[3072,3072,14],[3073,3075,14],[3076,3076,14],[3077,3084,11],[3086,3088,11],[3090,3112,11],[3114,3129,11],[3133,3133,11],[3134,3136,14],[3137,3140,14],[3142,3144,14],[3146,3149,14],[3157,3158,14],[3160,3162,11],[3168,3169,11],[3170,3171,14],[3174,3183,9],[3200,3200,11],[3201,3201,14],[3202,3203,14],[3205,3212,11],[3214,3216,11],[3218,3240,11],[3242,3251,11],[3253,3257,11],[3260,3260,14],[3261,3261,11],[3262,3262,14],[3263,3263,14],[3264,3268,14],
[3270,3270,14],[3271,3272,14],[3274,3275,14],[3276,3277,14],[3285,3286,14],[3294,3294,11],[3296,3297,11],[3298,3299,14],[3302,3311,9],[3313,3314,11],[3328,3329,14],[3330,3331,14],[3333,3340,11],[3342,3344,11],[3346,3386,11],[3387,3388,14],[3389,3389,11],[3390,3392,14],[3393,3396,14],[3398,3400,14],[3402,3404,14],[3405,3405,14],[3406,3406,11],[3412,3414,11],[3415,3415,14],[3423,3425,11],[3426,3427,14],[3430,3439,9],[3450,3455,11],[3458,3459,14],[3461,3478,11],[3482,3505,11],[3507,3515,11],[3517,3517,
11],[3520,3526,11],[3530,3530,14],[3535,3537,14],[3538,3540,14],[3542,3542,14],[3544,3551,14],[3558,3567,9],[3570,3571,14],[3633,3633,14],[3636,3642,14],[3655,3662,14],[3664,3673,9],[3761,3761,14],[3764,3772,14],[3784,3789,14],[3792,3801,9],[3840,3840,11],[3864,3865,14],[3872,3881,9],[3893,3893,14],[3895,3895,14],[3897,3897,14],[3902,3903,14],[3904,3911,11],[3913,3948,11],[3953,3966,14],[3967,3967,14],[3968,3972,14],[3974,3975,14],[3976,3980,11],[3981,3991,14],[3993,4028,14],[4038,4038,14],[4139,
4140,14],[4141,4144,14],[4145,4145,14],[4146,4151,14],[4152,4152,14],[4153,4154,14],[4155,4156,14],[4157,4158,14],[4160,4169,9],[4182,4183,14],[4184,4185,14],[4190,4192,14],[4194,4196,14],[4199,4205,14],[4209,4212,14],[4226,4226,14],[4227,4228,14],[4229,4230,14],[4231,4236,14],[4237,4237,14],[4239,4239,14],[4240,4249,9],[4250,4252,14],[4253,4253,14],[4256,4293,11],[4295,4295,11],[4301,4301,11],[4304,4346,11],[4348,4348,11],[4349,4351,11],[4352,4680,11],[4682,4685,11],[4688,4694,11],[4696,4696,11],
[4698,4701,11],[4704,4744,11],[4746,4749,11],[4752,4784,11],[4786,4789,11],[4792,4798,11],[4800,4800,11],[4802,4805,11],[4808,4822,11],[4824,4880,11],[4882,4885,11],[4888,4954,11],[4957,4959,14],[4992,5007,11],[5024,5109,11],[5112,5117,11],[5121,5740,11],[5743,5759,11],[5760,5760,4],[5761,5786,11],[5792,5866,11],[5870,5872,11],[5873,5880,11],[5888,5900,11],[5902,5905,11],[5906,5908,14],[5920,5937,11],[5938,5940,14],[5952,5969,11],[5970,5971,14],[5984,5996,11],[5998,6E3,11],[6002,6003,14],[6068,6069,
14],[6070,6070,14],[6071,6077,14],[6078,6085,14],[6086,6086,14],[6087,6088,14],[6089,6099,14],[6109,6109,14],[6112,6121,9],[6155,6157,14],[6158,6158,13],[6160,6169,9],[6176,6210,11],[6211,6211,11],[6212,6264,11],[6272,6276,11],[6277,6278,14],[6279,6312,11],[6313,6313,14],[6314,6314,11],[6320,6389,11],[6400,6430,11],[6432,6434,14],[6435,6438,14],[6439,6440,14],[6441,6443,14],[6448,6449,14],[6450,6450,14],[6451,6456,14],[6457,6459,14],[6470,6479,9],[6608,6617,9],[6656,6678,11],[6679,6680,14],[6681,
6682,14],[6683,6683,14],[6741,6741,14],[6742,6742,14],[6743,6743,14],[6744,6750,14],[6752,6752,14],[6753,6753,14],[6754,6754,14],[6755,6756,14],[6757,6764,14],[6765,6770,14],[6771,6780,14],[6783,6783,14],[6784,6793,9],[6800,6809,9],[6832,6845,14],[6846,6846,14],[6912,6915,14],[6916,6916,14],[6917,6963,11],[6964,6964,14],[6965,6965,14],[6966,6970,14],[6971,6971,14],[6972,6972,14],[6973,6977,14],[6978,6978,14],[6979,6980,14],[6981,6987,11],[6992,7001,9],[7019,7027,14],[7040,7041,14],[7042,7042,14],
[7043,7072,11],[7073,7073,14],[7074,7077,14],[7078,7079,14],[7080,7081,14],[7082,7082,14],[7083,7085,14],[7086,7087,11],[7088,7097,9],[7098,7141,11],[7142,7142,14],[7143,7143,14],[7144,7145,14],[7146,7148,14],[7149,7149,14],[7150,7150,14],[7151,7153,14],[7154,7155,14],[7168,7203,11],[7204,7211,14],[7212,7219,14],[7220,7221,14],[7222,7223,14],[7232,7241,9],[7245,7247,11],[7248,7257,9],[7258,7287,11],[7288,7293,11],[7296,7304,11],[7312,7354,11],[7357,7359,11],[7376,7378,14],[7380,7392,14],[7393,7393,
14],[7394,7400,14],[7401,7404,11],[7405,7405,14],[7406,7411,11],[7412,7412,14],[7413,7414,11],[7415,7415,14],[7416,7417,14],[7418,7418,11],[7424,7467,11],[7468,7530,11],[7531,7543,11],[7544,7544,11],[7545,7578,11],[7579,7615,11],[7616,7673,14],[7675,7679,14],[7680,7957,11],[7960,7965,11],[7968,8005,11],[8008,8013,11],[8016,8023,11],[8025,8025,11],[8027,8027,11],[8029,8029,11],[8031,8061,11],[8064,8116,11],[8118,8124,11],[8126,8126,11],[8130,8132,11],[8134,8140,11],[8144,8147,11],[8150,8155,11],[8160,
8172,11],[8178,8180,11],[8182,8188,11],[8192,8198,4],[8200,8202,4],[8204,8204,14],[8205,8205,16],[8206,8207,13],[8216,8216,8],[8217,8217,8],[8228,8228,8],[8231,8231,10],[8232,8232,2],[8233,8233,2],[8234,8238,13],[8239,8239,12],[8255,8256,12],[8260,8260,7],[8276,8276,12],[8287,8287,4],[8288,8292,13],[8294,8303,13],[8305,8305,11],[8319,8319,11],[8336,8348,11],[8400,8412,14],[8413,8416,14],[8417,8417,14],[8418,8420,14],[8421,8432,14],[8450,8450,11],[8455,8455,11],[8458,8467,11],[8469,8469,11],[8473,
8477,11],[8484,8484,11],[8486,8486,11],[8488,8488,11],[8490,8493,11],[8495,8500,11],[8501,8504,11],[8505,8505,11],[8508,8511,11],[8517,8521,11],[8526,8526,11],[8544,8578,11],[8579,8580,11],[8581,8584,11],[9398,9449,11],[11264,11310,11],[11312,11358,11],[11360,11387,11],[11388,11389,11],[11390,11492,11],[11499,11502,11],[11503,11505,14],[11506,11507,11],[11520,11557,11],[11559,11559,11],[11565,11565,11],[11568,11623,11],[11631,11631,11],[11647,11647,14],[11648,11670,11],[11680,11686,11],[11688,11694,
11],[11696,11702,11],[11704,11710,11],[11712,11718,11],[11720,11726,11],[11728,11734,11],[11736,11742,11],[11744,11775,14],[11823,11823,11],[12288,12288,4],[12293,12293,11],[12330,12333,14],[12334,12335,14],[12337,12341,17],[12347,12347,11],[12348,12348,11],[12441,12442,14],[12443,12444,17],[12448,12448,17],[12449,12538,17],[12540,12542,17],[12543,12543,17],[12549,12591,11],[12593,12686,11],[12704,12730,11],[12784,12799,17],[13008,13054,17],[13056,13143,17],[40960,40980,11],[40981,40981,11],[40982,
42124,11],[42192,42231,11],[42232,42237,11],[42240,42507,11],[42508,42508,11],[42512,42527,11],[42528,42537,9],[42538,42539,11],[42560,42605,11],[42606,42606,11],[42607,42607,14],[42608,42610,14],[42612,42621,14],[42623,42623,11],[42624,42651,11],[42652,42653,11],[42654,42655,14],[42656,42725,11],[42726,42735,11],[42736,42737,14],[42775,42783,11],[42784,42785,11],[42786,42863,11],[42864,42864,11],[42865,42887,11],[42888,42888,11],[42889,42890,11],[42891,42894,11],[42895,42895,11],[42896,42943,11],
[42946,42950,11],[42999,42999,11],[43E3,43001,11],[43002,43002,11],[43003,43009,11],[43010,43010,14],[43011,43013,11],[43014,43014,14],[43015,43018,11],[43019,43019,14],[43020,43042,11],[43043,43044,14],[43045,43046,14],[43047,43047,14],[43072,43123,11],[43136,43137,14],[43138,43187,11],[43188,43203,14],[43204,43205,14],[43216,43225,9],[43232,43249,14],[43250,43255,11],[43259,43259,11],[43261,43262,11],[43263,43263,14],[43264,43273,9],[43274,43301,11],[43302,43309,14],[43312,43334,11],[43335,43345,
14],[43346,43347,14],[43360,43388,11],[43392,43394,14],[43395,43395,14],[43396,43442,11],[43443,43443,14],[43444,43445,14],[43446,43449,14],[43450,43451,14],[43452,43453,14],[43454,43456,14],[43471,43471,11],[43472,43481,9],[43493,43493,14],[43504,43513,9],[43520,43560,11],[43561,43566,14],[43567,43568,14],[43569,43570,14],[43571,43572,14],[43573,43574,14],[43584,43586,11],[43587,43587,14],[43588,43595,11],[43596,43596,14],[43597,43597,14],[43600,43609,9],[43643,43643,14],[43644,43644,14],[43645,
43645,14],[43696,43696,14],[43698,43700,14],[43703,43704,14],[43710,43711,14],[43713,43713,14],[43744,43754,11],[43755,43755,14],[43756,43757,14],[43758,43759,14],[43762,43762,11],[43763,43764,11],[43765,43765,14],[43766,43766,14],[43777,43782,11],[43785,43790,11],[43793,43798,11],[43808,43814,11],[43816,43822,11],[43824,43866,11],[43867,43867,11],[43868,43871,11],[43872,43879,11],[43888,43967,11],[43968,44002,11],[44003,44004,14],[44005,44005,14],[44006,44007,14],[44008,44008,14],[44009,44010,14],
[44012,44012,14],[44013,44013,14],[44016,44025,9],[44032,55203,11],[55216,55238,11],[55243,55291,11],[64256,64262,11],[64275,64279,11],[64285,64285,15],[64286,64286,14],[64287,64296,15],[64298,64310,15],[64312,64316,15],[64318,64318,15],[64320,64321,15],[64323,64324,15],[64326,64335,15],[64336,64433,11],[64467,64829,11],[64848,64911,11],[64914,64967,11],[65008,65019,11],[65024,65039,14],[65040,65040,7],[65043,65043,10],[65044,65044,7],[65056,65071,14],[65075,65076,12],[65101,65103,12],[65104,65104,
7],[65106,65106,8],[65108,65108,7],[65109,65109,10],[65136,65140,11],[65142,65276,11],[65279,65279,13],[65287,65287,8],[65292,65292,7],[65294,65294,8],[65296,65305,9],[65306,65306,10],[65307,65307,7],[65313,65338,11],[65343,65343,12],[65345,65370,11],[65382,65391,17],[65392,65392,17],[65393,65437,17],[65438,65439,14],[65440,65470,11],[65474,65479,11],[65482,65487,11],[65490,65495,11],[65498,65500,11],[65529,65531,13],[65536,65547,11],[65549,65574,11],[65576,65594,11],[65596,65597,11],[65599,65613,
11],[65616,65629,11],[65664,65786,11],[65856,65908,11],[66045,66045,14],[66176,66204,11],[66208,66256,11],[66272,66272,14],[66304,66335,11],[66349,66368,11],[66369,66369,11],[66370,66377,11],[66378,66378,11],[66384,66421,11],[66422,66426,14],[66432,66461,11],[66464,66499,11],[66504,66511,11],[66513,66517,11],[66560,66639,11],[66640,66717,11],[66720,66729,9],[66736,66771,11],[66776,66811,11],[66816,66855,11],[66864,66915,11],[67072,67382,11],[67392,67413,11],[67424,67431,11],[67584,67589,11],[67592,
67592,11],[67594,67637,11],[67639,67640,11],[67644,67644,11],[67647,67669,11],[67680,67702,11],[67712,67742,11],[67808,67826,11],[67828,67829,11],[67840,67861,11],[67872,67897,11],[67968,68023,11],[68030,68031,11],[68096,68096,11],[68097,68099,14],[68101,68102,14],[68108,68111,14],[68112,68115,11],[68117,68119,11],[68121,68149,11],[68152,68154,14],[68159,68159,14],[68192,68220,11],[68224,68252,11],[68288,68295,11],[68297,68324,11],[68325,68326,14],[68352,68405,11],[68416,68437,11],[68448,68466,11],
[68480,68497,11],[68608,68680,11],[68736,68786,11],[68800,68850,11],[68864,68899,11],[68900,68903,14],[68912,68921,9],[69376,69404,11],[69415,69415,11],[69424,69445,11],[69446,69456,14],[69600,69622,11],[69632,69632,14],[69633,69633,14],[69634,69634,14],[69635,69687,11],[69688,69702,14],[69734,69743,9],[69759,69761,14],[69762,69762,14],[69763,69807,11],[69808,69810,14],[69811,69814,14],[69815,69816,14],[69817,69818,14],[69821,69821,13],[69837,69837,13],[69840,69864,11],[69872,69881,9],[69888,69890,
14],[69891,69926,11],[69927,69931,14],[69932,69932,14],[69933,69940,14],[69942,69951,9],[69956,69956,11],[69957,69958,14],[69968,70002,11],[70003,70003,14],[70006,70006,11],[70016,70017,14],[70018,70018,14],[70019,70066,11],[70067,70069,14],[70070,70078,14],[70079,70080,14],[70081,70084,11],[70089,70092,14],[70096,70105,9],[70106,70106,11],[70108,70108,11],[70144,70161,11],[70163,70187,11],[70188,70190,14],[70191,70193,14],[70194,70195,14],[70196,70196,14],[70197,70197,14],[70198,70199,14],[70206,
70206,14],[70272,70278,11],[70280,70280,11],[70282,70285,11],[70287,70301,11],[70303,70312,11],[70320,70366,11],[70367,70367,14],[70368,70370,14],[70371,70378,14],[70384,70393,9],[70400,70401,14],[70402,70403,14],[70405,70412,11],[70415,70416,11],[70419,70440,11],[70442,70448,11],[70450,70451,11],[70453,70457,11],[70459,70460,14],[70461,70461,11],[70462,70463,14],[70464,70464,14],[70465,70468,14],[70471,70472,14],[70475,70477,14],[70480,70480,11],[70487,70487,14],[70493,70497,11],[70498,70499,14],
[70502,70508,14],[70512,70516,14],[70656,70708,11],[70709,70711,14],[70712,70719,14],[70720,70721,14],[70722,70724,14],[70725,70725,14],[70726,70726,14],[70727,70730,11],[70736,70745,9],[70750,70750,14],[70751,70751,11],[70784,70831,11],[70832,70834,14],[70835,70840,14],[70841,70841,14],[70842,70842,14],[70843,70846,14],[70847,70848,14],[70849,70849,14],[70850,70851,14],[70852,70853,11],[70855,70855,11],[70864,70873,9],[71040,71086,11],[71087,71089,14],[71090,71093,14],[71096,71099,14],[71100,71101,
14],[71102,71102,14],[71103,71104,14],[71128,71131,11],[71132,71133,14],[71168,71215,11],[71216,71218,14],[71219,71226,14],[71227,71228,14],[71229,71229,14],[71230,71230,14],[71231,71232,14],[71236,71236,11],[71248,71257,9],[71296,71338,11],[71339,71339,14],[71340,71340,14],[71341,71341,14],[71342,71343,14],[71344,71349,14],[71350,71350,14],[71351,71351,14],[71352,71352,11],[71360,71369,9],[71453,71455,14],[71456,71457,14],[71458,71461,14],[71462,71462,14],[71463,71467,14],[71472,71481,9],[71680,
71723,11],[71724,71726,14],[71727,71735,14],[71736,71736,14],[71737,71738,14],[71840,71903,11],[71904,71913,9],[71935,71935,11],[72096,72103,11],[72106,72144,11],[72145,72147,14],[72148,72151,14],[72154,72155,14],[72156,72159,14],[72160,72160,14],[72161,72161,11],[72163,72163,11],[72164,72164,14],[72192,72192,11],[72193,72202,14],[72203,72242,11],[72243,72248,14],[72249,72249,14],[72250,72250,11],[72251,72254,14],[72263,72263,14],[72272,72272,11],[72273,72278,14],[72279,72280,14],[72281,72283,14],
[72284,72329,11],[72330,72342,14],[72343,72343,14],[72344,72345,14],[72349,72349,11],[72384,72440,11],[72704,72712,11],[72714,72750,11],[72751,72751,14],[72752,72758,14],[72760,72765,14],[72766,72766,14],[72767,72767,14],[72768,72768,11],[72784,72793,9],[72818,72847,11],[72850,72871,14],[72873,72873,14],[72874,72880,14],[72881,72881,14],[72882,72883,14],[72884,72884,14],[72885,72886,14],[72960,72966,11],[72968,72969,11],[72971,73008,11],[73009,73014,14],[73018,73018,14],[73020,73021,14],[73023,73029,
14],[73030,73030,11],[73031,73031,14],[73040,73049,9],[73056,73061,11],[73063,73064,11],[73066,73097,11],[73098,73102,14],[73104,73105,14],[73107,73108,14],[73109,73109,14],[73110,73110,14],[73111,73111,14],[73112,73112,11],[73120,73129,9],[73440,73458,11],[73459,73460,14],[73461,73462,14],[73728,74649,11],[74752,74862,11],[74880,75075,11],[77824,78894,11],[78896,78904,13],[82944,83526,11],[92160,92728,11],[92736,92766,11],[92768,92777,9],[92880,92909,11],[92912,92916,14],[92928,92975,11],[92976,
92982,14],[92992,92995,11],[93008,93017,9],[93027,93047,11],[93053,93071,11],[93760,93823,11],[93952,94026,11],[94031,94031,14],[94032,94032,11],[94033,94087,14],[94095,94098,14],[94099,94111,11],[94176,94177,11],[94179,94179,11],[110592,110592,17],[110948,110951,17],[113664,113770,11],[113776,113788,11],[113792,113800,11],[113808,113817,11],[113821,113822,14],[113824,113827,13],[119141,119142,14],[119143,119145,14],[119149,119154,14],[119155,119162,13],[119163,119170,14],[119173,119179,14],[119210,
119213,14],[119362,119364,14],[119808,119892,11],[119894,119964,11],[119966,119967,11],[119970,119970,11],[119973,119974,11],[119977,119980,11],[119982,119993,11],[119995,119995,11],[119997,120003,11],[120005,120069,11],[120071,120074,11],[120077,120084,11],[120086,120092,11],[120094,120121,11],[120123,120126,11],[120128,120132,11],[120134,120134,11],[120138,120144,11],[120146,120485,11],[120488,120512,11],[120514,120538,11],[120540,120570,11],[120572,120596,11],[120598,120628,11],[120630,120654,
11],[120656,120686,11],[120688,120712,11],[120714,120744,11],[120746,120770,11],[120772,120779,11],[120782,120831,9],[121344,121398,14],[121403,121452,14],[121461,121461,14],[121476,121476,14],[121499,121503,14],[121505,121519,14],[122880,122886,14],[122888,122904,14],[122907,122913,14],[122915,122916,14],[122918,122922,14],[123136,123180,11],[123184,123190,14],[123191,123197,11],[123200,123209,9],[123214,123214,11],[123584,123627,11],[123628,123631,14],[123632,123641,9],[124928,125124,11],[125136,
125142,14],[125184,125251,11],[125252,125258,14],[125259,125259,11],[125264,125273,9],[126464,126467,11],[126469,126495,11],[126497,126498,11],[126500,126500,11],[126503,126503,11],[126505,126514,11],[126516,126519,11],[126521,126521,11],[126523,126523,11],[126530,126530,11],[126535,126535,11],[126537,126537,11],[126539,126539,11],[126541,126543,11],[126545,126546,11],[126548,126548,11],[126551,126551,11],[126553,126553,11],[126555,126555,11],[126557,126557,11],[126559,126559,11],[126561,126562,11],
[126564,126564,11],[126567,126570,11],[126572,126578,11],[126580,126583,11],[126585,126588,11],[126590,126590,11],[126592,126601,11],[126603,126619,11],[126625,126627,11],[126629,126633,11],[126635,126651,11],[127280,127305,11],[127312,127337,11],[127344,127369,11],[127462,127487,18],[127995,127999,14],[917505,917505,13],[917536,917631,14],[917760,917999,14]]})(g||(g={}));(function(a){function b(a){return!Array.from(a).map(f).every(function(a){return 3===a||1===a||2===a||4===a})}function c(a){function b(b){return b>=
a.length?a.length:d(a[b])?b+2:b+1}function c(b){return 0>b?19:b>=a.length?20:d(a[b])?f(a[b]+a[b+1]):f(a[b])}function e(a){return 11===a||15===a}if(0===a.length)return[];var g=[];var h=0;var k=19,l=19;var m=c(0);var n=0;do{var p=h;h=b(h);m=[k,l,m,c(h)];var u=m[0];k=m[1];l=m[2];m=m[3];if(19===k)g.push(p);else{if(20===l){g.push(p);break}if(3!==k||1!==l)if(2===k||3===k||1===k)g.push(p);else if(2===l||3===l||1===l)g.push(p);else if(4!==k||4!=l){for(;13===l||14===l||16===l;)h=[h,b(h)],p=h[0],h=h[1],m=[m,
c(h)],l=m[0],m=m[1];if(20===l){g.push(p);break}for(;13===m||14===m||16===m;)h=b(h),m=c(h);if(!e(k)||!e(l))if(!e(k)||!e(m)||10!==l&&8!==l&&6!==l)if(!e(u)||!e(l)||10!==k&&8!==k&&6!==k)if(15!==k||6!==l)if(15!==k||5!==l||15!==m)if(15!==u||5!==k||15!==l)if(9!==k||9!==l)if(!e(k)||9!==l)if(9!==k||!e(l))if(9!==u||9!==l||7!==k&&8!==k&&6!==k)if(9!==k||9!==m||7!==l&&8!==l&&6!==l)if(17!==k||17!==l)if(!e(k)&&9!==k&&17!==k&&12!==k||12!==l)if(!e(l)&&9!==l&&17!==l||12!==k){if(18===l){if(n+=1,1==n%2)continue}else n=
0;g.push(p)}}}}while(p<a.length);return g}function d(a){a=a.charCodeAt(0);return 55296<=a&&56319>=a}function f(a){a=a.codePointAt(0);return g(a,0,h.length-1)}function g(a,b,c){if(c<b)return 0;var e=b+~~((c-b)/2),d=h[e];return a<d[0]?g(a,b,e-1):a>d[1]?g(a,e+1,c):d[2]}a.default_=function(a){var e=c(a);if(0==e.length)return[];for(var d=[],f=0;f<e.length-1;f++){var g=new l(a,e[f],e[f+1]);b(g.text)&&d.push(g)}return d};var h=a.data.WORD_BREAK_PROPERTY,l=function(){function a(a,b,c){this._source=a;this.start=
b;this.end=c}Object.defineProperty(a.prototype,"text",{get:function(){return this._source.substring(this.start,this.end)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){return this.end-this.start},enumerable:!0,configurable:!0});return a}()})(g||(g={}));g["default"]=g.default_}
function finallyConstructor(f){var g=this.constructor;return this.then(function(h){return g.resolve(f()).then(function(){return h})},function(h){return g.resolve(f()).then(function(){return g.reject(h)})})}setTimeoutFunc=setTimeout;function noop(){}function bind(f,g){return function(){f.apply(g,arguments)}}
function Promise(f){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof f)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(f,this)}
function handle(f,g){for(;3===f._state;)f=f._value;0===f._state?f._deferreds.push(g):(f._handled=!0,Promise._immediateFn(function(){var h=1===f._state?g.onFulfilled:g.onRejected;if(null===h)(1===f._state?resolve:reject)(g.promise,f._value);else{var l;try{l=h(f._value)}catch(d){reject(g.promise,d);return}resolve(g.promise,l)}}))}
function resolve(f,g){try{if(g===f)throw new TypeError("A promise cannot be resolved with itself.");if(g&&("object"===typeof g||"function"===typeof g)){var h=g.then;if(g instanceof Promise){f._state=3;f._value=g;finale(f);return}if("function"===typeof h){doResolve(bind(h,g),f);return}}f._state=1;f._value=g;finale(f)}catch(l){reject(f,l)}}function reject(f,g){f._state=2;f._value=g;finale(f)}
function finale(f){2===f._state&&0===f._deferreds.length&&Promise._immediateFn(function(){f._handled||Promise._unhandledRejectionFn(f._value)});for(var g=0,h=f._deferreds.length;g<h;g++)handle(f,f._deferreds[g]);f._deferreds=null}function Handler(f,g,h){this.onFulfilled="function"===typeof f?f:null;this.onRejected="function"===typeof g?g:null;this.promise=h}
function doResolve(f,g){var h=!1;try{f(function(f){h||(h=!0,resolve(g,f))},function(f){h||(h=!0,reject(g,f))})}catch(l){h||(h=!0,reject(g,l))}}Promise.prototype["catch"]=function(f){return this.then(null,f)};Promise.prototype.then=function(f,g){var h=new this.constructor(noop);handle(this,new Handler(f,g,h));return h};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(f){return new Promise(function(g,h){function l(b,c){try{if(c&&("object"===typeof c||"function"===typeof c)){var e=c.then;if("function"===typeof e){e.call(c,function(a){l(b,a)},h);return}}d[b]=c;0===--a&&g(d)}catch(n){h(n)}}if(!f||"undefined"===typeof f.length)throw new TypeError("Promise.all accepts an array");var d=Array.prototype.slice.call(f);if(0===d.length)return g([]);for(var a=d.length,b=0;b<d.length;b++)l(b,d[b])})};
Promise.resolve=function(f){return f&&"object"===typeof f&&f.constructor===Promise?f:new Promise(function(g){g(f)})};Promise.reject=function(f){return new Promise(function(g,h){h(f)})};Promise.race=function(f){return new Promise(function(g,h){for(var l=0,d=f.length;l<d;l++)f[l].then(g,h)})};Promise._immediateFn="function"===typeof setImmediate&&function(f){setImmediate(f)}||function(f){setTimeoutFunc(f,0)};
Promise._unhandledRejectionFn=function(f){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",f)};globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
(function(f){(function(f){(function(f){(function(f){var d=function(){function a(){this._promises=new Map}Object.defineProperty(a.prototype,"length",{get:function(){return this._promises.size},enumerable:!0,configurable:!0});a.prototype.make=function(a,e,c){if(this._promises.has(a))return c("Existing request with token "+a);this._promises.set(a,{reject:c,resolve:e})};a.prototype.keep=function(a,e){var b=this._promises.get(a);if(!b)throw Error("No promise associated with token: "+a);b=b.resolve;this._promises.delete(a);
return b(e)};a.prototype.break=function(a,e){var b=this._promises.get(a);if(!b)throw Error("No promise associated with token: "+a);this._promises.delete(a);b.reject(e)};return a}();f.PromiseStore=d})(f.prediction||(f.prediction={}))})(f.text||(f.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(f){(function(f){(function(f){var d=function(){function a(b,e){this._worker=e||new Worker(a.asBlobURI(LMLayerWorkerCode));this._worker.onmessage=this.onMessage.bind(this);this._declareLMLayerReady=null;this._predictPromises=new f.PromiseStore;this._wordbreakPromises=new f.PromiseStore;this._nextToken=Number.MIN_SAFE_INTEGER;this.sendConfig(b)}a.prototype.sendConfig=function(a){this._worker.postMessage({message:"config",capabilities:a})};a.prototype.loadModel=function(a){var b=
this;return new Promise(function(c,e){b._declareLMLayerReady=c;b._worker.postMessage({message:"load",model:a})})};a.prototype.unloadModel=function(){this._worker.postMessage({message:"unload"})};a.prototype.predict=function(a,e){var b=this,d=this._nextToken++;return new Promise(function(c,f){b._predictPromises.make(d,c,f);b._worker.postMessage({message:"predict",token:d,transform:a,context:e})})};a.prototype.wordbreak=function(a){var b=this,c=this._nextToken++;return new Promise(function(e,d){b._wordbreakPromises.make(c,
e,d);b._worker.postMessage({message:"wordbreak",token:c,context:a})})};a.prototype.onMessage=function(a){var b=a.data;if("ready"===b.message)this._declareLMLayerReady(a.data.configuration);else if("suggestions"===b.message)this._predictPromises.keep(b.token,b.suggestions);else if("currentword"===b.message)this._wordbreakPromises.keep(b.token,b.word);else throw Error("Message not implemented: "+b.message);};a.prototype.shutdown=function(){this._worker.terminate()};a.unwrap=function(a){return a.toString().match(/function[^{]+{((?:.|\r|\n)+)}[^}]*$/)[1]};
a.asBlobURI=function(b){b=a.unwrap(b);b=new Blob([b],{type:"text/javascript"});return URL.createObjectURL(b)};return a}();f.LMLayer=d})(f.prediction||(f.prediction={}))})(f.text||(f.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));(function(){var f=com.keyman.text.prediction;"undefined"!==typeof module&&"undefined"!==typeof module.exports?(module.exports=f.LMLayer,f.LMLayer.PromiseStore=f.PromiseStore):window.LMLayer=f.LMLayer})();
(function(f){(function(g){(function(g){(function(h){var d=function(){return function(a,b){this.left=a.getTextBeforeCaret();this.startOfBuffer=this.left._kmwLength()>b.leftContextCodeUnits;this.startOfBuffer||(this.left=this.left._kmwSubstr(-b.leftContextCodeUnits));this.right=a.getTextAfterCaret();this.endOfBuffer=this.right._kmwLength()>b.rightContextCodeUnits;this.endOfBuffer||(this.right=this.right._kmwSubstr(0,b.rightContextCodeUnits))}}(),a=function(){return function(a,b){this.suggestions=a;
this.transcriptionID=b}}();h.ReadySuggestions=a;var b=function(){function b(){this.recentTranscriptions=[];this._mayCorrect=this._mayPredict=!0;this.registeredModels={};this.languageModelMap={}}b.prototype.init=function(){var a=f.keyman.singleton,b={maxLeftContextCodeUnits:64,maxRightContextCodeUnits:a.isEmbedded?0:64};this.canEnable()&&(this.lmEngine=new h.LMLayer(b),a.addEventListener("keyboardchange",this.onKeyboardChange.bind(this)))};Object.defineProperty(b.prototype,"activeModel",{get:function(){return this.currentModel},
enumerable:!0,configurable:!0});b.prototype.unloadModel=function(){this.lmEngine.unloadModel();delete this.currentModel;delete this.configuration};b.prototype.loadModel=function(a){if(!a)throw Error("Null reference not allowed.");var b=this;return this.lmEngine.loadModel(a.path).then(function(c){b.currentModel=a;b.configuration=c})};b.prototype.onKeyboardChange=function(a){var c,e=f.keyman.singleton;if(!this.enabled)return Promise.resolve();"string"==typeof a&&(a=(c={},c.internalName=e.keyboardManager.getActiveKeyboardName(),
c.languageCode=a,c.indirect=!0,c));var d=this.languageModelMap[a.languageCode],g;if(this.currentModel!==d&&(this.currentModel&&(this.unloadModel(),e.util.callEvent(b.EVENT_PREFIX+"modelchange","unloaded")),d&&(g=this.loadModel(d)),g)){var h=this;g.then(function(){h.enabled?e.util.callEvent(b.EVENT_PREFIX+"modelchange","loaded"):h.unloadModel()}).catch(function(a){console.error("Could not load model '"+d.id+"': "+a)})}};b.prototype.register=function(a){var b=f.keyman.singleton.keyboardManager.getActiveLanguage();
this.registeredModels[a.id]=a;var c=this;a.languages.forEach(function(e){c.languageModelMap[e]=a;if(e==b)c.onKeyboardChange(e)})};b.prototype.deregister=function(a){var c=f.keyman.singleton;if(this.registeredModels[a]){var e=this.registeredModels[a];delete this.registeredModels[a];this.currentModel&&this.currentModel.id==a&&(this.unloadModel(),c.util.callEvent(b.EVENT_PREFIX+"modelchange","unloaded"));var d=this;e.languages.forEach(function(b){d.languageModelMap[b].id==a&&delete d.languageModelMap[b]})}};
b.prototype.isRegistered=function(a){return!!this.registeredModels[a.id]};b.prototype.addEventListener=function(a,e){return f.keyman.singleton.util.addEventListener(b.EVENT_PREFIX+a,e)};b.prototype.removeEventListener=function(a,e){return f.keyman.singleton.util.removeEventListener(b.EVENT_PREFIX+a,e)};b.prototype.invalidateContext=function(){f.keyman.singleton.util.callEvent(b.EVENT_PREFIX+"invalidatesuggestions","context");this.currentModel&&this.configuration&&this.predict_internal()};b.prototype.wordbreak=
function(a){a=new d(g.Mock.from(a),this.configuration);return this.lmEngine.wordbreak(a)};b.prototype.predict=function(a){this.currentModel&&this.configuration&&(f.keyman.singleton.util.callEvent(b.EVENT_PREFIX+"invalidatesuggestions","new"),this.predict_internal(a))};b.prototype.predict_internal=function(c){var e=f.keyman.singleton;if(!c)if(c=g.Processor.getOutputTarget())c=c.buildTranscriptionFrom(c,null);else return;var h=new d(c.preInput,this.configuration);this.recordTranscription(c);var l=c.transform,
p=this.currentPromise=this.lmEngine.predict(c.alternates||c.transform,h),v=this;p.then(function(c){p==v.currentPromise&&(c=new a(c,l.id),e.util.callEvent(b.EVENT_PREFIX+"suggestionsready",c),v.currentPromise=null)})};b.prototype.recordTranscription=function(a){this.recentTranscriptions.push(a);this.recentTranscriptions.length>b.TRANSCRIPTION_BUFFER&&this.recentTranscriptions.splice(0,1)};b.prototype.getPredictionState=function(a){var b=this.recentTranscriptions.filter(function(b){return b.token==
a});return 0==b.length?null:b[0]};b.prototype.shutdown=function(){this.lmEngine.shutdown()};Object.defineProperty(b.prototype,"enabled",{get:function(){return this._mayPredict},enumerable:!0,configurable:!0});b.prototype.canEnable=function(){var a=f.keyman.singleton;return 10==a.util.getIEVersion()?(console.warn("KeymanWeb cannot properly initialize its WebWorker in this version of IE."),!1):10>a.util.getIEVersion()?(console.warn("WebWorkers are not supported in this version of IE."),!1):!0};b.prototype.doEnable=
function(a){var c=f.keyman.singleton;if(a){if(a=c.keyboardManager.getActiveLanguage(),this.languageModelMap[a])this.onKeyboardChange(a)}else this.activeModel&&this.unloadModel(),c.util.callEvent(b.EVENT_PREFIX+"modelchange","unloaded")};Object.defineProperty(b.prototype,"mayPredict",{get:function(){return this._mayPredict},set:function(a){var b=this.enabled;this.canEnable()&&(this._mayPredict=a,b!=this.enabled&&this.doEnable(a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"mayCorrect",
{get:function(){return this._mayCorrect},set:function(a){this._mayCorrect=a},enumerable:!0,configurable:!0});b.prototype.tryAcceptSuggestion=function(a){return!f.keyman.singleton.util.callEvent(b.EVENT_PREFIX+"tryaccept",a)};b.prototype.tryRevertSuggestion=function(){return!f.keyman.singleton.util.callEvent(b.EVENT_PREFIX+"tryrevert",null)};b.EVENT_PREFIX="kmw.mm.";return b}();h.ModelManager=b})(g.prediction||(g.prediction={}))})(g.text||(g.text={}))})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){var h=function(){function h(){this._TitleElement=null;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=!1;this.refocusTimer=0;this.isHeadless=!1;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null};this.refreshElementContent=
null;this.util=this.util=new g.Util(this);window.KeymanWeb=this.interface=this["interface"]=new g.text.KeyboardInterface;this.ui=this.ui={};this.keyboardManager=new g.KeyboardManager(this);this.domManager=new g.DOMManager(this);this.hotkeyManager=new g.HotkeyManager(this);this.uiManager=new g.UIManager(this);this.keyMapManager=new g.KeyMapManager;this.textProcessor=new g.text.Processor;this.modelManager=new g.text.prediction.ModelManager;this.osk=this.osk=new f.keyman.osk.OSKManager;this.build=h.__BUILD__;
this.srcPath=h._srcPath;this.rootPath=h._rootPath;this.protocol=h._protocol;this.version=f.keyman.environment.VERSION;this.helpURL="http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}h.prototype.setDefaultDeviceOptions=function(d){};h.prototype.getStyleSheetPath=function(d){return d};h.prototype.getKeyboardPath=function(d,a){return d};h.prototype.KC_=function(d,a,b){return""};h.prototype.handleRotationEvents=function(){};h.prototype.alignInputs=function(d){};h.prototype.hideInputs=function(){};
h.prototype.namespaceID=function(d){};h.prototype.preserveID=function(d){};h.prototype.setInitialized=function(d){this.initialized=this.initialized=d};h.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};h.prototype.shutdown=function(){this.util.detachDOMEvent(window,"focus",this.pageFocusHandler,!1);this.util.detachDOMEvent(window,"blur",this.pageFocusHandler,!1);this.domManager.shutdown();this.osk.shutdown();
this.util.shutdown();this.keyboardManager.shutdown();this.modelManager.shutdown();this.ui&&this.ui.shutdown&&this.ui.shutdown();g.DOMEventHandlers.states=new g.CommonDOMStates};h.prototype.isFontAvailable=function(d){return this.util.checkFont({family:d})};h.prototype.addEventListener=function(d,a){return this.util.addEventListener("kmw."+d,a)};h.prototype._GetEventObject=function(d){if(!d&&(d=window.event,!d)){var a=this.domManager.getLastActiveElement();if(a){a=a.ownerDocument;if(a)var b=a.defaultView;
if(!b)return null;d=b.event}}return d};h.prototype._push=function(d,a){d.push?d.push(a):d=d.concat(a);return d};h.prototype.attachToControl=function(d){this.domManager.attachToControl(d)};h.prototype.detachFromControl=function(d){this.domManager.detachFromControl(d)};h.prototype.addKeyboards=function(d){0==arguments.length?this.keyboardManager.keymanCloudRequest("",!1):this.keyboardManager.addKeyboardArray(arguments)};h.prototype.addKeyboardsForLanguage=function(d){this.keyboardManager.addLanguageKeyboards(arguments)};
h.prototype.register=function(d){this.keyboardManager.register(d)};h.prototype.removeKeyboards=function(d){return this.keyboardManager.removeKeyboards(d)};h.prototype.setActiveKeyboard=function(d,a){return this.keyboardManager.setActiveKeyboard(d,a)};h.prototype.getActiveKeyboard=function(){return this.keyboardManager.getActiveKeyboardName()};h.prototype.getActiveLanguage=function(d){return this.keyboardManager.getActiveLanguage(d)};h.prototype.isAttached=function(d){return this.domManager.isAttached(d)};
h.prototype.isCJK=function(d){return this.keyboardManager.isCJK(d)};h.prototype.isChiral=function(d){return this.keyboardManager.isChiral(d)};h.prototype.getKeyboard=function(d,a){var b,e=this.keyboardManager.getDetailedKeyboards();for(b=0;b<e.length;b++){var c=e[b];if(c.InternalName==d||c.InternalName=="Keyboard_"+d)if(2>arguments.length||c.LanguageCode==a)return c}return null};h.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};h.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};
h.prototype.init=function(d){return this.domManager.init(d)};h.prototype.resetContext=function(){this.interface.resetContext()};h.prototype.setNumericLayer=function(){this.interface.setNumericLayer()};h.prototype.disableControl=function(d){this.domManager.disableControl(d)};h.prototype.enableControl=function(d){this.domManager.enableControl(d)};h.prototype.setKeyboardForControl=function(d,a,b){this.domManager.setKeyboardForControl(d,a,b)};h.prototype.getKeyboardForControl=function(d){this.domManager.getKeyboardForControl(d)};
h.prototype.getLanguageForControl=function(d){this.domManager.getLanguageForControl(d)};h.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};h.prototype.getLastActiveElement=function(){return this.domManager.getLastActiveElement()};h.prototype.setActiveElement=function(d,a){return this.domManager.setActiveElement(d,a)};h.prototype.moveToElement=function(d){this.domManager.moveToElement(d)};h.prototype.addHotKey=function(d,a,b){this.hotkeyManager.addHotKey(d,a,b)};
h.prototype.removeHotKey=function(d,a){this.hotkeyManager.removeHotkey(d,a)};h.prototype.getUIState=function(){return this.uiManager.getUIState()};h.prototype.activatingUI=function(d){this.uiManager.setActivatingUI(d)};h.prototype.BuildVisualKeyboard=function(d,a,b,e){return this.osk.vkbd?this.osk.vkbd.buildDocumentationKeyboard(d,a,b,e):null};return h}();g.KeymanBase=h})(f.keyman||(f.keyman={}))})(com||(com={}));
var scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+1),KeymanBase=com.keyman.KeymanBase;KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");KeymanBase.__BUILD__=17;window.keyman&&window.keyman.loaded||function(){window.keyman=com.keyman.singleton=new KeymanBase}();
window.keyman.initialized||function(){var f=window.keyman,g=f.util;f.debug=f.debug=function(g){if(null==f.debugElement){var h=document.createElement("DIV");var d=h.style;d.position="absolute";d.width="30%";d.maxHeight="50%";d.top="0";d.right="0";d.minHeight="50px";d.border="1px solid blue";d.whiteSpace="pre-line";d.overflowY="scroll";d=document.createElement("P");d.id="debug_output";d.style.margin="2px";h.appendChild(d);document.body.appendChild(h);f.debugElement=d}if(null!=(d=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof d.textContent?d.textContent="":d.innerHTML="";else{h=(new Date).toTimeString().substr(3,5)+" ";var a,b;for(a=0;a<arguments.length;a++){0<a&&(h+="; ");var e=arguments[a];if("object"==typeof e)if(null==e)h+="null";else{var c="";for(b in e){0<c.length&&(c+=", ");c=c+b+":";switch(typeof e[b]){case "string":case "number":case "boolean":c+=e[b];break;default:c+=typeof e[b]}if(1024<c.length){c=c.substr(0,1E3)+"...";break}}0<c.length&&(h=h+"{"+c+"}")}else h+=e}1500<h.length&&
(h=h.substr(0,1500)+" (more)");"undefined"!=typeof d.textContent?d.textContent=h+"\n"+d.textContent:d.innerHTML=h+"<br />"+d.innerHTML}};f.debugElement=null;f.delayedInit();com.keyman.osk.Layouts._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";f._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");g.attachDOMEvent(window,"load",f.domManager._WindowLoad,!1);g.attachDOMEvent(window,"unload",f.domManager._WindowUnload,!1);g.attachDOMEvent(document,
"keyup",f.hotkeyManager._Process,!1);f.pageFocusHandler=f.interface.resetVKShift.bind(f.interface);g.attachDOMEvent(window,"focus",f.pageFocusHandler,!1);g.attachDOMEvent(window,"blur",f.pageFocusHandler,!1);String.kmwEnableSupplementaryPlane(!1)}();
(function(f){(function(f){var g=function(){function d(){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight}d.prototype.equals=function(a){return this.innerWidth==a.innerWidth&&this.innerHeight==a.innerHeight};return d}(),l=function(){function d(a){this.idlePermutationCounter=d.IDLE_PERMUTATION_CAP;this.keyman=a}d.prototype.resolve=function(){this.keyman.alignInputs();var a=this.keyman.osk;a._Load();this.oskVisible&&a._Show();this.isActive=!1;this.updateTimer&&(window.clearInterval(this.updateTimer),
this.rotState=null)};d.prototype.initNewRotation=function(){this.oskVisible=this.keyman.osk.isVisible();this.keyman.osk.hideNow();this.isActive=!0};d.prototype.init=function(){if(!this.keyman.isEmbedded){var a=this.keyman.util.device.OS,b=this.keyman.util,e=this;"iOS"==a?(b.attachDOMEvent(window,"orientationchange",function(){e.iOSEventHandler();return!1}),b.attachDOMEvent(window,"resize",function(){e.iOSEventHandler();return!1})):"Android"==a&&("onmozorientationchange"in screen?b.attachDOMEvent(screen,
"mozorientationchange",function(){e.initNewRotation();return!1}):b.attachDOMEvent(window,"orientationchange",function(){e.initNewRotation();return!1}),b.attachDOMEvent(window,"resize",function(){e.resolve();return!1}))}};d.prototype.iOSEventHandler=function(){this.isActive||(this.initNewRotation(),this.rotState=new g,this.updateTimer=window.setInterval(this.iOSEventUpdate.bind(this),d.UPDATE_INTERVAL));this.idlePermutationCounter=0};d.prototype.iOSEventUpdate=function(){var a=new g;this.rotState.equals(a)?
++this.idlePermutationCounter==d.IDLE_PERMUTATION_CAP&&this.resolve():(this.rotState=a,this.idlePermutationCounter=0)};d.IDLE_PERMUTATION_CAP=15;d.UPDATE_INTERVAL=20;return d}();f.RotationManager=l})(f.keyman||(f.keyman={}))})(com||(com={}));
(function(f){(function(g){(function(h){h.VisualKeyboard.prototype.touchHold=function(f){this.subkeyDelayTimer&&(window.clearTimeout(this.subkeyDelayTimer),this.subkeyDelayTimer=null);"undefined"!=typeof f.subKeys&&null!=f.subKeys&&(this.subkeyDelayTimer=window.setTimeout(function(){this.clearPopup();this.showSubKeys(f)}.bind(this),this.popupDelay))};h.VisualKeyboard.prototype.optionKey=function(h,d,a){h=f.keyman.singleton;var b=h.osk;a&&(0<=d.indexOf("K_LOPT")?b.showLanguageMenu():0<=d.indexOf("K_ROPT")&&
(h.uiManager.setActivatingUI(!1),b._Hide(!0),d=h.domManager.getActiveElement(),g.dom.Utils.instanceof(d,"TouchAliasElement")&&d.hideCaret(),h.domManager.clearLastActiveElement()))};h.VisualKeyboard.prototype.highlightSubKeys=function(f,d,a){if(null!=f&&null!=f.subKeys){var b,e=document.getElementById("kmw-popup-keys");5<this.touchY-a&&null==e&&(this.subkeyDelayTimer&&window.clearTimeout(this.subkeyDelayTimer),this.showSubKeys(f),e=document.getElementById("kmw-popup-keys"));for(b=0;b<f.subKeys.length;b++)try{var c=
e.childNodes[b].firstChild;var h=g.dom.Utils.getAbsoluteX(c);var l=g.dom.Utils.getAbsoluteY(c);var u=h+c.offsetWidth;var p=l+c.offsetHeight;var v=d>h&&d<u&&a>l&&a<p;this.highlightKey(c,v);v&&this.highlightKey(f,!1)}catch(m){}}};h.VisualKeyboard.prototype.showKeyTip=function(h,d){var a=f.keyman.singleton,b=a.util,e=a.osk;a=this.keytip;if(null!=a&&(h!=a.key||d!=a.state)){var c=document.getElementById("kmw-popup-keys");c=c&&"visible"==c.style.visibility;if(d&&!c){var k=g.dom.Utils.getAbsoluteY(e._Box),
l=e._Box.offsetHeight;e=g.dom.Utils.getAbsoluteX(h);var u=g.dom.Utils.getAbsoluteY(h);c=h.offsetWidth;for(var p=h.offsetHeight,v=h.firstChild,m=a.element.style,q=a.element.childNodes[1],r=q.style,t=0,w=a.element.firstChild,z=0;z<h.childNodes.length&&(v=h.childNodes[z],!b.hasClass(v,"kmw-key-text"));z++);w.width=1.6*c;w.height=2.3*p;m.top="auto";m.bottom=k+l-u-p+"px";m.textAlign="center";m.overflow="visible";m.fontFamily=b.getStyleValue(v,"font-family");m.width=w.width+"px";m.height=w.height+"px";
b=b.getStyleInt(v,"font-size");0!=b&&(b*=1.8,m.fontSize=b+"px",k=f.keyman.osk.OSKKey.getTextWidth(this,q.textContent,m),k=.9*w.width/k,1>k&&(m.fontSize=b*k+"px"));q.textContent=v.textContent;r.display="block";r.position="absolute";r.textAlign="center";r.width="100%";r.top="2%";r.bottom="auto";b=(w.width-c)/2;e<b?(t=-1,e+=b):e>window.innerWidth-c-b&&(t=1,e-=b);this.drawPreview(w,c,p,t);m.left=e-b+"px";m.display="block"}else a.element.style.display="none";a.key=h;a.state=d}};h.VisualKeyboard.prototype.drawPreview=
function(g,d,a,b){a=f.keyman.singleton.util.device;var e=g.getContext("2d"),c=(g.width-d)/2,h=g.height,l=c,u=d+c;d+=2*c;var p=.5*h,v=.6*h,m=8;"Android"==a.OS&&(m=3);switch(b){case -1:l-=c;u-=c;break;case 1:l+=c,u+=c}e.clearRect(0,0,g.width,g.height);"Android"==a.OS?(l=u=(l+u)/2,e.fillStyle="#999"):e.fillStyle="#ffffff";e.lineWidth=1;e.strokeStyle="#cccccc";e.save();e.beginPath();e.moveTo(0+m,0);e.arcTo(d,0,d,m,m);"Android"==a.OS?(e.arcTo(d,p,u,v,m),e.arcTo(u,v,l,v,m)):(e.arcTo(d,p,u,v,m),e.arcTo(u,
v,u-m,h,m),e.arcTo(u,h,l,h,m),e.arcTo(l,h,l,v-m,m));e.arcTo(l,v,0,p-m,m);e.arcTo(0,p,0,m,m);e.arcTo(0,0,0+m,0,m);e.fill();e.stroke();e.restore()};h.VisualKeyboard.prototype.createKeyTip=function(){var g=f.keyman.singleton,d=g.util;if("phone"==g.util.device.formFactor){if(null==this.keytip){this.keytip={key:null,state:!1};var a=this.keytip.element=d._CreateElement("div");a.className="kmw-keytip";a.id="kmw-keytip";a.style.pointerEvents="none";a.appendChild(d._CreateElement("canvas"));a.appendChild(d._CreateElement("span"))}g.osk._Box.appendChild(this.keytip.element)}};
h.VisualKeyboard.prototype.addCallout=function(g){var d=f.keyman.singleton,a=d.util;if("phone"!=a.device.formFactor||"iOS"!=a.device.OS)return null;a=a._CreateElement("div");var b=a.style;a.id="kmw-popup-callout";d.osk._Box.appendChild(a);d=g.offsetLeft;var e=g.offsetWidth,c=g.offsetHeight;b.top=g.offsetTop-6+"px";b.left=d+"px";b.width=e+"px";b.height=c+6+"px";return a};h.VisualKeyboard.prototype.waitForFonts=function(g,d){var a=f.keyman.singleton,b=a.util;if("undefined"==typeof g&&"undefined"==typeof d||
"undefined"==typeof g.files&&"undefined"==typeof d.files)return!0;var e=b.checkFontDescriptor(g),c=b.checkFontDescriptor(d);if(e&&c)return!0;a.fontCheckTimer=window.setInterval(function(){b.checkFontDescriptor(g)&&b.checkFontDescriptor(d)&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},100);window.setTimeout(function(){a.fontCheckTimer&&(window.clearInterval(a.fontCheckTimer),a.fontCheckTimer=null,a.alignInputs())},5E3);return!1}})(g.osk||(g.osk={}))})(f.keyman||(f.keyman=
{}))})(com||(com={}));
window.keyman.initialized||function(){var f=window.keyman,g=f.util,h=g.device,l=com.keyman.dom;f.isEmbedded=!1;f.setDefaultDeviceOptions=function(d){""==d.attachType&&(d.attachType=h.touchable?"manual":"auto")};g.wait=function(d){var a=this.waiting;if("undefined"!=typeof a&&null!=a&&!f.warned){var b=a.firstChild.childNodes;d?(a.pending=!0,window.setTimeout(function(){a.pending&&(window.scrollTo(0,0),b[0].style.display="none",b[1].className="kmw-wait-text",b[1].innerHTML=d,b[2].style.display="block",
a.style.display="block")},1E3)):a.pending&&(b[1].innerHTML="",a.pending=!1,a.style.display="none")}};f.getStyleSheetPath=function(d){return g.getOption("resources")+"osk/"+d};f.getKeyboardPath=function(d){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(d)?"":f.options.keyboards)+d};f.alignInputs=function(d){if(h.touchable){var a=f.domManager,b=[];d?d.forEach(function(a){a.base?b.push(a):a.kmw_ip&&b.push(a.kmw_ip)}):b=a.inputList;b.forEach(function(a){l.Utils.instanceof(a,"TouchAliasElement")&&a.updateInput();
a.style.visibility="visible";0<a.base.textContent.length&&(a.base.style.visibility="hidden")})}};f.hideInputs=function(){var d=f.domManager;if(h.touchable)for(var a=0;a<d.inputList.length;a++)d.inputList[a].style.visibility="hidden",d.inputList[a].base.style.visibility="visible"};f.isPositionSynthesized=function(){return h.touchable};f.handleRotationEvents=function(){(new com.keyman.RotationManager(f)).init()}}();
(function(){var f=window.keyman,g=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(g),f.init(null))},10)})();(function(){var f=com.keyman.Util.prototype;f._GetAbsoluteX=f.getAbsoluteX;f._GetAbsoluteY=f.getAbsoluteY;f._GetAbsolute=f.getAbsolute;f.toNzString=f.nzString})();
(function(){var f=com.keyman.text.KeyboardInterface.prototype,g=function(g,l){f[g]=f[l]};g("KSF","saveFocus");g("KBR","beepReset");g("KT","insertText");g("KR","registerKeyboard");g("KRS","registerStub");g("KC","context");g("KN","nul");g("KCM","contextMatch");g("KFCM","fullContextMatch");g("KIK","isKeypress");g("KKM","keyMatch");g("KSM","stateMatch");g("KKI","keyInformation");g("KDM","deadkeyMatch");g("KB","beep");g("KA","any");g("KDC","deleteContext");g("KO","output");g("KDO","deadkeyOutput");g("KIO",
"indexOutput");g("KIFS","ifStore");g("KSETS","setStore");g("KLOAD","loadStore");g("KSAVE","saveStore")})();
//# sourceMappingURL=keymanweb.js.map
