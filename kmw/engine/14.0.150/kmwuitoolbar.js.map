{"version":3,"file":"kmwuitoolbar.js","lineCount":28,"mappings":"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","sources":["https://s.keyman.com/kmw/engine/14.0.150/src/kmwuitoolbar.ts"],"sourcesContent":["/***\r\n   KeymanWeb 11.0\r\n   Copyright 2019 SIL International\r\n***/\r\n\r\n// If a UI module has been loaded, we can rely on the publically-published \u0027name\u0027 property\r\n// having been set as a way to short-out a UI reload.  Its parent object always exists by\r\n// this point in the build process.\r\nif(!window[\u0027keyman\u0027][\u0027ui\u0027][\u0027name\u0027]) { \r\n  /********************************/\r\n  /*                              */\r\n  /* Toolbar User Interface       */\r\n  /*                              */\r\n  /********************************/\r\n\r\n  /**\r\n   * Do not enclose in an anonymous function, as the compiler may create\r\n   * global scope variables to replace true, false, null, which can collide\r\n   * with other variables.\r\n   * Instead, use the --output-wrapper command during optimization, which will\r\n   * add the anonymous function to enclose all code, including those optimized\r\n   * variables which would otherwise have global scope.\r\n   **/  \r\n\r\n  try {\r\n\r\n    // Declare KeymanWeb, OnScreen keyboard and Util objects\r\n    var keymanweb=window[\u0027keyman\u0027],osk=keymanweb[\u0027osk\u0027],util=keymanweb[\u0027util\u0027],dbg=keymanweb[\u0027debug\u0027];\r\n\r\n    // Disable UI for touch devices\r\n    if(util[\u0027isTouchDevice\u0027]()) throw \u0027\u0027;\r\n    \r\n    // User interface local variables\r\n    keymanweb[\u0027ui\u0027] = {\r\n      init: false,\r\n      toolbarNode: null,\r\n      backgroundNode: null, \r\n      browseMapNode: null, \r\n      keyboardsButtonNode: null,\r\n      languageButtonsNode: null, \r\n      offButtonNode: null, \r\n      offBarNode: null, \r\n      oskButtonNode: null, \r\n      oskBarNode: null,\r\n      selectorNode: null, \r\n      regionLanguageListNodes: [], \r\n      regionNodes: null, \r\n      langKeyboardNodes: [],\r\n      langKeyboardListNodes: [],\r\n      selectedRegion: \u0027as\u0027,\r\n      listedKeyboards: [],\r\n      catchAllRegion: \u0027un\u0027,\r\n      keyboardListPriority: 0,\r\n      maxListedKeyboards: 1,\r\n      lastActiveControl: null,\r\n      selectedKeyboard: null,\r\n      selectedLanguage: \u0027\u0027,\r\n      helpOffsetX: 0,\r\n      helpOffsetY: 0,\r\n      languages: [],      // array of objects { id: \u003clangid\u003e, name: \u003cname\u003e, keyboards: \u003carray of KeymanWeb keyboards\u003e }\r\n      updateMap: false,   // flag to control re-initialization of keyboard map\r\n      startTimer: 0,      // initialization timer - wait 2 seconds after last stub installed then initialize map\r\n      lgText: \u0027\u0027          // language name in toolbar\r\n    }\r\n\r\n    // User Interface object \r\n    var ui=keymanweb[\u0027ui\u0027];\r\n    ui[\u0027name\u0027] = \u0027toolbar\u0027;\r\n    \r\n    ui.ToolBar_Text = {\r\n      Keyboards: \u0027Languages\u0027,\r\n      OffTitle: \u0027Turn off KeymanWeb keyboards\u0027,\r\n      Off: \u0027Off\u0027,\r\n      ShowOSK: \u0027Show On Screen Keyboard\u0027,\r\n      LanguageSelector: \u0027Select language\u0027\r\n      };\r\n    \r\n    ui.ToolBar_Text[\u0027SelectKeyboardPre\u0027]=\u0027Select \u0027;\r\n    ui.ToolBar_Text[\u0027SelectKeyboardSuf\u0027]=\u0027keyboard\u0027;\r\n    ui.ToolBar_Text[\u0027AltKeyboardsPre\u0027]=\u0027Alternate keyboards for \u0027;\r\n    ui.ToolBar_Text[\u0027AltKeyboardsSuf\u0027]=\u0027\u0027;\r\n    \r\n    ui.ToolBar_Text[\u0027ca\u0027]=\u0027Central America\u0027;\r\n    ui.ToolBar_Text[\u0027sa\u0027]=\u0027South America\u0027;\r\n    ui.ToolBar_Text[\u0027na\u0027]=\u0027Americas\u0027;\r\n    ui.ToolBar_Text[\u0027eu\u0027]=\u0027Europe\u0027;\r\n    ui.ToolBar_Text[\u0027af\u0027]=\u0027Africa\u0027;\r\n    ui.ToolBar_Text[\u0027un\u0027]=\u0027Undetermined\u0027;\r\n    ui.ToolBar_Text[\u0027as\u0027]=\u0027Asia\u0027;\r\n    ui.ToolBar_Text[\u0027oc\u0027]=\u0027Oceania\u0027;\r\n\r\n\r\n    var controller=document.getElementById(\u0027KeymanWebControl\u0027);        \r\n  /**\r\n     * Create some of the controls but don\u0027t insert them into the document yet\r\n     * This does not need or want to prevent loss of focus, so uses document.createElement\r\n     * rather than util.createElement.      \r\n     * \r\n     * @param       {string}  tag\r\n     * @param       {?string=}  id\r\n     * @param       {?string=}  className\r\n     * @param       {string=}  innerHTML               \r\n     * @return      {Node|null}   \r\n     */       \r\n    ui.createNode = function(tag, id, className, innerHTML)\r\n    {\r\n      //var node = util[\u0027createElement\u0027](tag);\r\n      var node = document.createElement(tag);\r\n      if(id) node.id = id;\r\n      if(className) node.className = className;\r\n      if(innerHTML) node.innerHTML = innerHTML;\r\n      \r\n      // The following is OK for IE and for F3.5 and later - should simply be ignored for others\r\n      // first tried preventDefault() as suggested by many on web, which worked but interfered with keyboard and OSK enabling        \r\n      if(tag == \u0027a\u0027 || tag == \u0027area\u0027 || tag == \u0027map\u0027) node.ondragstart = function(){return false;}\r\n      return node;\r\n    }\r\n    \r\n    /**\r\n     * Initialize toolbar UI\r\n     */       \r\n    ui[\u0027initialize\u0027] = ui.initToolbarUI = function()\r\n    {\r\n      if(!keymanweb[\u0027initialized\u0027] || ui.init) return;\r\n    \r\n      // Find the controller DIV, insert at top of body if undefined\r\n      var e = document.getElementById(\u0027KeymanWebControl\u0027);    \r\n      if(!e) \r\n      {\r\n        if(document.body == null)\r\n          return;\r\n        else\r\n        {\r\n          e=document.createElement(\u0027DIV\u0027);\r\n          e.id=\u0027KeymanWebControl\u0027;  \r\n          document.body.insertBefore(e,document.body.firstChild);\r\n          ui._insertedElem = e;\r\n        }\r\n      }\r\n      \r\n      // Hide toolbar until elements fully drawn, to prevent spurious text displays\r\n      e.style.visibility=\u0027hidden\u0027; e.style.maxHeight=\u002735px\u0027;\r\n\r\n      ui.init = true;\r\n      \r\n      if(util[\u0027isTouchDevice\u0027]()) return;\r\n\r\n      util[\u0027linkStyleSheet\u0027](util[\u0027getOption\u0027](\u0027resources\u0027)+\u0027ui/toolbar/kmwuitoolbar.css\u0027);\r\n        \r\n      ui.regions = {};\r\n      //ui.regions[\u0027ca\u0027] = {t: ui.ToolBar_Text[\u0027ca\u0027], m: \u002749,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61\u0027 },\r\n      //ui.regions[\u0027sa\u0027] = {t: ui.ToolBar_Text[\u0027sa\u0027], m: \u002782,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89\u0027 },\r\n      ui.regions[\u0027na\u0027] = {t: ui.ToolBar_Text[\u0027na\u0027], m: \u00270,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8,49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61,82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89\u0027 },\r\n      ui.regions[\u0027eu\u0027] = {t: ui.ToolBar_Text[\u0027eu\u0027], m: \u0027145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33\u0027 },\r\n      ui.regions[\u0027af\u0027] = {t: ui.ToolBar_Text[\u0027af\u0027], m: \u0027150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60\u0027 },\r\n      ui.regions[\u0027as\u0027] = {t: ui.ToolBar_Text[\u0027as\u0027], m: \u0027219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0\u0027 },\r\n      ui.regions[\u0027oc\u0027] = {t: ui.ToolBar_Text[\u0027oc\u0027], m: \u0027288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130\u0027 }\r\n      ui.regions[\u0027un\u0027] = {t: ui.ToolBar_Text[\u0027un\u0027], m: \u0027205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53\u0027 },\r\n      \r\n      ui.toolbarNode = ui.createNode(\u0027div\u0027, \u0027kmw_controls\u0027);\r\n      ui.toolbarNode.style.display=\u0027block\u0027;\r\n      \r\n      var tbNode = ui.createNode(\u0027a\u0027, \u0027kmw_controls_start\u0027, null, \u0027 \u0027); \r\n      tbNode.href = \"https://keyman.com/developer/keymanweb/\";\r\n      tbNode.target=\"_blank\";\r\n      ui.toolbarNode.appendChild(tbNode);\r\n      \r\n      /* Keyboards button */\r\n      ui.keyboardsButtonNode = ui.createNode(\u0027div\u0027,\u0027kmw_btn_keyboards\u0027,\u0027kmw_button\u0027);\r\n      ui.keyboardsButtonNode.title=ui.ToolBar_Text.LanguageSelector;\r\n      var aNode = ui.createNode(\u0027a\u0027, null, \u0027kmw_button_a\u0027);\r\n      aNode.href=\u0027#\u0027;\r\n      aNode.onclick = ui.showKeyboardsPopup;\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, \u0027kmw_img_keyboards\u0027, \u0027kmw_img\u0027));\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_a\u0027, ui.ToolBar_Text.Keyboards));\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_drop\u0027));\r\n      ui.keyboardsButtonNode.appendChild(aNode);\r\n\r\n      /* Keyboards popup */\r\n      ui.selectorNode = ui.createNode(\u0027div\u0027, \u0027kmw_selector\u0027);\r\n      ui.regionsNode = ui.createNode(\u0027div\u0027, \u0027kmw_selector_regions\u0027);    \r\n      var imgNode;\r\n      ui.browseMapNode = ui.createNode(\u0027div\u0027, \u0027kmw_browsemap\u0027);\r\n      imgNode = ui.createNode(\u0027img\u0027, \u0027kmw_region_browsemap\u0027);\r\n      imgNode.src= util[\u0027getOption\u0027](\u0027resources\u0027)+\u0027ui/toolbar/blank.gif\u0027;\r\n      imgNode.useMap = \u0027#kmw_worldgrey16\u0027;\r\n      ui.browseMapNode.appendChild(imgNode);\r\n    \r\n      var areaNode, mapNode = ui.createNode(\u0027map\u0027, \u0027kmw_worldgrey16\u0027);\r\n      mapNode.name=\u0027kmw_worldgrey16\u0027;\r\n      for(var i in ui.regions)\r\n      {\r\n        areaNode = ui.createNode(\u0027area\u0027);\r\n        areaNode.shape = \u0027poly\u0027;\r\n        areaNode.alt = \u0027\u0027;\r\n        areaNode.href = \u0027#\u0027;\r\n        areaNode.title = ui.regions[i].t;\r\n        areaNode.hidefocus = \u0027true\u0027;\r\n        areaNode.onclick = (function(i) { return function(event) { return ui.selectRegion(event, i); } })(i);\r\n        areaNode.onmouseover = (function(i) { return function(event) { return ui.hoverRegion(event, i); } })(i);\r\n        areaNode.onmouseout = (function(i) { return function(event) { return ui.unhoverRegion(event, i); } })(i);\r\n        areaNode.coords = ui.regions[i].m;\r\n        mapNode.appendChild(areaNode);\r\n      }\r\n      \r\n      areaNode = ui.createNode(\u0027area\u0027);\r\n      areaNode.shape = \u0027default\u0027;\r\n      areaNode.nohref = \u0027true\u0027;\r\n      areaNode.alt = \u0027\u0027;\r\n      areaNode.onclick=ui.eventCapture;   // do not close map when clicking on ocean!\r\n      mapNode.appendChild(areaNode);\r\n      ui.browseMapNode.appendChild(mapNode);\r\n      ui.regionsNode.appendChild(ui.browseMapNode);\r\n      ui.regionNodes = {};\r\n\r\n      var listNode = ui.createNode(\u0027ul\u0027);\r\n      for(i in ui.regions)\r\n      {\r\n        var itemNode = ui.createNode(\u0027li\u0027);\r\n        ui.regionNodes[i] = ui.createNode(\u0027a\u0027, null, null, ui.regions[i].t);\r\n        ui.regionNodes[i].href=\u0027#\u0027;\r\n        ui.regionNodes[i].onclick = (function(i) { return function(event) { return ui.selectRegion(event, i); } })(i);\r\n        ui.regionNodes[i].onmouseover = (function(i) { return function(event) { return ui.hoverRegion(event, i); } })(i);\r\n        ui.regionNodes[i].onmouseout = (function(i) { return function(event) { return ui.unhoverRegion(event, i); } })(i);\r\n        itemNode.appendChild(ui.regionNodes[i]);\r\n        listNode.appendChild(itemNode);\r\n      }\r\n      ui.regionsNode.appendChild(listNode);    \r\n      ui.selectorNode.appendChild(ui.regionsNode);\r\n      ui.keyboardsButtonNode.appendChild(ui.selectorNode);\r\n      ui.toolbarNode.appendChild(ui.keyboardsButtonNode);\r\n\r\n      // Separator and Keyboard Off Button       \r\n      ui.toolbarNode.appendChild(ui.offBarNode = ui.createNode(\u0027div\u0027, \u0027kmw_bar_off\u0027, \u0027kmw_bar\u0027));\r\n  \r\n      ui.offButtonNode = ui.createNode(\u0027div\u0027, \u0027kmw_btn_off\u0027, \u0027kmw_button_selected\u0027);\r\n      aNode = ui.createNode(\u0027a\u0027, null, \u0027kmw_button_a\u0027);\r\n      aNode.href = \u0027#\u0027;\r\n      aNode.onclick = ui.offButtonClickEvent;\r\n      aNode.title = ui.ToolBar_Text.OffTitle;\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, \u0027kmw_img_off\u0027, \u0027kmw_img\u0027));\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_a\u0027, ui.ToolBar_Text.Off));\r\n      ui.offButtonNode.appendChild(aNode);\r\n      ui.toolbarNode.appendChild(ui.offButtonNode);\r\n      \r\n      // Keyboard buttons       \r\n      ui.toolbarNode.appendChild(ui.languageButtonsNode = ui.createNode(\u0027div\u0027, \u0027kmw_control_keyboards\u0027, \u0027kmw_button\u0027));    \r\n      \r\n      // Separator and On Screen Keyboard Button       \r\n      ui.toolbarNode.appendChild(ui.oskBarNode = ui.createNode(\u0027div\u0027, \u0027kmw_bar_osk\u0027, \u0027kmw_bar\u0027));\r\n        \r\n      ui.oskButtonNode = ui.createNode(\u0027div\u0027, \u0027kmw_btn_osk\u0027, \u0027kmw_button\u0027);//was \u0027kmw_button_selected\u0027\r\n      aNode = ui.createNode(\u0027a\u0027, null, \u0027kmw_button_a\u0027);\r\n      aNode.href = \u0027#\u0027;\r\n      aNode.onclick = ui.showOSK;\r\n      aNode.title = ui.ToolBar_Text.ShowOSK;\r\n      aNode.appendChild(ui.createNode(\u0027div\u0027, \u0027kmw_img_osk\u0027, \u0027kmw_img\u0027));\r\n      //aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_a\u0027, \u0027On Screen Keyboard\u0027));\r\n      ui.oskButtonNode.appendChild(aNode);\r\n      ui.toolbarNode.appendChild(ui.oskButtonNode);\r\n    \r\n      ui.toolbarNode.appendChild(ui.createNode(\u0027div\u0027, \u0027kmw_controls_end\u0027, null, \u0027 \u0027));\r\n    \r\n      var img = ui.createNode(\u0027div\u0027);\r\n      img.id = \u0027kmw_map_preload\u0027;\r\n      ui.toolbarNode.appendChild(img);\r\n    \r\n      ui.toolbarNode.appendChild(ui.createNode(\u0027br\u0027, null, \u0027kmw_clear\u0027));\r\n    \r\n      // Append toolbar node to controller      \r\n      e.appendChild(ui.toolbarNode);    \r\n    \r\n      // Initialize map array, using a timer to allow restarting if necessary after keyboards loaded\r\n      // Note that toolbar will be displayed and enabled on completion of timeout routine\r\n      ui.updateMap = true;\r\n      if(ui.startTimer) clearTimeout(ui.startTimer);\r\n      ui.startTimer = setTimeout(ui.addKeyboardsToMap,2000);\r\n    \r\n      // Ensure that popups are hidden by clicking elsewhere on document\r\n      util[\u0027attachDOMEvent\u0027](document.body,\u0027click\u0027,ui.hideAllPopups,false);\r\n\r\n      // Set Europe to be the default region \r\n      ui.selectedRegion = \u0027eu\u0027;\r\n\r\n      // Restore focus\r\n      keymanweb[\u0027focusLastActiveElement\u0027]();  \r\n    }\r\n\r\n    ui.shutdown = function() {\r\n      var root = ui.toolbarNode;\r\n      if(root) {\r\n        root.parentNode.removeChild(root);\r\n      }\r\n\r\n      root = ui._insertedElem;\r\n      if(root) {\r\n        root.parentNode.removeChild(root);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Fill the map with available keyboards when the Keyboards selector is clicked\r\n     *    after all keyboard stubs have been registered\r\n    **/     \r\n    ui.addKeyboardsToMap = function()\r\n    {\r\n      // Do nothing unless a keyboard has been installed since map created\r\n      if(ui.updateMap) ui.updateMap=false; else return;\r\n\r\n      var n = 0;  \r\n      ui.regionLanguageListNodes = {};\r\n    \r\n      // Build list of keyboards by region and language       \r\n      var Keyboards = keymanweb[\u0027getKeyboards\u0027]();\r\n      \r\n      // Sort the keyboards by region and language\r\n      Keyboards.sort(ui.sortKeyboards);\r\n\r\n      // Always rebuild the map, so remove any previously created language lists \r\n      for(n=ui.regionsNode.childNodes.length; n\u003e0; n--)\r\n      {\r\n        if(ui.regionsNode.childNodes[n-1].className == \u0027kmw_selector_region\u0027)\r\n        {\r\n          ui.regionsNode.removeChild(ui.regionsNode.childNodes[n-1]);\r\n        }\r\n      }\r\n      \r\n      for(var i in ui.regions)\r\n      {      \r\n      \r\n        ui.regionLanguageListNodes[i] = ui.createNode(\u0027div\u0027, null, \u0027kmw_selector_region\u0027);\r\n        var colNode = ui.createNode(\u0027div\u0027, null, \u0027kmw_keyboard_col\u0027);\r\n        var max = 0, count = 0, languageCode = \u0027\u0027;\r\n    \r\n        // Get number of languages for the region         \r\n        for(var j=0; j\u003cKeyboards.length; j++) {\r\n          // REVERT:  ensures that keyboards without visible map region get displayed SOMEWHERE.\r\n          var kbdRegion = Keyboards[j][\u0027RegionCode\u0027];\r\n          if(!ui.regions[kbdRegion]) {\r\n            // For now, we\u0027ll display them within the \u0027middle-east\u0027 region.\r\n            if(i != ui.catchAllRegion) {\r\n              continue;\r\n            }\r\n          } else if(kbdRegion != i) {\r\n            continue; // Not this region\r\n          }\r\n\r\n          // Get JUST the language code for this section.  BCP-47 codes can include more!\r\n          var bcpSubtags: string[] = keymanweb[\u0027util\u0027][\u0027getLanguageCodes\u0027](Keyboards[j][\u0027LanguageCode\u0027]);\r\n          if(bcpSubtags[0] == languageCode) continue; // Same language as previous keyboard\r\n          languageCode = bcpSubtags[0];\r\n\r\n          max++;\r\n        }   \r\n        max = Number(((max+3)/4).toFixed(0));   // Get number of entries per column\r\n  \r\n        // Add language list to columns for the region\r\n        languageCode=\u0027\u0027;\r\n        for(var j=0; j\u003cKeyboards.length; j++) {           \r\n          // REVERT:  ensures that keyboards without visible map region get displayed SOMEWHERE.\r\n          var kbdRegion = Keyboards[j][\u0027RegionCode\u0027];\r\n          if(!ui.regions[kbdRegion]) {\r\n            // For now, we\u0027ll display them within the \u0027middle-east\u0027 region.\r\n            if(i != ui.catchAllRegion) {\r\n              continue;\r\n            }\r\n          } else if(kbdRegion != i) {\r\n            continue; // Not this region\r\n          }\r\n\r\n          var bcpSubtags: string[] = keymanweb[\u0027util\u0027][\u0027getLanguageCodes\u0027](Keyboards[j][\u0027LanguageCode\u0027]);\r\n          if(bcpSubtags[0] == languageCode) {  // Same language as previous keyboard, so add it to that entry\r\n            var x = ui.languages[languageCode].keyboards;\r\n\r\n            // While we could avoid duplicating keyboard entries that occur for multiple regions, we\u0027ll instead\r\n            // allow them to display while distinguishing them more directly.  (That part is handled later.)\r\n            if(x.push) {\r\n              x.push(Keyboards[j]);\r\n            } else {\r\n              ui.languages[languageCode].keyboards = x.concat(Keyboards[j]);\r\n            }\r\n\r\n            continue;\r\n          }\r\n          \r\n          // Add a new language entry          \r\n          languageCode = bcpSubtags[0]; \r\n          ui.languages[languageCode] = { id: Keyboards[j][\u0027LanguageCode\u0027], name: Keyboards[j][\u0027LanguageName\u0027], keyboards: [Keyboards[j]] };\r\n  \r\n          // Start a new column if necessary          \r\n          if(count % max == 0 \u0026\u0026 count \u003e 0)\r\n          {\r\n            ui.regionLanguageListNodes[i].appendChild(colNode);\r\n            colNode = ui.createNode(\u0027div\u0027, null, count/max == 3 ? \u0027kmw_keyboard_col_right\u0027 : \u0027kmw_keyboard_col\u0027);   \r\n          }\r\n          count++;\r\n          \r\n          // Add the language to the column          \r\n          var langNode = ui.createNode(\u0027div\u0027, null, \u0027kmw_language\u0027);\r\n          var aNode = ui.createNode(\u0027a\u0027, null, null, Keyboards[j][\u0027LanguageName\u0027]);\r\n          aNode.href=\u0027#\u0027;\r\n          aNode.onclick = (function(lang) { return function(event) { return ui.selectLanguage(event, lang); }; })(ui.languages[languageCode]);\r\n          langNode.appendChild(aNode);\r\n          colNode.appendChild(langNode);\r\n          \r\n          n++;\r\n        }\r\n        // Finish the last column and close the list        \r\n        ui.regionLanguageListNodes[i].appendChild(colNode);\r\n        ui.regionLanguageListNodes[i].appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_clear\u0027));\r\n        ui.regionsNode.appendChild(ui.regionLanguageListNodes[i]);\r\n      }\r\n      ui.loadCookie();\r\n      \r\n      // Ensure that the correct region has been selected\r\n      ui.selectRegion(null, ui.selectedRegion);\r\n      ui.enableControls();  \r\n      \r\n      // Restore focus\r\n      keymanweb[\u0027focusLastActiveElement\u0027]();\r\n\r\n    }\r\n          \r\n    /**\r\n     * Sort keyboards array returned from keymanweb by region and language\r\n     * \r\n     * @param       {Object}  a\r\n     * @param       {Object}  b\r\n     * @return      {number}   \r\n     **/   \r\n    ui.sortKeyboards = function(a,b)\r\n    {\r\n      if(a[\u0027RegionCode\u0027] \u003c b[\u0027RegionCode\u0027]) return -2;\r\n      if(a[\u0027RegionCode\u0027] \u003e b[\u0027RegionCode\u0027]) return 2;\r\n      if(a[\u0027LanguageName\u0027] \u003c b[\u0027LanguageName\u0027]) return -1;\r\n      if(a[\u0027LanguageName\u0027] \u003e b[\u0027LanguageName\u0027]) return 1;\r\n      return 0;\r\n    }\r\n      \r\n    /* KeymanWeb Interfaces */\r\n\r\n    /**\r\n     * Function     findListedKeyboard\r\n     * Scope        Private\r\n     * @param       {Object}  lang\r\n     * @return      {?number}   \r\n     * Description  Test if a keyboard is still shown on the toolbar.  Returns index of keyboard in listedKeyboards or null if not found\r\n     */\r\n    ui.findListedKeyboard = function(lang)\r\n    {\r\n      for(var i = 0; i \u003c ui.listedKeyboards.length; i++)\r\n        if(ui.listedKeyboards[i].lang.id == lang.id) return i;\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Add a keyboard to the list of keyboards available for a language\r\n     * \r\n     * @param       {Object}  lang\r\n     * @param       {Object}  kbd\r\n     **/       \r\n    ui.addKeyboardToList = function(lang,kbd)\r\n    {\r\n      var found = ui.findListedKeyboard(lang);\r\n      if(found == null)\r\n      {\r\n        // Add the button \r\n        if(ui.listedKeyboards.length \u003e= ui.maxListedKeyboards)\r\n        {\r\n          var oldestPriority = 0x7fffffff, oldestFound = null;\r\n          \r\n          for(var i = 0; i \u003c ui.listedKeyboards.length; i++)\r\n            if(ui.listedKeyboards[i].priority \u003c oldestPriority)\r\n            {\r\n              oldestFound = i;\r\n              oldestPriority = ui.listedKeyboards[i].priority;\r\n            }\r\n            \r\n          // delete the oldest used control\r\n          if(oldestFound != null)\r\n          {\r\n            var rk = ui.listedKeyboards[oldestFound];\r\n            ui.langKeyboardListNodes[rk.lang.id] = null;\r\n            ui.langKeyboardNodes[rk.lang.id] = null;\r\n            ui.languageButtonsNode.removeChild(rk.buttonNode);\r\n            if(oldestFound == 0)\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(oldestFound + 1);\r\n            else if(oldestFound == ui.listedKeyboards.length - 1)\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(0, oldestFound);\r\n            else\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(0, oldestFound).concat(ui.listedKeyboards.slice(oldestFound+1));\r\n          }\r\n        }\r\n        var buttonNode = ui.createNode(\u0027div\u0027, null/*\u0027kmw_button_keyboard_\u0027+lang.id*/, \u0027kmw_button\u0027);\r\n        var aNode = ui.createNode(\u0027a\u0027, null, \u0027kmw_button_a\u0027+(lang.keyboards.length\u003e1 ? \u0027 kmw_norightgap\u0027 : \u0027\u0027));\r\n        aNode.href=\u0027#\u0027;\r\n        \r\n        var p1=ui.ToolBar_Text[\u0027SelectKeyboardPre\u0027]+kbd[\u0027Name\u0027],p2=ui.ToolBar_Text[\u0027SelectKeyboardSuf\u0027];\r\n        if(p1.toLowerCase().indexOf(p2.toLowerCase()) \u003c 0) p1=p1+\u0027 \u0027+ p2;\r\n        aNode.title = p1;\r\n        aNode.onclick = function(event) { return ui.selectLanguage(event, lang) };\r\n        aNode.appendChild(ui.createNode(\u0027div\u0027, \u0027kmw_img_kbd\u0027, \u0027kmw_img\u0027));\r\n        \r\n        ui.lgText=ui.truncate(lang.name,28);\r\n        aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_a\u0027, ui.lgText));\r\n        buttonNode.appendChild(aNode);\r\n        \r\n        var thisANode = aNode;\r\n        \r\n        if(lang.keyboards.length \u003e 1) { \r\n          aNode = ui.createNode(\u0027a\u0027, null, \u0027kmw_button_a kmw_noleftgap\u0027);\r\n          aNode.href = \u0027#\u0027;\r\n          aNode.title = ui.ToolBar_Text[\u0027AltKeyboardsPre\u0027]+lang.name+ui.ToolBar_Text[\u0027AltKeyboardsSuf\u0027];\r\n          aNode.onclick = function(event) { return ui.showKeyboardsForLanguage(event, lang) };\r\n          var divNode = ui.createNode(\u0027div\u0027, null, \u0027kmw_a\u0027);\r\n          var kbdText=ui.truncate(kbd[\u0027Name\u0027].replace(/\\s?keyboard/i,\u0027\u0027),40-ui.lgText.length);\r\n          divNode.appendChild(ui.langKeyboardNodes[lang.id] = ui.createNode(\u0027span\u0027, null, \u0027kmw_kbd\u0027, kbdText));\r\n          aNode.appendChild(divNode);\r\n          aNode.appendChild(ui.createNode(\u0027div\u0027, null, \u0027kmw_drop\u0027));\r\n          buttonNode.appendChild(aNode);\r\n          \r\n          ui.langKeyboardListNodes[lang.id] = ui.createNode(\u0027ul\u0027, null, \u0027kmw_selector_kbd\u0027);\r\n          ui.langKeyboardListNodes[lang.id].style.display=\u0027none\u0027;\r\n          \r\n          for(var n in lang.keyboards) {\r\n            var itemNode = ui.createNode(\u0027li\u0027);\r\n            kbdText = lang.keyboards[n][\u0027Name\u0027].replace(/\\s?keyboard/i,\u0027\u0027);\r\n            // We append the full BCP-47 code here for disambiguation when regional and/or script variants exist.\r\n            kbdText = kbdText + \" [\" + lang.keyboards[n].LanguageCode + \"]\";\r\n            aNode = ui.createNode(\u0027a\u0027, null, null, kbdText);\r\n            aNode.href = \u0027#\u0027;\r\n            aNode.title = \u0027\u0027;\r\n            aNode.onclick = (function(lang,kbd) { return function(event) { return ui.selectKeyboard(event, lang, kbd); } })(lang, lang.keyboards[n]);\r\n\r\n            itemNode.appendChild(aNode);\r\n            ui.langKeyboardListNodes[lang.id].appendChild(itemNode);\r\n          }\r\n          buttonNode.appendChild(ui.langKeyboardListNodes[lang.id]);\r\n        }\r\n        \r\n        ui.languageButtonsNode.appendChild(buttonNode);\r\n        \r\n        var thisLang = lang, thisButtonNode = buttonNode;\r\n        ui.listedKeyboards.push({priority: ui.keyboardListPriority++, lang:thisLang, keyboard:kbd, buttonNode:thisButtonNode, aNode:thisANode});\r\n      }\r\n      else\r\n      {    \r\n        ui.listedKeyboards[found].priority = ui.keyboardListPriority++;\r\n        ui.listedKeyboards[found].keyboard = kbd;\r\n        var e = ui.langKeyboardNodes[lang.id];\r\n        if(e) \r\n        {\r\n          var kbdText=kbd[\u0027Name\u0027].replace(/\\s?keyboard/i,\u0027\u0027);\r\n          e.innerHTML = ui.truncate(kbdText,40-ui.lgText.length);\r\n        }\r\n        if(ui.listedKeyboards[found].aNode) \r\n        {\r\n          var p1=ui.ToolBar_Text[\u0027SelectKeyboardPre\u0027]+kbd[\u0027Name\u0027],p2=ui.ToolBar_Text[\u0027SelectKeyboardSuf\u0027];\r\n          if(p1.toLowerCase().indexOf(p2.toLowerCase()) \u003c 0) p1=p1+\u0027 \u0027+ p2;\r\n          ui.listedKeyboards[found].aNode.title = p1;\r\n        }\r\n      }\r\n    }\r\n\r\n    /** \r\n     *  Truncate a long name and add an ellipsis\r\n     *  \r\n     *  @param  {string}  PName   string that may need to be truncated\r\n     *  @param  {number}  PLen    max non-truncated length\r\n     *  @return {string}          string, truncated with ellipsis if necessary\r\n     *                \r\n     **/\r\n    ui.truncate = function(PName,PLen)\r\n    {\r\n      if(PName.length \u003c=PLen) return PName;\r\n      return PName.substr(0,PLen-1)+\u0027\\u2026\u0027;\r\n    }\r\n        \r\n    /**\r\n     * Rebuild the entire keyboard list whenever a keyboard is installed \r\n     * (without necessarily loading the keyboard)\r\n     * \r\n     * @param       {Object}  p Keyboard metadata object\r\n     **/    \r\n    ui.registerKeyboard = function(p)\r\n    {\r\n      ui.updateMap = true; \r\n      if(ui.startTimer) clearTimeout(ui.startTimer);\r\n      ui.startTimer = setTimeout(ui.addKeyboardsToMap,2000);\r\n    }\r\n    keymanweb[\u0027addEventListener\u0027](\u0027keyboardregistered\u0027,ui.registerKeyboard);   \r\n    \r\n    var keyboardsForLangPopup = null;\r\n    \r\n    /**\r\n     * Function     hideKeyboardsForLanguage\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Hide the list of keyboards for this language\r\n     **/    \r\n    ui.hideKeyboardsForLanguage = function(event)\r\n    {\r\n      var e = ui.keyboardsForLangPopup;\r\n      if(e) e.style.display=\u0027none\u0027;\r\n      ui.CancelPopupDismissal(ui.hideKeyboardsForLanguage);\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Display the list of keyboards for this language\r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang\r\n     * @return      {boolean} \r\n     * \r\n     **/    \r\n    ui.showKeyboardsForLanguage = function(event, lang)\r\n    {\r\n      ui.hideKeyboardsPopup(event);\r\n      var e = ui.langKeyboardListNodes[lang.id];\r\n      if(e)\r\n      {\r\n        if(e.style.display==\u0027block\u0027) return ui.hideKeyboardsForLanguage(event);\r\n        e.style.display=\u0027block\u0027;\r\n        ui.keyboardsForLangPopup = e;\r\n        ui.SetupPopupDismissal(e, ui.hideKeyboardsForLanguage);\r\n      }\r\n      return ui.eventCapture(event);\r\n    }\r\n      \r\n    /**\r\n     * Select the language, and either select the keyboard (if unique) or display the list of keyboards\r\n     * available for this language\r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang   \r\n     * @return      {boolean} \r\n     **/    \r\n    ui.selectLanguage = function(event, lang)\r\n    {\r\n      var found=ui.findListedKeyboard(lang), kbd = null;\r\n\r\n      if(found == null)\r\n        kbd = lang.keyboards[0];\r\n      else\r\n        kbd = ui.listedKeyboards[found].keyboard;\r\n      if(!kbd) return false;\r\n\r\n      return ui.selectKeyboard(event,lang,kbd);\r\n    }\r\n\r\n    /**\r\n     * Enable a selected keyboard \r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang\r\n     * @param       {Object}  kbd    \r\n     * @return      {boolean} \r\n     **/  \r\n    ui.selectKeyboard = function(event,lang,kbd) {\r\n      if(ui.selectedLanguage) {\r\n        var found = ui.findListedKeyboard(ui.selectedLanguage);\r\n        if(found != null) {\r\n          ui.listedKeyboards[found].buttonNode.className = \u0027kmw_button\u0027;\r\n        }\r\n      }\r\n\r\n      ui.offButtonNode.className = \u0027kmw_button\u0027;\r\n      ui.selectedLanguage = lang;\r\n      ui.selectedKeyboard = kbd;\r\n\r\n      // In 12.0, this UI class has only been partially converted to BCP-47.\r\n      // `lang.id` refers to the base language identifier and will NOT include \r\n      // any subtags.  We want the FULL language identifier here, with subtags.\r\n      ui.SelectedLanguage = kbd.LanguageCode;\r\n\r\n      // Return focus to input area and activate the selected keyboard \r\n      ui.setLastFocus(); //*****this seems out of sequence???\r\n      ui.addKeyboardToList(lang, kbd);\r\n      keymanweb[\u0027setActiveKeyboard\u0027](kbd[\u0027InternalName\u0027], kbd[\u0027LanguageCode\u0027]);\r\n      ui.listedKeyboards[ui.findListedKeyboard(lang)].buttonNode.className = \u0027kmw_button_selected\u0027;\r\n    \r\n      // Always save current state when selecting a keyboard\r\n      ui.saveCookie();\r\n      ui.enableControls();\r\n      return ui.hideKeyboardsPopup(event) || ui.hideKeyboardsForLanguage(event);\r\n    }  \r\n\r\n    /**\r\n     * Enable all UI controls\r\n     * \r\n     * @return      {boolean} \r\n     **/    \r\n    ui.enableControls = function()\r\n    {\r\n      var elems=[ui.offButtonNode, ui.offBarNode, ui.oskButtonNode, ui.oskBarNode],hideOskButton=false;\r\n\r\n      if(keymanweb[\u0027isCJK\u0027](ui.selectedKeyboard)) hideOskButton = true;\r\n      else if(ui.selectedKeyboard == null) hideOskButton = (elems[2].style.display == \u0027none\u0027)\r\n    \r\n      if(ui.selectedKeyboard != null || ui.listedKeyboards.length \u003e 0)\r\n      {        \r\n        for(var i = 0; i \u003c elems.length; i++) \r\n          elems[i].style.display=\u0027\u0027;\r\n      }\r\n      else\r\n      {\r\n        for(var i = 0; i \u003c elems.length; i++) \r\n          elems[i].style.display=\u0027none\u0027;\r\n      }      \r\n\r\n      if(hideOskButton)\r\n        ui.oskButtonNode.style.display = ui.oskBarNode.style.display = \u0027none\u0027;\r\n\r\n      else if(ui.selectedKeyboard == null)\r\n        ui.oskButtonNode.className=\u0027kmw_button_disabled\u0027;\r\n      //else \r\n      //  ui.oskButtonNode.className=(osk \u0026\u0026 osk[\u0027isEnabled\u0027]() ? \u0027kmw_button_selected\u0027 : \u0027kmw_button\u0027);\r\n      \r\n      // Display the toolbar if still hidden\r\n      ui.toolbarNode.parentNode.style.visibility=\u0027visible\u0027;\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Restore the focus to the last focused element\r\n     **/    \r\n    ui.setLastFocus = function()\r\n    {\r\n      keymanweb[\u0027focusLastActiveElement\u0027]();\r\n    }\r\n\r\n    /**\r\n     * Display or hide the OSK according to user control. This will always force \r\n     * the focus to the last active element if currently unfocused, which is  \r\n     * preferable to not having the OSK appear when the OSK button is clicked.      \r\n     * \r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     **/    \r\n    ui.showOSK = function(event)\r\n    { \r\n      //Toggle OSK on or off\r\n      if(osk \u0026\u0026 keymanweb[\u0027getActiveKeyboard\u0027]() != \u0027\u0027)\r\n      {\r\n        if(osk[\u0027isEnabled\u0027]()) osk[\u0027hide\u0027](); else osk[\u0027show\u0027](true);      \r\n      }\r\n      ui.setLastFocus();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     offButtonClickEvent\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Update the UI when all keyboards disabled by user\r\n     **/    \r\n    ui.offButtonClickEvent = function(event)\r\n    { \r\n      if(ui.toolbarNode.className != \u0027kmw_controls_disabled\u0027)\r\n      {\r\n        ui.hideKeyboardsForLanguage(null);\r\n        if(ui.selectedLanguage)\r\n        {\r\n          var found = ui.findListedKeyboard(ui.selectedLanguage);\r\n          if(found != null) ui.listedKeyboards[found].buttonNode.className = \u0027kmw_button\u0027;\r\n        }\r\n        ui.selectedKeyboard = null;\r\n        ui.selectedLanguage = null;\r\n        ui.SelectedLanguage = \u0027\u0027;\r\n        ui.offButtonNode.className = \u0027kmw_button_selected\u0027;\r\n      }\r\n      // Return the focus to the input area and set the active keyboard to nothing\r\n      ui.setLastFocus();     \r\n      keymanweb[\u0027setActiveKeyboard\u0027](\u0027\u0027,\u0027\u0027);\r\n      \r\n      //Save current state when deselecting a keyboard (may not be needed) \r\n      ui.saveCookie();\r\n      ui.enableControls();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     eventCapture\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Browser-independent event capture\r\n     **/    \r\n    ui.eventCapture = function(event)\r\n    {\r\n      if(!event) event = window.event;\r\n      if(window.event) window.event.returnValue = false;\r\n      if(event) event.cancelBubble = true;\r\n      \r\n      return false;\r\n    }\r\n        \r\n    /**\r\n     * Function     selectRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region   \r\n     * @return      {boolean} \r\n     * Description  Select the region for which to list languages\r\n     **/    \r\n    ui.selectRegion = function(event, region)\r\n    {                     \r\n      var e = ui.browseMapNode;\r\n      if(!e) return ui.eventCapture(event);\r\n      e.className = \u0027kmw_browsemap_\u0027+region;      \r\n      if(typeof(ui.regionLanguageListNodes[region]) == \u0027undefined\u0027) \r\n      {\r\n        ui.updateMap = true; ui.addKeyboardsToMap();\r\n      }\r\n      ui.regionLanguageListNodes[region].style.display=\u0027block\u0027;\r\n      ui.regionNodes[region].className=\u0027selected\u0027;\r\n      if(ui.selectedRegion != null \u0026\u0026 ui.selectedRegion != region)\r\n      {\r\n        ui.regionLanguageListNodes[ui.selectedRegion].style.display=\u0027none\u0027;\r\n        ui.regionNodes[ui.selectedRegion].className=\u0027\u0027;\r\n      }\r\n      ui.selectedRegion = region;\r\n      //ui.saveCookie();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     unhoverRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region   \r\n     * @return      {boolean} \r\n     * Description  Remove highlighting from a region\r\n     **/    \r\n    ui.unhoverRegion = function(event, region)\r\n    {\r\n      ui.browseMapNode.className = (ui.selectedRegion == null ? \u0027\u0027 : \u0027kmw_browsemap_\u0027+ui.selectedRegion);\r\n      ui.regionNodes[region].className=(ui.selectedRegion==region?\u0027selected\u0027:\u0027\u0027);\r\n      return ui.eventCapture(event);\r\n    }\r\n      \r\n    /**\r\n     * Function     hoverRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region \r\n     * @return      {boolean} \r\n     * Description  Highlight a hovered region\r\n     **/    \r\n    ui.hoverRegion = function(event, region)\r\n    {\r\n      ui.browseMapNode.className = \u0027kmw_browsemap_\u0027+region+\u0027_sel\u0027;\r\n      ui.regionNodes[region].className=\u0027hover\u0027;\r\n      return ui.eventCapture(event);\r\n    }\r\n    \r\n    /**\r\n     * Function     pluck\r\n     * Scope        Private\r\n     * @param       {Object}  elem\r\n     * @param       {string}  property   \r\n     * @return      {*} \r\n     * Description  Get the value of an element property\r\n     **/    \r\n    ui.pluck = function(elem, property) {\r\n        return elem.getAttribute ? elem.getAttribute(property) || elem[property] : elem[property];\r\n      };\r\n\r\n    /**\r\n     * Function     focusControlEvent\r\n     * Scope        Private\r\n     * @param       {Object}  params    Object containing Target element (or frame)\r\n     * @return      {boolean}   \r\n     * Description  UI code to be executed on receiving focus\r\n     */\r\n    ui.focusControlEvent = function(params)\r\n    {      \r\n      if(!ui.init) return true;\r\n\r\n      var t=params.target;      \r\n      if(t.tagName.toLowerCase() == \u0027textarea\u0027 || (t.tagName.toLowerCase() == \u0027input\u0027 \u0026\u0026 t.type.toLowerCase() == \u0027text\u0027))\r\n      {\r\n        ui.lastActiveControl = t;\r\n        if(ui.pluck(t, \u0027kmw_disable\u0027))\r\n        {\r\n          if(ui.toolbarNode.className != \u0027kmw_controls_disabled\u0027)\r\n            ui.toolbarNode.className = \u0027kmw_controls_disabled\u0027;\r\n        }\r\n        else\r\n        {\r\n          if(ui.selectedKeyboard != null)\r\n          {\r\n            if(keymanweb[\u0027isCJK\u0027]()) \r\n            {\r\n              ui.oskButtonNode.style.display = ui.oskBarNode.style.display = \u0027none\u0027;\r\n            }\r\n            else\r\n            {\r\n              ui.oskButtonNode.className = (osk \u0026\u0026 osk[\u0027isEnabled\u0027]()) ? \u0027kmw_button_selected\u0027 : \u0027kmw_button\u0027;\r\n            }\r\n          }\r\n            \r\n          if(ui.toolbarNode.className != \u0027\u0027) ui.toolbarNode.className = \u0027\u0027;\r\n          \r\n          var offsetX, offsetY;\r\n          if(t.KMW_HelpOffsetX) offsetX = t.KMW_HelpOffsetX; else offsetX = 64;\r\n          if(t.KMW_HelpOffsetY) offsetY = t.KMW_HelpOffsetY; else offsetY = 0;\r\n          ui.helpOffsetX = util[\u0027getAbsoluteX\u0027](t)+offsetX;\r\n          ui.helpOffsetY = util[\u0027getAbsoluteY\u0027](t)+t.offsetHeight+offsetY;          \r\n        }\r\n      }   \r\n      return true;\r\n    }\r\n    keymanweb[\u0027addEventListener\u0027](\u0027controlfocused\u0027,ui.focusControlEvent);\r\n  \r\n    /**\r\n     * Function     oncontrolblurred\r\n     * Scope        Private\r\n     * Parameters   {Object}  params  Object containing event\r\n     * @return      {boolean}\r\n     * Description  UI code to be executed on losing focus \r\n     */  \r\n    ui.blurControlEvent = function(params)\r\n    {\r\n      if(!ui.init) return true;\r\n\r\n      // Must disable OSK button when not focused\r\n      if(ui.oskButtonNode.style.display != \u0027none\u0027) ui.oskButtonNode.className=\u0027kmw_button_disabled\u0027;\r\n      \r\n      if(!params.event) return true;   // I2404 - Manage IE events in IFRAMEs      \r\n      return true;\r\n    }\r\n    keymanweb[\u0027addEventListener\u0027](\u0027controlblurred\u0027,ui.blurControlEvent);\r\n\r\n\r\n    /**\r\n     * UI action required when keyboard changed indirectly\r\n     * \r\n     * @param       {Object}  p   keyboard selection object\r\n     * @return      {boolean}   \r\n     **/    \r\n    ui.changeKeyboardEvent = function(p)\r\n    {                   \r\n      //if(p[\u0027indirect\u0027]) \r\n      //{          \r\n        var kbName=p[\u0027internalName\u0027],\r\n            lgName=p[\u0027languageCode\u0027];\r\n        if(lgName != \u0027\u0027 \u0026\u0026 kbName != \u0027\u0027)\r\n        {\r\n          var lg = ui.languages[lgName];\r\n          if(lg != null)\r\n          {\r\n            for(var j=0; j\u003clg.keyboards.length; j++)\r\n            {\r\n              if(lg.keyboards[j][\u0027InternalName\u0027] == kbName)\r\n              {\r\n                ui.selectKeyboard(null, lg, lg.keyboards[j]);\r\n                window.focus(); ui.setLastFocus();                       \r\n              }\r\n            }\r\n          }\r\n        }\r\n      //}\r\n      return true;\r\n    }\r\n    keymanweb[\u0027addEventListener\u0027](\u0027keyboardchange\u0027,ui.changeKeyboardEvent);\r\n\r\n\r\n    /**\r\n     * UI action when OSK displayed: restore to or update the saved OSK position\r\n     * \r\n     * @param       {Object}  oskPosition\r\n     * @return      {Object} \r\n     **/    \r\n    ui.onShowOSK = function(oskPosition)\r\n    { \r\n      if(ui.init) ui.oskButtonNode.className = \u0027kmw_button_selected\u0027;\r\n      //The return valu is not currently useful, but allows for the possibility of the OSK restricting or limiting\r\n      //a UI-set position, and returning the corrected position to the UI\r\n      return oskPosition;\r\n    } \r\n    osk[\u0027addEventListener\u0027](\u0027show\u0027,ui.onShowOSK);\r\n\r\n    /**\r\n     * Update appearance of OSK button whenever the OSK is hidden by the user\r\n     * \r\n     * @param       {Object}  p\r\n     **/    \r\n    ui.onHideOSK = function(p)\r\n    {\r\n      if(ui.init \u0026\u0026 p[\u0027HiddenByUser\u0027]) ui.oskButtonNode.className = \u0027kmw_button\u0027;\r\n    }  \r\n    osk[\u0027addEventListener\u0027](\u0027hide\u0027,ui.onHideOSK);\r\n    \r\n    /**\r\n     * Function     showKeyboardsPopup\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Update the map when displayed\r\n     **/    \r\n    ui.showKeyboardsPopup = function(event)\r\n    {                 \r\n      // Add any newly available keyboards to the map\r\n      ui.addKeyboardsToMap();\r\n      \r\n      if(ui.toolbarNode.className == \u0027kmw_controls_disabled\u0027) return ui.eventCapture(event);\r\n      ui.hideKeyboardsForLanguage(null);\r\n      if(ui.selectorNode.className==\u0027kmw_over\u0027) return ui.hideKeyboardsPopup(event);\r\n      ui.selectorNode.className=\u0027kmw_over\u0027;\r\n      ui.keyboardsButtonNode.className=\u0027kmw_button_selected\u0027;\r\n      \r\n      ui.SetupPopupDismissal(ui.selectorNode, ui.hideKeyboardsPopup);\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     hideKeyboardsPopup\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Hide the list of keyboards for this language\r\n     **/    \r\n    ui.hideKeyboardsPopup = function(event)\r\n    {\r\n      ui.selectorNode.className=\u0027\u0027;\r\n      ui.keyboardsButtonNode.className=\u0027kmw_button\u0027;\r\n      ui.CancelPopupDismissal(ui.hideKeyboardsPopup);\r\n      return ui.eventCapture(event);\r\n    }\r\n    \r\n    /**\r\n     * Hide both language and keyboard selection popups on body click\r\n     * @param   {Object}  event\r\n     * @return  {boolean}      \r\n    **/       \r\n    ui.hideAllPopups = function(event)\r\n    {\r\n      var e = ui.keyboardsForLangPopup;\r\n      if((!e || (e.style.display ==\u0027none\u0027)) \u0026\u0026 (ui.selectorNode.className == \u0027\u0027)) return true;\r\n      ui.hideKeyboardsPopup(event);\r\n      ui.hideKeyboardsForLanguage(event);\r\n      return ui.eventCapture(event);    \r\n    }\r\n      \r\n    var dismissalCallback = null, popupElement = null, lastDismissalCallback = null;\r\n    \r\n    /**\r\n     * Function     PopupDismissal\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {Object} \r\n     * Description  Carry out action when popup dismissed\r\n     **/    \r\n    ui.PopupDismissal = function(event)\r\n    {               \r\n      var t = (event \u0026\u0026 event.target) || (window.event \u0026\u0026 window.event.srcElement);\r\n      if(t)\r\n      {            \r\n        while(t.parentNode)\r\n        {\r\n          if (t == popupElement) return null;\r\n          t = t.parentNode;\r\n        }\r\n      }    \r\n      if(t.nodeName == \u0027#document\u0027) ui.hideAllPopups(event); //KMEW-41, fixed for build 356.\r\n      return dismissalCallback;\r\n    }\r\n    \r\n    /**\r\n     * Function     SetupPopupDismissal\r\n     * Scope        Private\r\n     * @param       {Object}            element    \r\n     * @param       {function(Object)}  callback\r\n     * Description  Prepare for callback dismissal\r\n     **/    \r\n    ui.SetupPopupDismissal = function(element, callback)\r\n    {\r\n      if(ui.PopupDismissal == document.onclick)\r\n        ui.CancelPopupDismissal(dismissalCallback);\r\n      dismissalCallback = callback;\r\n      popupElement = element;\r\n      lastDismissalCallback = document.onclick;\r\n      document.onclick = ui.PopupDismissal;\r\n    }\r\n    \r\n    /**\r\n     * Function     CancelPopupDismissal\r\n     * Scope        Private\r\n     * @param       {?function(Object)}  callback\r\n     * Description  Cancel callback dismissal\r\n     **/    \r\n    ui.CancelPopupDismissal = function(callback)\r\n    {\r\n      if(ui.PopupDismissal == document.onclick)\r\n      {\r\n        document.onclick = lastDismissalCallback;\r\n        lastDismissalCallback = null;\r\n        dismissalCallback = null;\r\n        popupElement = null;\r\n      }\r\n    }\r\n    \r\n    /**\r\n     * Load the previous state from the KeymanWeb_Keyboard and KeymanWeb_Toolbar cookies\r\n     **/\r\n    ui.loadCookie = function()\r\n    {\r\n      var currentKeyboard=\u0027\u0027,currentLgCode=\u0027\u0027,c=util[\u0027loadCookie\u0027](\"KeymanWeb_Keyboard\");          \r\n      if(c[\u0027current\u0027] != undefined) currentKeyboard = c[\u0027current\u0027].split(\u0027:\u0027)[0];\r\n      c=util[\u0027loadCookie\u0027](\"KeymanWeb_Toolbar\"); \r\n\r\n      if(c[\u0027region\u0027] != undefined) ui.selectedRegion = c[\u0027region\u0027];\r\n      if(c[\u0027maxrecent\u0027] != undefined)\r\n      {\r\n        for(var i=0; i\u003cc[\u0027maxrecent\u0027]; i++)\r\n        {\r\n          if(c[\u0027recent\u0027+i] != undefined)    \r\n          { \r\n            var r=c[\u0027recent\u0027+i].split(\u0027,\u0027);\r\n            if(r.length == 2)\r\n            {\r\n              var k = ui.languages[r[0]];\r\n              if(k != null)\r\n              {\r\n                for(var j=0; j\u003ck.keyboards.length; j++)\r\n                {\r\n                  if(k.keyboards[j][\u0027InternalName\u0027] == r[1])\r\n                  {\r\n                    ui.addKeyboardToList(k, k.keyboards[j]);\r\n                    if(k.keyboards[j][\u0027InternalName\u0027] == currentKeyboard)\r\n                    { \r\n                      ui.selectKeyboard(null, k, k.keyboards[j]);\r\n                      window.focus(); ui.setLastFocus();\r\n                      break;                      \r\n                    }  \r\n                    break;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      // If language list and keyboard list have not yet been saved as a cookie, \r\n      // initialize to the current (default) language and keyboard, if set by KMW \r\n      else\r\n      {\r\n        var kbName=keymanweb[\u0027getActiveKeyboard\u0027](),\r\n            lgName=keymanweb[\u0027getActiveLanguage\u0027]();\r\n        if(lgName != \u0027\u0027 \u0026\u0026 kbName != \u0027\u0027)\r\n        {\r\n          var lg = ui.languages[lgName];\r\n          if(lg != null)\r\n          {\r\n            for(var j=0; j\u003clg.keyboards.length; j++)\r\n            {\r\n              if(lg.keyboards[j][\u0027InternalName\u0027] == kbName)\r\n              {\r\n                ui.selectKeyboard(null, lg, lg.keyboards[j]);\r\n                window.focus(); ui.setLastFocus();                       \r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Save the current UI state in the KeymanWeb_Toolbar cookie\r\n     **/  \r\n    ui.saveCookie = function()\r\n    {\r\n      var vs={};\r\n      vs[\u0027region\u0027] = ui.selectedRegion;\r\n      vs[\u0027maxrecent\u0027] = \u0027\u0027+ui.listedKeyboards.length; \r\n      for(var i=0; i\u003cui.listedKeyboards.length; i++)\r\n        vs[\u0027recent\u0027+i] = ui.listedKeyboards[i].lang.id+\",\"+ui.listedKeyboards[i].keyboard[\u0027InternalName\u0027];\r\n      util[\u0027saveCookie\u0027](\u0027KeymanWeb_Toolbar\u0027,vs);\r\n    }\r\n\r\n    // Initialize when everything defined (replaces unreliable onload event handler)\r\n    // ui.initToolbarUI(); \r\n    // No, initialization must not be done before KMW is ready!\r\n    // ui.initialize() is now called by keymanweb when document is ready and kmw initialization completed\r\n      \r\n  } catch(ex){}\r\n}"],"names":["window","keymanweb","osk","util","init","toolbarNode","backgroundNode","browseMapNode","keyboardsButtonNode","languageButtonsNode","offButtonNode","offBarNode","oskButtonNode","oskBarNode","selectorNode","regionLanguageListNodes","regionNodes","langKeyboardNodes","langKeyboardListNodes","selectedRegion","listedKeyboards","catchAllRegion","keyboardListPriority","maxListedKeyboards","lastActiveControl","selectedKeyboard","selectedLanguage","helpOffsetX","helpOffsetY","languages","updateMap","startTimer","lgText","ui","ToolBar_Text","Keyboards","OffTitle","Off","ShowOSK","LanguageSelector","createNode","ui.createNode","tag","id","className","innerHTML","node","document","createElement","ondragstart","node.ondragstart","initToolbarUI","ui.initToolbarUI","e","getElementById","body","insertBefore","firstChild","_insertedElem","style","visibility","maxHeight","regions","t","m","display","tbNode","href","target","appendChild","title","aNode","onclick","showKeyboardsPopup","regionsNode","imgNode","src","useMap","mapNode","name","i","areaNode","shape","alt","hidefocus","event","selectRegion","onmouseover","hoverRegion","onmouseout","unhoverRegion","coords","nohref","eventCapture","listNode","itemNode","offButtonClickEvent","showOSK","img","clearTimeout","setTimeout","addKeyboardsToMap","hideAllPopups","shutdown","ui.shutdown","root","parentNode","removeChild","ui.addKeyboardsToMap","n","sort","sortKeyboards","childNodes","length","colNode","max","count","languageCode","j","kbdRegion","bcpSubtags","Number","toFixed","x","keyboards","push","concat","langNode","lang","selectLanguage","loadCookie","enableControls","ui.sortKeyboards","a","b","findListedKeyboard","ui.findListedKeyboard","addKeyboardToList","ui.addKeyboardToList","kbd","found","oldestPriority","oldestFound","priority","rk","buttonNode","slice","p1","p2","toLowerCase","indexOf","aNode.onclick","truncate","thisANode","showKeyboardsForLanguage","divNode","kbdText","replace","LanguageCode","selectKeyboard","keyboard","ui.truncate","PName","PLen","substr","registerKeyboard","ui.registerKeyboard","hideKeyboardsForLanguage","ui.hideKeyboardsForLanguage","keyboardsForLangPopup","CancelPopupDismissal","ui.showKeyboardsForLanguage","hideKeyboardsPopup","SetupPopupDismissal","ui.selectLanguage","ui.selectKeyboard","SelectedLanguage","setLastFocus","saveCookie","ui.enableControls","elems","hideOskButton","ui.setLastFocus","ui.showOSK","ui.offButtonClickEvent","ui.eventCapture","returnValue","cancelBubble","ui.selectRegion","region","ui.unhoverRegion","ui.hoverRegion","pluck","ui.pluck","elem","getAttribute","property","focusControlEvent","ui.focusControlEvent","params","tagName","type","offsetX","KMW_HelpOffsetX","offsetY","KMW_HelpOffsetY","offsetHeight","blurControlEvent","ui.blurControlEvent","changeKeyboardEvent","ui.changeKeyboardEvent","p","kbName","lgName","lg","focus","onShowOSK","ui.onShowOSK","oskPosition","onHideOSK","ui.onHideOSK","ui.showKeyboardsPopup","ui.hideKeyboardsPopup","ui.hideAllPopups","dismissalCallback","popupElement","lastDismissalCallback","PopupDismissal","ui.PopupDismissal","srcElement","nodeName","ui.SetupPopupDismissal","element","callback","ui.CancelPopupDismissal","ui.loadCookie","currentKeyboard","c","undefined","split","r","k","ui.saveCookie","vs","ex"],"sourceRoot":"/keyman/web/source/"}
