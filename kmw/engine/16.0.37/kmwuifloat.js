(function() {if(!window.keyman.ui.name)try{var a=window.keyman,d=a.util;if(d.isTouchDevice())throw"";a.ui={};var e=a.ui;e.name="float";e.a=null;e.b=null;e.h=null;e.i=null;e.f=null;e.u=!1;e.v=!0;e.w=null;e.s=!1;e.c=!1;e.L=function(){a.activatingUI(!0);var b=a.osk;b&&b.show&&(b.isEnabled()?b.hide():b.show(!0));window.event&&(window.event.returnValue=!1);a.focusLastActiveElement();a.activatingUI(!1);return!1};e.initialize=e.j=function(){if(!a.initialized)window.setTimeout(e.j,50);else if(!e.c&&!d.isTouchDevice()){var b=
d.getOption("resources")+"ui/float/";e.b=d.createElement("DIV");e.h=d.createElement("DIV");e.f=d.createElement("IMG");e.b.innerHTML="<a href='http://keyman.com/web/' target='KeymanWebHelp'><img src='"+b+"kmicon.gif' border='0' style='padding: 0px 2px 0 1px; margin:0px;' title='KeymanWeb' alt='KeymanWeb' /></a>";var c=e.b.style;c.backgroundColor="white";c.border="solid 1px black";c.position="absolute";c.height="18px";c.font="bold 8pt sans-serif";c.display="none";c.textAlign="left";c.overflow="hidden";
d.attachDOMEvent(e.b,"mousedown",e.H);d.attachDOMEvent(e.b,"mouseover",e.J);d.attachDOMEvent(e.b,"mouseout",e.I);e.K();e.f.src=b+"kbdicon.gif";e.f.title="Display visual keyboard";e.l(!1);b=d.createElement("DIV");e.i=b;b.onclick=e.L;b.appendChild(e.f);e.h.appendChild(b);e.b.appendChild(e.h);document.body.appendChild(e.b);e.a=d.createElement("SELECT");c=e.a.style;c.font="8pt sans-serif";c.backgroundColor="#f3e5de";c.border="solid 1px #7B9EBD";c.height="16px";c.margin="1px 2px 0px 2px";c.left="20px";
c.top="0px";c.position="absolute";c.maxWidth="150px";d.attachDOMEvent(e.a,"change",e.G);d.attachDOMEvent(e.a,"blur",e.F);e.h.appendChild(e.a);c=d.getOption("ui");b="(System keyboard)";c&&"object"==typeof c&&("string"==typeof c.position&&"right"==c.position&&(e.s=!0),"string"==typeof c["default"]&&(b=c["default"]));c=d.createElement("OPTION");c.value="-";c.innerHTML=b;e.a.appendChild(c);e.c=!0;e.D()}};e.C=function(){e.a=e.h=e.b=e.f=null};a.addEventListener("unloaduserinterface",e.C);e.M=function(){var b=
e.b;b&&b.parentNode.removeChild(b);e.C();window.removeEventListener&&window.removeEventListener("resize",e.B,!1)};e.D=function(){if(e.v){e.c||e.j();var b,c=e.a.getElementsByTagName("OPTION");for(b=c.length;1<b;b--)e.a.removeChild(c[b-1]);var f=a.getKeyboards();for(b=0;b<f.length;b++){c=d.createElement("OPTION");c.value=f[b].InternalName+":"+f[b].LanguageCode;c.innerHTML=f[b].Name.replace(/\s?keyboard/i,"");if(f[b].LanguageName){var g=f[b].LanguageName;g=g.split(",")[0];-1==f[b].Name.search(g)&&(c.innerHTML=
g+" ("+c.innerHTML+")")}e.a.appendChild(c)}}e.v=!1;b=a.getSavedKeyboard().split(":");2>b.length&&(b[1]="");e.m(b[0],b[1]);a.getLastActiveElement()&&(e.A(),e.g())};e.m=function(b,c){if(e.c){var f=b;""!=c&&(f+=":"+c);if(""==b)e.a.selectedIndex=0;else{var g=e.a.getElementsByTagName("OPTION");for(b=0;b<g.length;b++){var h=g[b].value;""==c&&(h=h.split(":")[0]);if(h==f){e.a.selectedIndex=b;break}}}}};e.l=function(b){var c=e.f.style;c.width="24px";c.height="13px";c.top="1px";c.verticalAlign="bottom";c.padding=
"2px 2px 1px 2px";c.position="absolute";c.border=b?"inset 1px #808080":"none";c.background=b?"#f7e7de":"white";c.display="block";e.c&&(e.i.style.display="block")};e.K=function(){a.addEventListener("keyboardregistered",function(){e.v=!0;e.w&&clearTimeout(e.w);e.w=setTimeout(e.D,200)});a.addEventListener("keyboardloaded",function(){var c=a.getSavedKeyboard().split(":");1<c.length&&e.m(c[0],c[1])});a.addEventListener("keyboardchange",function(c){e.m(c.internalName,c.languageCode);e.o()});var b=a.osk;
b&&(b.addEventListener("show",function(c){e.o();return c}),b.addEventListener("hide",function(){e.c&&e.l(!1)}))};e.H=function(){a.activatingUI&&a.activatingUI(1)};e.J=function(){a.activatingUI&&a.activatingUI(1)};e.I=function(){a.activatingUI&&a.activatingUI(0)};e.G=function(){a.activatingUI(!0);if("-"!=e.a.value){var b=e.a.options[e.a.selectedIndex].value.split(":");a.setActiveKeyboard(b[0],b[1])}else a.setActiveKeyboard("");a.focusLastActiveElement();a.activatingUI(!1);e.u=!0};e.F=function(){e.u||
a.focusLastActiveElement();e.u=!1};e.g=function(b,c){if(e.c){var f=e.b.style;b&&c&&(f.left=b+"px",f.top=c+"px");f.display="block";e.f.style.left=e.a.offsetWidth+24+"px";e.o();e.m(a.getActiveKeyboard(),a.getActiveLanguage())}};e.A=function(){e.c&&(e.b.style.display="none")};e.o=function(){if(null!=e.i)if(a.isCJK()||0==e.a.selectedIndex)e.i.style.display="none",e.b.style.width=e.a.offsetWidth+30+"px";else{e.i.style.display="block";var b=a.osk;b?e.l(b.isEnabled()):e.l(!1);e.b.style.width=e.a.offsetWidth+
56+"px"}};a.addEventListener("controlfocused",function(b){if(null==b.activeControl||b.activeControl._kmwAttachment)e.s?e.g(d.getAbsoluteX(b.target)+b.target.offsetWidth+1,d.getAbsoluteY(b.target)+1):e.g(d.getAbsoluteX(b.target),d.getAbsoluteY(b.target)-parseInt(d.getStyleValue(e.b,"height"),10)-2);return!0});a.addEventListener("controlblurred",function(b){if(!b.event)return!0;b.isActivating||e.A();return!0});e.B=function(){if("block"==e.b.style.display){var b=a.getLastActiveElement();e.s?e.g(d.getAbsoluteX(b)+
b.offsetWidth+1,d.getAbsoluteY(b)+1):e.g(d.getAbsoluteX(b)+1,d.getAbsoluteY(b)+b.offsetHeight+1)}return!0};window.addEventListener&&window.addEventListener("resize",e.B,!1);a.addEventListener("loaduserinterface",e.j);e.j()}catch(b){};}());
//# sourceMappingURL=kmwuifloat.js.map
