var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,g){b!=Array.prototype&&b!=Object.prototype&&(b[a]=g.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,g,l){if(a){g=$jscomp.global;b=b.split(".");for(l=0;l<b.length-1;l++){var h=b[l];h in g||(g[h]={});g=g[h]}b=b[b.length-1];l=g[b];a=a(l);a!=l&&null!=a&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:a})}};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},a={};try{return a.__proto__=b,a.a}catch(g){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,a){b.__proto__=a;if(b.__proto__!==a)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(a,b,l){var h=this.length||0;0>b&&(b=Math.max(0,h+b));if(null==l||l>h)l=h;l=Number(l);0>l&&(l=Math.max(0,h+l));for(b=Number(b||0);b<l;b++)this[b]=a;return this}},"es6","es3");var com;
(function(b){(function(a){var b=function(){return function(){}}();a.KeyEvent=b;b=function(){return function(a,b){this.keyboard=a;this.touchEnabled=b}}();a.AttachmentInfo=b;b=function(){return function(){}}();a.LegacyKeyEvent=b;b=function(){return function(){}}();a.KeyInformation=b;b=function(){return function(a,b){this.cmd=a;this.state=b}}();a.StyleCommand=b})(b.keyman||(b.keyman={}))})(com||(com={}));
function finallyConstructor(b){var a=this.constructor;return this.then(function(g){return a.resolve(b()).then(function(){return g})},function(g){return a.resolve(b()).then(function(){return a.reject(g)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(b,a){return function(){b.apply(a,arguments)}}
function Promise(b){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!==typeof b)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(b,this)}
function handle(b,a){for(;3===b._state;)b=b._value;0===b._state?b._deferreds.push(a):(b._handled=!0,Promise._immediateFn(function(){var g=1===b._state?a.onFulfilled:a.onRejected;if(null===g)(1===b._state?resolve:reject)(a.promise,b._value);else{try{var l=g(b._value)}catch(h){reject(a.promise,h);return}resolve(a.promise,l)}}))}
function resolve(b,a){try{if(a===b)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"===typeof a||"function"===typeof a)){var g=a.then;if(a instanceof Promise){b._state=3;b._value=a;finale(b);return}if("function"===typeof g){doResolve(bind(g,a),b);return}}b._state=1;b._value=a;finale(b)}catch(l){reject(b,l)}}function reject(b,a){b._state=2;b._value=a;finale(b)}
function finale(b){2===b._state&&0===b._deferreds.length&&Promise._immediateFn(function(){b._handled||Promise._unhandledRejectionFn(b._value)});for(var a=0,g=b._deferreds.length;a<g;a++)handle(b,b._deferreds[a]);b._deferreds=null}function Handler(b,a,g){this.onFulfilled="function"===typeof b?b:null;this.onRejected="function"===typeof a?a:null;this.promise=g}
function doResolve(b,a){var g=!1;try{b(function(b){g||(g=!0,resolve(a,b))},function(b){g||(g=!0,reject(a,b))})}catch(l){g||(g=!0,reject(a,l))}}Promise.prototype["catch"]=function(b){return this.then(null,b)};Promise.prototype.then=function(b,a){var g=new this.constructor(noop);handle(this,new Handler(b,a,g));return g};Promise.prototype["finally"]=finallyConstructor;
Promise.all=function(b){return new Promise(function(a,g){function l(c,d){try{if(d&&("object"===typeof d||"function"===typeof d)){var e=d.then;if("function"===typeof e){e.call(d,function(d){l(c,d)},g);return}}h[c]=d;0===--f&&a(h)}catch(q){g(q)}}if(!b||"undefined"===typeof b.length)throw new TypeError("Promise.all accepts an array");var h=Array.prototype.slice.call(b);if(0===h.length)return a([]);for(var f=h.length,k=0;k<h.length;k++)l(k,h[k])})};
Promise.resolve=function(b){return b&&"object"===typeof b&&b.constructor===Promise?b:new Promise(function(a){a(b)})};Promise.reject=function(b){return new Promise(function(a,g){g(b)})};Promise.race=function(b){return new Promise(function(a,g){for(var l=0,h=b.length;l<h;l++)b[l].then(a,g)})};Promise._immediateFn="function"===typeof setImmediate&&function(b){setImmediate(b)}||function(b){setTimeoutFunc(b,0)};
Promise._unhandledRejectionFn=function(b){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",b)};var globalNS=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}();"Promise"in globalNS?globalNS.Promise.prototype["finally"]||(globalNS.Promise.prototype["finally"]=finallyConstructor):globalNS.Promise=Promise;
var __extends=this&&this.__extends||function(){var b=function(a,g){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])};return b(a,g)};return function(a,g){function l(){this.constructor=a}b(a,g);a.prototype=null===g?Object.create(g):(l.prototype=g.prototype,new l)}}();
(function(b){(function(a){var g=function(){function a(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._SelectionControl=this._Selection=null;this.modStateFlags=0}a.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),1E3)};return a}();a.CommonDOMStates=g;var l=function(){function a(f){this.setFocus=function(c){}.bind(this);this.flashCaret=function(){}.bind(this);this.setBlur=function(c){}.bind(this);this._ControlFocus=
function(c){var d=this.keyman.util.device,e=this.keyman.osk;c=this.keyman._GetEventObject(c);c=this.keyman.util.eventTarget(c);if(null==c||d.touchable&&(null==c.className||0>c.className.indexOf("keymanweb-input")))return!0;c.nodeName.toLowerCase();if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLInputElement){var f=c.type.toLowerCase();if("text"!=f&&"search"!=f)return!0}else if(!(!d.touchable&&c.isContentEditable||c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement))return!0;
h.states.activeElement=c;3==c.nodeType&&(c=c.parentNode);f=c;(null==c.className||0>c.className.indexOf("keymanweb-input"))&&this instanceof h&&this.scrollBody(c);c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(c),c=c.contentWindow.document);var b=a.states.lastActiveElement;a.states.lastActiveElement=c;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings():this._FocusKeyboardSettings(b?!1:!0);if(this._CommonFocusHelper(c))return!0;
c._KeymanWebSelectionStart=c._KeymanWebSelectionEnd=null;c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(c);this.doControlFocused(f,a.states.lastActiveElement);d.touchable?e._Enabled=1:e.ready&&(this.keyman.keyboardManager.isCJK()&&(e._Enabled=1),e._Enabled?e._Show():e._Hide(!1));return!0}.bind(this);this._ControlBlur=function(c){c=this.keyman._GetEventObject(c);var d=this.keyman.util.eventTarget(c);if(null==d)return!0;a.states.activeElement=
null;this instanceof h&&this.hideCaret();3==d.nodeType&&(d=d.parentNode);d.ownerDocument&&(d instanceof d.ownerDocument.defaultView.HTMLIFrameElement&&(d=d.contentWindow.document),d instanceof d.ownerDocument.defaultView.HTMLInputElement||d instanceof d.ownerDocument.defaultView.HTMLTextAreaElement)&&(d._KeymanWebSelectionStart=d.value._kmwCodeUnitToCodePoint(d.selectionStart),d._KeymanWebSelectionEnd=d.value._kmwCodeUnitToCodePoint(d.selectionEnd));this._BlurKeyboardSettings();a.states.lastActiveElement=
d;this.keyman.uiManager.justActivated=!1;var e=this.keyman.uiManager.isActivating;e||this.keyman.keyboardManager.notifyKeyboard(0,d,0);this.doControlBlurred(d,c,e);this.keyman.osk.ready&&!e&&this.keyman.osk._Hide(!1);this.doChangeEvent(d);this.keyman.interface.resetContext();return!0}.bind(this);this._SelectionChange=function(){a.states._IgnoreNextSelChange&&a.states._IgnoreNextSelChange--;return!0}.bind(this);this._KeyDown=function(c){var d=this.keyman.keyboardManager.activeKeyboard,e=this.keyman.osk,
f=this.keyman.util,b=this.keyman["interface"];a.states._KeyPressToSwallow=0;if(a.states._DisableInput||null==d)return!0;var k=f.eventTarget(c);if(f.device.touchable){if(k&&"undefined"!=typeof k.kmwInput&&0==k.kmwInput)return!0}else if(k&&0<=k.className.indexOf("kmw-disabled"))return!0;if(!e.ready)return!0;k=this._GetKeyEventProperties(c,!0);if(null==k)return!0;switch(k.Lcode){case 8:b.clearDeadkeys();break;case 16:case 17:case 18:case 20:case 144:case 145:return this.keyman.keyboardManager.notifyKeyboard(k.Lcode,
k.Ltarg,1),f.device.touchable?!0:e._UpdateVKShift(k,k.Lcode-15,1)}k.LmodifierChange&&(this.keyman.keyboardManager.notifyKeyboard(0,k.Ltarg,1),e._UpdateVKShift(k,0,1));!window.event&&this.keyman.keyMapManager.browserMap.FF["k"+k.Lcode]&&(k.Lcode=this.keyman.keyMapManager.browserMap.FF["k"+k.Lcode]);if(d.KM){if(8==k.Lcode)return a.states._KeyPressToSwallow=1,b.processKeystroke(f.physicalDevice,k.Ltarg,k)||this.keyman.interface.defaultBackspace(),!1;a.states._KeyPressToSwallow=0;h=h||b.processKeystroke(f.physicalDevice,
k.Ltarg,k)}else{var h=0,g=this.keyman.keyMapManager.languageMap[e._BaseLayout];g&&g["k"+k.Lcode]&&(k.Lcode=g["k"+k.Lcode]);"undefined"!=typeof d.KM||k.Lmodifiers&96||(g={Lcode:this.keyman.keyMapManager._USKeyCodeToCharCode(k),Ltarg:k.Ltarg,Lmodifiers:0,LisVirtualKey:0},b.processKeystroke(f.physicalDevice,g.Ltarg,g)&&(h=1));h=h||b.processKeystroke(f.physicalDevice,k.Ltarg,k);8==k.Lcode&&!h&&null!=k.Ltarg.className&&0<=k.Ltarg.className.indexOf("keymanweb-input")&&this.keyman.interface.defaultBackspace()}!h&&
96<=k.Lcode&&111>=k.Lcode&&!d.KM&&(b.output(0,k.Ltarg,String._kmwFromCharCode(106>k.Lcode?k.Lcode-48:k.Lcode-64)),h=1);if(h)return c&&c.preventDefault&&(c.preventDefault(),c.stopPropagation()),a.states._KeyPressToSwallow=c?this._GetEventKeyCode(c):0,!1;a.states._KeyPressToSwallow=0;return 8==k.Lcode&&null!=k.Ltarg.className&&0<=k.Ltarg.className.indexOf("keymanweb-input")?!1:"undefined"!=typeof k.Ltarg.base&&(c=e.defaultKeyOutput("",k.Lcode,k.Lmodifiers,!1,k.Ltarg))?(b.output(0,k.Ltarg,c),!1):!0}.bind(this);
this._KeyPress=function(c){if(a.states._DisableInput||null==this.keyman.keyboardManager.activeKeyboard)return!0;var d=this._GetKeyEventProperties(c);if(null==d||d.LisVirtualKey)return!0;if(!this.keyman.keyboardManager.activeKeyboard.KM){if(!a.states._KeyPressToSwallow||32>d.Lcode||this.keyman._BrowserIsSafari&&63232<d.Lcode&&63744>d.Lcode)return!0;if(c=this.keyman._GetEventObject(c))c.returnValue=!1;return!1}if(a.states._KeyPressToSwallow||this.keyman["interface"].processKeystroke(this.keyman.util.physicalDevice,
d.Ltarg,d))return a.states._KeyPressToSwallow=0,c&&c.preventDefault&&(c.preventDefault(),c.stopPropagation()),!1;a.states._KeyPressToSwallow=0;return!0}.bind(this);this._KeyUp=function(c){var d=this.keyman.keyboardManager,a=this.keyman.osk;c=this._GetKeyEventProperties(c,!1);if(null==c||!a.ready)return!0;switch(c.Lcode){case 13:if(c.Ltarg instanceof c.Ltarg.ownerDocument.defaultView.HTMLTextAreaElement)break;if(c.Ltarg.base&&c.Ltarg.base instanceof c.Ltarg.base.ownerDocument.defaultView.HTMLTextAreaElement)break;
c.Ltarg instanceof c.Ltarg.ownerDocument.defaultView.HTMLInputElement&&(d=c.Ltarg,"search"==d.type||"submit"==d.type?d.form.submit():this.keyman.domManager.moveToNext(!1));return!0;case 16:case 17:case 18:case 20:case 144:case 145:return d.notifyKeyboard(c.Lcode,c.Ltarg,0),this.keyman.util.device.touchable?!0:a._UpdateVKShift(c,c.Lcode-15,1)}c.LmodifierChange&&(d.notifyKeyboard(0,c.Ltarg,0),a._UpdateVKShift(c,0,1));return!1}.bind(this);this.keyman=f}a.prototype.getText=function(a){return""};a.prototype.setText=
function(a,c,d){};a.prototype.getTextBeforeCaret=function(a){return""};a.prototype.setTextBeforeCaret=function(a,c){};a.prototype.getTextCaret=function(a){return 0};a.prototype.setTextCaret=function(a,c){};a.prototype.hideCaret=function(){};a.prototype.updateInput=function(a){};a.prototype.doControlFocused=function(a,c){var d={};d.target=a;d.activeControl=c;return this.keyman.util.callEvent("kmw.controlfocused",d)};a.prototype.doControlBlurred=function(a,c,d){var e={};e.target=a;e.event=c;e.isActivating=
d;return this.keyman.util.callEvent("kmw.controlblurred",e)};a.prototype._BlurKeyboardSettings=function(f,c){var d=this.keyman.keyboardManager.activeKeyboard?this.keyman.keyboardManager.activeKeyboard.KI:"",e=this.keyman.keyboardManager.getActiveLanguage();void 0!==f&&void 0!==c&&(d=f,e=c);(f=a.states.lastActiveElement)&&null!=f._kmwAttachment.keyboard?(f._kmwAttachment.keyboard=d,f._kmwAttachment.languageCode=e):(this.keyman.globalKeyboard=d,this.keyman.globalLanguageCode=e)};a.prototype._FocusKeyboardSettings=
function(f){var c=a.states.lastActiveElement;c&&null!=c._kmwAttachment.keyboard?this.keyman.keyboardManager.setActiveKeyboard(c._kmwAttachment.keyboard,c._kmwAttachment.languageCode):f||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode)};a.prototype._CommonFocusHelper=function(f){var c=this.keyman.uiManager;if(f.ownerDocument&&f instanceof f.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(f,1)||!this.keyman.domManager._IsMozillaEditableIframe(f,
1)))return a.states._DisableInput=!0;a.states._DisableInput=!1;c.justActivated||(this.keyman["interface"]._DeadKeys=[],this.keyman.keyboardManager.notifyKeyboard(0,f,1));c.justActivated||a.states._SelectionControl==f||(c.isActivating=!1);c.justActivated=!1;a.states._SelectionControl=f;return!1};a.prototype._GetEventKeyCode=function(a){return a.keyCode?a.keyCode:a.which?a.which:null};a.prototype._GetKeyEventProperties=function(f,c){c=new b.keyman.KeyEvent;f=this.keyman._GetEventObject(f);c.Ltarg=this.keyman.util.eventTarget(f);
if(null==c.Ltarg||!0===f.cancelBubble)return null;3==c.Ltarg.nodeType&&(c.Ltarg=c.Ltarg.parentNode);c.Lcode=this._GetEventKeyCode(f);if(null==c.Lcode)return null;var d=this.keyman.osk,e=this.keyman.keyboardManager.activeKeyboard;if(e&&e.KM&&c.Lcode!=d.keyCodes.K_SPACE){var h=d.defaultKeyOutput("K_xxxx",c.Lcode,f.getModifierState("Shift")?16:0,!1,null);h&&(c.Lcode=h.charCodeAt(0))}h=a.states.modStateFlags;var k=!1,g=!1;switch(c.Lcode){case d.keyCodes.K_CTRL:case d.keyCodes.K_LCTRL:case d.keyCodes.K_RCTRL:case d.keyCodes.K_CONTROL:case d.keyCodes.K_LCONTROL:case d.keyCodes.K_RCONTROL:k=
!0;break;case d.keyCodes.K_LMENU:case d.keyCodes.K_RMENU:case d.keyCodes.K_ALT:case d.keyCodes.K_LALT:case d.keyCodes.K_RALT:g=!0}var l=0|(f.getModifierState("Shift")?16:0);f.getModifierState("Control")&&(l|=0!=f.location&&k?1==f.location?d.modifierCodes.LCTRL:d.modifierCodes.RCTRL:h&3);f.getModifierState("Alt")&&(l|=0!=f.location&&g?1==f.location?d.modifierCodes.LALT:d.modifierCodes.RALT:h&12);c.Lstates=0;f.getModifierState("CapsLock")?c.Lstates=d.modifierCodes.CAPS:c.Lstates=d.modifierCodes.NO_CAPS;
f.getModifierState("NumLock")?c.Lstates|=d.modifierCodes.NUM_LOCK:c.Lstates|=d.modifierCodes.NO_NUM_LOCK;f.getModifierState("ScrollLock")||f.getModifierState("Scroll")?c.Lstates|=d.modifierCodes.SCROLL_LOCK:c.Lstates|=d.modifierCodes.NO_SCROLL_LOCK;l|=c.Lstates;c.LmodifierChange=a.states.modStateFlags!=l;a.states.modStateFlags=l;e&&e.KM&&f.getModifierState("CapsLock")&&(65<=c.Lcode&&90>=c.Lcode||97<=c.Lcode&&122>=c.Lcode)&&(l^=16,c.Lcode^=32);e=d.modifierCodes.RALT|d.modifierCodes.LCTRL;(h&e)==e&&
(l&e)!=e&&(l&=~e);l&d.modifierCodes.RALT&&(l&=~d.modifierCodes.LCTRL);this.keyman.keyboardManager.isChiral()?(c.Lmodifiers=l&d.modifierBitmasks.CHIRAL,d.emulatesAltGr()&&(c.Lmodifiers&d.modifierBitmasks.ALT_GR_SIM)==d.modifierBitmasks.ALT_GR_SIM&&(c.Lmodifiers^=d.modifierBitmasks.ALT_GR_SIM,c.Lmodifiers|=d.modifierCodes.RALT)):c.Lmodifiers=l&16|(l&(d.modifierCodes.LCTRL|d.modifierCodes.RCTRL)?32:0)|(l&(d.modifierCodes.LALT|d.modifierCodes.RALT)?64:0);c.LisVirtualKeyCode="undefined"!=typeof f.charCode&&
null!=f.charCode&&(0==f.charCode||0!=(c.Lmodifiers&111));c.LisVirtualKey=c.LisVirtualKeyCode||"keypress"!=f.type;return c};a.prototype.doChangeEvent=function(f){if(a.states.changed){if("function"==typeof Event)var c=new Event("change",{bubbles:!0,cancelable:!1});else c=document.createEvent("HTMLEvents"),c.initEvent("change",!0,!1);f.base&&f.base.kmw_ip&&(f=f.base);f.dispatchEvent(c)}a.states.changed=!1};a.states=new g;return a}();a.DOMEventHandlers=l;var h=function(f){function b(c){c=f.call(this,
c)||this;c.setFocus=function(c){var d=this.keyman.osk,f=this.keyman.util;l.states.setFocusTimer();if(a.Util.instanceof(c,"TouchEvent"))var b=c.touches[0];else b={clientX:0,clientY:0},b.target=l.states.lastActiveElement?l.states.lastActiveElement.kmw_ip:this.keyman.domManager.sortedInputs[0].kmw_ip;c=b.clientX;var h=b.clientY,k=b.target;var g=a.Util.instanceof(k,"HTMLSpanElement")?k.parentNode:null!=k.className&&0<=k.className.indexOf("keymanweb-input")?k.firstChild:k;b=g.parentNode;l.states.activeElement!=
b&&(this.hideCaret(),l.states.activeElement=b,b.focus());this.keyman.domManager._SetTargDir(b);d.ready&&!d._Visible&&d._Show();if(a.Util.instanceof(k,"HTMLDivElement"))h=f._GetAbsoluteX(g.firstChild),"rtl"==b.dir?(h+=g.firstChild.offsetWidth,d=c>h?0:1E5):d=c<h?0:1E5,this.setTextCaret(b,d),this.scrollInput(b);else{var y;g=g.childNodes[1];k=0;var m=this.getText(b)._kmwLength();d=this.getTextCaret(b);var r=document.body.scrollTop;if(b.base instanceof b.base.ownerDocument.defaultView.HTMLTextAreaElement){var x=
Math.round(b.base.offsetHeight/b.base.rows);for(y=0;16>y;y++){var v=f._GetAbsoluteY(g)-r;if(v>h&&d>k&&d!=m)m=d,d=Math.round((d+k)/2);else if(v<h-x&&d<m&&d!=k)k=d,d=Math.round((d+m)/2);else break;this.setTextCaret(b,d)}for(;f._GetAbsoluteY(g)-r>h&&d>k;)this.setTextCaret(b,--d);for(;f._GetAbsoluteY(g)-r<h-x&&d<m;)this.setTextCaret(b,++d)}v="rtl"==b.dir?function(c,d){return c<d}:function(c,d){return c>d};for(y=0;16>y;y++){h=f._GetAbsoluteX(g);if(v(h,c)&&d>k&&d!=m)m=d,d=Math.round((d+k)/2);else if(!v(h,
c)&&d<m&&d!=k)k=d,d=Math.round((d+m)/2);else break;this.setTextCaret(b,d)}for(;v(f._GetAbsoluteX(g),c)&&d>k;)this.setTextCaret(b,--d);for(;!v(f._GetAbsoluteX(g),c)&&d<m;)this.setTextCaret(b,++d)}this._BlurKeyboardSettings();l.states.lastActiveElement=b;this._FocusKeyboardSettings(!1);this._CommonFocusHelper(b)}.bind(c);c.flashCaret=function(){if(this.keyman.util.device.touchable&&null!=l.states.activeElement){var c=this.caret.style;c.visibility="visible"!=c.visibility?"visible":"hidden"}}.bind(c);
c.setBlur=function(c){this.keyman.interface.resetContext();if("relatedTarget"in c&&c.relatedTarget&&(c=c.relatedTarget,this.doChangeEvent(c),"DIV"!=c.nodeName||-1==c.className.indexOf("keymanweb-input"))){this.cancelInput();return}l.states.focusing||this.cancelInput()}.bind(c);c.dragInput=function(c){c.preventDefault();c.stopPropagation();var d=a.Util.instanceof(c,"TouchEvent")?c.targetTouches[0].target:c.target;if(null!=d){if(null==d.className||0>d.className.indexOf("keymanweb-input"))d=d.parentNode;
if(null==d.className||0>d.className.indexOf("keymanweb-input"))d=d.parentNode;if(!(null==d.className||0>d.className.indexOf("keymanweb-input"))){if(a.Util.instanceof(c,"TouchEvent")){var f=c.touches[0].screenX;var b=c.touches[0].screenY}else f=c.screenX,b=c.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch={x:f,y:b};else{var h=this.firstTouch.x,k=this.firstTouch.y;c=d.firstChild;if("TEXTAREA"==d.base.nodeName){if(f=parseInt(c.style.top,10),isNaN(f)&&(f=0),h=k-b,
-4>h||4<h)c.style.top=(f<h?f-h:0)+"px",this.firstTouch.y=b}else{b=parseInt(c.style.left,10);isNaN(b)&&(b=0);var g=h-f;if(-4>g||4<g)h=0,k=this.keyman.util._GetAbsoluteX(d)+d.offsetWidth-c.offsetWidth-32,"rtl"==d.base.dir?h=16:k-=24,b-=g,b>h&&(b=h),b<k&&(b=k),c.style.left=b+"px",this.firstTouch.x=f}}this.setScrollBar(d)}}}.bind(c);c.initCaret();return c}__extends(b,f);b.prototype.initCaret=function(){this.caret=document.createElement("DIV");var c=this.caret.style;c.position="absolute";c.height="16px";
c.width="2px";c.backgroundColor="blue";c.border="none";c.left=c.top="0px";c.display="block";c.visibility="hidden";c.zIndex="9998";this.caretTimerId=window.setInterval(this.flashCaret,500)};b.prototype.getText=function(c){return null==c?"":c.textContent};b.prototype.setText=function(c,d,a){if(c&&0<c.childNodes.length){var e=c.firstChild,f=0;if(3<=e.childNodes.length){var b=e.childNodes[0];e=e.childNodes[2];if(null===d){var h=b.textContent;d=e.textContent;d=h+d}0>a&&(a=0);f=d._kmwLength();if(null===
a||a>f)a=f;h=d._kmwSubstr(0,a);d=d._kmwSubstr(a);b.textContent=h;e.textContent=d}}this.updateBaseElement(c,f)};b.prototype.getTextBeforeCaret=function(c){return c&&1<c.childNodes.length&&(c=c.firstChild,0<c.childNodes.length)?c.childNodes[0].textContent:""};b.prototype.setTextBeforeCaret=function(c,d){if(c&&0<c.childNodes.length){var a=c.firstChild,f=0;1<a.childNodes.length&&(f=a.childNodes[0],a=a.childNodes[2],"TEXTAREA"!=c.base.nodeName&&(d=d.replace(/\s+$/," ")),f.textContent=d,f=d.length,f+=a.textContent.length)}this.updateBaseElement(c,
f);this.scrollInput(c)};b.prototype.getTextCaret=function(c){return this.getTextBeforeCaret(c)._kmwLength()};b.prototype.setTextCaret=function(c,d){this.setText(c,null,d);this.showCaret(c)};b.prototype.hideCaret=function(){var c=l.states.lastActiveElement;if(c&&null!=c.className&&0<=c.className.indexOf("keymanweb-input")){if(c.base instanceof c.base.ownerDocument.defaultView.HTMLTextAreaElement||c.base instanceof c.base.ownerDocument.defaultView.HTMLInputElement)c.base.value=this.getText(c);this.setText(c,
null,1E5);var d=c.firstChild.style;"TEXTAREA"==c.base.nodeName?d.top="0":d.left="rtl"==c.base.dir?c.offsetWidth-c.firstChild.offsetWidth-8+"px":"0";this.caret.parentNode&&this.caret.parentNode.removeChild(this.caret);this.caret.style.visibility="hidden";1<c.childNodes.length&&(c.childNodes[1].style.visibility="hidden")}};b.prototype.showCaret=function(c){if(c&&c.firstChild&&!(3>c.firstChild.childNodes.length)){var d=c.firstChild,a=this.caret.style,f=d.childNodes[1];this.caret.parentNode!=d&&d.appendChild(this.caret);
a.left=f.offsetLeft+"px";a.top=f.offsetTop+"px";a.height=f.offsetHeight-1+"px";a.visibility="hidden";this.scrollBody(c);this.setScrollBar(c)}};b.prototype.updateInput=function(c){var d=this.keyman.util,a=c.style,f=c.base,b=window.getComputedStyle(f,null),h=parseInt(b.marginLeft,10),k=parseInt(b.marginTop,10),g=d._GetAbsoluteX(f),l=d._GetAbsoluteY(f),m=c.offsetParent;m&&(g-=d._GetAbsoluteX(m),l-=d._GetAbsoluteY(m));isNaN(h)&&(h=0);isNaN(k)&&(k=0);a.left=g-h+"px";a.top=l-k+"px";"undefined"!=typeof b.MozBoxSizing&&
(a.left=g+"px",a.top=l+"px");h=f.offsetWidth;f=f.offsetHeight;k=parseInt(b.paddingLeft,10);g=parseInt(b.paddingRight,10);l=parseInt(b.paddingTop,10);m=parseInt(b.paddingBottom,10);var r=parseInt(b.borderLeft,10),x=parseInt(b.borderRight,10),v=parseInt(b.borderTop,10),t=parseInt(b.borderBottom,10),B="undefined";"undefined"!=typeof b.boxSizing?B=b.boxSizing:"undefined"!=typeof b.MozBoxSizing&&(B=b.MozBoxSizing);"content-box"==B&&(isNaN(k)||(h-=k),isNaN(g)||(h-=g),isNaN(r)||(h-=r),isNaN(x)||(h-=x),isNaN(l)||
(f-=l),isNaN(m)||(f-=m),isNaN(v)||(f-=v),isNaN(t)||(f-=t));"Android"==d.device.OS&&("undefined"!=typeof b.MozBoxSizing?(a.paddingTop=l+1+"px",a.paddingLeft=k+"px","TEXTAREA"==c.base.nodeName?a.marginTop="1px":a.marginLeft="1px",h--,f--):(h++,f++));a.width=h+"px";a.height=f+"px"};b.prototype.updateBaseElement=function(c,a){var d=c.base.ownerDocument.defaultView;c.base instanceof d.HTMLInputElement||c.base instanceof d.HTMLTextAreaElement?c.base.value=this.getText(c):c.base.textContent=this.getText(c);
c.style.backgroundColor=0==a?"transparent":window.getComputedStyle(c.base,null).backgroundColor;"iOS"==this.keyman.util.device.OS&&(c.base.style.visibility=0==a?"visible":"hidden")};b.prototype.cancelInput=function(){l.states.activeElement=null;this.hideCaret();this.keyman.osk.hideNow()};b.prototype.setScrollBar=function(c){var a=c.childNodes[0],e=c.childNodes[1].style;(a.offsetWidth>c.offsetWidth||0>a.offsetLeft)&&"TEXTAREA"!=c.base.nodeName?(e.height="4px",e.width=c.offsetWidth/a.offsetWidth*100+
"%",e.left=-a.offsetLeft/a.offsetWidth*100+"%",e.top="0",e.visibility="visible"):a.offsetHeight>c.offsetHeight||0>a.offsetTop?(e.width="4px",e.height=c.offsetHeight/a.offsetHeight*100+"%",e.top=-a.offsetTop/a.offsetHeight*100+"%",e.left="0",e.visibility="visible"):e.visibility="hidden"};b.prototype.scrollInput=function(c){if(c&&c.firstChild&&null!=c.className&&!(0>c.className.indexOf("keymanweb-input"))){var a=c.firstChild;if(!(3>a.childNodes.length)){var e=this.keyman.util,f=a.childNodes[1],b=e._GetAbsoluteX(f);
f=e._GetAbsoluteY(f);var h=e._GetAbsoluteX(c);e=e._GetAbsoluteY(c);var k=parseInt(a.style.left,10),g=parseInt(a.style.top,10),l=0,m=0;isNaN(k)&&(k=0);isNaN(g)&&(g=0);c.base instanceof c.base.ownerDocument.defaultView.HTMLTextAreaElement?(b=Math.round(c.offsetHeight/c.base.rows),f<e&&(m=f-e),f>e+c.offsetHeight-b&&(m=f-e-c.offsetHeight+b),0!=m&&(a.style.top=(g<m?g-m:0)+"px")):(b<h+8&&(l=b-h-12),b>h+c.offsetWidth-12&&(l=b-h-c.offsetWidth+12),0!=l&&(a.style.left=(k<l?k-l:0)+"px"));this.showCaret(c)}}};
b.prototype.scrollBody=function(c){var a=this.keyman.osk,e=this.keyman.util;if(c&&null!=c.className&&!(0>c.className.indexOf("keymanweb-input"))&&a.ready){c=c.firstChild.childNodes[1];e=e._GetAbsoluteY(c);var f=window.pageYOffset;e<f?a=e-f:(a=e-f-(window.innerHeight-a._Box.offsetHeight-c.offsetHeight-2),0>a&&(a=0));0!=a&&window.scrollTo(0,a+window.pageYOffset)}};return b}(l);a.DOMTouchHandlers=h})(b.keyman||(b.keyman={}))})(com||(com={}));
String.kmwFromCharCode=function(b){var a=[],g;for(g=0;g<arguments.length;g++){var l=Number(arguments[g]);if(!isFinite(l)||0>l||1114111<l||Math.floor(l)!==l)throw new RangeError("Invalid code point "+l);65536>l?a.push(l):(l-=65536,a.push((l>>10)+55296),a.push(l%1024+56320))}return String.fromCharCode.apply(void 0,a)};
String.prototype.kmwCharCodeAt=function(b){var a=String(this),g=0;if(0>b||b>=a.length)return NaN;for(var l=0;l<b;l++)if(g=a.kmwNextChar(g),null===g)return NaN;b=a.charCodeAt(g);return 55296<=b&&56319>=b&&a.length>g+1&&(a=a.charCodeAt(g+1),56320<=a&&57343>=a)?(b-55296<<10)+(a-56320)+65536:b};String.prototype.kmwIndexOf=function(b,a){var g=String(this);b=g.indexOf(b,a);if(0>b)return b;for(var l=a=0;null!==l&&l<b;l=g.kmwNextChar(l))a++;return a};
String.prototype.kmwLastIndexOf=function(b,a){var g=String(this);b=g.lastIndexOf(b,a);if(0>b)return b;for(var l=a=0;null!==l&&l<b;l=g.kmwNextChar(l))a++;return a};String.prototype.kmwLength=function(){var b=String(this);if(0==b.length)return 0;for(var a=0,g=0;null!==g;a++)g=b.kmwNextChar(g);return a};String.prototype.kmwSlice=function(b,a){var g=String(this);b=g.kmwCodePointToCodeUnit(b);a=g.kmwCodePointToCodeUnit(a);return null===b||null===a?"":g.slice(b,a)};
String.prototype.kmwSubstr=function(b,a){var g=String(this);0>b&&(b=g.kmwLength()+b);0>b&&(b=0);var l=g.kmwCodePointToCodeUnit(b),h=l;if(null===l)return"";if(2>arguments.length)h=g.length;else for(var f=0;f<a;f++)h=g.kmwNextChar(h);return null===h?g.substring(l):g.substring(l,h)};
String.prototype.kmwSubstring=function(b,a){var g=String(this);if("undefined"==typeof a)b=g.kmwCodePointToCodeUnit(b),a=g.length;else{if(b>a){var l=b;b=a;a=l}b=g.kmwCodePointToCodeUnit(b);a=g.kmwCodePointToCodeUnit(a)}if(isNaN(b)||null===b)b=0;if(isNaN(a)||null===a)a=g.length;return g.substring(b,a)};
String.prototype.kmwNextChar=function(b){var a=String(this);if(null===b||0>b||b>=a.length-1)return null;var g=a.charCodeAt(b);return 55296<=g&&56319>=g&&a.length>b+1&&(g=a.charCodeAt(b+1),56320<=g&&57343>=g)?b==a.length-2?null:b+2:b+1};String.prototype.kmwPrevChar=function(b){var a=String(this);if(null==b||0>=b||b>a.length)return null;var g=a.charCodeAt(b-1);return 56320<=g&&57343>=g&&1<b&&(a=a.charCodeAt(b-2),55296<=a&&56319>=a)?b-2:b-1};
String.prototype.kmwCodePointToCodeUnit=function(b){if(null===b)return null;var a=String(this),g=0;if(0>b){g=a.length;for(var l=0;l>b;l--)g=a.kmwPrevChar(g);return g}if(b==a.kmwLength())return a.length;for(l=0;l<b;l++)g=a.kmwNextChar(g);return g};String.prototype.kmwCodeUnitToCodePoint=function(b){var a=String(this);return null===b?null:0==b?0:0>b?a.substr(b).kmwLength():a.substr(0,b).kmwLength()};String.prototype.kmwCharAt=function(b){var a=String(this);return 0<=b?a.kmwSubstr(b,1):""};
String.prototype.kmwBMPNextChar=function(b){var a=String(this);return 0>b||b>=a.length-1?null:b+1};String.prototype.kmwBMPPrevChar=function(b){var a=String(this);return 0>=b||b>a.length?null:b-1};String.prototype.kmwBMPCodePointToCodeUnit=function(b){return b};String.prototype.kmwBMPCodeUnitToCodePoint=function(b){return b};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(b,a){var g=String(this);return-1<b?g.substr(b,a):g.substr(g.length+b,-b)};
String.kmwEnableSupplementaryPlane=function(b){var a=String.prototype;String._kmwFromCharCode=b?String.kmwFromCharCode:String.fromCharCode;a._kmwCharAt=b?a.kmwCharAt:a.charAt;a._kmwCharCodeAt=b?a.kmwCharCodeAt:a.charCodeAt;a._kmwIndexOf=b?a.kmwIndexOf:a.indexOf;a._kmwLastIndexOf=b?a.kmwLastIndexOf:a.lastIndexOf;a._kmwSlice=b?a.kmwSlice:a.slice;a._kmwSubstring=b?a.kmwSubstring:a.substring;a._kmwSubstr=b?a.kmwSubstr:a.kmwBMPSubstr;a._kmwLength=b?a.kmwLength:a.kmwBMPLength;a._kmwNextChar=b?a.kmwNextChar:
a.kmwBMPNextChar;a._kmwPrevChar=b?a.kmwPrevChar:a.kmwBMPPrevChar;a._kmwCodePointToCodeUnit=b?a.kmwCodePointToCodeUnit:a.kmwBMPCodePointToCodeUnit;a._kmwCodeUnitToCodePoint=b?a.kmwCodeUnitToCodePoint:a.kmwBMPCodeUnitToCodePoint};
(function(b){(function(a){var b=function(){function b(b){this.inputList=[];this.sortedInputs=[];this.nonKMWTouchHandler=function(f){a.DOMEventHandlers.states.focusing=!1;clearTimeout(a.DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);this._EnablementMutationObserverCore=function(a){for(var f=0;f<a.length;f++){var c=a[f],d=c.oldValue?0<=c.oldValue.indexOf("kmw-disabled"):!1,e=0<=c.target.className.indexOf("kmw-disabled");d&&!e?this._EnableControl(c.target):!d&&e&&this._DisableControl(c.target);
!e&&"readonly"==c.attributeName&&(d=c.oldValue?null!=c.oldValue:!1,e=c.target,e instanceof e.ownerDocument.defaultView.HTMLInputElement||e instanceof e.ownerDocument.defaultView.HTMLTextAreaElement)&&(e=e.readOnly,d&&!e?this._EnableControl(c.target):!d&&e&&this._DisableControl(c.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var b=[],c=[],d=0;d<a.length;d++){for(var e=a[d],f=0;f<e.addedNodes.length;f++)b=b.concat(this._GetDocumentEditables(e.addedNodes[f]));for(f=0;f<e.removedNodes.length;f++)c=
c.concat(this._GetDocumentEditables(e.removedNodes[f]))}for(a=0;a<b.length;a++)this.isKMWInput(b[a])&&this._MutationAdditionObserved(b[a]);for(a=0;a<c.length;a++)this.isKMWInput(c[a])&&this._MutationRemovalObserved(c[a]);if(b.length||c.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var h=this;window.setTimeout(function(){h.listInputs();for(var c=0;c<this.sortedInputs.length;c++)this.sortedInputs[c].kmw_ip&&this.keyman.touchAliasing.updateInput(this.sortedInputs[c].kmw_ip)}.bind(this),
1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var b=this,c=function(){b.attachToControl(a)};a.addEventListener("load",c);"complete"==a.contentDocument.readyState&&window.setTimeout(c,1)}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=
function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0<=b.indexOf("kmw-disabled")&&(a.className=b.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk.ready&&this.keyman.osk._Unload();this.clearLastActiveElement()}.bind(this);this.init=
function(a){var b,c=this.keyman.osk;var d=this.keyman.util;var e=d.device,f=function(c){if(0==c.length)return c;"/"!=c.substr(c.length-1,1)&&(c+="/");return"http"==c.replace(/^(http)s?:.*/,"$1")||"file"==c.replace(/^(file):.*/,"$1")?c:"//"==c.substr(0,2)?this.keyman.protocol+c:"/"==c.substr(0,1)?this.keyman.rootPath+c.substr(1):this.keyman.srcPath+c}.bind(this);var h=this.keyman.options;if("object"==typeof a&&null!==a)for(b in h)a.hasOwnProperty(b)&&(h[b]=a[b]);""!=h.root&&(this.keyman.rootPath=f(h.root));
""==h.resources&&(h.resources=this.keyman.srcPath);h.resources=f(h.resources);h.keyboards=f(h.keyboards);h.fonts=f(h.fonts);""==h.attachType&&(h.attachType="auto");this.keyman.setDefaultDeviceOptions(h);if(this.keyman.initialized)return Promise.resolve();var g=this.keyman,l=this;if("complete"!==document.readyState)return new Promise(function(c){window.setTimeout(function(){l.init(a).then(function(){c()})},50)});this.keyman._MasterDocument=window.document;"Android"==e.OS&&(h=e.getDPI(),e.formFactor=
screen.height<4*h||screen.width<4*h?"phone":"tablet");this.keyman.setInitialized(1);c.prepare();d.prepareWait();this.keyman.keyboardManager.registerDeferredStubs();this.initializeUI();this.keyman.keyboardManager.registerDeferredKeyboards();if(this.keyman.isEmbedded)return this.keyman.keyboardManager.setDefaultKeyboard()||console.error("No keyboard stubs exist - cannot initialize keyboard!"),Promise.resolve();this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont();e.touchable&&this.keyman.handleRotationEvents();
"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement);this.listInputs();e.touchable&&(c._Box.addEventListener("touchend",function(c){c.stopPropagation()},!1),d=document.createElement("DIV"),h=d.style,h.width="100%",h.height=screen.width/2+"px",document.body.appendChild(d),"Android"==e.OS&&0<navigator.userAgent.indexOf("Chrome")?(this.keyman.hideOskWhileScrolling=function(a){if("undefined"!=typeof c._Box&&"undefined"!=typeof c._Box.style){b=a.target.parentNode;if("undefined"!=
typeof b&&null!=b&&(0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-")||"undefined"!=typeof b.parentNode&&(b=b.parentNode,0<=b.className.indexOf("keymanweb-input")||0<=b.className.indexOf("kmw-key-"))))return;c.hideNow()}},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskWhileScrolling,!1)):(this.keyman.conditionallyHideOsk=function(){g.hideOnRelease&&!c.lgList&&c.hideNow();g.hideOnRelease=!1},this.keyman.hideOskIfOnBody=function(c){g.touchY=
c.touches[0].screenY;g.hideOnRelease=!0},this.keyman.cancelHideIfScrolling=function(c){c=c.touches[0].screenY;var a=g.touchY;if(5<c-a||5>a-c)g.hideOnRelease=!1},this.keyman.util.attachDOMEvent(document.body,"touchstart",this.keyman.hideOskIfOnBody,!1),this.keyman.util.attachDOMEvent(document.body,"touchmove",this.keyman.cancelHideIfScrolling,!1),this.keyman.util.attachDOMEvent(document.body,"touchend",this.keyman.conditionallyHideOsk,!1)));this.keyman.keyboardManager.restoreCurrentKeyboard();MutationObserver?
(e=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&(d={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(e,d)),d={subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(e,d)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements.");
this.keyman.setInitialized(2);return Promise.resolve()}.bind(this);this.keyman=b;b.util.device.touchable&&(this.touchHandlers=new a.DOMTouchHandlers(b));this.nonTouchHandlers=new a.DOMEventHandlers(b)}b.prototype.shutdown=function(){this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver&&this.attachmentObserver.disconnect();for(var a=0,b=this.inputList;a<b.length;a++)this.disableInputElement(b[a])};b.prototype.getHandlers=function(a){return(a=a.base?a.base._kmwAttachment:
a._kmwAttachment)?a.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};b.prototype.enableTouchElement=function(a){if("iframe"==a.tagName.toLowerCase())return!1;if(this.isKMWDisabled(a))return this.setupNonKMWTouchElement(a),!1;a.kmwInput=!0;a.removeEventListener("touchstart",this.nonKMWTouchHandler);if(a.kmw_ip){if(-1!=this.inputList.indexOf(a.kmw_ip))return!1;this.inputList.push(a.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");
return!0}var b=document.createElement("div");b.base=b.base=a;b._kmwAttachment=a._kmwAttachment;this.enableInputElement(b,!0);a.kmw_ip=b;a.disabled=!0;b.className="keymanweb-input";b.dir=b.base.dir;var h=document.createElement("div");var c=window.getComputedStyle(b.base,null);a=b.style;a.overflow="hidden";a.position="absolute";a.border="hidden";a.border="none";a.borderRadius="5px";var d=document.createElement("div");var e=d.style;e.position="absolute";e.height=e.width="4px";e.left=e.top="0";e.display=
"block";e.visibility="hidden";e.backgroundColor="#808080";e.borderRadius="2px";e=document.createElement("span");var q=document.createElement("span");var u=document.createElement("span");e.innerHTML=q.innerHTML=u.innerHTML="";e.className=q.className=u.className="keymanweb-font";h.appendChild(e);h.appendChild(u);h.appendChild(q);b.appendChild(h);b.appendChild(d);h=h.style;h.position="absolute";d=e.style;var g=q.style;u=u.style;d.border=g.border="none";d.height=g.height="100%";d.fontFamily=g.fontFamily=
h.fontFamily=c.fontFamily;"input"!=b.base.nodeName.toLowerCase()||isNaN(parseInt(c.height,10))||(d.lineHeight=g.lineHeight=c.height);u.border="1px solid red";u.visibility="hidden";u.marginLeft=u.marginRight="-1px";a.padding="8px";h.padding="0px 2px";h.backgroundColor="Android"==this.keyman.util.device.OS&&"transparent"==c.backgroundColor?"#fff":c.backgroundColor;b.tabIndex=0;b.style.msTouchAction="none";var l=this.touchHandlers;b.addEventListener("touchstart",l.setFocus);b.onmspointerdown=function(c){c.preventDefault();
c.stopPropagation();return l.setFocus(c)};b.addEventListener("touchend",function(c){c.stopPropagation()});b.onmspointerup=function(c){c.stopPropagation()};b.addEventListener("touchmove",l.dragInput,!1);b.onmspointermove=l.dragInput;b.onblur=l.setBlur;"textarea"==b.base.nodeName.toLowerCase()?e.style.whiteSpace=q.style.whiteSpace="pre-wrap":e.style.whiteSpace=q.style.whiteSpace="pre";b.base.parentNode.appendChild(b);l.updateInput(b);a=b.style;a.color=c.color;a.fontFamily=c.fontFamily;a.fontSize=c.fontSize;
a.fontWeight=c.fontWeight;a.textDecoration=c.textDecoration;a.padding=c.padding;a.margin=c.margin;a.border=c.border;a.borderRadius=c.borderRadius;"webkitTapHighlightColor"in a&&(a.webkitTapHighlightColor="rgba(0,0,0,0)");b.base instanceof b.base.ownerDocument.defaultView.HTMLTextAreaElement?(2==b.base.rows&&(e=parseInt(c.height,10)-parseInt(c.paddingTop,10)-parseInt(c.paddingBottom,10),c=parseInt(c.fontSize,10),c=Math.round(e/c),c>b.base.rows+1&&(b.base.rows=c)),h.width=a.width,h.minHeight=a.height):
(h.minWidth=a.width,h.height=a.height);b.base.style.visibility="hidden";(function(c){c._kmwResizeHandler=function(a){window.setTimeout(function(){l.updateInput(c)},1)};c.base.addEventListener("resize",c._kmwResizeHandler,!1);c.base.addEventListener("orientationchange",c._kmwResizeHandler,!1)})(b);l.setText(b,b.base instanceof b.base.ownerDocument.defaultView.HTMLTextAreaElement||b.base instanceof b.base.ownerDocument.defaultView.HTMLInputElement?b.base.value:b.base.textContent,null);return!0};b.prototype.disableTouchElement=
function(a){if("iframe"!=a.tagName.toLowerCase()){if(a.kmw_ip){var b=this.inputList.indexOf(a.kmw_ip);-1!=b&&this.inputList.splice(b,1);a.style.visibility="visible";a.disabled=!1;a.removeEventListener("resize",a.kmw_ip._kmwResizeHandler);this.disableInputElement(a.kmw_ip);a.parentNode&&a.parentNode.removeChild(a.kmw_ip);delete a.kmw_ip}this.setupNonKMWTouchElement(a)}};b.prototype.setupNonKMWTouchElement=function(a){this.keyman.util.attachDOMEvent(a,"touchstart",this.nonKMWTouchHandler,!1);this.isAttached(a)&&
(a._kmwAttachment.touchEnabled=!1)};b.prototype.enableInputElement=function(a,b){b=b?a.base:a;this.isKMWDisabled(b)||(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(a):(b.className=b.className?b.className+" keymanweb-font":"keymanweb-font",this.inputList.push(a),this.keyman.util.attachDOMEvent(b,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.attachDOMEvent(b,"blur",this.getHandlers(a)._ControlBlur),a.onkeypress=this.getHandlers(a)._KeyPress,a.onkeydown=
this.getHandlers(a)._KeyDown,a.onkeyup=this.getHandlers(a)._KeyUp))};b.prototype.disableInputElement=function(a,b){var f=b?a.base:a;if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this._DetachFromIframe(a);else{0<f.className.indexOf("keymanweb-font")&&!b&&(f.className=f.className.replace("keymanweb-font","").trim());var c=this.inputList.indexOf(a);-1<c&&this.inputList.splice(c,1);b||(this.keyman.util.detachDOMEvent(f,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.detachDOMEvent(f,
"blur",this.getHandlers(a)._ControlBlur));a.onkeypress=null;a.onkeydown=null;a.onkeyup=null}b&&(this.inputList.push(f),f.onkeypress=this.getHandlers(a)._KeyPress,f.onkeydown=this.getHandlers(a)._KeyDown,f.onkeyup=this.getHandlers(a)._KeyUp);b=this.getLastActiveElement();if(b==a||b==a.kmw_ip)this.clearLastActiveElement(),this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode),this.keyman.osk._Hide()};b.prototype.isKMWDisabled=function(a){var b=a.className;
return a.readOnly||b&&0<=b.indexOf("kmw-disabled")?!0:!1};b.prototype.attachToControl=function(a){var b=this.keyman.util.device.touchable;if(!this.isAttached(a)||a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(a)?(this.setupElementAttachment(a),this.isKMWDisabled(a)?b&&this.setupNonKMWTouchElement(a):b?this.enableTouchElement(a):this.enableInputElement(a)):b&&this.setupNonKMWTouchElement(a)};b.prototype.detachFromControl=function(a){this.isAttached(a)&&(this.isKMWInput(a)&&
(this.isKMWDisabled(a)||this._DisableControl(a)),this.clearElementAttachment(a))};b.prototype.isAttached=function(a){return a._kmwAttachment?!0:!1};b.prototype.isKMWInput=function(a){var b=this.keyman.util.device.touchable;if(a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement)return!0;if(a instanceof a.ownerDocument.defaultView.HTMLInputElement){if("text"==a.type||"search"==a.type)return!0}else if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!b)try{if(a.contentWindow.document)return!0}catch(k){}else if(a.isContentEditable&&
!b)return!0;return!1};b.prototype.setupElementAttachment=function(b){b._kmwAttachment||(b._kmwAttachment=new a.AttachmentInfo(null,this.keyman.util.device.touchable))};b.prototype.clearElementAttachment=function(a){a._kmwAttachment=null};b.prototype._AttachToIframe=function(a){var b=this.keyman.util;try{var k=a.contentWindow.document;k&&("on"==k.designMode.toLowerCase()?(b.attachDOMEvent(k,"focus",this.getHandlers(a)._ControlFocus),b.attachDOMEvent(k,"blur",this.getHandlers(a)._ControlBlur),b.attachDOMEvent(k,
"keydown",this.getHandlers(a)._KeyDown),b.attachDOMEvent(k,"keypress",this.getHandlers(a)._KeyPress),b.attachDOMEvent(k,"keyup",this.getHandlers(a)._KeyUp)):this._SetupDocument(k))}catch(c){}};b.prototype._DetachFromIframe=function(a){var b=this.keyman.util;try{var k=a.contentWindow.document;k&&("on"==k.designMode.toLowerCase()?(b.detachDOMEvent(k,"focus",this.getHandlers(a)._ControlFocus),b.detachDOMEvent(k,"blur",this.getHandlers(a)._ControlBlur),b.detachDOMEvent(k,"keydown",this.getHandlers(a)._KeyDown),
b.detachDOMEvent(k,"keypress",this.getHandlers(a)._KeyPress),b.detachDOMEvent(k,"keyup",this.getHandlers(a)._KeyUp)):this._ClearDocument(k))}catch(c){}};b.prototype._GetDocumentEditables=function(a){var b=this.keyman.util,k=[];if(a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement){var c=a.ownerDocument.defaultView;a instanceof c.HTMLInputElement||a instanceof c.HTMLTextAreaElement?k.push(a):a instanceof c.HTMLIFrameElement&&k.push(a)}a.getElementsByTagName&&(k=k.concat(b.arrayFromNodeList(a.getElementsByTagName("INPUT")),
b.arrayFromNodeList(a.getElementsByTagName("TEXTAREA")),b.arrayFromNodeList(a.getElementsByTagName("IFRAME"))));a.querySelectorAll&&(k=k.concat(b.arrayFromNodeList(a.querySelectorAll("[contenteditable]"))));a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement&&a.isContentEditable&&k.push(a);return k};b.prototype._SetupDocument=function(a){a=this._GetDocumentEditables(a);for(var b=0;b<a.length;b++)this.attachToControl(a[b])};b.prototype._ClearDocument=function(a){a=this._GetDocumentEditables(a);
for(var b=0;b<a.length;b++)this.detachFromControl(a[b])};b.prototype._SetTargDir=function(a){var b=this.keyman.keyboardManager.isRTL()?"rtl":"ltr";a&&(this.keyman.util.device.touchable?0==a.textContent.length&&(a.base.dir=a.dir=b,this.getHandlers(a).setTextCaret(a,1E4)):a instanceof a.ownerDocument.defaultView.HTMLInputElement||a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement?0==a.value.length&&(a.dir=b):"string"==typeof a.textContent&&0==a.textContent.length&&(a.dir=b))};b.prototype._DisableControl=
function(a){this.isAttached(a)&&(this.keyman.util.device.touchable?(this.disableTouchElement(a),this.setupNonKMWTouchElement(a),window.setTimeout(function(){this.listInputs();for(var b=0;b<this.sortedInputs.length;b++)this.sortedInputs[b].kmw_ip&&this.getHandlers(a).updateInput(this.sortedInputs[b].kmw_ip)}.bind(this),1)):this.listInputs(),this.disableInputElement(a))};b.prototype._EnableControl=function(a){if(this.isAttached(a))if(this.keyman.util.device.touchable){this.enableTouchElement(a);var b=
this.keyman;window.setTimeout(function(){b.domManager.listInputs();for(var f=0;f<this.sortedInputs.length;f++)this.sortedInputs[f].kmw_ip&&this.getHandlers(a).updateInput(this.sortedInputs[f].kmw_ip)}.bind(this),1)}else this.enableInputElement(a)};b.prototype.listInputs=function(){var a,b=[],k=document.getElementsByTagName("input"),c=document.getElementsByTagName("textarea"),d=this.keyman.util;for(a=0;a<k.length;a++)switch(k[a].type){case "text":case "search":case "email":case "url":0>k[a].className.indexOf("kmw-disabled")&&
b.push({ip:k[a],x:d._GetAbsoluteX(k[a]),y:d._GetAbsoluteY(k[a])})}for(a=0;a<c.length;a++)0>c[a].className.indexOf("kmw-disabled")&&b.push({ip:c[a],x:d._GetAbsoluteX(c[a]),y:d._GetAbsoluteY(c[a])});b.sort(function(a,c){return a.y!=c.y?a.y-c.y:a.x-c.x});k=[];for(a=0;a<b.length;a++)k.push(b[a].ip);this.sortedInputs=k};b.prototype.disableControl=function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0>b.indexOf("kmw-disabled")&&(a.className=b?b+" kmw-disabled":
"kmw-disabled")};b.prototype.setKeyboardForControl=function(a,b,k){null!==b&&void 0!==b?0>b.indexOf("Keyboard_")&&""!=b&&(b="Keyboard_"+b):k=null;if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(a)){a._kmwAttachment.keyboard=b;a._kmwAttachment.languageCode=k;var c=this.getLastActiveElement();!c||c!=a&&c!=a.kmw_ip||(null!=b&&null!=k?this.keyman.keyboardManager.setActiveKeyboard(b,
k):this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode))}else console.error("KeymanWeb is not attached to element "+a)};b.prototype.getKeyboardForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+a);return null};b.prototype.getLanguageForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+
a);return null};b.prototype.focusLastActiveElement=function(){var a=this.getLastActiveElement();a&&(this.keyman.uiManager.justActivated=!0,a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&this.keyman.domManager._IsMozillaEditableIframe(a,0)?a.ownerDocument.defaultView.focus():a.focus&&a.focus())};b.prototype.getLastActiveElement=function(){return a.DOMEventHandlers.states.lastActiveElement};b.prototype.clearLastActiveElement=function(){a.DOMEventHandlers.states.lastActiveElement=
null};b.prototype.getActiveElement=function(){return a.DOMEventHandlers.states.activeElement};b.prototype._setActiveElement=function(b){a.DOMEventHandlers.states.activeElement=b};b.prototype.setActiveElement=function(b,f){"string"==typeof b&&(b=document.getElementById(b));this.isAttached(b)||this.keyman.isEmbedded?(b=b.kmw_ip?b.kmw_ip:b,this.keyman.isEmbedded||this.keyman.touchAliasing._BlurKeyboardSettings(),a.DOMEventHandlers.states.activeElement!=b&&this.keyman.interface.resetContext(),a.DOMEventHandlers.states.activeElement=
a.DOMEventHandlers.states.lastActiveElement=b,this.keyman.isEmbedded||this.keyman.touchAliasing._FocusKeyboardSettings(!1),1<arguments.length&&f&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocus():this.focusLastActiveElement())):console.warn("Cannot set an element KMW is not attached to as the active element.")};b.prototype.initActiveElement=function(b){null==a.DOMEventHandlers.states.activeElement&&(a.DOMEventHandlers.states.activeElement=b)};b.prototype.moveToNext=function(b){var f,
k=this.sortedInputs,c=this.getActiveElement(),d=this.keyman.util.device.touchable;if(0!=k.length){d&&(c=c.base);for(f=0;f<k.length&&k[f]!=c;f++);f=b?f-1:f+1;f=f>=k.length?f-k.length:f;f=0>f?f+k.length:f;d?(a.DOMEventHandlers.states.focusing=!0,b=k[f].kmw_ip,"undefined"==typeof b?k[f].focus():(this.keyman.domManager.setActiveElement(b),this.touchHandlers.setTextCaret(b,1E4),this.touchHandlers.scrollInput(b),b.focus())):k[f].focus()}};b.prototype.moveToElement=function(a){"string"==typeof a&&(a=document.getElementById(a));
this.keyman.util.device.touchable&&a.kmw_ip?a.kmw_ip.focus():a.focus()};b.prototype._IsIEEditableIframe=function(a,b){var f,c=a&&(f=a.tagName)&&"body"==f.toLowerCase()&&(f=a.ownerDocument)&&f.parentWindow;return!b&&c||b&&(!c||a.isContentEditable)};b.prototype._IsMozillaEditableIframe=function(a,b){var f;a=a&&(f=a.defaultView)&&f.frameElement;return!b&&a||b&&(!a||"on"==f.document.designMode.toLowerCase())};b.prototype.getBaseFont=function(){var a=this.keyman.util,b=document.getElementsByTagName("input"),
k=document.getElementsByTagName("textarea"),c=0;if(0==b.length&&0==k.length)c=0;else if(0<b.length&&0==k.length)c=1;else if(0==b.length&&0<k.length)c=2;else{var d=b[0],e=k[0];d.offsetTop<e.offsetTop?c=1:d.offsetTop>e.offsetTop?c=2:d.offsetLeft<e.offsetLeft?c=1:d.offsetLeft>e.offsetLeft&&(c=2)}switch(c){case 0:case 1:a.getStyleValue(b[0],"font-family");case 2:var q=a.getStyleValue(k[0],"font-family")}if("undefined"==typeof q||"monospace"==q)q="Arial,sans-serif";return q};b.prototype.initializeUI=function(){this.keyman.ui&&
this.keyman.ui.initialize instanceof Function?(this.keyman.ui.initialize(),this.keyman.osk._Show()):window.setTimeout(this.initializeUI.bind(this),1E3)};return b}();a.DOMManager=b})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){function a(){this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}a.prototype.getDPI=function(){var a=document.createElement("DIV"),b=a.style,k=96;if("complete"!==document.readyState)return k;a.id="calculateDPI";b.position="absolute";b.display="block";b.visibility="hidden";b.left="10px";b.top="10px";b.width="1in";b.height="10px";
document.body.appendChild(a);k="undefined"==typeof window.devicePixelRatio?a.offsetWidth:a.offsetWidth*window.devicePixelRatio;document.body.removeChild(a);return k};a.prototype.detect=function(){var b=a._GetIEVersion();if(navigator&&navigator.userAgent){var f=navigator.userAgent;if(0<=f.indexOf("iPad"))this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0;else if(0<=f.indexOf("iPhone"))this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=25;else if(0<=f.indexOf("Android")){this.OS=
"Android";this.formFactor="phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=f.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(k){}}else 0<=f.indexOf("Linux")?this.OS="Linux":0<=f.indexOf("Macintosh")?this.OS="MacOSX":0<=f.indexOf("Windows NT")&&(this.OS="Windows",0<=f.indexOf("Touch")&&(this.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}"tablet"==this.formFactor&&400>Math.min(screen.width,screen.height)&&(this.formFactor=
"phone");"phone"==this.formFactor&&720<Math.max(screen.width,screen.height)&&"iOS"!=this.OS&&(this.formFactor="tablet");"iOS"!=this.OS||"ongesturestart"in window||"Win32"==navigator.platform||(this.OS="Android");this.browser="web";if(999>b)this.browser="ie";else{if("iOS"==this.OS||"macosx"==this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR|Safari|Edge/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?
this.browser="opera":0<=navigator.userAgent.indexOf(" Edge/")?this.browser="edge":0<=navigator.userAgent.indexOf("Chrome")?this.browser="chrome":0<=navigator.userAgent.indexOf("Safari")&&(this.browser="safari"))}};a._GetIEVersion=function(){var a="";"userAgent"in navigator&&(a=navigator.userAgent);if("selection"in document){var b=navigator.appVersion;var k=b.indexOf("MSIE ");if(0<=k){if("BackCompat"==document.compatMode)return 6;b=b.substr(k+5);k=b.indexOf(".");if(0<k)return parseInt(b.substr(0,k),
10)}}k=a.indexOf("Trident/");if(0>k)return 999;a=a.substr(k+8);k=a.indexOf(".");return 0<k?parseInt(a.substr(0,k),10)+4:999};return a}();a.Device=b})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){function a(a,b,c,d){this.Pelem=a;this.Peventname=b.toLowerCase();this.Phandler=c;this.PuseCapture=d}a.prototype.equals=function(a){return this.Pelem==a.Pelem&&this.Peventname==a.Peventname&&this.Phandler==a.Phandler&&this.PuseCapture==a.PuseCapture};return a}(),l=function(){function h(a){this.linkedStylesheets=[];this.events={};this.currentEvents=[];this.domEvents=[];this.embeddedFonts=[];this.getAbsoluteX=this._GetAbsoluteX;this.getAbsoluteY=this._GetAbsoluteY;
this.getAbsolute=this._GetAbsolute;this.selectStartHandler=function(){return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=a}h.prototype.getLanguageCodes=function(a){return-1==a.indexOf("-")?[a]:a.split("-")};h.prototype.initDevices=function(){this.device=new a.Device;this.physicalDevice=new a.Device;this.activeDevice=this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=!1);this.physicalDevice=new a.Device;this.physicalDevice.touchable=
!1;this.physicalDevice.browser=this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};h.prototype.arrayFromNodeList=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};h.prototype.addEventListener=function(a,b){this.removeEventListener(a,b);this.events[a].push(b);return!0};h.prototype.removeEventListener=function(a,b){"undefined"==typeof this.events[a]&&(this.events[a]=[]);for(var c=0;c<this.events[a].length;c++)if(this.events[a][c]==b)return this.events[a].splice(c,
1),!0;return!1};h.prototype.callEvent=function(a,b){if("undefined"==typeof this.events[a])return!0;if(-1!=this.currentEvents.indexOf(a))return!1;this.currentEvents.push(a);for(var c=0;c<this.events[a].length;c++){var d=this.events[a][c],e=!1;try{e=d(b)}catch(q){e=!1}if(!1===e)return this.currentEvents.pop(),!1}this.currentEvents.pop();return!0};h.prototype.attachDOMEvent=function(a,k,c,d){this.detachDOMEvent(a,k,c,d);a.addEventListener(k,c,d?!0:!1);a=new b(a,k,c,d);this.domEvents.push(a)};h.prototype.detachDOMEvent=
function(a,k,c,d){a.removeEventListener(k,c,d);a=new b(a,k,c,d);for(k=0;k<this.domEvents.length;k++)if(this.domEvents[k].equals(a)){this.domEvents.splice(k,1);break}};h.prototype.getOption=function(a,b){return a in this.keyman.options?this.keyman.options[a]:1<arguments.length?b:""};h.prototype.setOption=function(a,b){this.keyman.options[a]=b};h.prototype._GetAbsoluteX=function(a){if(!a)return 0;var b=a.offsetLeft?a.offsetLeft:0;var c=a;if(c.offsetParent)for(;c.offsetParent;)c=c.offsetParent,b+=c.offsetLeft;
return c&&c.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&(a=c.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+this._GetAbsoluteX(a.defaultView.frameElement)-a.documentElement.scrollLeft:b};h.prototype._GetAbsoluteY=function(a){if(!a)return 0;var b=a.offsetTop?a.offsetTop:0;var c=a;if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement)for(;c.offsetParent;)c=c.offsetParent,b+=c.offsetTop;return c&&c.ownerDocument&&a.ownerDocument!=this.keyman._MasterDocument&&
(a=c.ownerDocument)&&a.defaultView&&a.defaultView.frameElement?b+this._GetAbsoluteY(a.defaultView.frameElement)-a.documentElement.scrollTop:b};h.prototype._GetAbsolute=function(a){return{x:this._GetAbsoluteX(a),y:this._GetAbsoluteY(a)}};h.prototype.mouseDownPreventDefaultHandler=function(a){a&&a.preventDefault()};h.prototype._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?a.onselectstart=this.selectStartHandler:(a.style.MozUserSelect="none",a.style.KhtmlUserSelect=
"none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};h.prototype.getIEVersion=function(){return a.Device._GetIEVersion()};h.prototype.getFontSizeStyle=function(a){a="string"==typeof a?a:a.style.fontSize;return-1!=a.indexOf("em")?(a=parseFloat(a.substr(0,a.indexOf("em"))),{val:a,absolute:!1}):-1!=a.indexOf("px")?(a=parseFloat(a.substr(0,a.indexOf("px"))),{val:a,absolute:!0}):-1!=a.indexOf("%")?(a=parseFloat(a.substr(0,a.indexOf("%"))),{val:a/100,absolute:!1}):null};h.prototype.getStyleValue=
function(a,b){try{if(a&&"undefined"!=typeof window.getComputedStyle)return window.getComputedStyle(a,"").getPropertyValue(b)}catch(c){}return""};h.prototype.getStyleInt=function(a,b,c){a=parseInt(this.getStyleValue(a,b),10);return isNaN(a)?"number"==typeof c?c:0:a};h.prototype.isTouchDevice=function(){return this.device.touchable};h.prototype.portraitView=function(){return!this.landscapeView()};h.prototype.landscapeView=function(){if("undefined"!=typeof window.orientation)var a=window.orientation;
else"undefined"!=typeof window.screen.orientation&&(a=window.screen.orientation.angle);return void 0!==a?1==Math.abs(a/90):!1};h.prototype.getViewportScale=function(){try{if(screen.width>document.documentElement.clientWidth)return 1;var a=screen.width;this.landscapeView()?screen.width<screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/window.innerWidth)/100}catch(k){return 1}};h.prototype.barHeight=function(){var a=0;"phone"==this.device.formFactor&&
(a=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return a};h.prototype._EncodeEntities=function(a){return a.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};h.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};h.prototype.showShim=function(a,b,c){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};
h.prototype.hideShim=function(a){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};h.prototype.rgba=function(a,b,c,d,e){a="transparent";try{a="rgba("+b+","+c+","+d+","+e+")"}catch(q){a="rgb("+b+","+c+","+d+")"}return a};h.prototype.addStyleSheet=function(a){var b=document.createElement("style");b.type="text/css";b.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");0<a.length?a[0].appendChild(b):
document.body.appendChild(b);this.linkedStylesheets.push(b);return b};h.prototype.removeStyleSheet=function(a){if(null==a||"object"!=typeof a||"STYLE"!=a.nodeName||"undefined"==typeof a.parentNode||null==a.parentNode)return!1;a.parentNode.removeChild(a);return!0};h.prototype.linkStyleSheet=function(a){var b=document.getElementsByTagName("head");if(0<b.length){var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=a;this.linkedStylesheets.push(c);b[0].appendChild(c)}};h.prototype.addFontFaceStyleSheet=
function(b){if("undefined"!=typeof b&&("undefined"==typeof b.files&&(b.files=b.source),"undefined"!=typeof b.files)){var f,c="",d="",e="",q="",u=[];for(f=0;f<this.embeddedFonts.length;f++)if(this.embeddedFonts[f]==b.family)return;"string"==typeof b.files?u[0]=b.files:u=b.files;for(f=0;f<u.length;f++)0<u[f].toLowerCase().indexOf(".ttf")&&(c=u[f]),0<u[f].toLowerCase().indexOf(".woff")&&(d=u[f]),0<u[f].toLowerCase().indexOf(".eot")&&(e=u[f]),0<u[f].toLowerCase().indexOf(".svg")&&(q=u[f]);""!=c&&0>c.indexOf("/")&&
(c=this.keyman.options.fonts+c);""!=d&&0>d.indexOf("/")&&(d=this.keyman.options.fonts+d);""!=e&&0>e.indexOf("/")&&(e=this.keyman.options.fonts+e);""!=q&&0>q.indexOf("/")&&(q=this.keyman.options.fonts+q);f="@font-face {\nfont-family:"+b.family+";\nfont-style:normal;\nfont-weight:normal;\n";if(9<=a.Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=c)c=this.unCached(c),f=f+"src:url('"+c+"') format('truetype');";else return;else{e=[];"Android"==this.device.OS?(""!=q&&e.push("url('"+q+"') format('svg')"),
""!=d&&e.push("url('"+d+"') format('woff')"),""!=c&&e.push("url('"+c+"') format('truetype')")):(""!=d&&e.push("url('"+d+"') format('woff')"),""!=c&&e.push("url('"+c+"') format('truetype')"),""!=q&&e.push("url('"+q+"') format('svg')"));if(0==e.length)return;f+="src:"+e.join(",")+";"}else if(""!=e)f=f+"src:url('"+e+"');";else return;this.addStyleSheet(f+"\n}\n");this.embeddedFonts.push(b.family)}};h.prototype.unCached=function(a){return a};h.prototype.loadCookie=function(a){var b={};if(0<arguments.length){var c=
this.loadCookie(),d;for(d in c)if(d==a)for(var e=decodeURIComponent(c[d]).split(";"),f=0;f<e.length;f++){var u=e[f].split("=");b[u[0]]=1<u.length?u[1]:""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(c=document.cookie.split(/;\s*/),f=0;f<c.length;f++)e=c[f].split("="),2==e.length&&(b[e[0]]=e[1]);return b};h.prototype.saveCookie=function(a,b){var c="",d;for(d in b)c=c+d+"="+b[d]+";";b=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=a+"="+encodeURIComponent(c)+
"; path=/; expires="+b};h.prototype.toNumber=function(a,b){a=parseInt(a,10);return isNaN(a)?b:a};h.prototype.toFloat=function(a,b){a=parseFloat(a);return isNaN(a)?b:a};h.prototype.nzString=function(a,b){var c="";1<arguments.length&&(c=b);return"undefined"==typeof a||null==a||0==a||""==a?c:""+a};h.prototype.deepCopy=function(a,b){b=b||{};for(var c in a)"object"===typeof a[c]?(b[c]=a[c].constructor===Array?[]:{},this.deepCopy(a[c],b[c])):b[c]=a[c];return b};h.prototype.eventTarget=function(a){return a?
a.target?a.target:a.srcElement?a.srcElement:window.event?window.event.srcElement:null:null};h.prototype.eventType=function(a){return a&&a.type?a.type:window.event?window.event.type:""};h.prototype.alert=function(a,b){var c=this.waiting,d=c.firstChild.childNodes;d[0].style.display="block";d[1].className="kmw-alert-text";d[1].innerHTML=a;d[2].style.display="none";c.style.display="block";c.dismiss=1<arguments.length?b:null};h.prototype.wait=function(a){};h.prototype.prepareWait=function(){var a=document.createElement("DIV"),
b=document.createElement("DIV"),c=document.createElement("DIV"),d=document.createElement("DIV"),e=document.createElement("DIV");a.className="kmw-wait-background";b.className="kmw-wait-box";a.dismiss=null;c.className="kmw-wait-text";d.className="kmw-wait-graphic";e.className="kmw-alert-close";b.onmousedown=b.onclick=function(c){"block"==e.style.display&&(a.style.display="none",a.dismiss&&a.dismiss())};b.addEventListener("touchstart",b.onclick,!1);a.onmousedown=a.onclick=function(a){a.preventDefault();
a.stopPropagation()};a.addEventListener("touchstart",a.onclick,!1);b.appendChild(e);b.appendChild(c);b.appendChild(d);a.appendChild(b);document.body.appendChild(a);this.waiting=a};h.prototype.shutdown=function(){this.events={};for(var a=0,b=this.domEvents;a<b.length;a++){var c=b[a];this.detachDOMEvent(c.Pelem,c.Peventname,c.Phandler,c.PuseCapture)}this.waiting.parentNode.removeChild(this.waiting);a=0;for(b=this.linkedStylesheets;a<b.length;a++)c=b[a],c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)};
h.prototype.myPath=function(a){var b,c=document.getElementsByTagName("script");for(b=0;b<c.length;b++){var d=c[b];if(0<=d.src.indexOf(a))return d.src.substr(0,d.src.lastIndexOf("/")+1)}return""};h.prototype.prependProtocol=function(a){return/^https?:/.test(a)?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.protocol+"/"+a:this.keyman.protocol+"//"+a};h.prototype.testString=function(a){var b=a.family;if("sample"in a&&"string"==typeof a.sample)return"BESbswy"+a.sample;var c=
"TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),d="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");for(a=0;a<c.length;a++)if(b==c[a])return"BESbswy"+d[a];return"BESbswy"};h.prototype.checkFont=function(a){var b=a.family,c=document.createElement("DIV"),d=c.style,e=document.createElement("P"),q=document.createElement("P"),
f=document.createElement("SPAN"),h=f.style,g=document.createElement("SPAN"),l=g.style;d.position="absolute";d.top="10px";d.left="10px";d.visibility="hidden";document.body.appendChild(c);c.appendChild(e);c.appendChild(q);e.appendChild(f);q.appendChild(g);f.setAttribute("style","font-family:monospace !important");l.fontFamily=b+",monospace";h.fontSize=l.fontSize="24px";f.innerHTML=g.innerHTML=this.testString(a);f.offsetWidth!=g.offsetWidth&&(f.setAttribute("style","font-family:sans-serif !important"),
l.fontFamily=b+",sans-serif",f.offsetWidth!=g.offsetWidth&&(f.setAttribute("style","font-family:serif !important"),l.fontFamily=b+",serif"));a=f.offsetWidth!=g.offsetWidth;e.removeChild(f);q.removeChild(g);c.removeChild(e);c.removeChild(q);document.body.removeChild(c);return a};h.prototype.checkFontDescriptor=function(a){return"undefined"==typeof a||"string"!=typeof a.family?!0:this.checkFont(a)};h.instanceof=function(a,b){var c;if(a.Window)return"Window"==b;a.defaultView?c=a.defaultView[b]:a.ownerDocument?
c=a.ownerDocument.defaultView[b]:a.target&&(this.instanceof(a.target,"Window")?c=a.target[b]:this.instanceof(a.target,"Document")?c=a.target.defaultView[b]:this.instanceof(a.target,"HTMLElement")&&(c=a.target.ownerDocument.defaultView[b]));return c?a instanceof c:!1};return h}();a.Util=l})(b.keyman||(b.keyman={}))})(com||(com={}));var Util=com.keyman.Util;
(function(b){(function(a){(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();var b=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&
(this._cache[a]=[]);this._cache[a][c]=b};return a}(),l=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};return a}(),h=function(){function a(c,b){this.p=c;this.d=b;this.o=a.ordinalSeed++}a.prototype.match=function(a,c){return this.p==a&&this.d==
c};a.prototype.set=function(){this.matched=1};a.prototype.reset=function(){this.matched=0};a.prototype.before=function(a){return this.o<a.o};a.ordinalSeed=0;return a}(),f=function(){function a(a){this.e=a;this.c=a.style.backgroundColor}a.prototype.reset=function(){this.e.style.backgroundColor=this.c};return a}(),k=function(){function c(c){this.cachedContext=new b;this.cachedContextEx=new l;this.TSS_LAYER=33;this.TSS_PLATFORM=31;this._AnyIndices=[];this._BeepObjects=[];this._BeepTimeout=0;this._DeadKeys=
[];this._CacheCommands=function(c){var d=[new a.StyleCommand("backcolor",1),new a.StyleCommand("fontname",1),new a.StyleCommand("fontsize",1),new a.StyleCommand("forecolor",1),new a.StyleCommand("bold",0),new a.StyleCommand("italic",0),new a.StyleCommand("strikethrough",0),new a.StyleCommand("subscript",0),new a.StyleCommand("superscript",0),new a.StyleCommand("underline",0)];c.defaultView&&this.keymanweb._push(d,["hilitecolor",1]);for(var b=0;b<d.length;b++)this.keymanweb._push(d[b],d[b][1]?c.queryCommandValue(d[b][0]):
c.queryCommandState(d[b][0]));return d};this._CacheCommandsReset=function(a,c,d){for(var b=0;b<c.length;b++)c[b][1]?a.queryCommandValue(c[b][0])!=c[b][2]&&(d&&d(),a.execCommand(c[b][0],!1,c[b][2])):a.queryCommandState(c[b][0])!=c[b][2]&&(d&&d(),a.execCommand(c[b][0],!1,null))};this.clearDeadkeys=function(){this._DeadKeys=[]};this.keymanweb=c}c.prototype.saveFocus=function(){a.DOMEventHandlers.states._IgnoreNextSelChange=1};c.prototype.insertText=function(c,b){this.resetContextCache();var d=this.keymanweb.domManager.getLastActiveElement();
var e=!1;if(null!=d){e=d._KeymanWebSelectionStart;var f=d._KeymanWebSelectionEnd;this.keymanweb.uiManager.setActivatingUI(!0);a.DOMEventHandlers.states._IgnoreNextSelChange=100;this.keymanweb.domManager.focusLastActiveElement();d.ownerDocument&&d instanceof d.ownerDocument.defaultView.HTMLIFrameElement&&this.keymanweb.domManager._IsMozillaEditableIframe(d,0)&&(d=d.documentElement);d._KeymanWebSelectionStart=e;d._KeymanWebSelectionEnd=f;a.DOMEventHandlers.states._IgnoreNextSelChange=0;null!=c&&this.output(0,
d,c);"undefined"!==typeof b&&null!==b&&this.deadkeyOutput(0,d,b);d._KeymanWebSelectionStart=null;d._KeymanWebSelectionEnd=null;e=!0}return e};c.prototype.registerKeyboard=function(a){this.keymanweb.keyboardManager._registerKeyboard(a)};c.prototype.registerStub=function(a){return this.keymanweb.keyboardManager._registerStub(a)};c.prototype.context=function(a,c,b){var d=this.cachedContext.get(a,c);if(null!==d)return d;b=this.keymanweb.KC_(a,c,b);this.cachedContext.set(a,c,b);return b};c.prototype.nul=
function(a,c){return"\ufffe"===this.context(a+1,1,c)};c.prototype.contextMatch=function(a,c,b,f){if(this.context(a,f,c)===b)return!0;this._DeadkeyResetMatched();return!1};c.prototype._BuildExtendedContext=function(a,c,b){var d=this.cachedContextEx.get(a,c);if(null!==d)return d;d=this.cachedContextEx.get(a,a);if(null===d){this._DeadKeys.sort(function(a,c){return a.p!=c.p?c.p-a.p:c.o-a.o});var e=[].concat(this._DeadKeys),f=0;for(d={valContext:[],deadContext:[]};d.valContext.length<a;){var q=this._SelPos(b)-
f;0<e.length&&e[0].p==q?(d.deadContext[a-d.valContext.length-1]=e[0],d.valContext=[e[0].d].concat(d.valContext),e.splice(0,1)):(q=this.context(++f,1,b),d.valContext=[q].concat(d.valContext))}this.cachedContextEx.set(a,a,d)}b=d;b.valContext=b.valContext.slice(0,c);for(d=0;d<b.valContext.length;d++)"\ufffe"==b[d]&&(b.valContext.splice(0,1),b.deadContext.splice(0,1));0==b.valContext.length&&(b.valContext=["\ufffe"],b.deadContext=[]);this.cachedContextEx.set(a,c,b);return b};c.prototype.fullContextMatch=
function(a,c,b){c=this._BuildExtendedContext(a,b.length,c);a=c.valContext;c=c.deadContext;for(var d=!1,e=0;e<b.length;e++)if("string"==typeof b[e]){if(b[e]!==a[e]){d=!0;break}}else{var f=b[e];switch(f.t){case "d":f.d!==a[e]?d=!0:c[e].set();break;case "a":var q=this.any(e,"string"==typeof a[e]?a[e]:{t:"d",d:a[e]},f.a);f.n?f.n&&(q||"\ufffe"!==a[e])&&(d=!0):q?void 0!==c[e]&&c[e].set():d=!0;break;case "i":f=this._Index(f.i,f.o);void 0!==f&&("string"==typeof f?f:f.d)!==a[e]?d=!0:void 0!==c[e]&&c[e].set();
break;case "c":a[f.c-1]!==a[e]?d=!0:void 0!==c[e]&&c[e].set();break;case "n":"\ufffe"!=a[e]&&(d=!0);break;default:throw Error("Unexpected object in fullContextMatch specification: "+f);}}d&&(this._DeadkeyResetMatched(),this._AnyIndices=[]);return!d};c.prototype.isKeypress=function(a){return this.keymanweb.keyboardManager.activeKeyboard.KM?!a.LisVirtualKey:this.keymanweb.keyMapManager._USKeyCodeToCharCode(a)?!0:!1};c.prototype.keyMatch=function(a,c,b){var d=!1,e=173==a.Lcode?189:a.Lcode,f=this.keymanweb.keyboardManager.getKeyboardModifierBitmask(),
q=f&this.keymanweb.osk.modifierBitmasks.ALL;f&=this.keymanweb.osk.stateBitmasks.ALL;255<a.vkCode&&(e=a.vkCode);if(a.LisVirtualKey||255<e){if(16384==(c&16384)||255<e)d=(d=b==e&&(c&q)==a.Lmodifiers)&&this.stateMatch(a,c&f)}else 0==(c&16384)&&(d=e==b);d||this._DeadkeyResetMatched();return d};c.prototype.stateMatch=function(a,c){return(c&a.Lstates)==c};c.prototype.keyInformation=function(c){var b=new a.KeyInformation;b.vk=c.LisVirtualKey;b.code=c.Lcode;b.modifiers=c.Lmodifiers;return b};c.prototype.deadkeyMatch=
function(a,c,b){if(0==this._DeadKeys.length)return!1;a=this._SelPos(c)-a;for(c=0;c<this._DeadKeys.length;c++)if(this._DeadKeys[c].match(a,b)&&!this._DeadKeys[c].matched)return this._DeadKeys[c].set(),!0;this._DeadkeyResetMatched();return!1};c.prototype.beepReset=function(){this.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();this._BeepObjects=[]};c.prototype.beep=function(a){this.resetContextCache();var c=a;c.defaultView&&a instanceof
c.defaultView.Document&&(a=c.body);if(a.style&&"undefined"!=typeof a.style.backgroundColor){for(c=0;c<this._BeepObjects.length;c++)if(this._BeepObjects[c].e==a)return;this._BeepObjects=this.keymanweb._push(this._BeepObjects,new f(a));a.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),50));"beepKeyboard"in this.keymanweb&&this.keymanweb.beepKeyboard()}};c.prototype._ExplodeStore=function(a){if("string"==typeof a){var c=this.keymanweb.keyboardManager.getActiveKeyboardTag();
if(c.stores[a])return c.stores[a];for(var b=[],d=0;d<a._kmwLength();d++)b.push(a._kmwCharAt(d));return c.stores[a]=b}return a};c.prototype.any=function(a,c,b){if(""==c)return!1;b=this._ExplodeStore(b);for(var d=-1,e=0;e<b.length;e++)if("string"==typeof b[e]){if(b[e]==c){d=e;break}}else if(b[e].d===c.d){d=e;break}this._AnyIndices[a]=d;return 0<=d};c.prototype._Index=function(a,c){a=this._ExplodeStore(a);if(this._AnyIndices[c-1]<a.length)return a[this._AnyIndices[c-1]];console.warn("Unmatched contextual index() statement detected in rule with index "+
c+"!");return""};c.prototype.indexOutput=function(a,c,b,f){this.resetContextCache();c=this._Index(c,b);if(""!==c)if("string"==typeof c)this.output(a,f,c);else if(c.t)switch(c.t){case "b":this.beep(f);break;case "d":this.deadkeyOutput(a,f,c.d);break;default:throw Error("Unexpected object in fullContextMatch specification: "+c);}else this.deadkeyOutput(a,f,c.d)};c.prototype.deleteContext=function(a,c){if(0<a){var b=this._BuildExtendedContext(a,a,c);for(var d=0;d<b.deadContext.length;d++){var e=b.deadContext[d];
e&&(e=this._DeadKeys.indexOf(e),this._DeadKeys.splice(e,1),a--)}}this._DeadkeyResetMatched();this.output(a,c,"")};c.prototype.output=function(c,b,f){this.resetContextCache();if("oninserttext"in this.keymanweb)this.keymanweb.oninserttext(c,f);var d=b.body?b:b.ownerDocument;var e;if(0<=b.className.indexOf("keymanweb-input"))d=this.keymanweb.touchAliasing.getTextBeforeCaret(b),d=0<c?d._kmwSubstr(0,d._kmwLength()-c)+f:d+f,this.keymanweb.touchAliasing.setTextBeforeCaret(b,d),this._DeadkeyDeleteMatched(),
0<=c&&this._DeadkeyAdjustPos(this._SelPos(b),-c+f._kmwLength());else{if(d&&(e=d.defaultView)&&e.getSelection&&("on"==d.designMode.toLowerCase()||"true"==b.contentEditable||"plaintext-only"==b.contentEditable||""===b.contentEditable)){var k="on"==d.designMode.toLowerCase();if(k)var q=this._CacheCommands(d);var h=e.getSelection();e=h.focusNode.nodeValue?h.focusNode.substringData(0,h.focusOffset)._kmwLength():0;h.isCollapsed||h.deleteFromDocument();var g=h.getRangeAt(0);0<c&&(g.setStart(h.focusNode,
h.focusOffset-h.focusNode.nodeValue.substr(0,h.focusOffset)._kmwSubstr(-c).length),g.deleteContents());if(0<f._kmwLength())if(3==h.focusNode.nodeType){g=h.focusOffset;h.focusNode.insertData(h.focusOffset,f);try{h.extend(h.focusNode,g+f.length)}catch(x){h.focusNode.parentNode.scrollIntoView(),h.extend(h.focusNode,g+f.length)}}else{var l=d.createTextNode(f);g.insertNode(l);h.extend(l,f.length)}k&&this._CacheCommandsReset(d,q,null);h.collapseToEnd();0<=c&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(e,
-c+f._kmwLength()))}else b.setSelectionRange&&(null!=b._KeymanWebSelectionStart?(e=b._KeymanWebSelectionStart,d=b._KeymanWebSelectionEnd):(e=b.value._kmwCodeUnitToCodePoint(b.selectionStart),d=b.value._kmwCodeUnitToCodePoint(b.selectionEnd)),"textarea"==b.type.toLowerCase()&&"undefined"!=typeof b.scrollTop&&(k=b.scrollTop,h=b.scrollLeft),0>c?(b.value=b.value._kmwSubstring(0,e)+f+b.value._kmwSubstring(d),c=0):b.value=e<c?f+b.value._kmwSubstring(d):b.value._kmwSubstring(0,e-c)+f+b.value._kmwSubstring(d),
0<=c&&(this._DeadkeyDeleteMatched(),this._DeadkeyAdjustPos(e,-c+f._kmwLength())),"undefined"!=typeof k&&(b.scrollTop=k,b.scrollLeft=h),d=e-c+f._kmwLength(),d=b.value._kmwCodePointToCodeUnit(d),b.setSelectionRange(d,d),b._KeymanWebSelectionStart=null,b._KeymanWebSelectionEnd=null);"function"==typeof this.keymanweb.refreshElementContent&&this.keymanweb.refreshElementContent(b)}(0<=c||f)&&b==a.DOMEventHandlers.states.activeElement&&(a.DOMEventHandlers.states.changed=!0)};c.prototype.deadkeyOutput=function(a,
c,b){this.resetContextCache();0<=a&&this.output(a,c,"");this._DeadKeys=[new h(this._SelPos(c),b)].concat(this._DeadKeys)};c.prototype.ifStore=function(a,c,b){b=!0;if(a==this.TSS_LAYER)b=this.keymanweb.osk.layerId===c;else if(a==this.TSS_PLATFORM){var d=c.split(" ");for(a=0;a<d.length;a++)switch(c=d[a].toLowerCase(),c){case "touch":case "hardware":this.keymanweb.util.activeDevice.touchable!=("touch"==c)&&(b=!1);break;case "macos":case "mac":c="macosx";case "macosx":case "windows":case "android":case "ios":case "linux":this.keymanweb.util.activeDevice.OS.toLowerCase()!=
c&&(b=!1);break;case "tablet":case "phone":case "desktop":this.keymanweb.util.device.formFactor!=c&&(b=!1);break;case "web":"native"==this.keymanweb.util.device.browser&&(b=!1);break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "edge":case "opera":this.keymanweb.util.device.browser!=c&&(b=!1);break;default:b=!1}}return b};c.prototype.setStore=function(a,c,b){this.resetContextCache();return a==this.TSS_LAYER?this.keymanweb.osk.showLayer(c):!1};c.prototype.loadStore=function(a,
c,b){this.resetContextCache();a=this.keymanweb.util.loadCookie("KeymanWeb_"+a+"_Option_"+c);return"undefined"!=typeof a[c]?decodeURIComponent(a[c]):b};c.prototype.saveStore=function(a,c){this.resetContextCache();var b=this.keymanweb.keyboardManager.activeKeyboard;if(!b||"undefined"==typeof b.KI||""==b.KI)return!1;a="KeymanWeb_"+b.KI+"_Option_"+a;c=encodeURIComponent(c);this.keymanweb.util.saveCookie(a,c);return!0};c.prototype.resetContextCache=function(){this.cachedContext.reset();this.cachedContextEx.reset()};
c.prototype._DeadkeyResetMatched=function(){for(var a=0,c=this._DeadKeys;a<c.length;a++)c[a].reset()};c.prototype._DeadkeyDeleteMatched=function(){for(var a=this._DeadKeys,c=0;c<a.length;c++)a[c].matched&&a.splice(c--,1)};c.prototype._DeadkeyAdjustPos=function(a,c){for(var b=0,d=this._DeadKeys;b<d.length;b++){var e=d[b];e.p>a&&(e.p+=c)}};c.prototype.doInputEvent=function(a){var c;"function"==typeof window.InputEvent&&(c=new window.InputEvent("input",{bubbles:!0,cancelable:!1}));a.base&&a.base.kmw_ip&&
(a=a.base);a&&c&&a.dispatchEvent(c)};c.prototype.defaultBackspace=function(a){a||(a=this.keymanweb.domManager.getLastActiveElement());this.output(1,a,"");this.doInputEvent(a)};c.prototype.processKeystroke=function(a,c,b){this.keymanweb._CachedSelectionStart=null;this._DeadkeyResetMatched();this.resetContextCache();this.keymanweb.util.activeDevice=a;(a=this.keymanweb.keyboardManager.activeKeyboard.gs(c,b))&&this.doInputEvent(c);return a};c.prototype.getLastActiveElement=function(){return this.keymanweb.domManager.getLastActiveElement()};
c.prototype.focusLastActiveElement=function(){this.keymanweb.domManager.focusLastActiveElement()};c.prototype.hideHelp=function(){this.keymanweb.osk._Hide(!0)};c.prototype.showHelp=function(a,c){this.keymanweb.osk._Show(a,c)};c.prototype.showPinnedHelp=function(){this.keymanweb.osk.userPositioned=!0;this.keymanweb.osk._Show(-1,-1)};c.prototype.resetContext=function(){this.keymanweb.osk.layerId="default";this.clearDeadkeys();this.resetContextCache();this.resetVKShift();this.keymanweb.osk._Show()};
c.prototype.setNumericLayer=function(){var a;for(a=0;a<this.keymanweb.osk.layers.length;a++)"numeric"==this.keymanweb.osk.layers[a].id&&(this.keymanweb.osk.layerId="numeric",this.keymanweb.osk._Show())};c.prototype._SelPos=function(c){var b,d;a.Device._GetIEVersion();if(this.keymanweb.isPositionSynthesized())return this.keymanweb.touchAliasing.getTextCaret(c);if(c._KeymanWebSelectionStart)return c._KeymanWebSelectionStart;if((b=c.ownerDocument)&&(d=b.defaultView))if(c instanceof d.HTMLInputElement||
c instanceof d.HTMLTextAreaElement){if(c.setSelectionRange)return c.value.substr(0,c.selectionStart)._kmwLength()}else if(d.getSelection&&"on"==c.ownerDocument.designMode.toLowerCase()&&(c=d.getSelection(),3==c.focusNode.nodeType))return c.focusNode.substringData(0,c.focusOffset)._kmwLength();return 0};c.prototype.resetVKShift=function(){this.keymanweb.uiManager.isActivating||this.keymanweb.osk._UpdateVKShift&&this.keymanweb.osk._UpdateVKShift(null,15,0)};return c}();a.KeyboardInterface=k})(b.keyman||
(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){function a(a,c){this.id=a;this.language=c}a.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};return a}(),l=function(){return function(a,b){this.family=a.family;this.files=a.source;this.path=b}}(),h=function(){return function(a,b){this.KI="Keyboard_"+a;this.KLC=b}}();a.KeyboardStub=h;var f=function(){return function(){this.stores={}}}();a.KeyboardTag=
f;var k=function(){function c(a){this.activeStub=null;this.keyboardStubs=[];this.deferredStubs=[];this.deferredKRS=[];this.deferredKR=[];this.dfltStub=null;this.keyboards=[];this.languageList=null;this.languagesPending=[];this.linkedScripts=[];this._GetKeyboardDetail=function(a){var c={};c.Name=a.KN;c.InternalName=a.KI;c.LanguageName=a.KL;c.LanguageCode=a.KLC;c.RegionName=a.KR;c.RegionCode=a.KRC;c.CountryName=a.KC;c.CountryCode=a.KCC;c.KeyboardID=a.KD;c.Font=a.KFont;c.OskFont=a.KOskFont;return c};
this.notifyKeyboard=function(a,c,b){var d=this.activeKeyboard;null!=d&&"function"==typeof d.KNS&&d.KNS(a,c,b)};this.keymanweb=a}c.prototype.getActiveKeyboardName=function(){return this.activeKeyboard?this.activeKeyboard.KI:""};c.prototype.getActiveKeyboardTag=function(){return this.activeKeyboard?this.activeKeyboard._kmw:null};c.prototype.getActiveLanguage=function(){return null==this.activeStub?"":this.activeStub.KLC};c.prototype.getDetailedKeyboards=function(){var a=[],c;for(c=0;c<this.keyboardStubs.length;c++){var b=
this.keyboardStubs[c];b=this._GetKeyboardDetail(b);a=this.keymanweb._push(a,b)}return a};c.prototype.registerDeferredStubs=function(){this.addKeyboardArray(this.deferredStubs);for(var a=0;a<this.deferredKRS.length;a++)this._registerStub(this.deferredKRS[a])};c.prototype.registerDeferredKeyboards=function(){for(var a=0;a<this.deferredKR.length;a++)this._registerKeyboard(this.deferredKR[a])};c.prototype.addStub=function(a){if("string"!=typeof a.id)return!1;"undefined"!=typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),
a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var c=a.languages,b=[];"undefined"==typeof c.length?b[0]=c:b=c;var d={keyboardBaseUri:this.keymanweb.options.keyboards,fontBaseUri:this.keymanweb.options.fonts};for(c=0;c<b.length;c++)this.mergeStub(a,b[c],d);return!0};c.prototype.mergeStub=function(a,b,f){var d=this.findStub(a.id,b.id),e=!1;null==d&&(d=new h(a.id,b.id),
this.keyboardStubs.push(d),e=!0);var k=b.region,g=0;if("number"==typeof k)g=1>k||9<k?0:k-1;else if("string"==typeof k)for(var q=2==k.length?c.regionCodes:c.regions,m=0;m<q.length;m++)if(k.toLowerCase()==q[m].toLowerCase()){g=m;break}d.KL="undefined"===typeof d.KL?b.name:d.KL;d.KR="undefined"===typeof d.KR?c.regions[g]:d.KR;d.KRC="undefined"===typeof d.KRC?c.regionCodes[g]:d.KRC;d.KN="undefined"===typeof d.KN?a.name:d.KN;"undefined"==typeof d.KF&&(k=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,d.KF=a.filename,
k.test(d.KF)||(d.KF=f.keyboardBaseUri+d.KF));a=f.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,k=/^https?\:/,k.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=a;"undefined"!=typeof b.font&&(d.KFont="undefined"===typeof d.KFont?new l(b.font,a):d.KFont);"undefined"!=typeof b.oskFont&&(d.KOskFont="undefined"===typeof d.KOskFont?new l(b.oskFont,a):d.KOskFont);
this.doKeyboardRegistered(d.KI,d.KL,d.KN,d.KLC,d.KP);!this.activeStub&&e&&1==this.keyboardStubs.length&&(this.doBeforeKeyboardChange(d.KI,d.KLC),this._SetActiveKeyboard(d.KI,d.KLC,!1),this.doKeyboardChange(d.KI,d.KLC))};c.prototype.findStub=function(a,c){var b;for(b=0;b<this.keyboardStubs.length;b++)if(this.keyboardStubs[b].KI=="Keyboard_"+a&&this.keyboardStubs[b].KLC==c)return this.keyboardStubs[b];return null};c.prototype.setDefaultKeyboard=function(){return 0<this.keyboardStubs.length?(this._SetActiveKeyboard(this.keyboardStubs[0].KI,
this.keyboardStubs[0].KLC),!0):!1};c.prototype.setActiveKeyboard=function(a,c){!this.keymanweb.isEmbedded&&a&&0!=a.indexOf("Keyboard_")&&(a="Keyboard_"+a);this.doBeforeKeyboardChange(a,c);var b=this._SetActiveKeyboard(a,c,!0);null!=this.keymanweb.domManager.getLastActiveElement()&&this.keymanweb.domManager.focusLastActiveElement();this.doKeyboardChange(a,c);return b};c.prototype._SetActiveKeyboard=function(a,c,b){var d,e,f=this.keymanweb.util,k=this.keymanweb.osk;if(2>arguments.length||!c)c="---";
for(d=0;d<this.keyboardStubs.length&&(a!=this.keyboardStubs[d].KI||c!=this.keyboardStubs[d].KLC&&"---"!=c);d++);f.device.touchable&&(""==a||null==a||d>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,c=this.keyboardStubs[0].KLC);2<arguments.length&&b&&this.saveCurrentKeyboard(a,c);if(this.activeStub&&this.activeKeyboard&&this.activeKeyboard.KI==a&&this.activeStub.KI==a&&this.activeStub.KLC==c&&!this.keymanweb.mustReloadKeyboard)return Promise.resolve();if(this.activeKeyboard&&
this.activeKeyboard.KI==a)for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&this.keyboardStubs[e].KLC==c)return this.activeStub=this.keyboardStubs[e],k.appendStyleSheet(),this.keymanweb.mustReloadKeyboard&&k._Load(),Promise.resolve();this.activeStub=this.activeKeyboard=null;if(""==a)return k._Hide(!1),this.keymanweb.isEmbedded||f.wait(!1),Promise.resolve();for(e=0;e<this.keyboards.length;e++)if(this.keyboards[e].KI==a){this.activeKeyboard=this.keyboards[e];this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement());
for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==a&&(this.keyboardStubs[d].KLC==c||"---"==c)){this.activeStub=this.keyboardStubs[d];break}break}if(null==this.activeKeyboard){for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&(this.keyboardStubs[e].KLC==c||"---"==c)){if(this.isCJK(this.keyboardStubs[e])||f.device.touchable)k._Enabled=1;if(!this.keyboardStubs[e].asyncLoader){k.ready&&k._Hide(!1);var h=this.keyboardStubs[e];h.asyncLoader={};var g=h.KN,q=h.KL;
g=g.replace(/\s*keyboard\s*/i,"");h.asyncLoader.callback=function(a,c){var b=a||"Sorry, the "+g+" keyboard for "+q+" is not currently available.";this.keymanweb.isEmbedded||(f.wait(!1),f.alert(a||b,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(c){case "err":console.error(b);break;default:console.warn(b)}0<e&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);h.asyncLoader.timer=window.setTimeout(h.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||
f.wait("Installing keyboard<br/>"+g);var l=this;h.asyncLoader.promise=new Promise(function(a,c){window.setTimeout(function(){l.installKeyboard(a,c,h)},0)})}this.activeStub=this.keyboardStubs[e];return this.keyboardStubs[e].asyncLoader.promise}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.getLastActiveElement())}d=this.activeKeyboard;null!==d&&String.kmwEnableSupplementaryPlane(d&&(d.KS&&1==d.KS||"Hieroglyphic"==d.KN));k._Load();return Promise.resolve()};c.prototype.installKeyboard=
function(a,c,b){var d=this.keymanweb.util,e=this.keymanweb.osk,f=d._CreateElement("script");f.charset="UTF-8";f.type="text/javascript";this.keymanweb.isEmbedded&&(f.id=b.KI);var k=b.KF,h=b.KL,g=b.KN,q=this;f.addEventListener("error",function(){null!==b.asyncLoader.timer&&(window.clearTimeout(b.asyncLoader.timer),b.asyncLoader.timer=null);b.asyncLoader.callback("Cannot find the "+g+" keyboard for "+h+".","warn");b.asyncLoader=null;c()},!1);f.addEventListener("load",function(){null!==b.asyncLoader.timer&&
(window.clearTimeout(b.asyncLoader.timer),b.asyncLoader.timer=null);var f=q.getKeyboardByID(b.KI);f?(b==q.activeStub&&(q.doBeforeKeyboardChange(f.KI,b.KLC),q.activeKeyboard=f,null!=q.keymanweb.domManager.getLastActiveElement()&&(q.keymanweb.uiManager.justActivated=!0,q.keymanweb.domManager._SetTargDir(q.keymanweb.domManager.getLastActiveElement())),String.kmwEnableSupplementaryPlane(f&&(f.KS&&1==f.KS||"Hieroglyphic"==f.KN)),q.saveCurrentKeyboard(f.KI,b.KLC),e._Load()),q.keymanweb.isEmbedded||d.wait(!1),
b.asyncLoader=null,a()):(b.asyncLoader.callback("Error registering the "+g+" keyboard for "+h+".","error"),b.asyncLoader=null,c())},!1);f.src=this.keymanweb.getKeyboardPath(k);try{document.body.appendChild(f),this.linkedScripts.push(f)}catch(x){try{document.getElementsByTagName("head")[0].appendChild(f)}catch(v){c()}}};c.prototype.saveCurrentKeyboard=function(a,c){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+c});this.keymanweb.isEmbedded||this.keymanweb.touchAliasing._BlurKeyboardSettings(a,
c)};c.prototype.restoreCurrentKeyboard=function(){var a=this.keyboardStubs,c=a.length;if(!(1>a.length)){var b=this.getSavedKeyboard();b.split(":");var f=b.split(":");2>f.length&&(f[1]="");for(b=0;b<c&&(a[b].KI!=f[0]||a[b].KLC!=f[1]&&""!=f[1]);b++);if(b<c||null==this.activeKeyboard)this._SetActiveKeyboard(f[0],f[1],!1),this.keymanweb.globalKeyboard=f[0],this.keymanweb.globalLanguageCode=f[1],this.doKeyboardChange(f[0],f[1])}};c.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");
if("string"!=typeof a.current)return"Keyboard_us:eng";var c,b=this.keyboardStubs;for(c=0;c<b.length;c++){var f=b[c].KI+":"+b[c].KLC;if(f==a.current)return f}for(c=0;c<b.length;c++)if(f=b[c].KI+":"+b[c].KLC,"Keyboard_us:eng"==f)return f;return 0<b.length?b[0].KI+":"+b[0].KLC:"Keyboard_us:eng"};c.prototype.isCJK=function(a){var c=this.activeKeyboard,b="";0<arguments.length&&(c=a);c&&("undefined"!=typeof c.KLC?b=c.KLC:"undefined"!=typeof c.LanguageCode&&(b=c.LanguageCode));return"cmn"==b||"jpn"==b||
"kor"==b};c.prototype.isRTL=function(a){a=a||this.activeKeyboard;return null!=a&&a.KRTL};c.prototype.isChiral=function(a){"string"==typeof a&&(a=this.getKeyboardByID(a));return!!(this.getKeyboardModifierBitmask(a)&this.keymanweb.osk.modifierBitmasks.IS_CHIRAL)};c.prototype.getKeyboardModifierBitmask=function(a){var c=this.activeKeyboard;0<arguments.length&&"undefined"!=typeof a&&(c=a);return c?c.KMBM?c.KMBM:this.keymanweb.osk.modifierBitmasks.NON_CHIRAL:0};c.prototype.getFont=function(a){return(a=
a||this.activeKeyboard)&&a.KV?a.KV.F:null};c.prototype.getKeyboardByID=function(a){var c;for(c=0;c<this.keyboards.length;c++)if(a==this.keyboards[c].KI)return this.keyboards[c];return null};c.prototype.isUniqueRequest=function(a,c){var b;if(null==this.findStub(c.id,c.language)){for(b=0;b<a.length;b++)if(a[b].id==c.id&&a[b].language==c.language)return!1;return!0}return!1};c.prototype.addKeyboardArray=function(a){if(!this.keymanweb.initialized)for(var c=0;c<a.length;c++)this.deferredStubs.push(a[c]);
else if(0!=a.length){var d,f="",k=[];for(c=0;c<a.length;c++){if("string"==typeof a[c]&&0<a[c].length){var h=a[c].split("@"),g=[""];"english"==h[0].toLowerCase()&&(h[0]="us");1<h.length&&(g=h[1].split(","));for(d=0;d<g.length;d++){var l=new b(h[0]);""!=g[d]&&(l.language=g[d]);2<h.length&&(l.version=h[2]);this.isUniqueRequest(k,l)&&k.push(l)}}if("object"==typeof a[c]&&null!=a[c])if("string"==typeof a[c].filename)this.addStub(a[c])||alert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");
else if(a[c].language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[c].languages=a[c].language),g=a[c].languages,"number"==typeof g.length)for(d=0;d<g.length;d++)l=new b(a[c].id,a[c].languages[d].id),this.isUniqueRequest(k,l)&&k.push(l);else l=new b(a[c].id,a[c].languages[d].id),this.isUniqueRequest(k,l)&&k.push(l)}if(0!=k.length){a="&keyboardid=";for(c=0;c<k.length;c++)a=a+f+k[c].toString(),f=",";this.keymanCloudRequest(a,
!1)}}};c.prototype.registerLanguagesForKeyboard=function(a,c,b){var d,e=0;var f="";if("undefined"!=typeof a)if("string"==typeof c.keyboardid&&(f=c.keyboardid.split(",")[b]),"number"==typeof a.length)if(1==a.length||"$"==f.substr(-1,1)||""==f)for(f=0;f<a.length;f++)this.registerLanguagesForKeyboard(a[f],c,b);else{for(f=0;f<a.length;f++){var k=a[f].id.toLowerCase();"us"==k&&(k="english");for(d=0;d<a[f].languages.length;d++)if(k==a[f].languages[d].name.toLowerCase()){e=f;break}}this.registerLanguagesForKeyboard(a[e],
c,b)}else if(b=f.split("@")[1],"string"==typeof b&&(b=b.replace(/\$$/,"")),e=a.languages,"undefined"!=typeof e)if("number"==typeof e.length)for(f=0;f<e.length;f++)"undefined"!=typeof b&&e[f].id!=b||this.mergeStub(a,e[f],c);else this.mergeStub(a,e,c)};c.prototype.register=function(a){var c=a.options;a.timerid&&window.clearTimeout(a.timerid);if("string"==typeof a.error)c="","string"==typeof a.keyboardid&&(c=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),this.serverUnavailable(c+" keyboard not found.");
else if("undefined"!=typeof c&&"undefined"!=typeof c.context)if("keyboard"==c.context){var b=a.keyboard;if("number"==typeof b.length)for(a=0;a<b.length;a++)this.registerLanguagesForKeyboard(b[a],c,a);else this.registerLanguagesForKeyboard(b,c,0)}else"language"==c.context&&(this.languageList=a.languages,this.languagesPending&&this.addLanguageKeyboards(this.languagesPending),this.languagesPending=[])};c.prototype.addLanguageKeyboards=function(a){var c,b;if(null==this.languageList){var d=0==this.languagesPending.length;
for(c=0;c<a.length;c++)this.languagesPending.push(a[c]);d&&this.keymanCloudRequest("",!0)}else{var f="";for(c=0;c<a.length;c++){var k=a[c].toLowerCase();(b="$"==k.substr(-1,1))&&(k=k.substr(0,k.length-1));for(d=0;d<this.languageList.length;d++)if(k==this.languageList[d].name.toLowerCase()){""!=f&&(f+=",");f=f+"@"+this.languageList[d].id;b&&(f+="$");break}}""==f?this.keymanweb.util.alert("No keyboards are available for "+a[0]+". Does it have another language name?"):this.keymanCloudRequest("&keyboardid="+
f,!1)}};c.prototype.keymanCloudRequest=function(c,b){var d="https://api.keyman.com/cloud/4.0/",e=this.keymanweb.util._CreateElement("script");d=d+(1<arguments.length&&b?"languages":"keyboards")+"?jsonp=keyman.register&languageidtype=bcp47&version="+this.keymanweb.version+"."+a.KeymanBase.__BUILD__;var f=this;var k="&timerid="+window.setTimeout(function(){f.serverUnavailable(c)},1E4);e.charset="UTF-8";e.src=d+c+k;e.type="text/javascript";try{document.body.appendChild(e)}catch(p){document.getElementsByTagName("head")[0].appendChild(e)}};
c.prototype.serverUnavailable=function(a){this.keymanweb.util.alert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};c.prototype.removeKeyboards=function(a){if(0==arguments.length)return!1;var c,b,d=!0,f=!1,k=!1;for(c=0;c<arguments.length;c++){for(b=this.keyboardStubs.length-1;0<=b;b--)if("Keyboard_"+arguments[c]==this.keyboardStubs[b].KI){"Keyboard_"+arguments[c]==this.getActiveKeyboardName()&&(f=!0);k=!0;this.keyboardStubs.splice(b,1);break}0>b&&(d=!1)}f&&(0<this.keyboardStubs.length?
this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);k&&this.doKeyboardUnregistered();return d};c.prototype._registerKeyboard=function(a){if(this.keymanweb.initialized)if(a._kmw)console.error("The keyboard _kmw property is a reserved field for engine use only; this keyboard is invalid.");else{a._kmw=new f;var c;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(a);var b=this.activeStub,d=this.activeStub;
if(!(b&&"KI"in b)||b.KI!=a.KI)for(c=0;c<this.keyboardStubs.length;c++){b=this.keyboardStubs[c];if(a.KI==b.KI)break;b=null}null==this.activeStub&&null!=b&&(this.activeStub=b);for(c=0;c<this.keyboards.length;c++)if(a.KI==this.keyboards[c].KI)return;this.keyboards=this.keymanweb._push(this.keyboards,a);this.doKeyboardLoaded(a.KI);this.activeStub=d}else this.deferredKR.push(a)};c.prototype._registerStub=function(a){var c;if(!this.keymanweb.initialized)return this.deferredKRS.push(a),null;null==this.dfltStub&&
(this.dfltStub=a);this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==typeof a.KL&&(a.KL="undefined");for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI==a.KI&&(""==a.KLC||this.keyboardStubs[c].KLC==a.KLC))return 1;this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a);this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,a.KP);this.activeStub||this.dfltStub!=a||1!=this.keyboardStubs.length||this.setActiveKeyboard(a.KI,a.KLC);
return null};c.prototype.doKeyboardRegistered=function(a,c,b,f,k){a={internalName:a,language:c,keyboardName:b,languageCode:f};k&&(a["package"]=k);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};c.prototype.doKeyboardUnregistered=function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};c.prototype.doKeyboardLoaded=function(a){var c={};c.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",c)};c.prototype.doBeforeKeyboardChange=function(a,c){var b=
{};b.internalName=a;b.languageCode=c;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",b)};c.prototype.doKeyboardChange=function(a,c,b){var d={};d.internalName=a;d.languageCode=c;d.indirect=2<arguments.length?b:!1;return this.keymanweb.util.callEvent("kmw.keyboardchange",d)};c.prototype.shutdown=function(){for(var a=0,c=this.linkedScripts;a<c.length;a++){var b=c[a];b.remove?b.remove():b.parentNode&&b.parentNode.removeChild(b)}};c.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");
c.regionCodes="un af as eu sa na oc ca me".split(" ");return c}();a.KeyboardManager=k})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){return function(){}}(),l=function(){return function(){this.FF=new b;this.Safari=new b;this.Opera=new b;this.FF.k61=187;this.FF.k59=186}}(),h=function(){return function(){this.se=new b;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new b;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),f=function(){function a(){this.browserMap=new l;this.languageMap=
new h;this._usCodeInit()}a.prototype._usCodeInit=function(){var a=new b,d=new b;a.k192=96;a.k49=49;a.k50=50;a.k51=51;a.k52=52;a.k53=53;a.k54=54;a.k55=55;a.k56=56;a.k57=57;a.k48=48;a.k189=45;a.k187=61;a.k81=113;a.k87=119;a.k69=101;a.k82=114;a.k84=116;a.k89=121;a.k85=117;a.k73=105;a.k79=111;a.k80=112;a.k219=91;a.k221=93;a.k220=92;a.k65=97;a.k83=115;a.k68=100;a.k70=102;a.k71=103;a.k72=104;a.k74=106;a.k75=107;a.k76=108;a.k186=59;a.k222=39;a.k90=122;a.k88=120;a.k67=99;a.k86=118;a.k66=98;a.k78=110;a.k77=
109;a.k188=44;a.k190=46;a.k191=47;d.k192=126;d.k49=33;d.k50=64;d.k51=35;d.k52=36;d.k53=37;d.k54=94;d.k55=38;d.k56=42;d.k57=40;d.k48=41;d.k189=95;d.k187=43;d.k81=81;d.k87=87;d.k69=69;d.k82=82;d.k84=84;d.k89=89;d.k85=85;d.k73=73;d.k79=79;d.k80=80;d.k219=123;d.k221=125;d.k220=124;d.k65=65;d.k83=83;d.k68=68;d.k70=70;d.k71=71;d.k72=72;d.k74=74;d.k75=75;d.k76=76;d.k186=58;d.k222=34;d.k90=90;d.k88=88;d.k67=67;d.k86=86;d.k66=66;d.k78=78;d.k77=77;d.k188=60;d.k190=62;d.k191=63;this._usCharCodes=[a,d]};a.prototype._USKeyCodeToCharCode=
function(a){return this._usCharCodes[a.Lmodifiers&16?1:0]["k"+a.Lcode]};return a}();a.KeyMapManager=f})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){function a(a,b,c){this.code=a;this.shift=b;this.handler=c}a.prototype.matches=function(a,b){return this.code==a&&this.shift==b};return a}(),l=function(){function a(a){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var c=this.keyman.domManager.nonTouchHandlers._GetEventKeyCode(a);if(null==c)return!1;for(var b=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),e=0;e<this.hotkeys.length;e++)if(this.hotkeys[e].matches(c,b))return this.hotkeys[e].Handler(),
a.returnValue=!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=a}a.prototype.addHotKey=function(a,k,c){for(var d=0;d<this.hotkeys.length;d++)if(this.hotkeys[d].code==a&&this.hotkeys[d].shift==k){this.hotkeys[d].handler=c;return}this.hotkeys.push(new b(a,k,c))};a.prototype.removeHotkey=function(a,b){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].matches(a,b)){this.hotkeys.splice(c,1);break}};return a}();a.HotkeyManager=l})(b.keyman||(b.keyman=
{}))})(com||(com={}));
(function(b){(function(a){var b=function(){return function(a,b){this.activationPending=a;this.activated=b}}();a.UIState=b;var l=function(){function a(a){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",{})};this.keyman=a}a.prototype.getUIState=function(){return new b(this.isActivating,this.justActivated)};a.prototype.setActivatingUI=function(a){this.isActivating=a?!0:!1};a.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};
return a}();a.UIManager=l})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){function b(){this._TitleElement=null;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=!1;this.refocusTimer=0;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null};this.refreshElementContent=
null;this.util=this.util=new a.Util(this);window.KeymanWeb=this.interface=this["interface"]=new a.KeyboardInterface(this);this.osk=this.osk={ready:!1};this.ui=this.ui=null;this.keyboardManager=new a.KeyboardManager(this);this.domManager=new a.DOMManager(this);this.hotkeyManager=new a.HotkeyManager(this);this.uiManager=new a.UIManager(this);this.keyMapManager=new a.KeyMapManager;this.build=b.__BUILD__;this.srcPath=b._srcPath;this.rootPath=b._rootPath;this.protocol=b._protocol;this.version="10.0";this.helpURL=
"http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}b.prototype.setDefaultDeviceOptions=function(a){};b.prototype.getStyleSheetPath=function(a){return a};b.prototype.getKeyboardPath=function(a,b){return a};b.prototype.KC_=function(a,b,k){return""};b.prototype.handleRotationEvents=function(){};b.prototype.alignInputs=function(a){};b.prototype.hideInputs=function(){};b.prototype.namespaceID=function(a){};b.prototype.preserveID=function(a){};b.prototype.setInitialized=function(a){this.initialized=
this.initialized=a};b.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};b.prototype.shutdown=function(){this.util.detachDOMEvent(window,"focus",this.pageFocusHandler,!1);this.util.detachDOMEvent(window,"blur",this.pageFocusHandler,!1);this.domManager.shutdown();this.osk.shutdown();this.util.shutdown();this.keyboardManager.shutdown();this.ui&&this.ui.shutdown&&this.ui.shutdown();a.DOMEventHandlers.states=new a.CommonDOMStates};
b.prototype.isFontAvailable=function(a){return this.util.checkFont({family:a})};b.prototype.addEventListener=function(a,b){return this.util.addEventListener("kmw."+a,b)};b.prototype._GetEventObject=function(a){if(!a&&(a=window.event,!a)){var b=this.domManager.getLastActiveElement();if(b){b=b.ownerDocument;if(b)var k=b.defaultView;if(!k)return null;a=k.event}}return a};b.prototype._push=function(a,b){a.push?a.push(b):a=a.concat(b);return a};b.prototype.attachToControl=function(a){this.domManager.attachToControl(a)};
b.prototype.detachFromControl=function(a){this.domManager.detachFromControl(a)};b.prototype.addKeyboards=function(a){0==arguments.length?this.keyboardManager.keymanCloudRequest("",!1):this.keyboardManager.addKeyboardArray(arguments)};b.prototype.addKeyboardsForLanguage=function(a){this.keyboardManager.addLanguageKeyboards(arguments)};b.prototype.register=function(a){this.keyboardManager.register(a)};b.prototype.removeKeyboards=function(a){return this.keyboardManager.removeKeyboards(a)};b.prototype.setActiveKeyboard=
function(a,b){return this.keyboardManager.setActiveKeyboard(a,b)};b.prototype.getActiveKeyboard=function(){return this.keyboardManager.getActiveKeyboardName()};b.prototype.getActiveLanguage=function(){return this.keyboardManager.getActiveLanguage()};b.prototype.isAttached=function(a){return this.domManager.isAttached(a)};b.prototype.isCJK=function(a){return this.keyboardManager.isCJK(a)};b.prototype.isChiral=function(a){return this.keyboardManager.isChiral(a)};b.prototype.getKeyboard=function(a,b){var f,
c=this.keyboardManager.getDetailedKeyboards();for(f=0;f<c.length;f++){var d=c[f];if(d.InternalName==a||d.InternalName=="Keyboard_"+a)if(2>arguments.length||d.LanguageCode==b)return d}return null};b.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};b.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};b.prototype.init=function(a){return this.domManager.init(a)};b.prototype.resetContext=function(){this.interface.resetContext()};b.prototype.setNumericLayer=
function(){this.interface.setNumericLayer()};b.prototype.disableControl=function(a){this.domManager.disableControl(a)};b.prototype.enableControl=function(a){this.domManager.enableControl(a)};b.prototype.setKeyboardForControl=function(a,b,k){this.domManager.setKeyboardForControl(a,b,k)};b.prototype.getKeyboardForControl=function(a){this.domManager.getKeyboardForControl(a)};b.prototype.getLanguageForControl=function(a){this.domManager.getLanguageForControl(a)};b.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};
b.prototype.getLastActiveElement=function(){return this.domManager.getLastActiveElement()};b.prototype.setActiveElement=function(a,b){return this.domManager.setActiveElement(a,b)};b.prototype.moveToElement=function(a){this.domManager.moveToElement(a)};b.prototype.addHotKey=function(a,b,k){this.hotkeyManager.addHotKey(a,b,k)};b.prototype.removeHotKey=function(a,b){this.hotkeyManager.removeHotkey(a,b)};b.prototype.getUIState=function(){return this.uiManager.getUIState()};b.prototype.activatingUI=function(a){this.uiManager.setActivatingUI(a)};
return b}();a.KeymanBase=b})(b.keyman||(b.keyman={}))})(com||(com={}));var scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+1),KeymanBase=com.keyman.KeymanBase;KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");KeymanBase.__BUILD__=6;
window.keyman&&window.keyman.loaded||function(){var b=window.keyman=new KeymanBase,a=b.osk;b.ui={};a.highlightSubKeys=function(a,b,h){};a.createKeyTip=function(){};a.optionKey=function(a,b,h){};a.showKeyTip=function(a,b){};a.waitForFonts=function(a,b){return!0}}();
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,g=b.util;b.debug=b.debug=function(a){if(null==b.debugElement){var g=document.createElement("DIV");var f=g.style;f.position="absolute";f.width="30%";f.maxHeight="50%";f.top="0";f.right="0";f.minHeight="50px";f.border="1px solid blue";f.whiteSpace="pre-line";f.overflowY="scroll";f=document.createElement("P");f.id="debug_output";f.style.margin="2px";g.appendChild(f);document.body.appendChild(g);b.debugElement=f}if(null!=(f=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof f.textContent?f.textContent="":f.innerHTML="";else{g=(new Date).toTimeString().substr(3,5)+" ";var k,c;for(k=0;k<arguments.length;k++){0<k&&(g+="; ");var d=arguments[k];if("object"==typeof d)if(null==d)g+="null";else{var e="";for(c in d){0<e.length&&(e+=", ");e=e+c+":";switch(typeof d[c]){case "string":case "number":case "boolean":e+=d[c];break;default:e+=typeof d[c]}if(1024<e.length){e=e.substr(0,1E3)+"...";break}}0<e.length&&(g=g+"{"+e+"}")}else g+=d}1500<g.length&&
(g=g.substr(0,1500)+" (more)");"undefined"!=typeof f.textContent?f.textContent=g+"\n"+f.textContent:f.innerHTML=g+"<br />"+f.innerHTML}};b.debugElement=null;b.delayedInit();a._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";b._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");g.attachDOMEvent(window,"load",b.domManager._WindowLoad,!1);g.attachDOMEvent(window,"unload",b.domManager._WindowUnload,!1);g.attachDOMEvent(document,"keyup",b.hotkeyManager._Process,
!1);b.pageFocusHandler=b.interface.resetVKShift.bind(b.interface);g.attachDOMEvent(window,"focus",b.pageFocusHandler,!1);g.attachDOMEvent(window,"blur",b.pageFocusHandler,!1);String.kmwEnableSupplementaryPlane(!1)}();
(function(b){(function(a){(function(a){var g=function(){function a(){}a.buildDefaultLayout=function(f,k,c){var d=window.keyman,e=d.osk,g=d.util;d=c;"object"!=typeof a.dfltLayout[d]&&(d="desktop");d=g.deepCopy(a.dfltLayout[d]);var h=d.layer,l=f.KLS,n=f.K102,p,y=0!=(k&e.modifierBitmasks.IS_CHIRAL);(k=!("undefined"==typeof l||!l))||(l=f.KLS=a.processLegacyDefinitions(f.BK));f=Object.getOwnPropertyNames(l);var m=[];f.splice(f.indexOf("default"),1);f=["default"].concat(f);a.emulatesAltGr(l)&&(-1==f.indexOf("leftctrl-leftalt")&&
-1!=f.indexOf("rightalt")&&(f.push("leftctrl-leftalt"),l["leftctrl-leftalt"]=l.rightalt),-1==f.indexOf("leftctrl-leftalt-shift")&&-1!=f.indexOf("rightalt-shift")&&(f.push("leftctrl-leftalt-shift"),l["leftctrl-leftalt-shift"]=l["rightalt-shift"]));if("desktop"==c)for(m=a.generateLayerIds(y),e=0;e<m.length;e++)-1!=f.indexOf(m[e])&&m.splice(e--,1);var r=f.concat(m);if(k&&"desktop"!=c){k=null;m=h[0].row;for(e=0;e<m.length;e++){var x=m[e].key;for(var v=0;v<x.length;v++){var t=x[v];"K_SHIFT"==t.id&&(k=
t)}}if(k)for(p in k.sk=[],l)"default"!=p&&"shift"!=p&&(e=a.modifierSpecials[p],k.sk.push(new b.keyman.OSKKeySpec("K_"+e,e,null,"1",p)));else console.warn("Error in default layout - cannot find default Shift key!")}for(e=0;e<r.length;e++)0<e&&(h[e]=g.deepCopy(h[0])),h[e].id=r[e],h[e].nextlayer=r[e],a.formatDefaultLayer(h[e],y,c,!!n);for(e=0;e<h.length;e++){n=h[e];v=r=y=k=null;var B=l[n.id],E="shift"==n.id?1:0,A="default"==n.id||E?1:0;m=n.row;for(p=0;p<m.length;p++)for(x=m[p].key,g=0;g<x.length;g++){t=
x[g];var w=a.dfltCodes.indexOf(t.id);if(B||A)B&&0<=w&&w<B.length&&(t.text=B[w]),A&&(""==t.text||"undefined"==typeof t.text)&&"K_SPACE"!=t.id&&w+65*E<a.dfltText.length&&(t.text=a.dfltText[w+65*E]);"undefined"==typeof t.text&&(t.text="");switch(t.id){case "K_SHIFT":k=t;break;case "K_CAPS":y=t;break;case "K_NUMLOCK":r=t;break;case "K_SCROLL":v=t}if(null!=t.sk){for(w=0;w<t.sk.length;w++)-1==f.indexOf(t.sk[w].nextlayer)&&t.sk.splice(w--,1);0==t.sk.length&&(t.sk=null)}}n.shiftKey=k;n.capsKey=y;n.numKey=
r;n.scrollKey=v;"desktop"!=c&&0<e&&null!=k&&(k.sp=a.buttonClasses["SHIFT-ON"],k.sk=null,k.text=a.modifierSpecials[h[e].id]?a.modifierSpecials[h[e].id]:"*Shift*")}return d};a.getLayerId=function(a){var b=window.keyman.osk.modifierCodes,c="";if(0==a)return"default";a&b.LCTRL&&(c=(0<c.length?c+"-":"")+"leftctrl");a&b.RCTRL&&(c=(0<c.length?c+"-":"")+"rightctrl");a&b.LALT&&(c=(0<c.length?c+"-":"")+"leftalt");a&b.RALT&&(c=(0<c.length?c+"-":"")+"rightalt");a&b.SHIFT&&(c=(0<c.length?c+"-":"")+"shift");a&
b.CTRL&&(c=(0<c.length?c+"-":"")+"ctrl");a&b.ALT&&(c=(0<c.length?c+"-":"")+"alt");return c};a.emulatesAltGr=function(b){var f=window.keyman,c=f.osk.modifierCodes;if(!f.keyboardManager.isChiral())return!1;if(!b){b=f.keyboardManager.activeKeyboard;if(null==b||null==b.KV)return!1;b=b.KV.KLS}var d=c.LCTRL|c.LALT,e=b[a.getLayerId(d)];d=b[a.getLayerId(c.SHIFT|d)];return null!=e&&e!=b[a.getLayerId(c.RALT)]||null!=d&&d!=b[a.getLayerId(c.RALT|c.SHIFT)]?!1:(f.keyboardManager.getKeyboardModifierBitmask(),!0)};
a.generateLayerIds=function(b){if(b){b=32;var f=1}else b=8,f=16;for(var c=[],d=0;d<b;d++)c.push(a.getLayerId(d*f));return c};a.formatDefaultLayer=function(b,k,c,d){for(var e=b.id,f=a.buttonClasses,g=0;g<b.row.length;g++)for(var h=b.row[g].key,l=0;l<h.length;l++){var p=h[l];switch(p.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=e.indexOf("shift")&&(p.sp=f["SHIFT-ON"]);"desktop"!=c&&"default"!=e&&(p.nextlayer="default");break;case "K_LCTRL":case "K_LCONTROL":if(k){-1!=e.indexOf("leftctrl")&&
(p.sp=f["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(k){-1!=e.indexOf("rightctrl")&&(p.sp=f["SHIFT-ON"]);break}case "K_CONTROL":-1==e.indexOf("ctrl")||k&&(-1==e.indexOf("leftctrl")||-1==e.indexOf("rightctrl"))||(p.sp=f["SHIFT-ON"]);break;case "K_LALT":if(k){-1!=e.indexOf("leftalt")&&(p.sp=f["SHIFT-ON"]);break}case "K_RALT":if(k){-1!=e.indexOf("rightalt")&&(p.sp=f["SHIFT-ON"]);break}case "K_ALT":-1==e.indexOf("alt")||k&&(-1==e.indexOf("leftalt")||-1==e.indexOf("rightalt"))||(p.sp=f["SHIFT-ON"]);
break;case "K_oE2":"undefined"!=typeof d&&d||("desktop"==c?(h.splice(l--,1),h[0].width="200"):h[l].sp=f.HIDDEN)}}};a.processLegacyDefinitions=function(b){for(var f=a.generateLayerIds(!1),c={},d=0;d<f.length;d++){for(var e=f[d],g=[],h=!1,l=0;65>l;l++){var n=l+65*d;g.push(b[n]);n<b.length&&""!=b[n]&&l!=a.dfltCodes.indexOf("K_SPACE")&&(h=!0)}h&&(c[e]=g)}"undefined"!=typeof c["default"]&&c["default"]||(c["default"]=[""]);"undefined"!=typeof c.shift&&c.shift||(c.shift=[""]);return c};a.dfltCodes="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
a.dfltText="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ ";a.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};a.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",alt:"*Alt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*",ctrl:"*Ctrl*","ctrl-alt":"*AltGr*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*","leftctrl-leftalt-shift":"*LAltCtrlShift*",
"rightctrl-rightalt-shift":"*RAltCtrlShift*",shift:"*Shift*","shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};a.dfltLayout={desktop:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},
{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",
width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},
tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},
{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",
text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"200"}]}]}]},
phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},
{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",
text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"200",sp:"1"}]}]}]}};
return a}();a.Layouts=g})(a.osk||(a.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){(function(a){var g=function(){function a(a){this.keyman=a;this.scrolling=!1;this.shim=this.constructShim()}a.prototype.constructShim=function(){var a=this,b=this.keyman.util._CreateElement("div"),c=this.keyman.osk;b.id="kmw-language-menu-background";b.addEventListener("touchstart",function(b){b.preventDefault();a.hide();if(2<b.touches.length){var d=b.touches[1].pageX;b=b.touches[1].pageY;d>c.spaceBar.offsetLeft&&d<c.spaceBar.offsetLeft+c.spaceBar.offsetWidth&&b>c.spaceBar.offsetTop&&
b<c.spaceBar.offsetTop+c.spaceBar.offsetHeight&&c.showBuild()}},!1);return b};a.prototype.show=function(){var a=this.keyman.keyboardManager.keyboardStubs,b=this.keyman.util;if(!(1>a.length)){var c=this.lgList=b._CreateElement("div");this.lgList.id="kmw-language-menu";var d=this;document.body.appendChild(this.shim);var e=b._CreateElement("div"),g=e.style,h=b._CreateElement("div");e.id="kmw-menu-scroll-container";h.id="kmw-menu-scroller";"WebkitOverflowScrolling"in g&&(g.WebkitOverflowScrolling="touch");
e.appendChild(h);c.appendChild(e);var l;g=b._CreateElement("div");g.id="kmw-menu-index";for(l=1;26>=l;l++){var n=b._CreateElement("p");n.innerHTML=String.fromCharCode(l+64);g.appendChild(n)}g.addEventListener("touchstart",function(a){d.scrollToLanguage(a,e,h)},!1);g.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},!1);c.appendChild(g);c.addEventListener("scroll",function(a){d.scrolling=!0},!1);e.addEventListener("scroll",function(a){1>e.scrollTop&&(e.scrollTop=1);e.scrollTop>
e.scrollHeight-e.offsetHeight-1&&(e.scrollTop=e.scrollHeight-e.offsetHeight-1)},!1);this.activeLgNo=this.addLanguages(h,a);this.lgList.style.visibility="hidden";document.body.appendChild(this.lgList);"Android"==b.device.OS&&"devicePixelRatio"in window&&(this.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==b.device.OS&&"tablet"==b.device.formFactor&&"devicePixelRatio"in window&&(l=parseInt(b.getStyleValue(c,"width"),10),a=c.style,isNaN(l)||(a.width=a.maxWidth=2*l/window.devicePixelRatio+
"px"),l=parseInt(b.getStyleValue(e,"width"),10),a=e.style,isNaN(l)||(a.width=a.maxWidth=2*l/window.devicePixelRatio+"px"),l=parseInt(b.getStyleValue(h,"width"),10),a=h.style,isNaN(l)||(a.width=a.maxWidth=2*l/window.devicePixelRatio+"px"));this.adjust(0);b=Math.floor(c.offsetHeight/26);a=Math.round(100*b/(g.childNodes[1].offsetTop-g.childNodes[0].offsetTop))/100;n=.6<a?1:2;1.25<a&&(a=1.25);for(l=0;26>l;l++){var p=g.childNodes[l].style;2==n&&1==l%2?p.display="none":(p.fontSize=a*n+"em",p.lineHeight=
b*n+"px")}l=e.offsetWidth;e.scrollHeight>e.offsetHeight+3?l+=g.offsetWidth:g.style.display="none";c.style.width=l+"px";this.lgList.style.visibility="";c=h.firstChild.offsetHeight*this.activeLgNo+1;e.scrollTop=c;e.scrollTop<c&&(e.scrollTop=e.scrollHeight-e.offsetHeight);e.scrollTop>e.scrollHeight-e.offsetHeight-1&&(e.scrollTop=e.scrollHeight-e.offsetHeight-1)}};a.prototype.adjust=function(a){var b=this.keyman.osk,c=this.keyman.util,d=c.device,e=this.lgList,f=e.firstChild,g=f.firstChild,h=e.style;e=
e.childNodes[1];var l=window.innerHeight-b.lgKey.offsetHeight-16;a=(g.childNodes.length+a-1)*g.firstChild.firstChild.offsetHeight;"iOS"==d.OS&&("phone"==d.formFactor?(d=c.landscapeView()?36:0,l=(window.innerHeight-d-16)*c.getViewportScale()):"tablet"==d.formFactor&&(d=c.landscapeView()?16:0,l-=d));h.left=c._GetAbsoluteX(b.lgKey)+"px";a>l&&(a=l);h.height=a+"px";h.top=c._GetAbsoluteY(b._Box)+b._Box.offsetHeight-a+window.pageYOffset-6+"px";h.bottom="auto";e.style.height=f.style.height=h.height};a.prototype.scrollToLanguage=
function(a,b,c){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();var d=a.touches[0].target;if("P"==d.nodeName){var e;a=0;d=d.innerHTML.charCodeAt(0);var f=c.childNodes;try{for(e=0;e<f.length-1;e++){var g=f[e].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(g>=d)break}}catch(C){}try{a=c.firstChild.offsetHeight*e+1,b.scrollTop=a}catch(C){a=0}try{b.scrollTop<a&&(b.scrollTop=b.scrollHeight-b.offsetHeight),b.scrollTop>b.scrollHeight-b.offsetHeight-1&&(b.scrollTop=b.scrollHeight-
b.offsetHeight-1)}catch(C){}}};a.prototype.addLanguages=function(a,b){var c=b.length,d=this.keyman.util,e=d.device,f,g,k=[];for(g=0;g<c;g++){var h=b[g].KL;-1==k.indexOf(h)&&k.push(h)}k.sort();var l=Math.round(100/d.getViewportScale())/100,y,m,r,x,v=-1;h=function(){y=d._CreateElement("div");y.className="kbd-list-closed";m=d._CreateElement("p");m.kList=[];for(g=0;g<c;g++)b[g].KL==k[f]&&m.kList.push(b[g]);"iOS"==e.OS&&(m.style.fontSize=l+"em");y.appendChild(m);a.appendChild(y);k[f]==t.keyman.keyboardManager.activeStub.KL&&
(v=f);var h=t;if(1<m.kList.length)for(m.className="kbd-list",m.innerHTML=k[f]+"...",m.scrolled=!1,m.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";h.adjust("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},m.addEventListener("touchstart",function(a){a.stopPropagation()},!1),m.addEventListener("touchmove",function(a){a.target.scrolled=
!0;a.stopPropagation()},!1),r=0;r<m.kList.length;r++)x=d._CreateElement("p"),x.className="kbd-list-entry","iOS"==e.OS&&(x.style.fontSize=l+"em"),t.addKeyboard(m.kList[r],x,!1),y.appendChild(x);else m.innerHTML=k[f],m.className="kbd-single-entry",t.addKeyboard(m.kList[0],m,!0);f==v&&(m.className+=" current")};var t=this;for(f=0;f<k.length;f++)h();h=d._CreateElement("div");h.id="kmw-menu-footer";var B=function(a){a.preventDefault();a.stopPropagation()};h.addEventListener("touchstart",B,!1);h.addEventListener("touchmove",
B,!1);h.addEventListener("touchend",B,!1);a.appendChild(h);return v};a.prototype.addKeyboard=function(a,g,c){g.kn=a.KI;g.kc=a.KLC;g.innerHTML=c?a.KL:a.KN.replace(" Keyboard","");var d=this;a=function(a){a.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");d.scrolling=!1;d.y0=a.touches[0].pageY;return!0};c=function(a){a.stopImmediatePropagation();var c=d.lgList.childNodes[0],b=c.scrollHeight-c.offsetHeight;if("undefined"!=typeof a.pageY)var e=a.pageY;else if("undefined"!=
typeof a.touches)e=a.touches[0].pageY;else return;var f=e-d.y0;if(0>f)c.scrollTop>=b-1&&(a.preventDefault(),d.y0=e);else if(0<f)2>c.scrollTop&&(a.preventDefault(),d.y0=e);else return;if(-5>f||5<f)d.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),d.y0=e;return!0};var e=function(a){a.preventDefault();"undefined"!=typeof a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation();d.scrolling?this.className=this.className.replace(/\s*selected/,""):(b.keyman.DOMEventHandlers.states.setFocusTimer(),
d.lgList.style.display="none",d.keyman.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),d.keyman.keyboardManager.doKeyboardChange(this.kn,this.kc),d.keyman.domManager.focusLastActiveElement(),d.hide(),d.keyman.osk._Show());return!0};g.onmspointerdown=a;g.addEventListener("touchstart",a,!1);g.onmspointermove=c;g.addEventListener("touchmove",c,!1);g.onmspointerout=e;g.addEventListener("touchend",e,!1)};a.prototype.hide=function(){var a=this.keyman.osk,b=this;this.lgList&&(a.highlightKey(a.lgKey.firstChild,
!1),this.lgList.style.visibility="hidden",window.setTimeout(function(){document.body.removeChild(b.shim);document.body.removeChild(b.lgList)},500))};return a}();a.LanguageMenu=g})(a.osk||(a.osk={}))})(b.keyman||(b.keyman={}))})(com||(com={}));
(function(b){(function(a){var b=function(){return function(a,b,g,c,d,e){this.id=a;this.text=b;this.width=g?g:"50";this.sp=c;this.nextlayer=d;this.pad=e}}();a.OSKKeySpec=b;b=function(){function a(a){this.spec=a}a.getTextWidth=function(b,g){g.fontFamily||(g.fontFamily=getComputedStyle(document.body).fontFamily);g.fontSize&&""!=g.fontSize||(g.fontSize="1em");var c=g.fontFamily,d=window.keyman.osk.getKeyEmFontSize();g=window.keyman.util.getFontSizeStyle(g.fontSize);d=g.absolute?g.val+"px":g.val*d+"px";
g=(a.getTextWidth.canvas||(a.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");g.font=d+" "+c;return g.measureText(b).width};a.prototype.getKeyWidth=function(){var a=this.objectUnits();if("px"==a)return this.spec.widthpc;if("%"==a)return a=window.keyman.osk.getWidthFromCookie(),Math.floor(a*this.spec.widthpc/100)};a.prototype.objectUnits=function(){return"desktop"==window.keyman.util.device.formFactor?"%":"px"};a.prototype.renameSpecialKey=function(a){var b=window.keyman.osk.specialCharacters;
return b[a]?String.fromCharCode(57344+b[a]):a};a.prototype.generateKeyText=function(){var b=window.keyman.util,g=this.spec,c=b._CreateElement("span"),d=c.style;if(null==g.text||""==g.text){var e="\u00a0";"string"==typeof g.id&&/^U_[0-9A-F]{4}$/i.test(g.id)&&(e=String.fromCharCode(parseInt(g.id.substr(2),16)))}else e=g.text;c.className="kmw-key-text";if("1"==g.sp||"2"==g.sp)e=this.renameSpecialKey("*Tab*"==g.text&&"shift"==g.layer?"*TabLeft*":g.text);var h=window.keyman.osk;d.fontSize=h.fontSize;"string"==
typeof g.font&&""!=g.font&&(d.fontFamily=g.font);"string"==typeof g.fontsize&&0!=g.fontsize&&(d.fontSize=g.fontsize);g=window.keyman.keyboardManager;var l={fontSize:d.fontSize};l.fontFamily=d.fontFamily?d.fontFamily:h.fontFamily;h=a.getTextWidth(e,l);0==h&&""!=e&&"\u00a0"!=e&&(e="\u25cc"+e,g.isRTL()&&(e="\u200f"+e),h=a.getTextWidth(e,l));b=b.getFontSizeStyle(d.fontSize);h=.9*this.getKeyWidth()/h;1>h&&(d.fontSize=b.absolute?h*b.val+"px":h*b.val+"em");c.innerHTML=e;return c};return a}();a.OSKKey=b;
var l=function(a){function b(b){return a.call(this,b)||this}__extends(b,a);b.prototype.getId=function(){return this.spec.layer+"-"+this.spec.id};b.prototype.generateKeyCapLabel=function(){var a=window.keyman.osk.keyCodes[this.spec.id];switch(a){case 186:a=59;break;case 187:a=61;break;case 188:a=44;break;case 189:a=45;break;case 190:a=46;break;case 191:a=47;break;case 192:a=96;break;case 219:a=91;break;case 220:a=92;break;case 221:a=93;break;case 222:a=39;break;default:if(48>a||90<a)a=0}if(0<a){var c=
window.keyman.util._CreateElement("div");c.className="kmw-key-label";c.innerHTML=String.fromCharCode(a);return c}return null};b.prototype.processSubkeys=function(a){var c,b=a.subKeys=this.spec.sk;for(c=0;c<b.length;c++)if("1"==b[c].sp||"2"==b[c].sp)b[c].text=this.renameSpecialKey(b[c].text);c=window.keyman.util._CreateElement("div");c.className="kmw-key-popup-icon";a.appendChild(c)};b.prototype.construct=function(a,c,b,e){var d=window.keyman.util,f=window.keyman.osk,g=this.spec,h="desktop"==d.device.formFactor;
g.layer=c;c=d._CreateElement("div");c.keyId=g.id;c.className="kmw-key-square";var k=c.style;k.width=this.objectGeometry(g.widthpc);var l=e,m=d._CreateElement("div");f.setButtonClass(g,m,a);h?k.marginLeft=this.objectGeometry(g.padpc):(k.left=this.objectGeometry(e+g.padpc),k.bottom=b.bottom,k.height=b.height,m.style.left=k.left,m.style.width=k.width);e=e+g.padpc+g.widthpc;(a.keyLabels||h)&&(a=this.generateKeyCapLabel())&&m.appendChild(a);m.id=this.getId();m.key=g;d.device.touchable||(m.onmouseover=
m.onmousedown=f.mouseOverMouseDownHandler,m.onmouseup=m.onmouseout=f.mouseUpMouseOutHandler);"undefined"!=typeof g.sk&&null!=g.sk?this.processSubkeys(m):m.subKeys=null;m.appendChild(this.generateKeyText());c.appendChild(m);return{element:c,percent:e-l}};b.prototype.objectGeometry=function(a){var c=this.objectUnits();return"%"==c?a+c:Math.round(a)+c};return b}(b);a.OSKBaseKey=l;b=function(a){function b(b){return a.call(this,b)||this}__extends(b,a);b.prototype.getId=function(){var a=this.spec;return"string"==
typeof a.layer&&""!=a.layer?"popup-"+a.layer+"-"+a.id:"popup-"+window.keyman.osk.layerId+"-"+a.id};b.prototype.construct=function(a,c){var b=window.keyman.osk,e=this.spec,f=document.createElement("div"),g=b.getDefaultKeyObject(),h=f.style,k;for(k in g)"string"!=typeof e[k]&&(e[k]=g[k]);f.className="kmw-key-square-ex";f.keyId=e.id;c&&(h.marginTop="5px");h.width="undefined"!=typeof e.width?parseInt(e.width,10)*a.offsetWidth/100+"px":a.offsetWidth+"px";h.height=a.offsetHeight+"px";a=document.createElement("div");
b.setButtonClass(e,a);a.id=this.getId();a.key=e;b=a.style;b.height=h.height;b.width=h.width;b.position="absolute";a.appendChild(this.generateKeyText());f.appendChild(a);return f};return b}(b);a.OSKSubKey=b})(b.keyman||(b.keyman={}))})(com||(com={}));
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,g=b.util,l=g.device,h=com.keyman.osk.Layouts,f=b["interface"];a.modifierCodes={LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384};a.modifierBitmasks={ALL:127,ALT_GR_SIM:a.modifierCodes.LCTRL|a.modifierCodes.LALT,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112};a.stateBitmasks={ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288};a.keyCodes=
{K_BKSP:8,K_TAB:9,K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,K_SPACE:32,K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,
K_NP2:98,K_NP3:99,K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,K_NPPLUS:107,K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,
K_QUOTE:222,K_oE2:226,K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,K_CURRENCIES:50005,K_UPPER:50006,K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012};a.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,"*Shifted*":8,"*AltGr*":2,"*TabLeft*":7,"*LAlt*":86,"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,
"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112};var k=[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']];a._Box=null;a._DivVKbd=null;a._DivVKbdHelp=null;a._Visible=0;a._Enabled=1;a._VShift=[];a._VKeySpans=[];a._VKeyDown=null;a._VKbdContainer=null;a._VOriginalWidth=1;a._BaseLayout="us";a._BaseLayoutEuro={};a._BaseLayoutEuro.se="\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ";
a._BaseLayoutEuro.uk="`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ ";a._stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};a.lgTimer=null;a.lgKey=null;a.hkKey=null;a.spaceBar=null;a.frameColor="#ad4a28";a.keyPending=null;a.fontFamily="";a.fontSize="1em";a.layout=null;a.layers=null;a.layerId="default";a.nextLayer="default";a.layerIndex=0;a.currentKey="";a.subkeyDelayTimer=null;a.popupPending=!1;a.popupVisible=!1;a.popupCallout=null;a.styleSheet=null;a.loadRetry=0;a.popupDelay=500;
a.currentTarget=null;a.touchCount=0;a.touchX=0;a.deleting=0;a.x=99;a.y=0;a.width=1;a.height=1;a.rowHeight=1;a.nRows=1;a.vpScale=1;a.closeButton=null;a.resizeIcon=null;a.resizing=0;a.pinImg=null;a.userPositioned=0;a.dfltX="";a.dfltY="";a.noDrag=!1;a.keytip=null;a.touchY=0;a.addCallout=function(a){};a.shutdown=function(){var c=a._Box;c.parentElement&&c.parentElement.removeChild(c)};a.addEventListener=function(a,b){return g.addEventListener("osk."+a,b)};a._TitleBarInterior=function(){var c=g._CreateElement("DIV"),
d=c.style;d.paddingLeft="2px";d.cursor="move";d.background="#ad4a28";d.font="8pt Tahoma,Arial,sans-serif";d=g._CreateElement("DIV");d.className="kmw-title-bar-actions";d.onmousedown=a._CancelMouse;var e=g._CreateElement("DIV");e.className="kmw-close-button";e.onmousedown=a._CancelMouse;e.onclick=function(){a._Hide(!0)};a.closeButton=e;d.appendChild(e);a.restorePosition=function(){a._Visible&&(b.domManager.focusLastActiveElement(),a.loadCookie(),a.userPositioned=!1,a.saveCookie(),a._Show(),a.doResizeMove());
a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)};e=a.pinImg=g._CreateElement("DIV");e.className="kmw-pin-image";e.title="Pin the On Screen Keyboard to its default location on the active text box";e.onclick=a.restorePosition;e.onmousedown=a._CancelMouse;e.style.display="none";l.touchable||d.appendChild(e);c.appendChild(d);e=b._TitleElement=g._CreateElement("SPAN");e.className="kmw-title-bar-caption";e.innerHTML="KeymanWeb";c.appendChild(e);return c};a.isEnabled=
a.isEnabled=function(){return a._Enabled};a.isVisible=a.isVisible=function(){return a._Visible};a.getRect=a.getRect=function(){var c={};a._DivVKbd?(c.left=c.left=g._GetAbsoluteX(a._DivVKbd),c.top=c.top=g._GetAbsoluteY(a._DivVKbd),c.width=c.width=g._GetAbsoluteX(a._DivVKbdHelp)-g._GetAbsoluteX(a._DivVKbd)+a._DivVKbdHelp.offsetWidth,c.height=c.height=g._GetAbsoluteY(a._DivVKbdHelp)-g._GetAbsoluteY(a._DivVKbd)+a._DivVKbdHelp.offsetHeight):(c.left=c.left=g._GetAbsoluteX(a._Box),c.top=c.top=g._GetAbsoluteY(a._Box),
c.width=c.width=g._GetAbsoluteX(a._Box)+a._Box.offsetWidth,c.height=c.height=g._GetAbsoluteY(a._Box)+a._Box.offsetHeight);return c};a.setRect=a.setRect=function(c){if(null!=a._Box&&"desktop"==l.formFactor){var b=a._Box,e=b.style;"left"in c&&(e.left=c.left-g._GetAbsoluteX(b)+b.offsetLeft+"px",a.dfltX=e.left);"top"in c&&(e.top=c.top-g._GetAbsoluteY(b)+b.offsetTop+"px",a.dfltY=e.top);if(null!=a._DivVKbd){var f=a._DivVKbd;e=f.style;if("width"in c){var h=c.width-(b.offsetWidth-f.offsetWidth);h<.2*screen.width&&
(h=.2*screen.width);h>.9*screen.width&&(h=.9*screen.width);e.width=h+"px";a.width=h}"height"in c&&(b=c.height-(b.offsetHeight-f.offsetHeight),b<.1*screen.height&&(b=.1*screen.height),b>.5*screen.height&&(b=.5*screen.height),e.height=b+"px",e.fontSize=b/8+"px",a.height=b);"nosize"in c&&a.resizeIcon&&(a.resizeIcon.style.display=c.nosize?"none":"block")}"nomove"in c&&(a.noDrag=c.nomove,a.pinImg&&(a.pinImg.style.display=c.nomove||!a.userPositioned?"none":"block"));a.saveCookie()}};a.getKeyEmFontSize=
function(){if("desktop"==g.device.formFactor)return.8*a.getFontSizeFromCookie();var c=getComputedStyle(document.body).fontSize;c=g.getFontSizeStyle(c).val;var b=g.getFontSizeStyle(a._Box).val;return c*b};a.getPos=function(){var c=a._Box;return{left:a._Visible?c.offsetLeft:a.x,top:a._Visible?c.offsetTop:a.y}};a.setPos=a.setPos=function(c){if("undefined"!=typeof a._Box&&!l.touchable){if(a.userPositioned){var b=c.left;c=c.top;"undefined"!=typeof b&&(b<-.8*a._Box.offsetWidth&&(b=-.8*a._Box.offsetWidth),
a.userPositioned&&(a._Box.style.left=b+"px",a.x=b));"undefined"!=typeof c&&(0>c&&(c=0),a.userPositioned&&(a._Box.style.top=c+"px",a.y=c))}a.pinImg&&(a.pinImg.style.display=a.userPositioned?"block":"none")}};a._VKeyGetTarget=function(a){a=b._GetEventObject(a);a=g.eventTarget(a);if(null==a)return null;3==a.nodeType&&(a=a.parentNode);"SPAN"==a.tagName&&(a=a.parentNode);return a};a.highlightKey=function(b,d){if(b&&""!=b.className&&!(0<=b.className.indexOf("kmw-key-row"))){var c=b.className;null!=a.keytip&&
0>c.indexOf("kmw-key-shift")&&0>c.indexOf("kmw-spacebar")&&0>b.id.indexOf("popup")?a.showKeyTip(b,d):d&&0>c.indexOf(" kmw-key-touched")?(b.className=c+" kmw-key-touched",a.showKeyTip(null,!1)):b.className=c.replace(" kmw-key-touched","")}};a.showSubKeys=function(b){if(null!=a.keyPending){var c=document.createElement("DIV");a.getDefaultKeyObject();c.id="kmw-popup-keys";a.popupBaseKey=b;"phone"==l.formFactor&&a.prependBaseKey(b);var e=b.id.split("-");var f=e[e.length-1];if("phone"==l.formFactor&&b.subKeys[0].id!=
f){f={id:f,layer:""};1<e.length&&(f.layer=e[0]);for(e=0;e<b.childNodes.length&&!a.hasClass(b.childNodes[e],"kmw-key-text");e++);e<b.childNodes.length&&(f.text=b.childNodes[e].textContent);b.subKeys.splice(0,0,f)}e=c.style;e.bottom=parseInt(b.style.bottom,10)+parseInt(b.style.height,10)+4+"px";e.fontFamily=a.fontFamily;e.fontSize=g.getStyleValue(b,"font-size");e.visibility="hidden";f=b.subKeys.length;var h=Math.min(Math.ceil(f/9),2);var k=Math.ceil(f/h);1<h&&(e.width=k*b.offsetWidth+5*k+"px");for(e=
0;e<f;e++){var n=!1,p=Math.floor(e/k);1<h&&0<p&&(n=!0);n=(new com.keyman.OSKSubKey(b.subKeys[e])).construct(b,n);c.appendChild(n)}a.showKeyTip(null,!1);a._Box.appendChild(c);e=c.style;f=g._GetAbsoluteX(b)+.5*(b.offsetWidth-c.offsetWidth);h=(g.landscapeView()?screen.height:screen.width)-c.offsetWidth;f>h&&(f=h);0>f&&(f=0);e.left=f+"px";a.popupCallout=a.addCallout(b);e.visibility="visible";c.shim=document.createElement("DIV");c.shim.id="kmw-popup-shim";a._Box.appendChild(c.shim);"phone"==l.formFactor&&
(b=c.childNodes[0].firstChild,a.keyPending=b,a.highlightKey(b,!0))}};a.prependBaseKey=function(b){if(b&&"undefined"!=typeof b.id){var c=b.id.split("-");var e=c[c.length-1];c=b.key&&b.key.layer?b.key.layer:1<c.length?c[0]:"";var f=b.key&&b.key.sp,g=b.key&&b.key.nextlayer?b.key.nextlayer:null;if("undefined"!=typeof b.subKeys&&0<b.subKeys.length&&(b.subKeys[0].id!=e||b.subKeys[0].layer!=c)){e={id:e,layer:"",key:void 0};""!=c&&(e.layer=c);f&&(e.sp=f);g&&(e.nextlayer=g);for(c=0;c<b.childNodes.length&&
!a.hasClass(b.childNodes[c],"kmw-key-text");c++);c<b.childNodes.length&&(e.text=b.childNodes[c].textContent);b.subKeys.splice(0,0,e)}}};a.getVKDictionaryCode=function(a){var c=b.keyboardManager.activeKeyboard;if(!c.VKDictionary){var e=[];if("string"==typeof c.KVKD)for(var f=c.KVKD.split(" "),g=0;g<f.length;g++)e[f[g].toUpperCase()]=g+256;c.VKDictionary=e}return(a=c.VKDictionary[a.toUpperCase()])?a:0};a.selectLayer=function(c,d){var e=2>arguments.length?null:d,f=b.keyboardManager.isChiral();"number"==
typeof e&&(e=h.getLayerId(16*e));if(!e)switch(c){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":e="shift";break;case "K_LCONTROL":case "K_LCTRL":if(f){e="leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(f){e="rightctrl";break}case "K_CTRL":e="ctrl";break;case "K_LMENU":case "K_LALT":if(f){e="leftalt";break}case "K_RMENU":case "K_RALT":if(f){e="rightalt";break}case "K_ALT":e="alt";break;case "K_ALTGR":e=f?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":e=
"default"}if(!e||e==a.layerId&&"desktop"!=l.formFactor)return!1;a.updateLayer(e);a._Show();return!0};a.defaultKeyOutput=function(c,d,e,g,h){var l="",q=!1,u=h&&"undefined"!=typeof h.base;0==e?q=!0:e==a.modifierCodes.SHIFT?(q=!0,e=1):console.warn("KMW only defines default key output for the 'default' and 'shift' layers!");if(u||g)switch((u=a.keyCodes[c])||(u=d),u){case a.keyCodes.K_BKSP:f.defaultBackspace();break;case a.keyCodes.K_TAB:b.domManager.moveToNext(e);break;case a.keyCodes.K_TABBACK:b.domManager.moveToNext(!0);
break;case a.keyCodes.K_TABFWD:b.domManager.moveToNext(!1);break;case a.keyCodes.K_ENTER:if("TEXTAREA"==h.nodeName||"undefined"!=typeof h.base&&"TEXTAREA"==h.base.nodeName)return"\n";g&&("INPUT"!=h.nodeName||"search"!=h.type&&"submit"!=h.type?"undefined"==typeof h.base||"search"!=h.base.type&&"submit"!=h.base.type?b.domManager.moveToNext(!1):(h.base.disabled=!1,h.base.form.submit()):h.form.submit());break;case a.keyCodes.K_SPACE:return" "}if("U_"==c.substr(0,2))c=parseInt(c.substr(2,6),16),0<=c&&
31>=c||128<=c&&159>=c?console.log("Suppressing Unicode control code: U_00"+c.toString(16)):l=String.kmwFromCharCode(c);else if(q)try{d>=a.keyCodes.K_0&&d<=a.keyCodes.K_9?l=k[e][0][d-a.keyCodes.K_0]:d>=a.keyCodes.K_A&&d<=a.keyCodes.K_Z?l=String.fromCharCode(d+(e?0:32)):d>=a.keyCodes.K_COLON&&d<=a.keyCodes.K_BKQUOTE?l=k[e][1][d-a.keyCodes.K_COLON]:d>=a.keyCodes.K_LBRKT&&d<=a.keyCodes.K_QUOTE&&(l=k[e][2][d-a.keyCodes.K_LBRKT])}catch(y){console.error("Error detected with default mapping for key:  code = "+
d+", shift state = "+(1==e?"shift":"default"))}return l};a.clickKey=function(c){var d=b.domManager.getLastActiveElement(),e,h=b.keyboardManager.activeKeyboard;var k=c.id.split("-");if(2>k.length)return!0;"popup"==k[0]&&k.splice(0,1);if(null!=d){var C=k[0],n=k[k.length-1].toUpperCase(),p=e=a.getModifierState(a.layerId);for(e=1;e<k.length-1;e++)C=C+"-"+k[e];"undefined"!=typeof c.key&&(p=c.key.nextlayer);b.domManager.initActiveElement(d);if("K_LOPT"==n||"K_ROPT"==n)return a.optionKey(c,n,!0),!0;a.highlightKey(c,
!1);if("desktop"==l.formFactor&&a.selectLayer(n,p))return!0;k=d._KeymanWebSelectionStart;e=d._KeymanWebSelectionEnd;b.uiManager.setActivatingUI(!0);com.keyman.DOMEventHandlers.states._IgnoreNextSelChange=100;b.domManager.focusLastActiveElement();b.domManager._IsMozillaEditableIframe(d,0)&&(d=d.documentElement);d._KeymanWebSelectionStart=k;d._KeymanWebSelectionEnd=e;com.keyman.DOMEventHandlers.states._IgnoreNextSelChange=0;b._CachedSelectionStart=null;f._DeadkeyDeleteMatched();k={Ltarg:d,Lmodifiers:0,
Lstates:0,Lcode:a.keyCodes[n],LisVirtualKey:!0};k.Lstates|=a._stateKeys.K_CAPS?a.modifierCodes.CAPS:a.modifierCodes.NO_CAPS;k.Lstates|=a._stateKeys.K_NUMLOCK?a.modifierCodes.NUM_LOCK:a.modifierCodes.NO_NUM_LOCK;k.Lstates|=a._stateKeys.K_SCROLL?a.modifierCodes.SCROLL_LOCK:a.modifierCodes.NO_SCROLL_LOCK;"U_"==n.substr(0,2)&&(k.LisVirtualKey=!1);"undefined"==typeof k.Lcode&&(k.Lcode=a.getVKDictionaryCode(n),k.Lcode||(k.Lcode=1));e="undefined"==typeof c.key?null:c.key.layer;e=null==e?a.getModifierState(C):
a.getModifierState(e);k.Lmodifiers=e;(k.Lmodifiers&a.modifierBitmasks.ALT_GR_SIM)==a.modifierBitmasks.ALT_GR_SIM&&a.emulatesAltGr()&&(k.Lmodifiers&=~a.modifierBitmasks.ALT_GR_SIM,k.Lmodifiers|=a.modifierCodes.RALT);if(!h||!h.KM||h.KVKL&&"desktop"!=l.formFactor)k.vkCode=k.Lcode;else if(k.Lcode!=a.keyCodes.K_SPACE){k.vkCode=k.Lcode;if(C=a.defaultKeyOutput("K_xxxx",k.Lcode,-1!=C.indexOf("shift")?16:0,!1,null))k.Lcode=C.charCodeAt(0);a._stateKeys.K_CAPS&&(65<=k.Lcode&&90>=k.Lcode||97<=k.Lcode&&122>=k.Lcode)&&
(k.Lmodifiers^=16,k.Lcode^=32)}"undefined"==typeof h.KM&&(k.Lcode=b.keyMapManager._USKeyCodeToCharCode(k),k.LisVirtualKey=!1);if(!h||0!=k.Lcode&&!f.processKeystroke(g.device,d,k))switch(k.Lcode=k.vkCode,n){case "K_CAPS":case "K_NUMLOCK":case "K_SCROLL":a._stateKeys[n]=!a._stateKeys[n];a._Show();break;default:(h=a.defaultKeyOutput(n,k.Lcode,e,!0,d))&&f.output(0,d,h)}"undefined"!=typeof c.key&&null!==c.key.nextlayer&&(a.nextLayer=c.key.nextlayer);a.selectLayer(n,p);d._KeymanWebSelectionStart=null;d._KeymanWebSelectionEnd=
null}b.uiManager.setActivatingUI(!1);return!0};a.getModifierState=function(b){var c=0;0<=b.indexOf("shift")&&(c|=a.modifierCodes.SHIFT);var e=!1;0<=b.indexOf("leftctrl")&&(c|=a.modifierCodes.LCTRL,e=!0);0<=b.indexOf("rightctrl")&&(c|=a.modifierCodes.RCTRL,e=!0);0<=b.indexOf("ctrl")&&!e&&(c|=a.modifierCodes.CTRL);e=!1;0<=b.indexOf("leftalt")&&(c|=a.modifierCodes.LALT,e=!0);0<=b.indexOf("rightalt")&&(c|=a.modifierCodes.RALT,e=!0);0<=b.indexOf("alt")&&!e&&(c|=a.modifierCodes.ALT);return c};a.updateLayer=
function(c){var d=a.layerId,e=c,f;if("desktop"==b.util.device.formFactor){var g="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(f=0;f<g.length;f++)e=e.replace(g[f]+"-",""),e=e.replace(g[f],"");if("default"==a.layerId||"numeric"==a.layerId||"symbol"==a.layerId||"currency"==a.layerId||""!=e)d=c;else{e=a.getModifierState(d);for(f=0;f<g.length;f++)d=d.replace(g[f]+"-",""),d=d.replace(g[f],"");switch(c){case "shift":e^=a.modifierCodes.SHIFT;break;case "leftctrl":e^=a.modifierCodes.LCTRL;
break;case "rightctrl":e^=a.modifierCodes.RCTRL;break;case "ctrl":e^=a.modifierCodes.CTRL;break;case "leftalt":e^=a.modifierCodes.LALT;break;case "rightalt":e^=a.modifierCodes.RALT;break;case "alt":e^=a.modifierCodes.ALT;break;default:d=c}"default"!=d&&(d=""==d?h.getLayerId(e):h.getLayerId(e)+"-"+d)}""==d&&(d="default")}else d=c;a.layerId=d;for(f=0;f<a.layers.length;f++)if(a.layerId==a.layers[f].id)return;a.layerId="default"};a.showLanguage=function(){var c="",d=b.keyboardManager.activeStub;if(d){var e=
d.KL;c=d.KN}else e=b._ActiveLanguage?b._ActiveLanguage.KN:"English";try{var f=a.spaceBar.firstChild.firstChild;f.parentNode.className="undefined"==typeof f.parentNode.className||""==f.parentNode.className?"kmw-spacebar":f.parentNode.className+" kmw-spacebar";f.className="kmw-spacebar-caption";c=c.replace(/\s*keyboard\s*/i,"");d="";d=c==e?e:e+" ("+c+")";f.innerHTML!=d&&(f.innerHTML=d)}catch(u){}};a.showLanguageMenu=function(){(new com.keyman.osk.LanguageMenu(b)).show()};a._UpdateVKShift=function(c,
d,e){var f=0,g=["CAPS","NUM_LOCK","SCROLL_LOCK"],k=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(c)for(f=c.Lmodifiers,d=c.Lstates,b.keyboardManager.isChiral()&&a.emulatesAltGr()&&(com.keyman.DOMEventHandlers.states.modStateFlags&a.modifierBitmasks.ALT_GR_SIM)==a.modifierBitmasks.ALT_GR_SIM&&(f|=a.modifierBitmasks.ALT_GR_SIM,f&=~a.modifierCodes.RALT),c=0;c<g.length;c++)d&a.stateBitmasks[g[c]]&&(a._stateKeys[k[c]]=d&a.modifierCodes[g[c]]);else if(e)for(f|=d,c=0;c<g.length;c++)d&a.stateBitmasks[g[c]]&&(a._stateKeys[k[c]]=
!0);else for(f&=~d,c=0;c<g.length;c++)d&a.stateBitmasks[g[c]]&&(a._stateKeys[k[c]]=!1);a.layerId=h.getLayerId(f);a._Visible&&a._Show();return!0};a._UpdateVKShiftStyle=function(b){var c;if(b)for(c=0;c<a.layers.length&&a.layers[c].id!=a.layerId;c++);else{c=a.layerIndex;b=a.layers[c].id;var e=a.layers[c];c=["K_CAPS","K_NUMLOCK","K_SCROLL"];var f=[e.capsKey,e.numKey,e.scrollKey];for(e=0;e<f.length;e++)if(null!=f[e]){f[e].sp=a._stateKeys[c[e]]?h.buttonClasses["SHIFT-ON"]:h.buttonClasses.SHIFT;var g=document.getElementById(b+
"-"+c[e]);a.setButtonClass(f[e],g,a.layout)}}};a._CancelMouse=function(a){(a=b._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};a.showLayer=function(c){if(b.keyboardManager.activeKeyboard)for(var d=0;d<a.layers.length;d++)if(a.layers[d].id==c)return a.layerId=c,a._Show(),!0;return!1};a.getHeight=function(){if("function"==typeof b.getOskHeight)return b.getOskHeight();var a=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==
l.formFactor){var d=Math.min(screen.height,screen.width),e=Math.max(screen.height,screen.width);a=g.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):e/d*a/1.6}"iOS"==l.OS&&(a/=g.getViewportScale());"Android"==l.OS&&"phone"==l.formFactor&&"devicePixelRatio"in window&&/Firefox|Chrome|OPR/.test(navigator.userAgent)&&(a*=window.devicePixelRatio);return a};a.getWidth=function(){if("function"==typeof b.getOskWidth)return b.getOskWidth();if("iOS"==g.device.OS)var a=window.innerWidth;
else if("Android"==l.OS)try{a=document.documentElement.clientWidth}catch(d){a=screen.availWidth}else a=screen.width;return a};a.mouseOverMouseDownHandler=function(b){var c=g.eventTarget(b);null!==c&&"desktop"==l.formFactor&&("SPAN"==c.nodeName&&(c=c.parentNode),"mousedown"==g.eventType(b)?(a.currentKey=c.id,a._CancelMouse(b),a.highlightKey(c,!0)):c.id==a.currentKey&&a.highlightKey(c,!0))};a.mouseUpMouseOutHandler=function(b){var c=g.eventTarget(b);null!==c&&"desktop"==l.formFactor&&("SPAN"==c.nodeName&&
(c=c.parentNode),a.highlightKey(c,!1),"mouseup"==g.eventType(b)&&(c.id==a.currentKey&&a.clickKey(c),a.currentKey=""))};a.getDefaultKeyObject=function(){return{text:"",width:"100",pad:"15",sp:"0",layer:null,nextlayer:null}};a.deviceDependentLayout=function(b,d){var c=g._CreateElement("DIV"),f=c.style;c.className="kmw-key-layer-group";switch(d){case "phone":case "tablet":var k=a.getHeight();f.height=k+"px"}if(null==b)return c;k=b.fontsize;f.fontSize="undefined"==typeof k||null==k||""==k?"1em":b.fontsize;
a.fontSize=f.fontSize;var h;var n=b.layer;var p=a.getDefaultKeyObject();p.fontsize=f.fontSize;var y=/\*\w+\*/;for(k=0;k<n.length;k++){var m=n[k];var r=m.row;for(h=r.length;0<h&&!(0<r[h-1].key.length);h--);h<r.length&&r.splice(h-r.length,r.length-h)}var x=100/r.length;"desktop"==d&&(x=100/r.length);var v="desktop"==d?100:a.getWidth();l.touchable&&(c.addEventListener("touchstart",a.touch,!0),c.addEventListener("touchend",a.release,!0),c.addEventListener("touchmove",a.moveOver,!1));for(k=0;k<n.length;k++){m=
n[k];m.aligned=!1;var t=g._CreateElement("DIV");r=t.style;t.className="kmw-key-layer";r.display=0==k?"block":"none";r.height=f.height;r.fontFamily="font"in b?b.font:"";t.layer=t.nextLayer=m.id;"string"==typeof m.nextlayer&&(t.nextLayer=m.nextlayer);r=m.row;var B=0;for(h=0;h<r.length;h++){var E=0;var A=r[h];var w=A.key;for(A=0;A<w.length;A++){var z=w[A];if(null==z)--w.length;else{var F="string"==typeof z.width&&""!=z.width?parseInt(z.width,10):100;if(isNaN(F)||0==F)F=100;z.width=F.toString();var D=
"string"==typeof z.pad&&""!=z.pad?parseInt(z.pad,10):15;if(isNaN(D)||0==D)D=15;z.pad=D.toString();E+=F+D}}E>B&&(B=E)}B="desktop"==d?B+5:B+15;for(h=0;h<r.length;h++){E=g._CreateElement("DIV");E.className="kmw-key-row";E.onmousedown=g.mouseDownPreventDefaultHandler;A=r[h];F=E.style;F.maxHeight=F.height=x+"%";w=A.key;for(A=0;A<w.length;A++){z=w[A];for(var H in p)"string"!=typeof z[H]&&(z[H]=p[H]);switch(z.sp){case "1":y.test(z.text)||""==z.text||(z.sp="3");break;case "2":y.test(z.text)||""==z.text||
(z.sp="4")}}for(A=D=0;A<w.length-1;A++){z=Math.round(parseInt(w[A].width,10)*v/B);w[A].widthpc=z;var G=Math.round(parseInt(w[A].pad,10)*v/B);w[A].padpc=G;D+=G+z}D+=Math.round(15*v/B);1==w.length&&0>parseInt(w[0].pad,10)?(z=Math.round(parseInt(w[0].width,10)*v/B),w[0].widthpc=z,D+=z,w[0].padpc=v-D):0<w.length&&(A=w.length-1,G=Math.round(parseInt(w[A].pad,10)*v/B),w[A].padpc=G,D+=G,w[A].widthpc=v-D);for(A=D=0;A<w.length;A++)z=w[A],z=(new com.keyman.OSKBaseKey(z)).construct(b,m.id,F,D),E.appendChild(z.element),
D+=z.percent;t.appendChild(E)}c.appendChild(t)}return c};a.clearPopup=function(){var b=document.getElementById("kmw-popup-keys");null!=b&&(b.shim&&a._Box.removeChild(b.shim),b.parentNode.removeChild(b));a.popupCallout&&a._Box.removeChild(a.popupCallout);a.popupCallout=null;a.subkeyDelayTimer&&(window.clearTimeout(a.subkeyDelayTimer),a.subkeyDelayTimer=null);a.popupBaseKey=null};a.touch=function(b){var c=b.changedTouches[0].target,e=a.keyTarget(c);a.touchX=b.changedTouches[0].pageX;a.currentTarget=
e;var f=document.getElementById("kmw-popup-keys");if(!(f&&"visible"==f.style.visibility||a.popupVisible)){a.touchCount=b.touches.length;if(e&&0<=e.className.indexOf("key-hidden")||0<=c.className.indexOf("kmw-key-row"))e=a.findNearestKey(b,c);null!=e&&(b=e.id.split("-"),b=b[b.length-1],a.highlightKey(e,!0),"K_LOPT"==b||"K_ROPT"==b?(window.setTimeout(function(){a.clickKey(e)},0),a.keyPending=null):"K_BKSP"==b?(a.clickKey(e),a.deleteKey=e,a.deleting=window.setTimeout(a.repeatDelete,500),a.keyPending=
null):(a.keyPending?(a.highlightKey(a.keyPending,!1),a.clickKey(a.keyPending),a.clearPopup(),a.touchCount--):a.touchHold(e),a.keyPending=e))}};a.release=function(b){var c=document.getElementById("kmw-popup-keys"),e=a.currentTarget;if(c&&"visible"==c.style.visibility||a.popupVisible){if(0<b.touches.length)return;if(null==e||0>e.id.indexOf("popup")&&e.id!=a.popupBaseKey.id)a.highlightKey(a.keyPending,!1),a.clearPopup(),a.keyPending=null}e&&e.id&&a.optionKey(b,e.id,!1);e=b.changedTouches[0].pageX;e=
2>e&&5<a.touchX||e>window.innerWidth-2&&a.touchX<window.innerWidth-5;c=a.touchCount;0<a.touchCount&&a.touchCount--;a.keyPending?(a.highlightKey(a.keyPending,!1),0>a.keyPending.className.indexOf("hidden")&&0<c&&!e&&a.clickKey(a.keyPending),a.clearPopup(),a.keyPending=null):(c=b.changedTouches[0],e=a.keyTarget(c.target),e||(e=document.elementFromPoint(c.clientX,c.clientY),e=a.findNearestKey(b,e)),a.highlightKey(e,!1));a.deleting&&window.clearTimeout(a.deleting);a.deleting=0};a.moveOver=function(b){b.preventDefault();
b.cancelBubble=!0;"function"==typeof b.stopImmediatePropagation?b.stopImmediatePropagation():"function"==typeof b.stopPropagation&&b.stopPropagation();if(!(1<b.touches.length||0==a.touchCount)){var c="object"==typeof b.touches?b.touches[0].clientX:b.clientX,e="object"==typeof b.touches?b.touches[0].clientY:b.clientY,f=document.elementFromPoint(c,e),g=a.keyPending,h=a.keyTarget(f);if(h&&0<=h.className.indexOf("key-hidden")||f&&!h&&0<=f.className.indexOf("key-row"))h=a.findNearestKey(b,f);h&&"string"==
typeof h.id&&0>h.id.indexOf("BKSP")&&(a.deleting&&window.clearTimeout(a.deleting),a.deleting=0);if(a.popupVisible)null==h?(g&&a.highlightKey(g,!1),a.keyPending=null):h==a.popupBaseKey?(a.hasClass(h,"kmw-key-touched")||a.highlightKey(h,!0),a.keyPending=h):(g&&a.highlightKey(g,!1),a.keyPending=null);else{(f=document.getElementById("kmw-popup-keys"))&&"visible"==f.style.visibility&&"phone"==l.formFactor&&h==a.popupBaseKey&&(h=f.childNodes[0].firstChild);a.currentTarget=h;g&&h&&h.id!=g.id&&a.highlightKey(g,
!1);a.highlightSubKeys(h,c,e);if(f&&"visible"==f.style.visibility){if(h&&0>h.id.indexOf("popup")&&h!=a.popupBaseKey)return;h&&h==a.popupBaseKey&&0>h.className.indexOf("kmw-key-touched")&&a.highlightKey(h,!0)}else g&&b.touches[0].pageY<Math.max(5,a._Box.offsetTop-.25*a._Box.offsetHeight)&&(a.highlightKey(g,!1),a.showKeyTip(null,!1),a.keyPending=null);h&&a.keyPending&&(a.keyPending=h);a.keyPending&&(g!=h||0>h.className.indexOf("kmw-key-touched"))&&a.highlightKey(h,!0);g&&h&&h!=g&&""!=h.id&&a.touchHold(h)}}};
a.hasClass=function(a,b){b=" "+b+" ";return 0<=(" "+a.className+" ").replace(/[\n\t\r\f]/g," ").indexOf(b)};a.keyTarget=function(b){try{if(b){if(a.hasClass(b,"kmw-key"))return b;if(b.parentNode&&a.hasClass(b.parentNode,"kmw-key"))return b.parentNode;if(b.firstChild&&a.hasClass(b.firstChild,"kmw-key"))return b.firstChild}}catch(d){}return null};a.findNearestKey=function(a,b){if(!a||"undefined"==typeof a.changedTouches||0==a.changedTouches.length)return null;for(a=a.changedTouches[0].pageX;b&&0>b.className.indexOf("key-row");)b=
b.parentNode;if(!b)return null;var c,d=0,f=24,g=1E5;for(c=0;c<b.childNodes.length;c++)if(!(0<=b.childNodes[c].firstChild.className.indexOf("key-hidden"))){var h=b.childNodes[c].offsetLeft;var k=h+b.childNodes[c].offsetWidth;h-=a;0<=h&&h<g&&(d=c,g=h);h=a-k;0<=h&&h<g&&(d=c,g=h)}return 1E5>g&&(b=b.childNodes[d],h=b.offsetLeft,k=h+b.offsetWidth,40<b.offsetWidth&&(f=.6*b.offsetWidth),0<=h-a&&h-a<f||0<=a-k&&a-k<f)?b.firstChild:null};a.repeatDelete=function(){a.deleting&&(a.clickKey(a.deleteKey),a.deleting=
window.setTimeout(a.repeatDelete,100))};a.setButtonClass=function(b,d,e){var c=0,f="default shift shift-on special special-on    deadkey blank hidden".split(" ");"string"==typeof b.dk&&"1"==b.dk&&(c=8);"string"==typeof b.sp&&(c=parseInt(b.sp,10));if(0>c||10<c)c=0;e=e||a.layout;d.className=4<e.layer[0].row.length&&"phone"==g.device.formFactor?"kmw-key kmw-5rows kmw-key-"+f[c]:"kmw-key kmw-key-"+f[c]};a.emulatesAltGr=function(a){return h.emulatesAltGr(a)};a._GenerateVisualKeyboard=function(c,d,e,f){d=
g._CreateElement("DIV");var k=b.keyboardManager.activeKeyboard;if("object"!=typeof e||null==e)e=h.buildDefaultLayout(c,f,l.formFactor);a.layout=e;a.layers=e.layer;a.fontFamily="font"in e?e.font:"";e.keyLabels=k&&"undefined"!=typeof k.KDU&&k.KDU;c=a.deviceDependentLayout(e,l.formFactor);a.ddOSK=!0;a.keyMap=c;d.appendChild(c);a._DivVKbdHelp=a._DivVKbd=d;a._Box.className=l.formFactor+" "+l.OS.toLowerCase()+" kmw-osk-frame";d.className=l.formFactor+" kmw-osk-inner-frame";"desktop"==l.formFactor&&a._Box.appendChild(a.controlBar());
a._Box.appendChild(d);"desktop"==l.formFactor?a._Box.appendChild(a.resizeBar()):a.adjustHeights()};b.BuildVisualKeyboard=b.buildOSK=function(c,d,e,f){d=b.keyboardManager.activeKeyboard;var g="undefined"==typeof e?"desktop":e;f="undefined"==typeof f?"default":f;e=b.keyboardManager.keyboards;if(null!=c){var k=c.toLowerCase().replace("keyboard_","");for(c=0;c<e.length;c++)if(k==e[c].KI.toLowerCase().replace("keyboard_","")){d=e[c];break}}if(!d)return null;c=d.KVKL;e=null;k=d.KV;"object"==typeof c&&("object"==
typeof c[g]&&null!=c[g]?e=c[g]:"phone"==g&&"object"==typeof c.tablet&&null!=c.tablet?e=c.tablet:"tablet"==g&&"object"==typeof c.phone&&null!=c.phone?e=c.phone:"object"==typeof c.desktop&&null!=c.desktop&&(e=c.desktop));null==e&&null!=k&&(e=h.buildDefaultLayout(k,b.keyboardManager.getKeyboardModifierBitmask(d),g));null!=e&&(e.keyLabels="undefined"!=typeof d.KDU&&d.KDU);k=a.deviceDependentLayout(e,g);k.className=g+"-static kmw-osk-inner-frame";if(null!=e){var l,q;for(c=0;c<e.layer.length;c++){d=k.childNodes[c];
for(l=0;l<d.childNodes.length;l++)for(g=d.childNodes[l],q=0;q<g.childNodes.length;q++){var y=g.childNodes[q];y.style.height="100%"}d.style.display="number"==typeof f?c==f&&0<=f?"block":"none":"string"==typeof f?e.layer[c].id==f?"block":"none":0==c?"block":"none"}}else k.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+g+" layout is defined for "+d.KN+".</p>";k.style.border="1px solid #ccc";return k};a.adjustHeights=function(){if(a._Box&&a._Box.firstChild&&a._Box.firstChild.firstChild&&
a._Box.firstChild.firstChild.childNodes){var b=a._Box.firstChild.firstChild.childNodes,d=b[0].childNodes.length,e=a.getHeight(),f=Math.floor(e/(0==d?1:d)),h,k,n;var p=1;"Android"==l.OS&&"devicePixelRatio"in window&&(f/=window.devicePixelRatio);e=d*f;d=a._Box;f=d.style;f.height=f.maxHeight=e+3+"px";d=d.firstChild.firstChild;f=d.style;f.height=f.maxHeight=e+3+"px";"iOS"==l.OS&&(p/=g.getViewportScale());f.fontSize=p+"em";var y="iOS"==l.OS&&"phone"==l.formFactor&&g.landscapeView();for(p=0;p<b.length;p++){d=
b[p].childNodes.length;f=Math.floor(e/(0==d?1:d));var m=Math.round(.15*f);b[p].style.height=e+3+"px";for(h=0;h<d;h++){var r=b[p].childNodes[h].style;r.bottom=(d-h-1)*f+1+"px";r.maxHeight=r.height=f+"px";var x=b[p].childNodes[h].childNodes;var v=x.length;for(k=0;k<v;k++){var t=x[k];for(n=0;n<t.childNodes.length&&!a.hasClass(t.childNodes[n],"kmw-key");n++);var B=t.childNodes[n].style;B.bottom=r.bottom;B.height=B.minHeight=f-m+"px";y&&0<n&&(t.childNodes[0].style.fontSize="6px")}}}}};a.controlBar=function(){var c=
g._CreateElement("DIV"),d="";c.id="keymanweb_title_bar";c.className="kmw-title-bar";c.onmousedown=a._VMoveMouseDown;b.keyboardManager.activeKeyboard&&(d=b.keyboardManager.activeKeyboard.KN);var e=g._CreateElement("SPAN");e.className="kmw-title-bar-caption";e.innerHTML=d;c.appendChild(e);d=a.closeButton=g._CreateElement("DIV");d.id="kmw-close-button";d.className="kmw-title-bar-image";d.onmousedown=a._CancelMouse;d.onclick=function(){a._Hide(!0)};c.appendChild(d);d=a.helpImg=g._CreateElement("DIV");
d.id="kmw-help-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Help";d.onclick=function(){g.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=a._CancelMouse;c.appendChild(d);d=a.configImg=g._CreateElement("DIV");d.id="kmw-config-image";d.className="kmw-title-bar-image";d.title="KeymanWeb Configuration Options";d.onclick=function(){g.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=a._CancelMouse;
c.appendChild(d);d=a.pinImg=g._CreateElement("DIV");d.id="kmw-pin-image";d.className="kmw-title-bar-image";d.title="Pin the On Screen Keyboard to its default location on the active text box";d.onclick=function(){a.loadCookie();a.userPositioned=!1;a.saveCookie();a._Show();a.doResizeMove();a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1);return!1};d.onmousedown=a._CancelMouse;c.appendChild(d);return c};a.showBuild=function(){g.alert("KeymanWeb Version "+b.version+
"."+b.build+'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2017 SIL International</span>')};a.resizeBar=function(){var b=g._CreateElement("DIV");b.className="kmw-footer";b.onmousedown=a._CancelMouse;var d=g._CreateElement("DIV");d.className="kmw-footer-caption";d.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';d.id="keymanweb-osk-footer-caption";g.attachDOMEvent(d,"dblclick",function(b){b&&b.shiftKey&&a.showBuild()},!1);"onselectstart"in d&&(d.onselectstart=
g.selectStartHandler);b.appendChild(d);d=g._CreateElement("DIV");d.className="kmw-footer-resize";d.onmousedown=a._VResizeMouseDown;d.onmouseover=d.onmouseout=a._VResizeMouseOut;b.appendChild(d);a.resizeIcon=d;return b};a._VKbdMouseOver=function(a){b.uiManager.setActivatingUI(!0)};a._VKbdMouseOut=function(a){b.uiManager.setActivatingUI(!1)};a._VResizeMouseOver=a._VResizeMouseOut=function(c){c=b._GetEventObject(c);if(!c)return!1;c&&c.preventDefault&&c.preventDefault();var d=a.getRect();a.width=d.width;
a.height=d.height;c.cancelBubble=!0;return!1};a._VResizeMouseDown=function(c){b.uiManager.justActivated=!0;c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(c.pageX){var d=c.pageX;var e=c.pageY}else c.clientX&&(d=c.clientX+document.body.scrollLeft,e=c.clientY+document.body.scrollTop);a._ResizeMouseX=d;a._ResizeMouseY=e;document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);a._VPreviousCursor=
document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof c.which?c.button:c.which;a._VOriginalWidth=a._DivVKbd.offsetWidth;a._VOriginalHeight=a._DivVKbd.offsetHeight;document.onmousemove=a._VResizeMouseMove;document.onmouseup=a._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="se-resize");c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VResizeMouseMove=function(c){c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(a._VPreviousMouseButton!=
("undefined"==typeof c.which?c.button:c.which))return a._VResizeMoveMouseUp(c);if(c.pageX){var d=c.pageX;var e=c.pageY}else c.clientX&&(d=c.clientX+document.body.scrollLeft,e=c.clientY+document.body.scrollTop);d=a._VOriginalWidth+d-a._ResizeMouseX;e=a._VOriginalHeight+e-a._ResizeMouseY;d<.2*screen.width&&(d=.2*screen.width);e<.1*screen.height&&(e=.1*screen.height);d>.9*screen.width&&(d=.9*screen.width);e>.5*screen.height&&(d=.5*screen.height);a._DivVKbd.style.width=d+"px";a._DivVKbd.style.height=
e+"px";a._DivVKbd.style.fontSize=e/8+"px";c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VMoveMouseDown=function(c){b.uiManager.justActivated=!0;c=b._GetEventObject(c);if(!c)return!0;a.resizing=1;if(c.pageX){var d=c.pageX;var e=c.pageY}else c.clientX&&(d=c.clientX+document.body.scrollLeft,e=c.clientY+document.body.scrollTop);document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);
a._VPreviousCursor=document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof c.which?c.button:c.which;a._VMoveX=d-a._Box.offsetLeft;a._VMoveY=e-a._Box.offsetTop;b.keyboardManager.isCJK()&&(a.pinImg.style.left="15px");document.onmousemove=a._VMoveMouseMove;document.onmouseup=a._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");c&&c.preventDefault&&c.preventDefault();c.cancelBubble=!0;return!1};a._VMoveMouseMove=function(c){c=b._GetEventObject(c);if(!c||
a.noDrag)return!0;a.resizing=1;a.userPositioned=!0;a.pinImg.style.display="block";if(a._VPreviousMouseButton!=("undefined"==typeof c.which?c.button:c.which))return a._VResizeMoveMouseUp(c);if(c.pageX){var d=c.pageX;var e=c.pageY}else c.clientX&&(d=c.clientX+document.body.scrollLeft,e=c.clientY+document.body.scrollTop);a._Box.style.left=d-a._VMoveX+"px";a._Box.style.top=e-a._VMoveY+"px";c&&c.preventDefault&&c.preventDefault();d=a.getRect();a.width=d.width;a.height=d.height;c.cancelBubble=!0;return!1};
a._VResizeMoveMouseUp=function(c){c=b._GetEventObject(c);if(!c)return!0;a.resizing=0;a.currentKey=null;document.onmousemove=a._VPreviousMouseMove;document.onmouseup=a._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=a._VPreviousCursor);b.domManager.focusLastActiveElement();c&&c.preventDefault&&c.preventDefault();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);a._DivVKbd&&(a._VOriginalWidth=a._DivVKbd.offsetWidth,a._VOriginalHeight=a._DivVKbd.offsetHeight);a.doResizeMove();
c.cancelBubble=!0;a.saveCookie();return!1};a.userLocated=function(){return a.userPositioned};a.show=function(b){0<arguments.length?(a._Enabled=b)?a._Show():a._Hide(!0):a._Visible?a._Hide(!0):a._Show()};a.doShow=function(a){return g.callEvent("osk.show",a)};a.doHide=function(a){return g.callEvent("osk.hide",a)};a.doResizeMove=function(a){return g.callEvent("osk.resizemove",a)};a._Show=function(c,d){if(null!=a._Box&&null!=b.domManager.getActiveElement()&&(l.touchable||null!=b.keyboardManager.activeKeyboard&&
a._Enabled)){var e=a._Box.style;l.touchable&&""==e.bottom&&(e.visibility="hidden");l.touchable&&(e.opacity="1");if(a.ddOSK){var f,h=-1,k=a._DivVKbd.childNodes[0].childNodes;for(f=0;f<k.length;f++)k[f].layer==a.layerId?(k[f].style.display="block",a.nextLayer=a.layerId,a.layerIndex=h=f,"string"==typeof a.layers[f].nextlayer&&(a.nextLayer=a.layers[f].nextlayer),a._UpdateVKShiftStyle()):k[f].style.display="none";l.touchable&&(e.position="fixed",e.left=e.bottom="0px",e.height=e.maxHeight=a._Box.firstChild.firstChild.style.height,
e.border="none",e.borderTop="1px solid gray",a._Enabled=1,a._Visible=1,a.lgKey=a.getSpecialKey(h,"K_LOPT"),a.hkKey=a.getSpecialKey(h,"K_ROPT"),"iOS"==l.OS&&"phone"==l.formFactor&&a.adjustHeights());a.spaceBar=a.getSpecialKey(h,"K_SPACE")}e.display="block";a.showLanguage();"desktop"==l.formFactor&&(e.position="absolute",e.display="block",e.left="0px",a.loadCookie(),0<=c?(e.left=c+"px",e.top=d+"px"):a.userPositioned?(e.left=a.x+"px",e.top=a.y+"px"):(c=b.domManager.getActiveElement(),""!=a.dfltX?e.left=
a.dfltX:"undefined"!=typeof c&&null!=c&&(e.left=g._GetAbsoluteX(c)+"px"),""!=a.dfltY?e.top=a.dfltY:"undefined"!=typeof c&&null!=c&&(e.top=g._GetAbsoluteY(c)+c.offsetHeight+"px")),a._Enabled=1,a._Visible=1,a._DivVKbd&&(a.width=a._DivVKbd.offsetWidth,a.height=a._DivVKbd.offsetHeight),a.saveCookie(),c=a.pinImg,"undefined"!=typeof c&&null!=c&&(c.style.display=a.userPositioned?"block":"none"));"hidden"==e.visibility&&window.setTimeout(function(){a._Box.style.visibility="visible"},0);l.touchable||(e={},
e.x=a._Box.offsetLeft,e.y=a._Box.offsetTop,e.userLocated=a.userPositioned,a.doShow(e))}};a.adjustRowLengths=function(b){if(!(0<=b)){var c=a._DivVKbd.childNodes[0].childNodes;if(!(0>b||b>=c.length||c[b].aligned)&&"block"==c[b].style.display){var e=a._DivVKbd.childNodes[0].offsetWidth-6;"Windows"==l.OS&&(e-=g.landscapeView()?4:40);var f,h=c[b].childNodes;for(f=0;f<h.length;f++){var k=h[f].childNodes;var n=k.length;var p=k[n-2].offsetLeft+k[n-2].offsetWidth;k=k[n-1];k.style.width=e-p+"px"}c[b].aligned=
!0}}};a.resetRowLengths=function(){var b,d=a._DivVKbd.childNodes[0].childNodes,e=-1;for(b=0;b<d.length;b++)"block"==d[b].style.display&&(e=b),d[b].aligned=!1;return e};a.getSpecialKey=function(b,d){var c=a._DivVKbd.childNodes[0].childNodes;if(0<=b&&b<c.length)for(b=c[b].childNodes,c=b[b.length-1].childNodes,b=0;b<c.length;b++)if(c[b].keyId==d)return c[b];return null};a.hide=function(){a._Enabled=0;a._Hide(!0)};a._Hide=function(c){a._Box&&"block"==a._Box.style.display&&a._DivVKbd&&(a.width=a._DivVKbd.offsetWidth,
a.height=a._DivVKbd.offsetHeight);if(c)a._Enabled=b.keyboardManager.isCJK()||l.touchable?1:0,a.saveCookie();else if("desktop"==l.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;a._Visible=0;if(a._Box&&l.touchable&&0<a._Box.offsetHeight){var d=a._Box.style;d.transition="string"==typeof d.MozBoxSizing?"opacity 0.8s linear":d.msTransition=d.WebkitTransition="opacity 0.5s linear 0";window.setTimeout(function(){var b=a._Box.style;a._Visible?b.transition=b.msTransition=b.MozTransition=
b.WebkitTransition="":(b.opacity="0",a._Box.addEventListener("transitionend",a.hideNow,!1),a._Box.addEventListener("webkitTransitionEnd",a.hideNow,!1))},200)}else a._Box&&(a._Box.style.display="none");d={};d.HiddenByUser=c;a.doHide(d);c&&b.domManager.focusLastActiveElement()};a.hideNow=function(){a._Box.removeEventListener("transitionend",a.hideNow,!1);a._Box.removeEventListener("webkitTransitionEnd",a.hideNow,!1);var b=a._Box.style;b.display="none";b.opacity="1";a._Visible=0;b.transition=b.msTransition=
b.mozTransition=b.WebkitTransition="";a.hkKey&&"undefined"!=typeof a.hkKey&&a.highlightKey(a.hkKey.firstChild,!1)};a.prepare=function(){if(b.initialized){if(!a.ready&&(a._Box=g._CreateElement("DIV"),document.body.appendChild(a._Box),g.linkStyleSheet(b.getStyleSheetPath("kmwosk.css")),g.attachDOMEvent(a._Box,"mousedown",function(){b.uiManager.setActivatingUI(!0)}),l.touchable)){var c=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();return!1};g.attachDOMEvent(a._Box,"touchstart",function(a){b.uiManager.setActivatingUI(!0);
return c(a)});g.attachDOMEvent(a._Box,"touchend",c);g.attachDOMEvent(a._Box,"touchmove",c);g.attachDOMEvent(a._Box,"touchcancel",c);a.vpScale=g.getViewportScale()}a.loadCookie();a.ready=!0}else window.setTimeout(a.prepare,200)};a._Load=function(){var c=b.keyboardManager.activeKeyboard;if(null==a._Box)99<=a.loadRetry||(window.setTimeout(a._Load,100),a.loadRetry++);else{a.loadRetry=0;b._TitleElement&&(b._TitleElement.innerHTML="KeymanWeb");a._Visible=0;a.layerId="default";var d=a._Box.style;d.zIndex=
"9999";d.display="none";d.width="auto";d.position="desktop"==l.formFactor?"absolute":"fixed";if(l.touchable){var e=1;if("phone"==l.formFactor)e=1.92*(b.isEmbedded?.65:.6);else{var f=1;"Android"==l.OS&&"devicePixelRatio"in window&&(f=window.devicePixelRatio);e="Android"==l.OS&&"tablet"==l.formFactor&&parseInt(a.getHeight(),10)<300*f?1.2*e:2*e}d.fontSize=e+"em"}a._DivVKbd=a._DivVKbdHelp=null;a._Box.innerHTML="";a._Box.onmouseover=a._VKbdMouseOver;a._Box.onmouseout=a._VKbdMouseOut;if(null!=c||l.touchable){e=
null;f=null;d="";a._Box.className="";if(null!=c){e=c.KV;d=c.KH;var k=c.KVKL;"undefined"!=typeof k&&null!=k&&(f=k[l.formFactor],"undefined"==typeof f||null==f)&&("phone"==l.formFactor?f=k.tablet:"tablet"==l.formFactor&&(f=k.phone),"undefined"==typeof f||null==f)&&(f=k.desktop)}if(null!=e&&null!=e.BK){k=e.BK;for(var C=!0,n=0;n<k.length;n++)if(0<k[n].length){C=!1;break}C&&(e=null)}null!=e||""==d||l.touchable?(null==e&&(e={F:"Tahoma",BK:h.dfltText}),a._GenerateVisualKeyboard(e,d,f,b.keyboardManager.getKeyboardModifierBitmask())):
(a.ddOSK=!1,e=g._CreateElement("DIV"),e.className="kmw-title-bar",e.appendChild(a._TitleBarInterior()),e.onmousedown=a._VMoveMouseDown,a._Box.appendChild(e),e=g._CreateElement("DIV"),e.className="kmw-osk-static",e.innerHTML=d,a._Box.appendChild(e),c.KHF&&c.KHF(a._Box));b._TitleElement&&(b._TitleElement.innerHTML="<span style='font-weight:bold'>"+c.KN+"</span> - "+b._TitleElement.innerHTML,b._TitleElement.className="",b._TitleElement.style.color="#fff")}else e=g._CreateElement("DIV"),e.className="kmw-title-bar",
e.appendChild(a._TitleBarInterior()),e.onmousedown=a._VMoveMouseDown,a._Box.appendChild(e),e=g._CreateElement("DIV"),e.className="kmw-osk-none",a._Box.appendChild(e);a.createKeyTip();d=a._Box.firstChild;c=" kmw-keyboard-"+(c?c.KI.replace("Keyboard_",""):"");"keymanweb_title_bar"==d.id&&(d=d.nextSibling);d.className="kmw-osk-inner-frame"+c;a.appendStyleSheet();a._Enabled&&a._Show()}};a.appendStyleSheet=function(){var c=b.keyboardManager.activeKeyboard,d=b.keyboardManager.activeStub;if(null!=d){a.styleSheet&&
g.removeStyleSheet(a.styleSheet);var e=d.KFont;d=d.KOskFont;g.addFontFaceStyleSheet(e);g.addFontFaceStyleSheet(d);b.hideInputs();var f=a.addFontStyle(e,d);null!=c&&"string"==typeof c.KCSS&&(f+=c.KCSS);a.styleSheet=g.addStyleSheet(f);a.waitForFonts(e,d)&&b.alignInputs()}};a.addFontStyle=function(a,d){var c=b.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(c=a.family);c=c.replace(/\u0022/g,"");var f=new RegExp("\\s?"+c+",?"),g=b.appliedFont.replace(/\u0022/g,"");g=g.replace(f,"");g=g.replace(/,$/,
"");g='"'+(""==g?c:c+","+g).replace(/,\s?/g,'","')+'"';c=".keymanweb-font{\nfont-family:"+g+" !important;\n}\n";"undefined"!=typeof d?c=c+'.kmw-key-text{\nfont-family:"'+d.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n':"undefined"!=typeof a&&(c=c+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');b.appliedFont=g;return c};a._Unload=function(){a._VShift=a._DivVKbd=a._VKeySpans=a._Box=0};a.saveCookie=function(){var b=g.loadCookie("KeymanWeb_OnScreenKeyboard"),
d=a.getPos();b.visible=a._Enabled?1:0;b.userSet=a.userPositioned?1:0;b.left=d.left;b.top=d.top;a._DivVKbd&&(b.width=a.width,b.height=a.height);g.saveCookie("KeymanWeb_OnScreenKeyboard",b)};a.loadCookie=function(){var b=g.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return a.userPositioned=!1;a._Enabled=g.toNumber(b.visible,!0);a.userPositioned=g.toNumber(b.userSet,!1);a.x=g.toNumber(b.left,-1);a.y=g.toNumber(b.top,-1);var d=g.toNumber(b.width,.3*screen.width);b=g.toNumber(b.height,
.15*screen.height);d<.2*screen.width&&(d=.2*screen.width);b<.1*screen.height&&(b=.1*screen.height);d>.9*screen.width&&(d=.9*screen.width);b>.5*screen.height&&(b=.5*screen.height);a._DivVKbd&&(a._DivVKbd.style.width=d+"px",a._DivVKbd.style.height=b+"px",a._DivVKbd.style.fontSize=b/8+"px");-1!=a.x&&-1!=a.y&&a._Box||(a.userPositioned=!1);a.x<window.pageXOffset-.8*d&&(a.x=window.pageXOffset-.8*d);0>a.y&&(a.x=-1,a.y=-1,a.userPositioned=!1);a.userPositioned&&a._Box&&a.setPos({left:a.x,top:a.y});return!0};
a.getWidthFromCookie=function(){var a=g.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof a||null==a)return.3*screen.width;a=g.toNumber(a.width,.3*screen.width);a<.2*screen.width?a=.2*screen.width:a>.9*screen.width&&(a=.9*screen.width);return a};a.getFontSizeFromCookie=function(){var a=g.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof a||null==a)return 16;a=g.toNumber(a.height,.15*screen.height);a>.5*screen.height&&(a=.5*screen.height);return a/8}}();
(function(b){(function(a){var b=function(){function a(){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight}a.prototype.equals=function(a){return this.innerWidth==a.innerWidth&&this.innerHeight==a.innerHeight};return a}(),l=function(){function a(b){this.idlePermutationCounter=a.IDLE_PERMUTATION_CAP;this.keyman=b}a.prototype.resolve=function(){this.keyman.alignInputs();var a=this.keyman.osk;a._Load();this.oskVisible&&a._Show();this.isActive=!1;this.updateTimer&&(window.clearInterval(this.updateTimer),
this.rotState=null)};a.prototype.initNewRotation=function(){this.oskVisible=this.keyman.osk.isVisible();this.keyman.osk.hideNow();this.isActive=!0};a.prototype.init=function(){if(!this.keyman.isEmbedded){var a=this.keyman.util.device.OS,b=this.keyman.util,c=this;"iOS"==a?(b.attachDOMEvent(window,"orientationchange",function(){c.iOSEventHandler();return!1}),b.attachDOMEvent(window,"resize",function(){c.iOSEventHandler();return!1})):"Android"==a&&("onmozorientationchange"in screen?b.attachDOMEvent(screen,
"mozorientationchange",function(){c.initNewRotation();return!1}):b.attachDOMEvent(window,"orientationchange",function(){c.initNewRotation();return!1}),b.attachDOMEvent(window,"resize",function(){c.resolve();return!1}))}};a.prototype.iOSEventHandler=function(){this.isActive||(this.initNewRotation(),this.rotState=new b,this.updateTimer=window.setInterval(this.iOSEventUpdate.bind(this),a.UPDATE_INTERVAL));this.idlePermutationCounter=0};a.prototype.iOSEventUpdate=function(){var f=new b;this.rotState.equals(f)?
++this.idlePermutationCounter==a.IDLE_PERMUTATION_CAP&&this.resolve():(this.rotState=f,this.idlePermutationCounter=0)};a.IDLE_PERMUTATION_CAP=15;a.UPDATE_INTERVAL=20;return a}();a.RotationManager=l})(b.keyman||(b.keyman={}))})(com||(com={}));
window.keyman.initialized||function(){var b=window.keyman,a=b.osk,g=b.util,l=g.device;b.isEmbedded=!1;b.setDefaultDeviceOptions=function(a){""==a.attachType&&(a.attachType=l.touchable?"manual":"auto")};g.wait=function(a){var f=this.waiting;if("undefined"!=typeof f&&null!=f&&!b.warned){var g=f.firstChild.childNodes;a?(f.pending=!0,window.setTimeout(function(){f.pending&&(window.scrollTo(0,0),g[0].style.display="none",g[1].className="kmw-wait-text",g[1].innerHTML=a,g[2].style.display="block",f.style.display=
"block")},1E3)):f.pending&&(g[1].innerHTML="",f.pending=!1,f.style.display="none")}};b.getStyleSheetPath=function(a){return g.getOption("resources")+"osk/"+a};b.getKeyboardPath=function(a){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(a)?"":b.options.keyboards)+a};b.KC_=function(a,f,g){var c,d="",e=g.body?g:g.ownerDocument;if(l.touchable)d=b.touchAliasing.getTextBeforeCaret(g);else if(e&&(c=e.defaultView)&&c.getSelection&&("on"==e.designMode.toLowerCase()||"true"==g.contentEditable||"plaintext-only"==
g.contentEditable||""===g.contentEditable))g=c.getSelection(),3==g.focusNode.nodeType&&(d=g.focusNode.substringData(0,g.focusOffset));else if(g.setSelectionRange){if(g._KeymanWebSelectionStart)d=g._KeymanWebSelectionStart;else{if(null===b._CachedSelectionStart||g.selectionStart!==b._LastCachedSelection)b._LastCachedSelection=g.selectionStart,b._CachedSelectionStart=g.value._kmwCodeUnitToCodePoint(g.selectionStart),b._CachedSelectionEnd=g.value._kmwCodeUnitToCodePoint(g.selectionEnd);d=b._CachedSelectionStart}d=
g.value._kmwSubstr(0,d)}d._kmwLength()<a&&(d=Array(a-d._kmwLength()+1).join("\ufffe")+d);return d._kmwSubstr(-a)._kmwSubstr(0,f)};b.alignInputs=function(a){if(l.touchable){var f=b.domManager,g=[];a?a.forEach(function(a){a.base?g.push(a):a.kmw_ip&&g.push(a.kmw_ip)}):g=f.inputList;g.forEach(function(a){f.touchHandlers.updateInput(a);a.style.visibility="visible";0<a.base.textContent.length&&(a.base.style.visibility="hidden")})}};b.hideInputs=function(){var a=b.domManager;if(l.touchable)for(var f=0;f<
a.inputList.length;f++)a.inputList[f].style.visibility="hidden",a.inputList[f].base.style.visibility="visible"};b.isPositionSynthesized=function(){return l.touchable};a.highlightSubKeys=function(b,f,k){if(null!=b&&null!=b.subKeys){var c,d=document.getElementById("kmw-popup-keys");5<a.touchY-k&&null==d&&(a.subkeyDelayTimer&&window.clearTimeout(a.subkeyDelayTimer),a.showSubKeys(b),d=document.getElementById("kmw-popup-keys"));for(c=0;c<b.subKeys.length;c++)try{var e=d.childNodes[c].firstChild;var h=
g._GetAbsoluteX(e);var l=g._GetAbsoluteY(e);var C=h+e.offsetWidth;var n=l+e.offsetHeight;var p=f>h&&f<C&&k>l&&k<n;a.highlightKey(e,p);p&&a.highlightKey(b,!1)}catch(y){}}};a.optionKey=function(g,f,k){k&&(0<=f.indexOf("K_LOPT")?a.showLanguageMenu():0<=f.indexOf("K_ROPT")&&(b.uiManager.setActivatingUI(!1),a._Hide(!0),b.touchAliasing.hideCaret(),b.domManager.clearLastActiveElement()))};a.createKeyTip=function(){"phone"==l.formFactor&&(null==a.keytip&&(a.keytip=g._CreateElement("div"),a.keytip.className=
"kmw-keytip",a.keytip.id="kmw-keytip",a.keytip.style.pointerEvents="none",a.keytip.appendChild(g._CreateElement("canvas")),a.keytip.appendChild(g._CreateElement("span")),a.keytip.key=null,a.keytip.state=!1),a._Box.appendChild(a.keytip))};a.showKeyTip=function(b,f){var h=a.keytip;if(null!=h&&(b!=h.key||f!=h.state)){var c=document.getElementById("kmw-popup-keys");c=c&&"visible"==c.style.visibility;if(f&&!c){var d=g._GetAbsoluteY(a._Box),e=a._Box.offsetHeight;c=g._GetAbsoluteX(b);for(var l=g._GetAbsoluteY(b),
u=b.offsetWidth,C=b.offsetHeight,n=b.firstChild,p=h.style,y=h.childNodes[1],m=y.style,r=0,x=h.firstChild,v=0;v<b.childNodes.length&&(n=b.childNodes[v],!a.hasClass(n,"kmw-key-text"));v++);x.width=1.6*u;x.height=2.3*C;p.top="auto";p.bottom=d+e-l-C+"px";p.textAlign="center";p.overflow="visible";p.fontFamily=g.getStyleValue(n,"font-family");p.width=x.width+"px";p.height=x.height+"px";d=g.getStyleInt(n,"font-size");0!=d&&(d*=1.8,p.fontSize=d+"px",e=com.keyman.OSKKey.getTextWidth(y.textContent,p),e=.9*
x.width/e,1>e&&(p.fontSize=d*e+"px"));y.textContent=n.textContent;m.display="block";m.position="absolute";m.textAlign="center";m.width="100%";m.top="2%";m.bottom="auto";n=(x.width-u)/2;c<n?(r=-1,c+=n):c>window.innerWidth-u-n&&(r=1,c-=n);a.drawPreview(x,u,C,r);p.left=c-n+"px";p.display="block"}else h.style.display="none";h.key=b;h.state=f}};a.drawPreview=function(a,b,g,c){g=a.getContext("2d");var d=(a.width-b)/2,e=a.height,f=d,h=b+d;b+=2*d;var k=.5*e,n=.6*e,p=8;"Android"==l.OS&&(p=3);switch(c){case -1:f-=
d;h-=d;break;case 1:f+=d,h+=d}g.clearRect(0,0,a.width,a.height);"Android"==l.OS?(f=h=(f+h)/2,g.fillStyle="#999"):g.fillStyle="#ffffff";g.lineWidth="1";g.strokeStyle="#cccccc";g.save();g.beginPath();g.moveTo(0+p,0);g.arcTo(b,0,b,p,p);"Android"==l.OS?(g.arcTo(b,k,h,n,p),g.arcTo(h,n,f,n,p)):(g.arcTo(b,k,h,n,p),g.arcTo(h,n,h-p,e,p),g.arcTo(h,e,f,e,p),g.arcTo(f,e,f,n-p,p));g.arcTo(f,n,0,k-p,p);g.arcTo(0,k,0,p,p);g.arcTo(0,0,0+p,0,p);g.fill();g.stroke();g.restore()};a.addCallout=function(b){if("phone"!=
l.formFactor||"iOS"!=l.OS)return null;var f=g._CreateElement("div"),h=f.style;f.id="kmw-popup-callout";a._Box.appendChild(f);var c=b.offsetLeft,d=b.offsetWidth,e=b.offsetHeight;h.top=b.offsetTop-6+"px";h.left=c+"px";h.width=d+"px";h.height=e+6+"px";return f};a.touchHold=function(b){a.subkeyDelayTimer&&(window.clearTimeout(a.subkeyDelayTimer),a.subkeyDelayTimer=null);"undefined"!=typeof b.subKeys&&null!=b.subKeys&&(a.subkeyDelayTimer=window.setTimeout(function(){a.clearPopup();a.showSubKeys(b)},a.popupDelay))};
b.handleRotationEvents=function(){(new com.keyman.RotationManager(b)).init()};a.waitForFonts=function(a,f){if("undefined"==typeof a&&"undefined"==typeof f||"undefined"==typeof a.files&&"undefined"==typeof f.files)return!0;var h=g.checkFontDescriptor(a),c=g.checkFontDescriptor(f);if(h&&c)return!0;b.fontCheckTimer=window.setInterval(function(){g.checkFontDescriptor(a)&&g.checkFontDescriptor(f)&&(window.clearInterval(b.fontCheckTimer),b.fontCheckTimer=null,b.alignInputs())},100);window.setTimeout(function(){b.fontCheckTimer&&
(window.clearInterval(b.fontCheckTimer),b.fontCheckTimer=null,b.alignInputs())},5E3);return!1}}();(function(){var b=window.keyman,a=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(a),b.init(null))},10)})();var CLOSURE_NO_DEPS=!0,COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(b){return void 0!==b};goog.isString=function(b){return"string"==typeof b};goog.isBoolean=function(b){return"boolean"==typeof b};goog.isNumber=function(b){return"number"==typeof b};
goog.exportPath_=function(b,a,g){b=b.split(".");g=g||goog.global;b[0]in g||!g.execScript||g.execScript("var "+b[0]);for(var l;b.length&&(l=b.shift());)!b.length&&goog.isDef(a)?g[l]=a:g=g[l]&&g[l]!==Object.prototype[l]?g[l]:g[l]={}};
goog.define=function(b,a){COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&void 0===goog.global.CLOSURE_UNCOMPILED_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,b)?a=goog.global.CLOSURE_UNCOMPILED_DEFINES[b]:goog.global.CLOSURE_DEFINES&&void 0===goog.global.CLOSURE_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,b)&&(a=goog.global.CLOSURE_DEFINES[b]));goog.exportPath_(b,a)};goog.DEBUG=!0;goog.LOCALE="en";
goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(b){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');goog.constructNamespace_(b)};
goog.constructNamespace_=function(b,a){if(!COMPILED){delete goog.implicitNamespaces_[b];for(var g=b;(g=g.substring(0,g.lastIndexOf(".")))&&!goog.getObjectByName(g);)goog.implicitNamespaces_[g]=!0}goog.exportPath_(b,a)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(b){if(!goog.isString(b)||!b||-1==b.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+b+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");
goog.moduleLoaderState_.moduleName=b;if(!COMPILED){if(goog.isProvided_(b))throw Error('Namespace "'+b+'" already declared.');delete goog.implicitNamespaces_[b]}};goog.module.get=function(b){return goog.module.getInternal_(b)};goog.module.getInternal_=function(b){if(!COMPILED){if(b in goog.loadedModules_)return goog.loadedModules_[b];if(!goog.implicitNamespaces_[b])return b=goog.getObjectByName(b),null!=b?b:null}return null};goog.moduleLoaderState_=null;
goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(b){if(goog.DISALLOW_TEST_ONLY_CODE)throw b=b||"",Error("Importing test-only code into non-debug environment"+(b?": "+b:"."));};goog.forwardDeclare=function(b){};COMPILED||(goog.isProvided_=function(b){return b in goog.loadedModules_||!goog.implicitNamespaces_[b]&&goog.isDefAndNotNull(goog.getObjectByName(b))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(b,a){b=b.split(".");a=a||goog.global;for(var g=0;g<b.length;g++)if(a=a[b[g]],!goog.isDefAndNotNull(a))return null;return a};goog.globalize=function(b,a){a=a||goog.global;for(var g in b)a[g]=b[g]};goog.addDependency=function(b,a,g,l){if(goog.DEPENDENCIES_ENABLED){var h=goog.getLoader_();h&&h.addDependency(b,a,g,l)}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(b){goog.global.console&&goog.global.console.error(b)};
goog.require=function(b){goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_&&goog.getLoader_().earlyProcessLoad(b);if(!COMPILED){if(goog.isProvided_(b)){if(goog.isInModuleLoader_())return goog.module.getInternal_(b)}else if(goog.ENABLE_DEBUG_LOADER){var a=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{var g=goog.getLoader_();g?g.load(b):goog.logToConsole_("Could not load "+b+" because there is no debug loader.")}finally{goog.moduleLoaderState_=a}}return null}};goog.basePath="";
goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(b){b.instance_=void 0;b.getInstance=function(){if(b.instance_)return b.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=b);return b.instance_=new b}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.TRANSPILE="detect";goog.TRANSPILER="transpile.js";goog.DEBUG_LOADER="";goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var b=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(a){b=!1}goog.hasBadLetScoping=b}return goog.hasBadLetScoping};goog.workaroundSafari10EvalBug=function(b){return"(function(){"+b+"\n;})();\n"};
goog.loadModule=function(b){var a=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};if(goog.isFunction(b))var g=b.call(void 0,{});else if(goog.isString(b))goog.useSafari10Workaround()&&(b=goog.workaroundSafari10EvalBug(b)),g=goog.loadModuleFromSource_.call(void 0,b);else throw Error("Invalid module definition");var l=goog.moduleLoaderState_.moduleName;if(!goog.isString(l)||!l)throw Error('Invalid module name "'+l+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(l,g):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof g&&null!=g&&Object.seal(g);goog.loadedModules_[l]=g}finally{goog.moduleLoaderState_=a}};goog.loadModuleFromSource_=function(b){eval(b);return{}};goog.normalizePath_=function(b){b=b.split("/");for(var a=0;a<b.length;)"."==b[a]?b.splice(a,1):a&&".."==b[a]&&b[a-1]&&".."!=b[a-1]?b.splice(--a,2):a++;return b.join("/")};
goog.loadFileSync_=function(b){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(b);try{var a=new goog.global.XMLHttpRequest;a.open("get",b,!1);a.send();return 0==a.status||200==a.status?a.responseText:null}catch(g){return null}};
goog.transpile_=function(b,a){var g=goog.global.$jscomp;g||(goog.global.$jscomp=g={});var l=g.transpile;if(!l){var h=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(h);if(f){(function(){eval(f+"\n//# sourceURL="+h)}).call(goog.global);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile;
g=goog.global.$jscomp;l=g.transpile}}l||(l=g.transpile=function(a,b){goog.logToConsole_(b+" requires transpilation but no transpiler was found.");return a});return l(b,a)};
goog.typeOf=function(b){var a=typeof b;if("object"==a)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return a;var g=Object.prototype.toString.call(b);if("[object Window]"==g)return"object";if("[object Array]"==g||"number"==typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==g||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==a&&"undefined"==typeof b.call)return"object";return a};goog.isNull=function(b){return null===b};goog.isDefAndNotNull=function(b){return null!=b};goog.isArray=function(b){return"array"==goog.typeOf(b)};goog.isArrayLike=function(b){var a=goog.typeOf(b);return"array"==a||"object"==a&&"number"==typeof b.length};goog.isDateLike=function(b){return goog.isObject(b)&&"function"==typeof b.getFullYear};goog.isFunction=function(b){return"function"==goog.typeOf(b)};
goog.isObject=function(b){var a=typeof b;return"object"==a&&null!=b||"function"==a};goog.getUid=function(b){return b[goog.UID_PROPERTY_]||(b[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(b){return!!b[goog.UID_PROPERTY_]};goog.removeUid=function(b){null!==b&&"removeAttribute"in b&&b.removeAttribute(goog.UID_PROPERTY_);try{delete b[goog.UID_PROPERTY_]}catch(a){}};goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;
goog.removeHashCode=goog.removeUid;goog.cloneObject=function(b){var a=goog.typeOf(b);if("object"==a||"array"==a){if(b.clone)return b.clone();a="array"==a?[]:{};for(var g in b)a[g]=goog.cloneObject(b[g]);return a}return b};goog.bindNative_=function(b,a,g){return b.call.apply(b.bind,arguments)};
goog.bindJs_=function(b,a,g){if(!b)throw Error();if(2<arguments.length){var l=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(g,l);return b.apply(a,g)}}return function(){return b.apply(a,arguments)}};goog.bind=function(b,a,g){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(b,a){var g=Array.prototype.slice.call(arguments,1);return function(){var a=g.slice();a.push.apply(a,arguments);return b.apply(this,a)}};goog.mixin=function(b,a){for(var g in a)b[g]=a[g]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(b){if(goog.global.execScript)goog.global.execScript(b,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(l){}if("undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(l){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(b);else{var a=goog.global.document,g=a.createElement("SCRIPT");g.type="text/javascript";g.defer=
!1;g.appendChild(a.createTextNode(b));a.head.appendChild(g);a.head.removeChild(g)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;
goog.getCssName=function(b,a){if("."==String(b).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+b);var g=function(a){return goog.cssNameMapping_[a]||a},l=function(a){a=a.split("-");for(var b=[],h=0;h<a.length;h++)b.push(g(a[h]));return b.join("-")};l=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?g:l:function(a){return a};b=a?b+"-"+l(a):l(b);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(b):b};
goog.setCssNameMapping=function(b,a){goog.cssNameMapping_=b;goog.cssNameMappingStyle_=a};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(b,a){a&&(b=b.replace(/\{\$([^}]+)}/g,function(b,l){return null!=a&&l in a?a[l]:b}));return b};goog.getMsgWithFallback=function(b,a){return b};goog.exportSymbol=function(b,a,g){goog.exportPath_(b,a,g)};goog.exportProperty=function(b,a,g){b[a]=g};
goog.inherits=function(b,a){function g(){}g.prototype=a.prototype;b.superClass_=a.prototype;b.prototype=new g;b.prototype.constructor=b;b.base=function(b,g,f){for(var h=Array(arguments.length-2),c=2;c<arguments.length;c++)h[c-2]=arguments[c];return a.prototype[g].apply(b,h)}};
goog.base=function(b,a,g){var l=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!l)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(l.superClass_){for(var h=Array(arguments.length-1),f=1;f<arguments.length;f++)h[f-1]=arguments[f];return l.superClass_.constructor.apply(b,h)}h=Array(arguments.length-2);for(f=2;f<arguments.length;f++)h[f-2]=arguments[f];f=!1;for(var k=b.constructor;k;k=
k.superClass_&&k.superClass_.constructor)if(k.prototype[a]===l)f=!0;else if(f)return k.prototype[a].apply(b,h);if(b[a]===l)return b.constructor.prototype[a].apply(b,h);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(b){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");b.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(b,a){var g=a.constructor,l=a.statics;g&&g!=Object.prototype.constructor||(g=function(){throw Error("cannot instantiate an interface (no constructor defined).");});g=goog.defineClass.createSealingConstructor_(g,b);b&&goog.inherits(g,b);delete a.constructor;delete a.statics;goog.defineClass.applyProperties_(g.prototype,a);null!=l&&(l instanceof Function?l(g):goog.defineClass.applyProperties_(g,l));return g};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(b,a){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return b;var g=!goog.defineClass.isUnsealable_(a),l=function(){var a=b.apply(this,arguments)||this;a[goog.UID_PROPERTY_]=a[goog.UID_PROPERTY_];this.constructor===l&&g&&Object.seal instanceof Function&&Object.seal(a);return a};return l};goog.defineClass.isUnsealable_=function(b){return b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(b,a){for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(b[g]=a[g]);for(var l=0;l<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;l++)g=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[l],Object.prototype.hasOwnProperty.call(a,g)&&(b[g]=a[g])};goog.tagUnsealableClass=function(b){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var b=goog.global.document;return null!=b&&"write"in b},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var b=goog.global.document,a=b.currentScript;b=a?[a]:b.getElementsByTagName("SCRIPT");for(a=b.length-1;0<=a;--a){var g=b[a].src,l=g.lastIndexOf("?");l=-1==l?g.length:l;if("base.js"==g.substr(l-
7,7)){goog.basePath=g.substr(0,l-7);break}}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function b(a,b){l?g[a]=!0:b()?g[a]=!1:l=g[a]=!0}function a(a){try{return!!eval(a)}catch(k){return!1}}var g={es3:!1},l=!1,h=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";b("es5",function(){return a("[1,].length==1")});b("es6",function(){var b=h.match(/Edge\/(\d+)(\.\d)*/i);
return b&&15>Number(b[1])?!1:a('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')});b("es6-impl",function(){return!0});b("es7",function(){return a("2 ** 2 == 4")});b("es8",function(){return a("async () => 1, true")});return g},goog.Transpiler.prototype.needsTranspile=
function(b){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;this.requiresTranspilation_||(this.requiresTranspilation_=this.createRequiresTranspilation_());if(b in this.requiresTranspilation_)return this.requiresTranspilation_[b];throw Error("Unknown language mode: "+b);},goog.Transpiler.prototype.transpile=function(b,a){return goog.transpile_(b,a)},goog.transpiler_=new goog.Transpiler,goog.DebugLoader=function(){this.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},
written:{},deferred:{}};this.oldIeWaiting_=!1;this.queuedModules_=[];this.lastNonModuleScriptIndex_=0},goog.DebugLoader.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader.prototype.earlyProcessLoad=function(b){goog.DebugLoader.IS_OLD_IE_&&this.maybeProcessDeferredDep_(b)},goog.DebugLoader.prototype.load=function(b){var a=this.getPathFromDeps_(b);if(a){var g=function(a){if(!(a in f.written||a in f.visited)){f.visited[a]=!0;if(a in f.requires)for(var b in f.requires[a])if(!k.isProvided(b))if(b in
f.nameToPath)g(f.nameToPath[b]);else throw Error("Undefined nameToPath for "+b);a in h||(h[a]=!0,l.push(a))}},l=[],h={},f=this.dependencies_,k=this;g(a);for(b=0;b<l.length;b++)a=l[b],this.dependencies_.written[a]=!0;for(b=0;b<l.length;b++)if(a=l[b]){var c=f.loadFlags[a]||{},d=c.lang||"es3";d=this.getTranspiler().needsTranspile(d);"goog"==c.module||d?this.importProcessedScript_(goog.basePath+a,"goog"==c.module,d):this.importScript_(goog.basePath+a)}else throw Error("Undefined script input");}else throw b=
"goog.require could not find: "+b,this.logToConsole(b),Error(b);},goog.DebugLoader.prototype.addDependency=function(b,a,g,l){var h;b=b.replace(/\\/g,"/");var f=this.dependencies_;l&&"boolean"!==typeof l||(l=l?{module:"goog"}:{});for(var k=0;h=a[k];k++)f.nameToPath[h]=b,f.loadFlags[b]=l;for(l=0;a=g[l];l++)b in f.requires||(f.requires[b]={}),f.requires[b][a]=!0},goog.DebugLoader.prototype.importScript_=function(b,a){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this))(b,a)&&(this.dependencies_.written[b]=
!0)},goog.DebugLoader.prototype.importProcessedScript_=function(b,a,g){this.importScript_("",'goog.debugLoader_.retrieveAndExec_("'+b+'", '+a+", "+g+");")},goog.DebugLoader.prototype.retrieveAndExec_=function(b,a,g){if(!COMPILED){var l=b;b=this.normalizePath(b);var h=goog.global.CLOSURE_IMPORT_SCRIPT||goog.bind(this.writeScriptTag_,this),f=this.loadFileSync(b);if(null==f)throw Error('Load of "'+b+'" failed');g&&(f=this.getTranspiler().transpile(f,b));f=a?this.wrapModule_(b,f):f+("\n//# sourceURL="+
b);goog.DebugLoader.IS_OLD_IE_&&this.oldIeWaiting_?(this.dependencies_.deferred[l]=f,this.queuedModules_.push(l)):h(b,f)}},goog.DebugLoader.prototype.wrapModule_=function(b,a){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(a+"\n//# sourceURL="+b+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+a+"\n;return exports});\n//# sourceURL="+b+"\n"},goog.DebugLoader.prototype.loadQueuedModules_=function(){var b=this.queuedModules_.length;
if(0<b){var a=this.queuedModules_;this.queuedModules_=[];for(var g=0;g<b;g++)this.maybeProcessDeferredPath_(a[g])}this.oldIeWaiting_=!1},goog.DebugLoader.prototype.maybeProcessDeferredDep_=function(b){this.isDeferredModule_(b)&&this.allDepsAreAvailable_(b)&&(b=this.getPathFromDeps_(b),this.maybeProcessDeferredPath_(goog.basePath+b))},goog.DebugLoader.prototype.isDeferredModule_=function(b){var a=(b=this.getPathFromDeps_(b))&&this.dependencies_.loadFlags[b]||{},g=a.lang||"es3";return b&&("goog"==a.module||
this.getTranspiler().needsTranspile(g))?goog.basePath+b in this.dependencies_.deferred:!1},goog.DebugLoader.prototype.allDepsAreAvailable_=function(b){if((b=this.getPathFromDeps_(b))&&b in this.dependencies_.requires)for(var a in this.dependencies_.requires[b])if(!this.isProvided(a)&&!this.isDeferredModule_(a))return!1;return!0},goog.DebugLoader.prototype.maybeProcessDeferredPath_=function(b){if(b in this.dependencies_.deferred){var a=this.dependencies_.deferred[b];delete this.dependencies_.deferred[b];
goog.globalEval(a)}},goog.DebugLoader.prototype.writeScriptSrcNode_=function(b){goog.global.document.write('<script type="text/javascript" src="'+b+'">\x3c/script>')},goog.DebugLoader.prototype.appendScriptSrcNode_=function(b){var a=goog.global.document,g=a.createElement("script");g.type="text/javascript";g.src=b;g.defer=!1;g.async=!1;a.head.appendChild(g)},goog.DebugLoader.prototype.writeScriptTag_=function(b,a){if(this.inHtmlDocument()){var g=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&
"complete"==g.readyState){if(/\bdeps.js$/.test(b))return!1;throw Error('Cannot write "'+b+'" after document load');}void 0===a?goog.DebugLoader.IS_OLD_IE_?(this.oldIeWaiting_=!0,a=" onreadystatechange='goog.debugLoader_.onScriptLoad_(this, "+ ++this.lastNonModuleScriptIndex_+")' ",g.write('<script type="text/javascript" src="'+b+'"'+a+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?this.appendScriptSrcNode_(b):this.writeScriptSrcNode_(b):g.write('<script type="text/javascript">'+this.protectScriptTag_(a)+
"\x3c/script>");return!0}return!1},goog.DebugLoader.prototype.protectScriptTag_=function(b){return b.replace(/<\/(SCRIPT)/ig,"\\x3c/$1")},goog.DebugLoader.prototype.onScriptLoad_=function(b,a){"complete"==b.readyState&&this.lastNonModuleScriptIndex_==a&&this.loadQueuedModules_();return!0},goog.DebugLoader.prototype.getPathFromDeps_=function(b){return b in this.dependencies_.nameToPath?this.dependencies_.nameToPath[b]:null},goog.DebugLoader.prototype.getTranspiler=function(){return goog.transpiler_},
goog.DebugLoader.prototype.isProvided=function(b){return goog.isProvided_(b)},goog.DebugLoader.prototype.inHtmlDocument=function(){return goog.inHtmlDocument_()},goog.DebugLoader.prototype.logToConsole=function(b){goog.logToConsole_(b)},goog.DebugLoader.prototype.loadFileSync=function(b){return goog.loadFileSync_(b)},goog.DebugLoader.prototype.normalizePath=function(b){return goog.normalizePath_(b)},goog.debugLoader_=null,goog.registerDebugLoader=function(b){if(goog.debugLoader_)throw Error("Debug loader already registered!");
if(!(b instanceof goog.DebugLoader))throw Error("Not a goog.DebugLoader.");goog.debugLoader_=b},goog.getLoader_=function(){if(!goog.debugLoader_&&goog.DEBUG_LOADER)throw Error("Loaded debug loader file but no loader was registered!");goog.debugLoader_||(goog.debugLoader_=new goog.DebugLoader);return goog.debugLoader_},function(){if(goog.DEBUG_LOADER){var b=new goog.DebugLoader;b.importScript_(goog.basePath+goog.DEBUG_LOADER)}goog.global.CLOSURE_NO_DEPS||(b=b||new goog.DebugLoader,goog.DEBUG_LOADER||
goog.registerDebugLoader(b),b.importScript_(goog.basePath+"deps.js"))}());goog.exportSymbol("com.keyman.Util.prototype.attachDOMEvent",com.keyman.Util.prototype.attachDOMEvent);goog.exportSymbol("com.keyman.Util.prototype.detachDOMEvent",com.keyman.Util.prototype.detachDOMEvent);goog.exportSymbol("com.keyman.Util.prototype.getOption",com.keyman.Util.prototype.getOption);goog.exportSymbol("com.keyman.Util.prototype.setOption",com.keyman.Util.prototype.setOption);
goog.exportSymbol("com.keyman.Util.prototype.getAbsoluteX",com.keyman.Util.prototype._GetAbsoluteX);goog.exportSymbol("com.keyman.Util.prototype.getAbsoluteY",com.keyman.Util.prototype._GetAbsoluteY);goog.exportSymbol("com.keyman.Util.prototype.getAbsolute",com.keyman.Util.prototype._GetAbsolute);goog.exportSymbol("com.keyman.Util.prototype.createElement",com.keyman.Util.prototype.createElement);goog.exportSymbol("com.keyman.Util.prototype.getIEVersion",com.keyman.Util.prototype.getIEVersion);
goog.exportSymbol("com.keyman.Util.prototype.isTouchDevice",com.keyman.Util.prototype.isTouchDevice);goog.exportSymbol("com.keyman.Util.prototype.createShim",com.keyman.Util.prototype.createShim);goog.exportSymbol("com.keyman.Util.prototype.showShim",com.keyman.Util.prototype.showShim);goog.exportSymbol("com.keyman.Util.prototype.hideShim",com.keyman.Util.prototype.hideShim);goog.exportSymbol("com.keyman.Util.prototype.rgba",com.keyman.Util.prototype.rgba);
goog.exportSymbol("com.keyman.Util.prototype.addStyleSheet",com.keyman.Util.prototype.addStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.removeStyleSheet",com.keyman.Util.prototype.removeStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.linkStyleSheet",com.keyman.Util.prototype.linkStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.addFontFaceStyleSheet",com.keyman.Util.prototype.addFontFaceStyleSheet);goog.exportSymbol("com.keyman.Util.prototype.loadCookie",com.keyman.Util.prototype.loadCookie);
goog.exportSymbol("com.keyman.Util.prototype.saveCookie",com.keyman.Util.prototype.saveCookie);goog.exportSymbol("com.keyman.Util.prototype.toNumber",com.keyman.Util.prototype.toNumber);goog.exportSymbol("com.keyman.Util.prototype.toFloat",com.keyman.Util.prototype.toFloat);goog.exportSymbol("com.keyman.Util.prototype.toNzString",com.keyman.Util.prototype.nzString);goog.exportSymbol("com.keyman.Util.prototype.alert",com.keyman.Util.prototype.alert);
(function(){var b=function(a,b,h){goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+b,h);goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+a,h)},a=function(a,b,h){goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+b,h);goog.exportSymbol("com.keyman.KeyboardInterface.prototype."+a,h)};b("KSF","saveFocus",com.keyman.KeyboardInterface.prototype.saveFocus);b("KBR","beepReset",com.keyman.KeyboardInterface.prototype.beepReset);a("KT","insertText",com.keyman.KeyboardInterface.prototype.insertText);
a("KR","registerKeyboard",com.keyman.KeyboardInterface.prototype.registerKeyboard);a("KRS","registerStub",com.keyman.KeyboardInterface.prototype.registerStub);a("KC","context",com.keyman.KeyboardInterface.prototype.context);a("KN","nul",com.keyman.KeyboardInterface.prototype.nul);a("KCM","contextMatch",com.keyman.KeyboardInterface.prototype.contextMatch);a("KFCM","fullContextMatch",com.keyman.KeyboardInterface.prototype.fullContextMatch);a("KIK","isKeypress",com.keyman.KeyboardInterface.prototype.isKeypress);
a("KKM","keyMatch",com.keyman.KeyboardInterface.prototype.keyMatch);a("KSM","stateMatch",com.keyman.KeyboardInterface.prototype.stateMatch);a("KKI","keyInformation",com.keyman.KeyboardInterface.prototype.keyInformation);a("KDM","deadkeyMatch",com.keyman.KeyboardInterface.prototype.deadkeyMatch);a("KB","beep",com.keyman.KeyboardInterface.prototype.beep);a("KA","any",com.keyman.KeyboardInterface.prototype.any);a("KDC","deleteContext",com.keyman.KeyboardInterface.prototype.deleteContext);a("KO","output",
com.keyman.KeyboardInterface.prototype.output);a("KDO","deadkeyOutput",com.keyman.KeyboardInterface.prototype.deadkeyOutput);a("KIO","indexOutput",com.keyman.KeyboardInterface.prototype.indexOutput);a("KIFS","ifStore",com.keyman.KeyboardInterface.prototype.ifStore);a("KSETS","setStore",com.keyman.KeyboardInterface.prototype.setStore);a("KLOAD","loadStore",com.keyman.KeyboardInterface.prototype.loadStore);a("KSAVE","saveStore",com.keyman.KeyboardInterface.prototype.saveStore)})();
//# sourceMappingURL=keymanweb.js.map
