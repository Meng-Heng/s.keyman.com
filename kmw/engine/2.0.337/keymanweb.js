/*
 KeymanWeb 2.0 (C) 2012 Tavultesoft Pty Ltd
*/
String.kmwFromCharCode=function(a){var b=[],c;for(c=0;c<arguments.length;c++){var d=Number(arguments[c]);if(!isFinite(d)||0>d||1114111<d||Math.floor(d)!==d)throw new RangeError("Invalid code point "+d);65536>d?b.push(d):(d-=65536,b.push((d>>10)+55296),b.push(d%1024+56320))}return String.fromCharCode.apply(void 0,b)};
String.prototype.kmwCharCodeAt=function(a){var b=""+this,c=0;if(0>a||a>=b.length)return NaN;for(var d=0;d<a;d++)if(c=b.kmwNextChar(c),null===c)return NaN;a=b.charCodeAt(c);return 55296<=a&&(56319>=a&&b.length>c+1)&&(b=b.charCodeAt(c+1),56320<=b&&57343>=b)?(a-55296<<10)+(b-56320)+65536:a};String.prototype.kmwIndexOf=function(a,b){var c=""+this,d=c.indexOf(a,b);if(0>d)return d;for(var e=0,f=0;null!==f&&f<d;f=c.kmwNextChar(f))e++;return e};
String.prototype.kmwLastIndexOf=function(a,b){var c=""+this,d=c.lastIndexOf(a,b);if(0>d)return d;for(var e=0,f=0;null!==f&&f<d;f=c.kmwNextChar(f))e++;return e};String.prototype.kmwLength=function(){var a=""+this;if(0==a.length)return 0;for(var b=0,c=0;null!==c;b++)c=a.kmwNextChar(c);return b};String.prototype.kmwSlice=function(a,b){var c=""+this,d=c.kmwCodePointToCodeUnit(a),e=c.kmwCodePointToCodeUnit(b);return null===d||null===e?"":c.slice(d,e)};
String.prototype.kmwSubstr=function(a,b){var c=""+this;0>a&&(a=c.kmwLength()+a);0>a&&(a=0);var d=c.kmwCodePointToCodeUnit(a),e=d;if(null===d)return"";if(2>arguments.length)e=c.length;else for(var f=0;f<b;f++)e=c.kmwNextChar(e);return null===e?c.substring(d):c.substring(d,e)};
String.prototype.kmwSubstring=function(a,b){var c=""+this,d,e;"undefined"==typeof b?(d=c.kmwCodePointToCodeUnit(a),e=c.length):(a>b&&(d=a,a=b,b=d),d=c.kmwCodePointToCodeUnit(a),e=c.kmwCodePointToCodeUnit(b));if(isNaN(d)||null===d)d=0;if(isNaN(e)||null===e)e=c.length;return c.substring(d,e)};
String.prototype.kmwNextChar=function(a){var b=""+this;if(null===a||0>a||a>=b.length-1)return null;var c=b.charCodeAt(a);return 55296<=c&&(56319>=c&&b.length>a+1)&&(c=b.charCodeAt(a+1),56320<=c&&57343>=c)?a==b.length-2?null:a+2:a+1};String.prototype.kmwPrevChar=function(a){var b=""+this;if(null==a||0>=a||a>b.length)return null;var c=b.charCodeAt(a-1);return 56320<=c&&(57343>=c&&1<a)&&(b=b.charCodeAt(a-2),55296<=b&&56319>=b)?a-2:a-1};
String.prototype.kmwCodePointToCodeUnit=function(a){if(null===a)return null;var b=""+this,c=0;if(0>a){for(var c=b.length,d=0;d>a;d--)c=b.kmwPrevChar(c);return c}if(a==b.kmwLength())return b.length;for(d=0;d<a;d++)c=b.kmwNextChar(c);return c};String.prototype.kmwCodeUnitToCodePoint=function(a){var b=""+this;return null===a?null:0==a?0:0>a?b.substr(a).kmwLength():b.substr(0,a).kmwLength()};String.prototype.kmwCharAt=function(a){return 0<=a?(""+this).kmwSubstr(a,1):""};
String.prototype.kmwBMPNextChar=function(a){return 0>a||a>=(""+this).length-1?void 0:a+1};String.prototype.kmwBMPPrevChar=function(a){return 0>=a||a>(""+this).length?void 0:a-1};String.prototype.kmwBMPCodePointToCodeUnit=function(a){return a};String.prototype.kmwBMPCodeUnitToCodePoint=function(a){return a};String.prototype.kmwBMPLength=function(){return(""+this).length};String.prototype.kmwBMPSubstr=function(a,b){var c=""+this;return-1<a?c.substr(a,b):c.substr(c.length+a,-a)};
String.kmwEnableSupplementaryPlane=function(a){var b=String.prototype;String._kmwFromCharCode=a?String.kmwFromCharCode:String.fromCharCode;b._kmwCharAt=a?b.kmwCharAt:b.charAt;b._kmwCharCodeAt=a?b.kmwCharCodeAt:b.charCodeAt;b._kmwIndexOf=a?b.kmwIndexOf:b.indexOf;b._kmwLastIndexOf=a?b.kmwLastIndexOf:b.lastIndexOf;b._kmwSlice=a?b.kmwSlice:b.slice;b._kmwSubstring=a?b.kmwSubstring:b.substring;b._kmwSubstr=a?b.kmwSubstr:b.kmwBMPSubstr;b._kmwLength=a?b.kmwLength:b.kmwBMPLength;b._kmwNextChar=a?b.kmwNextChar:
b.kmwBMPNextChar;b._kmwPrevChar=a?b.kmwPrevChar:b.kmwBMPPrevChar;b._kmwCodePointToCodeUnit=a?b.kmwCodePointToCodeUnit:b.kmwBMPCodePointToCodeUnit;b._kmwCodeUnitToCodePoint=a?b.kmwCodeUnitToCodePoint:b.kmwBMPCodeUnitToCodePoint};
/*
 KeymanWeb 2.0 Copyright 2010 Tavultesoft Pty Ltd
*/
var __BUILD__=337;
(function(){var b=(window.tavultesoft={}).keymanweb={_TitleElement:null,_Enabled:1,_IE:0,legacy:0,_IsActivatingKeymanWebUI:0,_JustActivatedKeymanWebUI:0,_IgnoreNextSelChange:0,_Selection:null,_SelectionControl:null,_KeyboardStubs:[],dfltStub:null,_Keyboards:[],_ActiveKeyboard:null,_ActiveStub:null,_LoadingInternalName:null,_AnyIndices:[],_DeadKeys:[],_EventHandlers:[],_ActiveControl:null,_Controls:[],_AttachedElements:[],_ActiveElement:null,_LastActiveElement:null,_DfltStyle:"",_MasterDocument:null,
_HotKeys:[],inputList:[],deferredKRS:[],deferredKR:[],loadTimer:null,waiting:null,baseFont:"sans-serif",appliedFont:"",embeddedFonts:[]};b.initialized=0;b.build=__BUILD__;b.version="2.0";b.helpURL="http://keyman.com/web/";window.KeymanWeb=b;var h=b.util={};b.osk={ready:!1};b.ui={};b.options={};h.events=[];h.currentEvents=[];h.addEventListener=function(a,b){h.removeEventListener(a,b);h.events[a].push(b);return!0};h.removeEventListener=function(a,b){"undefined"==typeof h.events[a]&&(h.events[a]=[]);
for(var c=0;c<h.events[a].length;c++)if(h.events[a][c]==b)return h.events[a].splice(c,1),!0;return!1};h.callEvent=function(a,b){if("undefined"==typeof h.events[a])return!0;if("undefined"!=typeof h.currentEvents[a])return!1;h.currentEvents.push(a);for(var c=0;c<h.events[a].length;c++){var d=h.events[a][c],e=!1;try{e=d(b)}catch(f){e=!1}if(!e)return h.currentEvents.pop(),!1}h.currentEvents.pop();return!0};h.attachDOMEvent=h.attachDOMEvent=function(a,g,c,d){h.detachDOMEvent(a,g,c,d);a.attachEvent?a.attachEvent("on"+
g,c):a.addEventListener&&a.addEventListener(g,c,d?!0:!1);b._EventHandlers=b._push(b._EventHandlers,{Lelem:a,Lname:g,Lhandler:c,LuseCapture:d?!0:!1})};h.detachDOMEvent=h.detachDOMEvent=function(a,g,c){var d,e;for(d=0;d<b._EventHandlers.length;d++)if(e=b._EventHandlers[d],e.Lname==g&&e.Lelem==a&&e.Lhandler==c){e.Lelem.detachEvent?e.Lelem.detachEvent("on"+e.Lname,e.Lhandler):e.Lelem.removeEventListener&&e.Lelem.removeEventListener(e.Lname,e.Lhandler,e.LuseCapture);b._EventHandlers=b._EventHandlers.slice(0,
d).concat(b._EventHandlers.slice(d+1));break}};h.getOption=h.getOption=function(a,g){return a in b.options?b.options[a]:1<arguments.length?g:""};h.setOption=h.setOption=function(a,g){b.options[a]=g};h.fixPath=function(a){if(0==a.length)return a;var b=a.substr(a.length-1,1);return"/"==b||"\\"==b?a:a+"/"};h.getAbsoluteX=h._GetAbsoluteX=function(a){if(!a)return 0;var g=a.offsetLeft?a.offsetLeft:0,c=a;if(c.offsetParent)for(;c.offsetParent;)c=c.offsetParent,g+=c.offsetLeft;c&&(c.ownerDocument&&a.ownerDocument!=
b._MasterDocument)&&(c=c.ownerDocument);return c&&c.parentWindow&&c.parentWindow.frameElement?g+h._GetAbsoluteX(c.parentWindow.frameElement)-c.documentElement.scrollLeft:c&&c.defaultView&&c.defaultView.frameElement?g+h._GetAbsoluteX(c.defaultView.frameElement)-c.documentElement.scrollLeft:g};h.getAbsoluteY=h._GetAbsoluteY=function(a){if(!a)return 0;var g=a.offsetTop?a.offsetTop:0,c=a;if(c.offsetParent)for(;c.offsetParent;)c=c.offsetParent,g+=c.offsetTop;c&&(c.ownerDocument&&a.ownerDocument!=b._MasterDocument)&&
(c=c.ownerDocument);return c&&c.parentWindow&&c.parentWindow.frameElement?g+h._GetAbsoluteY(c.parentWindow.frameElement)-c.documentElement.scrollTop:c&&c.defaultView&&c.defaultView.frameElement?g+h._GetAbsoluteY(c.defaultView.frameElement)-c.documentElement.scrollTop:g};h.getAbsolute=h._GetAbsolute=function(a){var b={};b.x=h._GetAbsoluteX(a);b.y=h._GetAbsoluteY(a);return b};h.createElement=h._CreateElement=function(a){a=document.createElement(a);"undefined"!=typeof a.onselectstart?(a.unSelectable=
"on",a.onselectstart=function(){return!1}):(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none",a.style.UserSelect="none",a.style.WebkitUserSelect="none");return a};h.getIEVersion=h._GetIEVersion=function(){var a=999;if(document.selection){var b=navigator.appVersion,c=b.indexOf("MSIE ");0<=c&&(a="BackCompat"==document.compatMode?6:parseInt(b.substr(c+5),10),6>a&&(a=6))}return a};h.getDPI=function(){var a=document.createElement("DIV"),b=a.style,c=96;if("complete"!==document.readyState)return c;
a.id="calculateDPI";b.position="absolute";b.display="block";b.visibility="hidden";b.left="10px";b.top="10px";b.width="1in";b.height="10px";document.body.appendChild(a);c="undefined"==typeof window.devicePixelRatio?a.offsetWidth:a.offsetWidth*window.devicePixelRatio;document.body.removeChild(a);return c};h.getStyleValue=function(a,b){return a&&"undefined"!=typeof a.currentStyle?a.currentStyle[b]:a&&"undefined"!=typeof window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):""};
var j=h.device={touchable:!!("ontouchstart"in window),OS:"",formFactor:"desktop",dyPortrait:0,dyLandscape:0,app:""};if(navigator&&navigator.userAgent){var l=navigator.userAgent;0<=l.indexOf("iPad")&&(j.OS="iOS",j.formFactor="tablet",j.dyPortrait=j.dyLandscape=0);0<=l.indexOf("iPhone")&&(j.OS="iOS",j.formFactor="phone",j.dyPortrait=j.dyLandscape=25);0<=l.indexOf("Android")&&(j.OS="Android",j.formFactor="phone",j.dyPortrait=75,j.dyLandscape=25);if(0<=l.indexOf("Windows NT")&&(j.OS="Windows",0<=l.indexOf("Touch")&&
(j.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints))j.touchable=!0}"tablet"==j.formFactor&&720>Math.min(screen.width,screen.height)&&(j.formFactor="phone");"phone"==j.formFactor&&720<Math.min(screen.width,screen.height)&&(j.formFactor="tablet");h.isTouchDevice=function(){return j.touchable};h.landscapeView=function(){return typeof window.orientation=="undefined"?true:Math.abs(window.orientation/90)==1};h.barHeight=function(){var a=0;j.formFactor=="phone"&&
(a=screen.height/2-window.innerHeight-(h.landscapeView()?j.dyLandscape:j.dyPortrait));return a};h.windowWidth=function(){var a=630;if(document.body&&document.body.offsetWidth)a=document.body.offsetWidth;if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth)a=document.documentElement.offsetWidth;if(window.innerWidth)a=window.innerWidth;return a};h.windowHeight=function(){var a=1024;if(document.body&&document.body.offsetHeight)a=document.body.offsetHeight;
if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetHeight)a=document.documentElement.offsetHeight;if(window.innerHeight)a=window.innerHeight;return a};h._EncodeEntities=function(a){return a.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};h.createShim=h.createShim=function(){var a=h._CreateElement("IFRAME");a.src="";a.style.display="none";a.style.position="absolute";a.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";
a.frameBorder="0";a.scrolling="no";return a};h.showShim=h.showShim=function(a,b,c){if(b)try{b.style.left=h._GetAbsoluteX(a)+"px";b.style.top=h._GetAbsoluteY(a)+"px";if(c){b.style.width=h._GetAbsoluteX(c)-h._GetAbsoluteX(a)+c.offsetWidth+"px";b.style.height=h._GetAbsoluteY(c)-h._GetAbsoluteY(a)+c.offsetHeight+"px"}else{b.style.width=a.offsetWidth+"px";b.style.height=a.offsetHeight+"px"}b.style.zindex="9999";b.style.display="block"}catch(d){}};h.hideShim=function(a){try{if(a)a.style.display="none"}catch(b){}};
h.rgba=h.rgba=function(a,b,c,d,e){var f="transparent";if(h._GetIEVersion()<9){e=Math.floor(100*e);b=b.toString(16);c=c.toString(16);d=d.toString(16);b=("00"+b).substr(-2);c=("00"+c).substr(-2);d=("00"+d).substr(-2);d=e+b+c+d;a.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+d+",endColorstr=#"+d+")";a.zoom="1"}else try{f="rgba("+b+","+c+","+d+","+e+")"}catch(i){f="rgb("+b+","+c+","+d+")"}return f};h.addStyleSheet=h.addStyleSheet=function(a){var b=document.createElement("STYLE");
b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));a=document.getElementsByTagName("HEAD");a.length>0?a[0].appendChild(b):document.body.appendChild(b);return b};h.removeStyleSheet=h.removeStyleSheet=function(a){if(a==null||typeof a!="object"||a.nodeName!="STYLE"||typeof a.parentNode=="undefined"||a.parentNode==null)return false;a.parentNode.removeChild(a);return true};h.linkStyleSheet=h.linkStyleSheet=function(a){var b=document.getElementsByTagName("head");
if(b.length>0){var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=a;b[0].appendChild(c)}};h.addFontFaceStyleSheet=function(a){if(!(typeof a=="undefined"||typeof a.files=="undefined")){var g,c="",d="",e="",f=[];for(g=0;g<b.embeddedFonts.length;g++)if(b.embeddedFonts[g]==a.family)return;typeof a.files=="string"?f[0]=a.files:f=a.files;for(g=0;g<f.length;g++){f[g].indexOf(".ttf")>0&&(c=f[g]);f[g].indexOf(".woff")>0&&(d=f[g]);f[g].indexOf(".eot")>0&&(e=f[g])}c!=""&&(c=b.options.fonts+
c);d!=""&&(d=b.options.fonts+d);e!=""&&(e=b.options.fonts+e);g="@font-face {\nfont-family:"+a.family+";\nfont-style:normal;\nfont-weight:normal;\n";f=h._GetIEVersion();if(f>=999)if(j.OS=="iOS"||j.OS=="Android")if(c!="")g=g+"src:url('"+c+"') format('truetype');";else return;else if(c!=""&&d!="")g=g+"src:url('"+d+"') format('woff'),url('"+c+"') format('truetype');";else if(d!="")g=g+"src:url('"+d+"') format('woff');";else if(c!="")g=g+"src:url('"+c+"') format('truetype');";else return;else if(e!=""&&
f<9)g=g+"src:url('"+e+"?#iefix') format('embedded-opentype');";else if(e!="")g=g+"src:url('"+e+"');";else return;h.addStyleSheet(g+"\n}\n");b.embeddedFonts.push(a.family)}};h.loadCookie=h.loadCookie=function(a){var b={};if(arguments.length>0){var c=h.loadCookie(),d;for(d in c)if(d==a)for(var e=unescape(c[d]).split(";"),f=0;f<e.length;f++){var i=e[f].split("=");b[i[0]]=i.length>1?i[1]:""}}else if(typeof document.cookie!="undefined"&&document.cookie!=""){c=document.cookie.split(/;\s*/);for(f=0;f<c.length;f++){e=
c[f].split("=");e.length==2&&(b[e[0]]=e[1])}}return b};h.saveCookie=h.saveCookie=function(a,b){var c="",d;for(d in b)c=c+d+"="+b[d]+";";d=(new Date((new Date).valueOf()+2592E6)).toGMTString();document.cookie=a+"="+escape(c)+"; path=/; expires="+d};h.toNumber=h.toNumber=function(a,b){var c=parseInt(a,10);return isNaN(c)?b:c};h.toFloat=h.toFloat=function(a,b){var c=parseFloat(a);return isNaN(c)?b:c};h.toNzString=h.nzString=function(a,b){var c="";arguments.length>1&&(c=b);return typeof a=="undefined"||
a==null||a==0||a==""?c:""+a};h.deepCopy=function(a,b){var c=b||{},d;for(d in a)if(typeof a[d]==="object"){c[d]=a[d].constructor===Array?[]:{};h.deepCopy(a[d],c[d])}else c[d]=a[d];return c};"indexOf"in Array||(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]==a)return c;return-1});h.eventTarget=function(a){return a&&a.target?a.target:window.event?window.event.srcElement:null};h.eventType=function(a){return a&&a.type?a.type:window.event?window.event.type:""};h.alert=
h.alert=function(a,g){var c=b.waiting,d=c.firstChild.childNodes;d[0].style.display="block";d[1].className="kmw-alert-text";d[1].innerHTML=a;d[2].style.display="none";c.style.display="block";c.dismiss=arguments.length>1?g:null};h.prepareWait=function(){var a=document.createElement("DIV"),g=document.createElement("DIV"),c=document.createElement("DIV"),d=document.createElement("DIV"),e=document.createElement("DIV");a.className="kmw-wait-background";g.className="kmw-wait-box";a.dismiss=null;c.className=
"kmw-wait-text";d.className="kmw-wait-graphic";e.className="kmw-alert-close";g.ontouchstart=g.onmousedown=g.onclick=function(){if(e.style.display=="block"){a.style.display="none";a.dismiss&&a.dismiss()}};a.ontouchstart=a.onmousedown=a.onclick=function(a){a.preventDefault();a.stopPropagation()};g.appendChild(e);g.appendChild(c);g.appendChild(d);a.appendChild(g);document.body.appendChild(a);b.waiting=a};h.wait=function(a){if(j.app==""){var g=b.waiting,c=g.firstChild.childNodes;if(a){g.pending=true;
window.setTimeout(function(){if(g.pending){window.scrollTo(0,0);c[0].style.display="none";c[1].className="kmw-wait-text";c[1].innerHTML=a;c[2].style.display="block";g.style.display="block"}},1E3)}else if(g.pending){c[1].innerHTML="";g.pending=false;g.style.display="none"}}};h.myPath=function(){var a="keymanweb",b,c=document.getElementsByTagName("script"),d;if(j.app=="iPhone"||j.app=="iPad")a="keymanios";for(b=0;b<c.length;b++){d=c[b];if(d.src.indexOf(a)>=0)return d.src.substr(0,d.src.lastIndexOf("/")+
1)}return""};h.checkFont=function(a){var b=true,c=document.createElement("DIV"),d=c.style,e=document.createElement("P"),f=document.createElement("P"),i=document.createElement("SPAN"),h=i.style,j=document.createElement("SPAN"),k=j.style;d.position="absolute";d.top="10px";d.left="10px";d.visibility="hidden";document.body.appendChild(c);c.appendChild(e);c.appendChild(f);e.appendChild(i);f.appendChild(j);h.fontFamily="monospace !important";k.fontFamily=a+",monospace";h.fontSize=k.fontSize="24px";i.innerHTML=
j.innerHTML="BESbswy";if(i.offsetWidth==j.offsetWidth){h.fontFamily="sans-serif !important";k.fontFamily=a+",sans-serif";if(i.offsetWidth==j.offsetWidth){h.fontFamily="serif !important";k.fontFamily=a+",serif";i.offsetWidth==j.offsetWidth&&(b=false)}}e.removeChild(i);f.removeChild(j);c.removeChild(e);c.removeChild(f);document.body.removeChild(c);return b};h.checkFontDescriptor=function(a){return typeof a=="undefined"||typeof a.family!="string"?true:h.checkFont(a.family)}})();(function(){var b=window.tavultesoft.keymanweb,h=b.osk,j=b.util,l=j.device;b.debug=b.debug=function(a){var c;if(null==b.debugElement){var d=document.createElement("DIV");c=d.style;c.position="absolute";c.width="30%";c.maxHeight="50%";c.top="0";c.right="0";c.minHeight="50px";c.border="1px solid blue";c.whiteSpace="pre-line";c.overflowY="scroll";c=document.createElement("P");c.id="debug_output";c.style.margin="2px";d.appendChild(c);document.body.appendChild(d);b.debugElement=c}if(null!=(c=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof c.textContent?c.textContent="":c.innerHTML="";else{var d=(new Date).toTimeString().substr(3,5),e=a,f;if("object"==typeof a)if(null==a)e="null";else{e="{";for(f in a){e=e+f+":";switch(typeof a[f]){case "string":case "number":case "boolean":e+=a[f];break;default:e+=typeof a[f]}e+="; "}2<e.length&&(e=e.substr(0,e.length-2));e+="}"}"undefined"!=typeof c.textContent?c.textContent=d+" "+e+"\n"+c.textContent:c.innerHTML=d+" "+e+"<br />"+c.innerHTML}};b.debugElement=null;
b.addEventListener=function(a,b){return j.addEventListener("kmw."+a,b)};b.setupTouchDevice=function(){b.setFocus=function(a){a.stopPropagation();a.preventDefault();var d=a;"object"==typeof a.touches&&(d=a.touches[0]);var a=d.clientX,g=d.clientY,c=d.target,e;e="SPAN"==c.nodeName?c.parentNode:null!=c.className&&0<=c.className.indexOf("keymanweb-input")?c.firstChild:c;d=e.parentNode;b._ActiveElement!=d&&(b.hideCaret(),b._ActiveElement=d,d.focus());b.useInternalKeyboard=!1;h.ready&&!h._Visible&&h._Show();
if("DIV"==c.nodeName)g=j._GetAbsoluteX(e.firstChild),"rtl"==d.dir?(g+=e.firstChild.offsetWidth,e=a>g?0:1E5):e=a<g?0:1E5,b.setTextCaret(d,e),b.scrollInput(d);else{var f,i,k,o,u,l,c=e.childNodes[1];f=0;i=b.getText(d)._kmwLength();e=b.getTextCaret(d);o=document.body.scrollTop;if("TEXTAREA"==d.base.nodeName){u=Math.round(d.base.offsetHeight/d.base.rows);for(l=0;16>l;l++){k=j._GetAbsoluteY(c)-o;if(k>g&&e>f&&e!=i)i=e,e=Math.round((e+f)/2);else if(k<g-u&&e<i&&e!=f)f=e,e=Math.round((e+i)/2);else break;b.setTextCaret(d,
e)}for(;j._GetAbsoluteY(c)-o>g&&e>f;)b.setTextCaret(d,--e);for(;j._GetAbsoluteY(c)-o<g-u&&e<i;)b.setTextCaret(d,++e)}if("rtl"==d.dir){for(l=0;16>l;l++){g=j._GetAbsoluteX(c);if(g<a&&e>f&&e!=i)i=e,e=Math.round((e+f)/2);else if(g>a&&e<i&&e!=f)f=e,e=Math.round((e+i)/2);else break;b.setTextCaret(d,e)}for(;j._GetAbsoluteX(c)<a&&e>f;)b.setTextCaret(d,--e);for(;j._GetAbsoluteX(c)>a&&e<i;)b.setTextCaret(d,++e)}else{for(l=0;16>l;l++){g=j._GetAbsoluteX(c);if(g>a&&e>f&&e!=i)i=e,e=Math.round((e+f)/2);else if(g<
a&&e<i&&e!=f)f=e,e=Math.round((e+i)/2);else break;b.setTextCaret(d,e)}for(;j._GetAbsoluteX(c)>a&&e>f;)b.setTextCaret(d,--e);for(;j._GetAbsoluteX(c)<a&&e<i;)b.setTextCaret(d,++e)}}b._ActiveControl=null;b._LastActiveElement=d;for(a=0;a<b._Controls.length;a++)if(b._Controls[a].LControl==d){b._ActiveControl=b._Controls[a];break}null!=b._ActiveControl&&null!=b._ActiveControl.LDefaultInternalName&&(b._JustActivatedKeymanWebUI?b._ActiveControl.LDefaultInternalName=null==b._ActiveKeyboard?"":b._ActiveKeyboard.KI:
b._SetActiveKeyboard(b._ActiveControl.LDefaultInternalName,"",!0));!b._IsIEEditableIframe(d,1)||!b._IsMozillaEditableIframe(d,1)?b._DisableInput=1:(b._DisableInput=0,b._JustActivatedKeymanWebUI||(b._DeadKeys=[],b._NotifyKeyboard(0,d,1)),!b._JustActivatedKeymanWebUI&&b._SelectionControl!=d&&(b._IsActivatingKeymanWebUI=0),b._JustActivatedKeymanWebUI=0,b._SelectionControl=d)};b.caret=document.createElement("DIV");var a=b.caret.style;a.position="absolute";a.height="16px";a.width="2px";a.backgroundColor=
"blue";a.border="none";a.left=a.top=0;a.display="block";a.visibility="hidden";a.zIndex="9998";b.showCaret=function(a){if(a&&a.firstChild&&!(3>a.firstChild.childNodes.length)){var d=a.firstChild,g=b.caret.style,e=d.childNodes[1];b.caret.parentNode!=d&&d.appendChild(b.caret);g.left=e.offsetLeft+"px";g.top=e.offsetTop+"px";g.height=e.offsetHeight-1+"px";g.visibility="hidden";b.scrollBody(a);b.setScrollBar(a)}};b.setScrollBar=function(a){var b=a.childNodes[0],d=a.childNodes[1].style;(b.offsetWidth>a.offsetWidth||
0>b.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(d.height="4px",d.width=100*(a.offsetWidth/b.offsetWidth)+"%",d.left=100*(-b.offsetLeft/b.offsetWidth)+"%",d.top="0",d.visibility="visible"):b.offsetHeight>a.offsetHeight||0>b.offsetTop?(d.width="4px",d.height=100*(a.offsetHeight/b.offsetHeight)+"%",d.top=100*(-b.offsetTop/b.offsetHeight)+"%",d.left="0",d.visibility="visible"):d.visibility="hidden"};b.flashCaret=function(){if(l.touchable&&null!=b._ActiveElement){var a=b.caret.style;a.visibility="visible"!=
a.visibility?"visible":"hidden"}};b.hideCaret=function(){var a=b._LastActiveElement;if(a&&null!=a.className&&0<=a.className.indexOf("keymanweb-input")){a.base.value=b.getText(a);b.setText(a,null,1E5);var d=a.firstChild.style;"TEXTAREA"==a.base.nodeName?d.top="0":d.left="rtl"==a.base.dir?a.offsetWidth-a.firstChild.offsetWidth-8+"px":"0";b.caret.parentNode&&b.caret.parentNode.removeChild(b.caret);b.caret.style.visibility="hidden";1<a.childNodes.length&&(a.childNodes[1].style.visibility="hidden")}};
b.timerId=window.setInterval(b.flashCaret,500);b.setText=function(a,d,g){if(a&&0<a.childNodes.length){var e=a.firstChild,c=0;if(3<=e.childNodes.length){var f=e.childNodes[0],e=e.childNodes[2],i;null===d&&(i="string"==typeof f.textContent?f.textContent:f.innerText,d="string"==typeof e.textContent?e.textContent:e.innerText,d=i+d);0>g&&(g=0);c=d._kmwLength();if(null===g||g>c)g=c;i=d._kmwSubstr(0,g);d=d._kmwSubstr(g);"string"==typeof f.textContent?f.textContent=i:f.innerText=i;"string"==typeof e.textContent?
e.textContent=d:e.innerText=d}}b.updateBaseElement(a,c)};b.updateBaseElement=function(a,d){a.base.value=b.getText(a);a.base.style.visibility=0==d?"visible":"hidden";a.style.backgroundColor=0==d?"transparent":window.getComputedStyle(a.base,null).backgroundColor};b.getText=function(a){return null==a?"":"string"==typeof a.textContent?a.textContent:a.innerText};b.getTextBeforeCaret=function(a){if(a&&1<a.childNodes.length&&(a=a.firstChild,0<a.childNodes.length)){a=a.childNodes[0];if("textContent"in a)return a.textContent;
if("innerText"in a)return a.innerText}return""};b.setTextBeforeCaret=function(a,d){if(a&&0<a.childNodes.length){var g=a.firstChild,e=0;1<g.childNodes.length&&(e=g.childNodes[0],g=g.childNodes[2],"TEXTAREA"!=a.base.nodeName&&(d=d.replace(/\s+$/," ")),"textContent"in e?e.textContent=d:"innerText"in e&&(e.innerText=d),e=d.length,"textContent"in g?e+=g.textContent.length:"innerText"in g&&(e+=g.innerText.length))}b.updateBaseElement(a,e);b.scrollInput(a)};b.getTextCaret=function(a){return b.getTextBeforeCaret(a)._kmwLength()};
b.setTextCaret=function(a,d){b.setText(a,null,d);b.showCaret(a)};b.dragInput=function(a){a.preventDefault();a.stopPropagation();var d="object"==typeof a.targetTouches?a.targetTouches[0].target:a.target;if(null!=d){if(null==d.className||0>d.className.indexOf("keymanweb-input"))d=d.parentNode;if(null==d.className||0>d.className.indexOf("keymanweb-input"))d=d.parentNode;if(!(null==d.className||0>d.className.indexOf("keymanweb-input"))){var g="object"==typeof a.touches?a.touches[0].screenX:a.screenX,
e="object"==typeof a.touches?a.touches[0].screenY:a.screenY;if("undefined"==typeof b.firstTouch||null==b.firstTouch)b.firstTouch={x:g,y:e};else{var c=b.firstTouch.x,f=b.firstTouch.y,a=d.firstChild,i;if("TEXTAREA"==d.base.nodeName){if(g=parseInt(a.style.top,10),isNaN(g)&&(g=0),c=f-e,-4>c||4<c)a.style.top=(g<c?g-c:0)+"px",b.firstTouch.y=e}else if(e=parseInt(a.style.left,10),isNaN(e)&&(e=0),i=c-g,-4>i||4<i)c=0,f=j._GetAbsoluteX(d)+d.offsetWidth-a.offsetWidth-32,"rtl"==d.base.dir?c=16:f-=24,e-=i,e>c&&
(e=c),e<f&&(e=f),a.style.left=e+"px",b.firstTouch.x=g}b.setScrollBar(d)}}};b.scrollInput=function(a){if(a&&a.firstChild&&!(null==a.className||0>a.className.indexOf("keymanweb-input"))){var d=a.firstChild;if(!(3>d.childNodes.length)){var g=d.childNodes[1],e=j._GetAbsoluteX(g),g=j._GetAbsoluteY(g),c=j._GetAbsoluteX(a),f=j._GetAbsoluteY(a),i=parseInt(d.style.left,10),h=parseInt(d.style.top,10),k=0,o=0;isNaN(i)&&(i=0);isNaN(h)&&(h=0);"TEXTAREA"==a.base.nodeName?(e=Math.round(a.offsetHeight/a.base.rows),
g<f&&(o=g-f),g>f+a.offsetHeight-e&&(o=g-f-a.offsetHeight+e),0!=o&&(d.style.top=(h<o?h-o:0)+"px")):(e<c+8&&(k=e-c-12),e>c+a.offsetWidth-12&&(k=e-c-a.offsetWidth+12),0!=k&&(d.style.left=(i<k?i-k:0)+"px"));b.showCaret(a)}}};b.scrollBody=function(a){if(a&&!(null==a.className||0>a.className.indexOf("keymanweb-input")||!h.ready)){var a=a.firstChild.childNodes[1],b=j._GetAbsoluteY(a),d=window.pageYOffset,g=0;b<d?g=b-d:(g=b-d-(window.innerHeight-h._Box.offsetHeight-a.offsetHeight-2),0>g&&(g=0));0!=g&&window.scrollTo(0,
g+window.pageYOffset)}};b.updateInput=function(a){var b=a.style,d=a.base,a=window.getComputedStyle(d,null),g=parseInt(a.marginLeft,10),e=parseInt(a.marginTop,10),c=j._GetAbsoluteX(d),f=j._GetAbsoluteY(d);isNaN(g)&&(g=0);isNaN(e)&&(e=0);b.left=c-g+"px";b.top=f-e+"px";var g=d.offsetWidth,d=d.offsetHeight,e=parseInt(a.paddingLeft,10),c=parseInt(a.paddingRight,10),f=parseInt(a.paddingTop,10),i=parseInt(a.paddingBottom,10),h=parseInt(a.borderLeft,10),k=parseInt(a.borderRight,10),o=parseInt(a.borderTop,
10),a=parseInt(a.borderBottom,10);isNaN(e)||(g-=e);isNaN(c)||(g-=c);isNaN(h)||(g-=h);isNaN(k)||(g-=k);b.width=g+"px";isNaN(f)||(d-=f);isNaN(i)||(d-=i);isNaN(o)||(d-=o);isNaN(a)||(d-=a);b.height=d+"px"};b.alignInputs=function(a){if(l.touchable)for(var d=0;d<b.inputList.length;d++)a?(b.updateInput(b.inputList[d]),b.inputList[d].style.visibility="visible",0<b.inputList[d].base.textContent.length&&(b.inputList[d].base.style.visibility="hidden")):(b.inputList[d].style.visibility="hidden",b.inputList[d].base.style.visibility=
"visible")};for(var c=0;2>c;c++)for(var d=document.getElementsByTagName(0==c?"INPUT":"TEXTAREA"),a=0;a<d.length;a++)if(d[a].kmwInput){var e=document.createElement("DIV");e.base=e.base=d[a];e.base.className=e.base.className?e.base.className+" keymanweb-font":"keymanweb-font";d[a].kmw_ip=e;b.inputList.push(e)}for(var f,i,u,o,k,a=0;a<b.inputList.length;a++)e=b.inputList[a],e.className="keymanweb-input",e.dir=e.base.dir,d=document.createElement("DIV"),c=window.getComputedStyle(e.base,null),f=e.style,
f.overflow="hidden",f.position="absolute",f.border="hidden",f.borderRadius="5px",f.padding="8px",f.webkitTapHighlightColor="rgb(0,0,0,0)",e.base.style.webkitTapHighlightColor="rgb(0,0,0,0)",o=document.createElement("DIV"),f=o.style,f.position="absolute",f.height=f.width="4px",f.left=f.top="0",f.display="block",f.visibility="hidden",f.backgroundColor="#808080",f.borderRadius="2px",f=document.createElement("SPAN"),i=document.createElement("SPAN"),u=document.createElement("SPAN"),f.innerHTML=i.innerHTML=
u.innerHTML="",f.className=i.className=u.className="keymanweb-font",d.appendChild(f),d.appendChild(u),d.appendChild(i),e.appendChild(d),e.appendChild(o),d=d.style,d.position="absolute",o=f.style,k=i.style,u=u.style,o.border=k.border="none",o.height=k.height="100%",o.fontFamily=k.fontFamily=d.fontFamily=c.fontFamily,u.border="1px solid red",u.visibility="hidden",u.marginLeft=u.marginRight="-1px",d.padding="0px 2px",e.tabIndex="0",e.style.msTouchAction="none",e.onmspointerdown=e.ontouchstart=e.onfocus=
b.setFocus,e.onmspointermove=e.ontouchmove=b.dragInput,f.style.whiteSpace="TEXTAREA"==e.base.nodeName?i.style.whiteSpace="pre-wrap":i.style.whiteSpace="pre",e.base.parentNode.appendChild(e),b.updateInput(e),f=e.style,f.color=c.color,f.backgroundColor=c.backgroundColor,f.fontFamily=c.fontFamily,f.fontSize=c.fontSize,f.fontWeight=c.fontWeight,f.textDecoration=c.textDecoration,f.padding=c.padding,f.margin=c.margin,f.border=c.border,f.borderRadius=c.borderRadius,"webkitTapHighlightColor"in f&&(f.webkitTapHighlightColor=
"rgba(0,0,0,0)"),"TEXTAREA"==e.base.nodeName?(2==e.base.rows&&(i=parseInt(c.height,10)-parseInt(c.paddingTop,10)-parseInt(c.paddingBottom,10),c=parseInt(c.fontSize,10),c=Math.round(i/c),c>e.base.rows+1&&(e.base.rows=c)),d.width=f.width,d.minHeight=f.height):(d.minWidth=f.width,d.height=f.height),e.base.style.visibility="hidden",function(a){a.base.addEventListener("resize",function(){b.updateInput(a)},false)}(e),b.setText(e,e.base.value,null)};b.setupDesktopPage=function(){for(var a=0;2>a;a++)for(var c=
document.getElementsByTagName(0==a?"INPUT":"TEXTAREA"),d=0;d<c.length;d++)0>c[d].className.indexOf("kmw-disabled")&&!c[d].readOnly&&b.inputList.push(c[d]),c[d].className=c[d].className?c[d].className+" keymanweb-font":"keymanweb-font"};b.getBaseFont=function(){var a=document.getElementsByTagName("INPUT"),b=document.getElementsByTagName("TEXTAREA"),d=0,e;0==a.length&&0==b.length?d=0:0<a.length&&0==b.length?d=1:0==a.length&&0<b.length?d=2:a[0].offsetTop<b[0].offsetTop?d=1:a[0].offsetTop>b[0].offsetTop?
d=2:a[0].offsetLeft<b[0].offsetLeft?d=1:a[0].offsetLeft>b[0].offsetLeft&&(d=2);switch(d){case 0:case 1:j.getStyleValue(a[0],"font-family");case 2:e=j.getStyleValue(b[0],"font-family")}if("undefined"==typeof e||"monospace"==e)e="Arial,sans-serif";return e};b.setFocus=function(){};b.timerID=null;b.getText=function(){return""};b.setText=function(){};b.getTextBeforeCaret=function(){return""};b.setTextBeforeCaret=function(){};b.getTextCaret=function(){return 0};b.setTextCaret=function(){};b.hideCaret=
function(){};b.flashCaret=function(){};b.updateInput=function(){};b.alignInputs=function(){};if(document.selection){var a=navigator.appVersion;"undefined"==typeof document.createEventObject&&(0<=a.indexOf("MSIE 5.0")||0<=a.indexOf("MSIE 4.0")||0<=a.indexOf("MSIE 3.0"))?b.legacy=1:0<=a.indexOf("MSIE 6.0")?b._IE=6:0<=a.indexOf("MSIE 7.0")?b._IE=7:0<=a.indexOf("MSIE 8.0")&&(b._IE=8);b._IE&&"BackCompat"==document.compatMode&&(b._IE=6)}h._BaseLayout="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:
"us";b._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");b._GetEventObject=function(a){if(!a&&(a=window.event,!a&&(a=b._GetLastActiveElement()))){if(a=a.ownerDocument)a=a.parentWindow;if(!a)return null;a=a.event}return a};b._push=function(a,b){a.push?a.push(b):a=a.concat(b);return a};b._IsAttached=function(a){for(var c=0;c<b._AttachedElements.length;c++)if(b._AttachedElements[c]==a)return 1;return 0};b.attachToControl=b.attachToControl=function(a){var c=a.attributes.readonly,d=a.className;
!("object"==typeof c&&"false"!=c.value)&&!("string"==typeof d&&0<=d.indexOf("kmw-disabled"))&&("iframe"==a.tagName.toLowerCase()?b._AttachToIframe(a):(j.attachDOMEvent(a,"focus",b._ControlFocus),j.attachDOMEvent(a,"blur",b._ControlBlur),a.onkeypress=b._KeyPress,a.onkeydown=b._KeyDown,a.onkeyup=b._KeyUp),b._IsAttached(a)||b._AttachedElements.push(a))};b._AttachToIframe=function(a){try{var c=a.contentWindow.document;if(c)if(c.parentWindow){if("on"==c.designMode.toLowerCase()||c.body.isContentEditable)j.attachDOMEvent(a,
"focus",b._ControlFocus),j.attachDOMEvent(a,"blur",b._ControlBlur),j.attachDOMEvent(c,"keydown",b._KeyDown),j.attachDOMEvent(c,"keypress",b._KeyPress),j.attachDOMEvent(c,"keyup",b._KeyUp),b.legacy||(j.attachDOMEvent(c,"selectionchange",b._SelectionChange),b._SelectionChange())}else"on"==c.designMode.toLowerCase()?(j.attachDOMEvent(c,"focus",b._ControlFocus),j.attachDOMEvent(c,"blur",b._ControlBlur),j.attachDOMEvent(c,"keydown",b._KeyDown),j.attachDOMEvent(c,"keypress",b._KeyPress),j.attachDOMEvent(c,
"keyup",b._KeyUp)):b._AttachToControls(c)}catch(d){}};b.GetEnabled=function(){return b._Enabled};b.SetEnabled=function(a){a=a?1:0;b._Enabled!=a&&(b._Enabled=a,!a&&b.HideInterface&&b.HideInterface())};b.DisableControl=function(a){var c;for(c=0;c<b._Controls.length;c++)if(b._Controls[c].LControl==a){b._Controls[c].LEnabled=0;return}b._Controls=b._push(b._Controls,{LControl:a,LEnabled:0,LDefaultInternalName:"-"})};b.EnableControl=function(a){var c;for(c=0;c<b._Controls.length;c++)if(b._Controls[c].LControl==
a){b._Controls[c].LEnabled=1;return}b._Controls=b._push(b._Controls,{LControl:a,LEnabled:1,LDefaultInternalName:"-"})};b.SetDefaultKeyboardForControl=function(a,c){var d;for(d=0;d<b._Controls.length;d++)if(b._Controls[d].LControl==a){b._Controls[d].LDefaultInternalName=c;return}b._Controls=b._push(b._Controls,{LControl:a,LEnabled:1,LDefaultInternalName:c})};b.focusLastActiveElement=b._FocusLastActiveElement=function(){b._LastActiveElement&&(b._JustActivatedKeymanWebUI=1,b._IsMozillaEditableIframe(b._LastActiveElement,
0)?b._LastActiveElement.defaultView.focus():b._LastActiveElement.focus&&b._LastActiveElement.focus())};b.getLastActiveElement=b._GetLastActiveElement=function(){return b._LastActiveElement};b.setActiveElement=b.setActiveElement=function(a){"string"==typeof a&&(a=document.getElementById(a));b._ActiveElement=b._LastActiveElement=a};b.getUIState=b.getUIState=function(){var a={};a.activationPending=a.activationPending=b._IsActivatingKeymanWebUI;a.activated=a.activated=b._JustActivatedKeymanWebUI;return a};
b.activatingUI=function(a){b._IsActivatingKeymanWebUI=a?1:0};b._ControlFocus=function(a){var c;if(!b._Enabled)return!0;a=b._GetEventObject(a);if(!a)return!0;if(a.target)a=a.target;else if(a.srcElement)a=a.srcElement;else return!0;if(l.touchable&&(null==a.className||0>a.className.indexOf("keymanweb-input")))return!0;c=a.nodeName.toLowerCase();if("input"==c){if(c=a.type.toLowerCase(),!("text"==c||"search"==c))return!0}else if("textarea"!=c)return!0;b._ActiveElement=a;3==a.nodeType&&(a=a.parentNode);
var d=a;l.touchable&&(null==a.className||0>a.className.indexOf("keymanweb-input"))&&b.scrollBody(a);"IFRAME"==a.tagName&&(b._AttachToIframe(a),a=a.contentWindow.document);b._ActiveControl=null;b._LastActiveElement=a;for(c=0;c<b._Controls.length;c++)if(b._Controls[c].LControl==a){b._ActiveControl=b._Controls[c];break}null!=b._ActiveControl&&null!=b._ActiveControl.LDefaultInternalName&&(b._JustActivatedKeymanWebUI?b._ActiveControl.LDefaultInternalName=null==b._ActiveKeyboard?"":b._ActiveKeyboard.KI:
b._SetActiveKeyboard(b._ActiveControl.LDefaultInternalName,"",!0));if(!b._IsIEEditableIframe(a,1)||!b._IsMozillaEditableIframe(a,1))return b._DisableInput=1,!0;b._DisableInput=0;b._JustActivatedKeymanWebUI||(b._DeadKeys=[],b._NotifyKeyboard(0,a,1));!b._JustActivatedKeymanWebUI&&b._SelectionControl!=a&&(b._IsActivatingKeymanWebUI=0);b._JustActivatedKeymanWebUI=0;b._SelectionControl=a;a._KeymanWebSelectionStart=a._KeymanWebSelectionEnd=null;b._SetTargDir(a);b.doControlFocused(d,b._ActiveControl);l.touchable?
h._Enabled=1:h.ready&&(b.isCJK()&&(h._Enabled=1),h._Enabled?h._Show():h._Hide(!1));return!0};b._IsIEEditableIframe=function(a,b){var d,e=a&&(d=a.tagName)&&"body"==d.toLowerCase()&&(d=a.ownerDocument)&&d.parentWindow;return!b&&e||b&&(!e||a.isContentEditable)};b._IsMozillaEditableIframe=function(a,b){var d,e=a&&(d=a.defaultView)&&d.frameElement;return!b&&e||b&&(!e||"on"==d.document.designMode.toLowerCase())};b._ControlBlur=function(a){var c;if(!b._Enabled)return!0;a=b._GetEventObject(a);if(!a)return!0;
if(a.target)c=a.target;else if(a.srcElement)c=a.srcElement;else return!0;b._ActiveElement=null;l.touchable&&b.hideCaret();3==c.nodeType&&(c=c.parentNode);"IFRAME"==c.tagName&&(c=c.contentWindow.document);c.setSelectionRange&&(c._KeymanWebSelectionStart=c.value._kmwCodeUnitToCodePoint(c.selectionStart),c._KeymanWebSelectionEnd=c.value._kmwCodeUnitToCodePoint(c.selectionEnd));b._LastActiveElement=c;null!=b._ActiveControl&&null!=b._ActiveControl.LDefaultInternalName&&(b._ActiveControl.LDefaultInternalName=
null==b._ActiveKeyboard?"":b._ActiveKeyboard.KI);b._ActiveControl=null;b._IsActivatingKeymanWebUI||b._NotifyKeyboard(0,c,0);a=b._GetEventObject(a);b.doControlBlurred(c,a,b._IsActivatingKeymanWebUI);h.ready&&!b._IsActivatingKeymanWebUI&&h._Hide(!1);return!0};b.doControlBlurred=function(a,b,d){var e={};e.target=a;e.event=b;e.isActivating=d;return j.callEvent("kmw.controlblurred",e)};b.doControlFocused=function(a,b){var d={};d.target=a;d.activeControl=b;return j.callEvent("kmw.controlfocused",d)};b.doKeyboardRegistered=
function(a,b,d,e){var f={};f.internalName=a;f.language=b;f.keyboardName=d;f.languageCode=e;return j.callEvent("kmw.keyboardregistered",f)};b.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return j.callEvent("kmw.keyboardloaded",b)};b.doBeforeKeyboardChange=function(a,b){var d={};d.internalName=a;d.languageCode=b;return j.callEvent("kmw.beforekeyboardchange",d)};b.doKeyboardChange=function(a,b,d){var e={};e.internalName=a;e.languageCode=b;e.indirect=2<arguments.length?d:!1;return j.callEvent("kmw.keyboardchange",
e)};b.doUnloadOSK=function(){return j.callEvent("kmw.unloadosk",{})};b.doLoadUI=function(){return j.callEvent("kmw.loaduserinterface",{})};b.doUnloadUI=function(){return j.callEvent("kmw.unloaduserinterface",{})};b._BubbledFocus=function(){};window.addEventListener&&window.addEventListener("focus",b._BubbledFocus,!0);b._GetKeyEventProperties=function(a){var c={},a=b._GetEventObject(a);if(!a||!0===a.cancelBubble)return null;if(a.target)c.Ltarg=a.target;else if(a.srcElement)c.Ltarg=a.srcElement;else return null;
3==c.Ltarg.nodeType&&(c.Ltarg=c.Ltarg.parentNode);if(a.keyCode)c.Lcode=a.keyCode;else if(a.which)c.Lcode=a.which;else return null;c.Lmodifiers=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0);c.LisVirtualKeyCode="undefined"!=typeof a.charCode&&null!=a.charCode&&(0==a.charCode||0!=(c.Lmodifiers&96));c.LisVirtualKey=c.LisVirtualKeyCode||"keypress"!=a.type;return c};b._SelectionChange=function(){if(b._IgnoreNextSelChange)b._IgnoreNextSelChange--;else{var a=document.selection;if("control"!=a.type.toLowerCase()&&
(a=a.createRange(),!b._Selection||!b._Selection.isEqual(a)))b._Selection=a,b._DeadKeys=[]}return!0};b._FindCaret=function(a){if(!a.createTextRange&&a.selectionStart){var c=document.createEvent("KeyboardEvent");if(c.initKeyEvent){c.initKeyEvent("keypress",!0,!0,null,!1,!1,!1,!1,0,32);var d=b._KeyPress;b._KeyPress=function(){};a.dispatchEvent(c);c=document.createEvent("KeyboardEvent");c.initKeyEvent("keypress",!0,!0,null,!1,!1,!1,!1,8,0);a.dispatchEvent(c);b._KeyPress=d}}};b._NotifyKeyboard=function(a,
c,d){null!=b._ActiveKeyboard&&"function"==typeof b._ActiveKeyboard.KNS&&b._ActiveKeyboard.KNS(a,c,d)};b._KeyDown=function(a){var c;b._KeyPressToSwallow=0;if(!b._Enabled||b._DisableInput||null==b._ActiveKeyboard||null!=b._ActiveControl&&!b._ActiveControl.LEnabled)return!0;var d=j.eventTarget(a);if(l.touchable){if(d&&"undefined"!=typeof d.kmwInput&&!1==d.kmwInput)return!0}else if(d&&0<=d.className.indexOf("kmw-disabled"))return!0;if(!h.ready)return!0;d=b._GetKeyEventProperties(a);if(null==d)return!0;
switch(d.Lcode){case 8:b._DeadKeys=[];break;case 16:case 17:case 18:return b._NotifyKeyboard(d.Lcode,d.Ltarg,1),h._UpdateVKShift(d,d.Lcode-15,1)}(c=d.Ltarg.ownerDocument)&&((c=c.selection)&&(33>d.Lcode||40<d.Lcode))&&c.createRange().select();!window.event&&b._VKMap_FF_IE["k"+d.Lcode]&&(d.Lcode=b._VKMap_FF_IE["k"+d.Lcode]);b._CachedSelectionStart=null;b._DeadkeyResetMatched();if(b._ActiveKeyboard.KM){if(8==d.Lcode)return b._KeyPressToSwallow=1,b._ActiveKeyboard.gs(d.Ltarg,d)||b.KO(1,b._LastActiveElement,
""),!1;b._KeyPressToSwallow=0}else{var e=0;if((c=b._VKMap[h._BaseLayout])&&c["k"+d.Lcode])d.Lcode=c["k"+d.Lcode];"undefined"==typeof b._ActiveKeyboard.KM&&!(d.Lmodifiers&96)&&(c={Lcode:b._USKeyCodeToCharCode(d),Ltarg:d.Ltarg,Lmodifiers:0,LisVirtualKey:0},b._ActiveKeyboard.gs(c.Ltarg,c)&&(e=1));b._CachedSelectionStart=null;b._DeadkeyResetMatched();e=e||b._ActiveKeyboard.gs(d.Ltarg,d);8==d.Lcode&&(!e&&null!=d.Ltarg.className&&0<=d.Ltarg.className.indexOf("keymanweb-input"))&&b.KO(1,b._LastActiveElement,
"")}!e&&(96<=d.Lcode&&111>=d.Lcode)&&(b.KO(0,d.Ltarg,String._kmwFromCharCode(106>d.Lcode?d.Lcode-48:d.Lcode-64)),e=1);if(e)return b._FindCaret(d.Ltarg),a&&a.preventDefault&&a.preventDefault(),b._KeyPressToSwallow=a?a.keyCode:0,!1;b._KeyPressToSwallow=0;return 8==d.Lcode&&null!=d.Ltarg.className&&0<=d.Ltarg.className.indexOf("keymanweb-input")?!1:!0};b._KeyPress=function(a){var c;if(!b._Enabled||b._DisableInput||null==b._ActiveKeyboard||null!=b._ActiveControl&&!b._ActiveControl.LEnabled)return!0;c=
b._GetKeyEventProperties(a);if(null==c||c.LisVirtualKey)return!0;if(!b._ActiveKeyboard.KM){if(!b._KeyPressToSwallow||32>c.Lcode||b._BrowserIsSafari&&63232<c.Lcode&&63744>c.Lcode)return!0;if(a=b._GetEventObject(a))a.returnValue=!1;return!1}b._CachedSelectionStart=null;b._DeadkeyResetMatched();if(b._KeyPressToSwallow||b._ActiveKeyboard.gs(c.Ltarg,c))return b._KeyPressToSwallow=0,a&&a.preventDefault&&a.preventDefault(),b._FindCaret(c.Ltarg),!1;b._KeyPressToSwallow=0;return!0};b._KeyUp=function(a){a=
b._GetKeyEventProperties(a);if(null==a||!h.ready)return!0;switch(a.Lcode){case 13:if("TEXTAREA"==a.Ltarg.nodeName)break;b.moveToNext(!1);return!0;case 16:case 17:case 18:return b._NotifyKeyboard(a.Lcode,a.Ltarg,0),h._UpdateVKShift(a,a.Lcode-15,1)}var c;if((c=a.Ltarg.ownerDocument)&&(c=c.selection)&&"control"!=c.type)c=c.createRange(),b._Selection=c;return!1};b.moveToNext=function(a){var c,d,e=[];for(c=0;c<b.inputList.length;c++)d=b.inputList[c],e.push({ip:d,x:j._GetAbsoluteX(d),y:j._GetAbsoluteY(d)});
e.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});for(c=0;c<e.length&&e[c].ip!=b._LastActiveElement;c++);for(var f=0;f<e.length&&!(a?c--:c++,0>c&&(c=e.length-1),c>=e.length&&(c=0),d=e[c].ip,"DIV"==d.nodeName&&(d=d.base),"TEXTAREA"==d.nodeName||"INPUT"==d.nodeName&&"text"==d.type.toLowerCase());f++);d=e[c].ip;d.focus();l.touchable&&b.scrollInput(d)};b.moveToElement=function(a){"string"==typeof a&&(a=document.getElementById(a));l.touchable&&a.kmw_ip?a.kmw_ip.focus():a.focus()};b.moveToFirst=function(){var a,
c,d=[];for(a=0;a<b.inputList.length;a++)c=b.inputList[a],d.push({ip:c,x:j._GetAbsoluteX(c),y:j._GetAbsoluteY(c)});d.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});l.touchable?(d[0].ip.focus(),b.scrollInput(c)):c.focus()};b._SetActiveKeyboard=function(a,c,d){var e,f,i;i=2>arguments.length||!c?"---":c;for(e=0;e<b._KeyboardStubs.length&&!(a==b._KeyboardStubs[e].KI&&(i==b._KeyboardStubs[e].KLC||"---"==i));e++);if(l.touchable&&(""==a||null==a||e>=b._KeyboardStubs.length))a=b._KeyboardStubs[0].KI,
i=b._KeyboardStubs[0].KLC;d&&b.saveCurrentKeyboard(a,i);if(!b._ActiveStub||!b._ActiveKeyboard||!(b._ActiveKeyboard.KI==a&&b._ActiveStub.KI==a&&b._ActiveStub.KLC==c&&""==l.app)){if(b._ActiveKeyboard&&b._ActiveKeyboard.KI==a)for(f=0;f<b._KeyboardStubs.length;f++)if(b._KeyboardStubs[f].KI==a&&b._KeyboardStubs[f].KLC==c){b._ActiveStub=b._KeyboardStubs[f];h.appendStyleSheet();("iPhone"==l.app||"iPad"==l.app)&&h._Load();return}b._ActiveKeyboard=null;b._ActiveStub=null;if(""==a)h._Hide(!1);else{for(f=0;f<
b._Keyboards.length;f++)if(b._Keyboards[f].KI==a){b._ActiveKeyboard=b._Keyboards[f];b._SetTargDir(b._LastActiveElement);for(e=0;e<b._KeyboardStubs.length;e++)if(b._KeyboardStubs[e].KI==a&&b._KeyboardStubs[e].KLC==c){b._ActiveStub=b._KeyboardStubs[e];break}break}if("undefined"==c||""==c)c="---";if(null==b._ActiveKeyboard){for(f=0;f<b._KeyboardStubs.length;f++)if(b._KeyboardStubs[f].KI==a&&(b._KeyboardStubs[f].KLC==c||"---"==c)){if(b.isCJK(b._KeyboardStubs[f])||l.touchable)h._Enabled=1;if(null==b._LoadingInternalName||
b._LoadingInternalName!=a){h.ready&&h._Hide(!1);b._LoadingInternalName=a;b.loadTimer="iPhone"==l.app||"iPad"==l.app?null:window.setTimeout(function(){j.wait(!1);var a=b._KeyboardStubs[f],d=a.KN,a=a.KL,d=d.replace(/\s*keyboard\s*/i,"");j.alert("Sorry, the "+d+" keyboard for "+a+" is not currently available!",b.setDfltKeyboard)},1E4);e="Installing keyboard<br/>"+b._KeyboardStubs[f].KN.replace(/\s*keyboard\s*/i,"");j.wait(e);e=j._CreateElement("SCRIPT");i=b._KeyboardStubs[f].KF;if(""==l.app)0>i.indexOf("/")&&
(0>i.indexOf("\\")&&"."!=i.charAt(0))&&(i=b.options.keyboards+i);else if("iPhone"==l.app||"iPad"==l.app)i=j.myPath()+"languages/"+i;e.src=i;e.type="text/javascript";try{document.body.appendChild(e)}catch(u){document.getElementsByTagName("head")[0].appendChild(e)}}b._ActiveStub=b._KeyboardStubs[f];return}b._SetTargDir(b._LastActiveElement)}e=b._ActiveKeyboard;null!==e&&String.kmwEnableSupplementaryPlane(e&&(e.KS&&1==e.KS||"Hieroglyphic"==e.KN));h._Load()}}};b.setDfltKeyboard=function(){b._SetActiveKeyboard("Keyboard_us",
"eng",!0);b.doKeyboardChange("Keyboard_us","eng",!0)};b.isCJK=function(a){var c=b._ActiveKeyboard,d="";0<arguments.length&&(c=a);c&&("undefined"!=typeof c.KLC?d=c.KLC:"undefined"!=typeof c.LanguageCode&&(d=c.LanguageCode));return"cmn"==d||"jpn"==d||"kor"==d};b.isCJK=b.isCJK;b.setActiveKeyboard=function(a,c){b.doBeforeKeyboardChange(a,c);b._SetActiveKeyboard(a,c,!0);null!=b._LastActiveElement&&b._FocusLastActiveElement();b.doKeyboardChange(a,c)};b.getActiveKeyboard=function(){return null==b._ActiveKeyboard?
"":b._ActiveKeyboard.KI};b.getActiveLanguage=function(){return null==b._ActiveStub?"":b._ActiveStub.KLC};b.getKeyboard=function(a,c){var d,e;for(d=0;d<b._KeyboardStubs.length;d++)if(e=b._GetKeyboardDetail(b._KeyboardStubs[d]),e.InternalName==a&&(2>arguments.length||e.LanguageCode==c))return e;return null};b.GetKeyboardDetail=function(a){for(var c=b.getKeyboards(),d=0;d<c.length;d++)if(c[d].InternalName==a)return c[d];return null};b._GetKeyboardDetail=function(a){var b=[];b.Name=a.KN;b.InternalName=
a.KI;b.LanguageName=a.KL;b.LanguageCode=a.KLC;b.RegionName=a.KR;b.RegionCode=a.KRC;b.CountryName=a.KC;b.CountryCode=a.KCC;b.KeyboardID=a.KD;b.Font=a.KFont;b.OskFont=a.KOskFont;return b};b.getKeyboards=function(){var a=[],c,d;for(c=0;c<b._KeyboardStubs.length;c++)d=b._KeyboardStubs[c],d=b._GetKeyboardDetail(d),a=b._push(a,d);return a};b._WindowUnload=function(){var a,c;for(a=0;a<b._EventHandlers.length;a++){c=b._EventHandlers[a];try{c.Lelem.detachEvent?c.Lelem.detachEvent("on"+c.Lname,c.Lhandler):
c.Lelem.removeEventListener(c.Lname,c.Lhandler,c.LuseCapture),c.Lhandler==b._ControlFocus&&(c.Lelem.onkeypress=c.Lelem.onkeydown=c.Lelem.onkeyup=null)}catch(d){}c.Lelem=0}b.doUnloadUI();h.ready&&h._Unload();b._EventHandlers=b._LastActiveElement=0};j.attachDOMEvent(window,"load",function(){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&(document.documentElement.scrollTop=0)},!1);j.attachDOMEvent(window,"unload",b._WindowUnload,!1);b._AttachToControls=function(a){for(var c=
a.getElementsByTagName("INPUT"),d=a.getElementsByTagName("TEXTAREA"),e=a.getElementsByTagName("IFRAME"),a=document.evaluate?document.evaluate('//*[@contenteditable and @contenteditable != "false"]',document,null,XPathResult.ANY_TYPE,null):null,f=0;f<c.length;f++)"text"==c[f].type.toLowerCase()&&b.attachToControl(c[f]);for(f=0;f<d.length;f++)b.attachToControl(d[f]);for(f=0;f<e.length;f++)try{e[f].contentWindow.document&&b._AttachToIframe(e[f])}catch(i){}if(a)for(c=a.iterateNext();c;c=a.iterateNext())b.attachToControl(c);
for(f=0;f<b.inputList.length;f++)b.attachToControl(b.inputList[f])};a=document.getElementsByTagName("script");b.srcPath=a[a.length-1].src;b.init=b.init=function(a){if("undefined"==typeof b.options.resources){var c="",d="",e="",f="";"string"==typeof window.KeymanWeb_Root&&(c=window.KeymanWeb_Root);"string"==typeof window.KeymanWeb_Resources&&(e=window.KeymanWeb_Resources);"string"==typeof window.KeymanWeb_Keyboards&&(f=window.KeymanWeb_Keyboards);"string"==typeof window.KeymanWeb_FontUriBasePath&&
(d=window.KeymanWeb_FontUriBasePath);var i={};i.root=c;i.resources=e;i.keyboards=f;i.fonts=d;i.key="";i.attachType=l.touchable?"manual":"auto";i.controlDownColor="#e0e0e0";i.keyDownColor="#c0c0ff";i.keyHoverColor="#e0e0ff";i.unmappedKeyboardName="English";i.defaultKeyboardHelp="Please wait while keyboard loads...";i.ui=l.touchable?"none":"";i.app="";b.options=i}else i=b.options;if(0<arguments.length&&"object"==typeof a&&null!=a)for(var u in i)a.hasOwnProperty(u)&&(i[u]=a[u]);""==i.root&&(i.root=j.myPath());
""==i.resources&&(i.resources=i.root+"engine/"+b.build+"/");""==i.keyboards&&(i.keyboards=i.root+"kbd/");i.resources=j.fixPath(i.resources);i.keyboards=j.fixPath(i.keyboards);i.fonts=j.fixPath(i.fonts);""!=i.app&&(l.touchable=!0,l.formFactor="phone",l.app=i.app,b.options.attachType=i.attachType="manual",navigator&&(navigator.userAgent&&0<=navigator.userAgent.indexOf("iPad"))&&(l.formFactor="tablet"));window.KeymanWeb_AttachType=i.attachType;window.KeymanWeb_ControlDownColor=i.controlDownColor;window.KeymanWeb_KeyDownColor=
i.keyDownColor;window.KeymanWeb_KeyHoverColor=i.keyHoverColor;window.KeymanWeb_DefaultKeyboardName=i.defaultKeyboardName;window.KeymanWeb_DefaultKeyboardHelp=i.defaultKeyboardHelp;window.KeymanWeb_Key=i.key;if(!b.initialized)if("complete"!==document.readyState)window.setTimeout(function(){b.init(a)},50);else{b._MasterDocument=window.document;b.getSavedKeyboard();if(l.touchable){d=document.getElementsByTagName("textarea");e=document.getElementsByTagName("input");for(c=0;c<d.length;c++)if(f=d[c],i=
f.className,f.kmwInput=!1,(!i||0>i.indexOf("kmw-disabled"))&&!f.readOnly)f.readOnly=!0,f.kmwInput=!0;for(c=0;c<e.length;c++)if(f=e[c],i=f.className,f.kmwInput=!1,(!i||0>i.indexOf("kmw-disabled"))&&!f.readOnly)if("text"==f.type||"search"==f.type)f.readOnly=!0,f.kmwInput=!0}0<=navigator.userAgent.indexOf("Android")&&(l.dpi=j.getDPI(),l.formFactor=screen.height<4*l.dpi||screen.width<4*l.dpi?"phone":"tablet");h.noShow=function(){};window.removeEventListener&&window.removeEventListener("focus",b._BubbledFocus,
!0);"manual"!=b.options.attachType&&b._AttachToControls(document);b.initialized=1;l.touchable||b.loadUI();h.prepare();for(c=0;c<b.deferredKRS.length;c++)b.KRS(b.deferredKRS[c]);b.initializeUI();j.prepareWait();for(c=0;c<b.deferredKR.length;c++)b.KR(b.deferredKR[c]);""==b.options.app&&(b.appliedFont=b.baseFont=b.getBaseFont(),l.touchable?b.setupTouchDevice():b.setupDesktopPage(),6==j._GetIEVersion()&&(h.shim=j.createShim()),l.touchable&&(h._Box.ontouchend=function(a){a.stopPropagation()},c=document.createElement("DIV"),
d=c.style,d.width="100%",d.height=screen.width/2+"px",document.body.appendChild(c)),h.shim&&document.body.appendChild(h.shim),document.selection&&!b.legacy&&j.attachDOMEvent(document,"selectionchange",b._SelectionChange),"manual"!=b.options.attachType&&(document.attachEvent?document.attachEvent("onfocusin",b._IEFocusIn):document.addEventListener&&document.addEventListener("DOMNodeInserted",b._DOMNodeInserted,!0)),b.restoreCurrentKeyboard(),b.initialized=2)}};b.loadUI=function(){var a=b.ui.name,c=
b.options;if("string"!=typeof a||""==a){a="";"string"==typeof c.ui?a=c.ui:"undefined"!=typeof c.ui.name&&(a=c.ui.name);for(var d=document.getElementsByTagName("SCRIPT"),e=0;e<d.length;e++)"kmw-ui-script"==d[e].id&&(a="");""!=a&&(d=j._CreateElement("SCRIPT"),d.id="kmw-ui-script",a=c.resources+("ui/"+a+"/")+("kmwui"+a+"-release.js"),d.src=a,d.type="text/javascript",document.body.appendChild(d))}};b.initializeUI=function(){"function"==typeof b.ui.initialize?(b.ui.initialize(),h._Show()):window.setTimeout(b.initializeUI,
1E3)};b._SelPos=function(a){var c,d=999>j._GetIEVersion();if(l.touchable)return b.getTextCaret(a);if(a._KeymanWebSelectionStart)return a._KeymanWebSelectionStart;if(a.setSelectionRange)return a.value.substr(0,a.selectionStart)._kmwLength();if((c=a.ownerDocument)&&(c=c.defaultView)&&c.getSelection&&"on"==a.ownerDocument.designMode.toLowerCase()){if(a=c.getSelection(),3==a.focusNode.nodeType)return a.focusNode.substringData(0,a.focusOffset)._kmwLength()}else if(d){if("string"==typeof a.value)return c=
b.getInputSelection(a),a.value.substr(0,c.start)._kmwLength();if(a=a.body?a:a.ownerDocument)c=a.selection;else return 0;a=c.createRange();a.moveStart("textedit",-1);return a.text._kmwLength()}return 0};b.getInputSelection=function(a){var b=0,d=0,e="",f,i=0;if("number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd)b=a.selectionStart,d=a.selectionEnd;else if((f=document.selection.createRange())&&f.parentElement()==a)i=a.value.length,e=a.value.replace(/\r\n/g,"\n"),d=a.createTextRange(),
d.moveToBookmark(f.getBookmark()),a=a.createTextRange(),a.collapse(!1),-1<d.compareEndPoints("StartToEnd",a)?b=d=i:(b=-d.moveStart("character",-i),b+=e.slice(0,b).split("\n").length-1,-1<d.compareEndPoints("EndToEnd",a)?d=i:(d=-d.moveEnd("character",-i),d+=e.slice(0,d).split("\n").length-1));return{start:b,end:d}};b._DeadkeyResetMatched=function(){var a,c=b._DeadKeys;for(a=0;a<c.length;a++)c[a].matched=0};b._DeadkeyDeleteMatched=function(){var a,c=b._DeadKeys;for(a=0;a<c.length;a++)c[a].matched&&
c.splice(a,1)};b._DeadkeyAdjustPos=function(a,c){var d,e=b._DeadKeys;for(d=0;d<e.length;d++)e[d].p>a&&(e[d].p+=c)};b._SetTargDir=function(a){var c=null!=b._ActiveKeyboard&&b._ActiveKeyboard.KRTL?"rtl":"ltr";a&&""==l.app&&(l.touchable?0==a.textContent.length&&(a.base.dir=a.dir=c,b.setTextCaret(a,1E4)):0==a.value.length&&(a.dir=c))};b._IEFocusIn=function(){var a=b._GetEventObject(null);a&&(a=a.srcElement,null!=a&&!b._IsAttached(a)&&("input"==a.tagName.toLowerCase()&&"text"==a.type.toLowerCase()||"textarea"==
a.tagName.toLowerCase()||"iframe"==a.tagName.toLowerCase())&&b.attachToControl(a))};b._DOMNodeInserted=function(a){a=a.target;null!=a&&1==a.nodeType&&b._AttachToControls(a)};b._ResetVKShift=function(){b._IsActivatingKeymanWebUI||h._UpdateVKShift&&h._UpdateVKShift(null,15,0)};b.addHotKey=b.addHotKey=function(a,c,d){for(var e=0;e<b._HotKeys.length;e++)if(b._HotKeys[e].Code==a&&b._HotKeys[e].Shift==c){b._HotKeys[e].Handler=d;return}b._HotKeys.push({Code:a,Shift:c,Handler:d})};b.removeHotKey=b.removeHotKey=
function(a,c){for(var d=0;d<b._HotKeys.length;d++)if(b._HotKeys[d].Code==a&&b._HotKeys[d].Shift==c){b._HotKeys.splice(d,1);break}};b._ProcessHotKeys=function(a){a||(a=window.event);if(a.keyCode)var c=a.keyCode;else if(a.which)c=a.which;else return 0;for(var d=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),e=0;e<b._HotKeys.length;e++)if(c==b._HotKeys[e].Code&&d==b._HotKeys[e].Shift)return b._HotKeys[e].Handler(),a.returnValue=0,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0};
j.attachDOMEvent(document,"keyup",b._ProcessHotKeys,!1);b.saveCurrentKeyboard=function(a,b){j.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b})};b.restoreCurrentKeyboard=function(){var a=b._KeyboardStubs,c,d=a.length;if(!(1>a.length)){c=b.getSavedKeyboard();var e=c.split(":"),e=c.split(":");2>e.length&&(e[1]="");for(c=0;c<d&&!(a[c].KI==e[0]&&(a[c].KLC==e[1]||""==e[1]));c++);if(c<d||null==b._ActiveKeyboard)b._SetActiveKeyboard(e[0],e[1],!1),b.doKeyboardChange(e[0],e[1])}};b.getSavedKeyboard=b.getSavedKeyboard=
function(){var a=j.loadCookie("KeymanWeb_Keyboard");return"string"==typeof a.current?a.current:"Keyboard_us:eng"};b.addEventListener=function(a,b){return j.addEventListener("kmw."+a,b)};j.attachDOMEvent(window,"focus",b._ResetVKShift,!1);j.attachDOMEvent(window,"blur",b._ResetVKShift,!1);b.rotateDevice=function(){h.hideLanguageList();h._Visible&&(h.anchored=!1,"iOS"!=l.OS&&(h.hideNow(),h.resetRowLengths(),window.setTimeout(function(){h._Show()},500)));"phone"==l.formFactor&&"Android"==l.OS&&window.setTimeout(function(){window.scrollTo(0,
1)},1E3)};l.touchable&&j.attachDOMEvent(window,"resize",b.rotateDevice);String.kmwEnableSupplementaryPlane(!1)})();(function(){var b=window.tavultesoft.keymanweb,h={K_BACK:8,K_BKSP:8,K_TAB:9,K_CLEAR:12,K_ENTER:13,K_RETURN:13,K_SHIFT:16,K_CONTROL:17,K_MENU:18,K_PAUSE:19,K_CAPS:20,K_CAPITAL:20,K_HANGUL:21,K_KANA:21,K_JUNJA:23,K_FINAL:24,K_HANJA:25,K_KANJI:25,K_ESCAPE:27,K_SPACE:32,K_PRIOR:33,K_NEXT:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SELECT:41,K_PRINT:42,K_EXECUTE:43,K_SNAPSHOT:44,K_INSERT:45,K_DELETE:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,
K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_LWIN:91,K_LOPT:91,K_RWIN:92,K_ROPT:92,K_APPS:93,K_SLEEP:95,K_NUMPAD0:96,K_NUMPAD1:97,K_NUMPAD2:98,K_NUMPAD3:99,K_NUMPAD4:100,K_NUMPAD5:101,K_NUMPAD6:102,K_NUMPAD7:103,K_NUMPAD8:104,K_NUMPAD9:105,K_MULTIPLY:106,K_ADD:107,K_SEPARATOR:108,K_SUBTRACT:109,K_DECIMAL:110,K_DIVIDE:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,
K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LMENU:164,K_LALT:164,K_RMENU:165,K_RALT:165,K_OEM_1:186,K_COLON:186,K_SEMICOLON:186,K_OEM_PLUS:187,K_EQUAL:187,K_PLUS:187,K_COMMA:188,K_OEM_COMMA:188,K_OEM_MINUS:189,K_HYPHEN:189,K_PERIOD:190,K_OEM_PERIOD:190,K_OEM_2:191,K_SLASH:191,K_QUERY:191,K_OEM_3:192,K_ACCENT:192,K_BKQUOTE:192,K_GRAVE:192,K_OEM_4:219,K_LBRKT:219,K_LBRACE:219,K_OEM_5:220,K_BKSLASH:220,
K_BAR:220,K_OEM_6:221,K_RBRKT:221,K_RBRACE:221,K_OEM_7:222,K_QUOTE:222,K_SQUOTE:222,K_DQUOTE:222,K_OEM_8:223,K_OEM_AX:225,K_OEM_102:226,K_oE2:226,K_TABBACK:257,K_TABFWD:258,K_UPPER:259,K_LOWER:260,K_NUMERALS:261,K_SYMBOLS:262,K_CURRENCIES:263,K_SHIFTED:264,K_ALTGR:265},j=[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']],l="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" "),
a=b.osk,g=b.util,c=g.device;a._Box=null;a._DivVKbd=null;a._DivVKbdHelp=null;a._Visible=0;a._Enabled=1;a._VShift=[];a._VKeySpans=[];a._VKeyDown=null;a._VKbdContainer=null;a._VOriginalWidth=1;a._BaseLayout="us";a._BaseLayoutEuro={};a._BaseLayoutEuro.se="\u00a71234567890+\u00b4~~~QWERTYUIOP\u00c5\u00a8'~~~ASDFGHJKL\u00d6\u00c4~~~~~<ZXCVBNM,.-~~~~~ ";a._BaseLayoutEuro.uk="`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;'~~~~~\\ZXCVBNM,./~~~~~ ";a.lgTimer=null;a.lgKey=null;a.hkKey=null;a.spaceBar=null;a.lgList=
null;a.frameColor="#ad4a28";a.keyPending=null;a.fontFamily="";a.layers=null;a.layerId="default";a.nextLayer="default";a.anchored=!1;a.layerIndex=0;a.currentKey="";a.subkeyDelayTimer=null;a.styleSheet=null;a.loadRetry=0;a.x=99;a.y=0;a.width=1;a.height=1;a.closeButton=null;a.resizeIcon=null;a.resizing=0;a.pinImg=null;a.userPositioned=0;a.dfltX="";a.dfltY="";a.noDrag=!1;a.shim=null;a.addEventListener=function(a,b){return g.addEventListener("osk."+a,b)};a._TitleBarInterior=function(){var d=g._CreateElement("DIV"),
e=d.style;e.paddingLeft="2px";e.cursor="move";e.background="#ad4a28";e.font="8pt Tahoma,Arial,sans-serif";e=g._CreateElement("DIV");e.className="kmw-title-bar-actions";e.onmousedown=a._CancelMouse;var f=g._CreateElement("DIV");f.className="kmw-close-button";f.onmousedown=a._CancelMouse;f.onclick=function(){a._Hide(!0)};a.closeButton=f;e.appendChild(f);a.restorePosition=function(){a._Visible&&(b._FocusLastActiveElement(),a.loadCookie(),a.userPositioned=!1,a.saveCookie(),a._Show(),a.doResizeMove());
a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1)};f=a.pinImg=g._CreateElement("DIV");f.className="kmw-pin-image";f.title="Pin the On Screen Keyboard to its default location on the active text box";f.onclick=a.restorePosition;f.onmousedown=a._CancelMouse;f.style.display="none";c.touchable||e.appendChild(f);d.appendChild(e);f=b._TitleElement=g._CreateElement("SPAN");f.className="kmw-title-bar-caption";f.innerHTML="Tavultesoft KeymanWeb";d.appendChild(f);return d};
a.isEnabled=a.isEnabled=function(){return a._Enabled};a.isVisible=a.isVisible=function(){return a._Visible};a.getRect=a.getRect=function(){var b={};a._DivVKbd?(b.left=b.left=g._GetAbsoluteX(a._DivVKbd),b.top=b.top=g._GetAbsoluteY(a._DivVKbd),b.width=b.width=g._GetAbsoluteX(a._DivVKbdHelp)-g._GetAbsoluteX(a._DivVKbd)+a._DivVKbdHelp.offsetWidth,b.height=b.height=g._GetAbsoluteY(a._DivVKbdHelp)-g._GetAbsoluteY(a._DivVKbd)+a._DivVKbdHelp.offsetHeight):(b.left=b.left=g._GetAbsoluteX(a._Box),b.top=b.top=
g._GetAbsoluteY(a._Box),b.width=b.width=g._GetAbsoluteX(a._Box)+a._Box.offsetWidth,b.height=b.height=g._GetAbsoluteY(a._Box)+a._Box.offsetHeight);return b};a.setRect=a.setRect=function(b){if(!(null==a._Box||"desktop"!=c.formFactor)){var e=a._Box,f=e.style;"left"in b&&(f.left=b.left-g._GetAbsoluteX(e)+e.offsetLeft+"px",a.dfltX=f.left);"top"in b&&(f.top=b.top-g._GetAbsoluteY(e)+e.offsetTop+"px",a.dfltY=f.top);if(null!=a._DivVKbd){var i=a._DivVKbd,f=i.style;if("width"in b){var h=b.width-(e.offsetWidth-
i.offsetWidth);h<0.2*screen.width&&(h=0.2*screen.width);h>0.9*screen.width&&(h=0.9*screen.width);f.width=h+"px";a.width=h}"height"in b&&(e=b.height-(e.offsetHeight-i.offsetHeight),e<0.1*screen.height&&(e=0.1*screen.height),e>0.5*screen.height&&(e=0.5*screen.height),f.height=e+"px",f.fontSize=e/8+"px",a.height=e);"nosize"in b&&a.resizeIcon&&(a.resizeIcon.style.display=b.nosize?"none":"block")}"nomove"in b&&(a.noDrag=b.nomove,a.pinImg&&(a.pinImg.style.display=b.nomove||!a.userPositioned?"none":"block"));
a.saveCookie()}};a.getPos=function(){var b=a._Box,e={};e.left=a._Visible?b.offsetLeft:a.x;e.top=a._Visible?b.offsetTop:a.y;return e};a.setPos=a.setPos=function(b){if(!("undefined"==typeof a._Box||c.touchable)){if(a.userPositioned){var e=b.left,b=b.top;"undefined"!=typeof e&&(e<-0.8*a._Box.offsetWidth&&(e=-0.8*a._Box.offsetWidth),a.userPositioned&&(a._Box.style.left=e+"px",a.x=e));"undefined"!=typeof b&&(0>b&&(b=0),a.userPositioned&&(a._Box.style.top=b+"px",a.y=b))}a.pinImg&&(a.pinImg.style.display=
a.userPositioned?"block":"none")}};a._VKeyGetTarget=function(a){a=b._GetEventObject(a);if(!a)return null;if(a.target)a=a.target;else if(a.srcElement)a=a.srcElement;else return null;3==a.nodeType&&(a=a.parentNode);"SPAN"==a.tagName&&(a=a.parentNode);return a};a.touchKey=function(d,e){e.preventDefault();e.cancelBubble=!0;"function"==typeof e.stopImmediatePropagation?e.stopImmediatePropagation():"function"==typeof e.stopPropagation&&e.stopPropagation();if(!("object"==typeof e.touches&&1<e.touches.length)){var c=
d.id.split("-")[1];"K_LOPT"==c||"K_ROPT"==c?(a.highlightKey(d,!0),window.setTimeout(function(){a.clickKey(d)},0)):"K_BKSP"==c?(a.highlightKey(d,!0),b.KO(1,b._LastActiveElement,""),a.deleting=!0,window.setTimeout(a.repeatDelete,500)):null==a.keyPending&&(a.keyPending=d,a.highlightKey(d,!0),null!=d.subKeys&&(a.subkeyDelayTimer=window.setTimeout(function(){a.showSubKeys(d)},100)))}};a.repeatDelete=function(){a.deleting&&(b.KO(1,b._LastActiveElement,""),window.setTimeout(a.repeatDelete,200))};a.highlightKey=
function(a,b,c){var g=a.className,h=2<arguments.length?" "+arguments[2]:" kmw-key-touched";""!=g&&(0<=g.indexOf(h)?b||(a.className=g.replace(h,"")):b&&(a.className=g+h))};a.moveOverKeys=function(b,e){e.preventDefault();e.cancelBubble=!0;"function"==typeof e.stopImmediatePropagation?e.stopImmediatePropagation():"function"==typeof e.stopPropagation&&e.stopPropagation();if(null!=a.keyPending){var c="object"==typeof e.touches?e.touches[0].clientX:e.clientX,i="object"==typeof e.touches?e.touches[0].clientY:
e.clientY,h=g._GetAbsoluteX(b),j=g._GetAbsoluteY(b),k=h+b.offsetWidth,l=j+b.offsetHeight,m=b.id.split("-")[1];"K_LOPT"!=m&&"K_ROPT"!=m&&a.highlightKey(b,c>h&&c<k&&i>j&&i<l);if(null!=b.subKeys){var p,q,x;x=document.getElementById("kmw-popup-keys");for(m=0;m<b.subKeys.length;m++)try{p=x.childNodes[m].firstChild,h=g._GetAbsoluteX(p),j=g._GetAbsoluteY(p),k=h+p.offsetWidth,l=j+p.offsetHeight,q=c>h&&c<k&&i>j&&i<l,a.highlightKey(p,q),q&&a.highlightKey(b,!1)}catch(z){}}}};a.showSubKeys=function(b){if(null!=
a.keyPending){var e=document.createElement("DIV"),f,i,h,j,k,l;e.id="kmw-popup-keys";f=e.style;f.bottom=parseInt(b.style.bottom,10)+parseInt(b.style.height,10)+10+"px";f.fontFamily=a.fontFamily;f.fontSize=g.getStyleValue(b,"font-size");f.visibility="hidden";var m=b.subKeys.length,p,q;p=Math.min(Math.ceil(m/9),2);q=Math.ceil(m/p);1<p&&(f.width=q*b.offsetWidth+5*q+"px");for(f=0;f<m;f++)i=b.subKeys[f],k=document.createElement("DIV"),k.className="kmw-key-square-ex",k.keyId=i.id,h=k.style,j=Math.floor(f/
q),1<p&&0<j&&(h.marginTop="5px"),k.width="undefined"!=typeof i.width?h.width=parseInt(i.width,10)*b.offsetWidth/100+"px":h.width=b.offsetWidth+"px",h.height=b.offsetHeight+"px",l=document.createElement("DIV"),a.setButtonClass(i,l),l.id="subkey-"+i.id,j=l.style,j.height=h.height,j.width=h.width,h=g._CreateElement("SPAN"),h.className="kmw-key-text",null==i.text||""==i.text?(h.innerHTML="\u00a0","string"==typeof i.id&&/^K_[0-9A-F]{4}$/i.test(i.id)&&(h.innerHTML=String.fromCharCode(parseInt(i.id.substr(2),
16)))):h.innerHTML=i.text,j=h.style,"string"==typeof i.font&&""!=i.font&&(j.fontFamily=i.font),"string"==typeof i.fontsize&&0!=i.fontsize&&(j.fontSize=i.fontsize),l.appendChild(h),k.appendChild(l),e.appendChild(k);""!=c.app&&"function"==typeof window.oskCreatePopup?(e=g._GetAbsoluteX(b)-g._GetAbsoluteX(a._DivVKbd)+b.offsetWidth/2,m=g._GetAbsoluteY(b)-g._GetAbsoluteY(a._DivVKbd),window.oskCreatePopup(b.subKeys,e,m)):(a._Box.appendChild(e),f=e.style,m=g._GetAbsoluteX(b)+0.5*(b.offsetWidth-e.offsetWidth),
p=(g.landscapeView()?screen.height:screen.width)-e.offsetWidth,m>p&&(m=p),0>m&&(m=0),f.left=m+"px",h=document.createElement("DIV"),h.className="arrow-border",j=h.style,m=g._GetAbsoluteX(b)+0.5*b.offsetWidth-16,j.left=m+"px",j.top=e.offsetTop+e.offsetHeight-2+"px",b=document.createElement("DIV"),b.className="arrow-content",j=b.style,j.left=m+3+"px",j.top=h.style.top,h.appendChild(b),e.appendChild(h),f.visibility="visible")}};a.getVKDictionaryCode=function(a){if(!b._ActiveKeyboard.VKDictionary){var e=
[];if("string"==typeof b._ActiveKeyboard.KVKD)for(var c=b._ActiveKeyboard.KVKD.split(" "),g=0;g<c.length;g++)e[c[g]]=g+256;b._ActiveKeyboard.VKDictionary=e}e=b._ActiveKeyboard.VKDictionary[a];if(!e){e=b._ActiveKeyboard.VKDictionary;c=0;for(g in e)e[g]>c&&(c=e[g]);256>c?c=256:c++;e=e[a]=c}return e?e:null};a.clickKey=function(d){var e=b._LastActiveElement,f,g,u,o=d.id.split("-");if(2>o.length)return!0;if(null!=e){var k=o[1];f=o=a.getModifierState(a.layerId);"undefined"!=typeof d.key&&(f=d.key.nextlayer);
null==b._ActiveElement&&(b._ActiveElement=e);switch(k){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":return a.highlightKey(d,!1),a.updateLayer(f?f:"shift"),a._Show(),!0;case "K_LCONTROL":case "K_RCONTROL":case "K_LCTRL":case "K_RCTRL":case "K_CTRL":return a.highlightKey(d,!1),a.updateLayer(f?f:"ctrl"),a._Show(),!0;case "K_LALT":case "K_RALT":case "K_ALT":return a.highlightKey(d,!1),a.updateLayer(f?f:"alt"),a._Show(),!0;case "K_ALTGR":return a.highlightKey(d,!1),a.updateLayer(f?f:"ctrlalt"),a._Show(),
!0;case "K_LOPT":return""==c.app?a.showLanguageMenu():"showKeyboardList"in b&&b.showKeyboardList(),!0;case "K_ROPT":return""==c.app?(b._IsActivatingKeymanWebUI=0,a._Hide(!1),b.hideCaret(),b._LastActiveElement=0):"hideKeyboard"in b&&b.hideKeyboard(),!0;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":return a.highlightKey(d,!1),a.updateLayer(f?f:"default"),a._Show(),!0}a.highlightKey(d,!1);if("K_SPACE"!=k&&(g=d.childNodes[0].innerHTML,""==g||"&nbsp;"==
g))return!0;f=e._KeymanWebSelectionStart;g=e._KeymanWebSelectionEnd;u=b._Selection;b._IsActivatingKeymanWebUI=1;b._IgnoreNextSelChange=100;b._FocusLastActiveElement();b._IsMozillaEditableIframe(e,0)&&(e=e.documentElement);document.selection&&null!=u&&u.select();e._KeymanWebSelectionStart=f;e._KeymanWebSelectionEnd=g;b._IgnoreNextSelChange=0;b._CachedSelectionStart=null;b._DeadkeyResetMatched();f={Ltarg:e,Lmodifiers:0,Lcode:h[k],LisVirtualKey:1};"undefined"==typeof f.Lcode&&(f.Lcode=a.getVKDictionaryCode(k),
null==f.Lcode&&(f.Lcode=parseInt(k.substr(2),6>k.length?10:16)));g="undefined"==typeof d.key?null:d.key.layer;null!=g&&(o=a.getModifierState(g));f.Lmodifiers=16*o;b._ActiveKeyboard&&b._ActiveKeyboard.KM?(g=d.firstChild.firstChild.wholeText,f.LisVirtualKey=!1,f.LisVirtualKeyCode=!1,f.vkCode=f.Lcode,32!=f.Lcode&&(f.Lcode="string"==typeof g&&""!=g?g.charCodeAt(0):0,160==f.Lcode&&(f.Lcode=0)),f.Lmodifiers=0):f.vkCode=f.Lcode;"undefined"==typeof b._ActiveKeyboard.KM&&(f.Lcode=b._USKeyCodeToCharCode(f),
f.LisVirtualKey=0);if(!b._ActiveKeyboard||0!=f.Lcode&&!b._ActiveKeyboard.gs(e,f))switch(f.Lcode=f.vkCode,k){case "K_BKSP":b.KO(1,b._LastActiveElement,"");break;case "K_TAB":b.moveToNext("shift"==a.layerId);break;case "K_TABBACK":b.moveToNext(!0);break;case "K_TABFWD":b.moveToNext(!1);break;case "K_ENTER":"TEXTAREA"==e.nodeName||"undefined"!=typeof e.base&&"TEXTAREA"==e.base.nodeName?b.KO(0,e,"\n"):b.moveToNext(!1);break;case "K_SPACE":b.KO(0,e," ");break;default:k=0,f=f.Lcode,255<f?k=d.firstChild.childNodes[0].wholeText:
48<=f&&57>=f?k=j[o][0][f-48]:65<=f&&90>=f?k=String.fromCharCode(f+(o?0:32)):186<=f&&192>=f?k=j[o][1][f-186]:219<=f&&222>=f&&(k=j[o][2][f-219]),k&&b.KO(0,e,k)}"undefined"!=typeof d.key&&null!==d.key.nextlayer&&(a.nextLayer=d.key.nextlayer);a.nextLayer!=a.layerId&&(a.layerId=a.nextLayer,a._Show());e._KeymanWebSelectionStart=null;e._KeymanWebSelectionEnd=null}b._IsActivatingKeymanWebUI=0;return!0};a.getLayerId=function(a){var b="";if(0==a)return"default";a&1&&(b="shift");a&4&&(b="alt"+b);a&2&&(b="ctrl"+
b);return b};a.getModifierState=function(a){var b=0;0<=a.indexOf("shift")&&(b+=1);0<=a.indexOf("ctrl")&&(b+=2);0<=a.indexOf("alt")&&(b+=4);return b};a.updateLayer=function(b){var e=a.layerId;if("default"==a.layerId||"numeric"==a.layerId||"symbol"==a.layerId||"currency"==a.layerId)e=b;else{var c=a.getModifierState(e),e=e.replace("shift",""),e=e.replace("ctrl",""),e=e.replace("alt","");switch(b){case "shift":c^=1;break;case "ctrl":c^=2;break;case "alt":c^=4;break;default:e=b}"default"!=e&&(c&1&&(e=
"shift"+e),c&2&&(e="ctrl"+e),c&4&&(e="alt"+e))}""==e&&(e="default");a.layerId=e.replace("altctrl","ctrlalt")};a.showLanguage=function(){var d="",e="";b._ActiveStub?(d=b._ActiveStub.KL,e=b._ActiveStub.KN):d=b._ActiveLanguage?b._ActiveLanguage.KN:"English";try{var c=a.spaceBar.firstChild.firstChild;c.className="kmw-spacebar-caption";e=e.replace(/\s*keyboard\s*/i,"");c.innerHTML=e==d?d:d+" ("+e+")"}catch(g){}};a.releaseKey=function(b,e){e.preventDefault();e.cancelBubble=!0;"function"==typeof e.stopImmediatePropagation?
e.stopImmediatePropagation():"function"==typeof e.stopPropagation&&e.stopPropagation();a.subkeyDelayTimer&&window.clearTimeout(a.subkeyDelayTimer);a.lgTimer&&window.clearTimeout(a.lgTimer);a.subkeyDelayTimer=a.lgTimer=null;e.target.id&&0<=e.target.id.indexOf("K_BKSP")?a.highlightKey(e.target,!1):e.target.parentNode.id&&0<=e.target.parentNode.id.indexOf("K_BKSP")&&a.highlightKey(e.target.parentNode,!1);a.deleting=!1;if(null!==a.keyPending){var c=null;"undefined"!=typeof e.changedTouches&&0<e.changedTouches.length?
c=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY):"undefined"!=typeof e.target&&(c=e.target);null!=c&&((""==c.id&&(c=c.parentNode),c==a.keyPending||"kmw-popup-keys"==c.parentNode.parentNode.id)?(a.clickKey(c),a.keyPending=null):a.highlightKey(a.keyPending,!1));a.keyPending=null}c=document.getElementById("kmw-popup-keys");null!=c&&c.parentNode.removeChild(c)};a.showLanguageMenu=function(){var d=b._KeyboardStubs,e=d.length;if(!(1>e)){var c=a.lgList=g._CreateElement("DIV");
a.lgList.id="kmw-language-menu";c.shim=g._CreateElement("DIV");c.shim.id="kmw-language-menu-background";c.shim.addEventListener("touchstart",function(b){b.preventDefault();a.hideLanguageList();if(1<b.touches.length){var d=b.touches[1].pageX,b=b.touches[1].pageY;d>a.hkKey.offsetLeft&&(d<a.hkKey.offsetLeft+a.hkKey.offsetWidth&&b>a.hkKey.offsetTop&&b<a.hkKey.offsetTop+a.hkKey.offsetHeight)&&a.showBuild()}},!1);document.body.appendChild(c.shim);var i=g._CreateElement("DIV"),h=i.style,j=g._CreateElement("DIV");
i.id="kmw-menu-scroll-container";j.id="kmw-menu-scroller";"WebkitOverflowScrolling"in h&&(h.WebkitOverflowScrolling="touch");i.appendChild(j);c.appendChild(i);var k,l,m=g._CreateElement("DIV");m.id="kmw-menu-index";for(k=1;26>=k;k++)l=g._CreateElement("P"),l.innerHTML=String.fromCharCode(k+64),m.appendChild(l);m.ontouchstart=function(b){a.scrollToLanguage(b,i,j)};c.appendChild(m);c.addEventListener("scroll",function(){a.lgList.scrolling=true},!1);i.addEventListener("scroll",function(){if(i.scrollTop<
1)i.scrollTop=1;if(i.scrollTop>i.scrollHeight-i.offsetHeight-1)i.scrollTop=i.scrollHeight-i.offsetHeight-1},!1);a.lgList.activeLgNo=a.addLanguagesToMenu(j,d);a.lgList.visibility="hidden";document.body.appendChild(a.lgList);k=c.style;e*=j.firstChild.offsetHeight;d=g.windowHeight()-a.lgKey.offsetHeight-16;c.firstY=0;k.left=g._GetAbsoluteX(a.lgKey)+"px";e<d?(k.top=window.pageYOffset+(d-e)+10+"px",k.height=e+"px"):(k.top=window.pageYOffset+10+"px",k.height=d+"px");m.style.height=h.height=k.height;h=Math.floor(c.offsetHeight/
26);e=Math.round(100*h/(m.childNodes[1].offsetTop-m.childNodes[0].offsetTop))/100;d=0.6<e?1:2;1.25<e&&(e=1.25);for(k=0;26>k;k++)l=m.childNodes[k].style,2==d&&1==k%2?l.display="none":(l.fontSize=e*d+"em",l.lineHeight=h*d+"px");k=i.offsetWidth;i.scrollHeight>i.offsetHeight+2?k+=m.offsetWidth:m.style.display="none";c.style.width=k+"px";a.lgList.visibility="";c=j.firstChild.offsetHeight*a.lgList.activeLgNo+1;i.scrollTop=c;i.scrollTop<c&&(i.scrollTop=i.scrollHeight-i.offsetHeight);i.scrollTop>i.scrollHeight-
i.offsetHeight-1&&(i.scrollTop=i.scrollHeight-i.offsetHeight-1)}};a.scrollToLanguage=function(a,b,c){a.stopImmediatePropagation();a.preventDefault();if("P"==a.touches[0].target.nodeName){var g,h,j=0,a=a.touches[0].target.innerHTML.charCodeAt(0),k=c.childNodes;try{for(g=0;g<k.length-1&&!(h=k[g].firstChild.innerHTML.toUpperCase().charCodeAt(0),h>=a);g++);}catch(l){}try{j=c.firstChild.offsetHeight*g+1,b.scrollTop=j}catch(m){j=0}try{if(b.scrollTop<j&&(b.scrollTop=b.scrollHeight-b.offsetHeight),b.scrollTop>
b.scrollHeight-b.offsetHeight-1)b.scrollTop=b.scrollHeight-b.offsetHeight-1}catch(p){}}};a.addLanguagesToMenu=function(d,c){var f=c.length,i,h,j,k=[];for(h=0;h<f;h++)j=c[h].KL,-1==k.indexOf(j)&&k.push(j);k.sort();var l,m,p;j=-1;for(i=0;i<k.length;i++){l=g._CreateElement("DIV");l.className="kbd-list-closed";m=g._CreateElement("P");m.kList=[];for(h=0;h<f;h++)c[h].KL==k[i]&&m.kList.push(c[h]);l.appendChild(m);d.appendChild(l);k[i]==b._ActiveStub.KL&&(j=i);if(1<m.kList.length){m.className="kbd-list";
m.innerHTML=k[i]+"...";m.scrolled=!1;m.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed"};m.ontouchstart=function(a){a.stopPropagation()};m.ontouchmove=function(a){a.target.scrolled=!0;a.stopPropagation()};for(h=0;h<m.kList.length;h++)p=g._CreateElement("P"),p.className="kbd-list-entry",a.addKeyboardToMenu(m.kList[h],p,!1),l.appendChild(p)}else m.innerHTML=
k[i],m.className="kbd-single-entry",a.addKeyboardToMenu(m.kList[0],m,!0);i==j&&(m.className+=" current")}f=g._CreateElement("DIV");f.id="kmw-menu-footer";f.ontouchstart=f.ontouchmove=f.ontouchend=function(a){a.preventDefault();a.stopPropagation()};d.appendChild(f);return j};a.addKeyboardToMenu=function(d,c,f){c.kn=d.KI;c.kc=d.KLC;c.innerHTML=f?d.KL:d.KN.replace(" Keyboard","");c.onmspointerdown=c.ontouchstart=function(b){b.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=
" selected");a.lgList.scrolling=!1;a.lgList.y0=b.touches[0].pageY;return!0};c.onmspointermove=c.ontouchmove=function(b){b.stopImmediatePropagation();var d=a.lgList.childNodes[0],c=d.scrollHeight-d.offsetHeight,e=b.touches[0].pageY,f=e-a.lgList.y0;if(0>f)d.scrollTop>=c-1&&(b.preventDefault(),a.lgList.y0=e);else if(0<f)2>d.scrollTop&&(b.preventDefault(),a.lgList.y0=e);else return;if(-5>f||5<f)a.lgList.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),a.lgList.y0=e;return!0};c.onmspointerout=
c.ontouchend=function(d){d.preventDefault();"undefined"!=typeof d.stopImmediatePropagation?d.stopImmediatePropagation():d.stopPropagation();a.lgList.scrolling?this.className=this.className.replace(/\s*selected/,""):(a.lgList.style.display="none",b._SetActiveKeyboard(this.kn,this.kc,!0),b._FocusLastActiveElement(),a.hideLanguageList(),a._Show());return!0}};a.hideLanguageList=function(){a.lgList&&(a.highlightKey(a.lgKey.firstChild,!1),a.lgList.style.visibility="hidden",window.setTimeout(function(){document.body.removeChild(a.lgList.shim);
document.body.removeChild(a.lgList);a.lgList=null},500))};a._UpdateVKShift=function(b,c,f){var g=0,g=b?b.Lmodifiers/16:f?g|c:g&~c;a.layerId=a.getLayerId(g);a._Visible&&a._Show();return!0};a._CancelMouse=function(a){(a=b._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};a.showLayer=function(d){if(b._ActiveKeyboard)for(var c=0;c<a.layers.length;c++)if(a.layers[c].id==d)return a.layerId=d,a._Show(),!0;return!1};a.deviceDependentLayout=function(b){var e=
g._CreateElement("DIV"),f=e.style,i=0;e.className="kmw-key-layer-group";switch(c.formFactor){case "phone":f.fontSize="0.6em";case "tablet":i=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2),"Android"==c.OS&&"undefined"!=typeof window.devicePixelRatio&&0<window.devicePixelRatio&&(i/=window.devicePixelRatio),f.height=i+"px"}var j,o,k,l,m,p,q,x,z,r,n,A,D,v,t,s,B;l=b.layer;var F={text:"",fontsize:"1em",width:"100",pad:"5",sp:"0",layer:null,nextlayer:null};for(j=0;j<l.length;j++){m=l[j];m.aligned=
!1;p=g._CreateElement("DIV");B=p.style;p.className="kmw-key-layer";B.display=0==j?"block":"none";B.fontFamily="font"in b?b.font:"";p.layer=p.nextLayer=m.id;"string"==typeof m.nextlayer&&(p.nextLayer=m.nextlayer);q=m.row;for(o=q.length;0<o&&!(0<q[o-1].key.length);o--);o<q.length&&q.splice(o-q.length,q.length-o);x=100/q.length;c.touchable&&(x=Math.floor(i/q.length),i=q.length*x,B.height=i+"px");for(o=B=0;o<q.length;o++){z=0;k=q[o];r=k.key;for(k=0;k<r.length;k++)n=r[k],null==n?r.length-=1:(z="string"==
typeof n.width&&""!=n.width?z+parseInt(n.width,10):z+100,z="string"==typeof n.pad&&""!=n.pad?z+parseInt(n.pad,10):z+5);z>B&&(B=z)}B+=5;for(o=0;o<q.length;o++){z=g._CreateElement("DIV");z.className="kmw-key-row";z.onmousedown=function(a){a&&a.preventDefault()};k=q[o];D=z.style;"desktop"!=c.formFactor?(D.bottom=(q.length-o-1)*x+"px",D.maxHeight=D.height=x+"px"):D.maxHeight=D.height=100/q.length+"%";r=k.key;for(k=0;k<r.length;k++){n=r[k];for(var E in F)"string"!=typeof n[E]&&(n[E]=F[E])}var C=0;for(k=
0;k<r.length-1;k++)""==r[k].width&&(r[k].width="100"),n=100*parseInt(r[k].width,10)/B,r[k].widthpc=n+"%",""==r[k].pad&&(r[k].pad="5"),A=100*parseInt(r[k].pad,10)/B,r[k].padpc=A+"%",C+=A+n;C+=500/B;1==r.length&&0>parseInt(r[0].pad,10)?(n=100*parseInt(r[0].width,10)/B,r[0].widthpc=n+"%",C+=n,r[0].padpc=100-C+"%"):0<r.length&&(k=r.length-1,A=100*parseInt(r[k].pad,10)/B,r[k].padpc=A+"%",C+=A,r[k].widthpc=100-C+"%");for(k=C=0;k<r.length;k++){n=r[k];A=g._CreateElement("DIV");A.keyId=n.id;A.className="kmw-key-square";
v=A.style;"desktop"!=c.formFactor&&(v.left=C+parseFloat(r[k].padpc)+"%");C=C+parseFloat(r[k].padpc)+parseFloat(r[k].widthpc);A.width=v.width=n.widthpc;"desktop"!=c.formFactor?(v.bottom=D.bottom,v.height=D.height):v.marginLeft=n.padpc;t=g._CreateElement("DIV");s=t.style;s.boxSizing="border-box";a.setButtonClass(n,t);c.touchable&&(s.position="fixed",s.left=v.left,s.bottom=D.bottom,s.top="auto",s.width=v.width,s.height=x-1+"px");v=null;if(b.keyLabels||!c.touchable){var y=h[n.id];switch(y){case 186:y=
59;break;case 187:y=61;break;case 188:y=44;break;case 189:y=45;break;case 190:y=46;break;case 191:y=47;break;case 192:y=96;break;case 219:y=91;break;case 220:y=92;break;case 221:y=93;break;case 222:y=39;break;default:if(48>y||90<y)y=0}0<y&&(v=g._CreateElement("DIV"),v.className="kmw-key-label",v.innerHTML=String.fromCharCode(y),A.appendChild(v))}s.overflow="hidden";s.border="1px solid #888888";s.webkitTapHighlightColor="rgba(0,0,0,0)";t.id=m.id+"-"+n.id;t.key=n;if("undefined"!=typeof n.sk&&null!=
n.sk){v=t.subKeys=n.sk;for(s=0;s<v.length;s++)if("1"==v[s].sp||"2"==v[s].sp)v[s].text=a.renameSpecialKey(v[s].text)}else t.subKeys=null;if(("phone"==c.formFactor||"iPhone"==c.app)&&0==n.sp&&"K_SPACE"!=n.id)s={id:n.id,text:n.text},null==t.subKeys?t.subKeys=[s]:t.subKeys[0].id!=n.id&&t.subKeys.splice(0,0,s);"ontouchstart"in window?(t.ontouchstart=function(b){a.touchKey(this,b)},t.ontouchend=function(b){a.releaseKey(this,b)},t.ontouchmove=function(b){a.moveOverKeys(this,b)},t.onclick=function(a){a.preventDefault();
a.stopPropagation()}):c.touchable&&"Windows"==c.OS?(t.style.msTouchAction="none",t.onmspointerdown=function(b){a.touchKey(this,b)},t.onmspointerup=function(b){a.releaseKey(this,b)},t.onmspointermove=function(b){a.moveOverKeys(this,b)}):(t.onmouseover=t.onmousedown=function(b){var d=g.eventTarget(b);if(d!==null){if(d.nodeName=="SPAN")d=d.parentNode;if(g.eventType(b)=="mousedown"){a.currentKey=d.id;a._CancelMouse(b);a.highlightKey(d,true)}else d.id==a.currentKey&&a.highlightKey(d,true)}},t.onmouseup=
t.onmouseout=function(b){var d=g.eventTarget(b);if(d!==null){if(d.nodeName=="SPAN")d=d.parentNode;a.highlightKey(d,false);if(g.eventType(b)=="mouseup"){d.id==a.currentKey&&a.clickKey(d);a.currentKey=""}}});s=g._CreateElement("SPAN");v=s.style;null==n.text||""==n.text?(s.innerHTML="\u00a0","string"==typeof n.id&&/^K_[0-9A-F]{4}$/i.test(n.id)&&(s.innerHTML=String.fromCharCode(parseInt(n.id.substr(2),16)))):s.innerHTML=n.text;s.className="kmw-key-text";if("1"==n.sp||"2"==n.sp)s.innerHTML=a.renameSpecialKey("*Tab*"==
n.text&&1==j?"*TabLeft*":n.text);"font"in n&&(v.fontFamily=n.font);"fontsize"in n&&(v.fontSize=n.fontsize);t.appendChild(s);A.appendChild(t);"undefined"!=typeof n.sk&&null!=n.sk&&(n=g._CreateElement("DIV"),n.className="kmw-key-popup-icon",A.appendChild(n));z.appendChild(A)}p.appendChild(z)}e.appendChild(p)}i&&(f.height=i+"px");return e};a.renameSpecialKey=function(a){for(var b="*Shift* *Enter* *Tab* *BkSp* *Menu* *Hide* *Alt* *Ctrl* *Caps* *ABC* *abc* *123* *Symbol* *Currency* *Shifted* *AltGr* *TabLeft*".split(" "),
c=[8,5,6,4,11,10,25,1,3,16,17,19,21,20,8,2,7],g=0;g<b.length;g++)if(a==b[g])return String.fromCharCode(57344+c[g]);return a};a.setButtonClass=function(a,b){var c=0;"string"==typeof a.dk&&"1"==a.dk&&(c=8);"string"==typeof a.sp&&(c=parseInt(a.sp,10));if(0>c||10<c)c=0;b.className="kmw-key kmw-key-"+"default shift shift-on      deadkey blank hidden".split(" ")[c]};a._GenerateVisualKeyboard=function(d,e,f){e=g._CreateElement("DIV");if("object"!=typeof f||null==f){var f=c.formFactor,i=window.dfltLayout;
"object"!=typeof i[f]&&(f="desktop");for(var f=g.deepCopy(i[f]),i=f.layer,h=d.BK,j=d.K102,k,w,m,p,q="default shift ctrl ctrlshift alt altshift ctrlalt ctrlaltshift".split(" "),d=0;8>d;d++){0<d&&(i[d]=g.deepCopy(i[0]));i[d].id=q[d];i[d].nextlayer=q[d];for(k=0;k<i[d].row.length;k++){w=i[d].row[k];p=w.key;for(w=0;w<p.length;w++)switch(m=p[w],m.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":1==(d&1)&&(m.sp="2");"desktop"!=c.formFactor&&0<d&&(m.nextlayer="default");break;case "K_CONTROL":case "K_LCTRL":case "K_LCONTROL":case "K_RCTRL":case "K_RCONTROL":2==
(d&2)&&(m.sp="2");break;case "K_ALT":case "K_LALT":case "K_RALT":4==(d&4)&&(m.sp="2")}}if("undefined"==typeof j||!j)for(k=0;k<i[d].row.length;k++)for(w=0;w<i[d].row[k].key.length;w++)"K_oE2"==i[d].row[k].key[w].id&&("desktop"==c.formFactor?(i[d].row[k].key.splice(w,1),i[d].row[k].key[0].width="200"):i[d].row[k].key[w].sp="10")}for(d=0;d<i.length;d++){var x=null,j=i[d].row;for(k=0;k<j.length;k++){p=j[k].key;for(w=0;w<p.length;w++)m=p[w],q=l.indexOf(m.id),"undefined"!=typeof h&&(0<=q&&q+65*d<h.length)&&
(m.text=h[q+65*d]),""==m.text&&"K_SPACE"!=m.id&&(m.text="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ "[q+65*d]),"K_SHIFT"==m.id&&(x=m)}if("desktop"!=c.formFactor&&0<d&&null!=x)switch(x.sp="2",x.sk=null,i[d].id){case "ctrl":x.text=a.renameSpecialKey("*Ctrl*");break;case "alt":x.text=a.renameSpecialKey("*Alt*");break;case "ctrlalt":x.text=a.renameSpecialKey("*AltGr*")}}}a.ddOSK=!1;a.layers=f.layer;a.fontFamily=
"font"in f?f.font:"";f.keyLabels="undefined"!=typeof b._ActiveKeyboard.KDU&&b._ActiveKeyboard.KDU;f=a.deviceDependentLayout(f);a.ddOSK=!0;a.keyMap=f;e.appendChild(f);a._DivVKbdHelp=a._DivVKbd=e;a._Box.className=c.formFactor+" kmw-osk-frame";e.className=c.formFactor+" kmw-osk-inner-frame";"desktop"==c.formFactor&&a._Box.appendChild(a.controlBar());a._Box.appendChild(e);"desktop"==c.formFactor&&a._Box.appendChild(a.resizeBar())};a.anchorToViewPort=function(){if(c.touchable&&!a.anchored&&!c.touchable){var d=
a._Box.style,e,f,i=b.debugElement,i=i&&i.parentNode?i.parentNode.style:null;g.landscapeView()?(e=f=window.innerHeight/2,"Android"==c.OS&&(e++,f--)):("iOS"==c.OS?(e=(window.innerWidth-screen.height+window.innerHeight)/2,f=(screen.height+window.innerHeight-window.innerWidth)/2):(e=window.innerHeight/2,f=e+(screen.height-window.outerHeight)/4-38),e=Math.round(e),f=Math.round(f));d.position="absolute";if("iOS"==c.OS){if("phone"==c.formFactor&&(f-=32,e+=32),d.height=e+"px",d.top=f+window.pageYOffset+"px",
a._Visible)d.display="block"}else{for(var h=a._Box.firstChild.firstChild.childNodes[a.layerIndex].childNodes,j=Math.round(e/h.length),k=0;k<h.length;k++)h[k].style.height=j+"px";window.setTimeout(function(){d.height=e+"px";d.top=f+window.pageYOffset+"px";if(a._Visible)d.display="block"},0)}i&&(i.position="absolute",i.top=window.pageYOffset+"px");a.anchored=!0}};a.controlBar=function(){var d=g._CreateElement("DIV"),c="";d.id="keymanweb_title_bar";d.className="kmw-title-bar";d.onmousedown=a._VMoveMouseDown;
b._ActiveKeyboard&&(c=b._ActiveKeyboard.KN);var f=g._CreateElement("SPAN");f.className="kmw-title-bar-caption";f.innerHTML=c;d.appendChild(f);c=a.closeButton=g._CreateElement("DIV");c.id="kmw-close-button";c.className="kmw-title-bar-image";c.onmousedown=a._CancelMouse;c.onclick=function(){a._Hide(!0)};d.appendChild(c);c=a.helpImg=g._CreateElement("DIV");c.id="kmw-help-image";c.className="kmw-title-bar-image";c.title="KeymanWeb Help";c.onclick=function(){g.callEvent("osk.helpclick",{});window.event&&
(window.event.returnValue=!1);return!1};c.onmousedown=a._CancelMouse;d.appendChild(c);c=a.configImg=g._CreateElement("DIV");c.id="kmw-config-image";c.className="kmw-title-bar-image";c.title="KeymanWeb Configuration Options";c.onclick=function(){g.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};c.onmousedown=a._CancelMouse;d.appendChild(c);c=a.pinImg=g._CreateElement("DIV");c.id="kmw-pin-image";c.className="kmw-title-bar-image";c.title="Pin the On Screen Keyboard to its default location on the active text box";
c.onclick=function(){a.loadCookie();a.userPositioned=!1;a.saveCookie();a._Show();a.doResizeMove();a.pinImg&&(a.pinImg.style.display="none");window.event&&(window.event.returnValue=!1);return!1};c.onmousedown=a._CancelMouse;d.appendChild(c);return d};a.showBuild=function(){g.alert("KeymanWeb Build "+b.build+'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2013 Tavultesoft Pty Ltd</span>')};a.resizeBar=function(){var b=g._CreateElement("DIV");b.className="kmw-footer";b.onmousedown=a._CancelMouse;
var c=g._CreateElement("DIV");c.className="kmw-footer-caption";c.innerHTML="Keyboard &copy; 2013 Tavultesoft Pty Ltd";c.id="keymanweb-osk-footer-caption";g.attachDOMEvent(c,"dblclick",function(b){b&&b.shiftKey&&a.showBuild()},!1);"onselectstart"in c&&(c.onselectstart=function(){return!1});b.appendChild(c);c=g._CreateElement("DIV");c.className="kmw-footer-resize";c.onmousedown=a._VResizeMouseDown;c.onmouseover=c.onmouseout=a._VResizeMouseOut;b.appendChild(c);a.resizeIcon=c;return b};a._VKbdMouseOver=
function(){b._IsActivatingKeymanWebUI=1};a._VKbdMouseOut=function(){b._IsActivatingKeymanWebUI=0};a._VResizeMouseOver=a._VResizeMouseOut=function(d){d=b._GetEventObject(d);if(!d)return!1;d&&d.preventDefault&&d.preventDefault();var c=a.getRect();a.width=c.width;a.height=c.height;d.cancelBubble=!0;return!1};a._VResizeMouseDown=function(d){b._JustActivatedKeymanWebUI=1;d=b._GetEventObject(d);if(!d)return!0;a.resizing=1;var c,f;d.pageX?(c=d.pageX,f=d.pageY):d.clientX&&(c=d.clientX+document.body.scrollLeft,
f=d.clientY+document.body.scrollTop);a._ResizeMouseX=c;a._ResizeMouseY=f;document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);a._VPreviousCursor=document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof d.which?d.button:d.which;a._VOriginalWidth=a._DivVKbd.offsetWidth;a._VOriginalHeight=a._DivVKbd.offsetHeight;document.onmousemove=a._VResizeMouseMove;document.onmouseup=a._VResizeMoveMouseUp;
document.body.style.cursor&&(document.body.style.cursor="se-resize");d&&d.preventDefault&&d.preventDefault();d.cancelBubble=!0;return!1};a._VResizeMouseMove=function(d){var c,f,d=b._GetEventObject(d);if(!d)return!0;a.resizing=1;if(a._VPreviousMouseButton!=("undefined"==typeof d.which?d.button:d.which))return a._VResizeMoveMouseUp(d);d.pageX?(c=d.pageX,f=d.pageY):d.clientX&&(c=d.clientX+document.body.scrollLeft,f=d.clientY+document.body.scrollTop);c=a._VOriginalWidth+c-a._ResizeMouseX;f=a._VOriginalHeight+
f-a._ResizeMouseY;c<0.2*screen.width&&(c=0.2*screen.width);f<0.1*screen.height&&(f=0.1*screen.height);c>0.9*screen.width&&(c=0.9*screen.width);f>0.5*screen.height&&(c=0.5*screen.height);a._DivVKbd.style.width=c+"px";a._DivVKbd.style.height=f+"px";a._DivVKbd.style.fontSize=f/8+"px";g.showShim(a._DivVKbd,a.shim,a._DivVKbdHelp);d&&d.preventDefault&&d.preventDefault();d.cancelBubble=!0;return!1};a._VMoveMouseDown=function(d){var c,f;b._JustActivatedKeymanWebUI=1;d=b._GetEventObject(d);if(!d)return!0;
a.resizing=1;d.pageX?(c=d.pageX,f=d.pageY):d.clientX&&(c=d.clientX+document.body.scrollLeft,f=d.clientY+document.body.scrollTop);document.onmousemove!=a._VResizeMouseMove&&document.onmousemove!=a._VMoveMouseMove&&(a._VPreviousMouseMove=document.onmousemove,a._VPreviousMouseUp=document.onmouseup);a._VPreviousCursor=document.body.style.cursor;a._VPreviousMouseButton="undefined"==typeof d.which?d.button:d.which;a._VMoveX=c-a._Box.offsetLeft;a._VMoveY=f-a._Box.offsetTop;b.isCJK()&&(a.pinImg.style.left=
"15px");document.onmousemove=a._VMoveMouseMove;document.onmouseup=a._VResizeMoveMouseUp;document.body.style.cursor&&(document.body.style.cursor="move");d&&d.preventDefault&&d.preventDefault();d.cancelBubble=!0;return!1};a._VMoveMouseMove=function(d){var c,f,d=b._GetEventObject(d);if(!d||a.noDrag)return!0;a.resizing=1;a.userPositioned=!0;a.pinImg.style.display="block";if(a._VPreviousMouseButton!=("undefined"==typeof d.which?d.button:d.which))return a._VResizeMoveMouseUp(d);d.pageX?(c=d.pageX,f=d.pageY):
d.clientX&&(c=d.clientX+document.body.scrollLeft,f=d.clientY+document.body.scrollTop);a._Box.style.left=c-a._VMoveX+"px";a._Box.style.top=f-a._VMoveY+"px";a._DivVKbd?g.showShim(a._DivVKbd,a.shim,a._DivVKbdHelp):g.showShim(a._Box,a.shim);d&&d.preventDefault&&d.preventDefault();c=a.getRect();a.width=c.width;a.height=c.height;d.cancelBubble=!0;return!1};a._VResizeMoveMouseUp=function(d){d=b._GetEventObject(d);if(!d)return!0;a.resizing=0;a.currentKey=null;document.onmousemove=a._VPreviousMouseMove;document.onmouseup=
a._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=a._VPreviousCursor);b._FocusLastActiveElement();d&&d.preventDefault&&d.preventDefault();b._JustActivatedKeymanWebUI=0;b._IsActivatingKeymanWebUI=0;a._DivVKbd&&(a._VOriginalWidth=a._DivVKbd.offsetWidth,a._VOriginalHeight=a._DivVKbd.offsetHeight);a.doResizeMove();d.cancelBubble=!0;a.saveCookie();return!1};a.userLocated=function(){return a.userPositioned};a.show=function(b){0<arguments.length?(a._Enabled=b)?a._Show():a._Hide(!0):
a._Visible?a._Hide(!0):a._Show()};a.doShow=function(a){return g.callEvent("osk.show",a)};a.doHide=function(a){return g.callEvent("osk.hide",a)};a.doResizeMove=function(a){return g.callEvent("osk.resizemove",a)};a._Show=function(d,e){if(!(null==a._Box||null==b._ActiveElement))if(c.touchable||null!=b._ActiveKeyboard&&a._Enabled){var f=a._Box.style;c.touchable&&""==f.bottom&&(f.visibility="hidden");if(a.ddOSK){var i,h=-1,j=a._DivVKbd.childNodes[0].childNodes;for(i=0;i<j.length;i++)j[i].layer==a.layerId?
(j[i].style.display="block",a.nextLayer=a.layerId,a.layerIndex=h=i,"string"==typeof a.layers[i].nextlayer&&(a.nextLayer=a.layers[i].nextlayer)):j[i].style.display="none";c.touchable&&(f.position="fixed",f.left=f.bottom="0px",f.height=f.maxHeight=a._Box.firstChild.firstChild.style.height,f.border="none",f.borderTop="1px solid gray",a._Enabled=1,a._Visible=1,a._DivVKbd.style.fontSize="phone"==c.formFactor?"120%":"200%",a.lgKey=a.getSpecialKey(h,"K_LOPT"),a.hkKey=a.getSpecialKey(h,"K_ROPT"));a.spaceBar=
a.getSpecialKey(h,"K_SPACE")}f.display="block";a.showLanguage();if("desktop"==c.formFactor&&(f.position="absolute",f.display="block",f.left="0px",a.loadCookie(),0<=d?(f.left=d+"px",f.top=e+"px"):a.userPositioned?(f.left=a.x+"px",f.top=a.y+"px"):(i=b._ActiveElement,""!=a.dfltX?f.left=a.dfltX:"undefined"!=typeof i&&null!=i&&(f.left=g._GetAbsoluteX(i)+"px"),""!=a.dfltY)?f.top=a.dfltY:"undefined"!=typeof i&&null!=i&&(f.top=g._GetAbsoluteY(i)+i.offsetHeight+"px"),a._Enabled=1,a._Visible=1,a._DivVKbd&&
(a.width=a._DivVKbd.offsetWidth,a.height=a._DivVKbd.offsetHeight),a.saveCookie(),i=a.pinImg,"undefined"!=typeof i&&null!=i))i.style.display=a.userPositioned?"block":"none";"hidden"==f.visibility&&window.setTimeout(function(){a._Box.style.visibility="visible"},0);c.touchable||(f={},f.x=a._Box.offsetLeft,f.y=a._Box.offsetTop,f.userLocated=a.userPositioned,a.doShow(f))}};a.adjustRowLengths=function(b){if(!(0<=b)){var e,f=a._DivVKbd.childNodes[0].childNodes;if(!(0>b||b>=f.length||f[b].aligned)&&"block"==
f[b].style.display){e=a._DivVKbd.childNodes[0].offsetWidth-6;"Windows"==c.OS&&(e-=g.landscapeView()?4:40);var i,h=f[b].childNodes,j,k,l;for(i=0;i<h.length;i++)j=h[i].childNodes,k=j.length,l=j[k-2].offsetLeft+j[k-2].offsetWidth,j=j[k-1],j.style.width=e-l+"px";f[b].aligned=!0}}};a.resetRowLengths=function(){var b,c=a._DivVKbd.childNodes[0].childNodes,f=-1;for(b=0;b<c.length;b++)"block"==c[b].style.display&&(f=b),c[b].aligned=!1;return f};a.getSpecialKey=function(b,c){var f,g;f=a._DivVKbd.childNodes[0].childNodes;
if(0<=b&&b<f.length){f=f[b].childNodes;g=f[f.length-1].childNodes;for(f=0;f<g.length;f++)if(g[f].keyId==c)return g[f]}return null};a.hide=function(){a._Enabled=0;a._Hide(!0)};a._Hide=function(d){a._Box&&("block"==a._Box.style.display&&a._DivVKbd)&&(a.width=a._DivVKbd.offsetWidth,a.height=a._DivVKbd.offsetHeight);if(d)a._Enabled=b.isCJK()||c.touchable?1:0,a.saveCookie();else if("desktop"==c.formFactor&&0<=document.body.className.indexOf("osk-always-visible"))return;a._Visible=0;if(a._Box&&c.touchable&&
0<a._Box.offsetHeight){var e=a._Box.style,f=a._Box.offsetHeight;e.msTransition="-ms-transform 0.5s linear 0";e.WebkitTransition="-webkit-transform 0.5s linear 0";e.msTransform=e.WebkitTransform="";window.setTimeout(function(){var b=a._Box.style;if(a._Visible==0){b.msTransform=b.WebkitTransform="translate3d(0,"+f+"px,0)";c.OS=="Windows"?a._Box.addEventListener("transitionend",a.hideNow,false):a._Box.addEventListener("webkitTransitionEnd",a.hideNow,false)}},500)}else a._Box&&(a._Box.style.display="none"),
g.hideShim(a.shim);a.anchored=!1;e={};e.HiddenByUser=d;a.doHide(e);d&&b._FocusLastActiveElement()};a.hideNow=function(){"Windows"==c.OS?a._Box.removeEventListener("transitionend",a.hideNow,!1):a._Box.removeEventListener("webkitTransitionEnd",a.hideNow,!1);var b=a._Box.style;b.display="none";a._Visible=0;b.msTransition=b.WebkitTransition="";b.msTransform=b.WebkitTransform="none";a.anchored=!1;"undefined"!=typeof a.hkKey&&a.highlightKey(a.hkKey.firstChild,!1)};a.prepare=function(){b.initialized?(a.ready||
(a._Box=g._CreateElement("DIV"),document.body.appendChild(a._Box),"iPhone"==c.app||"iPad"==c.app?g.linkStyleSheet(g.myPath()+"kmwosk.css"):g.linkStyleSheet(g.getOption("resources")+"osk/kmwosk.css"),g.attachDOMEvent(a._Box,"mousedown",function(){b._IsActivatingKeymanWebUI=1}),c.touchable&&(g.attachDOMEvent(a._Box,"touchstart",function(a){b._IsActivatingKeymanWebUI=1;a.preventDefault();a.stopPropagation()}),g.attachDOMEvent(a._Box,"touchend",function(a){a.preventDefault();a.stopPropagation()}),g.attachDOMEvent(a._Box,
"touchmove",function(a){a.preventDefault();a.stopPropagation()}),g.attachDOMEvent(a._Box,"touchcancel",function(a){a.preventDefault();a.stopPropagation()}))),a.loadCookie(),a.ready=!0):window.setTimeout(a.prepare,200)};a._Load=function(){if(null==a._Box){if(99<=a.loadRetry)return;window.setTimeout(a._Load,100);a.loadRetry++}b._TitleElement&&(b._TitleElement.innerHTML="Tavultesoft KeymanWeb");a._Visible=0;a.layerId="default";var d=a._Box.style;d.zIndex="9999";d.display="none";d.width="auto";d.position=
"desktop"==c.formFactor?"absolute":"fixed";"phone"==c.formFactor&&(d.fontSize="1.6em");a._DivVKbd=a._DivVKbdHelp=null;a._Box.innerHTML="";a._Box.onmouseover=a._VKbdMouseOver;a._Box.onmouseout=a._VKbdMouseOut;if(null==b._ActiveKeyboard&&!c.touchable){var e=g._CreateElement("DIV");e.className="kmw-title-bar";e.appendChild(a._TitleBarInterior());e.onmousedown=a._VMoveMouseDown;a._Box.appendChild(e);e=g._CreateElement("DIV");e.className="kmw-osk-none";a._Box.appendChild(e)}else{var f=e=null,h=null,d=
"";a._Box.className="";if(null!=b._ActiveKeyboard&&(e=b._ActiveKeyboard.KV,d=b._ActiveKeyboard.KH,f=b._ActiveKeyboard.KVKL,"undefined"!=typeof f&&null!=f&&(h=f[c.formFactor],"undefined"==typeof h||null==h)))if("phone"==c.formFactor?h=f.tablet:"tablet"==c.formFactor&&(h=f.phone),"undefined"==typeof h||null==h)h=f.desktop;if(null!=e&&null!=e.BK){for(var f=e.BK,j=!0,l=0;l<f.length;l++)if(0<f[l].length){j=!1;break}j&&(e=null)}null!=e||""==d||c.touchable?(null==e&&(e={F:"Tahoma",BK:"`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ "}),
a._GenerateVisualKeyboard(e,d,h)):(a.ddOSK=!1,e=g._CreateElement("DIV"),e.className="kmw-title-bar",e.appendChild(a._TitleBarInterior()),e.onmousedown=a._VMoveMouseDown,a._Box.appendChild(e),e=g._CreateElement("DIV"),e.className="kmw-osk-static",e.innerHTML=d,a._Box.appendChild(e),b._ActiveKeyboard.KHF&&b._ActiveKeyboard.KHF(a._Box));b._TitleElement&&(b._TitleElement.innerHTML="<span style='font-weight:bold'>"+b._ActiveKeyboard.KN+"</span> - "+b._TitleElement.innerHTML,b._TitleElement.className="",
b._TitleElement.style.color="#fff")}a.appendStyleSheet();a._Enabled&&a._Show()};a.appendStyleSheet=function(){if(null!=b._ActiveStub){a.styleSheet&&g.removeStyleSheet(a.styleSheet);var c=b._ActiveStub,e=c.KFont,f=c.KOskFont;g.addFontFaceStyleSheet(e);g.addFontFaceStyleSheet(f);b.alignInputs(!1);a.styleSheet=g.addStyleSheet(a.addFontStyle(e,f));if("undefined"!=typeof e||"undefined"!=typeof f){var h=g.checkFontDescriptor(e),j=g.checkFontDescriptor(f);if(!h||!j){var l=window.setInterval(function(){h=
g.checkFontDescriptor(e);j=g.checkFontDescriptor(f);h&&j&&(window.clearInterval(l),l=null,b.alignInputs(!0))},250);window.setTimeout(function(){l&&(window.clearInterval(l),l=null,b.alignInputs(!0),g.alert("Unable to download the font normally used with "+c.KN+"."))},5E3);return}}b.alignInputs(!0)}};a.addFontStyle=function(a,c){var f=b.baseFont;"undefined"!=typeof a&&"undefined"!=typeof a.family&&(f=a.family);var g=b.appliedFont,g=g.replace(RegExp("s?"+f+",?"),""),g=g.replace(/,$/,""),g=""==g?f:f+
","+g,f=".keymanweb-font{\nfont-family:"+g+" !important;\n}\n";"undefined"!=typeof c?f=f+".kmw-key-text{\nfont-family:"+c.family+";\n}\n":"undefined"!=typeof a&&(f=f+".kmw-key-text{\nfont-family:"+a.family+";\n}\n");b.appliedFont=g;return f};a._Unload=function(){a._VShift=a._DivVKbd=a._VKeySpans=a._Box=0};a.saveCookie=function(){var b=g.loadCookie("KeymanWeb_OnScreenKeyboard"),c=a.getPos();b.visible=a._Enabled?1:0;b.userSet=a.userPositioned?1:0;b.left=c.left;b.top=c.top;a._DivVKbd&&(b.width=a.width,
b.height=a.height);g.saveCookie("KeymanWeb_OnScreenKeyboard",b)};a.loadCookie=function(){var b=g.loadCookie("KeymanWeb_OnScreenKeyboard");if("undefined"==typeof b||null==b)return a.userPositioned=!1;a._Enabled=g.toNumber(b.visible,!0);a.userPositioned=g.toNumber(b.userSet,!1);a.x=g.toNumber(b.left,-1);a.y=g.toNumber(b.top,-1);var c=g.toNumber(b.width,0.3*screen.width),b=g.toNumber(b.height,0.15*screen.height);c<0.2*screen.width&&(c=0.2*screen.width);b<0.1*screen.height&&(b=0.1*screen.height);c>0.9*
screen.width&&(c=0.9*screen.width);b>0.5*screen.height&&(c=0.5*screen.height);a._DivVKbd&&(a._DivVKbd.style.width=c+"px",a._DivVKbd.style.height=b+"px",a._DivVKbd.style.fontSize=b/8+"px");if(-1==a.x||-1==a.y||!a._Box)a.userPositioned=!1;a.x<window.pageXOffset-0.8*c&&(a.x=window.pageXOffset-0.8*c);0>a.y&&(a.x=-1,a.y=-1,a.userPositioned=!1);a.userPositioned&&a._Box&&a.setPos({left:a.x,top:a.y});return!0};b.executePopupKey=function(c,e){if(!b._ActiveKeyboard)return!1;var f=b._LastActiveElement,g,j=a.getModifierState(a.layerId);
null==b._ActiveElement&&(b._ActiveElement=f);switch(c){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":return a.updateLayer("shift"),a._Show(),!0;case "K_LCONTROL":case "K_RCONTROL":case "K_LCTRL":case "K_RCTRL":case "K_CTRL":return a.updateLayer("ctrl"),a._Show(),!0;case "K_LMENU":case "K_RMENU":case "K_LALT":case "K_RALT":case "K_ALT":return a.updateLayer("alt"),a._Show(),!0;case "K_ALTGR":return a.updateLayer("ctrlalt"),a._Show(),!0}g={Ltarg:f,Lmodifiers:0,Lcode:h[c],LisVirtualKey:1};"undefined"==
typeof g.Lcode&&(g.Lcode=a.getVKDictionaryCode(c));if(isNaN(g.Lcode)||!g.Lcode)return!1;g.vkCode=g.Lcode;g.Lmodifiers=16*j;if(!b._ActiveKeyboard||isNaN(g.Lcode)||0==g.Lcode)return!1;if(b._ActiveKeyboard.gs(f,g))return!0;"string"==typeof e&&""!=e?b.KO(0,f,String.fromCharCode(parseInt(e,16))):(g.Lcode=parseInt(c.substr(2),6>c.length?10:16),b.KO(0,f,String.fromCharCode(g.Lcode)));return!0};b.touchMenuPos=function(){if(null==a.lgKey)return"";var b=g._GetAbsoluteX(a.lgKey)-g._GetAbsoluteX(a._DivVKbd)+
a.lgKey.offsetWidth/2,c=g._GetAbsoluteY(a.lgKey)-g._GetAbsoluteY(a._DivVKbd);return b+","+c}})();(function(){var b=window.tavultesoft.keymanweb,h=b.util,j=h.device;b.TSS_LAYER=33;b.TSS_PLATFORM=31;b._BeepObjects=[];b._BeepTimeout=0;b.KSF=b.KSF=function(){b._IgnoreNextSelChange=1};b.KT=b.KT=function(a,g){var c=b._LastActiveElement,d,e,f;d=!1;null!=c&&(d=c._KeymanWebSelectionStart,e=c._KeymanWebSelectionEnd,f=b._Selection,b._IsActivatingKeymanWebUI=1,b._IgnoreNextSelChange=100,b._FocusLastActiveElement(),b._IsMozillaEditableIframe(c,0)&&(c=c.documentElement),document.selection&&null!=f&&f.select(),
c._KeymanWebSelectionStart=d,c._KeymanWebSelectionEnd=e,b._IgnoreNextSelChange=0,null!=a&&b.KO(0,c,a),"undefined"!=typeof g&&b.KDO(0,c,g),c._KeymanWebSelectionStart=null,c._KeymanWebSelectionEnd=null,d=!0);return d};b.KR=b.KR=function(a){b.loadTimer&&(window.clearTimeout(b.loadTimer),b.loadTimer=null);if(b.initialized){var g,c=b.osk,d=b._ActiveStub;if(!d||!("KI"in d)||d.KI!=a.KI)for(g=0;g<b._KeyboardStubs.length;g++){d=b._KeyboardStubs[g];if(a.KI==d.KI)break;d=null}b.KRS(d?d:a);for(g=0;g<b._Keyboards.length;g++)if(a.KI==
b._Keyboards[g].KI)return;b._Keyboards=b._push(b._Keyboards,a);b._LoadingInternalName==a.KI&&(b.doBeforeKeyboardChange(a.KI,d.KLC),b._ActiveKeyboard=a,null!=b._LastActiveElement&&(b._JustActivatedKeymanWebUI=1,b._SetTargDir(b._LastActiveElement)),b._LoadingInternalName=null,a.KL="undefined"!=typeof d.KL?d.KL:"",a.KLC="undefined"!=typeof d.KLC?d.KLC:"",a.KR="undefined"!=typeof d.KR?d.KR:"",a.KRC="undefined"!=typeof d.KRC?d.KRC:"",a.KC="undefined"!=typeof d.KC?d.KC:"",a.KCC="undefined"!=typeof d.KCC?
d.KCC:"",a.KD="undefined"!=typeof d.KD?d.KD:"",a.KS="undefined"!=typeof d.KS?d.KS:0,String.kmwEnableSupplementaryPlane(d&&(d.KS&&1==d.KS||"Hieroglyphic"==a.KN)),b.saveCurrentKeyboard(a.KI,d.KLC),c._Load(),h.wait(!1));b.doKeyboardLoaded(a.KI);b._LoadingInternalName=null}else b.deferredKR.push(a)};b.KRS=b.KRS=function(a){var g;if(b.initialized){null==b.dfltStub&&(b.dfltStub=a);"undefined"==typeof a.KLC&&(a.KLC="");"undefined"==typeof a.KL&&(a.KL="undefined");for(g=0;g<b._KeyboardStubs.length;g++)if(b._KeyboardStubs[g].KI==
a.KI&&(""==a.KLC||b._KeyboardStubs[g].KLC==a.KLC))return 1;b._KeyboardStubs=b._push(b._KeyboardStubs,a)}else b.deferredKRS.push(a)};b.KC=b.KC=function(a,g,c){var d,e=c.body?c:c.ownerDocument;if(j.touchable&&""==j.app)return b.getTextBeforeCaret(c)._kmwSubstr(-a)._kmwSubstr(0,g);if(b.legacy)return c.value._kmwSubstr(c.length-a,g);if(e&&(d=e.defaultView)&&d.getSelection&&("on"==e.designMode.toLowerCase()||"true"==c.contentEditable||"plaintext-only"==c.contentEditable||""===c.contentEditable)){if(c=
d.getSelection(),3==c.focusNode.nodeType)return c.focusOffset>2*a?c.focusNode.substringData(c.focusOffset-2*a,2*a)._kmwSubstr(-a)._kmwSubstr(0,g):c.focusNode.substringData(0,c.focusOffset)._kmwSubstr(-a)._kmwSubstr(0,g)}else{if(c.setSelectionRange){if(c._KeymanWebSelectionStart)d=c._KeymanWebSelectionStart;else{if(null===b._CachedSelectionStart||c.selectionStart!==b._LastCachedSelection)b._LastCachedSelection=c.selectionStart,b._CachedSelectionStart=c.value._kmwCodeUnitToCodePoint(c.selectionStart),
b._CachedSelectionEnd=c.value._kmwCodeUnitToCodePoint(c.selectionEnd);d=b._CachedSelectionStart}return d<a?c.value._kmwSubstr(0,d):c.value._kmwSubstring(d-a,d-a+g)}if(e&&(d=e.selection))return c=d.createRange(),c.moveStart("character",-2*a),c.text._kmwSubstr(-a)._kmwSubstring(0,g)}return""};b.KN=b.KN=function(a,b){var c=this.KC(a+1,a+1,b);return!1===c?!0:c._kmwLength()<a+1};b.KCM=b.KCM=function(a,b,c,d){a=this.KC(a,d,b);if(!1!==a&&a===c)return!0;this._DeadkeyResetMatched();return!1};b.KIK=b.KIK=function(a){return b._ActiveKeyboard.KM?
!a.LisVirtualKey:b._USKeyCodeToCharCode(a)?1:0};b.KKM=b.KKM=function(a,b,c){var d=0,e=173==a.Lcode?189:a.Lcode;255<a.vkCode&&(e=a.vkCode);if(a.LisVirtualKey||255<e){if(16384==(b&16384)||255<e)d=c==e&&(b&127)==a.Lmodifiers}else 0==(b&16384)&&(d=e==c);d||this._DeadkeyResetMatched();return d};b.KKI=b.KKI=function(a){var b={};b.vk=a.LisVirtualKey;b.code=a.Lcode;b.modifiers=a.Lmodifiers;return b};b.KDM=b.KDM=function(a,g,c){if(0==b._DeadKeys.length)return!1;a=b._SelPos(g)-a;for(g=0;g<b._DeadKeys.length;g++)if(b._DeadKeys[g].p==
a&&b._DeadKeys[g].d==c)return b._DeadKeys[g].matched=1;this._DeadkeyResetMatched();return!1};b.KBR=b.KBR=function(){var a;for(a=b._BeepTimeout=0;a<b._BeepObjects.length;a++)b._BeepObjects[a].e.style.backgroundColor=b._BeepObjects[a].c;b._BeepObjects=[]};b.KB=b.KB=function(a){a.body&&(a=a.body);if(a.style&&"undefined"!=typeof a.style.backgroundColor){for(var g=0;g<b._BeepObjects.length;g++)if(b._BeepObjects[g].e==a)return;b._BeepObjects=b._push(b._BeepObjects,{e:a,c:a.style.backgroundColor});a.style.backgroundColor=
"#000000";0==b._BeepTimeout&&(b._BeepTimeout=1,window.setTimeout(b.KBR,50))}};b.KA=b.KA=function(a,g,c){if(""==g)return 0;g=c._kmwIndexOf(g);b._AnyIndices[a]=g;return 0<=g};b.KO=b.KO=function(a,g,c){var d=g.body?g:g.ownerDocument,e;if(0<=g.className.indexOf("keymanweb-input")){var f=b.getTextBeforeCaret(g),f=0<a?f._kmwSubstr(0,f._kmwLength()-a)+c:f+c;b.setTextBeforeCaret(g,f)}else{if(b.legacy)g.value=0<a?g.value._kmwSubstr(0,g.value._kmwLength()-a)+c:g.value+c;else if(d&&(e=d.defaultView)&&e.getSelection&&
("on"==d.designMode.toLowerCase()||"true"==g.contentEditable||"plaintext-only"==g.contentEditable||""===g.contentEditable)){var h="on"==d.designMode.toLowerCase();if(h)var j=b._CacheCommands(d);e=e.getSelection();f=e.focusNode.nodeValue?e.focusNode.substringData(0,e.focusOffset)._kmwLength():0;e.isCollapsed||e.deleteFromDocument();var l=e.getRangeAt(0);0<a&&(l.setStart(e.focusNode,e.focusOffset-e.focusNode.nodeValue.substr(0,e.focusOffset)._kmwSubstr(-a).length),l.deleteContents());if(0<c._kmwLength())if(3==
e.focusNode.nodeType){l=e.focusOffset;e.focusNode.insertData(e.focusOffset,c);try{e.extend(e.focusNode,l+c.length)}catch(k){e.focusNode.parentNode.scrollIntoView(),e.extend(e.focusNode,l+c.length)}}else{var w=d.createTextNode(c);l.insertNode(w);e.extend(w,c.length)}h&&b._CacheCommandsReset(d,j,null);e.collapseToEnd();0<=a&&(b._DeadkeyDeleteMatched(),b._DeadkeyAdjustPos(f,-a+c._kmwLength()))}else if(d&&(e=d.selection)){if(d.body.isContentEditable||"on"==d.designMode.toLowerCase())j=b._CacheCommands(d);
l=e.createRange();""!=l.text?(e.clear(),a=0):l.collapse(!0);0<a?(l.moveStart("character",-2*a),h=l.text._kmwSubstr(-a),l.collapse(!1),l.moveStart("character",-h.length)):a=0;l.text=c;if(d.body.isContentEditable||"on"==d.designMode.toLowerCase())l.moveStart("character",-c.length),b._CacheCommandsReset(d,j,l.select),l.moveStart("character",c.length),l.select();0<=a&&(b._DeadkeyDeleteMatched(),b._DeadkeyAdjustPos(f,-a+c._kmwLength()));b._Selection=e.createRange();b._Selection.select();b._Selection.scrollIntoView()}else g.setSelectionRange&&
(null!=g._KeymanWebSelectionStart?(f=g._KeymanWebSelectionStart,d=g._KeymanWebSelectionEnd):(f=g.value._kmwCodeUnitToCodePoint(g.selectionStart),d=g.value._kmwCodeUnitToCodePoint(g.selectionEnd)),"textarea"==g.type.toLowerCase()&&"undefined"!=typeof g.scrollTop&&(h=g.scrollTop,l=g.scrollLeft),0>a?(g.value=g.value._kmwSubstring(0,f)+c+g.value._kmwSubstring(d),a=0):g.value=f<a?c+g.value._kmwSubstring(d):g.value._kmwSubstring(0,f-a)+c+g.value._kmwSubstring(d),0<=a&&(b._DeadkeyDeleteMatched(),b._DeadkeyAdjustPos(f,
-a+c._kmwLength())),"undefined"!=typeof h&&(g.scrollTop=h,g.scrollLeft=l),a=f-a+c._kmwLength(),a=g.value._kmwCodePointToCodeUnit(a),g.setSelectionRange(a,a),g._KeymanWebSelectionStart=null,g._KeymanWebSelectionEnd=null);if("ontextchange"in b)b.ontextchange(g)}};b.KDO=b.KDO=function(a,g,c){var d={};0<=a&&b.KO(a,g,"");d.p=b._SelPos(g);d.d=c;b._DeadKeys=b._push(b._DeadKeys,d)};b.KIO=b.KIO=function(a,g,c,d){b._AnyIndices[c-1]<g._kmwLength()&&b.KO(a,d,g._kmwCharAt(b._AnyIndices[c-1]))};b._CacheCommands=
function(a){var g=[["backcolor",1],["fontname",1],["fontsize",1],["forecolor",1],["bold",0],["italic",0],["strikethrough",0],["subscript",0],["superscript",0],["underline",0]];a.defaultView&&b._push(g,["hilitecolor",1]);for(var c=0;c<g.length;c++)b._push(g[c],g[c][1]?a.queryCommandValue(g[c][0]):a.queryCommandState(g[c][0]));return g};b._CacheCommandsReset=function(a,b,c){for(var d=0;d<b.length;d++)b[d][1]?a.queryCommandValue(b[d][0])!=b[d][2]&&(c&&c(),a.execCommand(b[d][0],!1,b[d][2])):a.queryCommandState(b[d][0])!=
b[d][2]&&(c&&c(),a.execCommand(b[d][0],!1,null))};b.KIFS=b.KIFS=function(a,g){if(a==b.TSS_LAYER)return l.layerId===g;if(a==b.TSS_PLATFORM)switch(g){case "tablet":case "phone":case "desktop":return j.formFactor===g;default:return!0}else return!1};b.KSETS=function(a,g){return a==b.TSS_LAYER?l.showLayer(g):!1};b.KLOAD=function(a,b,c){a=h.loadCookie("KeymanWeb_"+a+"_Option_"+b);return"undefined"!=typeof a[b]?unescape(a[b]):c};b.KSAVE=function(a,g){var c=b._ActiveKeyboard;if(!c||"undefined"==typeof c.KI||
""==c.KI)return!1;var c="KeymanWeb_"+c.KI+"_Option_"+a,d=escape(g);h.saveCookie(c,d);return!0};var l=b.osk;b.GetLastActiveElement=function(){return b._LastActiveElement};b.FocusLastActiveElement=function(){b._FocusLastActiveElement()};b.HideHelp=function(){l._Hide(!0)};b.ShowHelp=function(a,b){l._Show(a,b)};b.ShowPinnedHelp=function(){l.userPositioned=!0;l._Show(-1,-1)}})();(function(){var b=window.tavultesoft.keymanweb,h=b._VKMap_FF_IE={};h.k61=187;h.k59=186;b._VKMap_Opera_IE={};b._VKMap_Safari_IE={};h=b._VKMap={};h.se={};h.se.k220=192;h.se.k187=189;h.se.k219=187;h.se.k221=219;h.se.k186=221;h.se.k191=220;h.se.k192=186;h.se.k189=191;h.uk={};h.uk.k223=192;h.uk.k192=222;h.uk.k222=226;h.uk.k220=220;var h={},j={};h.k192=96;h.k49=49;h.k50=50;h.k51=51;h.k52=52;h.k53=53;h.k54=54;h.k55=55;h.k56=56;h.k57=57;h.k48=48;h.k189=45;h.k187=61;h.k81=113;h.k87=119;h.k69=101;h.k82=114;
h.k84=116;h.k89=121;h.k85=117;h.k73=105;h.k79=111;h.k80=112;h.k219=91;h.k221=93;h.k220=92;h.k65=97;h.k83=115;h.k68=100;h.k70=102;h.k71=103;h.k72=104;h.k74=106;h.k75=107;h.k76=108;h.k186=59;h.k222=39;h.k90=122;h.k88=120;h.k67=99;h.k86=118;h.k66=98;h.k78=110;h.k77=109;h.k188=44;h.k190=46;h.k191=47;j.k192=126;j.k49=33;j.k50=64;j.k51=35;j.k52=36;j.k53=37;j.k54=94;j.k55=38;j.k56=42;j.k57=40;j.k48=41;j.k189=95;j.k187=43;j.k81=81;j.k87=87;j.k69=69;j.k82=82;j.k84=84;j.k89=89;j.k85=85;j.k73=73;j.k79=79;j.k80=
80;j.k219=123;j.k221=125;j.k220=124;j.k65=65;j.k83=83;j.k68=68;j.k70=70;j.k71=71;j.k72=72;j.k74=74;j.k75=75;j.k76=76;j.k186=58;j.k222=34;j.k90=90;j.k88=88;j.k67=67;j.k86=86;j.k66=66;j.k78=78;j.k77=77;j.k188=60;j.k190=62;j.k191=63;b._USCharCode=[h,j];b._USKeyCodeToCharCode=function(h){return b._USCharCode[h.Lmodifiers&16?1:0]["k"+h.Lcode]}})();window.dfltLayout={desktop:{font:"Tahoma",layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},
{id:"3",key:[{id:"K_CAPS",text:"*Caps*",sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",
text:"*Ctrl*",sp:"1",width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_ALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},
{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",
key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"140",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrlalt"}]},{id:"K_LOPT",text:"*Menu*",sp:"1",width:"120"},{id:"K_TAB",text:"*Tab*",sp:"1",width:"120"},{id:"K_SPACE",text:"",width:"500"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"120"},{id:"K_ROPT",text:"*Hide*",sp:"1",width:"120"},{id:"K_ENTER",text:"*Enter*",
sp:"1",width:"120"}]}]}]},phone:{font:"Tahoma",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},
{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"140",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_ALTGR",
text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrlalt"}]},{id:"K_LOPT",text:"*Menu*",width:"120",sp:"1"},{id:"K_TAB",text:"*Tab*",width:"120",sp:"1"},{id:"K_SPACE",width:"500",text:""},{id:"K_BKSP",text:"*BkSp*",width:"120",sp:"1"},{id:"K_ROPT",text:"*Hide*",width:"120",sp:"1"},{id:"K_ENTER",text:"*Enter*",width:"120",sp:"1"}]}]}]}};(function(){var b=window.tavultesoft.keymanweb;if("complete"===document.readyState)b.init(null);else var h=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(h),b.init(null))},10)})();
