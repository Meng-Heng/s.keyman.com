/*
 https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
 https://mths.be/codepointat v0.2.0 by @mathias  http://mths.be/startswith v0.2.0 by @mathias */
var com;(function(g){g=g.keyman||(g.keyman={});g=g.environment||(g.environment={});g.VERSION="15.0";g.BUILD=272;g.ENVIRONMENT="stable";g.SENTRY_RELEASE="release-15.0.272"})(com||(com={}));(function(g){(function(g){(function(h){function g(e,b){b=b||{};for(var a in e)"object"===typeof e[a]&&null!=e[a]?(b[a]=e[a].constructor===Array?[]:{},g(e[a],b[a])):b[a]=e[a];return b}h.deepCopy=g})(g.utils||(g.utils={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){h.getGlobalObject=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:global}})(g.utils||(g.utils={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var k=function(){function e(b){if(void 0===b||null===b)this.components=[].concat(e.DEVELOPER_VERSION_FALLBACK.components);else if(Array.isArray(b)){if(2>b.length)throw Error("Version string must have at least a major and minor component!");this.components=[].concat(b)}else{b=b.split(".");var a=[];if(2>b.length)throw Error("Version string must have at least a major and minor component!");for(var c=0;c<b.length;c++){var d=parseInt(b[c],10);if(isNaN(d))throw Error("Version string components must be numerical!");
a.push(d)}this.components=a}}Object.defineProperty(e.prototype,"major",{get:function(){return this.components[0]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"minor",{get:function(){return this.components[1]},enumerable:!0,configurable:!0});e.prototype.toString=function(){return this.components.join(".")};e.prototype.toJSON=function(){return this.toString()};e.prototype.equals=function(b){return 0==this.compareTo(b)};e.prototype.precedes=function(b){return 0>this.compareTo(b)};
e.prototype.compareTo=function(b){var a=this.components.length<b.components.length,c=this.components.length<b.components.length?this.components.length:b.components.length,d;for(d=0;d<c;d++){var f=this.components[d]-b.components[d];if(0!=f)return f}b=a?b.components:this.components;do{if(0<b[d])return a?-1:1;d++}while(d<b.length);return 0};e.CURRENT=new e(g.keyman.environment.VERSION);e.DEVELOPER_VERSION_FALLBACK=new e([9,0,0]);e.NO_DEFAULT_KEYCAPS=new e([12,0]);e.MAC_POSSIBLE_IPAD_ALIAS=new e([10,
15]);return e}();h.Version=k})(k.utils||(k.utils={}))})(g.keyman||(g.keyman={}))})(com||(com={}));String.kmwFromCharCode=function(g){var k=[],h;for(h=0;h<arguments.length;h++){var n=Number(arguments[h]);if(!isFinite(n)||0>n||1114111<n||Math.floor(n)!==n)throw new RangeError("Invalid code point "+n);65536>n?k.push(n):(n-=65536,k.push((n>>10)+55296),k.push(n%1024+56320))}return String.fromCharCode.apply(void 0,k)};
String.prototype.kmwCharCodeAt=function(g){var k=String(this),h=0;if(0>g||g>=k.length)return NaN;for(var n=0;n<g;n++)if(h=k.kmwNextChar(h),null===h)return NaN;g=k.charCodeAt(h);return 55296<=g&&56319>=g&&k.length>h+1&&(k=k.charCodeAt(h+1),56320<=k&&57343>=k)?(g-55296<<10)+(k-56320)+65536:g};String.prototype.kmwIndexOf=function(g,k){var h=String(this);g=h.indexOf(g,k);if(0>g)return g;for(var n=k=0;null!==n&&n<g;n=h.kmwNextChar(n))k++;return k};
String.prototype.kmwLastIndexOf=function(g,k){var h=String(this);g=h.lastIndexOf(g,k);if(0>g)return g;for(var n=k=0;null!==n&&n<g;n=h.kmwNextChar(n))k++;return k};String.prototype.kmwLength=function(){var g=String(this);if(0==g.length)return 0;for(var k=0,h=0;null!==h;k++)h=g.kmwNextChar(h);return k};String.prototype.kmwSlice=function(g,k){var h=String(this);g=h.kmwCodePointToCodeUnit(g);k=h.kmwCodePointToCodeUnit(k);return null===g||null===k?"":h.slice(g,k)};
String.prototype.kmwSubstr=function(g,k){var h=String(this);0>g&&(g=h.kmwLength()+g);0>g&&(g=0);var n=h.kmwCodePointToCodeUnit(g),e=n;if(null===n)return"";if(2>arguments.length)e=h.length;else for(var b=0;b<k;b++)e=h.kmwNextChar(e);return null===e?h.substring(n):h.substring(n,e)};
String.prototype.kmwSubstring=function(g,k){var h=String(this);if("undefined"==typeof k)g=h.kmwCodePointToCodeUnit(g),k=h.length;else{if(g>k){var n=g;g=k;k=n}g=h.kmwCodePointToCodeUnit(g);k=h.kmwCodePointToCodeUnit(k)}if(isNaN(g)||null===g)g=0;if(isNaN(k)||null===k)k=h.length;return h.substring(g,k)};
String.prototype.kmwNextChar=function(g){var k=String(this);if(null===g||0>g||g>=k.length-1)return null;var h=k.charCodeAt(g);return 55296<=h&&56319>=h&&k.length>g+1&&(h=k.charCodeAt(g+1),56320<=h&&57343>=h)?g==k.length-2?null:g+2:g+1};String.prototype.kmwPrevChar=function(g){var k=String(this);if(null==g||0>=g||g>k.length)return null;var h=k.charCodeAt(g-1);return 56320<=h&&57343>=h&&1<g&&(k=k.charCodeAt(g-2),55296<=k&&56319>=k)?g-2:g-1};
String.prototype.kmwCodePointToCodeUnit=function(g){if(null===g)return null;var k=String(this),h=0;if(0>g){h=k.length;for(var n=0;n>g;n--)h=k.kmwPrevChar(h);return h}if(g==k.kmwLength())return k.length;for(n=0;n<g;n++)h=k.kmwNextChar(h);return h};String.prototype.kmwCodeUnitToCodePoint=function(g){var k=String(this);return null===g?null:0==g?0:0>g?k.substr(g).kmwLength():k.substr(0,g).kmwLength()};String.prototype.kmwCharAt=function(g){var k=String(this);return 0<=g?k.kmwSubstr(g,1):""};
String.prototype.kmwBMPNextChar=function(g){var k=String(this);return 0>g||g>=k.length-1?null:g+1};String.prototype.kmwBMPPrevChar=function(g){var k=String(this);return 0>=g||g>k.length?null:g-1};String.prototype.kmwBMPCodePointToCodeUnit=function(g){return g};String.prototype.kmwBMPCodeUnitToCodePoint=function(g){return g};String.prototype.kmwBMPLength=function(){return String(this).length};
String.prototype.kmwBMPSubstr=function(g,k){var h=String(this);return-1<g?h.substr(g,k):h.substr(h.length+g,-g)};
String.kmwEnableSupplementaryPlane=function(g){var k=String.prototype;String._kmwFromCharCode=g?String.kmwFromCharCode:String.fromCharCode;k._kmwCharAt=g?k.kmwCharAt:k.charAt;k._kmwCharCodeAt=g?k.kmwCharCodeAt:k.charCodeAt;k._kmwIndexOf=g?k.kmwIndexOf:k.indexOf;k._kmwLastIndexOf=g?k.kmwLastIndexOf:k.lastIndexOf;k._kmwSlice=g?k.kmwSlice:k.slice;k._kmwSubstring=g?k.kmwSubstring:k.substring;k._kmwSubstr=g?k.kmwSubstr:k.kmwBMPSubstr;k._kmwLength=g?k.kmwLength:k.kmwBMPLength;k._kmwNextChar=g?k.kmwNextChar:
k.kmwBMPNextChar;k._kmwPrevChar=g?k.kmwPrevChar:k.kmwBMPPrevChar;k._kmwCodePointToCodeUnit=g?k.kmwCodePointToCodeUnit:k.kmwBMPCodePointToCodeUnit;k._kmwCodeUnitToCodePoint=g?k.kmwCodeUnitToCodePoint:k.kmwBMPCodeUnitToCodePoint};
(function(g){(function(g){(function(h){var g;(function(a){a.Chrome="chrome";a.Edge="edge";a.Firefox="firefox";a.Native="native";a.Opera="opera";a.Safari="safari";a.Other="other"})(g=h.Browser||(h.Browser={}));var e;(function(a){a.Windows="windows";a.macOS="macosx";a.Linux="linux";a.Android="android";a.iOS="ios";a.Other="other"})(e=h.OperatingSystem||(h.OperatingSystem={}));var b;(function(a){a.Desktop="desktop";a.Phone="phone";a.Tablet="tablet"})(b=h.FormFactor||(h.FormFactor={}));var a=function(){return function(a,
d,f,l){switch(a.toLowerCase()){case g.Chrome:case g.Edge:case g.Firefox:case g.Native:case g.Opera:case g.Safari:this.browser=a.toLowerCase();break;default:this.browser=g.Other}switch(d.toLowerCase()){case b.Desktop:case b.Phone:case b.Tablet:this.formFactor=d.toLowerCase();break;default:throw"Invalid form factor specified for device: "+d;}switch(f.toLowerCase()){case e.Windows.toLowerCase():case e.macOS.toLowerCase():case e.Linux.toLowerCase():case e.Android.toLowerCase():case e.iOS.toLowerCase():this.OS=
f.toLowerCase();break;default:this.OS=e.Other}this.touchable=l}}();h.DeviceSpec=a})(g.utils||(g.utils={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){(function(h){var e=function(){function b(){}b.constructInstance=function(){return new Worker(this.asBlobURI(LMLayerWorkerCode))};b.asBlobURI=function(a){a=h.LMLayer.unwrap(a);a=new Blob([a],{type:"text/javascript"});return URL.createObjectURL(a)};return b}();h.DefaultWorker=e})(h.prediction||(h.prediction={}))})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){var h=function(){return function(h,e,b){this.interface=h;this.keyboard=e;this.touchEnabled=b||!1}}();g.AttachmentInfo=h})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g,k){"function"===typeof define&&define.amd?define(k):"object"===typeof exports?module.exports=k():g.returnExports=k()})(this,function(){var g=Function.call.bind(Function.apply),k=Function.call.bind(Function.call),h=Array.isArray,n=Object.keys,e=function(a){try{return a(),!1}catch(C){return!0}},b=function(a){try{return a()}catch(C){return!1}},a=function(a){return function(){return!g(a,this,arguments)}}(e),c=function(){return!e(function(){return Object.defineProperty({},"x",{get:function(){}})})},
d=!!Object.defineProperty&&c(),f="foo"===function(){}.name,l=Function.call.bind(Array.prototype.forEach),q=Function.call.bind(Array.prototype.reduce),w=Function.call.bind(Array.prototype.filter),D=Function.call.bind(Array.prototype.some),u=function(a,c,b,f){!f&&c in a||(d?Object.defineProperty(a,c,{configurable:!0,enumerable:!1,writable:!0,value:b}):a[c]=b)},t=function(a,c,b){l(n(c),function(d){u(a,d,c[d],!!b)})},v=Function.call.bind(Object.prototype.toString),z="function"===typeof/abc/?function(a){return"function"===
typeof a&&"[object Function]"===v(a)}:function(a){return"function"===typeof a},r={getter:function(a,c,b){if(!d)throw new TypeError("getters require true ES5 support");Object.defineProperty(a,c,{configurable:!0,enumerable:!1,get:b})},proxy:function(a,c,b){if(!d)throw new TypeError("getters require true ES5 support");var f=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(b,c,{configurable:f.configurable,enumerable:f.enumerable,get:function(){return a[c]},set:function(b){a[c]=b}})},redefine:function(a,
c,b){if(d){var f=Object.getOwnPropertyDescriptor(a,c);f.value=b;Object.defineProperty(a,c,f)}else a[c]=b},defineByDescriptor:function(a,c,b){d?Object.defineProperty(a,c,b):"value"in b&&(a[c]=b.value)},preserveToString:function(a,c){c&&z(c.toString)&&u(a,"toString",c.toString.bind(c),!0)}},y=Object.create||function(a,c){var b=function(){};b.prototype=a;var d=new b;"undefined"!==typeof c&&n(c).forEach(function(a){r.defineByDescriptor(d,a,c[a])});return d},A=function(a,c){return Object.setPrototypeOf?
b(function(){var b=function xa(c){c=new a(c);Object.setPrototypeOf(c,xa.prototype);return c};Object.setPrototypeOf(b,a);b.prototype=y(a.prototype,{constructor:{value:b}});return c(b)}):!1},p=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),H=p.isFinite,qa=Function.call.bind(String.prototype.indexOf),wa=Function.apply.bind(Array.prototype.indexOf),Y=Function.call.bind(Array.prototype.concat),
N=Function.call.bind(String.prototype.slice),S=Function.call.bind(Array.prototype.push),Xb=Function.apply.bind(Array.prototype.push),Yb=Function.call.bind(Array.prototype.shift),T=Math.max,V=Math.min,O=Math.floor,E=Math.abs,K=Math.exp,W=Math.log,Z=Math.sqrt,ha=Function.call.bind(Object.prototype.hasOwnProperty),aa=function(){},F=p.Map,pa=F&&F.prototype["delete"],da=F&&F.prototype.get,ba=F&&F.prototype.has,ea=F&&F.prototype.set,B=p.Symbol||{},ra=B.species||"@@species",I=Number.isNaN||function(a){return a!==
a},ya=Number.isFinite||function(a){return"number"===typeof a&&H(a)},ca=z(Math.sign)?Math.sign:function(a){a=Number(a);return 0===a||I(a)?a:0>a?-1:1},fa=function(a){a=Number(a);return-1>a||I(a)?NaN:0===a||Infinity===a?a:-1===a?-Infinity:0===1+a-1?a:a*(W(1+a)/(1+a-1))},Ka=function(a){return"[object Arguments]"===v(a)},La=function(a){return null!==a&&"object"===typeof a&&"number"===typeof a.length&&0<=a.length&&"[object Array]"!==v(a)&&"[object Function]"===v(a.callee)},sa=Ka(arguments)?Ka:La,G={primitive:function(a){return null===
a||"function"!==typeof a&&"object"!==typeof a},string:function(a){return"[object String]"===v(a)},regex:function(a){return"[object RegExp]"===v(a)},symbol:function(a){return"function"===typeof p.Symbol&&"symbol"===typeof a}},x=function(a,c,b){var d=a[c];u(a,c,b,!0);r.preserveToString(a[c],d)},ta="function"===typeof B&&"function"===typeof B["for"]&&G.symbol(B()),P=G.symbol(B.iterator)?B.iterator:"_es6-shim iterator_";p.Set&&"function"===typeof(new p.Set)["@@iterator"]&&(P="@@iterator");p.Reflect||
u(p,"Reflect",{},!0);var ia=p.Reflect,Ma=String,Na="undefined"!==typeof document&&document?document.all:null,U=null==Na?function(a){return null==a}:function(a){return null==a&&a!==Na},m={Call:function(a,c){var b=2<arguments.length?arguments[2]:[];if(!m.IsCallable(a))throw new TypeError(a+" is not a function");return g(a,c,b)},RequireObjectCoercible:function(a,c){if(U(a))throw new TypeError(c||"Cannot call method on "+a);return a},TypeIsObject:function(a){return void 0===a||null===a||!0===a||!1===
a?!1:"function"===typeof a||"object"===typeof a||a===Na},ToObject:function(a,c){return Object(m.RequireObjectCoercible(a,c))},IsCallable:z,IsConstructor:function(a){return m.IsCallable(a)},ToInt32:function(a){return m.ToNumber(a)>>0},ToUint32:function(a){return m.ToNumber(a)>>>0},ToNumber:function(a){if("[object Symbol]"===v(a))throw new TypeError("Cannot convert a Symbol value to a number");return+a},ToInteger:function(a){a=m.ToNumber(a);return I(a)?0:0!==a&&ya(a)?(0<a?1:-1)*O(E(a)):a},ToLength:function(a){a=
m.ToInteger(a);return 0>=a?0:a>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a},SameValue:function(a,c){return a===c?0===a?1/a===1/c:!0:I(a)&&I(c)},SameValueZero:function(a,c){return a===c||I(a)&&I(c)},IsIterable:function(a){return m.TypeIsObject(a)&&("undefined"!==typeof a[P]||sa(a))},GetIterator:function(a){if(sa(a))return new ja(a,"value");var c=m.GetMethod(a,P);if(!m.IsCallable(c))throw new TypeError("value is not an iterable");a=m.Call(c,a);if(!m.TypeIsObject(a))throw new TypeError("bad iterator");
return a},GetMethod:function(a,c){a=m.ToObject(a)[c];if(!U(a)){if(!m.IsCallable(a))throw new TypeError("Method not callable: "+c);return a}},IteratorComplete:function(a){return!!a.done},IteratorClose:function(a,c){var b=m.GetMethod(a,"return");if(void 0!==b){try{var d=m.Call(b,a)}catch(xa){var f=xa}if(!c){if(f)throw f;if(!m.TypeIsObject(d))throw new TypeError("Iterator's return method returned a non-object.");}}},IteratorNext:function(a){var c=1<arguments.length?a.next(arguments[1]):a.next();if(!m.TypeIsObject(c))throw new TypeError("bad iterator");
return c},IteratorStep:function(a){a=m.IteratorNext(a);return m.IteratorComplete(a)?!1:a},Construct:function(a,c,b,d){b="undefined"===typeof b?a:b;if(!d&&ia.construct)return ia.construct(a,c,b);d=b.prototype;m.TypeIsObject(d)||(d=Object.prototype);d=y(d);a=m.Call(a,d,c);return m.TypeIsObject(a)?a:d},SpeciesConstructor:function(a,c){a=a.constructor;if(void 0===a)return c;if(!m.TypeIsObject(a))throw new TypeError("Bad constructor");a=a[ra];if(U(a))return c;if(!m.IsConstructor(a))throw new TypeError("Bad @@species");
return a},CreateHTML:function(a,c,b,d){a=m.ToString(a);var f="<"+c;""!==b&&(d=m.ToString(d).replace(/"/g,"&quot;"),f+=" "+b+'="'+d+'"');return f+">"+a+"</"+c+">"},IsRegExp:function(a){if(!m.TypeIsObject(a))return!1;var c=a[B.match];return"undefined"!==typeof c?!!c:G.regex(a)},ToString:function(a){return Ma(a)}};if(d&&ta){var za=function(a){if(G.symbol(B[a]))return B[a];var c=B["for"]("Symbol."+a);Object.defineProperty(B,a,{configurable:!1,enumerable:!1,writable:!1,value:c});return c};if(!G.symbol(B.search)){var fb=
za("search"),gb=String.prototype.search;u(RegExp.prototype,fb,function(a){return m.Call(gb,a,[this])});x(String.prototype,"search",function(a){var c=m.RequireObjectCoercible(this);if(!U(a)){var b=m.GetMethod(a,fb);if("undefined"!==typeof b)return m.Call(b,a,[c])}return m.Call(gb,c,[m.ToString(a)])})}if(!G.symbol(B.replace)){var hb=za("replace"),ib=String.prototype.replace;u(RegExp.prototype,hb,function(a,c){return m.Call(ib,a,[this,c])});x(String.prototype,"replace",function(a,c){var b=m.RequireObjectCoercible(this);
if(!U(a)){var d=m.GetMethod(a,hb);if("undefined"!==typeof d)return m.Call(d,a,[b,c])}return m.Call(ib,b,[m.ToString(a),c])})}if(!G.symbol(B.split)){var jb=za("split"),kb=String.prototype.split;u(RegExp.prototype,jb,function(a,c){return m.Call(kb,a,[this,c])});x(String.prototype,"split",function(a,c){var b=m.RequireObjectCoercible(this);if(!U(a)){var d=m.GetMethod(a,jb);if("undefined"!==typeof d)return m.Call(d,a,[b,c])}return m.Call(kb,b,[m.ToString(a),c])})}var lb=G.symbol(B.match),Zb=lb&&function(){var a=
{};a[B.match]=function(){return 42};return 42!=="a".match(a)}();if(!lb||Zb){var mb=za("match"),nb=String.prototype.match;u(RegExp.prototype,mb,function(a){return m.Call(nb,a,[this])});x(String.prototype,"match",function(a){var c=m.RequireObjectCoercible(this);if(!U(a)){var b=m.GetMethod(a,mb);if("undefined"!==typeof b)return m.Call(b,a,[c])}return m.Call(nb,c,[m.ToString(a)])})}}var ob=function(a,c,b){r.preserveToString(c,a);Object.setPrototypeOf&&Object.setPrototypeOf(a,c);d?l(Object.getOwnPropertyNames(a),
function(d){d in aa||b[d]||r.proxy(a,d,c)}):l(Object.keys(a),function(d){d in aa||b[d]||(c[d]=a[d])});c.prototype=a.prototype;r.redefine(a.prototype,"constructor",c)},$b=function(){return this},ua=function(a){d&&!ha(a,ra)&&r.getter(a,ra,$b)},Q=function(a,c){c=c||function(){return this};u(a,P,c);!a[P]&&G.symbol(P)&&(a[P]=c)},pb=function(a,c,b){d?Object.defineProperty(a,c,{configurable:!0,enumerable:!0,writable:!0,value:b}):a[c]=b;if(!m.SameValue(a[c],b))throw new TypeError("property is nonconfigurable");
},Oa=function(a,c,b,d){if(!m.TypeIsObject(a))throw new TypeError("Constructor requires `new`: "+c.name);a=c.prototype;m.TypeIsObject(a)||(a=b);b=y(a);for(var f in d)ha(d,f)&&u(b,f,d[f],!0);return b};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var ac=String.fromCodePoint;x(String,"fromCodePoint",function(a){return m.Call(ac,this,arguments)})}var qb={fromCodePoint:function(a){for(var c=[],b,d=0,f=arguments.length;d<f;d++){b=Number(arguments[d]);if(!m.SameValue(b,m.ToInteger(b))||0>b||
1114111<b)throw new RangeError("Invalid code point "+b);65536>b?S(c,String.fromCharCode(b)):(b-=65536,S(c,String.fromCharCode((b>>10)+55296)),S(c,String.fromCharCode(b%1024+56320)))}return c.join("")},raw:function(a){var c=m.ToObject(a,"bad callSite");c=m.ToObject(c.raw,"bad raw value");var b=m.ToLength(c.length);if(0>=b)return"";for(var d=[],f=0,l;f<b;){l=m.ToString(f);l=m.ToString(c[l]);S(d,l);if(f+1>=b)break;l=f+1<arguments.length?arguments[f+1]:"";l=m.ToString(l);S(d,l);f+=1}return d.join("")}};
String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&x(String,"raw",qb.raw);t(String,qb);var bc=function Ia(a,c){if(1>c)return"";if(c%2)return Ia(a,c-1)+a;a=Ia(a,c/2);return a+a},ka={repeat:function(a){var c=m.ToString(m.RequireObjectCoercible(this));a=m.ToInteger(a);if(0>a||Infinity<=a)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return bc(c,a)},startsWith:function(a){var c=m.ToString(m.RequireObjectCoercible(this));if(m.IsRegExp(a))throw new TypeError('Cannot call method "startsWith" with a regex');
var b=m.ToString(a),d;1<arguments.length&&(d=arguments[1]);d=T(m.ToInteger(d),0);return N(c,d,d+b.length)===b},endsWith:function(a){var c=m.ToString(m.RequireObjectCoercible(this));if(m.IsRegExp(a))throw new TypeError('Cannot call method "endsWith" with a regex');var b=m.ToString(a),d=c.length,f;1<arguments.length&&(f=arguments[1]);f="undefined"===typeof f?d:m.ToInteger(f);d=V(T(f,0),d);return N(c,d-b.length,d)===b},includes:function(a){if(m.IsRegExp(a))throw new TypeError('"includes" does not accept a RegExp');
var c=m.ToString(a),b;1<arguments.length&&(b=arguments[1]);return-1!==qa(this,c,b)},codePointAt:function(a){var c=m.ToString(m.RequireObjectCoercible(this)),b=m.ToInteger(a),d=c.length;if(0<=b&&b<d){a=c.charCodeAt(b);if(55296>a||56319<a||b+1===d)return a;c=c.charCodeAt(b+1);return 56320>c||57343<c?a:1024*(a-55296)+(c-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&x(String.prototype,"includes",ka.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var cc=
e(function(){return"/a/".startsWith(/a/)}),dc=b(function(){return!1==="abc".startsWith("a",Infinity)});cc&&dc||(x(String.prototype,"startsWith",ka.startsWith),x(String.prototype,"endsWith",ka.endsWith))}ta&&(b(function(){var a=/a/;a[B.match]=!1;return"/a/".startsWith(a)})||x(String.prototype,"startsWith",ka.startsWith),b(function(){var a=/a/;a[B.match]=!1;return"/a/".endsWith(a)})||x(String.prototype,"endsWith",ka.endsWith),b(function(){var a=/a/;a[B.match]=!1;return"/a/".includes(a)})||x(String.prototype,
"includes",ka.includes));t(String.prototype,ka);var ec=/(^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)/g,rb=function(){return m.ToString(m.RequireObjectCoercible(this)).replace(ec,"")},sb=/[\u0085\u200b\ufffe]/g,tb=/^[-+]0x[0-9a-f]+$/i;u(String.prototype,"trim",rb,!0);
var la=function(a){return{value:a,done:0===arguments.length}},Pa=function(a){m.RequireObjectCoercible(a);this._s=m.ToString(a);this._i=0};Pa.prototype.next=function(){var a=this._s,c=this._i;if("undefined"===typeof a||c>=a.length)return this._s=void 0,la();var b=a.charCodeAt(c);55296>b||56319<b||c+1===a.length?b=1:(b=a.charCodeAt(c+1),b=56320>b||57343<b?1:2);this._i=c+b;return la(a.substr(c,b))};Q(Pa.prototype);Q(String.prototype,function(){return new Pa(this)});var Aa={from:function(a){var c;1<arguments.length&&
(c=arguments[1]);var b;if("undefined"===typeof c)var d=!1;else{if(!m.IsCallable(c))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(b=arguments[2]);d=!0}var f;if("undefined"!==typeof(sa(a)||m.GetMethod(a,P))){var l=m.IsConstructor(this)?Object(new this):[];var C=m.GetIterator(a);for(f=0;;){var q=m.IteratorStep(C);if(!1===q)break;q=q.value;try{d&&(q="undefined"===typeof b?c(q,f):k(c,b,q,f)),l[f]=q}catch(fc){throw m.IteratorClose(C,!0),fc;
}f+=1}C=f}else for(q=m.ToObject(a),C=m.ToLength(q.length),l=m.IsConstructor(this)?Object(new this(C)):Array(C),f=0;f<C;++f){var e=q[f];d&&(e="undefined"===typeof b?c(e,f):k(c,b,e,f));pb(l,f,e)}l.length=C;return l},of:function(){for(var a=arguments.length,c=h(this)||!m.IsCallable(this)?Array(a):m.Construct(this,[a]),b=0;b<a;++b)pb(c,b,arguments[b]);c.length=a;return c}};t(Array,Aa);ua(Array);var ja=function(a,c){this.i=0;this.array=a;this.kind=c};t(ja.prototype,{next:function(){var a=this.i,c=this.array;
if(!(this instanceof ja))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof c)for(var b=m.ToLength(c.length);a<b;){b=this.kind;var d;"key"===b?d=a:"value"===b?d=c[a]:"entry"===b&&(d=[a,c[a]]);this.i=a+1;return la(d)}this.array=void 0;return la()}});Q(ja.prototype);Array.of===Aa.of||function(){var a=function(a){this.length=a};a.prototype=[];var c=Array.of.apply(a,[1,2]);return c instanceof a&&2===c.length}()||x(Array,"of",Aa.of);var Ta={copyWithin:function(a,c){var b=m.ToObject(this),
d=m.ToLength(b.length),f=m.ToInteger(a),l=m.ToInteger(c);f=0>f?T(d+f,0):V(f,d);l=0>l?T(d+l,0):V(l,d);var C;2<arguments.length&&(C=arguments[2]);C="undefined"===typeof C?d:m.ToInteger(C);C=0>C?T(d+C,0):V(C,d);d=V(C-l,d-f);C=1;l<f&&f<l+d&&(C=-1,l+=d-1,f+=d-1);for(;0<d;)l in b?b[f]=b[l]:delete b[f],l+=C,f+=C,--d;return b},fill:function(a){var c;1<arguments.length&&(c=arguments[1]);var b;2<arguments.length&&(b=arguments[2]);var d=m.ToObject(this),f=m.ToLength(d.length);c=m.ToInteger("undefined"===typeof c?
0:c);b=m.ToInteger("undefined"===typeof b?f:b);c=0>c?T(f+c,0):V(c,f);for(b=0>b?f+b:b;c<f&&c<b;++c)d[c]=a;return d},find:function(a){var c=m.ToObject(this),b=m.ToLength(c.length);if(!m.IsCallable(a))throw new TypeError("Array#find: predicate must be a function");for(var d=1<arguments.length?arguments[1]:null,f=0,l;f<b;f++)if(l=c[f],d){if(k(a,d,l,f,c))return l}else if(a(l,f,c))return l},findIndex:function(a){var c=m.ToObject(this),b=m.ToLength(c.length);if(!m.IsCallable(a))throw new TypeError("Array#findIndex: predicate must be a function");
for(var d=1<arguments.length?arguments[1]:null,f=0;f<b;f++)if(d){if(k(a,d,c[f],f,c))return f}else if(a(c[f],f,c))return f;return-1},keys:function(){return new ja(this,"key")},values:function(){return new ja(this,"value")},entries:function(){return new ja(this,"entry")}};Array.prototype.keys&&!m.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!m.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&
Array.prototype[P]&&(t(Array.prototype,{values:Array.prototype[P]}),G.symbol(B.unscopables)&&(Array.prototype[B.unscopables].values=!0));if(f&&Array.prototype.values&&"values"!==Array.prototype.values.name){var gc=Array.prototype.values;x(Array.prototype,"values",function(){return m.Call(gc,this,arguments)});u(Array.prototype,P,Array.prototype.values,!0)}t(Array.prototype,Ta);0>1/[!0].indexOf(!0,-0)&&u(Array.prototype,"indexOf",function(a){var c=wa(this,arguments);return 0===c&&0>1/c?0:c},!0);Q(Array.prototype,
function(){return this.values()});Object.getPrototypeOf&&Q(Object.getPrototypeOf([].values()));var hc=function(){return b(function(){return 0===Array.from({length:-1}).length})}(),ic=function(){var a=Array.from([0].entries());return 1===a.length&&h(a[0])&&0===a[0][0]&&0===a[0][1]}();hc&&ic||x(Array,"from",Aa.from);if(!function(){return b(function(){return Array.from([0],void 0)})}()){var ub=Array.from;x(Array,"from",function(a){return 1<arguments.length&&"undefined"!==typeof arguments[1]?m.Call(ub,
this,arguments):k(ub,this,a)})}var jc=-(Math.pow(2,32)-1),ma=function(a,c){var d={length:jc};d[c?(d.length>>>0)-1:0]=!0;return b(function(){k(a,d,function(){throw new RangeError("should not reach here");},[]);return!0})};if(!ma(Array.prototype.forEach)){var kc=Array.prototype.forEach;x(Array.prototype,"forEach",function(a){return m.Call(kc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.map)){var lc=Array.prototype.map;x(Array.prototype,"map",function(a){return m.Call(lc,0<=this.length?
this:[],arguments)},!0)}if(!ma(Array.prototype.filter)){var mc=Array.prototype.filter;x(Array.prototype,"filter",function(a){return m.Call(mc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.some)){var nc=Array.prototype.some;x(Array.prototype,"some",function(a){return m.Call(nc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.every)){var oc=Array.prototype.every;x(Array.prototype,"every",function(a){return m.Call(oc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.reduce)){var pc=
Array.prototype.reduce;x(Array.prototype,"reduce",function(a){return m.Call(pc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.reduceRight,!0)){var qc=Array.prototype.reduceRight;x(Array.prototype,"reduceRight",function(a){return m.Call(qc,0<=this.length?this:[],arguments)},!0)}var rc=8!==Number("0o10"),sc=2!==Number("0b10"),tc=D("\u0085\u200b\ufffe",function(a){return 0===Number(a+0+a)});if(rc||sc||tc){var X=Number,vb=/^0b[01]+$/i,wb=/^0o[0-7]+$/i,uc=vb.test.bind(vb),vc=wb.test.bind(wb),
wc=function(a){if("function"===typeof a.valueOf){var c=a.valueOf();if(G.primitive(c))return c}if("function"===typeof a.toString&&(c=a.toString(),G.primitive(c)))return c;throw new TypeError("No default value");},xc=sb.test.bind(sb),yc=tb.test.bind(tb),Ba=function(){var a=function(c){var d=0<arguments.length?G.primitive(c)?c:wc(c,"number"):0;if("string"===typeof d)if(d=m.Call(rb,d),uc(d))d=parseInt(N(d,2),2);else if(vc(d))d=parseInt(N(d,2),8);else if(xc(d)||yc(d))d=NaN;var f=this,l=b(function(){X.prototype.valueOf.call(f);
return!0});return f instanceof a&&!l?new X(d):X(d)};return a}();ob(X,Ba,{});t(Ba,{NaN:X.NaN,MAX_VALUE:X.MAX_VALUE,MIN_VALUE:X.MIN_VALUE,NEGATIVE_INFINITY:X.NEGATIVE_INFINITY,POSITIVE_INFINITY:X.POSITIVE_INFINITY});Number=Ba;r.redefine(p,"Number",Ba)}var xb=Math.pow(2,53)-1;t(Number,{MAX_SAFE_INTEGER:xb,MIN_SAFE_INTEGER:-xb,EPSILON:2.220446049250313E-16,parseInt:p.parseInt,parseFloat:p.parseFloat,isFinite:ya,isInteger:function(a){return ya(a)&&m.ToInteger(a)===a},isSafeInteger:function(a){return Number.isInteger(a)&&
E(a)<=Number.MAX_SAFE_INTEGER},isNaN:I});u(Number,"parseInt",p.parseInt,Number.parseInt!==p.parseInt);1===[,1].find(function(){return!0})&&x(Array.prototype,"find",Ta.find);0!==[,1].findIndex(function(){return!0})&&x(Array.prototype,"findIndex",Ta.findIndex);var yb=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Ca=function(a,c){d&&yb(a,c)&&Object.defineProperty(a,c,{enumerable:!1})},zc=function(){var a=Number(this),c=arguments.length,b=c-a;b=Array(0>b?0:b);for(var d=a;d<c;++d)b[d-
a]=arguments[d];return b},zb=function(a){return function(c,b){c[b]=a[b];return c}},Ac=function(a,c){var b=n(Object(c)),d;m.IsCallable(Object.getOwnPropertySymbols)&&(d=w(Object.getOwnPropertySymbols(Object(c)),yb(c)));return q(Y(b,d||[]),zb(c),a)},Ab={assign:function(a,c){var b=m.ToObject(a,"Cannot convert undefined or null to object");return q(m.Call(zc,1,arguments),Ac,b)},is:function(a,c){return m.SameValue(a,c)}};Object.assign&&Object.preventExtensions&&function(){var a=Object.preventExtensions({1:2});
try{Object.assign(a,"xy")}catch(L){return"y"===a[1]}}()&&x(Object,"assign",Ab.assign);t(Object,Ab);if(d){var Bc={setPrototypeOf:function(a,c){var b=function(a,c){if(!m.TypeIsObject(a))throw new TypeError("cannot set prototype on a non-object");if(null!==c&&!m.TypeIsObject(c))throw new TypeError("can only set prototype to an object or null"+c);k(d,a,c);return a};try{var d=a.getOwnPropertyDescriptor(a.prototype,c).set;k(d,{},null)}catch(xa){if(a.prototype!=={}[c])return;d=function(a){this[c]=a};b.polyfill=
b(b({},null),a.prototype)instanceof a}return b}(Object,"__proto__")};t(Object,Bc)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&function(){var a=Object.create(null),c=Object.getPrototypeOf,b=Object.setPrototypeOf;Object.getPrototypeOf=function(b){b=c(b);return b===a?null:b};Object.setPrototypeOf=function(c,d){return b(c,null===d?a:d)};Object.setPrototypeOf.polyfill=!1}();if(e(function(){return Object.keys("foo")})){var Cc=
Object.keys;x(Object,"keys",function(a){return Cc(m.ToObject(a))});n=Object.keys}if(e(function(){return Object.keys(/a/g)})){var Dc=Object.keys;x(Object,"keys",function(a){if(G.regex(a)){var c=[],b;for(b in a)ha(a,b)&&S(c,b);return c}return Dc(a)});n=Object.keys}if(Object.getOwnPropertyNames&&e(function(){return Object.getOwnPropertyNames("foo")})){var Ec="object"===typeof window?Object.getOwnPropertyNames(window):[],Bb=Object.getOwnPropertyNames;x(Object,"getOwnPropertyNames",function(a){a=m.ToObject(a);
if("[object Window]"===v(a))try{return Bb(a)}catch(L){return Y([],Ec)}return Bb(a)})}if(Object.getOwnPropertyDescriptor&&e(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var Fc=Object.getOwnPropertyDescriptor;x(Object,"getOwnPropertyDescriptor",function(a,c){return Fc(m.ToObject(a),c)})}if(Object.seal&&e(function(){return Object.seal("foo")})){var Gc=Object.seal;x(Object,"seal",function(a){return m.TypeIsObject(a)?Gc(a):a})}if(Object.isSealed&&e(function(){return Object.isSealed("foo")})){var Hc=
Object.isSealed;x(Object,"isSealed",function(a){return m.TypeIsObject(a)?Hc(a):!0})}if(Object.freeze&&e(function(){return Object.freeze("foo")})){var Ic=Object.freeze;x(Object,"freeze",function(a){return m.TypeIsObject(a)?Ic(a):a})}if(Object.isFrozen&&e(function(){return Object.isFrozen("foo")})){var Jc=Object.isFrozen;x(Object,"isFrozen",function(a){return m.TypeIsObject(a)?Jc(a):!0})}if(Object.preventExtensions&&e(function(){return Object.preventExtensions("foo")})){var Kc=Object.preventExtensions;
x(Object,"preventExtensions",function(a){return m.TypeIsObject(a)?Kc(a):a})}if(Object.isExtensible&&e(function(){return Object.isExtensible("foo")})){var Lc=Object.isExtensible;x(Object,"isExtensible",function(a){return m.TypeIsObject(a)?Lc(a):!1})}if(Object.getPrototypeOf&&e(function(){return Object.getPrototypeOf("foo")})){var Mc=Object.getPrototypeOf;x(Object,"getPrototypeOf",function(a){return Mc(m.ToObject(a))})}var Nc=d&&function(){var a=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");
return a&&m.IsCallable(a.get)}();d&&!Nc&&r.getter(RegExp.prototype,"flags",function(){if(!m.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var a="";this.global&&(a+="g");this.ignoreCase&&(a+="i");this.multiline&&(a+="m");this.unicode&&(a+="u");this.sticky&&(a+="y");return a});var Oc=d&&b(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Pc=ta&&d&&function(){var a=/./;a[B.match]=!1;return RegExp(a)===a}(),Cb=b(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),
Qc=Cb&&b(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!Cb||!Qc){var Db=RegExp.prototype.toString;u(RegExp.prototype,"toString",function(){var a=m.RequireObjectCoercible(this);if(G.regex(a))return k(Db,a);var c=Ma(a.source);a=Ma(a.flags);return"/"+c+"/"+a},!0);r.preserveToString(RegExp.prototype.toString,Db)}if(d&&(!Oc||Pc)){var Rc=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,Eb=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},
Sc=function(){return this.source},Tc=m.IsCallable(Eb.get)?Eb.get:Sc,Fb=RegExp,Ua=function(){return function Ja(a,c){var b=m.IsRegExp(a);return this instanceof Ja||!b||"undefined"!==typeof c||a.constructor!==Ja?G.regex(a)?(b=m.Call(Tc,a),a="undefined"===typeof c?m.Call(Rc,a):c,new Ja(b,a)):new Fb(a,c):a}}();ob(Fb,Ua,{$input:!0});RegExp=Ua;r.redefine(p,"RegExp",Ua)}if(d){var Va={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Va),function(a){a in RegExp&&!(Va[a]in RegExp)&&
r.getter(RegExp,Va[a],function(){return RegExp[a]})})}ua(RegExp);var Da=1/Number.EPSILON,Ea=Math.pow(2,-23),Uc=Math.pow(2,127)*(2-Ea),Wa=Math.pow(2,-126),oa=Math.E,Fa=Math.LOG2E,Vc=Math.LOG10E,Gb=Number.prototype.clz;delete Number.prototype.clz;var J={acosh:function(a){var c=Number(a);if(I(c)||1>a)return NaN;if(1===c)return 0;if(Infinity===c)return c;a=1/(c*c);if(2>c)return fa(c-1+Z(1-a)*c);c/=2;return fa(c+Z(1-a)*c-1)+1/Fa},asinh:function(a){var c=Number(a);if(0===c||!H(c))return c;a=E(c);var b=
a*a;c=ca(c);return 1>a?c*fa(a+b/(Z(b+1)+1)):c*(fa(a/2+Z(1+1/b)*a/2-1)+1/Fa)},atanh:function(a){a=Number(a);if(0===a)return a;if(-1===a)return-Infinity;if(1===a)return Infinity;if(I(a)||-1>a||1<a)return NaN;var c=E(a);return ca(a)*fa(2*c/(1-c))/2},cbrt:function(a){a=Number(a);if(0===a)return a;var c=0>a;c&&(a=-a);if(Infinity===a)var b=Infinity;else b=K(W(a)/3),b=(a/(b*b)+2*b)/3;return c?-b:b},clz32:function(a){a=m.ToUint32(Number(a));return 0===a?32:Gb?m.Call(Gb,a):31-O(W(a+.5)*Fa)},cosh:function(a){a=
Number(a);if(0===a)return 1;if(I(a))return NaN;if(!H(a))return Infinity;a=K(E(a)-1);return oa/2*(a+1/(a*oa*oa))},expm1:function(a){a=Number(a);if(-Infinity===a)return-1;if(!H(a)||0===a)return a;if(.5<E(a))return K(a)-1;for(var c=a,b=0,d=1;b+c!==b;)b+=c,d+=1,c*=a/d;return b},hypot:function(a,c){for(var b=0,d=0,f=0;f<arguments.length;++f){var l=E(Number(arguments[f]));d<l?(b*=d/l*(d/l),b+=1,d=l):b+=0<l?l/d*(l/d):l}return Infinity===d?Infinity:d*Z(b)},log2:function(a){return W(a)*Fa},log10:function(a){return W(a)*
Vc},log1p:fa,sign:ca,sinh:function(a){a=Number(a);if(!H(a)||0===a)return a;var c=E(a);if(1>c)return c=Math.expm1(c),ca(a)*c*(1+1/(c+1))/2;c=K(c-1);return ca(a)*(c-1/(c*oa*oa))*(oa/2)},tanh:function(a){a=Number(a);return I(a)||0===a?a:20<=a?1:-20>=a?-1:(Math.expm1(a)-Math.expm1(-a))/(K(a)+K(-a))},trunc:function(a){a=Number(a);return 0>a?-O(-a):O(a)},imul:function(a,c){a=m.ToUint32(a);c=m.ToUint32(c);var b=a&65535,d=c&65535;return b*d+((a>>>16&65535)*d+b*(c>>>16&65535)<<16>>>0)|0},fround:function(a){var c=
Number(a);if(0===c||Infinity===c||-Infinity===c||I(c))return c;a=ca(c);c=E(c);if(c<Wa)return a*(c/Wa/Ea+Da-Da)*Wa*Ea;var b=(1+Ea/Number.EPSILON)*c;c=b-(b-c);return c>Uc||I(c)?Infinity*a:a*c}};t(Math,J);u(Math,"sinh",J.sinh,Infinity===Math.sinh(710));u(Math,"cosh",J.cosh,Infinity===Math.cosh(710));u(Math,"log1p",J.log1p,-1E-17!==Math.log1p(-1E-17));u(Math,"asinh",J.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));u(Math,"asinh",J.asinh,Infinity===Math.asinh(1E300));u(Math,"atanh",J.atanh,0===Math.atanh(1E-300));
u(Math,"tanh",J.tanh,-2E-17!==Math.tanh(-2E-17));u(Math,"acosh",J.acosh,Infinity===Math.acosh(Number.MAX_VALUE));u(Math,"acosh",J.acosh,!(8>E(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));u(Math,"cbrt",J.cbrt,!(8>E(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));u(Math,"sinh",J.sinh,-2E-17!==Math.sinh(-2E-17));var Hb=Math.expm1(10);u(Math,"expm1",J.expm1,22025.465794806718<Hb||22025.465794806718>Hb);var Wc=Math.round,Xc=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+
Number.EPSILON/3.99),Yc=[Da+1,2*Da-1].every(function(a){return Math.round(a)===a});u(Math,"round",function(a){var c=O(a);return.5>a-c?c:-1===c?-0:c+1},!Xc||!Yc);r.preserveToString(Math.round,Wc);var Ib=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=J.imul,r.preserveToString(Math.imul,Ib));2!==Math.imul.length&&x(Math,"imul",function(a,c){return m.Call(Ib,Math,arguments)});var Ga=function(){var a=p.setTimeout;if("function"===typeof a||"object"===typeof a){m.IsPromise=function(a){return m.TypeIsObject(a)&&
"undefined"!==typeof a._promise?!0:!1};var c=function(a){if(!m.IsConstructor(a))throw new TypeError("Bad promise constructor");var c=this;c.resolve=void 0;c.reject=void 0;c.promise=new a(function(a,b){if(void 0!==c.resolve||void 0!==c.reject)throw new TypeError("Bad Promise implementation!");c.resolve=a;c.reject=b});if(!m.IsCallable(c.resolve)||!m.IsCallable(c.reject))throw new TypeError("Bad promise constructor");},b;"undefined"!==typeof window&&m.IsCallable(window.postMessage)&&(b=function(){var a=
[];window.addEventListener("message",function(c){c.source===window&&"zero-timeout-message"===c.data&&(c.stopPropagation(),0!==a.length&&Yb(a)())},!0);return function(c){S(a,c);window.postMessage("zero-timeout-message","*")}});var d=function(){var a=p.Promise,c=a&&a.resolve&&a.resolve();return c&&function(a){return c.then(a)}},f=m.IsCallable(p.setImmediate)?p.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:d()||(m.IsCallable(b)?b():function(c){a(c,0)}),l=function(a){return a},
q=function(a){throw a;},e={},h=function(a,c,b){f(function(){if(c===e)a(b);else{try{var d=a(b);var f=c.resolve}catch(Xa){d=Xa,f=c.reject}f(d)}})},g=function(a,c){var b=a._promise,d=b.reactionLength;if(0<d&&(h(b.fulfillReactionHandler0,b.reactionCapability0,c),b.fulfillReactionHandler0=void 0,b.rejectReactions0=void 0,b.reactionCapability0=void 0,1<d))for(var f=1,l=0;f<d;f++,l+=3)h(b[l+0],b[l+2],c),a[l+0]=void 0,a[l+1]=void 0,a[l+2]=void 0;b.result=c;b.state=1;b.reactionLength=0},w=function(a,c){var b=
a._promise,d=b.reactionLength;if(0<d&&(h(b.rejectReactionHandler0,b.reactionCapability0,c),b.fulfillReactionHandler0=void 0,b.rejectReactions0=void 0,b.reactionCapability0=void 0,1<d))for(var f=1,l=0;f<d;f++,l+=3)h(b[l+1],b[l+2],c),a[l+0]=void 0,a[l+1]=void 0,a[l+2]=void 0;b.result=c;b.state=2;b.reactionLength=0},r=function(a){var c=!1;return{resolve:function(b){if(!c){c=!0;if(b===a)return w(a,new TypeError("Self resolution"));if(!m.TypeIsObject(b))return g(a,b);try{var d=b.then}catch(Zc){return w(a,
Zc)}if(!m.IsCallable(d))return g(a,b);f(function(){var c=d,f=r(a),l=f.resolve;f=f.reject;try{v(c,b,l,f)}catch($c){f($c)}})}},reject:function(b){if(!c)return c=!0,w(a,b)}}},v=function(a,c,b,d){a===A?k(a,c,b,d,e):k(a,c,b,d)},y=function(){var a=function(c){if(!(this instanceof a))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!m.IsCallable(c))throw new TypeError("not a valid resolver");var b=Oa(this,a,z,{_promise:{result:void 0,
state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),d=r(b),f=d.reject;try{c(d.resolve,f)}catch(Xa){f(Xa)}return b};return a}();var z=y.prototype;var D=function(a,c,b,d){var f=!1;return function(l){f||(f=!0,c[a]=l,0===--d.count&&(l=b.resolve,l(c)))}};t(y,{all:function(a){if(!m.TypeIsObject(this))throw new TypeError("Promise is not object");var b=new c(this),d;try{var f=m.GetIterator(a);a=d={iterator:f,done:!1};for(var l=a.iterator,C=[],
q={count:1},e,h,g=0;;){try{e=m.IteratorStep(l);if(!1===e){a.done=!0;break}h=e.value}catch(Za){throw a.done=!0,Za;}C[g]=void 0;var k=this.resolve(h),w=D(g,C,b,q);q.count+=1;v(k.then,k,w,b.reject);g+=1}if(0===--q.count){var r=b.resolve;r(C)}return b.promise}catch(Za){l=Za;if(d&&!d.done)try{m.IteratorClose(f,!0)}catch(bd){l=bd}f=b.reject;f(l);return b.promise}},race:function(a){if(!m.TypeIsObject(this))throw new TypeError("Promise is not object");var b=new c(this),d;try{var f=m.GetIterator(a);a=d={iterator:f,
done:!1};for(var l=a.iterator,C,q,e;;){try{C=m.IteratorStep(l);if(!1===C){a.done=!0;break}q=C.value}catch(Ya){throw a.done=!0,Ya;}e=this.resolve(q);v(e.then,e,b.resolve,b.reject)}return b.promise}catch(Ya){l=Ya;if(d&&!d.done)try{m.IteratorClose(f,!0)}catch(ad){l=ad}f=b.reject;f(l);return b.promise}},reject:function(a){if(!m.TypeIsObject(this))throw new TypeError("Bad promise constructor");var b=new c(this),d=b.reject;d(a);return b.promise},resolve:function(a){if(!m.TypeIsObject(this))throw new TypeError("Bad promise constructor");
if(m.IsPromise(a)&&a.constructor===this)return a;var b=new c(this),d=b.resolve;d(a);return b.promise}});t(z,{"catch":function(a){return this.then(null,a)},then:function(a,b){if(!m.IsPromise(this))throw new TypeError("not a promise");var d=m.SpeciesConstructor(this,y);d=2<arguments.length&&arguments[2]===e&&d===y?e:new c(d);var f=m.IsCallable(a)?a:l,C=m.IsCallable(b)?b:q,g=this._promise;if(0===g.state){if(0===g.reactionLength)g.fulfillReactionHandler0=f,g.rejectReactionHandler0=C,g.reactionCapability0=
d;else{var k=3*(g.reactionLength-1);g[k+0]=f;g[k+1]=C;g[k+2]=d}g.reactionLength+=1}else if(1===g.state)g=g.result,h(f,d,g);else if(2===g.state)g=g.result,h(C,d,g);else throw new TypeError("unexpected Promise state");return d.promise}});e=new c(y);var A=z.then;return y}}();p.Promise&&(delete p.Promise.accept,delete p.Promise.defer,delete p.Promise.prototype.chain);if("function"===typeof Ga){t(p,{Promise:Ga});var cd=A(p.Promise,function(a){return a.resolve(42).then(function(){})instanceof a}),dd=!e(function(){return p.Promise.reject(42).then(null,
5).then(null,aa)}),ed=e(function(){return p.Promise.call(3,aa)}),fd=function(a){var c=a.resolve(5);c.constructor={};a=a.resolve(c);try{a.then(null,aa).then(null,aa)}catch(Ia){return!0}return c===a}(p.Promise),gd=d&&function(){var a=0,c=Object.defineProperty({},"then",{get:function(){a+=1}});Promise.resolve(c);return 1===a}(),$a=function(a){var c=new Promise(a);a(3,function(){});this.then=c.then;this.constructor=BadResolverPromise_1};$a.prototype=Promise.prototype;$a.all=Promise.all;var hd=b(function(){return!!$a.all([1,
2])});cd&&dd&&ed&&!fd&&gd&&!hd||(Promise=Ga,x(p,"Promise",Ga));if(1!==Promise.all.length){var id=Promise.all;x(Promise,"all",function(a){return m.Call(id,this,arguments)})}if(1!==Promise.race.length){var jd=Promise.race;x(Promise,"race",function(a){return m.Call(jd,this,arguments)})}if(1!==Promise.resolve.length){var kd=Promise.resolve;x(Promise,"resolve",function(a){return m.Call(kd,this,arguments)})}if(1!==Promise.reject.length){var ld=Promise.reject;x(Promise,"reject",function(a){return m.Call(ld,
this,arguments)})}Ca(Promise,"all");Ca(Promise,"race");Ca(Promise,"resolve");Ca(Promise,"reject");ua(Promise)}var Jb=function(a){var c=n(q(a,function(a,c){a[c]=!0;return a},{}));return a.join(":")===c.join(":")},md=Jb(["z","a","bb"]),nd=Jb(["z",1,"a","3",2]);if(d){var na=function(a,c){return c||md?U(a)?"^"+m.ToString(a):"string"===typeof a?"$"+a:"number"===typeof a?nd?a:"n"+a:"boolean"===typeof a?"b"+a:null:null},Ha=function(){return Object.create?Object.create(null):{}},ab=function(a,c,b){if(h(b)||
G.string(b))l(b,function(a){if(!m.TypeIsObject(a))throw new TypeError("Iterator value "+a+" is not an entry object");c.set(a[0],a[1])});else if(b instanceof a)k(a.prototype.forEach,b,function(a,b){c.set(b,a)});else{if(!U(b)){var d=c.set;if(!m.IsCallable(d))throw new TypeError("bad map");var f=m.GetIterator(b)}if("undefined"!==typeof f)for(;;){a=m.IteratorStep(f);if(!1===a)break;a=a.value;try{if(!m.TypeIsObject(a))throw new TypeError("Iterator value "+a+" is not an entry object");k(d,c,a[0],a[1])}catch(Qa){throw m.IteratorClose(f,
!0),Qa;}}}},Kb=function(a,c,b){if(h(b)||G.string(b))l(b,function(a){c.add(a)});else if(b instanceof a)k(a.prototype.forEach,b,function(a){c.add(a)});else{if(!U(b)){var d=c.add;if(!m.IsCallable(d))throw new TypeError("bad set");var f=m.GetIterator(b)}if("undefined"!==typeof f)for(;;){a=m.IteratorStep(f);if(!1===a)break;a=a.value;try{k(d,c,a)}catch(Qa){throw m.IteratorClose(f,!0),Qa;}}}},va={Map:function(){var a={},c=function(a,c){this.key=a;this.value=c;this.prev=this.next=null};c.prototype.isRemoved=
function(){return this.key===a};var b=function(a,c){if(!m.TypeIsObject(a)||!a._es6map)throw new TypeError("Method Map.prototype."+c+" called on incompatible receiver "+m.ToString(a));},d=function(a,c){b(a,"[[MapIterator]]");this.i=this.head=a._head;this.kind=c};d.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var a=this.i,c=this.kind,b=this.head;if("undefined"===typeof this.i)return la();for(;a.isRemoved()&&a!==b;)a=a.prev;for(;a.next!==
b;)if(a=a.next,!a.isRemoved())return c="key"===c?a.key:"value"===c?a.value:[a.key,a.value],this.i=a,la(c);this.i=void 0;return la()}};Q(d.prototype);var f=function Sa(){if(!(this instanceof Sa))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var a=Oa(this,Sa,l,{_es6map:!0,_head:null,_map:F?new F:null,_size:0,_storage:Ha()}),b=new c(null,null);b.next=b.prev=b;a._head=b;0<arguments.length&&ab(Sa,a,arguments[0]);return a};var l=f.prototype;
r.getter(l,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});t(l,{get:function(a){b(this,"get");var c=na(a,!0);if(null!==c){if(a=this._storage[c])return a.value}else if(this._map){if(a=da.call(this._map,a))return a.value}else for(var d=c=this._head;(d=d.next)!==c;)if(m.SameValueZero(d.key,a))return d.value},has:function(a){b(this,"has");var c=na(a,!0);if(null!==c)return"undefined"!==typeof this._storage[c];if(this._map)return ba.call(this._map,
a);for(var d=c=this._head;(d=d.next)!==c;)if(m.SameValueZero(d.key,a))return!0;return!1},set:function(a,d){b(this,"set");var f=this._head,l=f,q=na(a,!0);if(null!==q){if("undefined"!==typeof this._storage[q])return this._storage[q].value=d,this;var C=this._storage[q]=new c(a,d);l=f.prev}else this._map&&(ba.call(this._map,a)?da.call(this._map,a).value=d:(C=new c(a,d),ea.call(this._map,a,C),l=f.prev));for(;(l=l.next)!==f;)if(m.SameValueZero(l.key,a))return l.value=d,this;C=C||new c(a,d);m.SameValue(-0,
a)&&(C.key=0);C.next=this._head;C.prev=this._head.prev;C.prev.next=C;C.next.prev=C;this._size+=1;return this},"delete":function(c){b(this,"delete");var d=this._head,f=d,l=na(c,!0);if(null!==l){if("undefined"===typeof this._storage[l])return!1;f=this._storage[l].prev;delete this._storage[l]}else if(this._map){if(!ba.call(this._map,c))return!1;f=da.call(this._map,c).prev;pa.call(this._map,c)}for(;(f=f.next)!==d;)if(m.SameValueZero(f.key,c))return f.key=a,f.value=a,f.prev.next=f.next,f.next.prev=f.prev,
--this._size,!0;return!1},clear:function(){b(this,"clear");this._map=F?new F:null;this._size=0;this._storage=Ha();for(var c=this._head,d,f=c.next;(d=f)!==c;)d.key=a,d.value=a,f=d.next,d.next=d.prev=c;c.next=c.prev=c},keys:function(){b(this,"keys");return new d(this,"key")},values:function(){b(this,"values");return new d(this,"value")},entries:function(){b(this,"entries");return new d(this,"key+value")},forEach:function(a){b(this,"forEach");for(var c=1<arguments.length?arguments[1]:null,d=this.entries(),
f=d.next();!f.done;f=d.next())c?k(a,c,f.value[1],f.value[0],this):a(f.value[1],f.value[0],this)}});Q(l,l.entries);return f}(),Set:function(){var a=function(a,c){if(!m.TypeIsObject(a)||!a._es6set||"undefined"===typeof a._storage)throw new TypeError("Set.prototype."+c+" called on incompatible receiver "+m.ToString(a));},c=function Ra(){if(!(this instanceof Ra))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var a=Oa(this,Ra,b,{_es6set:!0,
"[[SetData]]":null,_storage:Ha()});if(!a._es6set)throw new TypeError("bad set");0<arguments.length&&Kb(Ra,a,arguments[0]);return a};var b=c.prototype;var d=function(a){if(!a["[[SetData]]"]){var c=new va.Map;a["[[SetData]]"]=c;l(n(a._storage),function(a){if("^null"===a)a=null;else if("^undefined"!==a){var b=a.charAt(0);a="$"===b?N(a,1):"n"===b?+N(a,1):"b"===b?"btrue"===a:+a}else a=void 0;c.set(a,a)});a["[[SetData]]"]=c}a._storage=null};r.getter(c.prototype,"size",function(){a(this,"size");if(this._storage)return n(this._storage).length;
d(this);return this["[[SetData]]"].size});t(c.prototype,{has:function(c){a(this,"has");var b;if(this._storage&&null!==(b=na(c)))return!!this._storage[b];d(this);return this["[[SetData]]"].has(c)},add:function(c){a(this,"add");var b;if(this._storage&&null!==(b=na(c)))return this._storage[b]=!0,this;d(this);this["[[SetData]]"].set(c,c);return this},"delete":function(c){a(this,"delete");var b;if(this._storage&&null!==(b=na(c)))return c=ha(this._storage,b),delete this._storage[b]&&c;d(this);return this["[[SetData]]"]["delete"](c)},
clear:function(){a(this,"clear");this._storage&&(this._storage=Ha());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){a(this,"values");d(this);return new f(this["[[SetData]]"].values())},entries:function(){a(this,"entries");d(this);return new f(this["[[SetData]]"].entries())},forEach:function(c){a(this,"forEach");var b=1<arguments.length?arguments[1]:null,f=this;d(f);this["[[SetData]]"].forEach(function(a,d){b?k(c,b,d,d,f):c(d,d,f)})}});u(c.prototype,"keys",c.prototype.values,!0);
Q(c.prototype,c.prototype.values);var f=function(a){this.it=a};f.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};Q(f.prototype);return c}()};p.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(p.Set=va.Set);if(p.Map||p.Set){b(function(){return 2===(new Map([[1,2]])).get(1)})||(p.Map=function L(){if(!(this instanceof L))throw new TypeError('Constructor Map requires "new"');
var a=new F;0<arguments.length&&ab(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,p.Map.prototype);return a},p.Map.prototype=y(F.prototype),u(p.Map.prototype,"constructor",p.Map,!0),r.preserveToString(p.Map,F));var Lb=new Map,Mb=function(){var a=new Map([[1,0],[2,0],[3,0],[4,0]]);a.set(-0,a);return a.get(0)===a&&a.get(-0)===a&&a.has(0)&&a.has(-0)}(),od=Lb.set(1,2)===Lb;Mb&&od||x(Map.prototype,"set",function(a,c){k(ea,this,0===a?0:a,c);return this});Mb||(t(Map.prototype,{get:function(a){return k(da,
this,0===a?0:a)},has:function(a){return k(ba,this,0===a?0:a)}},!0),r.preserveToString(Map.prototype.get,da),r.preserveToString(Map.prototype.has,ba));var bb=new Set,Nb=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(a){a["delete"](0);a.add(-0);return!a.has(0)}(bb),pd=bb.add(1)===bb;if(!Nb||!pd){var Ob=Set.prototype.add;Set.prototype.add=function(a){k(Ob,this,0===a?0:a);return this};r.preserveToString(Set.prototype.add,Ob)}if(!Nb){var Pb=Set.prototype.has;Set.prototype.has=
function(a){return k(Pb,this,0===a?0:a)};r.preserveToString(Set.prototype.has,Pb);var Qb=Set.prototype["delete"];Set.prototype["delete"]=function(a){return k(Qb,this,0===a?0:a)};r.preserveToString(Set.prototype["delete"],Qb)}var Rb=A(p.Map,function(a){var c=new a([]);c.set(42,42);return c instanceof a}),qd=Object.setPrototypeOf&&!Rb;try{var Sb=!(p.Map()instanceof p.Map)}catch(C){Sb=C instanceof TypeError}if(0!==p.Map.length||qd||!Sb)p.Map=function L(){if(!(this instanceof L))throw new TypeError('Constructor Map requires "new"');
var a=new F;0<arguments.length&&ab(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,L.prototype);return a},p.Map.prototype=F.prototype,u(p.Map.prototype,"constructor",p.Map,!0),r.preserveToString(p.Map,F);var rd=A(p.Set,function(a){var c=new a([]);c.add(42,42);return c instanceof a}),sd=Object.setPrototypeOf&&!rd;try{var Tb=!(p.Set()instanceof p.Set)}catch(C){Tb=C instanceof TypeError}if(0!==p.Set.length||sd||!Tb){var cb=p.Set;p.Set=function L(){if(!(this instanceof L))throw new TypeError('Constructor Set requires "new"');
var a=new cb;0<arguments.length&&Kb(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,L.prototype);return a};p.Set.prototype=cb.prototype;u(p.Set.prototype,"constructor",p.Set,!0);r.preserveToString(p.Set,cb)}var db=new p.Map,td=!b(function(){return db.keys().next().done});("function"!==typeof p.Map.prototype.clear||0!==(new p.Set).size||0!==db.size||"function"!==typeof p.Map.prototype.keys||"function"!==typeof p.Set.prototype.keys||"function"!==typeof p.Map.prototype.forEach||"function"!==
typeof p.Set.prototype.forEach||a(p.Map)||a(p.Set)||"function"!==typeof db.keys().next||td||!Rb)&&t(p,{Map:va.Map,Set:va.Set},!0);p.Set.prototype.keys!==p.Set.prototype.values&&u(p.Set.prototype,"keys",p.Set.prototype.values,!0);Q(Object.getPrototypeOf((new p.Map).keys()));Q(Object.getPrototypeOf((new p.Set).keys()));if(f&&"has"!==p.Set.prototype.has.name){var ud=p.Set.prototype.has;x(p.Set.prototype,"has",function(a){return k(ud,this,a)})}}t(p,va);ua(p.Map);ua(p.Set)}var R=function(a){if(!m.TypeIsObject(a))throw new TypeError("target must be an object");
},M={apply:function(){return m.Call(m.Call,null,arguments)},construct:function(a,c){if(!m.IsConstructor(a))throw new TypeError("First argument must be a constructor.");var b=2<arguments.length?arguments[2]:a;if(!m.IsConstructor(b))throw new TypeError("new.target must be a constructor.");return m.Construct(a,c,b,"internal")},deleteProperty:function(a,c){R(a);if(d){var b=Object.getOwnPropertyDescriptor(a,c);if(b&&!b.configurable)return!1}return delete a[c]},has:function(a,c){R(a);return c in a}};Object.getOwnPropertyNames&&
Object.assign(M,{ownKeys:function(a){R(a);var c=Object.getOwnPropertyNames(a);m.IsCallable(Object.getOwnPropertySymbols)&&Xb(c,Object.getOwnPropertySymbols(a));return c}});Object.preventExtensions&&Object.assign(M,{isExtensible:function(a){R(a);return Object.isExtensible(a)},preventExtensions:function(a){R(a);return!e(function(){return Object.preventExtensions(a)})}});if(d){var Ub=function(a,c,b){var d=Object.getOwnPropertyDescriptor(a,c);if(!d)return a=Object.getPrototypeOf(a),null===a?void 0:Ub(a,
c,b);if("value"in d)return d.value;if(d.get)return m.Call(d.get,b)},Vb=function(a,c,b,d){var f=Object.getOwnPropertyDescriptor(a,c);if(!f){a=Object.getPrototypeOf(a);if(null!==a)return Vb(a,c,b,d);f={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in f?f.writable&&m.TypeIsObject(d)?Object.getOwnPropertyDescriptor(d,c)?ia.defineProperty(d,c,{value:b}):ia.defineProperty(d,c,{value:b,writable:!0,enumerable:!0,configurable:!0}):!1:f.set?(k(f.set,d,b),!0):!1};Object.assign(M,{defineProperty:function(a,
c,b){R(a);return!e(function(){return Object.defineProperty(a,c,b)})},getOwnPropertyDescriptor:function(a,c){R(a);return Object.getOwnPropertyDescriptor(a,c)},get:function(a,c){R(a);return Ub(a,c,2<arguments.length?arguments[2]:a)},set:function(a,c,b){R(a);return Vb(a,c,b,3<arguments.length?arguments[3]:a)}})}if(Object.getPrototypeOf){var vd=Object.getPrototypeOf;M.getPrototypeOf=function(a){R(a);return vd(a)}}Object.setPrototypeOf&&M.getPrototypeOf&&Object.assign(M,{setPrototypeOf:function(a,c){R(a);
if(null!==c&&!m.TypeIsObject(c))throw new TypeError("proto must be an object or null");if(c===ia.getPrototypeOf(a))return!0;if(ia.isExtensible&&!ia.isExtensible(a))return!1;var b;a:{for(b=c;b;){if(a===b){b=!0;break a}b=M.getPrototypeOf(b)}b=!1}if(b)return!1;Object.setPrototypeOf(a,c);return!0}});var wd=function(a,c){m.IsCallable(p.Reflect[a])?b(function(){p.Reflect[a](1);p.Reflect[a](NaN);p.Reflect[a](!0);return!0})&&x(p.Reflect,a,c):u(p.Reflect,a,c)};Object.keys(M).forEach(function(a){wd(a,M[a])});
var eb=p.Reflect.getPrototypeOf;f&&eb&&"getPrototypeOf"!==eb.name&&x(p.Reflect,"getPrototypeOf",function(a){return k(eb,p.Reflect,a)});p.Reflect.setPrototypeOf&&b(function(){p.Reflect.setPrototypeOf(1,{});return!0})&&x(p.Reflect,"setPrototypeOf",M.setPrototypeOf);p.Reflect.defineProperty&&(b(function(){var a=!p.Reflect.defineProperty(1,"test",{value:1}),c="function"!==typeof Object.preventExtensions||!p.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return a&&c})||x(p.Reflect,"defineProperty",
M.defineProperty));p.Reflect.construct&&(b(function(){var a=function(){};return p.Reflect.construct(function(){},[],a)instanceof a})||x(p.Reflect,"construct",M.construct));if("Invalid Date"!==String(new Date(NaN))){var xd=Date.prototype.toString;x(Date.prototype,"toString",function(){var a=+this;return a!==a?"Invalid Date":m.Call(xd,this)})}var Wb={anchor:function(a){return m.CreateHTML(this,"a","name",a)},big:function(){return m.CreateHTML(this,"big","","")},blink:function(){return m.CreateHTML(this,
"blink","","")},bold:function(){return m.CreateHTML(this,"b","","")},fixed:function(){return m.CreateHTML(this,"tt","","")},fontcolor:function(a){return m.CreateHTML(this,"font","color",a)},fontsize:function(a){return m.CreateHTML(this,"font","size",a)},italics:function(){return m.CreateHTML(this,"i","","")},link:function(a){return m.CreateHTML(this,"a","href",a)},small:function(){return m.CreateHTML(this,"small","","")},strike:function(){return m.CreateHTML(this,"strike","","")},sub:function(){return m.CreateHTML(this,
"sub","","")},sup:function(){return m.CreateHTML(this,"sup","","")}};l(Object.keys(Wb),function(a){var c=String.prototype[a];if(m.IsCallable(c)){c=k(c,"",' " ');var b=Y([],c.match(/"/g)).length;c=c!==c.toLowerCase()||2<b}else c=!0;c&&x(String.prototype,a,Wb[a])});var yd=function(){if(!ta)return!1;var a="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!a)return!1;if("undefined"!==typeof a(B())||"[null]"!==a([B()]))return!0;var c={a:B()};c[B()]=!0;return"{}"!==a(c)?
!0:!1}(),zd=b(function(){return ta?"{}"===JSON.stringify(Object(B()))&&"[{}]"===JSON.stringify([Object(B())]):!0});if(yd||!zd){var Ad=JSON.stringify;x(JSON,"stringify",function(a){if("symbol"!==typeof a){var c;1<arguments.length&&(c=arguments[1]);var b=[a];if(h(c))b.push(c);else{var d=m.IsCallable(c)?c:null;b.push(function(a,c){a=d?k(d,this,a,c):c;if("symbol"!==typeof a)return G.symbol(a)?zb({})(a):a})}2<arguments.length&&b.push(arguments[2]);return Ad.apply(this,b)}})}return p});
(function(g){g.keyman||(g.keyman={})})(com||(com={}));var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1));function EE(g,k,h){this.fn=g;this.context=k;this.once=h||!1}
function addListener(g,k,h,n,e){if("function"!==typeof h)throw new TypeError("The listener must be a function");h=new EE(h,n||g,e);k=prefix?prefix+k:k;g._events[k]?g._events[k].fn?g._events[k]=[g._events[k],h]:g._events[k].push(h):(g._events[k]=h,g._eventsCount++);return g}function clearEvent(g,k){0===--g._eventsCount?g._events=new Events:delete g._events[k]}function EventEmitter(){this._events=new Events;this._eventsCount=0}
EventEmitter.prototype.eventNames=function(){var g=[],k,h;if(0===this._eventsCount)return g;for(h in k=this._events)has.call(k,h)&&g.push(prefix?h.slice(1):h);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(k)):g};EventEmitter.prototype.listeners=function(g){g=this._events[prefix?prefix+g:g];if(!g)return[];if(g.fn)return[g.fn];for(var k=0,h=g.length,n=Array(h);k<h;k++)n[k]=g[k].fn;return n};
EventEmitter.prototype.listenerCount=function(g){return(g=this._events[prefix?prefix+g:g])?g.fn?1:g.length:0};
EventEmitter.prototype.emit=function(g,k,h,n,e,b){var a=prefix?prefix+g:g;if(!this._events[a])return!1;a=this._events[a];var c=arguments.length,d;if(a.fn){a.once&&this.removeListener(g,a.fn,void 0,!0);switch(c){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,k),!0;case 3:return a.fn.call(a.context,k,h),!0;case 4:return a.fn.call(a.context,k,h,n),!0;case 5:return a.fn.call(a.context,k,h,n,e),!0;case 6:return a.fn.call(a.context,k,h,n,e,b),!0}var f=1;for(d=Array(c-1);f<c;f++)d[f-
1]=arguments[f];a.fn.apply(a.context,d)}else{var l=a.length;for(f=0;f<l;f++)switch(a[f].once&&this.removeListener(g,a[f].fn,void 0,!0),c){case 1:a[f].fn.call(a[f].context);break;case 2:a[f].fn.call(a[f].context,k);break;case 3:a[f].fn.call(a[f].context,k,h);break;case 4:a[f].fn.call(a[f].context,k,h,n);break;default:if(!d){var q=1;for(d=Array(c-1);q<c;q++)d[q-1]=arguments[q]}a[f].fn.apply(a[f].context,d)}}return!0};EventEmitter.prototype.on=function(g,k,h){return addListener(this,g,k,h,!1)};
EventEmitter.prototype.once=function(g,k,h){return addListener(this,g,k,h,!0)};EventEmitter.prototype.removeListener=function(g,k,h,n){g=prefix?prefix+g:g;if(!this._events[g])return this;if(!k)return clearEvent(this,g),this;var e=this._events[g];if(e.fn)e.fn!==k||n&&!e.once||h&&e.context!==h||clearEvent(this,g);else{for(var b=0,a=[],c=e.length;b<c;b++)(e[b].fn!==k||n&&!e[b].once||h&&e[b].context!==h)&&a.push(e[b]);a.length?this._events[g]=1===a.length?a[0]:a:clearEvent(this,g)}return this};
EventEmitter.prototype.removeAllListeners=function(g){g?(g=prefix?prefix+g:g,this._events[g]&&clearEvent(this,g)):(this._events=new Events,this._eventsCount=0);return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;"undefined"!==typeof module&&(module.exports=EventEmitter);
(function(g){(function(k){(function(h){h.Codes={modifierCodes:{LCTRL:1,RCTRL:2,LALT:4,RALT:8,SHIFT:16,CTRL:32,ALT:64,META:128,CAPS:256,NO_CAPS:512,NUM_LOCK:1024,NO_NUM_LOCK:2048,SCROLL_LOCK:4096,NO_SCROLL_LOCK:8192,VIRTUAL_KEY:16384,VIRTUAL_CHAR_KEY:32768},modifierBitmasks:{ALL:127,ALT_GR_SIM:5,CHIRAL:31,IS_CHIRAL:15,NON_CHIRAL:112},stateBitmasks:{ALL:16128,CAPS:768,NUM_LOCK:3072,SCROLL_LOCK:12288},keyCodes:{K_BKSP:8,K_TAB:9,K_ENTER:13,K_SHIFT:16,K_CONTROL:17,K_ALT:18,K_PAUSE:19,K_CAPS:20,K_ESC:27,
K_SPACE:32,K_PGUP:33,K_PGDN:34,K_END:35,K_HOME:36,K_LEFT:37,K_UP:38,K_RIGHT:39,K_DOWN:40,K_SEL:41,K_PRINT:42,K_EXEC:43,K_INS:45,K_DEL:46,K_HELP:47,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,K_A:65,K_B:66,K_C:67,K_D:68,K_E:69,K_F:70,K_G:71,K_H:72,K_I:73,K_J:74,K_K:75,K_L:76,K_M:77,K_N:78,K_O:79,K_P:80,K_Q:81,K_R:82,K_S:83,K_T:84,K_U:85,K_V:86,K_W:87,K_X:88,K_Y:89,K_Z:90,K_NP0:96,K_NP1:97,K_NP2:98,K_NP3:99,K_NP4:100,K_NP5:101,K_NP6:102,K_NP7:103,K_NP8:104,K_NP9:105,K_NPSTAR:106,
K_NPPLUS:107,K_SEPARATOR:108,K_NPMINUS:109,K_NPDOT:110,K_NPSLASH:111,K_F1:112,K_F2:113,K_F3:114,K_F4:115,K_F5:116,K_F6:117,K_F7:118,K_F8:119,K_F9:120,K_F10:121,K_F11:122,K_F12:123,K_NUMLOCK:144,K_SCROLL:145,K_LSHIFT:160,K_RSHIFT:161,K_LCONTROL:162,K_RCONTROL:163,K_LALT:164,K_RALT:165,K_COLON:186,K_EQUAL:187,K_COMMA:188,K_HYPHEN:189,K_PERIOD:190,K_SLASH:191,K_BKQUOTE:192,K_LBRKT:219,K_BKSLASH:220,K_RBRKT:221,K_QUOTE:222,K_oE2:226,K_OE2:226,K_LOPT:50001,K_ROPT:50002,K_NUMERALS:50003,K_SYMBOLS:50004,
K_CURRENCIES:50005,K_UPPER:50006,K_LOWER:50007,K_ALPHA:50008,K_SHIFTED:50009,K_ALTGR:50010,K_TABBACK:50011,K_TABFWD:50012},codesUS:[["0123456789",";=,-./`","[\\]'"],[")!@#$%^&*(",":+<_>?~",'{|}"']],isKnownOSKModifierKey:function(h){switch(h){case "K_SHIFT":case "K_LOPT":case "K_ROPT":case "K_NUMLOCK":case "K_CAPS":return!0;default:if(h=g.keyman.text.Codes[h],5E4<h&&50011>h)return!0}return!1}}})(k.text||(k.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function b(a,c){this.p=a;this.d=c;this.o=b.ordinalSeed++}b.prototype.match=function(a,c){return this.p==a&&this.d==c};b.prototype.set=function(){this.matched=1};b.prototype.reset=function(){this.matched=0};b.prototype.before=function(a){return this.o<a.o};b.prototype.clone=function(){var a=new b(this.p,this.d);a.o=this.o;return a};b.ordinalSeed=0;b.sortFunc=function(a,c){return a.p!=c.p?c.p-a.p:c.o-a.o};return b}();g.Deadkey=h;var e=function(){function b(){this.dks=
[]}b.prototype.toSortedArray=function(){this.dks=this.dks.sort(h.sortFunc);return[].concat(this.dks)};b.prototype.clone=function(){var a=new b,c=this.toSortedArray();a.dks=[];c.forEach(function(c){a.dks.push(c.clone())});return a};b.prototype.isMatch=function(a,c,b){if(0==this.dks.length)return!1;c=a-c;for(a=0;a<this.dks.length;a++)if(this.dks[a].match(c,b)&&!this.dks[a].matched)return this.dks[a].set(),!0;this.resetMatched();return!1};b.prototype.add=function(a){this.dks=this.dks.concat(a)};b.prototype.remove=
function(a){a=this.dks.indexOf(a);this.dks.splice(a,1)};b.prototype.clear=function(){this.dks=[]};b.prototype.resetMatched=function(){for(var a=0,c=this.dks;a<c.length;a++)c[a].reset()};b.prototype.deleteMatched=function(){for(var a=0;a<this.dks.length;a++)this.dks[a].matched&&this.dks.splice(a--,1)};b.prototype.adjustPositions=function(a,c){if(0!=c)for(var b=0,f=this.dks;b<f.length;b++){var l=f[b];l.p>a&&(l.p+=c)}};b.prototype.count=function(){return this.dks.length};return b}();g.DeadkeyTracker=
e})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));var __extends=this&&this.__extends||function(){var g=function(k,h){g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,e){g.__proto__=e}||function(g,e){for(var b in e)e.hasOwnProperty(b)&&(g[b]=e[b])};return g(k,h)};return function(k,h){function n(){this.constructor=k}g(k,h);k.prototype=null===h?Object.create(h):(n.prototype=h.prototype,new n)}}();
(function(g){(function(g){var h;(function(g){var e=function(){function a(a,c,b){this.insert=a;this.deleteLeft=c;this.deleteRight=b||0}a.prototype.isNoOp=function(){return""===this.insert&&0===this.deleteLeft&&0===this.deleteRight};a.nil=new a("",0,0);return a}();g.TextTransform=e;var b=function(){function a(c,b,d,e){var f=this.token=a.tokenSeed++;this.keystroke=c;this.transform=b;this.alternates=e;this.preInput=d;this.transform.id=this.token;e&&e.forEach(function(a){a.sample.id=f})}a.tokenSeed=0;
return a}();g.Transcription=b;var a=function(){function a(){this._dks=new h.DeadkeyTracker}Object.defineProperty(a.prototype,"isSynthetic",{get:function(){return!0},enumerable:!0,configurable:!0});a.prototype.resetContext=function(){this.deadkeys().clear()};a.prototype.deadkeys=function(){return this._dks};a.prototype.hasDeadkeyMatch=function(a,c){return this.deadkeys().isMatch(this.getDeadkeyCaret(),a,c)};a.prototype.insertDeadkeyBeforeCaret=function(a){a=new g.Deadkey(this.getDeadkeyCaret(),a);
this.deadkeys().add(a)};a.prototype.adjustDeadkeys=function(a){this.deadkeys().adjustPositions(this.getDeadkeyCaret(),a)};a.prototype.setDeadkeys=function(a){this._dks=a.clone()};a.prototype.buildTransformFrom=function(a){var c=this.getText(),b=a.getText(),d=a.getDeadkeyCaret();a=this.getDeadkeyCaret();for(var f=c._kmwCodePointToCodeUnit(d<a?d:a),g=0,h=f;g<h;){var k=Math.floor((h+g+1)/2),z=b.substr(g,k-g),r=c.substr(g,k-g);z==r?g=k:h=k-1}0<h&&h<f&&(f=b.charCodeAt(h-1),g=b.charCodeAt(h),k=c.charCodeAt(h),
55296<=f&&56319>=f&&(56320<=g&&57343>=g||56320<=k&&57343>=k)&&--h);f=b._kmwCodeUnitToCodePoint(h);h=d-f;f=c._kmwSubstr(f,a-f);g=c._kmwLength()-a;b=b._kmwLength()-d-g;0>b&&(f+=c._kmwSubstr(a,-b),b=0);return new e(f,h,b)};a.prototype.buildTranscriptionFrom=function(a,d,q,e){var f=this.buildTransformFrom(a);return new b(d,f,c.from(a,q),e)};a.prototype.restoreTo=function(a){this.setTextBeforeCaret(a.getTextBeforeCaret());this.setTextAfterCaret(a.getTextAfterCaret());this._dks=a._dks.clone()};a.prototype.apply=
function(a){a.deleteRight&&this.setTextAfterCaret(this.getTextAfterCaret()._kmwSubstr(a.deleteRight));a.deleteLeft&&this.deleteCharsBeforeCaret(a.deleteLeft);a.insert&&this.insertTextBeforeCaret(a.insert);this._dks.clear()};a.prototype.setTextBeforeCaret=function(a){this.deleteCharsBeforeCaret(this.getTextBeforeCaret()._kmwLength());this.insertTextBeforeCaret(a)};a.prototype.saveProperties=function(){};a.prototype.restoreProperties=function(){};return a}();g.OutputTarget=a;var c=function(a){function c(c,
b){var d=a.call(this)||this;d.text=c?c:"";c=d.text._kmwLength();d.caretIndex="number"==typeof b?b:c;return d}__extends(c,a);c.from=function(a,b){if(a instanceof c)b=new c(a.text,a.caretIndex);else if(b){b=a.getText();var d=a.getTextAfterCaret();d=b._kmwLength()-d._kmwLength();b=new c(b,d)}else b=a.getTextBeforeCaret(),d=b._kmwLength(),b=new c(b+a.getTextAfterCaret(),d);b.setDeadkeys(a.deadkeys());return b};c.prototype.clearSelection=function(){};c.prototype.invalidateSelection=function(){};c.prototype.isSelectionEmpty=
function(){return!0};c.prototype.hasSelection=function(){return!0};c.prototype.getDeadkeyCaret=function(){return this.caretIndex};c.prototype.setDeadkeyCaret=function(a){if(0>a||a>this.text._kmwLength())throw Error("Provided caret index is out of range.");this.caretIndex=a};c.prototype.getTextBeforeCaret=function(){return this.text.kmwSubstr(0,this.caretIndex)};c.prototype.getTextAfterCaret=function(){return this.text.kmwSubstr(this.caretIndex)};c.prototype.getText=function(){return this.text};c.prototype.deleteCharsBeforeCaret=
function(a){0<=a&&(a>this.caretIndex&&(a=this.caretIndex),this.text=this.text.kmwSubstr(0,this.caretIndex-a)+this.getTextAfterCaret(),this.caretIndex-=a)};c.prototype.insertTextBeforeCaret=function(a){this.text=this.getTextBeforeCaret()+a+this.getTextAfterCaret();this.caretIndex+=a.kmwLength()};c.prototype.handleNewlineAtCaret=function(){this.insertTextBeforeCaret("\n")};c.prototype.setTextAfterCaret=function(a){this.text=this.getTextBeforeCaret()+a};c.prototype.doInputEvent=function(){};return c}(a);
g.Mock=c})(h=g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));(function(g){(function(g){(function(g){var h=function(){function e(){this.isSynthetic=!0}e.constructNullKeyEvent=function(b){var a=new e;a.Lcode=0;a.kName="";a.device=b;return a};return e}();g.KeyEvent=h})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(){this.transcription=null;this.setStore={};this.saveStore={};this.variableStores={};this.triggersDefaultCommand=!1}e.prototype.finalize=function(b,a,c){if(!this.transcription)throw"Cannot finalize a RuleBehavior with no transcription.";b.beepHandler&&this.beep&&b.beepHandler(a);for(var d in this.setStore)if(c=b.keyboardInterface.systemStores[d])try{c.set(this.setStore[d])}catch(f){b.errorLogger&&b.errorLogger("Rule attempted to perform illegal operation - 'platform' may not be changed.")}else b.warningLogger&&
b.warningLogger("Unknown store affected by keyboard rule: "+d);b.keyboardInterface.applyVariableStores(this.variableStores);if(b.keyboardInterface.variableStoreSerializer)for(d in this.saveStore)b.keyboardInterface.variableStoreSerializer.saveStore(b.activeKeyboard.id,d,this.saveStore[d]);this.triggersDefaultCommand&&g.DefaultOutput.applyCommand(this.transcription.keystroke,a);b.warningLogger&&this.warningLog?b.warningLogger(this.warningLog):b.errorLogger&&this.errorLog&&b.errorLogger(this.errorLog)};
e.prototype.mergeInDefaults=function(b){var a=this.transcription.keystroke,c=b.transcription.keystroke;if(a.Lcode!=c.Lcode||a.Lmodifiers!=c.Lmodifiers)throw"RuleBehavior default-merge not supported unless keystrokes are identical!";this.triggersDefaultCommand=this.triggersDefaultCommand||b.triggersDefaultCommand;c=g.Mock.from(this.transcription.preInput,!1);c.apply(this.transcription.transform);c.apply(b.transcription.transform);this.transcription=c.buildTranscriptionFrom(this.transcription.preInput,
a,!1,this.transcription.alternates)};return e}();g.RuleBehavior=h})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h;(function(b){b.Enter="\n";b.Backspace="\b"})(h=g.EmulationKeystrokes||(g.EmulationKeystrokes={}));var e=function(){function b(){}b.codeForEvent=function(a){return g.Codes.keyCodes[a.kName]||a.Lcode};b.forAny=function(a,c,d){var f;if(null!=(f=b.forSpecialEmulation(a,d)))return f;if(c||null==(f=b.forNumpadKeys(a,d))){if(null!=(f=b.forUnicodeKeynames(a,d))||null!=(f=b.forBaseKeys(a,d)))return f;b.codeForEvent(a);return null}return f};b.isCommand=function(a){b.codeForEvent(a);
return!1};b.applyCommand=function(a,c){};b.forSpecialEmulation=function(a,c){switch(b.codeForEvent(a)){case g.Codes.keyCodes.K_BKSP:return h.Backspace;case g.Codes.keyCodes.K_ENTER:return h.Enter;default:return null}};b.forNumpadKeys=function(a,c){return a.Lcode>=g.Codes.keyCodes.K_NP0&&a.Lcode<=g.Codes.keyCodes.K_NPSLASH?String._kmwFromCharCode(106>a.Lcode?a.Lcode-48:a.Lcode-64):null};b.forUnicodeKeynames=function(a,c){a=a.kName;if(!a||"U_"!=a.substr(0,2))return null;for(var b="",f=0,l=a.substr(2).split("_");f<
l.length;f++){var q=parseInt(l[f],16);0<=q&&31>=q||128<=q&&159>=q?c&&(c.errorLog="Suppressing Unicode control code in "+a):b+=String.kmwFromCharCode(q)}return b?b:null};b.forBaseKeys=function(a,c){var b=a.Lcode;a=a.Lmodifiers;if(a==g.Codes.modifierCodes.SHIFT)a=1;else if(0!=a)return c&&(c.warningLog="KMW only defines default key output for the 'default' and 'shift' layers!"),null;try{if(b==g.Codes.keyCodes.K_SPACE)return" ";if(b>=g.Codes.keyCodes.K_0&&b<=g.Codes.keyCodes.K_9)return g.Codes.codesUS[a][0][b-
g.Codes.keyCodes.K_0];if(b>=g.Codes.keyCodes.K_A&&b<=g.Codes.keyCodes.K_Z)return String.fromCharCode(b+(a?0:32));if(b>=g.Codes.keyCodes.K_COLON&&b<=g.Codes.keyCodes.K_BKQUOTE)return g.Codes.codesUS[a][1][b-g.Codes.keyCodes.K_COLON];if(b>=g.Codes.keyCodes.K_LBRKT&&b<=g.Codes.keyCodes.K_QUOTE)return g.Codes.codesUS[a][2][b-g.Codes.keyCodes.K_LBRKT]}catch(f){c&&(c.errorLog="Error detected with default mapping for key:  code = "+b+", shift state = "+(1==a?"shift":"default"))}return null};return b}();
g.DefaultOutput=e})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=g.keyman.text.Codes,e=function(){function b(){}b.buildDefaultLayout=function(a,c,d){var f=d;"object"!=typeof b.dfltLayout[f]&&(f="desktop");var l=n.modifierBitmasks.NON_CHIRAL,q=k.utils.Version.CURRENT;c&&(l=c.modifierBitmask,q=c.compilerVersion);a||(a=this.DEFAULT_RAW_SPEC);f=k.utils.deepCopy(b.dfltLayout[f]);var e=f.layer,g=a.KLS,h=a.K102,t,v,z=0!=(l&n.modifierBitmasks.IS_CHIRAL);a.F&&(l=/^(?:(?:italic|bold) )* *[0-9.eE-]+(?:[a-z]+) "(.+)"$/.exec(a.F))&&
(f.font=l[1]);(v=!("undefined"==typeof g||!g))||(g=a.KLS=b.processLegacyDefinitions(a.BK));a=Object.getOwnPropertyNames(g);var r=[];a.splice(a.indexOf("default"),1);a=["default"].concat(a);c&&c.emulatesAltGr&&(-1==a.indexOf("leftctrl-leftalt")&&-1!=a.indexOf("rightalt")&&(a.push("leftctrl-leftalt"),g["leftctrl-leftalt"]=g.rightalt),-1==a.indexOf("leftctrl-leftalt-shift")&&-1!=a.indexOf("rightalt-shift")&&(a.push("leftctrl-leftalt-shift"),g["leftctrl-leftalt-shift"]=g["rightalt-shift"]));f.displayUnderlying=
c?!!c.scriptObject.KDU:!1;if("desktop"==d)for(r=b.generateLayerIds(z),l=0;l<r.length;l++)-1!=a.indexOf(r[l])&&r.splice(l--,1);var y=a.concat(r);if(v&&"desktop"!=d){c=null;v=e[0].row;for(l=0;l<v.length;l++){var A=v[l].key;for(var p=0;p<A.length;p++)r=A[p],"K_SHIFT"==r.id&&(c=r)}if(c)for(t in c.sk=[],g)"default"!=t&&"shift"!=t&&(l=b.modifierSpecials[t],c.sk.push({id:"K_"+l,text:l,sp:"1",nextlayer:t}));else console.warn("Error in default layout - cannot find default Shift key!")}for(l=0;l<y.length;l++)0<
l&&(e[l]=k.utils.deepCopy(e[0])),e[l].id=y[l],e[l].nextlayer=y[l],b.formatDefaultLayer(e[l],z,d,!!h);for(l=0;l<e.length;l++){z=e[l];var H=p=y=c=null,qa=g[z.id],wa="shift"==z.id?1:0,Y="default"==z.id||wa?1:0;v=z.row;for(t=0;t<v.length;t++)for(A=v[t].key,h=0;h<A.length;h++){r=A[h];var N=b.dfltCodes.indexOf(r.id);if(qa||Y)qa&&0<=N&&N<qa.length&&(r.text=qa[N]),Y&&q.precedes(k.utils.Version.NO_DEFAULT_KEYCAPS)&&"K_SPACE"!=r.id&&N+65*wa<b.dfltText.length&&null!==r.text&&(r.text=r.text||b.dfltText[N+65*
wa]);null!==r.text&&(r.text=r.text||"");switch(r.id){case "K_SHIFT":c=r;break;case "K_CAPS":y=r;break;case "K_NUMLOCK":p=r;break;case "K_SCROLL":H=r}if(null!=r.sk){for(N=0;N<r.sk.length;N++)-1==a.indexOf(r.sk[N].nextlayer)&&r.sk.splice(N--,1);0==r.sk.length&&(r.sk=null)}}z.shiftKey=c;z.capsKey=y;z.numKey=p;z.scrollKey=H;"desktop"!=d&&0<l&&null!=c&&(c.sp=b.buttonClasses["SHIFT-ON"],c.sk=null,c.text=b.modifierSpecials[e[l].id]?b.modifierSpecials[e[l].id]:"*Shift*")}return f};b.getLayerId=function(a){var c=
n.modifierCodes,b="";if(0==a)return"default";a&c.LCTRL&&(b=(0<b.length?b+"-":"")+"leftctrl");a&c.RCTRL&&(b=(0<b.length?b+"-":"")+"rightctrl");a&c.LALT&&(b=(0<b.length?b+"-":"")+"leftalt");a&c.RALT&&(b=(0<b.length?b+"-":"")+"rightalt");a&c.SHIFT&&(b=(0<b.length?b+"-":"")+"shift");a&c.CTRL&&(b=(0<b.length?b+"-":"")+"ctrl");a&c.ALT&&(b=(0<b.length?b+"-":"")+"alt");return b};b.generateLayerIds=function(a){if(a){a=32;var c=1}else a=8,c=16;for(var d=[],f=0;f<a;f++)d.push(b.getLayerId(f*c));return d};b.formatDefaultLayer=
function(a,c,d,f){for(var l=a.id,e=b.buttonClasses,g=0;g<a.row.length;g++)for(var h=a.row[g].key,k=0;k<h.length;k++){var t=h[k];switch(t.id){case "K_SHIFT":case "K_LSHIFT":case "K_RSHIFT":-1!=l.indexOf("shift")&&(t.sp=e["SHIFT-ON"]);"desktop"!=d&&(t.nextlayer="default"!=l?"default":"shift");break;case "K_LCTRL":case "K_LCONTROL":if(c){-1!=l.indexOf("leftctrl")&&(t.sp=e["SHIFT-ON"]);break}case "K_RCTRL":case "K_RCONTROL":if(c){-1!=l.indexOf("rightctrl")&&(t.sp=e["SHIFT-ON"]);break}case "K_CONTROL":-1==
l.indexOf("ctrl")||c&&(-1==l.indexOf("leftctrl")||-1==l.indexOf("rightctrl"))||(t.sp=e["SHIFT-ON"]);break;case "K_LALT":if(c){-1!=l.indexOf("leftalt")&&(t.sp=e["SHIFT-ON"]);break}case "K_RALT":if(c){-1!=l.indexOf("rightalt")&&(t.sp=e["SHIFT-ON"]);break}case "K_ALT":-1==l.indexOf("alt")||c&&(-1==l.indexOf("leftalt")||-1==l.indexOf("rightalt"))||(t.sp=e["SHIFT-ON"]);break;case "K_oE2":"undefined"!=typeof f&&f||("desktop"==d?(h.splice(k--,1),h[0].width="200"):h[k].sp=e.HIDDEN)}}};b.processLegacyDefinitions=
function(a){for(var c=b.generateLayerIds(!1),d={},f=0;f<c.length;f++){for(var l=c[f],e=[],g=!1,h=0;65>h;h++){var k=h+65*f;e.push(a[k]);k<a.length&&""!=a[k]&&h!=b.dfltCodes.indexOf("K_SPACE")&&(g=!0)}g&&(d[l]=e)}"undefined"!=typeof d["default"]&&d["default"]||(d["default"]=[""]);"undefined"!=typeof d.shift&&d.shift||(d.shift=[""]);return d};b.dfltCodes="K_BKQUOTE K_1 K_2 K_3 K_4 K_5 K_6 K_7 K_8 K_9 K_0 K_HYPHEN K_EQUAL K_* K_* K_* K_Q K_W K_E K_R K_T K_Y K_U K_I K_O K_P K_LBRKT K_RBRKT K_BKSLASH K_* K_* K_* K_A K_S K_D K_F K_G K_H K_J K_K K_L K_COLON K_QUOTE K_* K_* K_* K_* K_* K_oE2 K_Z K_X K_C K_V K_B K_N K_M K_COMMA K_PERIOD K_SLASH K_* K_* K_* K_* K_* K_SPACE".split(" ");
b.dfltText="`1234567890-=\u00a7~~qwertyuiop[]\\~~~asdfghjkl;'~~~~~?zxcvbnm,./~~~~~ ~!@#$%^&*()_+\u00a7~~QWERTYUIOP{}\\~~~ASDFGHJKL:\"~~~~~?ZXCVBNM<>?~~~~~ ";b.DEFAULT_RAW_SPEC={F:"Tahoma",BK:b.dfltText};b.buttonClasses={DEFAULT:"0",SHIFT:"1","SHIFT-ON":"2",SPECIAL:"3","SPECIAL-ON":"4",DEADKEY:"8",BLANK:"9",HIDDEN:"10"};b.modifierSpecials={leftalt:"*LAlt*",rightalt:"*RAlt*",alt:"*Alt*",leftctrl:"*LCtrl*",rightctrl:"*RCtrl*",ctrl:"*Ctrl*","ctrl-alt":"*AltGr*","leftctrl-leftalt":"*LAltCtrl*","rightctrl-rightalt":"*RAltCtrl*",
"leftctrl-leftalt-shift":"*LAltCtrlShift*","rightctrl-rightalt-shift":"*RAltCtrlShift*",shift:"*Shift*","shift-alt":"*AltShift*","shift-ctrl":"*CtrlShift*","shift-ctrl-alt":"*AltCtrlShift*","leftalt-shift":"*LAltShift*","rightalt-shift":"*RAltShift*","leftctrl-shift":"*LCtrlShift*","rightctrl-shift":"*RCtrlShift*"};b.dfltLayout={desktop:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"1",key:[{id:"K_BKQUOTE"},{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},
{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"130"}]},{id:"2",key:[{id:"K_TAB",text:"*Tab*",sp:"1",width:"130"},{id:"K_Q"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{id:"K_BKSLASH"}]},{id:"3",key:[{id:"K_CAPS",text:"*Caps*",sp:"1",width:"165"},{id:"K_A"},{id:"K_S"},{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},
{id:"K_ENTER",text:"*Enter*",sp:"1",width:"165"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"130"},{id:"K_oE2"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_RSHIFT",text:"*Shift*",sp:"1",width:"130"}]},{id:"5",key:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"170"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_SPACE",text:"",width:"770"},{id:"K_RALT",text:"*Alt*",sp:"1",width:"160"},{id:"K_RCONTROL",
text:"*Ctrl*",sp:"1",width:"170"}]}]}]},tablet:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},
{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",
width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",sp:"1",width:"150"},{id:"K_SPACE",text:"",width:"570"},{id:"K_BKSP",text:"*BkSp*",sp:"1",width:"150"},{id:"K_ENTER",
text:"*Enter*",sp:"1",width:"200"}]}]}]},phone:{font:"Tahoma,Helvetica",layer:[{id:"default",row:[{id:"0",key:[{id:"K_1"},{id:"K_2"},{id:"K_3"},{id:"K_4"},{id:"K_5"},{id:"K_6"},{id:"K_7"},{id:"K_8"},{id:"K_9"},{id:"K_0"},{id:"K_HYPHEN"},{id:"K_EQUAL"},{sp:"10",width:"1"}]},{id:"1",key:[{id:"K_Q",pad:"25"},{id:"K_W"},{id:"K_E"},{id:"K_R"},{id:"K_T"},{id:"K_Y"},{id:"K_U"},{id:"K_I"},{id:"K_O"},{id:"K_P"},{id:"K_LBRKT"},{id:"K_RBRKT"},{sp:"10",width:"1"}]},{id:"2",key:[{id:"K_A",pad:"50"},{id:"K_S"},
{id:"K_D"},{id:"K_F"},{id:"K_G"},{id:"K_H"},{id:"K_J"},{id:"K_K"},{id:"K_L"},{id:"K_COLON"},{id:"K_QUOTE"},{id:"K_BKSLASH",width:"90"}]},{id:"3",key:[{id:"K_oE2",width:"90"},{id:"K_Z"},{id:"K_X"},{id:"K_C"},{id:"K_V"},{id:"K_B"},{id:"K_N"},{id:"K_M"},{id:"K_COMMA"},{id:"K_PERIOD"},{id:"K_SLASH"},{id:"K_BKQUOTE"},{sp:"10",width:"1"}]},{id:"4",key:[{id:"K_SHIFT",text:"*Shift*",sp:"1",width:"200",sk:[{id:"K_LCONTROL",text:"*Ctrl*",sp:"1",width:"50",nextlayer:"ctrl"},{id:"K_LCONTROL",text:"*LCtrl*",sp:"1",
width:"50",nextlayer:"leftctrl"},{id:"K_RCONTROL",text:"*RCtrl*",sp:"1",width:"50",nextlayer:"rightctrl"},{id:"K_LALT",text:"*Alt*",sp:"1",width:"50",nextlayer:"alt"},{id:"K_LALT",text:"*LAlt*",sp:"1",width:"50",nextlayer:"leftalt"},{id:"K_RALT",text:"*RAlt*",sp:"1",width:"50",nextlayer:"rightalt"},{id:"K_ALTGR",text:"*AltGr*",sp:"1",width:"50",nextlayer:"ctrl-alt"}]},{id:"K_LOPT",text:"*Menu*",width:"150",sp:"1"},{id:"K_SPACE",width:"570",text:""},{id:"K_BKSP",text:"*BkSp*",width:"150",sp:"1"},{id:"K_ENTER",
text:"*Enter*",width:"200",sp:"1"}]}]}]}};return b}();h.Layouts=e})(k.keyboards||(k.keyboards={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){var k=function(){function a(){this.isMnemonic=!1}Object.defineProperty(a.prototype,"baseKeyID",{get:function(){if("undefined"!==typeof this.id)return this.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"coreID",{get:function(){if("undefined"!==typeof this.id){var a=this.id||"";this.displayLayer!=this.layer&&(a=a+"+"+this.layer);return a}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"elementID",{get:function(){if("undefined"!==
typeof this.id)return this.displayLayer+"-"+this.coreID},enumerable:!0,configurable:!0});a.polyfill=function(c,b,l){var d=new a,f=Object.getPrototypeOf(d),e;for(e in d)if(!c.hasOwnProperty(e)){var g=Object.getOwnPropertyDescriptor(f,e);g?Object.defineProperty(c,e,g):c[e]=d[e]}if(c.sk)for(d=0,f=c.sk;d<f.length;d++)a.polyfill(f[d],b,l);c.displayLayer=l;c.layer=c.layer||l;c.constructBaseKeyEvent(b,l)};a.prototype.constructBaseKeyEvent=function(a,c){var b=this.layer||c||"",d=this.id?this.id.toUpperCase():
null;c={Lmodifiers:g.text.KeyboardProcessor.getModifierState(b),Lstates:g.text.KeyboardProcessor.getStateFromLayer(b),Lcode:d?g.text.Codes.keyCodes[d]:0,LisVirtualKey:!0,vkCode:0,kName:d,kLayer:b,kbdLayer:c,kNextLayer:this.nextlayer,device:null,isSynthetic:!0};a.keyboard&&(b=a.keyboard,!b.isMnemonic||a.isDefault&&"desktop"!=a.formFactor?c.vkCode=c.Lcode:c.Lcode!=g.text.Codes.keyCodes.K_SPACE&&(c.vkCode=c.Lcode,this.isMnemonic=!0),b.definesPositionalOrMnemonic||(c.Lcode=g.KeyMapping._USKeyCodeToCharCode(this.constructKeyEvent(null,
null)),c.LisVirtualKey=!1));this.baseKeyEvent=c};a.prototype.constructKeyEvent=function(a,c){var b=g.utils.deepCopy(this.baseKeyEvent);b.device=c;this.isMnemonic&&g.text.KeyboardProcessor.setMnemonicCode(b,-1!=this.layer.indexOf("shift"),a?a.stateKeys.K_CAPS:!1);a&&(a.setSyntheticEventDefaults(b),a={K_CAPS:g.text.Codes.stateBitmasks.CAPS,K_NUMLOCK:g.text.Codes.stateBitmasks.NUM_LOCK,K_SCROLL:g.text.Codes.stateBitmasks.SCROLL_LOCK}[b.kName])&&(b.Lstates^=a,b.LmodifierChange=!0);return b};a.prototype.getSubkey=
function(a){if(this.sk)for(var c=0,b=this.sk;c<b.length;c++){var d=b[c];if(d.coreID==a)return d}return null};a.DEFAULT_PAD=15;a.DEFAULT_RIGHT_MARGIN=15;a.DEFAULT_KEY_WIDTH=100;a.DEFAULT_KEY={text:"",width:a.DEFAULT_KEY_WIDTH.toString(),sp:"0",pad:a.DEFAULT_PAD.toString()};return a}();h.ActiveKey=k;var e=function(){function a(){}a.polyfill=function(c,b,l,e,g){for(var d=c.key,f=0;f<d.length;f++){var q=d[f];for(w in k.DEFAULT_KEY)"string"!=typeof q[w]&&(q[w]=k.DEFAULT_KEY[w]);switch(q.sp){case "1":a.SPECIAL_LABEL.test(q.text)||
""==q.text||(q.sp="3");break;case "2":a.SPECIAL_LABEL.test(q.text)||""==q.text||(q.sp="4")}k.polyfill(q,b,l)}for(f=b=0;f<d.length-1;f++){l=parseInt(d[f].width,10)/e;d[f].widthpc=l;var h=parseInt(d[f].pad,10)/e;d[f].padpc=h;var w=d[f];var r=h,y=l,A=b;w.proportionalPad=r;w.proportionalWidth=y;w.proportionalX=A+r+y/2;b+=h+l}b+=k.DEFAULT_RIGHT_MARGIN/e;1==d.length&&0>parseInt(d[0].pad,10)?(l=parseInt(d[0].width,10)/e,d[0].widthpc=l,b+=l,d[0].padpc=1-b,e=d[0],e.proportionalPad=h,e.proportionalWidth=l,
e.proportionalX=b+h+l/2):0<d.length&&(f=d.length-1,h=parseInt(d[f].pad,10)/e,d[f].padpc=h,b+=h,d[f].widthpc=l=1-b,e=d[f],e.proportionalPad=h,e.proportionalWidth=l,e.proportionalX=b+h+l/2);b=new a;for(q in b)c.hasOwnProperty(q)||(c[q]=b[q]);c.proportionalY=g};a.prototype.populateKeyMap=function(a){this.key.forEach(function(c){c.coreID&&(a[c.coreID]=c)})};a.SPECIAL_LABEL=/\*\w+\*/;return a}();h.ActiveRow=e;var b=function(){function a(){}a.polyfill=function(c,b){c.aligned=!1;for(var d=c.row,f=0,g=0;g<
c.row.length;g++){for(var h=0,n=d[g].key,t=0;t<n.length;t++){var v=n[t];if(null==v)--n.length;else{var z="string"==typeof v.width&&""!=v.width?parseInt(v.width,10):k.DEFAULT_KEY_WIDTH;if(isNaN(z)||0==z)z=k.DEFAULT_KEY_WIDTH;v.width=z.toString();var r="string"==typeof v.pad&&""!=v.pad?parseInt(v.pad,10):k.DEFAULT_PAD;if(isNaN(r)||0==r)r=k.DEFAULT_PAD;v.pad=r.toString();h+=z+r}}h>f&&(f=h)}f="desktop"==b.formFactor?f+5:f+k.DEFAULT_RIGHT_MARGIN;d=c.row.length;for(g=0;g<d;g++)e.polyfill(c.row[g],b,c.id,
f,(g+.5)/d);b=new a;for(v in b)c.hasOwnProperty(v)||(c[v]=b[v]);c.totalWidth=f;c.defaultKeyProportionalWidth=parseInt(k.DEFAULT_KEY.width,10)/f;c.rowProportionalHeight=1/d;c.keyMap=c.constructKeyMap()};a.prototype.constructKeyMap=function(){var a={};this.row.forEach(function(c){c.populateKeyMap(a)});return a};a.prototype.getTouchProbabilities=function(a,c){a=this.simpleTouchDistribution(a,c);c=[];for(var b in a)c.push({keyId:b,p:a[b]});return c.sort(function(a,c){return c.p-a.p})};a.prototype.simpleTouchDistribution=
function(a,c){a=this.keyTouchDistances(a,c);c={};var b=0,d;for(d in a)b+=c[d]=1/(a[d]+1E-6);for(d in c)c[d]/=b;return c};a.prototype.keyTouchDistances=function(a,c){var b=this,d={};this.row.forEach(function(f){f.key.forEach(function(l){if(l.baseKeyID&&!g.text.Codes.isKnownOSKModifierKey(l.baseKeyID)){var e=Math.abs(a.x-l.proportionalX),q=Math.abs(a.y-f.proportionalY);if(e>.5*l.proportionalWidth){var h=e-.5*l.proportionalWidth;e=.5}else h=0,e/=l.proportionalWidth;if(q>.5*b.rowProportionalHeight){var k=
q-.5*b.rowProportionalHeight;q=.5}else k=0,q/=b.rowProportionalHeight;h*=c;h+=e*b.rowProportionalHeight;k+=q*b.rowProportionalHeight;d[l.coreID]=h*h+k*k}})});return d};a.prototype.getKey=function(a){0==a.indexOf(this.id+"-")&&(a=a.replace(this.id+"-",""));var c=a.split("::");return 1<c.length?this.keyMap[c[0]].getSubkey(c[1]):this.keyMap[a]};return a}();h.ActiveLayer=b;var a=function(){function a(){}a.prototype.getLayer=function(a){return this.layerMap[a]};a.correctLayerEmptyRowBug=function(a){for(var c=
0;c<a.length;c++){var b=a[c].row,d;for(d=b.length-1;0<=d;d--)Array.isArray(b[d].key)&&0!=b[d].key.length||b.splice(d,1)}};a.polyfill=function(c,f,l){if(null==c)throw Error("Cannot build an ActiveLayout for a null specification.");var d={},e=c.layer;a.correctLayerEmptyRowBug(e);var g=new a,h;for(h in g)c.hasOwnProperty(h)||(c[h]=g[h]);c.keyboard=f;c.formFactor=l;for(f=0;f<e.length;f++)b.polyfill(e[f],c),d[e[f].id]=e[f];c.layerMap=d;return c};return a}();h.ActiveLayout=a})(g.keyboards||(g.keyboards=
{}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function b(a){this.id=a}b.prototype.set=function(a){throw Error("System store with ID "+this.id+" may not be directly set.");};return b}();g.SystemStore=h;var e=function(b){function a(a,d){a=b.call(this,a)||this;a.handler=null;a._value=d;return a}__extends(a,b);Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.matches=function(a){return this._value==a};a.prototype.set=function(a){this.handler&&
this.handler(this,a)||(this._value=a)};return a}(h);g.MutableSystemStore=e;h=function(b){function a(a){var c=b.call(this,g.KeyboardInterface.TSS_PLATFORM)||this;c.kbdInterface=a;return c}__extends(a,b);a.prototype.matches=function(a){var c=a.split(" "),b=this.kbdInterface.activeDevice;for(a=0;a<c.length;a++){var l=c[a].toLowerCase();switch(l){case "touch":case "hardware":if(b.touchable!=("touch"==l))return!1;break;case "macos":case "mac":l="macosx";case "macosx":case "windows":case "android":case "ios":case "linux":if(b.OS!=
l)return!1;break;case "tablet":case "phone":case "desktop":if(b.formFactor!=l)return!1;break;case "web":if("native"==b.browser)return!1;break;case "native":case "ie":case "chrome":case "firefox":case "safari":case "edge":case "opera":if(b.browser!=l)return!1;break;default:return!1}}return!0};return a}(h);g.PlatformSystemStore=h})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){return function(){}}();h.KeyInformation=n;(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();(function(){return function(){}})();var e=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:
this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};return a}(),b=function(){function a(){}a.prototype.reset=function(){this._cache=[]};a.prototype.get=function(a,c){return"undefined"==typeof this._cache[a]||"undefined"==typeof this._cache[a][c]?null:this._cache[a][c]};a.prototype.set=function(a,c,b){"undefined"==typeof this._cache[a]&&(this._cache[a]=[]);this._cache[a][c]=b};a.prototype.clone=function(){var c=new a;c._cache=
this._cache;return c};return a}(),a=function(){function a(c){void 0===c&&(c=null);this.cachedContext=new e;this.cachedContextEx=new b;this._AnyIndices=[];this.systemStores={};this.systemStores[a.TSS_PLATFORM]=new h.PlatformSystemStore(this);this.systemStores[a.TSS_LAYER]=new h.MutableSystemStore(a.TSS_LAYER,"default");this.systemStores[a.TSS_NEWLAYER]=new h.MutableSystemStore(a.TSS_NEWLAYER,"");this.systemStores[a.TSS_OLDLAYER]=new h.MutableSystemStore(a.TSS_OLDLAYER,"");this.variableStoreSerializer=
c}a.prototype.saveFocus=function(){};a.prototype.registerKeyboard=function(a){this.activeKeyboard=new k.keyboards.Keyboard(a)};a.prototype.context=function(a,c,b){var d=this.cachedContext.get(a,c);if(null!==d)return d;b=this.KC_(a,c,b);this.cachedContext.set(a,c,b);return b};a.prototype.KC_=function(a,c,b){b=b.isSelectionEmpty()?b.getTextBeforeCaret():"";b._kmwLength()<a&&(b=Array(a-b._kmwLength()+1).join("\ufffe")+b);return b._kmwSubstr(-a)._kmwSubstr(0,c)};a.prototype.nul=function(a,c){return"\ufffe"===
this.context(a+1,1,c)};a.prototype.contextMatch=function(a,c,b,e){if(this.context(a,e,c)===b)return!0;c.deadkeys().resetMatched();return!1};a.prototype._BuildExtendedContext=function(a,c,b){var d=this.cachedContextEx.get(a,c);if(null!==d)return d;d=this.cachedContextEx.get(a,a);if(null===d){var f=b.deadkeys().toSortedArray(),l=0;for(d={valContext:[],deadContext:[]};d.valContext.length<a;){var e=b.getDeadkeyCaret()-l;0<f.length&&f[0].p>e?f.splice(0,1):0<f.length&&f[0].p==e?(d.deadContext[a-d.valContext.length-
1]=f[0],d.valContext=[f[0].d].concat(d.valContext),f.splice(0,1)):(e=this.context(++l,1,b),d.valContext=[e].concat(d.valContext))}this.cachedContextEx.set(a,a,d)}b=d;b.valContext=b.valContext.slice(0,c);for(d=0;d<b.valContext.length;d++)"\ufffe"==b[d]&&(b.valContext.splice(0,1),b.deadContext.splice(0,1));0==b.valContext.length&&(b.valContext=["\ufffe"],b.deadContext=[]);this.cachedContextEx.set(a,c,b);return b};a.prototype.fullContextMatch=function(a,c,b){var d=this._BuildExtendedContext(a,b.length,
c);this.ruleContextEx=this.cachedContextEx.clone();a=d.valContext;d=d.deadContext;for(var f=!1,l=0;l<b.length;l++)if("string"==typeof b[l]){if(b[l]!==a[l]){f=!0;break}}else{var e=b[l];switch(e.t){case "d":e.d!==a[l]?f=!0:d[l].set();break;case "a":var g=this.any(l,"string"==typeof a[l]?a[l]:{t:"d",d:a[l]},e.a);e.n?e.n&&(g||"\ufffe"===a[l])&&(f=!0):g?void 0!==d[l]&&d[l].set():f=!0;break;case "i":e=this._Index(e.i,e.o);void 0!==e&&("string"==typeof e?e:e.d)!==a[l]?f=!0:void 0!==d[l]&&d[l].set();break;
case "c":a[e.c-1]!==a[l]?f=!0:void 0!==d[l]&&d[l].set();break;case "n":"\ufffe"!=a[l]&&(f=!0);break;default:throw Error("Unexpected object in fullContextMatch specification: "+e);}}f&&(c.deadkeys().resetMatched(),this._AnyIndices=[]);return!f};a.prototype.isKeypress=function(a){return this.activeKeyboard.isMnemonic?!a.LisVirtualKey:k.KeyMapping._USKeyCodeToCharCode(a)?!0:!1};a.prototype.keyMatch=function(a,c,b){var d=!1,f=173==a.Lcode?189:a.Lcode,l=this.activeKeyboard.modifierBitmask,e=g.keyman.text.Codes,
h=l&e.modifierBitmasks.ALL;l&=e.stateBitmasks.ALL;255<a.vkCode&&(f=a.vkCode);if(a.LisVirtualKey||255<f){if(16384==(c&16384)||255<f)d=(d=b==f&&(c&h)==a.Lmodifiers)&&this.stateMatch(a,c&l)}else 0==(c&16384)&&(d=f==b);d||this.activeTargetOutput.deadkeys().resetMatched();return d};a.prototype.stateMatch=function(a,c){return(c&a.Lstates)==c};a.prototype.keyInformation=function(a){var c=new n;c.vk=a.LisVirtualKey;c.code=a.Lcode;c.modifiers=a.Lmodifiers;return c};a.prototype.deadkeyMatch=function(a,c,b){return c.hasDeadkeyMatch(a,
b)};a.prototype.beep=function(a){this.resetContextCache();this.ruleBehavior.beep=!0};a.prototype._ExplodeStore=function(a){if("string"==typeof a){var c=this.activeKeyboard.explodedStores;if(c[a])return c[a];for(var b=[],d=0;d<a._kmwLength();d++)b.push(a._kmwCharAt(d));return c[a]=b}return a};a.prototype.any=function(a,c,b){if(""==c)return!1;b=this._ExplodeStore(b);for(var d=-1,f=0;f<b.length;f++)if("string"==typeof b[f]){if(b[f]==c){d=f;break}}else if(b[f].d===c.d){d=f;break}this._AnyIndices[a]=d;
return 0<=d};a.prototype._Index=function(a,c){a=this._ExplodeStore(a);if(this._AnyIndices[c-1]<a.length)return a[this._AnyIndices[c-1]];console.warn("Unmatched contextual index() statement detected in rule with index "+c+"!");return""};a.prototype.indexOutput=function(a,c,b,e){this.resetContextCache();c=this._Index(c,b);if(""!==c)if("string"==typeof c)this.output(a,e,c);else if(c.t)switch(c.t){case "b":this.beep(e);break;case "d":this.deadkeyOutput(a,e,c.d);break;default:throw Error("Unexpected object in fullContextMatch specification: "+
c);}else this.deadkeyOutput(a,e,c.d)};a.prototype.deleteContext=function(a,c){if(0<a){var b=this._BuildExtendedContext(a,a,c);for(var d=0,f=0;f<b.valContext.length;f++){var e=b.deadContext[f];e?(c.deadkeys().remove(e),a--):"\ufffe"==b.valContext[f]&&d++}b=b.valContext.length-d;a>b&&(a=b)}c.deadkeys().resetMatched();this.output(a,c,"")};a.prototype.output=function(a,c,b){this.resetContextCache();c.saveProperties();c.clearSelection();c.deadkeys().deleteMatched();0<=a&&c.deleteCharsBeforeCaret(a);c.insertTextBeforeCaret(b);
c.restoreProperties()};a.prototype.contextExOutput=function(a,c,b,e){this.resetContextCache();0<=a&&this.output(a,c,"");b=this.ruleContextEx.get(b,b);a=b.deadContext[e-1];e=b.valContext[e-1];if(a)c.insertDeadkeyBeforeCaret(a.d);else if("string"==typeof e)this.output(-1,c,e);else throw Error("contextExOutput: should never be a numeric valContext with no corresponding deadContext");};a.prototype.deadkeyOutput=function(a,c,b){this.resetContextCache();0<=a&&this.output(a,c,"");c.insertDeadkeyBeforeCaret(b)};
a.prototype.ifStore=function(a,c,b){b=!0;(a=this.systemStores[a])&&(b=a.matches(c));return b};a.prototype.setStore=function(c,b,l){this.resetContextCache();if(c==a.TSS_LAYER&&this.activeDevice.touchable)this.ruleBehavior.setStore[c]=b;else return!1};a.prototype.loadStore=function(a,c,b){this.resetContextCache();return this.variableStoreSerializer?this.variableStoreSerializer.loadStore(a,c)[c]||b:b};a.prototype.saveStore=function(a,c){this.resetContextCache();var b=this.activeKeyboard;if(!b||"undefined"==
typeof b.id||""==b.id)return!1;b={};b[a]=c;this.ruleBehavior?this.ruleBehavior.saveStore[a]=b:this.variableStoreSerializer.saveStore(this.activeKeyboard.id,a,b);return!0};a.prototype.resetContextCache=function(){this.cachedContext.reset();this.cachedContextEx.reset()};a.prototype.defaultBackspace=function(a){a.isSelectionEmpty()?this.output(1,a,""):this.output(0,a,"")};a.prototype.processNewContextEvent=function(a,c){if(!this.activeKeyboard)throw"No active keyboard for keystroke processing!";return this.process(this.activeKeyboard.processNewContextEvent.bind(this.activeKeyboard),
a,c,!0)};a.prototype.processPostKeystroke=function(a,c){if(!this.activeKeyboard)throw"No active keyboard for keystroke processing!";return this.process(this.activeKeyboard.processPostKeystroke.bind(this.activeKeyboard),a,c,!0)};a.prototype.processKeystroke=function(a,c){if(!this.activeKeyboard)throw"No active keyboard for keystroke processing!";return this.process(this.activeKeyboard.process.bind(this.activeKeyboard),a,c,!1)};a.prototype.process=function(a,c,b,e){if(c){if(!this.activeKeyboard)throw"No active keyboard for keystroke processing!";
if(!a)throw"No callee for keystroke processing!";}else throw"No target specified for keyboard output!";c.invalidateSelection();c.deadkeys().resetMatched();this.resetContextCache();var d=h.Mock.from(c,!0),f=this.activeKeyboard.variableStores;this.ruleBehavior=new h.RuleBehavior;this.activeDevice=b.device;this.activeTargetOutput=c;a=a(c,b);this.activeTargetOutput=null;this.ruleBehavior.transcription=c.buildTranscriptionFrom(d,b,e);this.ruleBehavior.variableStores=this.activeKeyboard.variableStores;
this.activeKeyboard.variableStores=f;this.ruleBehavior.triggerKeyDefault=!a;c=this.ruleBehavior;this.ruleBehavior=null;return c};a.prototype.applyVariableStores=function(a){this.activeKeyboard.variableStores=a};a.__publishShorthandAPI=function(){var a=this.prototype,c=function(c,b){a[c]=a[b]};c("KSF","saveFocus");c("KBR","beepReset");c("KT","insertText");c("KR","registerKeyboard");c("KRS","registerStub");c("KC","context");c("KN","nul");c("KCM","contextMatch");c("KFCM","fullContextMatch");c("KIK",
"isKeypress");c("KKM","keyMatch");c("KSM","stateMatch");c("KKI","keyInformation");c("KDM","deadkeyMatch");c("KB","beep");c("KA","any");c("KDC","deleteContext");c("KO","output");c("KDO","deadkeyOutput");c("KCXO","contextExOutput");c("KIO","indexOutput");c("KIFS","ifStore");c("KSETS","setStore");c("KLOAD","loadStore");c("KSAVE","saveStore")};a.GLOBAL_NAME="KeymanWeb";a.TSS_LAYER=33;a.TSS_PLATFORM=31;a.TSS_NEWLAYER=42;a.TSS_OLDLAYER=43;return a}();h.KeyboardInterface=a;a.__publishShorthandAPI()})(k.text||
(k.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){var k=function(){return function(){this.stores={}}}(),e;(function(a){a[a.NOT_LOADED=void 0]="NOT_LOADED";a[a.POLYFILLED=1]="POLYFILLED";a[a.CALIBRATED=2]="CALIBRATED"})(e=h.LayoutState||(h.LayoutState={}));var b=function(){function a(c){this.scriptObject=c?c:a.DEFAULT_SCRIPT_OBJECT;this.layoutStates={}}a.prototype.process=function(a,b){return this.scriptObject.gs(a,b)};a.prototype.processNewContextEvent=function(a,b){return this.scriptObject.gn?this.scriptObject.gn(a,
b):!1};a.prototype.processPostKeystroke=function(a,b){return this.scriptObject.gpk?this.scriptObject.gpk(a,b):!1};Object.defineProperty(a.prototype,"isHollow",{get:function(){return this.scriptObject==a.DEFAULT_SCRIPT_OBJECT},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.scriptObject.KI},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"name",{get:function(){return this.scriptObject.KN},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"variableStores",{get:function(){var a=this.scriptObject.KVS,b={};if(Array.isArray(a))for(var f=0;f<a.length;f++){var l=a[f];b[l]=this.scriptObject[l]}return b},set:function(a){var c=this.scriptObject.KVS;if(Array.isArray(c))for(var b=0;b<c.length;b++){var l=c[b];"string"==typeof a[l]&&(this.scriptObject[l]=a[l])}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_legacyLayoutSpec",{get:function(){return this.scriptObject.KV},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_layouts",{get:function(){return this.scriptObject.KVKL},set:function(a){this.scriptObject.KVKL=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"compilerVersion",{get:function(){return new g.utils.Version(this.scriptObject.KVER)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isMnemonic",{get:function(){return!!this.scriptObject.KM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"definesPositionalOrMnemonic",{get:function(){return"undefined"!=
typeof this.scriptObject.KM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"helpText",{get:function(){return this.scriptObject.KH},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasScript",{get:function(){return!!this.scriptObject.KHF},enumerable:!0,configurable:!0});a.prototype.embedScript=function(a){this.scriptObject.KHF(a)};Object.defineProperty(a.prototype,"oskStyling",{get:function(){return this.scriptObject.KCSS},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"isCJK",{get:function(){var a;"undefined"!=typeof this.scriptObject.KLC?a=this.scriptObject.KLC:"undefined"!=typeof this.scriptObject.LanguageCode&&(a=this.scriptObject.LanguageCode);return"cmn"==a||"jpn"==a||"kor"==a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isRTL",{get:function(){return!!this.scriptObject.KRTL},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"modifierBitmask",{get:function(){return this.scriptObject.KMBM||g.text.Codes.modifierBitmasks.NON_CHIRAL},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isChiral",{get:function(){return!!(this.modifierBitmask&g.text.Codes.modifierBitmasks.IS_CHIRAL)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"desktopFont",{get:function(){return this.scriptObject.KV?this.scriptObject.KV.F:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"cacheTag",{get:function(){var a=this.scriptObject._kmw;a||(a=new k,this.scriptObject._kmw=a);return a},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"explodedStores",{get:function(){return this.cacheTag.stores},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"emulatesAltGr",{get:function(){var a=g.text.Codes.modifierCodes;if(!this.isChiral||null==this._legacyLayoutSpec)return!1;var b=this._legacyLayoutSpec.KLS;if(!b)return!1;var f=a.LCTRL|a.LALT,l=b[h.Layouts.getLayerId(f)];f=b[h.Layouts.getLayerId(a.SHIFT|f)];return null!=l&&l!=b[h.Layouts.getLayerId(a.RALT)]||null!=f&&f!=
b[h.Layouts.getLayerId(a.RALT|a.SHIFT)]?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usesSupplementaryPlaneChars",{get:function(){var a=this.scriptObject;return a&&(a.KS&&1==a.KS||"Hieroglyphic"==a.KN)},enumerable:!0,configurable:!0});a.prototype.usesDesktopLayoutOnDevice=function(a){return this.scriptObject.KVKL?a.formFactor==g.utils.FormFactor.Desktop:!0};a.prototype.notify=function(a,b,f){"function"==typeof this.scriptObject.KNS&&this.scriptObject.KNS(a,b,f)};a.prototype.findOrConstructLayout=
function(a){if(this._layouts){if(void 0!==this._layouts[a])return this._layouts[a];if(a==g.utils.FormFactor.Phone&&this._layouts[g.utils.FormFactor.Tablet])return this._layouts[g.utils.FormFactor.Phone]=this._layouts[g.utils.FormFactor.Tablet];if(a==g.utils.FormFactor.Tablet&&this._layouts[g.utils.FormFactor.Phone])return this._layouts[g.utils.FormFactor.Tablet]=this._layouts[g.utils.FormFactor.Phone]}var c=null;if(null!=this._legacyLayoutSpec&&this._legacyLayoutSpec.KLS)c=this._legacyLayoutSpec;
else if(null!=this._legacyLayoutSpec&&null!=this._legacyLayoutSpec.BK)for(var b=this._legacyLayoutSpec.BK,l=0;l<b.length;l++)if(0<b[l].length){c=this._legacyLayoutSpec;break}c||""!=this.helpText&&a==g.utils.FormFactor.Desktop||(c={F:"Tahoma",BK:h.Layouts.dfltText});this._layouts||(this._layouts={});return c?(a=this._layouts[a]=h.Layouts.buildDefaultLayout(c,this,a),a.isDefault=!0,a):this._layouts[a]=null};a.prototype.layout=function(a){var c=this.findOrConstructLayout(a);return c?(this.layoutStates[a]==
e.NOT_LOADED&&(c=h.ActiveLayout.polyfill(c,this,a),this.layoutStates[a]=e.POLYFILLED),c):null};a.prototype.refreshLayouts=function(){var a=this;[g.utils.FormFactor.Desktop,g.utils.FormFactor.Phone,g.utils.FormFactor.Tablet].forEach(function(c){a.layoutStates[c]=e.NOT_LOADED})};a.prototype.markLayoutCalibrated=function(a){this.layoutStates[a]!=e.NOT_LOADED&&(this.layoutStates[a]=e.CALIBRATED)};a.prototype.getLayoutState=function(a){return this.layoutStates[a]};a.DEFAULT_SCRIPT_OBJECT={gs:function(a,
b){return!1},KI:"",KN:"",KV:h.Layouts.DEFAULT_RAW_SPEC,KM:0};return a}();h.Keyboard=b})(g.keyboards||(g.keyboards={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){var h=function(){return function(){}}(),k=function(){return function(){this.FF=new h;this.Safari=new h;this.Opera=new h;this.FF.k61=187;this.FF.k59=186;this.FF.k173=189}}(),e=function(){return function(){this.se=new h;this.se.k220=192;this.se.k187=189;this.se.k219=187;this.se.k221=219;this.se.k186=221;this.se.k191=220;this.se.k192=186;this.se.k189=191;this.uk=new h;this.uk.k223=192;this.uk.k192=222;this.uk.k222=226;this.uk.k220=220}}(),b=function(){function a(){}a._usCodeInit=
function(){var c=new h,b=new h;c.k192=96;c.k49=49;c.k50=50;c.k51=51;c.k52=52;c.k53=53;c.k54=54;c.k55=55;c.k56=56;c.k57=57;c.k48=48;c.k189=45;c.k187=61;c.k81=113;c.k87=119;c.k69=101;c.k82=114;c.k84=116;c.k89=121;c.k85=117;c.k73=105;c.k79=111;c.k80=112;c.k219=91;c.k221=93;c.k220=92;c.k65=97;c.k83=115;c.k68=100;c.k70=102;c.k71=103;c.k72=104;c.k74=106;c.k75=107;c.k76=108;c.k186=59;c.k222=39;c.k90=122;c.k88=120;c.k67=99;c.k86=118;c.k66=98;c.k78=110;c.k77=109;c.k188=44;c.k190=46;c.k191=47;b.k192=126;b.k49=
33;b.k50=64;b.k51=35;b.k52=36;b.k53=37;b.k54=94;b.k55=38;b.k56=42;b.k57=40;b.k48=41;b.k189=95;b.k187=43;b.k81=81;b.k87=87;b.k69=69;b.k82=82;b.k84=84;b.k89=89;b.k85=85;b.k73=73;b.k79=79;b.k80=80;b.k219=123;b.k221=125;b.k220=124;b.k65=65;b.k83=83;b.k68=68;b.k70=70;b.k71=71;b.k72=72;b.k74=74;b.k75=75;b.k76=76;b.k186=58;b.k222=34;b.k90=90;b.k88=88;b.k67=67;b.k86=86;b.k66=66;b.k78=78;b.k77=77;b.k188=60;b.k190=62;b.k191=63;a._usCharCodes=[c,b]};a._USKeyCodeToCharCode=function(b){return a.usCharCodes[b.Lmodifiers&
16?1:0]["k"+b.Lcode]};Object.defineProperty(a,"usCharCodes",{get:function(){a._usCharCodes||a._usCodeInit();return a._usCharCodes},enumerable:!0,configurable:!0});a.browserMap=new k;a.languageMap=new e;return a}();g.KeyMapping=b})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){var k=function(){function e(b,a){this.stateKeys={K_CAPS:!1,K_NUMLOCK:!1,K_SCROLL:!1};this.modStateFlags=0;a||(a=e.DEFAULT_OPTIONS);this.contextDevice=b;this.baseLayout=a.baseLayout||e.DEFAULT_OPTIONS.baseLayout;this.keyboardInterface=new h.KeyboardInterface(a.variableStoreSerializer);this.installInterface()}e.prototype.installInterface=function(){g.utils.getGlobalObject()[h.KeyboardInterface.GLOBAL_NAME]=this.keyboardInterface;this.activeKeyboard&&(this.keyboardInterface.activeKeyboard=
this.activeKeyboard)};Object.defineProperty(e.prototype,"activeKeyboard",{get:function(){return this.keyboardInterface.activeKeyboard},set:function(b){this.keyboardInterface.activeKeyboard=b;this.resetContext()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layerStore",{get:function(){return this.keyboardInterface.systemStores[h.KeyboardInterface.TSS_LAYER]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"newLayerStore",{get:function(){return this.keyboardInterface.systemStores[h.KeyboardInterface.TSS_NEWLAYER]},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"oldLayerStore",{get:function(){return this.keyboardInterface.systemStores[h.KeyboardInterface.TSS_OLDLAYER]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layerId",{get:function(){return this.layerStore.value},set:function(b){this.layerStore.set(b)},enumerable:!0,configurable:!0});e.prototype.defaultRuleBehavior=function(b,a,c){var d=h.Mock.from(a,c),f=new h.RuleBehavior,l=!1,e;if(b.isSynthetic||a.isSynthetic)if(l=
!0,h.DefaultOutput.isCommand(b))f.triggersDefaultCommand=!0;else if(null!=(e=h.DefaultOutput.forSpecialEmulation(b)))switch(e){case h.EmulationKeystrokes.Backspace:this.keyboardInterface.defaultBackspace(a);break;case h.EmulationKeystrokes.Enter:a.handleNewlineAtCaret();break;default:f.errorLog="Unexpected 'special emulation' character (\\u"+e.kmwCharCodeAt(0).toString(16)+") went unhandled!"}else l=!1;e=this.activeKeyboard&&this.activeKeyboard.isMnemonic;if(!l)if(null!=(l=h.DefaultOutput.forAny(b,
e)))if(e=h.DefaultOutput.forSpecialEmulation(b),e==h.EmulationKeystrokes.Backspace)this.keyboardInterface.defaultBackspace(a);else{if(e||h.DefaultOutput.isCommand(b))return null;this.keyboardInterface.output(0,a,l)}else return null;if(f.errorLog)return f;b=a.buildTranscriptionFrom(d,b,c);f.transcription=b;return f};e.prototype.setSyntheticEventDefaults=function(b){b.device.touchable||(b.Lstates|=this.stateKeys.K_CAPS?h.Codes.modifierCodes.CAPS:h.Codes.modifierCodes.NO_CAPS,b.Lstates|=this.stateKeys.K_NUMLOCK?
h.Codes.modifierCodes.NUM_LOCK:h.Codes.modifierCodes.NO_NUM_LOCK,b.Lstates|=this.stateKeys.K_SCROLL?h.Codes.modifierCodes.SCROLL_LOCK:h.Codes.modifierCodes.NO_SCROLL_LOCK);b.kName&&"U_"==b.kName.substr(0,2)&&(b.LisVirtualKey=!1);"undefined"==typeof b.Lcode&&(b.Lcode=this.getVKDictionaryCode(b.kName),b.Lcode||(b.Lcode=1));(b.Lmodifiers&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&this.activeKeyboard.emulatesAltGr&&(b.Lmodifiers&=~h.Codes.modifierBitmasks.ALT_GR_SIM,b.Lmodifiers|=
h.Codes.modifierCodes.RALT)};e.prototype.constructNullKeyEvent=function(b){b=h.KeyEvent.constructNullKeyEvent(b);this.setSyntheticEventDefaults(b);return b};e.prototype.processNewContextEvent=function(b,a){return this.activeKeyboard?this.keyboardInterface.processNewContextEvent(a,this.constructNullKeyEvent(b)):null};e.prototype.processPostKeystroke=function(b,a){return this.activeKeyboard?this.keyboardInterface.processPostKeystroke(a,this.constructNullKeyEvent(b)):null};e.prototype.processKeystroke=
function(b,a){if(this.activeKeyboard&&0!=b.Lcode){this.installInterface();var c=this.keyboardInterface.processKeystroke(a,b)}if(!c||c.triggerKeyDefault){b.Lcode=b.vkCode||b.Lcode;this.keyboardInterface.activeTargetOutput=a;if(b=this.defaultRuleBehavior(b,a,!1))c?c.mergeInDefaults(b):c=b,c.triggerKeyDefault=!1;this.keyboardInterface.activeTargetOutput=null}return c};e.setMnemonicCode=function(b,a,c){if(b.Lcode!=h.Codes.keyCodes.K_SPACE){var d=new h.KeyEvent,f;for(f in b)d[f]=b[f];d.kName="K_xxxx";
d.Lmodifiers=a?16:0;a=h.DefaultOutput.forAny(d,!0);b.vkCode=b.Lcode;a?b.Lcode=a.charCodeAt(0):e.isModifier(b)||delete b.Lcode}c&&(65<=b.Lcode&&90>=b.Lcode||97<=b.Lcode&&122>=b.Lcode)&&(b.Lmodifiers^=16,b.Lcode^=32)};e.getModifierState=function(b){var a=0;0<=b.indexOf("shift")&&(a|=h.Codes.modifierCodes.SHIFT);var c=!1;0<=b.indexOf("leftctrl")&&(a|=h.Codes.modifierCodes.LCTRL,c=!0);0<=b.indexOf("rightctrl")&&(a|=h.Codes.modifierCodes.RCTRL,c=!0);0<=b.indexOf("ctrl")&&!c&&(a|=h.Codes.modifierCodes.CTRL);
c=!1;0<=b.indexOf("leftalt")&&(a|=h.Codes.modifierCodes.LALT,c=!0);0<=b.indexOf("rightalt")&&(a|=h.Codes.modifierCodes.RALT,c=!0);0<=b.indexOf("alt")&&!c&&(a|=h.Codes.modifierCodes.ALT);return a};e.getStateFromLayer=function(b){var a=0;return a=0<=b.indexOf("caps")?a|h.Codes.modifierCodes.CAPS:a|h.Codes.modifierCodes.NO_CAPS};e.prototype.getVKDictionaryCode=function(b){var a=this.activeKeyboard;if(!a.scriptObject.VKDictionary){var c=[];if("string"==typeof a.scriptObject.KVKD)for(var d=a.scriptObject.KVKD.split(" "),
f=0;f<d.length;f++)c[d[f].toUpperCase()]=f+256;a.scriptObject.VKDictionary=c}return(b=a.scriptObject.VKDictionary[b.toUpperCase()])?b:0};e.prototype._UpdateVKShift=function(b){var a=0,c=["CAPS","NUM_LOCK","SCROLL_LOCK"],d=["K_CAPS","K_NUMLOCK","K_SCROLL"];if(!this.activeKeyboard)return!0;if(b){a=b.Lmodifiers;this.activeKeyboard.isChiral&&this.activeKeyboard.emulatesAltGr&&(this.modStateFlags&h.Codes.modifierBitmasks.ALT_GR_SIM)==h.Codes.modifierBitmasks.ALT_GR_SIM&&(a|=h.Codes.modifierBitmasks.ALT_GR_SIM,
a&=~h.Codes.modifierCodes.RALT);for(var f=0;f<c.length;f++)b.Lstates&h.Codes.stateBitmasks[c[f]]&&(this.stateKeys[d[f]]=!!(b.Lstates&h.Codes.modifierCodes[c[f]]))}this.updateStates();this.activeKeyboard.isMnemonic&&this.stateKeys.K_CAPS&&(b&&e.isModifier(b)||(a^=h.Codes.modifierCodes.SHIFT));this.layerId=this.getLayerId(a);return!0};e.prototype.updateStates=function(){for(var b=["CAPS","NUM_LOCK","SCROLL_LOCK"],a=["K_CAPS","K_NUMLOCK","K_SCROLL"],c=0;c<a.length;c++){var d=b[c],f="NO_"+b[c];this.stateKeys[a[c]]?
(this.modStateFlags|=h.Codes.modifierCodes[d],this.modStateFlags&=~h.Codes.modifierCodes[f]):(this.modStateFlags&=~h.Codes.modifierCodes[d],this.modStateFlags|=h.Codes.modifierCodes[f])}};e.prototype.getLayerId=function(b){return g.keyboards.Layouts.getLayerId(b)};e.prototype.selectLayer=function(b){var a=b.kName,c=b.kNextLayer,d=this.activeKeyboard&&this.activeKeyboard.isChiral;"number"==typeof c&&(c=this.getLayerId(16*c));if(!c)switch(a){case "K_LSHIFT":case "K_RSHIFT":case "K_SHIFT":c="shift";
break;case "K_LCONTROL":case "K_LCTRL":if(d){c="leftctrl";break}case "K_RCONTROL":case "K_RCTRL":if(d){c="rightctrl";break}case "K_CTRL":c="ctrl";break;case "K_LMENU":case "K_LALT":if(d){c="leftalt";break}case "K_RMENU":case "K_RALT":if(d){c="rightalt";break}case "K_ALT":c="alt";break;case "K_ALTGR":c=d?"leftctrl-rightalt":"ctrl-alt";break;case "K_CURRENCIES":case "K_NUMERALS":case "K_SHIFTED":case "K_UPPER":case "K_LOWER":case "K_SYMBOLS":c="default"}if(!c)return!1;this.updateLayer(b,c);return!0};
e.prototype.updateLayer=function(b,a){var c=this.layerId,d=c;if(a==c&&b.device.formFactor!=g.utils.FormFactor.Desktop)return!1;var f=a,l;if(b.device.formFactor==g.utils.FormFactor.Desktop){var q="leftctrl rightctrl ctrl leftalt rightalt alt shift".split(" ");for(l=0;l<q.length;l++)f=f.replace(q[l]+"-",""),f=f.replace(q[l],"");if("default"==c||"numeric"==c||"symbol"==c||"currency"==c||""!=f)d=a;else{c=e.getModifierState(d);for(l=0;l<q.length;l++)d=d.replace(q[l]+"-",""),d=d.replace(q[l],"");switch(a){case "shift":c^=
h.Codes.modifierCodes.SHIFT;break;case "leftctrl":c^=h.Codes.modifierCodes.LCTRL;break;case "rightctrl":c^=h.Codes.modifierCodes.RCTRL;break;case "ctrl":c^=h.Codes.modifierCodes.CTRL;break;case "leftalt":c^=h.Codes.modifierCodes.LALT;break;case "rightalt":c^=h.Codes.modifierCodes.RALT;break;case "alt":c^=h.Codes.modifierCodes.ALT;break;default:d=a}"default"!=d&&(d=""==d?this.getLayerId(c):this.getLayerId(c)+"-"+d)}""==d&&(d="default")}else d=a;this.activeKeyboard.layout(b.device.formFactor).getLayer(d)?
this.layerId=d:this.layerId="default";this.modStateFlags=h.KeyboardProcessor.getModifierState(this.layerId)|b.Lstates};e.isModifier=function(b){switch(b.Lcode){case 16:case 17:case 18:case 20:case 144:case 145:return!0;default:return!1}};e.prototype.doModifierPress=function(b,a,c){if(!this.activeKeyboard)return!1;if(8==b.Lcode)a.deadkeys().clear();else if(e.isModifier(b))return this.activeKeyboard.notify(b.Lcode,a,c?1:0),this.contextDevice.touchable?!0:this._UpdateVKShift(b);b.LmodifierChange&&(this.activeKeyboard.notify(0,
a,1),this.contextDevice.touchable||this._UpdateVKShift(b));return!1};e.prototype.resetContext=function(){this.layerId="default";this.keyboardInterface.resetContextCache();this.contextDevice.touchable||this._UpdateVKShift(null)};e.prototype.setNumericLayer=function(b){this.activeKeyboard&&this.activeKeyboard.layout(b.formFactor).getLayer("numeric")&&(this.layerId="numeric")};e.DEFAULT_OPTIONS={baseLayout:"us"};return e}();h.KeyboardProcessor=k})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||
(com={}));(function(){var g=com.keyman.text;"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=g.KeyboardProcessor,g.KeyboardProcessor.com=com)})();
(function(g){(function(g){(function(g){var h=function(){function e(b,a,c){this.left=b.getTextBeforeCaret();this.startOfBuffer=this.left._kmwLength()<=a.leftContextCodePoints;this.startOfBuffer||(this.left=this.left._kmwSubstr(-a.leftContextCodePoints));this.right=b.getTextAfterCaret();this.endOfBuffer=this.right._kmwLength()<=a.rightContextCodePoints;this.endOfBuffer||(this.right=this.right._kmwSubstr(0,a.rightContextCodePoints));this.casingForm="shift"==c?"initial":"caps"==c?"upper":null}e.prototype.toMock=
function(){var b=this.left._kmwLength();return new g.Mock(this.left+(this.right||""),b)};e.ENGINE_RULE_WINDOW={leftContextCodePoints:64,rightContextCodePoints:32};return e}();g.ContextWindow=h})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
function LMLayerWorkerCode(){String.prototype.codePointAt||function(){var a=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(A){}return c}(),b=function(a){if(null==this)throw TypeError();var b=String(this),c=b.length,d=a?Number(a):0;d!=d&&(d=0);if(!(0>d||d>=c))return a=b.charCodeAt(d),55296<=a&&56319>=a&&c>d+1&&(b=b.charCodeAt(d+1),56320<=b&&57343>=b)?1024*(a-55296)+b-56320+65536:a};a?a(String.prototype,"codePointAt",{value:b,configurable:!0,writable:!0}):String.prototype.codePointAt=
b}();String.prototype.startsWith||function(){var a=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(p){}return c}(),b={}.toString,c=function(a){if(null==this)throw TypeError();var c=String(this);if(a&&"[object RegExp]"==b.call(a))throw TypeError();var d=c.length,f=String(a),l=f.length,e=1<arguments.length?arguments[1]:void 0;e=e?Number(e):0;e!=e&&(e=0);e=Math.min(Math.max(e,0),d);if(l+e>d)return!1;for(d=-1;++d<l;)if(c.charCodeAt(e+d)!=f.charCodeAt(d))return!1;return!0};a?a(String.prototype,
"startsWith",{value:c,configurable:!0,writable:!0}):String.prototype.startsWith=c}();Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(a,b,c){if(null==this)throw new TypeError("this is null or not defined");var d=Object(this),f=d.length>>>0;b>>=0;b=0>b?Math.max(f+b,0):Math.min(b,f);c=void 0===c?f:c>>0;for(f=0>c?Math.max(f+c,0):Math.min(c,f);b<f;)d[b]=a,b++;return d}});Array.from||(Array.from=function(){var a=Object.prototype.toString,b=function(b){return"function"===
typeof b||"[object Function]"===a.call(b)},c=Math.pow(2,53)-1;return function(a){var d=Object(a);if(null==a)throw new TypeError("Array.from requires an array-like object - not null or undefined");var f=1<arguments.length?arguments[1]:void 0,l;if("undefined"!==typeof f){if(!b(f))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(l=arguments[2])}var e=Number(d.length);e=isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e;e=Math.min(Math.max(e,
0),c);for(var g=b(this)?Object(new this(e)):Array(e),h=0,q;h<e;)q=d[h],g[h]=f?"undefined"===typeof l?f(q,h):f.call(l,q,h):q,h+=1;g.length=e;return g}}());Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=c.length;return function(f){if("function"!==typeof f&&("object"!==typeof f||null===f))throw new TypeError("Object.keys called on non-object");
var l=[],e;for(e in f)a.call(f,e)&&l.push(e);if(b)for(e=0;e<d;e++)a.call(f,c[e])&&l.push(c[e]);return l}}());var g=Function.bind.call(Function.call,Array.prototype.reduce),k=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),h=Function.bind.call(Function.call,Array.prototype.concat),n=Object.keys;Object.values||(Object.values=function(a){return g(n(a),function(b,c){return h(b,"string"===typeof c&&k(a,c)?[a[c]]:[])},[])});Object.entries||(Object.entries=function(a){return g(n(a),
function(b,c){return h(b,"string"===typeof c&&k(a,c)?[[c,a[c]]]:[])},[])});!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}("undefined"!=typeof window?window:self?self:global,function(a){var b=Object.defineProperty,c=Object.defineProperties,d=0,f=[],l=Array.prototype.slice,e="object"==typeof a.ES6?a.ES6:a.ES6={},g=Array.isArray,h=Object.prototype.toString,q=Array.prototype.push,k=function(){},w=function(a){return a},t=function(){},n=function(a,b){this._array=
a;this._flag=b;this._nextIndex=0},D=function(a,b){this._string=a;this._flag=b;this._nextIndex=0},u=function(a){return null!==a&&("object"==typeof a||"function"==typeof a)},V=function(a,b){if("number"==typeof a.length&&0<=a.length&&"number"==typeof b.length&&0<=b.length){var c=Math.floor(a.length),d=Math.floor(b.length),f=0;for(a.length=c+d;f<d;++f)b.hasOwnProperty(f)&&(a[c+f]=b[f])}},O=function(a,b){if("function"!=typeof a||"function"!=typeof b)throw new TypeError("Child and Parent must be function type");
a.prototype=Object.create(b.prototype);a.prototype.constructor=a},E=function ha(a){if(a=void 0===a?"":String(a),this instanceof ha)throw new TypeError("Symbol is not a constructor");var b=Object.create(ha.prototype);return c(b,{_description:{value:a},_isSymbol:{value:!0},_id:{value:d++}}),b};c(E,{for:{value:function(a){a=String(a);for(var b,c=f.length,d=0;d<c;++d)if((b=f[d]).key===a)return b.symbol;return b={key:a,symbol:E(a)},f.push(b),b.symbol},writable:!0,configurable:!0},keyFor:{value:function(a){if(!e.isSymbol(a))throw new TypeError(String(a)+
" is not a symbol");for(var b,c=f.length,d=0;d<c;++d)if((b=f[d]).symbol===a)return b.key},writable:!0,configurable:!0},hasInstance:{value:E("Symbol.hasInstance")},isConcatSpreadable:{value:E("Symbol.isConcatSpreadable")},iterator:{value:E("Symbol.iterator")},toStringTag:{value:E("Symbol.toStringTag")}});E.prototype.toString=function(){return"@@_____"+this._id+"_____"};E.prototype.valueOf=function(){return this};b(t.prototype,E.iterator.toString(),{value:function(){return this},writable:!0,configurable:!0});
O(n,t);O(D,t);b(n.prototype,E.toStringTag.toString(),{value:"Array Iterator",configurable:!0});b(D.prototype,E.toStringTag.toString(),{value:"String Iterator",configurable:!0});n.prototype.next=function(){if(!(this instanceof n))throw new TypeError("Method Array Iterator.prototype.next called on incompatible receiver "+String(this));var a;return-1===this._nextIndex?{done:!0,value:void 0}:"number"==typeof this._array.length&&0<=this._array.length&&this._nextIndex<Math.floor(this._array.length)?(1===
this._flag?a=[this._nextIndex,this._array[this._nextIndex]]:2===this._flag?a=this._array[this._nextIndex]:3===this._flag&&(a=this._nextIndex),this._nextIndex++,{done:!1,value:a}):(this._nextIndex=-1,{done:!0,value:void 0})};D.prototype.next=function(){if(!(this instanceof D))throw new TypeError("Method String Iterator.prototype.next called on incompatible receiver "+String(this));var a,b=new String(this._string);return-1===this._nextIndex?{done:!0,value:void 0}:this._nextIndex<b.length?(a=b[this._nextIndex],
this._nextIndex++,{done:!1,value:a}):(this._nextIndex=-1,{done:!0,value:void 0})};var K=function(a,b){this._target=a;this._values=[];this._thisArg=b};K.prototype.spread=function(){var a=this;return l.call(arguments).forEach(function(b){e.forOf(b,function(b){a._values.push(b)})}),a};K.prototype.add=function(){var a=this;return l.call(arguments).forEach(function(b){a._values.push(b)}),a};K.prototype.call=function(a){if("function"!=typeof this._target)throw new TypeError("Target is not a function");
return a=0>=arguments.length?this._thisArg:a,this._target.apply(a,this._values)};K.prototype.new=function(){if("function"!=typeof this._target)throw new TypeError("Target is not a constructor");var a,b;return a=Object.create(this._target.prototype),b=this._target.apply(a,this._values),u(b)?b:a};K.prototype.array=function(){if(!g(this._target))throw new TypeError("Target is not a array");return q.apply(this._target,this._values),this._target};return c(e,{isSymbol:{value:function(a){return a instanceof
E&&!0===a._isSymbol&&"number"==typeof a._id&&"string"==typeof a._description},writable:!0,configurable:!0},instanceOf:{value:function(a,b){if(!u(b))throw new TypeError("Right-hand side of 'instanceof' is not an object");var c=b[E.hasInstance];if(void 0===c)return a instanceof b;if("function"!=typeof c)throw new TypeError(typeof c+" is not a function");return c.call(b,a)},writable:!0,configurable:!0},forOf:{value:function(a,b,c){if(b="function"!=typeof b?k:b,"function"!=typeof a[E.iterator])throw new TypeError("Iterable[Symbol.iterator] is not a function");
var d;a=a[E.iterator]();if("function"!=typeof a.next)throw new TypeError(".iterator.next is not a function");for(;;){if(d=a.next(),!u(d))throw new TypeError("Iterator result "+d+" is not an object");if(d.done)break;b.call(c,d.value)}},writable:!0,configurable:!0},spreadOperator:{value:function(a,b){if("function"!=typeof a&&!g(a))throw new TypeError("Spread operator only supports on array and function objects at this moment");return new K(a,b)},writable:!0,configurable:!0}}),b(a,"Symbol",{value:E,
writable:!0,configurable:!0}),b(Function.prototype,E.hasInstance.toString(),{value:function(a){return"function"==typeof this&&a instanceof this}}),b(Array.prototype,"concat",{value:function(){if(void 0===this||null===this)throw new TypeError("Array.prototype.concat called on null or undefined");var a=Object(this),b=l.call(arguments),c=[];return b.unshift(a),b.forEach(function(a){u(a)?void 0!==a[E.isConcatSpreadable]?a[E.isConcatSpreadable]?V(c,a):c.push(a):g(a)?V(c,a):c.push(a):c.push(a)}),c},writable:!0,
configurable:!0}),b(Object.prototype,"toString",{value:function(){return void 0===this||null===this?h.call(this):"string"==typeof this[E.toStringTag]?"[object "+this[E.toStringTag]+"]":h.call(this)},writable:!0,configurable:!0}),b(Array.prototype,E.iterator.toString(),{value:function(){if(void 0===this||null===this)throw new TypeError("Cannot convert undefined or null to object");return new n(Object(this),2)},writable:!0,configurable:!0}),b(Array,"from",{value:function(a,b,c){var d,f,l=0;if(d="function"==
typeof this?this:Array,void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");if(a=Object(a),void 0===b)b=w;else if("function"!=typeof b)throw new TypeError(b+" is not a function");if(void 0===a[E.iterator]){if(!("number"==typeof a.length&&0<=a.length))return(f=new d(0)).length=0,f;var g=Math.floor(a.length);for((f=new d(g)).length=g;l<g;++l)f[l]=b.call(c,a[l])}else(f=new d).length=0,e.forOf(a,function(a){f.length++;f[f.length-1]=b.call(c,a)});return f},writable:!0,
configurable:!0}),b(Array.prototype,"entries",{value:function(){if(void 0===this||null===this)throw new TypeError("Cannot convert undefined or null to object");return new n(Object(this),1)},writable:!0,configurable:!0}),b(Array.prototype,"keys",{value:function(){if(void 0===this||null===this)throw new TypeError("Cannot convert undefined or null to object");return new n(Object(this),3)},writable:!0,configurable:!0}),b(String.prototype,E.iterator.toString(),{value:function(){if(void 0===this||null===
this)throw new TypeError("String.prototype[Symbol.iterator] called on null or undefined");return new D(String(this),0)},writable:!0,configurable:!0}),e});String.prototype.normalize||function(){var a={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00c7":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d9":"U","\u00da":"U","\u00db":"U",
"\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00e7":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c",
"\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u011d":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k",
"\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016a":"U",
"\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U",
"\u01dc":"u","\u01de":"A","\u01df":"a","\u01e0":"A","\u01e1":"a","\u01e2":"\u00c6","\u01e3":"\u00e6","\u01e6":"G","\u01e7":"g","\u01e8":"K","\u01e9":"k","\u01ea":"O","\u01eb":"o","\u01ec":"O","\u01ed":"o","\u01ee":"\u01b7","\u01ef":"\u0292","\u01f0":"j","\u01f4":"G","\u01f5":"g","\u01f8":"N","\u01f9":"n","\u01fa":"A","\u01fb":"a","\u01fc":"\u00c6","\u01fd":"\u00e6","\u01fe":"\u00d8","\u01ff":"\u00f8","\u0200":"A","\u0201":"a","\u0202":"A","\u0203":"a","\u0204":"E","\u0205":"e","\u0206":"E","\u0207":"e",
"\u0208":"I","\u0209":"i","\u020a":"I","\u020b":"i","\u020c":"O","\u020d":"o","\u020e":"O","\u020f":"o","\u0210":"R","\u0211":"r","\u0212":"R","\u0213":"r","\u0214":"U","\u0215":"u","\u0216":"U","\u0217":"u","\u0218":"S","\u0219":"s","\u021a":"T","\u021b":"t","\u021e":"H","\u021f":"h","\u0226":"A","\u0227":"a","\u0228":"E","\u0229":"e","\u022a":"O","\u022b":"o","\u022c":"O","\u022d":"o","\u022e":"O","\u022f":"o","\u0230":"O","\u0231":"o","\u0232":"Y","\u0233":"y","\u0300":"\u0300","\u0301":"\u0301",
"\u0313":"\u0313","\u0308\u0301":"\u0308","\u02b9":"\u02b9",";":";","\u0385":"\u00a8","\u0386":"\u0391","\u00b7":"\u00b7","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u038f":"\u03a9","\u0390":"\u03b9","\u03aa":"\u0399","\u03ab":"\u03a5","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u03cb":"\u03c5","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03ce":"\u03c9","\u03d3":"\u03d2","\u03d4":"\u03d2","\u0400":"\u0415","\u0401":"\u0415",
"\u0403":"\u0413","\u0407":"\u0406","\u040c":"\u041a","\u040d":"\u0418","\u040e":"\u0423","\u0419":"\u0418","\u0439":"\u0438","\u0450":"\u0435","\u0451":"\u0435","\u0453":"\u0433","\u0457":"\u0456","\u045c":"\u043a","\u045d":"\u0438","\u045e":"\u0443","\u0476":"\u0474","\u0477":"\u0475","\u04c1":"\u0416","\u04c2":"\u0436","\u04d0":"\u0410","\u04d1":"\u0430","\u04d2":"\u0410","\u04d3":"\u0430","\u04d6":"\u0415","\u04d7":"\u0435","\u04da":"\u04d8","\u04db":"\u04d9","\u04dc":"\u0416","\u04dd":"\u0436",
"\u04de":"\u0417","\u04df":"\u0437","\u04e2":"\u0418","\u04e3":"\u0438","\u04e4":"\u0418","\u04e5":"\u0438","\u04e6":"\u041e","\u04e7":"\u043e","\u04ea":"\u04e8","\u04eb":"\u04e9","\u04ec":"\u042d","\u04ed":"\u044d","\u04ee":"\u0423","\u04ef":"\u0443","\u04f0":"\u0423","\u04f1":"\u0443","\u04f2":"\u0423","\u04f3":"\u0443","\u04f4":"\u0427","\u04f5":"\u0447","\u04f8":"\u042b","\u04f9":"\u044b","\u1e00":"A","\u1e01":"a","\u1e02":"B","\u1e03":"b","\u1e04":"B","\u1e05":"b","\u1e06":"B","\u1e07":"b","\u1e08":"C",
"\u1e09":"c","\u1e0a":"D","\u1e0b":"d","\u1e0c":"D","\u1e0d":"d","\u1e0e":"D","\u1e0f":"d","\u1e10":"D","\u1e11":"d","\u1e12":"D","\u1e13":"d","\u1e14":"E","\u1e15":"e","\u1e16":"E","\u1e17":"e","\u1e18":"E","\u1e19":"e","\u1e1a":"E","\u1e1b":"e","\u1e1c":"E","\u1e1d":"e","\u1e1e":"F","\u1e1f":"f","\u1e20":"G","\u1e21":"g","\u1e22":"H","\u1e23":"h","\u1e24":"H","\u1e25":"h","\u1e26":"H","\u1e27":"h","\u1e28":"H","\u1e29":"h","\u1e2a":"H","\u1e2b":"h","\u1e2c":"I","\u1e2d":"i","\u1e2e":"I","\u1e2f":"i",
"\u1e30":"K","\u1e31":"k","\u1e32":"K","\u1e33":"k","\u1e34":"K","\u1e35":"k","\u1e36":"L","\u1e37":"l","\u1e38":"L","\u1e39":"l","\u1e3a":"L","\u1e3b":"l","\u1e3c":"L","\u1e3d":"l","\u1e3e":"M","\u1e3f":"m","\u1e40":"M","\u1e41":"m","\u1e42":"M","\u1e43":"m","\u1e44":"N","\u1e45":"n","\u1e46":"N","\u1e47":"n","\u1e48":"N","\u1e49":"n","\u1e4a":"N","\u1e4b":"n","\u1e4c":"O","\u1e4d":"o","\u1e4e":"O","\u1e4f":"o","\u1e50":"O","\u1e51":"o","\u1e52":"O","\u1e53":"o","\u1e54":"P","\u1e55":"p","\u1e56":"P",
"\u1e57":"p","\u1e58":"R","\u1e59":"r","\u1e5a":"R","\u1e5b":"r","\u1e5c":"R","\u1e5d":"r","\u1e5e":"R","\u1e5f":"r","\u1e60":"S","\u1e61":"s","\u1e62":"S","\u1e63":"s","\u1e64":"S","\u1e65":"s","\u1e66":"S","\u1e67":"s","\u1e68":"S","\u1e69":"s","\u1e6a":"T","\u1e6b":"t","\u1e6c":"T","\u1e6d":"t","\u1e6e":"T","\u1e6f":"t","\u1e70":"T","\u1e71":"t","\u1e72":"U","\u1e73":"u","\u1e74":"U","\u1e75":"u","\u1e76":"U","\u1e77":"u","\u1e78":"U","\u1e79":"u","\u1e7a":"U","\u1e7b":"u","\u1e7c":"V","\u1e7d":"v",
"\u1e7e":"V","\u1e7f":"v","\u1e80":"W","\u1e81":"w","\u1e82":"W","\u1e83":"w","\u1e84":"W","\u1e85":"w","\u1e86":"W","\u1e87":"w","\u1e88":"W","\u1e89":"w","\u1e8a":"X","\u1e8b":"x","\u1e8c":"X","\u1e8d":"x","\u1e8e":"Y","\u1e8f":"y","\u1e90":"Z","\u1e91":"z","\u1e92":"Z","\u1e93":"z","\u1e94":"Z","\u1e95":"z","\u1e96":"h","\u1e97":"t","\u1e98":"w","\u1e99":"y","\u1e9b":"\u017f","\u1ea0":"A","\u1ea1":"a","\u1ea2":"A","\u1ea3":"a","\u1ea4":"A","\u1ea5":"a","\u1ea6":"A","\u1ea7":"a","\u1ea8":"A","\u1ea9":"a",
"\u1eaa":"A","\u1eab":"a","\u1eac":"A","\u1ead":"a","\u1eae":"A","\u1eaf":"a","\u1eb0":"A","\u1eb1":"a","\u1eb2":"A","\u1eb3":"a","\u1eb4":"A","\u1eb5":"a","\u1eb6":"A","\u1eb7":"a","\u1eb8":"E","\u1eb9":"e","\u1eba":"E","\u1ebb":"e","\u1ebc":"E","\u1ebd":"e","\u1ebe":"E","\u1ebf":"e","\u1ec0":"E","\u1ec1":"e","\u1ec2":"E","\u1ec3":"e","\u1ec4":"E","\u1ec5":"e","\u1ec6":"E","\u1ec7":"e","\u1ec8":"I","\u1ec9":"i","\u1eca":"I","\u1ecb":"i","\u1ecc":"O","\u1ecd":"o","\u1ece":"O","\u1ecf":"o","\u1ed0":"O",
"\u1ed1":"o","\u1ed2":"O","\u1ed3":"o","\u1ed4":"O","\u1ed5":"o","\u1ed6":"O","\u1ed7":"o","\u1ed8":"O","\u1ed9":"o","\u1eda":"O","\u1edb":"o","\u1edc":"O","\u1edd":"o","\u1ede":"O","\u1edf":"o","\u1ee0":"O","\u1ee1":"o","\u1ee2":"O","\u1ee3":"o","\u1ee4":"U","\u1ee5":"u","\u1ee6":"U","\u1ee7":"u","\u1ee8":"U","\u1ee9":"u","\u1eea":"U","\u1eeb":"u","\u1eec":"U","\u1eed":"u","\u1eee":"U","\u1eef":"u","\u1ef0":"U","\u1ef1":"u","\u1ef2":"Y","\u1ef3":"y","\u1ef4":"Y","\u1ef5":"y","\u1ef6":"Y","\u1ef7":"y",
"\u1ef8":"Y","\u1ef9":"y","\u1f00":"\u03b1","\u1f01":"\u03b1","\u1f02":"\u03b1","\u1f03":"\u03b1","\u1f04":"\u03b1","\u1f05":"\u03b1","\u1f06":"\u03b1","\u1f07":"\u03b1","\u1f08":"\u0391","\u1f09":"\u0391","\u1f0a":"\u0391","\u1f0b":"\u0391","\u1f0c":"\u0391","\u1f0d":"\u0391","\u1f0e":"\u0391","\u1f0f":"\u0391","\u1f10":"\u03b5","\u1f11":"\u03b5","\u1f12":"\u03b5","\u1f13":"\u03b5","\u1f14":"\u03b5","\u1f15":"\u03b5","\u1f18":"\u0395","\u1f19":"\u0395","\u1f1a":"\u0395","\u1f1b":"\u0395","\u1f1c":"\u0395",
"\u1f1d":"\u0395","\u1f20":"\u03b7","\u1f21":"\u03b7","\u1f22":"\u03b7","\u1f23":"\u03b7","\u1f24":"\u03b7","\u1f25":"\u03b7","\u1f26":"\u03b7","\u1f27":"\u03b7","\u1f28":"\u0397","\u1f29":"\u0397","\u1f2a":"\u0397","\u1f2b":"\u0397","\u1f2c":"\u0397","\u1f2d":"\u0397","\u1f2e":"\u0397","\u1f2f":"\u0397","\u1f30":"\u03b9","\u1f31":"\u03b9","\u1f32":"\u03b9","\u1f33":"\u03b9","\u1f34":"\u03b9","\u1f35":"\u03b9","\u1f36":"\u03b9","\u1f37":"\u03b9","\u1f38":"\u0399","\u1f39":"\u0399","\u1f3a":"\u0399",
"\u1f3b":"\u0399","\u1f3c":"\u0399","\u1f3d":"\u0399","\u1f3e":"\u0399","\u1f3f":"\u0399","\u1f40":"\u03bf","\u1f41":"\u03bf","\u1f42":"\u03bf","\u1f43":"\u03bf","\u1f44":"\u03bf","\u1f45":"\u03bf","\u1f48":"\u039f","\u1f49":"\u039f","\u1f4a":"\u039f","\u1f4b":"\u039f","\u1f4c":"\u039f","\u1f4d":"\u039f","\u1f50":"\u03c5","\u1f51":"\u03c5","\u1f52":"\u03c5","\u1f53":"\u03c5","\u1f54":"\u03c5","\u1f55":"\u03c5","\u1f56":"\u03c5","\u1f57":"\u03c5","\u1f59":"\u03a5","\u1f5b":"\u03a5","\u1f5d":"\u03a5",
"\u1f5f":"\u03a5","\u1f60":"\u03c9","\u1f61":"\u03c9","\u1f62":"\u03c9","\u1f63":"\u03c9","\u1f64":"\u03c9","\u1f65":"\u03c9","\u1f66":"\u03c9","\u1f67":"\u03c9","\u1f68":"\u03a9","\u1f69":"\u03a9","\u1f6a":"\u03a9","\u1f6b":"\u03a9","\u1f6c":"\u03a9","\u1f6d":"\u03a9","\u1f6e":"\u03a9","\u1f6f":"\u03a9","\u1f70":"\u03b1","\u1f72":"\u03b5","\u1f74":"\u03b7","\u1f76":"\u03b9","\u1f78":"\u03bf","\u1f7a":"\u03c5","\u1f7c":"\u03c9","\u1f80":"\u03b1","\u1f81":"\u03b1","\u1f82":"\u03b1","\u1f83":"\u03b1",
"\u1f84":"\u03b1","\u1f85":"\u03b1","\u1f86":"\u03b1","\u1f87":"\u03b1","\u1f88":"\u0391","\u1f89":"\u0391","\u1f8a":"\u0391","\u1f8b":"\u0391","\u1f8c":"\u0391","\u1f8d":"\u0391","\u1f8e":"\u0391","\u1f8f":"\u0391","\u1f90":"\u03b7","\u1f91":"\u03b7","\u1f92":"\u03b7","\u1f93":"\u03b7","\u1f94":"\u03b7","\u1f95":"\u03b7","\u1f96":"\u03b7","\u1f97":"\u03b7","\u1f98":"\u0397","\u1f99":"\u0397","\u1f9a":"\u0397","\u1f9b":"\u0397","\u1f9c":"\u0397","\u1f9d":"\u0397","\u1f9e":"\u0397","\u1f9f":"\u0397",
"\u1fa0":"\u03c9","\u1fa1":"\u03c9","\u1fa2":"\u03c9","\u1fa3":"\u03c9","\u1fa4":"\u03c9","\u1fa5":"\u03c9","\u1fa6":"\u03c9","\u1fa7":"\u03c9","\u1fa8":"\u03a9","\u1fa9":"\u03a9","\u1faa":"\u03a9","\u1fab":"\u03a9","\u1fac":"\u03a9","\u1fad":"\u03a9","\u1fae":"\u03a9","\u1faf":"\u03a9","\u1fb0":"\u03b1","\u1fb1":"\u03b1","\u1fb2":"\u03b1","\u1fb3":"\u03b1","\u1fb4":"\u03b1","\u1fb6":"\u03b1","\u1fb7":"\u03b1","\u1fb8":"\u0391","\u1fb9":"\u0391","\u1fba":"\u0391","\u1fbc":"\u0391","\u03b9":"\u03b9",
"\u1fc1":"\u00a8","\u1fc2":"\u03b7","\u1fc3":"\u03b7","\u1fc4":"\u03b7","\u1fc6":"\u03b7","\u1fc7":"\u03b7","\u1fc8":"\u0395","\u1fca":"\u0397","\u1fcc":"\u0397","\u1fcd":"\u1fbf","\u1fce":"\u1fbf","\u1fcf":"\u1fbf","\u1fd0":"\u03b9","\u1fd1":"\u03b9","\u1fd2":"\u03b9","\u1fd6":"\u03b9","\u1fd7":"\u03b9","\u1fd8":"\u0399","\u1fd9":"\u0399","\u1fda":"\u0399","\u1fdd":"\u1ffe","\u1fde":"\u1ffe","\u1fdf":"\u1ffe","\u1fe0":"\u03c5","\u1fe1":"\u03c5","\u1fe2":"\u03c5","\u03b0":"\u03c5","\u1fe4":"\u03c1",
"\u1fe5":"\u03c1","\u1fe6":"\u03c5","\u1fe7":"\u03c5","\u1fe8":"\u03a5","\u1fe9":"\u03a5","\u1fea":"\u03a5","\u1fec":"\u03a1","\u1fed":"\u00a8","`":"`","\u1ff2":"\u03c9","\u1ff3":"\u03c9","\u1ff4":"\u03c9","\u1ff6":"\u03c9","\u1ff7":"\u03c9","\u1ff8":"\u039f","\u1ffa":"\u03a9","\u1ffc":"\u03a9","\u00b4":"\u00b4","\u2002":"\u2002","\u2003":"\u2003","\u03a9":"\u03a9",K:"K"};String.prototype.normalize=function(){return this.split("").map(function(b){return b in a?a[b]:b}).join("")}}();var e;(function(a){a=
a.keyman||(a.keyman={});a=a.environment||(a.environment={});a.VERSION="15.0";a.BUILD=272;a.ENVIRONMENT="stable";a.SENTRY_RELEASE="release-15.0.272"})(e||(e={}));(function(a){(function(a){(function(a){function b(a,c){c=c||{};for(var d in a)"object"===typeof a[d]&&null!=a[d]?(c[d]=a[d].constructor===Array?[]:{},b(a[d],c[d])):c[d]=a[d];return c}a.deepCopy=b})(a.utils||(a.utils={}))})(a.keyman||(a.keyman={}))})(e||(e={}));(function(a){(function(a){(function(a){a.getGlobalObject=function(){return"undefined"!=
typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:global}})(a.utils||(a.utils={}))})(a.keyman||(a.keyman={}))})(e||(e={}));(function(a){(function(b){(function(b){var c=function(){function b(a){if(void 0===a||null===a)this.components=[].concat(b.DEVELOPER_VERSION_FALLBACK.components);else if(Array.isArray(a)){if(2>a.length)throw Error("Version string must have at least a major and minor component!");this.components=[].concat(a)}else{a=a.split(".");var c=[];
if(2>a.length)throw Error("Version string must have at least a major and minor component!");for(var d=0;d<a.length;d++){var f=parseInt(a[d],10);if(isNaN(f))throw Error("Version string components must be numerical!");c.push(f)}this.components=c}}Object.defineProperty(b.prototype,"major",{get:function(){return this.components[0]},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"minor",{get:function(){return this.components[1]},enumerable:!0,configurable:!0});b.prototype.toString=function(){return this.components.join(".")};
b.prototype.toJSON=function(){return this.toString()};b.prototype.equals=function(a){return 0==this.compareTo(a)};b.prototype.precedes=function(a){return 0>this.compareTo(a)};b.prototype.compareTo=function(a){var b=this.components.length<a.components.length,c=this.components.length<a.components.length?this.components.length:a.components.length,d;for(d=0;d<c;d++){var f=this.components[d]-a.components[d];if(0!=f)return f}a=b?a.components:this.components;do{if(0<a[d])return b?-1:1;d++}while(d<a.length);
return 0};b.CURRENT=new b(a.keyman.environment.VERSION);b.DEVELOPER_VERSION_FALLBACK=new b([9,0,0]);b.NO_DEFAULT_KEYCAPS=new b([12,0]);b.MAC_POSSIBLE_IPAD_ALIAS=new b([10,15]);return b}();b.Version=c})(b.utils||(b.utils={}))})(a.keyman||(a.keyman={}))})(e||(e={}));String.kmwFromCharCode=function(a){var b=[],c;for(c=0;c<arguments.length;c++){var d=Number(arguments[c]);if(!isFinite(d)||0>d||1114111<d||Math.floor(d)!==d)throw new RangeError("Invalid code point "+d);65536>d?b.push(d):(d-=65536,b.push((d>>
10)+55296),b.push(d%1024+56320))}return String.fromCharCode.apply(void 0,b)};String.prototype.kmwCharCodeAt=function(a){var b=String(this),c=0;if(0>a||a>=b.length)return NaN;for(var d=0;d<a;d++)if(c=b.kmwNextChar(c),null===c)return NaN;a=b.charCodeAt(c);return 55296<=a&&56319>=a&&b.length>c+1&&(b=b.charCodeAt(c+1),56320<=b&&57343>=b)?(a-55296<<10)+(b-56320)+65536:a};String.prototype.kmwIndexOf=function(a,b){var c=String(this);a=c.indexOf(a,b);if(0>a)return a;for(var d=b=0;null!==d&&d<a;d=c.kmwNextChar(d))b++;
return b};String.prototype.kmwLastIndexOf=function(a,b){var c=String(this);a=c.lastIndexOf(a,b);if(0>a)return a;for(var d=b=0;null!==d&&d<a;d=c.kmwNextChar(d))b++;return b};String.prototype.kmwLength=function(){var a=String(this);if(0==a.length)return 0;for(var b=0,c=0;null!==c;b++)c=a.kmwNextChar(c);return b};String.prototype.kmwSlice=function(a,b){var c=String(this);a=c.kmwCodePointToCodeUnit(a);b=c.kmwCodePointToCodeUnit(b);return null===a||null===b?"":c.slice(a,b)};String.prototype.kmwSubstr=
function(a,b){var c=String(this);0>a&&(a=c.kmwLength()+a);0>a&&(a=0);var d=c.kmwCodePointToCodeUnit(a),f=d;if(null===d)return"";if(2>arguments.length)f=c.length;else for(var l=0;l<b;l++)f=c.kmwNextChar(f);return null===f?c.substring(d):c.substring(d,f)};String.prototype.kmwSubstring=function(a,b){var c=String(this);if("undefined"==typeof b)a=c.kmwCodePointToCodeUnit(a),b=c.length;else{if(a>b){var d=a;a=b;b=d}a=c.kmwCodePointToCodeUnit(a);b=c.kmwCodePointToCodeUnit(b)}if(isNaN(a)||null===a)a=0;if(isNaN(b)||
null===b)b=c.length;return c.substring(a,b)};String.prototype.kmwNextChar=function(a){var b=String(this);if(null===a||0>a||a>=b.length-1)return null;var c=b.charCodeAt(a);return 55296<=c&&56319>=c&&b.length>a+1&&(c=b.charCodeAt(a+1),56320<=c&&57343>=c)?a==b.length-2?null:a+2:a+1};String.prototype.kmwPrevChar=function(a){var b=String(this);if(null==a||0>=a||a>b.length)return null;var c=b.charCodeAt(a-1);return 56320<=c&&57343>=c&&1<a&&(b=b.charCodeAt(a-2),55296<=b&&56319>=b)?a-2:a-1};String.prototype.kmwCodePointToCodeUnit=
function(a){if(null===a)return null;var b=String(this),c=0;if(0>a){c=b.length;for(var d=0;d>a;d--)c=b.kmwPrevChar(c);return c}if(a==b.kmwLength())return b.length;for(d=0;d<a;d++)c=b.kmwNextChar(c);return c};String.prototype.kmwCodeUnitToCodePoint=function(a){var b=String(this);return null===a?null:0==a?0:0>a?b.substr(a).kmwLength():b.substr(0,a).kmwLength()};String.prototype.kmwCharAt=function(a){var b=String(this);return 0<=a?b.kmwSubstr(a,1):""};String.prototype.kmwBMPNextChar=function(a){var b=
String(this);return 0>a||a>=b.length-1?null:a+1};String.prototype.kmwBMPPrevChar=function(a){var b=String(this);return 0>=a||a>b.length?null:a-1};String.prototype.kmwBMPCodePointToCodeUnit=function(a){return a};String.prototype.kmwBMPCodeUnitToCodePoint=function(a){return a};String.prototype.kmwBMPLength=function(){return String(this).length};String.prototype.kmwBMPSubstr=function(a,b){var c=String(this);return-1<a?c.substr(a,b):c.substr(c.length+a,-a)};String.kmwEnableSupplementaryPlane=function(a){var b=
String.prototype;String._kmwFromCharCode=a?String.kmwFromCharCode:String.fromCharCode;b._kmwCharAt=a?b.kmwCharAt:b.charAt;b._kmwCharCodeAt=a?b.kmwCharCodeAt:b.charCodeAt;b._kmwIndexOf=a?b.kmwIndexOf:b.indexOf;b._kmwLastIndexOf=a?b.kmwLastIndexOf:b.lastIndexOf;b._kmwSlice=a?b.kmwSlice:b.slice;b._kmwSubstring=a?b.kmwSubstring:b.substring;b._kmwSubstr=a?b.kmwSubstr:b.kmwBMPSubstr;b._kmwLength=a?b.kmwLength:b.kmwBMPLength;b._kmwNextChar=a?b.kmwNextChar:b.kmwBMPNextChar;b._kmwPrevChar=a?b.kmwPrevChar:
b.kmwBMPPrevChar;b._kmwCodePointToCodeUnit=a?b.kmwCodePointToCodeUnit:b.kmwBMPCodePointToCodeUnit;b._kmwCodeUnitToCodePoint=a?b.kmwCodeUnitToCodePoint:b.kmwBMPCodeUnitToCodePoint};(function(a){(function(a){(function(a){var b;(function(a){a.Chrome="chrome";a.Edge="edge";a.Firefox="firefox";a.Native="native";a.Opera="opera";a.Safari="safari";a.Other="other"})(b=a.Browser||(a.Browser={}));var c;(function(a){a.Windows="windows";a.macOS="macosx";a.Linux="linux";a.Android="android";a.iOS="ios";a.Other=
"other"})(c=a.OperatingSystem||(a.OperatingSystem={}));var d;(function(a){a.Desktop="desktop";a.Phone="phone";a.Tablet="tablet"})(d=a.FormFactor||(a.FormFactor={}));var f=function(){return function(a,f,l,e){switch(a.toLowerCase()){case b.Chrome:case b.Edge:case b.Firefox:case b.Native:case b.Opera:case b.Safari:this.browser=a.toLowerCase();break;default:this.browser=b.Other}switch(f.toLowerCase()){case d.Desktop:case d.Phone:case d.Tablet:this.formFactor=f.toLowerCase();break;default:throw"Invalid form factor specified for device: "+
f;}switch(l.toLowerCase()){case c.Windows.toLowerCase():case c.macOS.toLowerCase():case c.Linux.toLowerCase():case c.Android.toLowerCase():case c.iOS.toLowerCase():this.OS=l.toLowerCase();break;default:this.OS=c.Other}this.touchable=e}}();a.DeviceSpec=f})(a.utils||(a.utils={}))})(a.keyman||(a.keyman={}))})(e||(e={}));var b=this&&this.__values||function(a){var b="function"===typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"===typeof a.length)return{next:function(){a&&
d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.");},a;(function(a){var c=function(){function a(a){a=a||{};this._futureSuggestions=a.futureSuggestions?a.futureSuggestions.slice():[];a.punctuation&&(this.punctuation=a.punctuation)}a.prototype.configure=function(a){return this.configuration={leftContextCodePoints:a.maxLeftContextCodePoints,rightContextCodePoints:a.maxRightContextCodePoints}};a.prototype.predict=
function(a,c,d){a=function(a){var c,d=[];try{for(var f=b(a),l=f.next();!l.done;l=f.next())d.push({sample:l.value,p:1})}catch(S){var e={error:S}}finally{try{l&&!l.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error;}}return d};return d?a(d):(d=this._futureSuggestions.shift())?a(d):[]};return a}();a.DummyModel=c})(a||(a={}));var c;(function(a){a.ascii=function(a){for(var c=/[A-Za-z0-9']+/g,d=[],f;null!==(f=c.exec(a));)d.push(new b(f[0],f.index));return d};var b=function(){function a(a,b){this.text=
a;this.start=b}Object.defineProperty(a.prototype,"length",{get:function(){return this.text.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"end",{get:function(){return this.start+this.text.length},enumerable:!0,configurable:!0});return a}()})(c||(c={}));(function(a){(a.data||(a.data={})).WORD_BREAK_PROPERTY=[[0,0],[10,1],[11,2],[13,3],[14,0],[32,4],[33,0],[34,5],[35,0],[39,6],[40,0],[44,7],[45,0],[46,8],[47,0],[48,9],[58,10],[59,7],[60,0],[65,11],[91,0],[95,12],[96,0],[97,
11],[123,0],[133,2],[134,0],[170,11],[171,0],[173,13],[174,0],[181,11],[182,0],[183,10],[184,0],[186,11],[187,0],[192,11],[215,0],[216,11],[247,0],[248,11],[728,0],[734,11],[768,14],[880,11],[885,0],[886,11],[888,0],[890,11],[894,7],[895,11],[896,0],[902,11],[903,10],[904,11],[907,0],[908,11],[909,0],[910,11],[930,0],[931,11],[1014,0],[1015,11],[1154,0],[1155,14],[1162,11],[1328,0],[1329,11],[1367,0],[1369,11],[1373,0],[1374,11],[1375,10],[1376,11],[1417,7],[1418,11],[1419,0],[1425,14],[1470,0],[1471,
14],[1472,0],[1473,14],[1475,0],[1476,14],[1478,0],[1479,14],[1480,0],[1488,15],[1515,0],[1519,15],[1523,11],[1524,10],[1525,0],[1536,13],[1542,0],[1548,7],[1550,0],[1552,14],[1563,0],[1564,13],[1565,0],[1568,11],[1611,14],[1632,9],[1642,0],[1643,9],[1644,7],[1645,0],[1646,11],[1648,14],[1649,11],[1748,0],[1749,11],[1750,14],[1757,13],[1758,0],[1759,14],[1765,11],[1767,14],[1769,0],[1770,14],[1774,11],[1776,9],[1786,11],[1789,0],[1791,11],[1792,0],[1807,13],[1808,11],[1809,14],[1810,11],[1840,14],
[1867,0],[1869,11],[1958,14],[1969,11],[1970,0],[1984,9],[1994,11],[2027,14],[2036,11],[2038,0],[2040,7],[2041,0],[2042,11],[2043,0],[2045,14],[2046,0],[2048,11],[2070,14],[2074,11],[2075,14],[2084,11],[2085,14],[2088,11],[2089,14],[2094,0],[2112,11],[2137,14],[2140,0],[2144,11],[2155,0],[2208,11],[2229,0],[2230,11],[2248,0],[2259,14],[2274,13],[2275,14],[2308,11],[2362,14],[2365,11],[2366,14],[2384,11],[2385,14],[2392,11],[2402,14],[2404,0],[2406,9],[2416,0],[2417,11],[2433,14],[2436,0],[2437,11],
[2445,0],[2447,11],[2449,0],[2451,11],[2473,0],[2474,11],[2481,0],[2482,11],[2483,0],[2486,11],[2490,0],[2492,14],[2493,11],[2494,14],[2501,0],[2503,14],[2505,0],[2507,14],[2510,11],[2511,0],[2519,14],[2520,0],[2524,11],[2526,0],[2527,11],[2530,14],[2532,0],[2534,9],[2544,11],[2546,0],[2556,11],[2557,0],[2558,14],[2559,0],[2561,14],[2564,0],[2565,11],[2571,0],[2575,11],[2577,0],[2579,11],[2601,0],[2602,11],[2609,0],[2610,11],[2612,0],[2613,11],[2615,0],[2616,11],[2618,0],[2620,14],[2621,0],[2622,
14],[2627,0],[2631,14],[2633,0],[2635,14],[2638,0],[2641,14],[2642,0],[2649,11],[2653,0],[2654,11],[2655,0],[2662,9],[2672,14],[2674,11],[2677,14],[2678,0],[2689,14],[2692,0],[2693,11],[2702,0],[2703,11],[2706,0],[2707,11],[2729,0],[2730,11],[2737,0],[2738,11],[2740,0],[2741,11],[2746,0],[2748,14],[2749,11],[2750,14],[2758,0],[2759,14],[2762,0],[2763,14],[2766,0],[2768,11],[2769,0],[2784,11],[2786,14],[2788,0],[2790,9],[2800,0],[2809,11],[2810,14],[2816,0],[2817,14],[2820,0],[2821,11],[2829,0],[2831,
11],[2833,0],[2835,11],[2857,0],[2858,11],[2865,0],[2866,11],[2868,0],[2869,11],[2874,0],[2876,14],[2877,11],[2878,14],[2885,0],[2887,14],[2889,0],[2891,14],[2894,0],[2901,14],[2904,0],[2908,11],[2910,0],[2911,11],[2914,14],[2916,0],[2918,9],[2928,0],[2929,11],[2930,0],[2946,14],[2947,11],[2948,0],[2949,11],[2955,0],[2958,11],[2961,0],[2962,11],[2966,0],[2969,11],[2971,0],[2972,11],[2973,0],[2974,11],[2976,0],[2979,11],[2981,0],[2984,11],[2987,0],[2990,11],[3002,0],[3006,14],[3011,0],[3014,14],[3017,
0],[3018,14],[3022,0],[3024,11],[3025,0],[3031,14],[3032,0],[3046,9],[3056,0],[3072,14],[3077,11],[3085,0],[3086,11],[3089,0],[3090,11],[3113,0],[3114,11],[3130,0],[3133,11],[3134,14],[3141,0],[3142,14],[3145,0],[3146,14],[3150,0],[3157,14],[3159,0],[3160,11],[3163,0],[3168,11],[3170,14],[3172,0],[3174,9],[3184,0],[3200,11],[3201,14],[3204,0],[3205,11],[3213,0],[3214,11],[3217,0],[3218,11],[3241,0],[3242,11],[3252,0],[3253,11],[3258,0],[3260,14],[3261,11],[3262,14],[3269,0],[3270,14],[3273,0],[3274,
14],[3278,0],[3285,14],[3287,0],[3294,11],[3295,0],[3296,11],[3298,14],[3300,0],[3302,9],[3312,0],[3313,11],[3315,0],[3328,14],[3332,11],[3341,0],[3342,11],[3345,0],[3346,11],[3387,14],[3389,11],[3390,14],[3397,0],[3398,14],[3401,0],[3402,14],[3406,11],[3407,0],[3412,11],[3415,14],[3416,0],[3423,11],[3426,14],[3428,0],[3430,9],[3440,0],[3450,11],[3456,0],[3457,14],[3460,0],[3461,11],[3479,0],[3482,11],[3506,0],[3507,11],[3516,0],[3517,11],[3518,0],[3520,11],[3527,0],[3530,14],[3531,0],[3535,14],[3541,
0],[3542,14],[3543,0],[3544,14],[3552,0],[3558,9],[3568,0],[3570,14],[3572,0],[3633,14],[3634,0],[3636,14],[3643,0],[3655,14],[3663,0],[3664,9],[3674,0],[3761,14],[3762,0],[3764,14],[3773,0],[3784,14],[3790,0],[3792,9],[3802,0],[3840,11],[3841,0],[3864,14],[3866,0],[3872,9],[3882,0],[3893,14],[3894,0],[3895,14],[3896,0],[3897,14],[3898,0],[3902,14],[3904,11],[3912,0],[3913,11],[3949,0],[3953,14],[3973,0],[3974,14],[3976,11],[3981,14],[3992,0],[3993,14],[4029,0],[4038,14],[4039,0],[4139,14],[4159,
0],[4160,9],[4170,0],[4182,14],[4186,0],[4190,14],[4193,0],[4194,14],[4197,0],[4199,14],[4206,0],[4209,14],[4213,0],[4226,14],[4238,0],[4239,14],[4240,9],[4250,14],[4254,0],[4256,11],[4294,0],[4295,11],[4296,0],[4301,11],[4302,0],[4304,11],[4347,0],[4348,11],[4681,0],[4682,11],[4686,0],[4688,11],[4695,0],[4696,11],[4697,0],[4698,11],[4702,0],[4704,11],[4745,0],[4746,11],[4750,0],[4752,11],[4785,0],[4786,11],[4790,0],[4792,11],[4799,0],[4800,11],[4801,0],[4802,11],[4806,0],[4808,11],[4823,0],[4824,
11],[4881,0],[4882,11],[4886,0],[4888,11],[4955,0],[4957,14],[4960,0],[4992,11],[5008,0],[5024,11],[5110,0],[5112,11],[5118,0],[5121,11],[5741,0],[5743,11],[5760,4],[5761,11],[5787,0],[5792,11],[5867,0],[5870,11],[5881,0],[5888,11],[5901,0],[5902,11],[5906,14],[5909,0],[5920,11],[5938,14],[5941,0],[5952,11],[5970,14],[5972,0],[5984,11],[5997,0],[5998,11],[6001,0],[6002,14],[6004,0],[6068,14],[6100,0],[6109,14],[6110,0],[6112,9],[6122,0],[6155,14],[6158,13],[6159,0],[6160,9],[6170,0],[6176,11],[6265,
0],[6272,11],[6277,14],[6279,11],[6313,14],[6314,11],[6315,0],[6320,11],[6390,0],[6400,11],[6431,0],[6432,14],[6444,0],[6448,14],[6460,0],[6470,9],[6480,0],[6608,9],[6618,0],[6656,11],[6679,14],[6684,0],[6741,14],[6751,0],[6752,14],[6781,0],[6783,14],[6784,9],[6794,0],[6800,9],[6810,0],[6832,14],[6849,0],[6912,14],[6917,11],[6964,14],[6981,11],[6988,0],[6992,9],[7002,0],[7019,14],[7028,0],[7040,14],[7043,11],[7073,14],[7086,11],[7088,9],[7098,11],[7142,14],[7156,0],[7168,11],[7204,14],[7224,0],[7232,
9],[7242,0],[7245,11],[7248,9],[7258,11],[7294,0],[7296,11],[7305,0],[7312,11],[7355,0],[7357,11],[7360,0],[7376,14],[7379,0],[7380,14],[7401,11],[7405,14],[7406,11],[7412,14],[7413,11],[7415,14],[7418,11],[7419,0],[7424,11],[7616,14],[7674,0],[7675,14],[7680,11],[7958,0],[7960,11],[7966,0],[7968,11],[8006,0],[8008,11],[8014,0],[8016,11],[8024,0],[8025,11],[8026,0],[8027,11],[8028,0],[8029,11],[8030,0],[8031,11],[8062,0],[8064,11],[8117,0],[8118,11],[8125,0],[8126,11],[8127,0],[8130,11],[8133,0],
[8134,11],[8141,0],[8144,11],[8148,0],[8150,11],[8156,0],[8160,11],[8173,0],[8178,11],[8181,0],[8182,11],[8189,0],[8192,4],[8199,0],[8200,4],[8203,0],[8204,14],[8205,16],[8206,13],[8208,0],[8216,8],[8218,0],[8228,8],[8229,0],[8231,10],[8232,2],[8234,13],[8239,12],[8240,0],[8255,12],[8257,0],[8260,7],[8261,0],[8276,12],[8277,0],[8287,4],[8288,13],[8293,0],[8294,13],[8304,0],[8305,11],[8306,0],[8319,11],[8320,0],[8336,11],[8349,0],[8400,14],[8433,0],[8450,11],[8451,0],[8455,11],[8456,0],[8458,11],[8468,
0],[8469,11],[8470,0],[8473,11],[8478,0],[8484,11],[8485,0],[8486,11],[8487,0],[8488,11],[8489,0],[8490,11],[8494,0],[8495,11],[8506,0],[8508,11],[8512,0],[8517,11],[8522,0],[8526,11],[8527,0],[8544,11],[8585,0],[9398,11],[9450,0],[11264,11],[11311,0],[11312,11],[11359,0],[11360,11],[11493,0],[11499,11],[11503,14],[11506,11],[11508,0],[11520,11],[11558,0],[11559,11],[11560,0],[11565,11],[11566,0],[11568,11],[11624,0],[11631,11],[11632,0],[11647,14],[11648,11],[11671,0],[11680,11],[11687,0],[11688,
11],[11695,0],[11696,11],[11703,0],[11704,11],[11711,0],[11712,11],[11719,0],[11720,11],[11727,0],[11728,11],[11735,0],[11736,11],[11743,0],[11744,14],[11776,0],[11823,11],[11824,0],[12288,4],[12289,0],[12293,11],[12294,0],[12330,14],[12336,0],[12337,17],[12342,0],[12347,11],[12349,0],[12441,14],[12443,17],[12445,0],[12448,17],[12539,0],[12540,17],[12544,0],[12549,11],[12592,0],[12593,11],[12687,0],[12704,11],[12736,0],[12784,17],[12800,0],[13008,17],[13055,0],[13056,17],[13144,0],[40960,11],[42125,
0],[42192,11],[42238,0],[42240,11],[42509,0],[42512,11],[42528,9],[42538,11],[42540,0],[42560,11],[42607,14],[42611,0],[42612,14],[42622,0],[42623,11],[42654,14],[42656,11],[42736,14],[42738,0],[42760,11],[42944,0],[42946,11],[42955,0],[42997,11],[43010,14],[43011,11],[43014,14],[43015,11],[43019,14],[43020,11],[43043,14],[43048,0],[43052,14],[43053,0],[43072,11],[43124,0],[43136,14],[43138,11],[43188,14],[43206,0],[43216,9],[43226,0],[43232,14],[43250,11],[43256,0],[43259,11],[43260,0],[43261,11],
[43263,14],[43264,9],[43274,11],[43302,14],[43310,0],[43312,11],[43335,14],[43348,0],[43360,11],[43389,0],[43392,14],[43396,11],[43443,14],[43457,0],[43471,11],[43472,9],[43482,0],[43493,14],[43494,0],[43504,9],[43514,0],[43520,11],[43561,14],[43575,0],[43584,11],[43587,14],[43588,11],[43596,14],[43598,0],[43600,9],[43610,0],[43643,14],[43646,0],[43696,14],[43697,0],[43698,14],[43701,0],[43703,14],[43705,0],[43710,14],[43712,0],[43713,14],[43714,0],[43744,11],[43755,14],[43760,0],[43762,11],[43765,
14],[43767,0],[43777,11],[43783,0],[43785,11],[43791,0],[43793,11],[43799,0],[43808,11],[43815,0],[43816,11],[43823,0],[43824,11],[43882,0],[43888,11],[44003,14],[44011,0],[44012,14],[44014,0],[44016,9],[44026,0],[44032,11],[55204,0],[55216,11],[55239,0],[55243,11],[55292,0],[64256,11],[64263,0],[64275,11],[64280,0],[64285,15],[64286,14],[64287,15],[64297,0],[64298,15],[64311,0],[64312,15],[64317,0],[64318,15],[64319,0],[64320,15],[64322,0],[64323,15],[64325,0],[64326,15],[64336,11],[64434,0],[64467,
11],[64830,0],[64848,11],[64912,0],[64914,11],[64968,0],[65008,11],[65020,0],[65024,14],[65040,7],[65041,0],[65043,10],[65044,7],[65045,0],[65056,14],[65072,0],[65075,12],[65077,0],[65101,12],[65104,7],[65105,0],[65106,8],[65107,0],[65108,7],[65109,10],[65110,0],[65136,11],[65141,0],[65142,11],[65277,0],[65279,13],[65280,0],[65287,8],[65288,0],[65292,7],[65293,0],[65294,8],[65295,0],[65296,9],[65306,10],[65307,7],[65308,0],[65313,11],[65339,0],[65343,12],[65344,0],[65345,11],[65371,0],[65382,17],
[65438,14],[65440,11],[65471,0],[65474,11],[65480,0],[65482,11],[65488,0],[65490,11],[65496,0],[65498,11],[65501,0],[65529,13],[65532,0],[65536,11],[65548,0],[65549,11],[65575,0],[65576,11],[65595,0],[65596,11],[65598,0],[65599,11],[65614,0],[65616,11],[65630,0],[65664,11],[65787,0],[65856,11],[65909,0],[66045,14],[66046,0],[66176,11],[66205,0],[66208,11],[66257,0],[66272,14],[66273,0],[66304,11],[66336,0],[66349,11],[66379,0],[66384,11],[66422,14],[66427,0],[66432,11],[66462,0],[66464,11],[66500,
0],[66504,11],[66512,0],[66513,11],[66518,0],[66560,11],[66718,0],[66720,9],[66730,0],[66736,11],[66772,0],[66776,11],[66812,0],[66816,11],[66856,0],[66864,11],[66916,0],[67072,11],[67383,0],[67392,11],[67414,0],[67424,11],[67432,0],[67584,11],[67590,0],[67592,11],[67593,0],[67594,11],[67638,0],[67639,11],[67641,0],[67644,11],[67645,0],[67647,11],[67670,0],[67680,11],[67703,0],[67712,11],[67743,0],[67808,11],[67827,0],[67828,11],[67830,0],[67840,11],[67862,0],[67872,11],[67898,0],[67968,11],[68024,
0],[68030,11],[68032,0],[68096,11],[68097,14],[68100,0],[68101,14],[68103,0],[68108,14],[68112,11],[68116,0],[68117,11],[68120,0],[68121,11],[68150,0],[68152,14],[68155,0],[68159,14],[68160,0],[68192,11],[68221,0],[68224,11],[68253,0],[68288,11],[68296,0],[68297,11],[68325,14],[68327,0],[68352,11],[68406,0],[68416,11],[68438,0],[68448,11],[68467,0],[68480,11],[68498,0],[68608,11],[68681,0],[68736,11],[68787,0],[68800,11],[68851,0],[68864,11],[68900,14],[68904,0],[68912,9],[68922,0],[69248,11],[69290,
0],[69291,14],[69293,0],[69296,11],[69298,0],[69376,11],[69405,0],[69415,11],[69416,0],[69424,11],[69446,14],[69457,0],[69552,11],[69573,0],[69600,11],[69623,0],[69632,14],[69635,11],[69688,14],[69703,0],[69734,9],[69744,0],[69759,14],[69763,11],[69808,14],[69819,0],[69821,13],[69822,0],[69837,13],[69838,0],[69840,11],[69865,0],[69872,9],[69882,0],[69888,14],[69891,11],[69927,14],[69941,0],[69942,9],[69952,0],[69956,11],[69957,14],[69959,11],[69960,0],[69968,11],[70003,14],[70004,0],[70006,11],[70007,
0],[70016,14],[70019,11],[70067,14],[70081,11],[70085,0],[70089,14],[70093,0],[70094,14],[70096,9],[70106,11],[70107,0],[70108,11],[70109,0],[70144,11],[70162,0],[70163,11],[70188,14],[70200,0],[70206,14],[70207,0],[70272,11],[70279,0],[70280,11],[70281,0],[70282,11],[70286,0],[70287,11],[70302,0],[70303,11],[70313,0],[70320,11],[70367,14],[70379,0],[70384,9],[70394,0],[70400,14],[70404,0],[70405,11],[70413,0],[70415,11],[70417,0],[70419,11],[70441,0],[70442,11],[70449,0],[70450,11],[70452,0],[70453,
11],[70458,0],[70459,14],[70461,11],[70462,14],[70469,0],[70471,14],[70473,0],[70475,14],[70478,0],[70480,11],[70481,0],[70487,14],[70488,0],[70493,11],[70498,14],[70500,0],[70502,14],[70509,0],[70512,14],[70517,0],[70656,11],[70709,14],[70727,11],[70731,0],[70736,9],[70746,0],[70750,14],[70751,11],[70754,0],[70784,11],[70832,14],[70852,11],[70854,0],[70855,11],[70856,0],[70864,9],[70874,0],[71040,11],[71087,14],[71094,0],[71096,14],[71105,0],[71128,11],[71132,14],[71134,0],[71168,11],[71216,14],
[71233,0],[71236,11],[71237,0],[71248,9],[71258,0],[71296,11],[71339,14],[71352,11],[71353,0],[71360,9],[71370,0],[71453,14],[71468,0],[71472,9],[71482,0],[71680,11],[71724,14],[71739,0],[71840,11],[71904,9],[71914,0],[71935,11],[71943,0],[71945,11],[71946,0],[71948,11],[71956,0],[71957,11],[71959,0],[71960,11],[71984,14],[71990,0],[71991,14],[71993,0],[71995,14],[71999,11],[72E3,14],[72001,11],[72002,14],[72004,0],[72016,9],[72026,0],[72096,11],[72104,0],[72106,11],[72145,14],[72152,0],[72154,14],
[72161,11],[72162,0],[72163,11],[72164,14],[72165,0],[72192,11],[72193,14],[72203,11],[72243,14],[72250,11],[72251,14],[72255,0],[72263,14],[72264,0],[72272,11],[72273,14],[72284,11],[72330,14],[72346,0],[72349,11],[72350,0],[72384,11],[72441,0],[72704,11],[72713,0],[72714,11],[72751,14],[72759,0],[72760,14],[72768,11],[72769,0],[72784,9],[72794,0],[72818,11],[72848,0],[72850,14],[72872,0],[72873,14],[72887,0],[72960,11],[72967,0],[72968,11],[72970,0],[72971,11],[73009,14],[73015,0],[73018,14],[73019,
0],[73020,14],[73022,0],[73023,14],[73030,11],[73031,14],[73032,0],[73040,9],[73050,0],[73056,11],[73062,0],[73063,11],[73065,0],[73066,11],[73098,14],[73103,0],[73104,14],[73106,0],[73107,14],[73112,11],[73113,0],[73120,9],[73130,0],[73440,11],[73459,14],[73463,0],[73648,11],[73649,0],[73728,11],[74650,0],[74752,11],[74863,0],[74880,11],[75076,0],[77824,11],[78895,0],[78896,13],[78905,0],[82944,11],[83527,0],[92160,11],[92729,0],[92736,11],[92767,0],[92768,9],[92778,0],[92880,11],[92910,0],[92912,
14],[92917,0],[92928,11],[92976,14],[92983,0],[92992,11],[92996,0],[93008,9],[93018,0],[93027,11],[93048,0],[93053,11],[93072,0],[93760,11],[93824,0],[93952,11],[94027,0],[94031,14],[94032,11],[94033,14],[94088,0],[94095,14],[94099,11],[94112,0],[94176,11],[94178,0],[94179,11],[94180,14],[94181,0],[94192,14],[94194,0],[110592,17],[110593,0],[110948,17],[110952,0],[113664,11],[113771,0],[113776,11],[113789,0],[113792,11],[113801,0],[113808,11],[113818,0],[113821,14],[113823,0],[113824,13],[113828,
0],[119141,14],[119146,0],[119149,14],[119155,13],[119163,14],[119171,0],[119173,14],[119180,0],[119210,14],[119214,0],[119362,14],[119365,0],[119808,11],[119893,0],[119894,11],[119965,0],[119966,11],[119968,0],[119970,11],[119971,0],[119973,11],[119975,0],[119977,11],[119981,0],[119982,11],[119994,0],[119995,11],[119996,0],[119997,11],[120004,0],[120005,11],[120070,0],[120071,11],[120075,0],[120077,11],[120085,0],[120086,11],[120093,0],[120094,11],[120122,0],[120123,11],[120127,0],[120128,11],[120133,
0],[120134,11],[120135,0],[120138,11],[120145,0],[120146,11],[120486,0],[120488,11],[120513,0],[120514,11],[120539,0],[120540,11],[120571,0],[120572,11],[120597,0],[120598,11],[120629,0],[120630,11],[120655,0],[120656,11],[120687,0],[120688,11],[120713,0],[120714,11],[120745,0],[120746,11],[120771,0],[120772,11],[120780,0],[120782,9],[120832,0],[121344,14],[121399,0],[121403,14],[121453,0],[121461,14],[121462,0],[121476,14],[121477,0],[121499,14],[121504,0],[121505,14],[121520,0],[122880,14],[122887,
0],[122888,14],[122905,0],[122907,14],[122914,0],[122915,14],[122917,0],[122918,14],[122923,0],[123136,11],[123181,0],[123184,14],[123191,11],[123198,0],[123200,9],[123210,0],[123214,11],[123215,0],[123584,11],[123628,14],[123632,9],[123642,0],[124928,11],[125125,0],[125136,14],[125143,0],[125184,11],[125252,14],[125259,11],[125260,0],[125264,9],[125274,0],[126464,11],[126468,0],[126469,11],[126496,0],[126497,11],[126499,0],[126500,11],[126501,0],[126503,11],[126504,0],[126505,11],[126515,0],[126516,
11],[126520,0],[126521,11],[126522,0],[126523,11],[126524,0],[126530,11],[126531,0],[126535,11],[126536,0],[126537,11],[126538,0],[126539,11],[126540,0],[126541,11],[126544,0],[126545,11],[126547,0],[126548,11],[126549,0],[126551,11],[126552,0],[126553,11],[126554,0],[126555,11],[126556,0],[126557,11],[126558,0],[126559,11],[126560,0],[126561,11],[126563,0],[126564,11],[126565,0],[126567,11],[126571,0],[126572,11],[126579,0],[126580,11],[126584,0],[126585,11],[126589,0],[126590,11],[126591,0],[126592,
11],[126602,0],[126603,11],[126620,0],[126625,11],[126628,0],[126629,11],[126634,0],[126635,11],[126652,0],[127280,11],[127306,0],[127312,11],[127338,0],[127344,11],[127370,0],[127462,18],[127488,0],[127995,14],[128E3,0],[130032,9],[130042,0],[917505,13],[917506,0],[917536,14],[917632,0],[917760,14],[918E3,0]]})(c||(c={}));var d=this&&this.__read||function(a,b){var c="function"===typeof Symbol&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,f=[];try{for(;(void 0===b||0<b--)&&!(d=a.next()).done;)f.push(d.value)}catch(p){var l=
{error:p}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(l)throw l.error;}}return f};(function(a){function b(a){return!Array.from(a).map(l).every(function(a){return 3===a||1===a||2===a||4===a})}function c(a){function b(b){return b>=a.length?a.length:f(a[b])?b+2:b+1}function c(b){return 0>b?19:b>=a.length?20:f(a[b])?l(a[b]+a[b+1]):l(a[b])}function e(a){return 11===a||15===a}if(0===a.length)return[];var g=[];var h=0;var q=19,k=19;var p=c(0);var w=0;do{var r=h;h=b(h);p=d([q,k,p,c(h)],
4);var y=p[0];q=p[1];k=p[2];p=p[3];if(19===q)g.push(r);else{if(20===k){g.push(r);break}if(3!==q||1!==k)if(2===q||3===q||1===q)g.push(r);else if(2===k||3===k||1===k)g.push(r);else if(4!==q||4!=k){for(;13===k||14===k||16===k;)h=d([h,b(h)],2),r=h[0],h=h[1],p=d([p,c(h)],2),k=p[0],p=p[1];if(20===k){g.push(r);break}for(;13===p||14===p||16===p;)h=b(h),p=c(h);if(!e(q)||!e(k))if(!e(q)||!e(p)||10!==k&&8!==k&&6!==k)if(!e(y)||!e(k)||10!==q&&8!==q&&6!==q)if(15!==q||6!==k)if(15!==q||5!==k||15!==p)if(15!==y||5!==
q||15!==k)if(9!==q||9!==k)if(!e(q)||9!==k)if(9!==q||!e(k))if(9!==y||9!==k||7!==q&&8!==q&&6!==q)if(9!==q||9!==p||7!==k&&8!==k&&6!==k)if(17!==q||17!==k)if(!e(q)&&9!==q&&17!==q&&12!==q||12!==k)if(!e(k)&&9!==k&&17!==k||12!==q){if(18===k){if(w+=1,1==w%2)continue}else w=0;g.push(r)}}}}while(r<a.length);return g}function f(a){a=a.charCodeAt(0);return 55296<=a&&56319>=a}function l(a){a=a.codePointAt(0);return e(a,0,g.length-1)}function e(a,b,c){if(c<b)return 0;var d=b+~~((c-b)/2),f=g[d],l=g[d+1];l=l?l[0]:
Infinity;return a<f[0]?e(a,b,d-1):a>=l?e(a,d+1,c):f[1]}a.default_=function(a){var d=c(a);if(0==d.length)return[];for(var f=[],l=0;l<d.length-1;l++){var e=d[l+1],g=new h(a,d[l],e);b(g.text)?f.push(g):l==d.length-2&&(g=new h(a,e,e),f.push(g))}return f};var g=a.data.WORD_BREAK_PROPERTY,h=function(){function a(a,b,c){this._source=a;this.start=b;this.end=c}Object.defineProperty(a.prototype,"text",{get:function(){return this._source.substring(this.start,this.end)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"length",{get:function(){return this.end-this.start},enumerable:!0,configurable:!0});return a}()})(c||(c={}));c["default"]=c.default_;(function(a){a.placeholder=function(a){var b=0;return a.split(/\s+/).map(function(a){a={start:b,end:b+a.length,text:a,length:a.length};b=a.end;return a})}})(c||(c={}));"undefined"!==typeof module&&module.exports&&(module.exports.wordBreakers=c);(function(a){function b(a){"string"==typeof a&&(a=a.charCodeAt(0));return 55296<=a&&56319>=a}function c(a){"string"==typeof a&&
(a=a.charCodeAt(0));return 56320<=a&&57343>=a}a.SENTINEL_CODE_UNIT="\ufdd0";a.applyTransform=function(a,b){var c=b.left||"",d=c.kmwLength();c=c.kmwSubstr(0,d-(d<a.deleteLeft?d:a.deleteLeft))+(a.insert||"");d=b.right||"";var f=d.kmwLength();a=d.kmwSubstr(f<a.deleteRight?f:a.deleteRight);return{left:c,right:a,startOfBuffer:b.startOfBuffer,endOfBuffer:b.endOfBuffer,casingForm:b.casingForm}};a.buildMergedTransform=function(a,b){var c=a.insert,d=b.deleteLeft;b.deleteLeft&&(d=a.insert.kmwLength(),d<=b.deleteLeft?
(c="",d=b.deleteLeft-d):(c=a.insert.kmwSubstr(0,d-b.deleteLeft),d=0));return{insert:c+b.insert,deleteLeft:a.deleteLeft+d,deleteRight:(a.deleteRight||0)+(b.deleteRight||0)}};a.isHighSurrogate=b;a.isLowSurrogate=c;a.isSentinel=function(b){return b==a.SENTINEL_CODE_UNIT};a.transformToSuggestion=function(a,b){a={transform:a,transformId:a.id,displayAs:a.insert};if(0===b||b)a.p=b;return a};a.defaultApplyCasing=function(a,d){switch(a){case "lower":return d.toLowerCase();case "upper":return d.toUpperCase();
case "initial":return a=1,1<d.length&&b(d.charAt(0))&&c(d.charCodeAt(1))&&(a=2),d.substring(0,a).toUpperCase().concat(d.substring(a))}}})(a||(a={}));(function(a){var b=function(){function a(a,b){void 0===b&&(b=[]);this.comparator=a;this.heap=Array.from(b);this.heapify()}a.leftChildIndex=function(a){return 2*a+1};a.rightChildIndex=function(a){return 2*a+2};a.parentIndex=function(a){return Math.floor((a-1)/2)};a.prototype.heapify=function(b,c){void 0!=b&&void 0!=c||this.heapify(0,this.count-1);for(var d=
[],f=-1,l=c;l>=b;l--)c=a.parentIndex(l),this.siftDown(l)&&c<b&&f!=c&&(d.push(c),f=c);for(f=-1;0<d.length;)b=d.shift(),c=a.parentIndex(b),this.siftDown(b)&&0<=c&&f!=c&&(d.push(c),f=c)};Object.defineProperty(a.prototype,"count",{get:function(){return this.heap.length},enumerable:!0,configurable:!0});a.prototype.peek=function(){return this.heap[0]};a.prototype.enqueue=function(b){var c=this.heap.length;this.heap.push(b);b=a.parentIndex;for(var d=b(c);0!==c&&0>this.comparator(this.heap[c],this.heap[d]);){var f=
this.heap[c];this.heap[c]=this.heap[d];this.heap[d]=f;c=d;d=b(c)}};a.prototype.enqueueAll=function(b){if(0!=b.length){var c=this.count;this.heap=this.heap.concat(b);b=a.parentIndex(c);this.heapify(0<=b?b:0,a.parentIndex(this.count-1))}};a.prototype.dequeue=function(){if(0!=this.count){var a=this.heap[0],b=this.heap.pop();0<this.heap.length&&(this.heap[0]=b,this.siftDown(0));return a}};a.prototype.siftDown=function(b){var c=a.leftChildIndex(b),d=a.rightChildIndex(b),f=b;c<this.heap.length&&0>this.comparator(this.heap[c],
this.heap[f])&&(f=c);d<this.heap.length&&0>this.comparator(this.heap[d],this.heap[f])&&(f=d);return f!=b?(c=this.heap[b],this.heap[b]=this.heap[f],this.heap[f]=c,this.siftDown(f),!0):!1};a.prototype.toArray=function(){return Array.from(this.heap)};return a}();a.PriorityQueue=b})(a||(a={}));(function(a){function b(a,b){b=b||{left:void 0,startOfBuffer:void 0,endOfBuffer:void 0};var c=a(b.left||"")||[],d=a(b.right||"")||[],f;0<c.length&&(f=c[c.length-1]);if(1<c.length){var l=c[c.length-2];l.end==f.start&&
"'"==f.text&&(f={text:l.text+f.text,start:l.start,end:f.end,length:l.length+f.length},c.pop(),c.pop(),c.push(f))}l={left:c.map(function(a){return a.text}),right:d.map(function(a){return a.text}),caretSplitsToken:!1};if(0<c.length&&0<d.length){c=d[0];d=0!=c.start;if(f.end!=b.left.length||d)return l;1==a(f.text+c.text).length&&(l.caretSplitsToken=!0)}return l}function c(a,c){a=b(a,c);return 0<a.left.length?a.left.pop():""}a.tokenize=b;a.getLastPreCaretToken=c;a.wordbreak=function(a,b){return c(a,b)}})(a||
(a={}));var f=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(l)throw new TypeError("Generator is already executing.");for(;f;)try{if(l=1,e&&(g=c[0]&2?e["return"]:c[0]?e["throw"]||((g=e["return"])&&g.call(e),0):e.next)&&!(g=g.call(e,c[1])).done)return g;if(e=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;e=c[1];c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;
default:if(!(g=f.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))f.label=c[1];else if(6===c[0]&&f.label<g[1])f.label=g[1],g=c;else if(g&&f.label<g[2])f.label=g[2],f.ops.push(c);else{g[2]&&f.ops.pop();f.trys.pop();continue}}c=b.call(a,f)}catch(Y){c=[6,Y],e=0}finally{l=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},l,e,g,h;return h={next:c(0),
"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h};(function(a){function d(a,b,c){void 0===c&&(c=0);if("leaf"===a.type||c===b.length)return a;var f=b[c];return a.children[f]?d(a.children[f],b,c+1):null}function l(c,d,f,l){var e;void 0===l&&(l=12);var g=new a.PriorityQueue(function(a,b){return(b?b.weight:0)-(a?a.weight:0)}),h=[];if("leaf"===c.type)try{for(var q=b(c.entries),k=q.next();!k.done;k=q.next()){var w=k.value;if(w.key.startsWith(d)&&(h.push({text:w.content,
p:w.weight/f}),h.length>=l))return h}}catch(E){var p={error:E}}finally{try{k&&!k.done&&(e=q.return)&&e.call(q)}finally{if(p)throw p.error;}}else{g.enqueue(c);var r=void 0;c=function(){if("type"in r)if("leaf"===r.type)g.enqueueAll(r.entries);else{var a=r;g.enqueueAll(r.values.map(function(b){return a.children[b]}))}else if(h.push({text:r.content,p:r.weight/f}),h.length>=l)return{value:h}};for(;r=g.dequeue();)if(d=c(),"object"===typeof d)return d.value}return h}function e(a){return a.normalize("NFD").replace(/[\u0300-\u036f]/g,
"").toLowerCase()}var g=function(){function d(a,b){void 0===b&&(b={});this.languageUsesCasing=b.languageUsesCasing;this.applyCasing=b.applyCasing;this._trie=new h(a.root,a.totalWeight,b.searchTermToKey||e);(a=b.wordBreaker)||(a=("undefined"!==typeof c?c:require("@keymanapp/models-wordBreakers").wordBreakers)["default"]);this.breakWords=a;this.punctuation=b.punctuation}d.prototype.configure=function(a){return this.configuration={leftContextCodePoints:a.maxLeftContextCodePoints,rightContextCodePoints:a.maxRightContextCodePoints}};
d.prototype.toKey=function(a){return this._trie.toKey(a)};d.prototype.predict=function(c,d){function f(a){var c,d=[];try{for(var f=b(a),l=f.next();!l.done;l=f.next()){var e=l.value;d.push({sample:e,p:e.p})}}catch(K){var g={error:K}}finally{try{l&&!l.done&&(c=f.return)&&c.call(f)}finally{if(g)throw g.error;}}return d}if(!c.insert&&!d.left&&!d.right&&d.startOfBuffer&&d.endOfBuffer)return f(this._trie.firstN(12).map(function(a){var b=a.text;return{transform:{insert:b,deleteLeft:0},displayAs:b,p:a.p}}));
d=a.applyTransform(c,d);var l=c.deleteLeft-c.insert.kmwLength(),e=a.getLastPreCaretToken(this.breakWords,d);return f(this._trie.lookup(e).map(function(b){var c=b.p;return a.transformToSuggestion({insert:b.text,deleteLeft:l+e.kmwLength()},c)}))};Object.defineProperty(d.prototype,"wordbreaker",{get:function(){return this.breakWords},enumerable:!0,configurable:!0});d.prototype.traverseFromRoot=function(){return new d.Traversal(this._trie.root,"")};d.Traversal=function(){function c(a,b){this.root=a;this.prefix=
b}c.prototype.children=function(){var c,l,e,g,h,q,k,w,p,r,v,n,D,y,u,A,t,z;return f(this,function(H){switch(H.label){case 0:c=this.root;if("internal"!=c.type)return[3,9];l=function(l){var g,h,q,k,w,p,r,v,n,D,y,u;return f(this,function(A){switch(A.label){case 0:g=c.children[l];if(!a.isHighSurrogate(l))return[3,12];if("internal"!=g.type)return[3,9];h=g;q=function(a){var b;return f(this,function(c){switch(c.label){case 0:return b=e.prefix+l+a,[4,{char:l+a,traversal:function(){return new d.Traversal(h.children[a],
b)}}];case 1:return c.sent(),[2]}})};A.label=1;case 1:A.trys.push([1,6,7,8]),k=(y=void 0,b(h.values)),w=k.next(),A.label=2;case 2:if(w.done)return[3,5];p=w.value;return[5,q(p)];case 3:A.sent(),A.label=4;case 4:return w=k.next(),[3,2];case 5:return[3,8];case 6:return r=A.sent(),y={error:r},[3,8];case 7:try{w&&!w.done&&(u=k.return)&&u.call(k)}finally{if(y)throw y.error;}return[7];case 8:return[3,11];case 9:return v=g.entries[0].key,l+=v[e.prefix.length+1],n=e.prefix+l,[4,{char:l,traversal:function(){return new d.Traversal(g,
n)}}];case 10:A.sent(),A.label=11;case 11:return[3,16];case 12:return a.isSentinel(l)?[2,"continue"]:[3,13];case 13:return l?[3,14]:[2,"continue"];case 14:return D=e.prefix+l,[4,{char:l,traversal:function(){return new d.Traversal(g,D)}}];case 15:A.sent(),A.label=16;case 16:return[2]}})};e=this;H.label=1;case 1:H.trys.push([1,6,7,8]),g=b(c.values),h=g.next(),H.label=2;case 2:if(h.done)return[3,5];q=h.value;return[5,l(q)];case 3:H.sent(),H.label=4;case 4:return h=g.next(),[3,2];case 5:return[3,8];case 6:return k=
H.sent(),u={error:k},[3,8];case 7:try{h&&!h.done&&(A=g.return)&&A.call(g)}finally{if(u)throw u.error;}return[7];case 8:return[2];case 9:w=this.prefix,p=c.entries.filter(function(a){return a.key!=w&&w.length<a.key.length}),r=function(b){var l;return f(this,function(f){switch(f.label){case 0:return l=b[w.length],a.isHighSurrogate(l)&&(l+=b[w.length+1]),[4,{char:l,traversal:function(){return new d.Traversal(c,w+l)}}];case 1:return f.sent(),[2]}})},H.label=10;case 10:H.trys.push([10,15,16,17]),v=b(p),
n=v.next(),H.label=11;case 11:if(n.done)return[3,14];D=n.value.key;return[5,r(D)];case 12:H.sent(),H.label=13;case 13:return n=v.next(),[3,11];case 14:return[3,17];case 15:return y=H.sent(),t={error:y},[3,17];case 16:try{n&&!n.done&&(z=v.return)&&z.call(v)}finally{if(t)throw t.error;}return[7];case 17:return[2]}})};Object.defineProperty(c.prototype,"entries",{get:function(){if("leaf"==this.root.type){var b=this.prefix;return this.root.entries.filter(function(a){return a.key==b}).map(function(a){return a.content})}var c=
this.root.children[a.SENTINEL_CODE_UNIT];return c&&"leaf"==c.type?c.entries.map(function(a){return a.content}):[]},enumerable:!0,configurable:!0});return c}();return d}();a.TrieModel=g;var h=function(){function a(a,b,c){this.root=a;this.toKey=c;this.totalWeight=b}a.prototype.lookup=function(a){a=this.toKey(a);var b=d(this.root,a);return null===b?[]:l(b,a,this.totalWeight)};a.prototype.firstN=function(a){return l(this.root,"",this.totalWeight,a)};return a}()})(a||(a={}));(function(a){(function(a){a.noQuotes=
"no-quotes";a.useQuotes="use-quotes";a["default"]="default-quotes"})(a.QuoteBehavior||(a.QuoteBehavior={}));(function(a){a.apply=function(b,c,d,f){if(f==a.default||!f)throw"Specified quote behavior may be ambiguous - default behavior not specified (may not be .default)";b==a.default&&(b=f);switch(b){case a.noQuotes:return c;case a.useQuotes:return b=d.quotesForKeepSuggestion,b.open+c+b.close;default:throw"Unsupported quote behavior state detected; implementation missing!";}}})(a.QuoteBehavior||(a.QuoteBehavior=
{}))})(a||(a={}));"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports.models=a);var l;(function(b){var c=function(){function b(a){this.diagonalWidth=2;this.inputSequence=[];this.matchSequence=[];if(a){var b=a.resolvedDistances.length;this.resolvedDistances=Array(b);for(var c=0;c<b;c++)this.resolvedDistances[c]=Array.from(a.resolvedDistances[c]);this.inputSequence=Array.from(a.inputSequence);this.matchSequence=Array.from(a.matchSequence);this.diagonalWidth=a.diagonalWidth}else this.resolvedDistances=
[]}b.prototype.getTrueIndex=function(a,b,c){a={row:a,col:b-a+c,sparse:!1};if(0>a.col||a.col>2*c)a.sparse=!0;return a};b.prototype.getCostAt=function(a,b,c){void 0===c&&(c=this.diagonalWidth);if(0>a||0>b)return-1==a&&-1<=b?b+1:-1==b&&-1<=a?a+1:Number.MAX_VALUE;a=this.getTrueIndex(a,b,c);return a.sparse?Number.MAX_VALUE:this.resolvedDistances[a.row][a.col]};b.prototype.getFinalCost=function(){for(var a=this,b=a.getHeuristicFinalCost();b>a.diagonalWidth;)a=a.increaseMaxDistance(),b=a.getHeuristicFinalCost();
return b};b.prototype.getHeuristicFinalCost=function(){return this.getCostAt(this.inputSequence.length-1,this.matchSequence.length-1)};b.prototype.hasFinalCostWithin=function(a){var b=this,c=b.getHeuristicFinalCost(),d=this.diagonalWidth;do{if(c<=a)return!0;if(d<a)b=b.increaseMaxDistance(),d++,c=b.getHeuristicFinalCost();else break}while(1);return!1};b.prototype.editPath=function(a,c){void 0===a&&(a=this.inputSequence.length-1);void 0===c&&(c=this.matchSequence.length-1);var f=this.getCostAt(a,c),
l=null,e=null,g=this.getCostAt(a,c-1),h=this.getCostAt(a-1,c),q=this.getCostAt(a-1,c-1),k=d(b.getTransposeParent(this,a,c),2),w=k[0];k=k[1];if(0<=w&&0<=k){e=1;l=["transpose-start"];if(w!=a-1){var r=a-w-1;l=l.concat(Array(r).fill("transpose-delete"))}else r=c-k-1,l=l.concat(Array(r).fill("transpose-insert"));e+=r;l.push("transpose-end");this.getCostAt(w-1,k-1)!=f-e&&(l=null);e=[w-1,k-1]}l||(q==f-1?(l=["substitute"],e=[a-1,c-1]):g==f-1?(l=["insert"],e=[a,c-1]):h==f-1?(l=["delete"],e=[a-1,c]):(l=["match"],
e=[a-1,c-1]));return 0<=e[0]&&0<=e[1]?this.editPath(e[0],e[1]).concat(l):-1<e[0]?Array(e[0]+1).fill("delete").concat(l):-1<e[1]?Array(e[1]+1).fill("insert").concat(l):l};b.getTransposeParent=function(a,b,c){if(0>b||0>c||a.inputSequence[b].key==a.matchSequence[c].key)return[-1,-1];for(var d=-1,f=b-1;0<=f;f--)if(a.inputSequence[f].key==a.matchSequence[c].key){d=f;break}var l=-1;for(f=c-1;0<=f;f--)if(a.matchSequence[f].key==a.inputSequence[b].key){l=f;break}return[d,l]};b.initialCostAt=function(a,c,
f,l,e){var g=a.inputSequence[c].key==a.matchSequence[f].key?0:1;g=a.getCostAt(c-1,f-1)+g;l=l||a.getCostAt(c,f-1)+1;e=e||a.getCostAt(c-1,f)+1;var h=Number.MAX_VALUE;if(0<c&&0<f){var q=d(b.getTransposeParent(a,c,f),2);h=q[0];q=q[1];h=a.getCostAt(h-1,q-1)+(c-h-1)+1+(f-q-1)}return Math.min(g,e,l,h)};b.prototype.getSubset=function(a,c){var d=new b(this);if(a>this.inputSequence.length||c>this.matchSequence.length)throw"Invalid dimensions specified for trim operation";d.inputSequence.splice(a);d.matchSequence.splice(c);
d.resolvedDistances.splice(a);a=this.getTrueIndex(a-1,c-1,this.diagonalWidth);for(c=a.col;c<=2*this.diagonalWidth;c++){var f=a.row-(c-a.col);if(0>f)break;if(0>c)d.resolvedDistances[f]=Array(2*d.diagonalWidth+1).fill(Number.MAX_VALUE);else{var l=2*this.diagonalWidth-c,e=d.resolvedDistances[f].splice(0,c+1);l=Array(l).fill(Number.MAX_VALUE);d.resolvedDistances[f]=e.concat(l)}}return d};b.forDiagonalOfAxis=function(a,b,c,d){c=c-b<a?c-b+a:2*a;a=b-a;for(b=(0>a?0:a)-a;b<=c;b++)d(a+b,b)};b.prototype.addInputChar=
function(a){var c=new b(this),d=c.inputSequence.length;c.inputSequence.push(a);var f=Array(2*c.diagonalWidth+1).fill(Number.MAX_VALUE);c.resolvedDistances[d]=f;if(0==c.matchSequence.length)return c;b.forDiagonalOfAxis(c.diagonalWidth,d,c.matchSequence.length-1,function(a,l){f[l]=b.initialCostAt(c,d,a)});return c};b.prototype.addMatchChar=function(a){var c=new b(this),d=c.matchSequence.length;c.matchSequence.push(a);if(0==c.inputSequence.length)return c;b.forDiagonalOfAxis(c.diagonalWidth,d,c.inputSequence.length-
1,function(a,f){c.resolvedDistances[a][2*c.diagonalWidth-f]=b.initialCostAt(c,a,d)});return c};b.prototype.increaseMaxDistance=function(){function a(a,b,d,f){var l=2*(c.diagonalWidth-1),e=d.length-1;l=l<e-a?l:e-a;for(e=0;e<=l;e++)b==d[a+e].key&&f(a+e,e)}var c=new b(this);c.diagonalWidth++;if(1>c.inputSequence.length||1>c.matchSequence.length)return c;for(var d=function(d){var e=Number.MAX_VALUE,g=d-c.diagonalWidth;if(0<=g){var h=e=b.initialCostAt(c,d,g,0==g?d+2:Number.MAX_VALUE,void 0);if(g<c.matchSequence.length-
1){b.propagateUpdateFrom(c,d,g+1,h+1,0);var q=d+2;d+2<f.inputSequence.length&&a(g+3,c.inputSequence[d+1].key,c.matchSequence,function(a,d){b.propagateUpdateFrom(c,q,a,h+d+2,d)})}}var k=Number.MAX_VALUE;g=d+c.diagonalWidth;if(g<c.matchSequence.length){k=0==d?g+2:Number.MAX_VALUE;l=c.getCostAt(d,g-1,f.diagonalWidth)+1;var w=k=b.initialCostAt(c,d,g,l,k);if(d<c.inputSequence.length-1){b.propagateUpdateFrom(c,d+1,g,w+1,2*f.diagonalWidth);var p=g+2;g+2<f.matchSequence.length&&a(d+3,c.matchSequence[d+1].key,
c.inputSequence,function(a,d){b.propagateUpdateFrom(c,a,p,w+d+2,2*(c.diagonalWidth-1)-d)})}}c.resolvedDistances[d]=[e].concat(c.resolvedDistances[d],k)},f=this,l,e=0;e<c.inputSequence.length;e++)d(e);return c};b.propagateUpdateFrom=function(a,b,c,d,f){if(d<a.resolvedDistances[b][f]){a.resolvedDistances[b][f]=d;var l=b<a.inputSequence.length-1,e=c<a.matchSequence.length-1;f<2*(a.diagonalWidth-1)&&e&&this.propagateUpdateFrom(a,b,c+1,d+1,f+1);0<f&&l&&this.propagateUpdateFrom(a,b+1,c,d+1,f-1);if(l&&e){l=
d+(a.inputSequence[b+1].key==a.matchSequence[c+1].key?0:1);this.propagateUpdateFrom(a,b+1,c+1,l,f);f=-1;for(l=b+2;l<a.inputSequence.length;l++)if(a.inputSequence[l].key==a.matchSequence[c+1].key){f=l;break}e=-1;for(l=c+2;l<a.matchSequence.length;l++)if(a.matchSequence[l].key==a.inputSequence[b+1].key){e=l;break}0<f&&0<e&&this.propagateUpdateFrom(a,f,e,d+(f-b-2)+1+(e-c-2),a.diagonalWidth-1+e-f)}}};Object.defineProperty(b.prototype,"mapKey",{get:function(){var b=this.inputSequence.map(function(a){return a.key}).join(""),
c=this.matchSequence.map(function(a){return a.key}).join("");return b+a.SENTINEL_CODE_UNIT+c+a.SENTINEL_CODE_UNIT+this.diagonalWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"lastInputEntry",{get:function(){return this.inputSequence[this.inputSequence.length-1]},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"lastMatchEntry",{get:function(){return this.matchSequence[this.matchSequence.length-1]},enumerable:!0,configurable:!0});b.computeDistance=function(a,
c,d){void 0===d&&(d=1);var f=new b;f.diagonalWidth=d||1;for(d=0;d<a.length;d++)f=f.addInputChar(a[d]);for(a=0;a<c.length;a++)f=f.addMatchChar(c[a]);return f};return b}();b.ClassicalDistanceCalculation=c})(l||(l={}));(function(c){c.QUEUE_NODE_COMPARATOR=function(a,b){return a.currentCost-b.currentCost};var d=function(){function d(a,b){this.toKey=function(a){return a};b=b||function(a){return a};a instanceof d?(this.calculation=a.calculation,this.currentTraversal=a.currentTraversal,this.priorInput=a.priorInput,
this.toKey=a.toKey):(this.calculation=new c.ClassicalDistanceCalculation,this.currentTraversal=a,this.priorInput=[],this.toKey=b)}Object.defineProperty(d.prototype,"knownCost",{get:function(){return this.calculation.getHeuristicFinalCost()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"inputSamplingCost",{get:function(){if(void 0===this._inputCost){var a=g.MIN_KEYSTROKE_PROBABILITY;this._inputCost=this.priorInput.map(function(b){return b.p>a?b.p:a}).reduce(function(a,b){return a-
Math.log(b)},0)}return this._inputCost},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentCost",{get:function(){return g.EDIT_DISTANCE_COST_SCALE*this.knownCost+this.inputSamplingCost},enumerable:!0,configurable:!0});d.prototype.buildInsertionEdges=function(){var a,c=[];try{for(var f=b(this.currentTraversal.children()),l=f.next();!l.done;l=f.next()){var e=l.value,g=e.traversal(),h=this.calculation.addMatchChar({key:e.char,traversal:g}),q=new d(this);q.calculation=h;q.priorInput=
this.priorInput;q.currentTraversal=g;c.push(q)}}catch(T){var k={error:T}}finally{try{l&&!l.done&&(a=f.return)&&a.call(f)}finally{if(k)throw k.error;}}return c};d.prototype.buildDeletionEdges=function(c){var f,l=[];try{for(var e=b(c),h=e.next();!h.done;h=e.next()){var q=h.value;if(q.p<c[0].p*Math.exp(-g.EDIT_DISTANCE_COST_SCALE))break;var k=this.calculation,w=q.sample;w.deleteLeft&&(k=k.getSubset(k.inputSequence.length-w.deleteLeft,k.matchSequence.length));var p=Array.from(this.priorInput);p.push(q);
for(var n=0;n<w.insert.length;n++){var v=w.insert[n];a.isHighSurrogate(v)&&(n++,v+=w.insert[n]);var D=this.toKey(v);D&&(k=k.addInputChar({key:D}))}var u=new d(this);u.calculation=k;u.priorInput=p;l.push(u)}}catch(W){var r={error:W}}finally{try{h&&!h.done&&(f=e.return)&&f.call(e)}finally{if(r)throw r.error;}}return l};d.prototype.buildSubstitutionEdges=function(a){var c,f,l;a=this.buildDeletionEdges(a);var e=[];try{for(var g=b(this.currentTraversal.children()),h=g.next();!h.done;h=g.next()){var q=
h.value;try{for(var k=(f=void 0,b(a)),w=k.next();!w.done;w=k.next()){var p=w.value,n=q.traversal(),v=p.calculation.addMatchChar({key:q.char,traversal:n}),D=new d(this);D.calculation=v;D.priorInput=p.priorInput;D.currentTraversal=n;e.push(D)}}catch(Z){f={error:Z}}finally{try{w&&!w.done&&(l=k.return)&&l.call(k)}finally{if(f)throw f.error;}}}}catch(Z){var u={error:Z}}finally{try{h&&!h.done&&(c=g.return)&&c.call(g)}finally{if(u)throw u.error;}}return e};Object.defineProperty(d.prototype,"mapKey",{get:function(){var b=
this.priorInput.map(function(a){return"+"+a.sample.insert+"-"+a.sample.deleteLeft}).join(""),c=this.calculation.matchSequence.map(function(a){return a.key}).join("");return b+a.SENTINEL_CODE_UNIT+c},enumerable:!0,configurable:!0});return d}();c.SearchNode=d;var l=function(){function b(b,d){this.processed=[];this.index=b;this.correctionQueue=new a.PriorityQueue(c.QUEUE_NODE_COMPARATOR,d)}b.prototype.increaseMaxEditDistance=function(){var b=this.correctionQueue.toArray();b.forEach(function(a){a.calculation=
a.calculation.increaseMaxDistance()});this.correctionQueue=new a.PriorityQueue(c.QUEUE_NODE_COMPARATOR,b)};return b}(),e=function(){function a(a){this.resultNode=a}Object.defineProperty(a.prototype,"inputSequence",{get:function(){return this.resultNode.priorInput},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"matchSequence",{get:function(){return this.resultNode.calculation.matchSequence},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"matchString",{get:function(){return this.matchSequence.map(function(a){return a.key}).join("")},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"knownCost",{get:function(){return this.resultNode.knownCost},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputSamplingCost",{get:function(){return this.resultNode.inputSamplingCost},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"totalCost",{get:function(){return this.resultNode.currentCost},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"finalTraversal",{get:function(){return this.resultNode.currentTraversal},
enumerable:!0,configurable:!0});return a}();c.SearchResult=e;var g=function(){function b(b){this.tierOrdering=[];this.inputSequence=[];this.minInputCost=[];this.returnedValues={};this.processedEdgeSet={};if(!b)throw"The LexicalModel parameter must not be null / undefined.";if(!b.traverseFromRoot)throw"The provided model does not implement the `traverseFromRoot` function, which is needed to support robust correction searching.";this.buildQueueSpaceComparator();this.selectionQueue=new a.PriorityQueue(this.QUEUE_SPACE_COMPARATOR);
this.rootNode=new d(b.traverseFromRoot(),b.toKey?b.toKey.bind(b):null);this.completedPaths=[this.rootNode];b=new l(0,[this.rootNode]);this.tierOrdering.push(b);this.selectionQueue.enqueue(b)}b.prototype.buildQueueSpaceComparator=function(){var a=this;this.QUEUE_SPACE_COMPARATOR=function(b,c){var d=b.correctionQueue.peek(),f=c.correctionQueue.peek();b=b.index;c=c.index;var l=0,e=1;c<b&&(e=c,c=b,b=e,e=-1);for(;b<c;b++)l+=a.minInputCost[b];return d&&f?d.currentCost-f.currentCost+e*l:f?1:-1}};b.prototype.increaseMaxEditDistance=
function(){this.tierOrdering.forEach(function(a){a.increaseMaxEditDistance()})};b.prototype.addInput=function(a){this.inputSequence.push(a);this.minInputCost.push(-Math.log(a[0].p));var b=[],c=this.completedPaths.map(function(b){var c=b.buildDeletionEdges(a);b=b.buildSubstitutionEdges(a);return c.concat(b)});this.completedPaths=[];this.returnedValues={};c.forEach(function(a){b=b.concat(a)});c=new l(this.tierOrdering.length,b);this.tierOrdering.push(c);this.selectionQueue.enqueue(c)};b.prototype.removeLastInput=
function(){};b.prototype.hasNextMatchEntry=function(){var a=this.selectionQueue.peek();return a?0<a.correctionQueue.count:!1};b.prototype.handleNextNode=function(){if(!this.hasNextMatchEntry())return{type:"none"};var c=this.selectionQueue.dequeue(),d=c.correctionQueue.dequeue(),f={type:"intermediate",cost:d.currentCost};if(this.processedEdgeSet[d.mapKey])return this.selectionQueue.enqueue(c),f;this.processedEdgeSet[d.mapKey]=!0;var l=!1;if(2<d.knownCost)return f;2==d.knownCost&&(l=!0);for(var e=0,
g=0;g<=c.index;g++)e+=this.minInputCost[g];if(d.currentCost>e+2.5*b.EDIT_DISTANCE_COST_SCALE)return f;l||(e=d.buildInsertionEdges(),c.correctionQueue.enqueueAll(e));if(c.index==this.tierOrdering.length-1)return this.completedPaths.push(d),this.selectionQueue.enqueue(c),{type:"complete",cost:d.currentCost,finalNode:d};c=this.tierOrdering[c.index+1];g=c.index;e=[];l||(e=d.buildDeletionEdges(this.inputSequence[g-1]));d=d.buildSubstitutionEdges(this.inputSequence[g-1]);c.correctionQueue.enqueueAll(e.concat(d));
this.selectionQueue=new a.PriorityQueue(this.QUEUE_SPACE_COMPARATOR,this.tierOrdering);return f};b.prototype.getBestMatches=function(d){var l,g,h,q,k,w,p,n,v,D,u,r,t,z,y,A;return f(this,function(f){switch(f.label){case 0:l=this;g={};h=Date.now();q=0==d?Infinity:void 0==d||Number.isNaN(d)?b.DEFAULT_ALLOTTED_CORRECTION_TIME_INTERVAL:d;k=function(){function a(){this.currentCost=Number.MIN_SAFE_INTEGER;this.entries=[]}a.prototype.checkAndAdd=function(a){var b=null;a.currentCost>this.currentCost&&(b=this.tryFinalize(),
this.currentCost=a.currentCost);var c=a.calculation.matchSequence.map(function(a){return a.key}).join("");l.returnedValues[c]||(l.returnedValues[c]=a);g[c]||(this.entries.push(new e(a)),g[c]=a);return b};a.prototype.tryFinalize=function(){var a=null;0<this.entries.length&&(a=this.entries,this.entries=[]);return a};return a}();w=new k;p=Object.values(this.returnedValues);if(!(0<p.length))return[3,6];n=new a.PriorityQueue(c.QUEUE_NODE_COMPARATOR,p);f.label=1;case 1:if(!(0<n.count))return[3,4];v=n.dequeue();
return(D=w.checkAndAdd(v))?[4,D]:[3,3];case 2:f.sent(),f.label=3;case 3:return[3,1];case 4:return(u=w.tryFinalize())?[4,u]:[3,6];case 5:f.sent(),f.label=6;case 6:r=!1,f.label=7;case 7:t=void 0;do t=this.handleNextNode(),z=Date.now(),z-h>q&&(r=!0);while(!r&&"intermediate"==t.type);y=void 0;if("none"==t.type)return[3,10];"complete"==t.type&&(y=w.checkAndAdd(t.finalNode));return y?[4,y]:[3,9];case 8:f.sent(),f.label=9;case 9:if(!r&&this.hasNextMatchEntry())return[3,7];f.label=10;case 10:return(A=w.tryFinalize())?
[4,A]:[3,12];case 11:f.sent(),f.label=12;case 12:return[2,null]}})};b.EDIT_DISTANCE_COST_SCALE=5;b.MIN_KEYSTROKE_PROBABILITY=1E-4;b.DEFAULT_ALLOTTED_CORRECTION_TIME_INTERVAL=33;return b}();c.SearchSpace=g})(l||(l={}));var q=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);
b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();(function(d){function f(a,b){for(var c=[],d=0;d<a.kmwLength();d++){var f={insert:a.kmwCharAt(d),deleteLeft:0,id:b};c.push(f)}return c}var l=function(){return function(){}}();d.TrackedContextSuggestion=l;var e=function(){function a(){this.transformDistributions=[];this.activeReplacementId=-1}Object.defineProperty(a.prototype,"isNew",{get:function(){return 0==this.transformDistributions.length},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"currentText",{get:function(){return void 0===this.replacementText||null===this.replacementText?this.raw:this.replacementText},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"replacement",{get:function(){var a=this.activeReplacementId;return this.replacements.find(function(b){return b.suggestion.id==a})},enumerable:!0,configurable:!0});a.prototype.revert=function(){delete this.activeReplacementId};return a}();d.TrackedContextToken=e;var g=function(){function a(b){this.searchSpace=
[];b instanceof a?(this.tokens=b.tokens.map(function(a){var b=new e;b.raw=a.raw;b.replacements=a.replacements;b.activeReplacementId=a.activeReplacementId;b.transformDistributions=a.transformDistributions;a.replacementText&&(b.replacementText=a.replacementText);return b}),this.searchSpace=b.searchSpace,this.indexOffset=0,this.model=b.model):(this.tokens=[],this.indexOffset=Number.MIN_SAFE_INTEGER,(this.model=b)&&b.traverseFromRoot&&(this.searchSpace=[new d.SearchSpace(b)]))}Object.defineProperty(a.prototype,
"head",{get:function(){return this.tokens[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"tail",{get:function(){return this.tokens[this.tokens.length-1]},enumerable:!0,configurable:!0});a.prototype.popHead=function(){this.tokens.splice(0,2);--this.indexOffset};a.prototype.pushTail=function(a){this.searchSpace=this.model&&this.model.traverseFromRoot?[new d.SearchSpace(this.model)]:[];this.tokens.push(a);var b=this;0<b.searchSpace.length&&a.transformDistributions.forEach(function(a){return b.searchSpace[0].addInput(a)})};
a.prototype.pushWhitespaceToTail=function(a){void 0===a&&(a=null);var b=new e;b.transformDistributions=[a];b.raw=null;this.tokens.push(b)};a.prototype.replaceTailForBackspace=function(a,b){this.tokens.pop();b=f(a,b).map(function(a){return[{sample:a,p:1}]});var c=new e;c.raw=a;c.transformDistributions=b;this.pushTail(c)};a.prototype.updateTail=function(a,b){var c=this.tail;b=b||(""===b?"":c.raw);a&&0<a.length&&(c.transformDistributions.push(a),this.searchSpace&&this.searchSpace.forEach(function(b){return b.addInput(a)}));
c.raw=b};a.prototype.toRawTokenization=function(){var a,c=[];try{for(var d=b(this.tokens),f=d.next();!f.done;f=d.next()){var l=f.value;null!==l.currentText&&c.push(l.currentText)}}catch(S){var e={error:S}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(e)throw e.error;}}return c};return a}();d.TrackedContextState=g;l=function(b){function l(){return null!==b&&b.apply(this,arguments)||this}q(l,b);l.attemptMatchContext=function(a,b,c){var f=b.toRawTokenization();f=d.ClassicalDistanceCalculation.computeDistance(f.map(function(a){return{key:a}}),
a.map(function(a){return{key:a}}),1).editPath();var l=!1,h=!1;if(1<f.length){if("insert"==f[0]&&("substitute"!=f[1]||2!=f.length)||0<=f[0].indexOf("transpose"))return null;"delete"==f[0]&&(l=!0)}var q=f.length-1,k=!1;if("delete"==f[q]||0<=f[0].indexOf("transpose"))return null;"insert"==f[q]?h=!0:0<q&&"insert"==f[q-1]&&"substitute"==f[q]&&(k=h=!0);if(0<q&&"delete"==f[q-1]&&"substitute"==f[q])return null;for(var w=1;w<f.length-(k?2:1);w++)if("match"!=f[w])return null;h&&(k&&(b.tail.replacementText=
a[a.length-2]),b=new g(b));(k=c&&Array.isArray(c)?c[0].sample:null)&&""==k.insert&&0==k.deleteLeft&&!k.deleteRight&&(k=null);w=k&&""==k.insert&&0<k.deleteLeft&&!k.deleteRight;var n=a[a.length-1];1<f.length?(l&&b.popHead(),h?(b.pushWhitespaceToTail(c),a=new e,a.raw="",a.transformDistributions=[],b.pushTail(a)):w?b.replaceTailForBackspace(n,k.id):b.updateTail(k?c:null,n)):"insert"==f[q]?(f=new e,f.raw=a[0],f.transformDistributions=[c],b.pushTail(f)):w?b.replaceTailForBackspace(n,k.id):b.updateTail(k?
c:null,n);return b};l.modelContextState=function(a,b){a=a.map(function(a){var b=new e;b.raw=a;b.transformDistributions=b.raw?f(b.raw).map(function(a){return[{sample:a,p:1}]}):[];return b});b=new g(b);for(0<a.length&&b.pushTail(a.splice(0,1)[0]);0<a.length;)b.pushWhitespaceToTail(),b.pushTail(a.splice(0,1)[0]);0==b.tokens.length&&(a=new e,a.raw="",b.pushTail(a));return b};l.prototype.analyzeState=function(b,d,f){if(!b.traverseFromRoot)throw"This lexical model does not provide adequate data for correction algorithms and context reuse";
var e=a.tokenize(b.wordbreaker||c.default,d);if(0<e.left.length)for(var g=this.count-1;0<=g;g--){var h=l.attemptMatchContext(e.left,this.item(g),f);if(h)return h.taggedContext=d,h!=this.item(g)&&this.enqueue(h),h}b=l.modelContextState(e.left,b);b.taggedContext=d;this.enqueue(b);return b};return l}(function(){function a(b){void 0===b&&(b=a.DEFAULT_ARRAY_SIZE);this.currentTail=this.currentHead=0;this.circle=Array(b)}Object.defineProperty(a.prototype,"count",{get:function(){var a=this.currentHead-this.currentTail;
0>a&&(a+=this.circle.length);return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxCount",{get:function(){return this.circle.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"oldest",{get:function(){if(0!=this.count)return this.item(0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"newest",{get:function(){if(0!=this.count)return this.item(this.count-1)},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){var b=null,
c=(this.currentHead+1)%this.maxCount;c==this.currentTail&&(b=this.circle[this.currentTail],this.currentTail=(this.currentTail+1)%this.maxCount);this.circle[this.currentHead]=a;this.currentHead=c;return b};a.prototype.dequeue=function(){if(this.currentTail==this.currentHead)return null;var a=this.circle[this.currentTail];this.currentTail=(this.currentTail+1)%this.maxCount;return a};a.prototype.popNewest=function(){if(this.currentTail==this.currentHead)return null;var a=this.circle[this.currentHead];
this.currentHead=(this.currentHead-1+this.maxCount)%this.maxCount;return a};a.prototype.item=function(a){if(a>=this.count)throw"Invalid array index";return this.circle[(this.currentTail+a)%this.maxCount]};a.DEFAULT_ARRAY_SIZE=5;return a}());d.ContextTracker=l})(l||(l={}));var w=this&&this.__assign||function(){w=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&(a[f]=b[f])}return a};return w.apply(this,arguments)},
D=function(){function d(a){this.SUGGESTION_ID_SEED=0;this.lexicalModel=a;a.traverseFromRoot&&(this.contextTracker=new l.ContextTracker);this.punctuation=d.determinePunctuationFromModel(a)}d.prototype.isWhitespace=function(a){if(""==a.insert)return!1;a=a.insert;a=a.replace(/.*[\u0009\u000A\u000D\u0020\u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u202f\u205f\u3000]/i,"");return""==a};d.prototype.isBackspace=function(a){return""==a.insert&&0<a.deleteLeft};
d.prototype.isEmpty=function(a){return""==a.insert&&0==a.deleteLeft};d.prototype.predictFromCorrections=function(a,c){var d,f=[],l=function(a){var b=e.lexicalModel.predict(a.sample,c).map(function(b){var c=a.sample,d=a.p;void 0!==c.id&&(b.sample.transformId=c.id);return{sample:b.sample,p:b.p*d}},e);f=f.concat(b)},e=this;try{for(var g=b(a),h=g.next();!h.done;h=g.next())l(h.value)}catch(Y){var q={error:Y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(q)throw q.error;}}return f};d.prototype.predict=
function(c,f){var l,e,g=[],h=this.lexicalModel,q=this.punctuation;c instanceof Array?0==c.length&&c.push({sample:{insert:"",deleteLeft:0},p:1}):c=[{sample:c,p:1}];var k=c.sort(function(a,b){return b.p-a.p})[0].sample,n=this.isWhitespace(k),D=this.isBackspace(k),u=a.applyTransform(k,f),v=this.wordbreak(u),t=null,z=[],T=null;if(this.contextTracker){T=this.contextTracker.analyzeState(this.lexicalModel,u,this.isEmpty(k)?null:c);c=T.searchSpace[0];var V=!1,O=T.tokens;if(0==O.length||O[O.length-1].isNew)if(this.isEmpty(k)||
this.isWhitespace(k)){V=!0;var E=k;f=u}O=void 0;try{for(var K=b(c.getBestMatches()),W=K.next();!W.done;W=K.next()){var Z=W.value;pa=Z.map(function(a){var b=a.matchString,c=0;V||(c=D?this.wordbreak(u).kmwLength()+k.deleteLeft:this.wordbreak(f).kmwLength());return{sample:{insert:b,deleteLeft:c,id:k.id},p:Math.exp(-a.totalCost)}},this);var ha=this.predictFromCorrections(pa,f);0<ha.length&&void 0===O&&(O=-Math.log(pa[0].p));z=z.concat(ha);var aa=Z[0].totalCost;if(aa>=O+8)break;else if(z.length>=d.MAX_SUGGESTIONS)if(aa>=
O+4)break;else if(z.sort(function(a,b){return b.p-a.p}),z[d.MAX_SUGGESTIONS-1].p>Math.exp(-aa))break}}catch(sa){var F={error:sa}}finally{try{W&&!W.done&&(l=K.return)&&l.call(K)}finally{if(F)throw F.error;}}}else{var pa=void 0;n?(pa=[{sample:k,p:1}],E=k):pa=c.map(function(a){var b=a.sample;return this.isWhitespace(b)&&!n||this.isBackspace(b)&&!D?null:a},this);pa=pa.filter(function(a){return!!a});z=this.predictFromCorrections(pa,f)}F={};l=null;h.languageUsesCasing&&(l=this.detectCurrentCasing(u));h=
this.wordbreak(f);try{for(var da=b(z),ba=da.next();!ba.done;ba=da.next()){var ea=ba.value,B=ea.sample.displayAs;z=B==v;this.lexicalModel.languageUsesCasing&&(z=z||B==this.lexicalModel.applyCasing("lower",v));if(z)if(t)t.p&&ea.p&&(t.p+=ea.p);else{var ra=ea.sample.transform,I={insert:v,deleteLeft:ra.deleteLeft,deleteRight:ra.deleteRight,id:ra.id},ya=a.transformToSuggestion(I,ea.p);t=this.toAnnotatedSuggestion(ya,"keep",a.QuoteBehavior.noQuotes);t.matchesModel=!0;t.transformId=ea.sample.transformId}else{l&&
"lower"!=l&&(this.applySuggestionCasing(ea.sample,h,l),B=ea.sample.displayAs);var ca=F[B];ca?ca.p+=ea.p:F[B]=ea}}}catch(sa){var fa={error:sa}}finally{try{ba&&!ba.done&&(e=da.return)&&e.call(da)}finally{if(fa)throw fa.error;}}t||""==v||(I=w({},k),t=a.transformToSuggestion(I,1),t.displayAs=v,t=this.toAnnotatedSuggestion(t,"keep"),t.matchesModel=!1);for(var Ka in F)g.push(F[Ka]);g=g.sort(function(a,b){return b.p-a.p});g=g.splice(0,d.MAX_SUGGESTIONS).map(function(a){a.sample.p&&(a.sample["lexical-p"]=
a.sample.p,a.sample["correction-p"]=a.p/a.sample.p,a.sample.p=a.p);return a.sample});t&&(g=[t].concat(g));var La=this;g.forEach(function(b){if(f.right){var c=La.tokenize(f);c&&c.caretSplitsToken&&(b.transform.insert+=q.insertAfterWord)}else b.transform.insert+=q.insertAfterWord;E&&(c=a.buildMergedTransform(E,b.transform),c.id=b.transformId,b.transform=c);b.id=La.SUGGESTION_ID_SEED;La.SUGGESTION_ID_SEED++});T&&(T.tail.replacements=g.map(function(a){return{suggestion:a,tokenWidth:1}}));return g};d.prototype.applySuggestionCasing=
function(a,b,c){var d=b.kmwLength()-a.transform.deleteLeft;0<d&&(a.transform.deleteLeft+=d,a.transform.insert=b.kmwSubstr(0,d)+a.transform.insert);a.transform.insert=this.lexicalModel.applyCasing(c,a.transform.insert);a.displayAs=this.lexicalModel.applyCasing(c,a.displayAs)};d.prototype.toAnnotatedSuggestion=function(b,c,d){void 0===d&&(d=a.QuoteBehavior.default);var f=a.QuoteBehavior,l=f.noQuotes;if("keep"==c||"revert"==c)l=f.useQuotes;return{transform:b.transform,transformId:b.transformId,displayAs:f.apply(d,
b.displayAs,this.punctuation,l),tag:c,p:b.p}};d.determinePunctuationFromModel=function(a){var b=u;if(!a.punctuation)return b;a=a.punctuation;var c=a.insertAfterWord;""===c||c||(c=b.insertAfterWord);var d=a.quotesForKeepSuggestion;d||(d=b.quotesForKeepSuggestion);return{insertAfterWord:c,quotesForKeepSuggestion:d,isRTL:a.isRTL}};d.prototype.acceptSuggestion=function(b,c,d){var f=b.transform,l=c.left.kmwSubstr(-f.deleteLeft,f.deleteLeft);f=f.insert.kmwLength();l={insert:l,deleteLeft:f};f=c;d&&(l=a.buildMergedTransform(l,
d),f=a.applyTransform(d,f));var e=this.tokenize(f);e?(d=0<e.left.length?e.left[e.left.length-1]:"",d+=e.caretSplitsToken?e.right[0]:""):d=this.wordbreak(f);l=a.transformToSuggestion(l);l.displayAs=d;d=this.toAnnotatedSuggestion(l,"revert");null!=b.transformId&&(d.transformId=-b.transformId);null!=b.id?d.id=-b.id:(d.id=-this.SUGGESTION_ID_SEED,this.SUGGESTION_ID_SEED++);this.contextTracker&&((l=this.contextTracker.newest)||(l=this.contextTracker.analyzeState(this.lexicalModel,c)),l.tail.activeReplacementId=
b.id,b=a.applyTransform(b.transform,c),this.contextTracker.analyzeState(this.lexicalModel,b));return d};d.prototype.applyReversion=function(b,c){var d=this,f=function(){var f=a.applyTransform(b.transform,c);f=d.predict({insert:"",deleteLeft:0},f);f.forEach(function(a){a.transformId=-b.transformId});return f};if(!this.contextTracker)return f();for(var l=!1,e=this.contextTracker.count-1;0<=e;e--)if(this.contextTracker.item(e).tail.activeReplacementId==-b.id){l=!0;break}if(!l)return f();for(;this.contextTracker.newest.tail.activeReplacementId!=
-b.id;)this.contextTracker.popNewest();this.contextTracker.newest.tail.revert();f=this.contextTracker.newest.tail.replacements.map(function(a){return a.suggestion});f.forEach(function(a){a.transformId=-b.transformId});return f};d.prototype.wordbreak=function(b){var d=this.lexicalModel;return d.wordbreaker||!d.wordbreak?a.wordbreak(d.wordbreaker||c.default,b):d.wordbreak(b)};d.prototype.tokenize=function(b){var c=this.lexicalModel;return c.wordbreaker?a.tokenize(c.wordbreaker,b):null};d.prototype.resetContext=
function(b){this.contextTracker&&(b=a.tokenize(this.lexicalModel.wordbreaker||c.default,b),b=l.ContextTracker.modelContextState(b.left,this.lexicalModel),this.contextTracker.enqueue(b))};d.prototype.detectCurrentCasing=function(a){var b,c=this.lexicalModel,d=this.wordbreak(a);if(!c.languageUsesCasing)throw"Invalid attempt to detect casing: languageUsesCasing is set to false";if(!c.applyCasing)throw"Invalid LMLayer state:  languageUsesCasing is set to true, but no applyCasing function exists";return"upper"==
a.casingForm||"initial"==a.casingForm?a.casingForm:c.applyCasing("lower",d)==d?"lower":c.applyCasing("upper",d)==d?1<d.kmwLength()?"upper":"initial":c.applyCasing("initial",d)==d?"initial":null!==(b=a.casingForm)&&void 0!==b?b:null};d.MAX_SUGGESTIONS=12;return d}(),u={quotesForKeepSuggestion:{open:"\u201c",close:"\u201d"},insertAfterWord:" "};e=function(){function b(a){void 0===a&&(a={importScripts:null,postMessage:null});this._postMessage=a.postMessage||postMessage;this._importScripts=a.importScripts||
importScripts;this.setupConfigState()}b.prototype.error=function(a,b){this.cast("error",{log:a,error:b&&b.stack?b.stack:void 0})};b.prototype.onMessage=function(a){if(!a.data.message)throw Error("Missing required 'message' property: "+a.data);a=a.data;if("load"==a.message){var b=!1;this._currentModelSource&&a.source.type==this._currentModelSource.type&&("file"==a.source.type&&a.source.file==this._currentModelSource.file?b=!0:"raw"==a.source.type&&a.source.code==this._currentModelSource.code&&(b=!0));
if(b){"undefined"!==typeof console&&console.warn("Duplicate model load message detected - squashing!");return}this._currentModelSource=a.source}else"unload"==a.message&&(this._currentModelSource=null);this.state.handleMessage(a)};b.prototype.cast=function(a,b){var c=this._postMessage;c(w({message:a},b))};b.prototype.loadModel=function(b){try{var c=b.configure(this._platformCapabilities);c.leftContextCodePoints||(c.leftContextCodePoints=c.leftContextCodeUnits);c.rightContextCodePoints||(c.rightContextCodePoints=
c.rightContextCodeUnits);c.leftContextCodePoints||(c.leftContextCodePoints=this._platformCapabilities.maxLeftContextCodePoints);c.rightContextCodePoints||(c.rightContextCodePoints=this._platformCapabilities.maxRightContextCodePoints||0);b.languageUsesCasing&&!b.applyCasing&&(b.applyCasing=a.defaultApplyCasing);var d=this.transitionToReadyState(b);void 0===c.wordbreaksAfterSuggestions&&(c.wordbreaksAfterSuggestions=""!=d.punctuation.insertAfterWord);this.cast("ready",{configuration:c})}catch(y){this.error("loadModel failed!",
y)}};b.prototype.loadModelFile=function(a){try{this._importScripts(a)}catch(z){this.error("Error occurred when attempting to load dictionary",z)}};b.prototype.unloadModel=function(){this.transitionToLoadingState()};b.prototype.setupConfigState=function(){var a=this;this.state={name:"unconfigured",handleMessage:function(b){if("config"!==b.message)throw Error("invalid message; expected 'config' but got "+b.message);a._platformCapabilities=b.capabilities;a.transitionToLoadingState()}}};b.prototype.transitionToLoadingState=
function(){var b=this;this.state={name:"modelless",handleMessage:function(d){if("load"!==d.message)throw Error("invalid message; expected 'load' but got "+d.message);if("file"==d.source.type)b.loadModelFile(d.source.file);else{var f=d.source.code;(function(a,b,c,d){eval(f)})(b,a,l,c)}}}};b.prototype.transitionToReadyState=function(b){var d=this,f=new D(b);this.state={name:"ready",handleMessage:function(l){switch(l.message){case "predict":var e=l.context;e=f.predict(l.transform,e);d.cast("suggestions",
{token:l.token,suggestions:e});break;case "wordbreak":e=a.wordbreak(b.wordbreaker||c.default,l.context);d.cast("currentword",{token:l.token,word:e});break;case "unload":d.unloadModel();break;case "accept":var g=l.suggestion;e=l.context;g=f.acceptSuggestion(g,e,l.postTransform);d.cast("postaccept",{token:l.token,reversion:g});break;case "revert":g=l.reversion;e=l.context;e=f.applyReversion(g,e);d.cast("postrevert",{token:l.token,suggestions:e});break;case "reset-context":e=l.context;f.resetContext(e);
break;default:throw Error("invalid message; expected one of {'predict', 'wordbreak', 'accept', 'revert', 'reset-context', 'unload'} but got "+l.message);}},compositor:f};return f};b.install=function(d){var f=new b({postMessage:d.postMessage,importScripts:d.importScripts.bind(d)});d.onmessage=f.onMessage.bind(f);f.self=d;d.LMLayerWorker=f;d.models=a;d.correction=l;d.wordBreakers=c;return f};return b}();"undefined"!==typeof module&&"undefined"!==typeof module.exports?(module.exports=e,module.exports.correction=
l,module.exports.models=a,module.exports.wordBreakers=c,module.exports.ModelCompositor=D):"undefined"!==typeof self&&"postMessage"in self?e.install(self):window.LMLayerWorker=e}
(function(g,k){"function"===typeof define&&define.amd?define(k):"object"===typeof exports?module.exports=k():g.returnExports=k()})(this,function(){var g=Function.call.bind(Function.apply),k=Function.call.bind(Function.call),h=Array.isArray,n=Object.keys,e=function(a){try{return a(),!1}catch(C){return!0}},b=function(a){try{return a()}catch(C){return!1}},a=function(a){return function(){return!g(a,this,arguments)}}(e),c=function(){return!e(function(){return Object.defineProperty({},"x",{get:function(){}})})},
d=!!Object.defineProperty&&c(),f="foo"===function(){}.name,l=Function.call.bind(Array.prototype.forEach),q=Function.call.bind(Array.prototype.reduce),w=Function.call.bind(Array.prototype.filter),D=Function.call.bind(Array.prototype.some),u=function(a,b,c,f){!f&&b in a||(d?Object.defineProperty(a,b,{configurable:!0,enumerable:!1,writable:!0,value:c}):a[b]=c)},t=function(a,b,c){l(n(b),function(d){u(a,d,b[d],!!c)})},v=Function.call.bind(Object.prototype.toString),z="function"===typeof/abc/?function(a){return"function"===
typeof a&&"[object Function]"===v(a)}:function(a){return"function"===typeof a},r={getter:function(a,b,c){if(!d)throw new TypeError("getters require true ES5 support");Object.defineProperty(a,b,{configurable:!0,enumerable:!1,get:c})},proxy:function(a,b,c){if(!d)throw new TypeError("getters require true ES5 support");var f=Object.getOwnPropertyDescriptor(a,b);Object.defineProperty(c,b,{configurable:f.configurable,enumerable:f.enumerable,get:function(){return a[b]},set:function(c){a[b]=c}})},redefine:function(a,
b,c){if(d){var f=Object.getOwnPropertyDescriptor(a,b);f.value=c;Object.defineProperty(a,b,f)}else a[b]=c},defineByDescriptor:function(a,b,c){d?Object.defineProperty(a,b,c):"value"in c&&(a[b]=c.value)},preserveToString:function(a,b){b&&z(b.toString)&&u(a,"toString",b.toString.bind(b),!0)}},y=Object.create||function(a,b){var c=function(){};c.prototype=a;var d=new c;"undefined"!==typeof b&&n(b).forEach(function(a){r.defineByDescriptor(d,a,b[a])});return d},A=function(a,c){return Object.setPrototypeOf?
b(function(){var b=function xa(b){b=new a(b);Object.setPrototypeOf(b,xa.prototype);return b};Object.setPrototypeOf(b,a);b.prototype=y(a.prototype,{constructor:{value:b}});return c(b)}):!1},p=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),H=p.isFinite,qa=Function.call.bind(String.prototype.indexOf),wa=Function.apply.bind(Array.prototype.indexOf),Y=Function.call.bind(Array.prototype.concat),
N=Function.call.bind(String.prototype.slice),S=Function.call.bind(Array.prototype.push),Xb=Function.apply.bind(Array.prototype.push),Yb=Function.call.bind(Array.prototype.shift),T=Math.max,V=Math.min,O=Math.floor,E=Math.abs,K=Math.exp,W=Math.log,Z=Math.sqrt,ha=Function.call.bind(Object.prototype.hasOwnProperty),aa=function(){},F=p.Map,pa=F&&F.prototype["delete"],da=F&&F.prototype.get,ba=F&&F.prototype.has,ea=F&&F.prototype.set,B=p.Symbol||{},ra=B.species||"@@species",I=Number.isNaN||function(a){return a!==
a},ya=Number.isFinite||function(a){return"number"===typeof a&&H(a)},ca=z(Math.sign)?Math.sign:function(a){a=Number(a);return 0===a||I(a)?a:0>a?-1:1},fa=function(a){a=Number(a);return-1>a||I(a)?NaN:0===a||Infinity===a?a:-1===a?-Infinity:0===1+a-1?a:a*(W(1+a)/(1+a-1))},Ka=function(a){return"[object Arguments]"===v(a)},La=function(a){return null!==a&&"object"===typeof a&&"number"===typeof a.length&&0<=a.length&&"[object Array]"!==v(a)&&"[object Function]"===v(a.callee)},sa=Ka(arguments)?Ka:La,G={primitive:function(a){return null===
a||"function"!==typeof a&&"object"!==typeof a},string:function(a){return"[object String]"===v(a)},regex:function(a){return"[object RegExp]"===v(a)},symbol:function(a){return"function"===typeof p.Symbol&&"symbol"===typeof a}},x=function(a,b,c){var d=a[b];u(a,b,c,!0);r.preserveToString(a[b],d)},ta="function"===typeof B&&"function"===typeof B["for"]&&G.symbol(B()),P=G.symbol(B.iterator)?B.iterator:"_es6-shim iterator_";p.Set&&"function"===typeof(new p.Set)["@@iterator"]&&(P="@@iterator");p.Reflect||
u(p,"Reflect",{},!0);var ia=p.Reflect,Ma=String,Na="undefined"!==typeof document&&document?document.all:null,U=null==Na?function(a){return null==a}:function(a){return null==a&&a!==Na},m={Call:function(a,b){var c=2<arguments.length?arguments[2]:[];if(!m.IsCallable(a))throw new TypeError(a+" is not a function");return g(a,b,c)},RequireObjectCoercible:function(a,b){if(U(a))throw new TypeError(b||"Cannot call method on "+a);return a},TypeIsObject:function(a){return void 0===a||null===a||!0===a||!1===
a?!1:"function"===typeof a||"object"===typeof a||a===Na},ToObject:function(a,b){return Object(m.RequireObjectCoercible(a,b))},IsCallable:z,IsConstructor:function(a){return m.IsCallable(a)},ToInt32:function(a){return m.ToNumber(a)>>0},ToUint32:function(a){return m.ToNumber(a)>>>0},ToNumber:function(a){if("[object Symbol]"===v(a))throw new TypeError("Cannot convert a Symbol value to a number");return+a},ToInteger:function(a){a=m.ToNumber(a);return I(a)?0:0!==a&&ya(a)?(0<a?1:-1)*O(E(a)):a},ToLength:function(a){a=
m.ToInteger(a);return 0>=a?0:a>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a},SameValue:function(a,b){return a===b?0===a?1/a===1/b:!0:I(a)&&I(b)},SameValueZero:function(a,b){return a===b||I(a)&&I(b)},IsIterable:function(a){return m.TypeIsObject(a)&&("undefined"!==typeof a[P]||sa(a))},GetIterator:function(a){if(sa(a))return new ja(a,"value");var b=m.GetMethod(a,P);if(!m.IsCallable(b))throw new TypeError("value is not an iterable");a=m.Call(b,a);if(!m.TypeIsObject(a))throw new TypeError("bad iterator");
return a},GetMethod:function(a,b){a=m.ToObject(a)[b];if(!U(a)){if(!m.IsCallable(a))throw new TypeError("Method not callable: "+b);return a}},IteratorComplete:function(a){return!!a.done},IteratorClose:function(a,b){var c=m.GetMethod(a,"return");if(void 0!==c){try{var d=m.Call(c,a)}catch(xa){var f=xa}if(!b){if(f)throw f;if(!m.TypeIsObject(d))throw new TypeError("Iterator's return method returned a non-object.");}}},IteratorNext:function(a){var b=1<arguments.length?a.next(arguments[1]):a.next();if(!m.TypeIsObject(b))throw new TypeError("bad iterator");
return b},IteratorStep:function(a){a=m.IteratorNext(a);return m.IteratorComplete(a)?!1:a},Construct:function(a,b,c,d){c="undefined"===typeof c?a:c;if(!d&&ia.construct)return ia.construct(a,b,c);d=c.prototype;m.TypeIsObject(d)||(d=Object.prototype);d=y(d);a=m.Call(a,d,b);return m.TypeIsObject(a)?a:d},SpeciesConstructor:function(a,b){a=a.constructor;if(void 0===a)return b;if(!m.TypeIsObject(a))throw new TypeError("Bad constructor");a=a[ra];if(U(a))return b;if(!m.IsConstructor(a))throw new TypeError("Bad @@species");
return a},CreateHTML:function(a,b,c,d){a=m.ToString(a);var f="<"+b;""!==c&&(d=m.ToString(d).replace(/"/g,"&quot;"),f+=" "+c+'="'+d+'"');return f+">"+a+"</"+b+">"},IsRegExp:function(a){if(!m.TypeIsObject(a))return!1;var b=a[B.match];return"undefined"!==typeof b?!!b:G.regex(a)},ToString:function(a){return Ma(a)}};if(d&&ta){var za=function(a){if(G.symbol(B[a]))return B[a];var b=B["for"]("Symbol."+a);Object.defineProperty(B,a,{configurable:!1,enumerable:!1,writable:!1,value:b});return b};if(!G.symbol(B.search)){var fb=
za("search"),gb=String.prototype.search;u(RegExp.prototype,fb,function(a){return m.Call(gb,a,[this])});x(String.prototype,"search",function(a){var b=m.RequireObjectCoercible(this);if(!U(a)){var c=m.GetMethod(a,fb);if("undefined"!==typeof c)return m.Call(c,a,[b])}return m.Call(gb,b,[m.ToString(a)])})}if(!G.symbol(B.replace)){var hb=za("replace"),ib=String.prototype.replace;u(RegExp.prototype,hb,function(a,b){return m.Call(ib,a,[this,b])});x(String.prototype,"replace",function(a,b){var c=m.RequireObjectCoercible(this);
if(!U(a)){var d=m.GetMethod(a,hb);if("undefined"!==typeof d)return m.Call(d,a,[c,b])}return m.Call(ib,c,[m.ToString(a),b])})}if(!G.symbol(B.split)){var jb=za("split"),kb=String.prototype.split;u(RegExp.prototype,jb,function(a,b){return m.Call(kb,a,[this,b])});x(String.prototype,"split",function(a,b){var c=m.RequireObjectCoercible(this);if(!U(a)){var d=m.GetMethod(a,jb);if("undefined"!==typeof d)return m.Call(d,a,[c,b])}return m.Call(kb,c,[m.ToString(a),b])})}var lb=G.symbol(B.match),Zb=lb&&function(){var a=
{};a[B.match]=function(){return 42};return 42!=="a".match(a)}();if(!lb||Zb){var mb=za("match"),nb=String.prototype.match;u(RegExp.prototype,mb,function(a){return m.Call(nb,a,[this])});x(String.prototype,"match",function(a){var b=m.RequireObjectCoercible(this);if(!U(a)){var c=m.GetMethod(a,mb);if("undefined"!==typeof c)return m.Call(c,a,[b])}return m.Call(nb,b,[m.ToString(a)])})}}var ob=function(a,b,c){r.preserveToString(b,a);Object.setPrototypeOf&&Object.setPrototypeOf(a,b);d?l(Object.getOwnPropertyNames(a),
function(d){d in aa||c[d]||r.proxy(a,d,b)}):l(Object.keys(a),function(d){d in aa||c[d]||(b[d]=a[d])});b.prototype=a.prototype;r.redefine(a.prototype,"constructor",b)},$b=function(){return this},ua=function(a){d&&!ha(a,ra)&&r.getter(a,ra,$b)},Q=function(a,b){b=b||function(){return this};u(a,P,b);!a[P]&&G.symbol(P)&&(a[P]=b)},pb=function(a,b,c){d?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,writable:!0,value:c}):a[b]=c;if(!m.SameValue(a[b],c))throw new TypeError("property is nonconfigurable");
},Oa=function(a,b,c,d){if(!m.TypeIsObject(a))throw new TypeError("Constructor requires `new`: "+b.name);a=b.prototype;m.TypeIsObject(a)||(a=c);c=y(a);for(var f in d)ha(d,f)&&u(c,f,d[f],!0);return c};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var ac=String.fromCodePoint;x(String,"fromCodePoint",function(a){return m.Call(ac,this,arguments)})}var qb={fromCodePoint:function(a){for(var b=[],c,d=0,f=arguments.length;d<f;d++){c=Number(arguments[d]);if(!m.SameValue(c,m.ToInteger(c))||0>c||
1114111<c)throw new RangeError("Invalid code point "+c);65536>c?S(b,String.fromCharCode(c)):(c-=65536,S(b,String.fromCharCode((c>>10)+55296)),S(b,String.fromCharCode(c%1024+56320)))}return b.join("")},raw:function(a){var b=m.ToObject(a,"bad callSite");b=m.ToObject(b.raw,"bad raw value");var c=m.ToLength(b.length);if(0>=c)return"";for(var d=[],f=0,l;f<c;){l=m.ToString(f);l=m.ToString(b[l]);S(d,l);if(f+1>=c)break;l=f+1<arguments.length?arguments[f+1]:"";l=m.ToString(l);S(d,l);f+=1}return d.join("")}};
String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&x(String,"raw",qb.raw);t(String,qb);var bc=function Ia(a,b){if(1>b)return"";if(b%2)return Ia(a,b-1)+a;a=Ia(a,b/2);return a+a},ka={repeat:function(a){var b=m.ToString(m.RequireObjectCoercible(this));a=m.ToInteger(a);if(0>a||Infinity<=a)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return bc(b,a)},startsWith:function(a){var b=m.ToString(m.RequireObjectCoercible(this));if(m.IsRegExp(a))throw new TypeError('Cannot call method "startsWith" with a regex');
var c=m.ToString(a),d;1<arguments.length&&(d=arguments[1]);d=T(m.ToInteger(d),0);return N(b,d,d+c.length)===c},endsWith:function(a){var b=m.ToString(m.RequireObjectCoercible(this));if(m.IsRegExp(a))throw new TypeError('Cannot call method "endsWith" with a regex');var c=m.ToString(a),d=b.length,f;1<arguments.length&&(f=arguments[1]);f="undefined"===typeof f?d:m.ToInteger(f);d=V(T(f,0),d);return N(b,d-c.length,d)===c},includes:function(a){if(m.IsRegExp(a))throw new TypeError('"includes" does not accept a RegExp');
var b=m.ToString(a),c;1<arguments.length&&(c=arguments[1]);return-1!==qa(this,b,c)},codePointAt:function(a){var b=m.ToString(m.RequireObjectCoercible(this)),c=m.ToInteger(a),d=b.length;if(0<=c&&c<d){a=b.charCodeAt(c);if(55296>a||56319<a||c+1===d)return a;b=b.charCodeAt(c+1);return 56320>b||57343<b?a:1024*(a-55296)+(b-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&x(String.prototype,"includes",ka.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var cc=
e(function(){return"/a/".startsWith(/a/)}),dc=b(function(){return!1==="abc".startsWith("a",Infinity)});cc&&dc||(x(String.prototype,"startsWith",ka.startsWith),x(String.prototype,"endsWith",ka.endsWith))}ta&&(b(function(){var a=/a/;a[B.match]=!1;return"/a/".startsWith(a)})||x(String.prototype,"startsWith",ka.startsWith),b(function(){var a=/a/;a[B.match]=!1;return"/a/".endsWith(a)})||x(String.prototype,"endsWith",ka.endsWith),b(function(){var a=/a/;a[B.match]=!1;return"/a/".includes(a)})||x(String.prototype,
"includes",ka.includes));t(String.prototype,ka);var ec=/(^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)/g,rb=function(){return m.ToString(m.RequireObjectCoercible(this)).replace(ec,"")},sb=/[\u0085\u200b\ufffe]/g,tb=/^[-+]0x[0-9a-f]+$/i;u(String.prototype,"trim",rb,!0);
var la=function(a){return{value:a,done:0===arguments.length}},Pa=function(a){m.RequireObjectCoercible(a);this._s=m.ToString(a);this._i=0};Pa.prototype.next=function(){var a=this._s,b=this._i;if("undefined"===typeof a||b>=a.length)return this._s=void 0,la();var c=a.charCodeAt(b);55296>c||56319<c||b+1===a.length?c=1:(c=a.charCodeAt(b+1),c=56320>c||57343<c?1:2);this._i=b+c;return la(a.substr(b,c))};Q(Pa.prototype);Q(String.prototype,function(){return new Pa(this)});var Aa={from:function(a){var b;1<arguments.length&&
(b=arguments[1]);var c;if("undefined"===typeof b)var d=!1;else{if(!m.IsCallable(b))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(c=arguments[2]);d=!0}var f;if("undefined"!==typeof(sa(a)||m.GetMethod(a,P))){var l=m.IsConstructor(this)?Object(new this):[];var e=m.GetIterator(a);for(f=0;;){var g=m.IteratorStep(e);if(!1===g)break;g=g.value;try{d&&(g="undefined"===typeof c?b(g,f):k(b,c,g,f)),l[f]=g}catch(fc){throw m.IteratorClose(e,!0),fc;
}f+=1}e=f}else for(g=m.ToObject(a),e=m.ToLength(g.length),l=m.IsConstructor(this)?Object(new this(e)):Array(e),f=0;f<e;++f){var h=g[f];d&&(h="undefined"===typeof c?b(h,f):k(b,c,h,f));pb(l,f,h)}l.length=e;return l},of:function(){for(var a=arguments.length,b=h(this)||!m.IsCallable(this)?Array(a):m.Construct(this,[a]),c=0;c<a;++c)pb(b,c,arguments[c]);b.length=a;return b}};t(Array,Aa);ua(Array);var ja=function(a,b){this.i=0;this.array=a;this.kind=b};t(ja.prototype,{next:function(){var a=this.i,b=this.array;
if(!(this instanceof ja))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof b)for(var c=m.ToLength(b.length);a<c;){c=this.kind;var d;"key"===c?d=a:"value"===c?d=b[a]:"entry"===c&&(d=[a,b[a]]);this.i=a+1;return la(d)}this.array=void 0;return la()}});Q(ja.prototype);Array.of===Aa.of||function(){var a=function(a){this.length=a};a.prototype=[];var b=Array.of.apply(a,[1,2]);return b instanceof a&&2===b.length}()||x(Array,"of",Aa.of);var Ta={copyWithin:function(a,b){var c=m.ToObject(this),
d=m.ToLength(c.length),f=m.ToInteger(a),l=m.ToInteger(b);f=0>f?T(d+f,0):V(f,d);l=0>l?T(d+l,0):V(l,d);var e;2<arguments.length&&(e=arguments[2]);e="undefined"===typeof e?d:m.ToInteger(e);e=0>e?T(d+e,0):V(e,d);d=V(e-l,d-f);e=1;l<f&&f<l+d&&(e=-1,l+=d-1,f+=d-1);for(;0<d;)l in c?c[f]=c[l]:delete c[f],l+=e,f+=e,--d;return c},fill:function(a){var b;1<arguments.length&&(b=arguments[1]);var c;2<arguments.length&&(c=arguments[2]);var d=m.ToObject(this),f=m.ToLength(d.length);b=m.ToInteger("undefined"===typeof b?
0:b);c=m.ToInteger("undefined"===typeof c?f:c);b=0>b?T(f+b,0):V(b,f);for(c=0>c?f+c:c;b<f&&b<c;++b)d[b]=a;return d},find:function(a){var b=m.ToObject(this),c=m.ToLength(b.length);if(!m.IsCallable(a))throw new TypeError("Array#find: predicate must be a function");for(var d=1<arguments.length?arguments[1]:null,f=0,l;f<c;f++)if(l=b[f],d){if(k(a,d,l,f,b))return l}else if(a(l,f,b))return l},findIndex:function(a){var b=m.ToObject(this),c=m.ToLength(b.length);if(!m.IsCallable(a))throw new TypeError("Array#findIndex: predicate must be a function");
for(var d=1<arguments.length?arguments[1]:null,f=0;f<c;f++)if(d){if(k(a,d,b[f],f,b))return f}else if(a(b[f],f,b))return f;return-1},keys:function(){return new ja(this,"key")},values:function(){return new ja(this,"value")},entries:function(){return new ja(this,"entry")}};Array.prototype.keys&&!m.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!m.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&
Array.prototype[P]&&(t(Array.prototype,{values:Array.prototype[P]}),G.symbol(B.unscopables)&&(Array.prototype[B.unscopables].values=!0));if(f&&Array.prototype.values&&"values"!==Array.prototype.values.name){var gc=Array.prototype.values;x(Array.prototype,"values",function(){return m.Call(gc,this,arguments)});u(Array.prototype,P,Array.prototype.values,!0)}t(Array.prototype,Ta);0>1/[!0].indexOf(!0,-0)&&u(Array.prototype,"indexOf",function(a){var b=wa(this,arguments);return 0===b&&0>1/b?0:b},!0);Q(Array.prototype,
function(){return this.values()});Object.getPrototypeOf&&Q(Object.getPrototypeOf([].values()));var hc=function(){return b(function(){return 0===Array.from({length:-1}).length})}(),ic=function(){var a=Array.from([0].entries());return 1===a.length&&h(a[0])&&0===a[0][0]&&0===a[0][1]}();hc&&ic||x(Array,"from",Aa.from);if(!function(){return b(function(){return Array.from([0],void 0)})}()){var ub=Array.from;x(Array,"from",function(a){return 1<arguments.length&&"undefined"!==typeof arguments[1]?m.Call(ub,
this,arguments):k(ub,this,a)})}var jc=-(Math.pow(2,32)-1),ma=function(a,c){var d={length:jc};d[c?(d.length>>>0)-1:0]=!0;return b(function(){k(a,d,function(){throw new RangeError("should not reach here");},[]);return!0})};if(!ma(Array.prototype.forEach)){var kc=Array.prototype.forEach;x(Array.prototype,"forEach",function(a){return m.Call(kc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.map)){var lc=Array.prototype.map;x(Array.prototype,"map",function(a){return m.Call(lc,0<=this.length?
this:[],arguments)},!0)}if(!ma(Array.prototype.filter)){var mc=Array.prototype.filter;x(Array.prototype,"filter",function(a){return m.Call(mc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.some)){var nc=Array.prototype.some;x(Array.prototype,"some",function(a){return m.Call(nc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.every)){var oc=Array.prototype.every;x(Array.prototype,"every",function(a){return m.Call(oc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.reduce)){var pc=
Array.prototype.reduce;x(Array.prototype,"reduce",function(a){return m.Call(pc,0<=this.length?this:[],arguments)},!0)}if(!ma(Array.prototype.reduceRight,!0)){var qc=Array.prototype.reduceRight;x(Array.prototype,"reduceRight",function(a){return m.Call(qc,0<=this.length?this:[],arguments)},!0)}var rc=8!==Number("0o10"),sc=2!==Number("0b10"),tc=D("\u0085\u200b\ufffe",function(a){return 0===Number(a+0+a)});if(rc||sc||tc){var X=Number,vb=/^0b[01]+$/i,wb=/^0o[0-7]+$/i,uc=vb.test.bind(vb),vc=wb.test.bind(wb),
wc=function(a){if("function"===typeof a.valueOf){var b=a.valueOf();if(G.primitive(b))return b}if("function"===typeof a.toString&&(b=a.toString(),G.primitive(b)))return b;throw new TypeError("No default value");},xc=sb.test.bind(sb),yc=tb.test.bind(tb),Ba=function(){var a=function(c){var d=0<arguments.length?G.primitive(c)?c:wc(c,"number"):0;if("string"===typeof d)if(d=m.Call(rb,d),uc(d))d=parseInt(N(d,2),2);else if(vc(d))d=parseInt(N(d,2),8);else if(xc(d)||yc(d))d=NaN;var f=this,l=b(function(){X.prototype.valueOf.call(f);
return!0});return f instanceof a&&!l?new X(d):X(d)};return a}();ob(X,Ba,{});t(Ba,{NaN:X.NaN,MAX_VALUE:X.MAX_VALUE,MIN_VALUE:X.MIN_VALUE,NEGATIVE_INFINITY:X.NEGATIVE_INFINITY,POSITIVE_INFINITY:X.POSITIVE_INFINITY});Number=Ba;r.redefine(p,"Number",Ba)}var xb=Math.pow(2,53)-1;t(Number,{MAX_SAFE_INTEGER:xb,MIN_SAFE_INTEGER:-xb,EPSILON:2.220446049250313E-16,parseInt:p.parseInt,parseFloat:p.parseFloat,isFinite:ya,isInteger:function(a){return ya(a)&&m.ToInteger(a)===a},isSafeInteger:function(a){return Number.isInteger(a)&&
E(a)<=Number.MAX_SAFE_INTEGER},isNaN:I});u(Number,"parseInt",p.parseInt,Number.parseInt!==p.parseInt);1===[,1].find(function(){return!0})&&x(Array.prototype,"find",Ta.find);0!==[,1].findIndex(function(){return!0})&&x(Array.prototype,"findIndex",Ta.findIndex);var yb=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Ca=function(a,b){d&&yb(a,b)&&Object.defineProperty(a,b,{enumerable:!1})},zc=function(){var a=Number(this),b=arguments.length,c=b-a;c=Array(0>c?0:c);for(var d=a;d<b;++d)c[d-
a]=arguments[d];return c},zb=function(a){return function(b,c){b[c]=a[c];return b}},Ac=function(a,b){var c=n(Object(b)),d;m.IsCallable(Object.getOwnPropertySymbols)&&(d=w(Object.getOwnPropertySymbols(Object(b)),yb(b)));return q(Y(c,d||[]),zb(b),a)},Ab={assign:function(a,b){var c=m.ToObject(a,"Cannot convert undefined or null to object");return q(m.Call(zc,1,arguments),Ac,c)},is:function(a,b){return m.SameValue(a,b)}};Object.assign&&Object.preventExtensions&&function(){var a=Object.preventExtensions({1:2});
try{Object.assign(a,"xy")}catch(L){return"y"===a[1]}}()&&x(Object,"assign",Ab.assign);t(Object,Ab);if(d){var Bc={setPrototypeOf:function(a,b){var c=function(a,b){if(!m.TypeIsObject(a))throw new TypeError("cannot set prototype on a non-object");if(null!==b&&!m.TypeIsObject(b))throw new TypeError("can only set prototype to an object or null"+b);k(d,a,b);return a};try{var d=a.getOwnPropertyDescriptor(a.prototype,b).set;k(d,{},null)}catch(xa){if(a.prototype!=={}[b])return;d=function(a){this[b]=a};c.polyfill=
c(c({},null),a.prototype)instanceof a}return c}(Object,"__proto__")};t(Object,Bc)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&function(){var a=Object.create(null),b=Object.getPrototypeOf,c=Object.setPrototypeOf;Object.getPrototypeOf=function(c){c=b(c);return c===a?null:c};Object.setPrototypeOf=function(b,d){return c(b,null===d?a:d)};Object.setPrototypeOf.polyfill=!1}();if(e(function(){return Object.keys("foo")})){var Cc=
Object.keys;x(Object,"keys",function(a){return Cc(m.ToObject(a))});n=Object.keys}if(e(function(){return Object.keys(/a/g)})){var Dc=Object.keys;x(Object,"keys",function(a){if(G.regex(a)){var b=[],c;for(c in a)ha(a,c)&&S(b,c);return b}return Dc(a)});n=Object.keys}if(Object.getOwnPropertyNames&&e(function(){return Object.getOwnPropertyNames("foo")})){var Ec="object"===typeof window?Object.getOwnPropertyNames(window):[],Bb=Object.getOwnPropertyNames;x(Object,"getOwnPropertyNames",function(a){a=m.ToObject(a);
if("[object Window]"===v(a))try{return Bb(a)}catch(L){return Y([],Ec)}return Bb(a)})}if(Object.getOwnPropertyDescriptor&&e(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var Fc=Object.getOwnPropertyDescriptor;x(Object,"getOwnPropertyDescriptor",function(a,b){return Fc(m.ToObject(a),b)})}if(Object.seal&&e(function(){return Object.seal("foo")})){var Gc=Object.seal;x(Object,"seal",function(a){return m.TypeIsObject(a)?Gc(a):a})}if(Object.isSealed&&e(function(){return Object.isSealed("foo")})){var Hc=
Object.isSealed;x(Object,"isSealed",function(a){return m.TypeIsObject(a)?Hc(a):!0})}if(Object.freeze&&e(function(){return Object.freeze("foo")})){var Ic=Object.freeze;x(Object,"freeze",function(a){return m.TypeIsObject(a)?Ic(a):a})}if(Object.isFrozen&&e(function(){return Object.isFrozen("foo")})){var Jc=Object.isFrozen;x(Object,"isFrozen",function(a){return m.TypeIsObject(a)?Jc(a):!0})}if(Object.preventExtensions&&e(function(){return Object.preventExtensions("foo")})){var Kc=Object.preventExtensions;
x(Object,"preventExtensions",function(a){return m.TypeIsObject(a)?Kc(a):a})}if(Object.isExtensible&&e(function(){return Object.isExtensible("foo")})){var Lc=Object.isExtensible;x(Object,"isExtensible",function(a){return m.TypeIsObject(a)?Lc(a):!1})}if(Object.getPrototypeOf&&e(function(){return Object.getPrototypeOf("foo")})){var Mc=Object.getPrototypeOf;x(Object,"getPrototypeOf",function(a){return Mc(m.ToObject(a))})}var Nc=d&&function(){var a=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");
return a&&m.IsCallable(a.get)}();d&&!Nc&&r.getter(RegExp.prototype,"flags",function(){if(!m.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var a="";this.global&&(a+="g");this.ignoreCase&&(a+="i");this.multiline&&(a+="m");this.unicode&&(a+="u");this.sticky&&(a+="y");return a});var Oc=d&&b(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Pc=ta&&d&&function(){var a=/./;a[B.match]=!1;return RegExp(a)===a}(),Cb=b(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),
Qc=Cb&&b(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!Cb||!Qc){var Db=RegExp.prototype.toString;u(RegExp.prototype,"toString",function(){var a=m.RequireObjectCoercible(this);if(G.regex(a))return k(Db,a);var b=Ma(a.source);a=Ma(a.flags);return"/"+b+"/"+a},!0);r.preserveToString(RegExp.prototype.toString,Db)}if(d&&(!Oc||Pc)){var Rc=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,Eb=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},
Sc=function(){return this.source},Tc=m.IsCallable(Eb.get)?Eb.get:Sc,Fb=RegExp,Ua=function(){return function Ja(a,b){var c=m.IsRegExp(a);return this instanceof Ja||!c||"undefined"!==typeof b||a.constructor!==Ja?G.regex(a)?(c=m.Call(Tc,a),a="undefined"===typeof b?m.Call(Rc,a):b,new Ja(c,a)):new Fb(a,b):a}}();ob(Fb,Ua,{$input:!0});RegExp=Ua;r.redefine(p,"RegExp",Ua)}if(d){var Va={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Va),function(a){a in RegExp&&!(Va[a]in RegExp)&&
r.getter(RegExp,Va[a],function(){return RegExp[a]})})}ua(RegExp);var Da=1/Number.EPSILON,Ea=Math.pow(2,-23),Uc=Math.pow(2,127)*(2-Ea),Wa=Math.pow(2,-126),oa=Math.E,Fa=Math.LOG2E,Vc=Math.LOG10E,Gb=Number.prototype.clz;delete Number.prototype.clz;var J={acosh:function(a){var b=Number(a);if(I(b)||1>a)return NaN;if(1===b)return 0;if(Infinity===b)return b;a=1/(b*b);if(2>b)return fa(b-1+Z(1-a)*b);b/=2;return fa(b+Z(1-a)*b-1)+1/Fa},asinh:function(a){var b=Number(a);if(0===b||!H(b))return b;a=E(b);var c=
a*a;b=ca(b);return 1>a?b*fa(a+c/(Z(c+1)+1)):b*(fa(a/2+Z(1+1/c)*a/2-1)+1/Fa)},atanh:function(a){a=Number(a);if(0===a)return a;if(-1===a)return-Infinity;if(1===a)return Infinity;if(I(a)||-1>a||1<a)return NaN;var b=E(a);return ca(a)*fa(2*b/(1-b))/2},cbrt:function(a){a=Number(a);if(0===a)return a;var b=0>a;b&&(a=-a);if(Infinity===a)var c=Infinity;else c=K(W(a)/3),c=(a/(c*c)+2*c)/3;return b?-c:c},clz32:function(a){a=m.ToUint32(Number(a));return 0===a?32:Gb?m.Call(Gb,a):31-O(W(a+.5)*Fa)},cosh:function(a){a=
Number(a);if(0===a)return 1;if(I(a))return NaN;if(!H(a))return Infinity;a=K(E(a)-1);return oa/2*(a+1/(a*oa*oa))},expm1:function(a){a=Number(a);if(-Infinity===a)return-1;if(!H(a)||0===a)return a;if(.5<E(a))return K(a)-1;for(var b=a,c=0,d=1;c+b!==c;)c+=b,d+=1,b*=a/d;return c},hypot:function(a,b){for(var c=0,d=0,f=0;f<arguments.length;++f){var l=E(Number(arguments[f]));d<l?(c*=d/l*(d/l),c+=1,d=l):c+=0<l?l/d*(l/d):l}return Infinity===d?Infinity:d*Z(c)},log2:function(a){return W(a)*Fa},log10:function(a){return W(a)*
Vc},log1p:fa,sign:ca,sinh:function(a){a=Number(a);if(!H(a)||0===a)return a;var b=E(a);if(1>b)return b=Math.expm1(b),ca(a)*b*(1+1/(b+1))/2;b=K(b-1);return ca(a)*(b-1/(b*oa*oa))*(oa/2)},tanh:function(a){a=Number(a);return I(a)||0===a?a:20<=a?1:-20>=a?-1:(Math.expm1(a)-Math.expm1(-a))/(K(a)+K(-a))},trunc:function(a){a=Number(a);return 0>a?-O(-a):O(a)},imul:function(a,b){a=m.ToUint32(a);b=m.ToUint32(b);var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0},fround:function(a){var b=
Number(a);if(0===b||Infinity===b||-Infinity===b||I(b))return b;a=ca(b);b=E(b);if(b<Wa)return a*(b/Wa/Ea+Da-Da)*Wa*Ea;var c=(1+Ea/Number.EPSILON)*b;b=c-(c-b);return b>Uc||I(b)?Infinity*a:a*b}};t(Math,J);u(Math,"sinh",J.sinh,Infinity===Math.sinh(710));u(Math,"cosh",J.cosh,Infinity===Math.cosh(710));u(Math,"log1p",J.log1p,-1E-17!==Math.log1p(-1E-17));u(Math,"asinh",J.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));u(Math,"asinh",J.asinh,Infinity===Math.asinh(1E300));u(Math,"atanh",J.atanh,0===Math.atanh(1E-300));
u(Math,"tanh",J.tanh,-2E-17!==Math.tanh(-2E-17));u(Math,"acosh",J.acosh,Infinity===Math.acosh(Number.MAX_VALUE));u(Math,"acosh",J.acosh,!(8>E(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));u(Math,"cbrt",J.cbrt,!(8>E(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));u(Math,"sinh",J.sinh,-2E-17!==Math.sinh(-2E-17));var Hb=Math.expm1(10);u(Math,"expm1",J.expm1,22025.465794806718<Hb||22025.465794806718>Hb);var Wc=Math.round,Xc=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+
Number.EPSILON/3.99),Yc=[Da+1,2*Da-1].every(function(a){return Math.round(a)===a});u(Math,"round",function(a){var b=O(a);return.5>a-b?b:-1===b?-0:b+1},!Xc||!Yc);r.preserveToString(Math.round,Wc);var Ib=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=J.imul,r.preserveToString(Math.imul,Ib));2!==Math.imul.length&&x(Math,"imul",function(a,b){return m.Call(Ib,Math,arguments)});var Ga=function(){var a=p.setTimeout;if("function"===typeof a||"object"===typeof a){m.IsPromise=function(a){return m.TypeIsObject(a)&&
"undefined"!==typeof a._promise?!0:!1};var b=function(a){if(!m.IsConstructor(a))throw new TypeError("Bad promise constructor");var b=this;b.resolve=void 0;b.reject=void 0;b.promise=new a(function(a,c){if(void 0!==b.resolve||void 0!==b.reject)throw new TypeError("Bad Promise implementation!");b.resolve=a;b.reject=c});if(!m.IsCallable(b.resolve)||!m.IsCallable(b.reject))throw new TypeError("Bad promise constructor");},c;"undefined"!==typeof window&&m.IsCallable(window.postMessage)&&(c=function(){var a=
[];window.addEventListener("message",function(b){b.source===window&&"zero-timeout-message"===b.data&&(b.stopPropagation(),0!==a.length&&Yb(a)())},!0);return function(b){S(a,b);window.postMessage("zero-timeout-message","*")}});var d=function(){var a=p.Promise,b=a&&a.resolve&&a.resolve();return b&&function(a){return b.then(a)}},f=m.IsCallable(p.setImmediate)?p.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:d()||(m.IsCallable(c)?c():function(b){a(b,0)}),l=function(a){return a},
e=function(a){throw a;},g={},h=function(a,b,c){f(function(){if(b===g)a(c);else{try{var d=a(c);var f=b.resolve}catch(Xa){d=Xa,f=b.reject}f(d)}})},q=function(a,b){var c=a._promise,d=c.reactionLength;if(0<d&&(h(c.fulfillReactionHandler0,c.reactionCapability0,b),c.fulfillReactionHandler0=void 0,c.rejectReactions0=void 0,c.reactionCapability0=void 0,1<d))for(var f=1,l=0;f<d;f++,l+=3)h(c[l+0],c[l+2],b),a[l+0]=void 0,a[l+1]=void 0,a[l+2]=void 0;c.result=b;c.state=1;c.reactionLength=0},w=function(a,b){var c=
a._promise,d=c.reactionLength;if(0<d&&(h(c.rejectReactionHandler0,c.reactionCapability0,b),c.fulfillReactionHandler0=void 0,c.rejectReactions0=void 0,c.reactionCapability0=void 0,1<d))for(var f=1,l=0;f<d;f++,l+=3)h(c[l+1],c[l+2],b),a[l+0]=void 0,a[l+1]=void 0,a[l+2]=void 0;c.result=b;c.state=2;c.reactionLength=0},n=function(a){var b=!1;return{resolve:function(c){if(!b){b=!0;if(c===a)return w(a,new TypeError("Self resolution"));if(!m.TypeIsObject(c))return q(a,c);try{var d=c.then}catch(Zc){return w(a,
Zc)}if(!m.IsCallable(d))return q(a,c);f(function(){var b=d,f=n(a),l=f.resolve;f=f.reject;try{D(b,c,l,f)}catch($c){f($c)}})}},reject:function(c){if(!b)return b=!0,w(a,c)}}},D=function(a,b,c,d){a===z?k(a,b,c,d,g):k(a,b,c,d)},u=function(){var a=function(b){if(!(this instanceof a))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!m.IsCallable(b))throw new TypeError("not a valid resolver");var c=Oa(this,a,r,{_promise:{result:void 0,
state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),d=n(c),f=d.reject;try{b(d.resolve,f)}catch(Xa){f(Xa)}return c};return a}();var r=u.prototype;var v=function(a,b,c,d){var f=!1;return function(l){f||(f=!0,b[a]=l,0===--d.count&&(l=c.resolve,l(b)))}};t(u,{all:function(a){if(!m.TypeIsObject(this))throw new TypeError("Promise is not object");var c=new b(this),d;try{var f=m.GetIterator(a);a=d={iterator:f,done:!1};for(var l=a.iterator,e=[],
g={count:1},h,q,k=0;;){try{h=m.IteratorStep(l);if(!1===h){a.done=!0;break}q=h.value}catch(Za){throw a.done=!0,Za;}e[k]=void 0;var w=this.resolve(q),n=v(k,e,c,g);g.count+=1;D(w.then,w,n,c.reject);k+=1}if(0===--g.count){var u=c.resolve;u(e)}return c.promise}catch(Za){l=Za;if(d&&!d.done)try{m.IteratorClose(f,!0)}catch(bd){l=bd}f=c.reject;f(l);return c.promise}},race:function(a){if(!m.TypeIsObject(this))throw new TypeError("Promise is not object");var c=new b(this),d;try{var f=m.GetIterator(a);a=d={iterator:f,
done:!1};for(var l=a.iterator,e,g,h;;){try{e=m.IteratorStep(l);if(!1===e){a.done=!0;break}g=e.value}catch(Ya){throw a.done=!0,Ya;}h=this.resolve(g);D(h.then,h,c.resolve,c.reject)}return c.promise}catch(Ya){l=Ya;if(d&&!d.done)try{m.IteratorClose(f,!0)}catch(ad){l=ad}f=c.reject;f(l);return c.promise}},reject:function(a){if(!m.TypeIsObject(this))throw new TypeError("Bad promise constructor");var c=new b(this),d=c.reject;d(a);return c.promise},resolve:function(a){if(!m.TypeIsObject(this))throw new TypeError("Bad promise constructor");
if(m.IsPromise(a)&&a.constructor===this)return a;var c=new b(this),d=c.resolve;d(a);return c.promise}});t(r,{"catch":function(a){return this.then(null,a)},then:function(a,c){if(!m.IsPromise(this))throw new TypeError("not a promise");var d=m.SpeciesConstructor(this,u);d=2<arguments.length&&arguments[2]===g&&d===u?g:new b(d);var f=m.IsCallable(a)?a:l,q=m.IsCallable(c)?c:e,k=this._promise;if(0===k.state){if(0===k.reactionLength)k.fulfillReactionHandler0=f,k.rejectReactionHandler0=q,k.reactionCapability0=
d;else{var w=3*(k.reactionLength-1);k[w+0]=f;k[w+1]=q;k[w+2]=d}k.reactionLength+=1}else if(1===k.state)k=k.result,h(f,d,k);else if(2===k.state)k=k.result,h(q,d,k);else throw new TypeError("unexpected Promise state");return d.promise}});g=new b(u);var z=r.then;return u}}();p.Promise&&(delete p.Promise.accept,delete p.Promise.defer,delete p.Promise.prototype.chain);if("function"===typeof Ga){t(p,{Promise:Ga});var cd=A(p.Promise,function(a){return a.resolve(42).then(function(){})instanceof a}),dd=!e(function(){return p.Promise.reject(42).then(null,
5).then(null,aa)}),ed=e(function(){return p.Promise.call(3,aa)}),fd=function(a){var b=a.resolve(5);b.constructor={};a=a.resolve(b);try{a.then(null,aa).then(null,aa)}catch(Ia){return!0}return b===a}(p.Promise),gd=d&&function(){var a=0,b=Object.defineProperty({},"then",{get:function(){a+=1}});Promise.resolve(b);return 1===a}(),$a=function(a){var b=new Promise(a);a(3,function(){});this.then=b.then;this.constructor=BadResolverPromise_2};$a.prototype=Promise.prototype;$a.all=Promise.all;var hd=b(function(){return!!$a.all([1,
2])});cd&&dd&&ed&&!fd&&gd&&!hd||(Promise=Ga,x(p,"Promise",Ga));if(1!==Promise.all.length){var id=Promise.all;x(Promise,"all",function(a){return m.Call(id,this,arguments)})}if(1!==Promise.race.length){var jd=Promise.race;x(Promise,"race",function(a){return m.Call(jd,this,arguments)})}if(1!==Promise.resolve.length){var kd=Promise.resolve;x(Promise,"resolve",function(a){return m.Call(kd,this,arguments)})}if(1!==Promise.reject.length){var ld=Promise.reject;x(Promise,"reject",function(a){return m.Call(ld,
this,arguments)})}Ca(Promise,"all");Ca(Promise,"race");Ca(Promise,"resolve");Ca(Promise,"reject");ua(Promise)}var Jb=function(a){var b=n(q(a,function(a,b){a[b]=!0;return a},{}));return a.join(":")===b.join(":")},md=Jb(["z","a","bb"]),nd=Jb(["z",1,"a","3",2]);if(d){var na=function(a,b){return b||md?U(a)?"^"+m.ToString(a):"string"===typeof a?"$"+a:"number"===typeof a?nd?a:"n"+a:"boolean"===typeof a?"b"+a:null:null},Ha=function(){return Object.create?Object.create(null):{}},ab=function(a,b,c){if(h(c)||
G.string(c))l(c,function(a){if(!m.TypeIsObject(a))throw new TypeError("Iterator value "+a+" is not an entry object");b.set(a[0],a[1])});else if(c instanceof a)k(a.prototype.forEach,c,function(a,c){b.set(c,a)});else{if(!U(c)){var d=b.set;if(!m.IsCallable(d))throw new TypeError("bad map");var f=m.GetIterator(c)}if("undefined"!==typeof f)for(;;){a=m.IteratorStep(f);if(!1===a)break;a=a.value;try{if(!m.TypeIsObject(a))throw new TypeError("Iterator value "+a+" is not an entry object");k(d,b,a[0],a[1])}catch(Qa){throw m.IteratorClose(f,
!0),Qa;}}}},Kb=function(a,b,c){if(h(c)||G.string(c))l(c,function(a){b.add(a)});else if(c instanceof a)k(a.prototype.forEach,c,function(a){b.add(a)});else{if(!U(c)){var d=b.add;if(!m.IsCallable(d))throw new TypeError("bad set");var f=m.GetIterator(c)}if("undefined"!==typeof f)for(;;){a=m.IteratorStep(f);if(!1===a)break;a=a.value;try{k(d,b,a)}catch(Qa){throw m.IteratorClose(f,!0),Qa;}}}},va={Map:function(){var a={},b=function(a,b){this.key=a;this.value=b;this.prev=this.next=null};b.prototype.isRemoved=
function(){return this.key===a};var c=function(a,b){if(!m.TypeIsObject(a)||!a._es6map)throw new TypeError("Method Map.prototype."+b+" called on incompatible receiver "+m.ToString(a));},d=function(a,b){c(a,"[[MapIterator]]");this.i=this.head=a._head;this.kind=b};d.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var a=this.i,b=this.kind,c=this.head;if("undefined"===typeof this.i)return la();for(;a.isRemoved()&&a!==c;)a=a.prev;for(;a.next!==
c;)if(a=a.next,!a.isRemoved())return b="key"===b?a.key:"value"===b?a.value:[a.key,a.value],this.i=a,la(b);this.i=void 0;return la()}};Q(d.prototype);var f=function Sa(){if(!(this instanceof Sa))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var a=Oa(this,Sa,l,{_es6map:!0,_head:null,_map:F?new F:null,_size:0,_storage:Ha()}),c=new b(null,null);c.next=c.prev=c;a._head=c;0<arguments.length&&ab(Sa,a,arguments[0]);return a};var l=f.prototype;
r.getter(l,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});t(l,{get:function(a){c(this,"get");var b=na(a,!0);if(null!==b){if(a=this._storage[b])return a.value}else if(this._map){if(a=da.call(this._map,a))return a.value}else for(var d=b=this._head;(d=d.next)!==b;)if(m.SameValueZero(d.key,a))return d.value},has:function(a){c(this,"has");var b=na(a,!0);if(null!==b)return"undefined"!==typeof this._storage[b];if(this._map)return ba.call(this._map,
a);for(var d=b=this._head;(d=d.next)!==b;)if(m.SameValueZero(d.key,a))return!0;return!1},set:function(a,d){c(this,"set");var f=this._head,l=f,e=na(a,!0);if(null!==e){if("undefined"!==typeof this._storage[e])return this._storage[e].value=d,this;var g=this._storage[e]=new b(a,d);l=f.prev}else this._map&&(ba.call(this._map,a)?da.call(this._map,a).value=d:(g=new b(a,d),ea.call(this._map,a,g),l=f.prev));for(;(l=l.next)!==f;)if(m.SameValueZero(l.key,a))return l.value=d,this;g=g||new b(a,d);m.SameValue(-0,
a)&&(g.key=0);g.next=this._head;g.prev=this._head.prev;g.prev.next=g;g.next.prev=g;this._size+=1;return this},"delete":function(b){c(this,"delete");var d=this._head,f=d,l=na(b,!0);if(null!==l){if("undefined"===typeof this._storage[l])return!1;f=this._storage[l].prev;delete this._storage[l]}else if(this._map){if(!ba.call(this._map,b))return!1;f=da.call(this._map,b).prev;pa.call(this._map,b)}for(;(f=f.next)!==d;)if(m.SameValueZero(f.key,b))return f.key=a,f.value=a,f.prev.next=f.next,f.next.prev=f.prev,
--this._size,!0;return!1},clear:function(){c(this,"clear");this._map=F?new F:null;this._size=0;this._storage=Ha();for(var b=this._head,d,f=b.next;(d=f)!==b;)d.key=a,d.value=a,f=d.next,d.next=d.prev=b;b.next=b.prev=b},keys:function(){c(this,"keys");return new d(this,"key")},values:function(){c(this,"values");return new d(this,"value")},entries:function(){c(this,"entries");return new d(this,"key+value")},forEach:function(a){c(this,"forEach");for(var b=1<arguments.length?arguments[1]:null,d=this.entries(),
f=d.next();!f.done;f=d.next())b?k(a,b,f.value[1],f.value[0],this):a(f.value[1],f.value[0],this)}});Q(l,l.entries);return f}(),Set:function(){var a=function(a,b){if(!m.TypeIsObject(a)||!a._es6set||"undefined"===typeof a._storage)throw new TypeError("Set.prototype."+b+" called on incompatible receiver "+m.ToString(a));},b=function Ra(){if(!(this instanceof Ra))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var a=Oa(this,Ra,c,{_es6set:!0,
"[[SetData]]":null,_storage:Ha()});if(!a._es6set)throw new TypeError("bad set");0<arguments.length&&Kb(Ra,a,arguments[0]);return a};var c=b.prototype;var d=function(a){if(!a["[[SetData]]"]){var b=new va.Map;a["[[SetData]]"]=b;l(n(a._storage),function(a){if("^null"===a)a=null;else if("^undefined"!==a){var c=a.charAt(0);a="$"===c?N(a,1):"n"===c?+N(a,1):"b"===c?"btrue"===a:+a}else a=void 0;b.set(a,a)});a["[[SetData]]"]=b}a._storage=null};r.getter(b.prototype,"size",function(){a(this,"size");if(this._storage)return n(this._storage).length;
d(this);return this["[[SetData]]"].size});t(b.prototype,{has:function(b){a(this,"has");var c;if(this._storage&&null!==(c=na(b)))return!!this._storage[c];d(this);return this["[[SetData]]"].has(b)},add:function(b){a(this,"add");var c;if(this._storage&&null!==(c=na(b)))return this._storage[c]=!0,this;d(this);this["[[SetData]]"].set(b,b);return this},"delete":function(b){a(this,"delete");var c;if(this._storage&&null!==(c=na(b)))return b=ha(this._storage,c),delete this._storage[c]&&b;d(this);return this["[[SetData]]"]["delete"](b)},
clear:function(){a(this,"clear");this._storage&&(this._storage=Ha());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){a(this,"values");d(this);return new f(this["[[SetData]]"].values())},entries:function(){a(this,"entries");d(this);return new f(this["[[SetData]]"].entries())},forEach:function(b){a(this,"forEach");var c=1<arguments.length?arguments[1]:null,f=this;d(f);this["[[SetData]]"].forEach(function(a,d){c?k(b,c,d,d,f):b(d,d,f)})}});u(b.prototype,"keys",b.prototype.values,!0);
Q(b.prototype,b.prototype.values);var f=function(a){this.it=a};f.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};Q(f.prototype);return b}()};p.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(p.Set=va.Set);if(p.Map||p.Set){b(function(){return 2===(new Map([[1,2]])).get(1)})||(p.Map=function L(){if(!(this instanceof L))throw new TypeError('Constructor Map requires "new"');
var a=new F;0<arguments.length&&ab(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,p.Map.prototype);return a},p.Map.prototype=y(F.prototype),u(p.Map.prototype,"constructor",p.Map,!0),r.preserveToString(p.Map,F));var Lb=new Map,Mb=function(){var a=new Map([[1,0],[2,0],[3,0],[4,0]]);a.set(-0,a);return a.get(0)===a&&a.get(-0)===a&&a.has(0)&&a.has(-0)}(),od=Lb.set(1,2)===Lb;Mb&&od||x(Map.prototype,"set",function(a,b){k(ea,this,0===a?0:a,b);return this});Mb||(t(Map.prototype,{get:function(a){return k(da,
this,0===a?0:a)},has:function(a){return k(ba,this,0===a?0:a)}},!0),r.preserveToString(Map.prototype.get,da),r.preserveToString(Map.prototype.has,ba));var bb=new Set,Nb=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(a){a["delete"](0);a.add(-0);return!a.has(0)}(bb),pd=bb.add(1)===bb;if(!Nb||!pd){var Ob=Set.prototype.add;Set.prototype.add=function(a){k(Ob,this,0===a?0:a);return this};r.preserveToString(Set.prototype.add,Ob)}if(!Nb){var Pb=Set.prototype.has;Set.prototype.has=
function(a){return k(Pb,this,0===a?0:a)};r.preserveToString(Set.prototype.has,Pb);var Qb=Set.prototype["delete"];Set.prototype["delete"]=function(a){return k(Qb,this,0===a?0:a)};r.preserveToString(Set.prototype["delete"],Qb)}var Rb=A(p.Map,function(a){var b=new a([]);b.set(42,42);return b instanceof a}),qd=Object.setPrototypeOf&&!Rb;try{var Sb=!(p.Map()instanceof p.Map)}catch(C){Sb=C instanceof TypeError}if(0!==p.Map.length||qd||!Sb)p.Map=function L(){if(!(this instanceof L))throw new TypeError('Constructor Map requires "new"');
var a=new F;0<arguments.length&&ab(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,L.prototype);return a},p.Map.prototype=F.prototype,u(p.Map.prototype,"constructor",p.Map,!0),r.preserveToString(p.Map,F);var rd=A(p.Set,function(a){var b=new a([]);b.add(42,42);return b instanceof a}),sd=Object.setPrototypeOf&&!rd;try{var Tb=!(p.Set()instanceof p.Set)}catch(C){Tb=C instanceof TypeError}if(0!==p.Set.length||sd||!Tb){var cb=p.Set;p.Set=function L(){if(!(this instanceof L))throw new TypeError('Constructor Set requires "new"');
var a=new cb;0<arguments.length&&Kb(L,a,arguments[0]);delete a.constructor;Object.setPrototypeOf(a,L.prototype);return a};p.Set.prototype=cb.prototype;u(p.Set.prototype,"constructor",p.Set,!0);r.preserveToString(p.Set,cb)}var db=new p.Map,td=!b(function(){return db.keys().next().done});("function"!==typeof p.Map.prototype.clear||0!==(new p.Set).size||0!==db.size||"function"!==typeof p.Map.prototype.keys||"function"!==typeof p.Set.prototype.keys||"function"!==typeof p.Map.prototype.forEach||"function"!==
typeof p.Set.prototype.forEach||a(p.Map)||a(p.Set)||"function"!==typeof db.keys().next||td||!Rb)&&t(p,{Map:va.Map,Set:va.Set},!0);p.Set.prototype.keys!==p.Set.prototype.values&&u(p.Set.prototype,"keys",p.Set.prototype.values,!0);Q(Object.getPrototypeOf((new p.Map).keys()));Q(Object.getPrototypeOf((new p.Set).keys()));if(f&&"has"!==p.Set.prototype.has.name){var ud=p.Set.prototype.has;x(p.Set.prototype,"has",function(a){return k(ud,this,a)})}}t(p,va);ua(p.Map);ua(p.Set)}var R=function(a){if(!m.TypeIsObject(a))throw new TypeError("target must be an object");
},M={apply:function(){return m.Call(m.Call,null,arguments)},construct:function(a,b){if(!m.IsConstructor(a))throw new TypeError("First argument must be a constructor.");var c=2<arguments.length?arguments[2]:a;if(!m.IsConstructor(c))throw new TypeError("new.target must be a constructor.");return m.Construct(a,b,c,"internal")},deleteProperty:function(a,b){R(a);if(d){var c=Object.getOwnPropertyDescriptor(a,b);if(c&&!c.configurable)return!1}return delete a[b]},has:function(a,b){R(a);return b in a}};Object.getOwnPropertyNames&&
Object.assign(M,{ownKeys:function(a){R(a);var b=Object.getOwnPropertyNames(a);m.IsCallable(Object.getOwnPropertySymbols)&&Xb(b,Object.getOwnPropertySymbols(a));return b}});Object.preventExtensions&&Object.assign(M,{isExtensible:function(a){R(a);return Object.isExtensible(a)},preventExtensions:function(a){R(a);return!e(function(){return Object.preventExtensions(a)})}});if(d){var Ub=function(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(!d)return a=Object.getPrototypeOf(a),null===a?void 0:Ub(a,
b,c);if("value"in d)return d.value;if(d.get)return m.Call(d.get,c)},Vb=function(a,b,c,d){var f=Object.getOwnPropertyDescriptor(a,b);if(!f){a=Object.getPrototypeOf(a);if(null!==a)return Vb(a,b,c,d);f={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in f?f.writable&&m.TypeIsObject(d)?Object.getOwnPropertyDescriptor(d,b)?ia.defineProperty(d,b,{value:c}):ia.defineProperty(d,b,{value:c,writable:!0,enumerable:!0,configurable:!0}):!1:f.set?(k(f.set,d,c),!0):!1};Object.assign(M,{defineProperty:function(a,
b,c){R(a);return!e(function(){return Object.defineProperty(a,b,c)})},getOwnPropertyDescriptor:function(a,b){R(a);return Object.getOwnPropertyDescriptor(a,b)},get:function(a,b){R(a);return Ub(a,b,2<arguments.length?arguments[2]:a)},set:function(a,b,c){R(a);return Vb(a,b,c,3<arguments.length?arguments[3]:a)}})}if(Object.getPrototypeOf){var vd=Object.getPrototypeOf;M.getPrototypeOf=function(a){R(a);return vd(a)}}Object.setPrototypeOf&&M.getPrototypeOf&&Object.assign(M,{setPrototypeOf:function(a,b){R(a);
if(null!==b&&!m.TypeIsObject(b))throw new TypeError("proto must be an object or null");if(b===ia.getPrototypeOf(a))return!0;if(ia.isExtensible&&!ia.isExtensible(a))return!1;var c;a:{for(c=b;c;){if(a===c){c=!0;break a}c=M.getPrototypeOf(c)}c=!1}if(c)return!1;Object.setPrototypeOf(a,b);return!0}});var wd=function(a,c){m.IsCallable(p.Reflect[a])?b(function(){p.Reflect[a](1);p.Reflect[a](NaN);p.Reflect[a](!0);return!0})&&x(p.Reflect,a,c):u(p.Reflect,a,c)};Object.keys(M).forEach(function(a){wd(a,M[a])});
var eb=p.Reflect.getPrototypeOf;f&&eb&&"getPrototypeOf"!==eb.name&&x(p.Reflect,"getPrototypeOf",function(a){return k(eb,p.Reflect,a)});p.Reflect.setPrototypeOf&&b(function(){p.Reflect.setPrototypeOf(1,{});return!0})&&x(p.Reflect,"setPrototypeOf",M.setPrototypeOf);p.Reflect.defineProperty&&(b(function(){var a=!p.Reflect.defineProperty(1,"test",{value:1}),b="function"!==typeof Object.preventExtensions||!p.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return a&&b})||x(p.Reflect,"defineProperty",
M.defineProperty));p.Reflect.construct&&(b(function(){var a=function(){};return p.Reflect.construct(function(){},[],a)instanceof a})||x(p.Reflect,"construct",M.construct));if("Invalid Date"!==String(new Date(NaN))){var xd=Date.prototype.toString;x(Date.prototype,"toString",function(){var a=+this;return a!==a?"Invalid Date":m.Call(xd,this)})}var Wb={anchor:function(a){return m.CreateHTML(this,"a","name",a)},big:function(){return m.CreateHTML(this,"big","","")},blink:function(){return m.CreateHTML(this,
"blink","","")},bold:function(){return m.CreateHTML(this,"b","","")},fixed:function(){return m.CreateHTML(this,"tt","","")},fontcolor:function(a){return m.CreateHTML(this,"font","color",a)},fontsize:function(a){return m.CreateHTML(this,"font","size",a)},italics:function(){return m.CreateHTML(this,"i","","")},link:function(a){return m.CreateHTML(this,"a","href",a)},small:function(){return m.CreateHTML(this,"small","","")},strike:function(){return m.CreateHTML(this,"strike","","")},sub:function(){return m.CreateHTML(this,
"sub","","")},sup:function(){return m.CreateHTML(this,"sup","","")}};l(Object.keys(Wb),function(a){var b=String.prototype[a];if(m.IsCallable(b)){b=k(b,"",' " ');var c=Y([],b.match(/"/g)).length;b=b!==b.toLowerCase()||2<c}else b=!0;b&&x(String.prototype,a,Wb[a])});var yd=function(){if(!ta)return!1;var a="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!a)return!1;if("undefined"!==typeof a(B())||"[null]"!==a([B()]))return!0;var b={a:B()};b[B()]=!0;return"{}"!==a(b)?
!0:!1}(),zd=b(function(){return ta?"{}"===JSON.stringify(Object(B()))&&"[{}]"===JSON.stringify([Object(B())]):!0});if(yd||!zd){var Ad=JSON.stringify;x(JSON,"stringify",function(a){if("symbol"!==typeof a){var b;1<arguments.length&&(b=arguments[1]);var c=[a];if(h(b))c.push(b);else{var d=m.IsCallable(b)?b:null;c.push(function(a,b){a=d?k(d,this,a,b):b;if("symbol"!==typeof a)return G.symbol(a)?zb({})(a):a})}2<arguments.length&&c.push(arguments[2]);return Ad.apply(this,c)}})}return p});
(function(g){(function(g){(function(g){(function(g){var e=function(){function b(){this._promises=new Map}Object.defineProperty(b.prototype,"length",{get:function(){return this._promises.size},enumerable:!0,configurable:!0});b.prototype.make=function(a,b,d){if(this._promises.has(a))return d("Existing request with token "+a);this._promises.set(a,{reject:d,resolve:b})};b.prototype.keep=function(a,b){var c=this._promises.get(a);if(!c)throw Error("No promise associated with token: "+a);c=c.resolve;this._promises.delete(a);
return c(b)};b.prototype.break=function(a,b){var c=this._promises.get(a);if(!c)throw Error("No promise associated with token: "+a);this._promises.delete(a);c.reject(b)};return b}();g.PromiseStore=e})(g.prediction||(g.prediction={}))})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(g){var e=function(){function b(a,b){this._worker=b||g.DefaultWorker.constructInstance();this._worker.onmessage=this.onMessage.bind(this);this._declareLMLayerReady=null;this._predictPromises=new g.PromiseStore;this._wordbreakPromises=new g.PromiseStore;this._acceptPromises=new g.PromiseStore;this._revertPromises=new g.PromiseStore;this._nextToken=Number.MIN_SAFE_INTEGER;this.sendConfig(a)}b.prototype.sendConfig=function(a){this._worker.postMessage({message:"config",
capabilities:a})};b.prototype.loadModel=function(a,b){var c=this;void 0===b&&(b="file");return new Promise(function(d,l){c._declareLMLayerReady=d;d={type:b};"file"==b?d.file=a:d.code=a;c._worker.postMessage({message:"load",source:d})})};b.prototype.unloadModel=function(){this._worker.postMessage({message:"unload"})};b.prototype.predict=function(a,b){var c=this,f=this._nextToken++;return new Promise(function(d,e){c._predictPromises.make(f,d,e);c._worker.postMessage({message:"predict",token:f,transform:a,
context:b})})};b.prototype.wordbreak=function(a){var b=this,d=this._nextToken++;return new Promise(function(c,l){b._wordbreakPromises.make(d,c,l);b._worker.postMessage({message:"wordbreak",token:d,context:a})})};b.prototype.acceptSuggestion=function(a,b,d){var c=this,l=this._nextToken++;return new Promise(function(f,e){c._acceptPromises.make(l,f,e);c._worker.postMessage({message:"accept",token:l,suggestion:a,context:b,postTransform:d})})};b.prototype.revertSuggestion=function(a,b){var c=this,f=this._nextToken++;
return new Promise(function(d,e){c._revertPromises.make(f,d,e);c._worker.postMessage({message:"revert",token:f,reversion:a,context:b})})};b.prototype.resetContext=function(a){this._worker.postMessage({message:"reset-context",context:a})};b.prototype.onMessage=function(a){var b=a.data;if("error"===b.message)console.error(b.log),b.error&&console.error(b.error);else if("ready"===b.message)this._declareLMLayerReady(a.data.configuration);else if("suggestions"===b.message)this._predictPromises.keep(b.token,
b.suggestions);else if("currentword"===b.message)this._wordbreakPromises.keep(b.token,b.word);else if("postaccept"===b.message)this._acceptPromises.keep(b.token,b.reversion);else if("postrevert"===b.message)this._revertPromises.keep(b.token,b.suggestions);else throw Error("Message not implemented: "+b.message);};b.prototype.shutdown=function(){this._worker.terminate()};b.unwrap=function(a){return a.toString().match(/function[^{]+{((?:.|\r|\n)+)}[^}]*$/)[1]};return b}();g.LMLayer=e})(g.prediction||
(g.prediction={}))})(g.text||(g.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));(function(){var g=com.keyman.text.prediction;"undefined"!==typeof module&&"undefined"!==typeof module.exports?(module.exports=g.LMLayer,g.LMLayer.PromiseStore=g.PromiseStore):window.LMLayer=g.LMLayer})();
(function(g){(function(g){(function(g){(function(h){var e=function(){return function(a,b){this.suggestions=a;this.transcriptionID=b}}();h.ReadySuggestions=e;var b=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.recentTranscriptions=[];b._mayPredict=!0;b._mayCorrect=!0;return b}__extends(b,a);b.prototype.init=function(a){void 0===a&&(a=!1);a={maxLeftContextCodePoints:64,maxRightContextCodePoints:a?0:64};this.canEnable()&&(this.lmEngine=new h.LMLayer(a))};Object.defineProperty(b.prototype,
"activeModel",{get:function(){return this.currentModel},enumerable:!0,configurable:!0});b.prototype.unloadModel=function(){this.lmEngine.unloadModel();delete this.currentModel;delete this.configuration;this.emit("statechange","inactive")};b.prototype.loadModel=function(a){if(!a)throw Error("Null reference not allowed.");var b=a.path?"file":"raw",c="file"==b?a.path:a.code,d=this;d.currentModel=a;this.mayPredict&&d.emit("statechange","active");return this.lmEngine.loadModel(c,b).then(function(a){d.configuration=
a;d.emit("statechange","configured")}).catch(function(b){console.error("Could not load model '"+a.id+"': "+(b instanceof Error?b.message:String(b)));d.currentModel=null;d.emit("statechange","inactive")})};b.prototype.invalidateContext=function(a,b){this.emit("invalidatesuggestions","context");this.currentModel&&this.configuration&&this.isActive&&a&&(a=a.buildTranscriptionFrom(a,null,!1),this.predict_internal(a,!0,b))};b.prototype.wordbreak=function(a,b){if(!this.isActive)return null;a=new g.ContextWindow(g.Mock.from(a,
!1),this.configuration,b);return this.lmEngine.wordbreak(a)};b.prototype.predict=function(a,b){if(!this.isActive||!this.currentModel||!this.configuration)return null;this.emit("invalidatesuggestions","new");return this.predict_internal(a,!1,b)};b.prototype.applySuggestion=function(a,b,c){if(!b)throw"Accepting suggestions requires a destination OutputTarget instance.";var d=this.getPredictionState(a.transformId);if(d){var f=g.Mock.from(d.preInput,!1);f.apply(a.transform);f=f.buildTransformFrom(b);
b.apply(f);this.emit("suggestionapplied",b);g.Mock.from(d.preInput,!1).apply(d.transform);f=new g.ContextWindow(d.preInput,this.configuration,c());a=this.lmEngine.acceptSuggestion(a,f,d.transform);var l=this;return a=a.then(function(a){a={transform:d.transform,transformId:-d.token,displayAs:a.displayAs,id:a.id,tag:a.tag};l.predictFromTarget(b,c());return a})}console.warn("Could not apply the Suggestion!");return null};b.prototype.applyReversion=function(a,b){if(!b)throw"Accepting suggestions requires a destination OutputTarget instance.";
var c=this.getPredictionState(-a.transformId);if(c){var d=g.Mock.from(c.preInput,!1);d.apply(a.transform);var f=d.buildTransformFrom(b);b.apply(f);var h=this;return this.lmEngine.revertSuggestion(a,new g.ContextWindow(c.preInput,this.configuration,null)).then(function(a){var b=new e(a,f.id);h.emit("suggestionsready",b);h.currentPromise=null;return a})}console.warn("Could not apply the Suggestion!")};b.prototype.predictFromTarget=function(a,b){if(!a)return null;a=a.buildTranscriptionFrom(a,null,!1);
return this.predict(a,b)};b.prototype.predict_internal=function(a,b,c){if(!a)return null;c=new g.ContextWindow(a.preInput,this.configuration,c);this.recordTranscription(a);b&&this.lmEngine.resetContext(c);(b=a.alternates)&&0!=b.length||(b=[{sample:a.transform,p:1}]);var d=a.transform,f=this.currentPromise=this.lmEngine.predict(b,c),l=this;return f.then(function(a){if(f==l.currentPromise){var b=new e(a,d.id);l.emit("suggestionsready",b);l.currentPromise=null}return a})};b.prototype.recordTranscription=
function(a){this.recentTranscriptions.push(a);this.recentTranscriptions.length>b.TRANSCRIPTION_BUFFER&&this.recentTranscriptions.splice(0,1)};b.prototype.getPredictionState=function(a){var b=this.recentTranscriptions.filter(function(b){return b.token==a});return 0==b.length?null:b[0]};b.prototype.shutdown=function(){this.lmEngine.shutdown()};Object.defineProperty(b.prototype,"isActive",{get:function(){return this.canEnable()?(this.activeModel||!1)&&this._mayPredict:this._mayPredict=!1},enumerable:!0,
configurable:!0});b.prototype.canEnable=function(){return!0};Object.defineProperty(b.prototype,"mayPredict",{get:function(){return this._mayPredict},set:function(a){if(this.canEnable()){var b=this._mayPredict;this._mayPredict=a;b!=a&&this.activeModel&&this.emit("statechange",a?"active":"inactive")}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"mayCorrect",{get:function(){return this._mayCorrect},set:function(a){this._mayCorrect=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"wordbreaksAfterSuggestions",{get:function(){return this.configuration.wordbreaksAfterSuggestions},enumerable:!0,configurable:!0});b.prototype.tryAcceptSuggestion=function(a){var b={shouldSwallow:!1};this.emit("tryaccept",a,b);return b.shouldSwallow};b.prototype.tryRevertSuggestion=function(){var a={shouldSwallow:!1};this.emit("tryrevert",a);return a.shouldSwallow};b.TRANSCRIPTION_BUFFER=10;return b}(EventEmitter);h.LanguageProcessor=b})(g.prediction||(g.prediction={}))})(g.text||(g.text={}))})(g.keyman||
(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function e(b,a){if(!b)throw Error("device must be defined");a||(a=e.DEFAULT_OPTIONS);this.contextDevice=b;this.kbdProcessor=new h.KeyboardProcessor(b,a);this.lngProcessor=new h.prediction.LanguageProcessor}Object.defineProperty(e.prototype,"languageProcessor",{get:function(){return this.lngProcessor},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"keyboardProcessor",{get:function(){return this.kbdProcessor},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"keyboardInterface",{get:function(){return this.keyboardProcessor.keyboardInterface},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"activeKeyboard",{get:function(){return this.keyboardInterface.activeKeyboard},set:function(b){this.keyboardInterface.activeKeyboard=b;this.resetContext()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"activeModel",{get:function(){return this.languageProcessor.activeModel},enumerable:!0,configurable:!0});
e.prototype.processNewContextEvent=function(b){var a=this.keyboardProcessor.processNewContextEvent(this.contextDevice,b);a&&a.finalize(this.keyboardProcessor,b,!0);return a};e.prototype.processKeyEvent=function(b,a){var c,d,f=b.isSynthetic;if((b.device.formFactor==k.utils.FormFactor.Desktop||!this.activeKeyboard||this.activeKeyboard.usesDesktopLayoutOnDevice(b.device))&&f&&this.keyboardProcessor.selectLayer(b)||this.keyboardProcessor.doModifierPress(b,a,!f)&&!f||this.languageProcessor.isActive&&(("K_BKSP"==
b.kName||b.Lcode==h.Codes.keyCodes.K_BKSP)&&this.languageProcessor.tryRevertSuggestion()||("K_SPACE"==b.kName||b.Lcode==h.Codes.keyCodes.K_SPACE)&&this.languageProcessor.tryAcceptSuggestion("space")))return new h.RuleBehavior;var l=h.Mock.from(a,!0),e=this.keyboardProcessor.layerId;f=this.keyboardProcessor.processKeystroke(b,a);b.kNextLayer&&this.keyboardProcessor.selectLayer(b);var g=h.Codes.isKnownOSKModifierKey(b.kName);(null===(d=null===(c=null===f||void 0===f?void 0:f.transcription)||void 0===
c?void 0:c.transform)||void 0===d?0:d.isNoOp())&&b.kNextLayer&&(g=!0);(c=null!=f)?(d=g?null:this.buildAlternates(f,b,l),f.finalize(this.keyboardProcessor,a,!1),d&&0<d.length&&(f.transcription.alternates=d)):(f=new h.RuleBehavior,f.transcription=a.buildTranscriptionFrom(a,null,!1),f.triggersDefaultCommand=!0);b=f.setStore[h.KeyboardInterface.TSS_LAYER]||b.kNextLayer;this.keyboardProcessor.newLayerStore.set(b?this.keyboardProcessor.layerId:"");this.keyboardProcessor.oldLayerStore.set(b?e:"");(b=this.keyboardProcessor.processPostKeystroke(this.contextDevice,
a))&&b.finalize(this.keyboardProcessor,a,!0);f.predictionPromise=this.languageProcessor.predict(f.transcription,this.keyboardProcessor.layerId);f.triggersDefaultCommand||a.doInputEvent();return c?f:null};e.prototype.buildAlternates=function(b,a,c){if(this.languageProcessor.isActive&&!b.triggersDefaultCommand){var d=a.keyDistribution;c=(new h.ContextWindow(c,h.ContextWindow.ENGINE_RULE_WINDOW,this.keyboardProcessor.layerId)).toMock();if(d&&a.kbdLayer){var f=Number.MAX_VALUE,l=g.keyman.utils.getGlobalObject(),
e=void 0;l.performance&&l.performance.now&&(e=function(){return l.performance.now()},f=e()+16);var k=Math.exp(-5);d.sort(function(a,b){return b.p-a.p});var n=this.activeKeyboard.layout(a.device.formFactor);var u=[];for(var t=0,v=0;v<d.length;v++){var z=d[v];if(z.p<k)break;else if(e&&e()>=f)break;var r=h.Mock.from(c,!1),y=n.getLayer(a.kbdLayer).getKey(z.keyId);y?(y=y.constructKeyEvent(this.keyboardProcessor,a.device),(r=this.keyboardProcessor.processKeystroke(y,r))&&!r.beep&&0<z.p&&(r=r.transcription.transform,
r.id=b.transcription.token,u.push({sample:r,p:z.p}),t+=z.p)):console.warn("Potential fat-finger key could not be found in layer!")}u.forEach(function(a){a.p/=t})}}return u};e.prototype.resetContext=function(b){this.keyboardProcessor.resetContext();this.languageProcessor.invalidateContext(b,this.keyboardProcessor.layerId);b&&this.processNewContextEvent(b)};e.DEFAULT_OPTIONS={baseLayout:"us"};return e}();h.InputProcessor=n})(k.text||(k.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(){var g=com.keyman.text;"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=g.InputProcessor,g.InputProcessor.com=com)})();
(function(g){(function(k){(function(h){h.KeyboardInterface.prototype.registerKeyboard=function(h){g.keyman.singleton.keyboardManager._registerKeyboard(h)};h.KeyboardInterface.prototype.registerStub=function(h){var e=g.keyman.singleton.keyboardManager;if(e.keymanweb.initialized)for(var b=0;b<e.keyboardStubs.length;b++)if(e.keyboardStubs[b].KI==h.KI&&(""==h.KLC||e.keyboardStubs[b].KLC==h.KLC))return 1;e._registerStub(h);return null};h.KeyboardInterface.prototype.insertText=function(h,e){var b=g.keyman.singleton;
this.resetContextCache();var a=this.activeTargetOutput?this.activeTargetOutput:k.dom.Utils.getOutputTarget();return null!=a?(b.uiManager.setActivatingUI(!0),k.dom.DOMEventHandlers.states._IgnoreNextSelChange=100,b.domManager.focusLastActiveElement(),k.dom.DOMEventHandlers.states._IgnoreNextSelChange=0,null!=h&&this.output(0,a,h),"undefined"!==typeof e&&null!==e&&this.deadkeyOutput(0,a,e),a.invalidateSelection(),!0):!1};h.KeyboardInterface.prototype.saveFocus=function(){k.dom.DOMEventHandlers.states._IgnoreNextSelChange=
1};h.KeyboardInterface.prototype.getLastActiveElement=function(){return k.dom.Utils.getOutputTarget()};h.KeyboardInterface.prototype.focusLastActiveElement=function(){g.keyman.singleton.domManager.focusLastActiveElement()};h.KeyboardInterface.prototype.hideHelp=function(){g.keyman.singleton.osk.startHide(!0)};h.KeyboardInterface.prototype.showHelp=function(h,e){var b=g.keyman.singleton;b.osk instanceof k.osk.FloatingOSKView?b.osk.presentAtPosition(h,e):b.osk.present()};h.KeyboardInterface.prototype.showPinnedHelp=
function(){var h=g.keyman.singleton;!(h.osk instanceof k.osk.FloatingOSKView)||h.core.activeKeyboard.isCJK&&this.ruleBehavior||(h.osk.userPositioned=!0);h.osk.present()};h.KeyboardInterface.prototype.GetLastActiveElement=h.KeyboardInterface.prototype.getLastActiveElement;h.KeyboardInterface.prototype.FocusLastActiveElement=h.KeyboardInterface.prototype.focusLastActiveElement;h.KeyboardInterface.prototype.HideHelp=h.KeyboardInterface.prototype.hideHelp;h.KeyboardInterface.prototype.ShowHelp=h.KeyboardInterface.prototype.showHelp;
h.KeyboardInterface.prototype.ShowPinnedHelp=h.KeyboardInterface.prototype.showPinnedHelp})(k.text||(k.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b){this.popupCanvasBackgroundColor=b.OS==g.OperatingSystem.Android?"#999":e.prefersDarkMode()?"#0f1319":"#ffffff"}e.prefersDarkMode=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches};return e}();g.StyleConstants=h})(g.utils||(g.utils={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){var h=function(){function h(){this.detected=!1;this.touchable=!!("ontouchstart"in window);this.OS="";this.formFactor="desktop";this.dyLandscape=this.dyPortrait=0;this.version="0";this.orientation=window.orientation;this.browser=""}h.prototype.getDPI=function(){var e=document.createElement("DIV"),b=e.style,a=96;if("complete"!==document.readyState)return a;e.id="calculateDPI";b.position="absolute";b.display="block";b.visibility="hidden";b.left="10px";b.top="10px";b.width="1in";
b.height="10px";document.body.appendChild(e);a="undefined"==typeof window.devicePixelRatio?e.offsetWidth:e.offsetWidth*window.devicePixelRatio;document.body.removeChild(e);return a};h.prototype.detect=function(){var e=h._GetIEVersion(),b=!1;if(navigator&&navigator.userAgent){var a=navigator.userAgent;if(0<=a.indexOf("iPad"))this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0;else if(0<=a.indexOf("iPhone"))this.OS="iOS",this.formFactor="phone",this.dyPortrait=this.dyLandscape=
25;else if(0<=a.indexOf("Android")){this.OS="Android";this.formFactor="phone";this.dyPortrait=75;this.dyLandscape=25;try{this.version=a.match(/(?:Android\s+)(\d+\.\d+\.\d+)/)[1]}catch(d){}}else 0<=a.indexOf("Linux")?this.OS="Linux":0<=a.indexOf("Macintosh")?(a=/Intel Mac OS X (\d+(?:[_\.]\d+)+)/i.exec(a),a)?1<a.length&&a[1]&&(b=a[1].replace("_","."),b=new g.utils.Version(b),b=0>=g.utils.Version.MAC_POSSIBLE_IPAD_ALIAS.compareTo(b),this.OS="MacOSX"):(console.warn("KMW could not properly parse the user agent string.A suboptimal keyboard layout may result."),
this.OS="MacOSX"):0<=a.indexOf("Windows NT")&&(this.OS="Windows",0<=a.indexOf("Touch")&&(this.formFactor="phone"),"number"==typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints&&(this.touchable=!0))}a=Math.min(screen.width,screen.height);var c=a/Math.max(screen.width,screen.height);"iOS"!=this.OS&&"phone"==this.formFactor&&(600<=a&&.5625<c||.625<=c)&&(this.formFactor="tablet");a="Win32"==navigator.platform||"MacIntel"==navigator.platform;"iOS"!=this.OS||"ongesturestart"in window||a||(this.OS=
"Android");this.browser="web";if(999>e)this.browser="ie";else{if("iOS"==this.OS||"macosx"==this.OS.toLowerCase())this.browser="safari";/Firefox|Chrome|OPR|Safari|Edge/.test(navigator.userAgent)&&(0<=navigator.userAgent.indexOf("Firefox")&&"onmozorientationchange"in screen?this.browser="firefox":0<=navigator.userAgent.indexOf("OPR")?this.browser="opera":0<=navigator.userAgent.indexOf(" Edge/")?this.browser="edge":0<=navigator.userAgent.indexOf("Chrome")?this.browser="chrome":0<=navigator.userAgent.indexOf("Safari")&&
(this.browser="safari"))}b&&"safari"==this.browser&&window.TouchEvent&&(this.OS="iOS",this.formFactor="tablet",this.dyPortrait=this.dyLandscape=0,e=screen.height/screen.width,1>e&&(e=1/e),1.6<e&&(this.formFactor="phone",this.dyPortrait=this.dyLandscape=25));this.colorScheme=g.utils.StyleConstants.prefersDarkMode()?"dark":"light";this.detected=!0};h._GetIEVersion=function(){var e="";"userAgent"in navigator&&(e=navigator.userAgent);if("selection"in document){var b=navigator.appVersion;var a=b.indexOf("MSIE ");
if(0<=a){if("BackCompat"==document.compatMode)return 6;b=b.substr(a+5);a=b.indexOf(".");if(0<a)return parseInt(b.substr(0,a),10)}}a=e.indexOf("Trident/");if(0>a)return 999;e=e.substr(a+8);a=e.indexOf(".");return 0<a?parseInt(e.substr(0,a),10)+4:999};Object.defineProperty(h.prototype,"coreSpec",{get:function(){return new g.utils.DeviceSpec(this.browser,this.formFactor,this.OS,this.touchable)},enumerable:!0,configurable:!0});return h}();g.Device=h})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var k=function(){function e(){}e.getOutputTarget=function(b){if(!b){var a=g.keyman.singleton;a&&(b=a.domManager.lastActiveElement);if(!b)return null}if(b._kmwAttachment&&b._kmwAttachment.interface)return b._kmwAttachment.interface;throw Error("OSK could not find element output target data!");};e.getAbsoluteX=function(b){if(!b)return 0;var a=b.offsetLeft?b.offsetLeft:0;var c=b;if(c.offsetParent){for(;c.offsetParent;)c=c.offsetParent,a+=c.offsetLeft;var d=c.ownerDocument;
"fixed"==c.style.position&&d&&d.scrollingElement&&(a+=d.scrollingElement.scrollLeft)}return c&&c.ownerDocument&&b.ownerDocument!=window.document&&(b=c.ownerDocument)&&b.defaultView&&b.defaultView.frameElement?a+e.getAbsoluteX(b.defaultView.frameElement)-b.documentElement.scrollLeft:a};e.getAbsoluteY=function(b){if(!b)return 0;var a=b.offsetTop?b.offsetTop:0;var c=b;if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement){for(;c.offsetParent;)c=c.offsetParent,a+=c.offsetTop;var d=
c.ownerDocument;"fixed"==c.style.position&&d&&d.scrollingElement&&(a+=d.scrollingElement.scrollTop)}return c&&c.ownerDocument&&b.ownerDocument!=window.document&&(b=c.ownerDocument)&&b.defaultView&&b.defaultView.frameElement?a+e.getAbsoluteY(b.defaultView.frameElement):a};e.instanceof=function(b,a){if("TouchAliasElement"==a)return this.instanceof(b,"HTMLDivElement")?void 0!==b.base:!1;var c;if(!b)return!1;if(b.Window)return"Window"==a;b.defaultView?c=b.defaultView[a]:b.ownerDocument?c=b.ownerDocument.defaultView[a]:
b.target&&(this.instanceof(b.target,"Window")?c=b.target[a]:this.instanceof(b.target,"Document")?c=b.target.defaultView[a]:this.instanceof(b.target,"HTMLElement")&&(c=b.target.ownerDocument.defaultView[a]));return c?b instanceof c:!1};e.forceScroll=function(b){if(g&&g.keyman&&g.keyman.DOMEventHandlers&&!g.keyman.singleton.isEmbedded){var a=g.keyman.DOMEventHandlers,c=b.selectionStart,d=b.selectionEnd;a.states._IgnoreBlurFocus=!0;b.blur();b.focus();a.states._IgnoreBlurFocus=!1;b.selectionStart=c;b.selectionEnd=
d}};return e}();h.Utils=k})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){h.findTouchAliasTarget=function(e){if(e&&h.Utils.instanceof(e,"HTMLSpanElement"))e=e.parentNode;else if(e&&null!=e.className&&0<=e.className.indexOf("keymanweb-input"))e=e.firstChild;else if(e&&h.Utils.instanceof(e,"HTMLDivElement"))e.parentElement&&0>e.parentElement.className.indexOf("keymanweb-input")&&(e=e.parentElement);else return e.kmw_ip?e.kmw_ip:null;e=e.parentNode;return void 0!==e.base?e:null};h.constructTouchAlias=function(e){var b=document.createElement("div"),
a=new k,c;for(c in a)b.hasOwnProperty(c)||(b[c]=a[c]);e?b.initWithBase(e):b.init();return b};var k=function(){function e(){this.base=null;this.__executingCaretSearch=this.__activeCaret=!1}e.getDevice=function(){if(!e.device){var b=new g.keyman.Device;b.detect();e.device=b}return e.device};e.getOS=function(){return this.getDevice().OS};e.prototype.isMultiline=function(){return this.base&&"TEXTAREA"==this.base.nodeName};e.prototype.initCaret=function(){this.__caretDiv=document.createElement("DIV");
var b=this.__caretDiv.style;b.position="absolute";b.height="16px";b.width="2px";b.backgroundColor="blue";b.border="none";b.left=b.top="0px";b.display="block";b.visibility="hidden";b.zIndex="9998";this.__caretTimerId=window.setInterval(this.flashCaret.bind(this),500)};e.prototype.init=function(){this.className="keymanweb-input";var b=this.__scrollDiv=document.createElement("div"),a=this.style;a.overflow="hidden";a.position="absolute";a.border="hidden";a.border="none";a.borderRadius="5px";var c=this.__scrollBar=
document.createElement("div"),d=c.style;d.position="absolute";d.height=d.width="4px";d.left=d.top="0";d.display="block";d.visibility="hidden";d.backgroundColor="#808080";d.borderRadius="2px";this.__preCaret=document.createElement("span");this.__postCaret=document.createElement("span");this.__caretSpan=document.createElement("span");this.__preCaret.innerHTML=this.__postCaret.innerHTML=this.__caretSpan.innerHTML="";this.__preCaret.className=this.__postCaret.className=this.__caretSpan.className="keymanweb-font";
b.appendChild(this.__preCaret);b.appendChild(this.__caretSpan);b.appendChild(this.__postCaret);this.appendChild(b);this.appendChild(c);b=b.style;b.position="relative";c=this.__preCaret.style;d=this.__postCaret.style;var f=this.__caretSpan.style;c.border=d.border="none";c.height=d.height="100%";f.border="1px solid red";f.visibility="hidden";f.marginLeft=f.marginRight="-1px";b.left="0px";b.top="0px";b.padding="0";b.border="none";a.padding="8px";this.tabIndex=0;this.style.msTouchAction="none";b.minWidth=
a.width;b.height=a.height;this.initCaret()};e.prototype.initWithBase=function(b){this.base=b;this.init();this.base.kmw_ip=this;b.disabled=!0;var a=window.getComputedStyle(b,null),c=this.__scrollDiv.style,d=this.__preCaret.style,f=this.__postCaret.style;this.dir=b.dir;d.fontFamily=f.fontFamily=c.fontFamily=a.fontFamily;"input"!=b.nodeName.toLowerCase()||isNaN(parseInt(a.height,10))||(d.lineHeight=f.lineHeight=a.height);"Android"==e.getOS()&&"transparent"==a.backgroundColor?c.backgroundColor="#fff":
c.backgroundColor=a.backgroundColor;"textarea"==this.base.nodeName.toLowerCase()?d.whiteSpace=f.whiteSpace="pre-wrap":d.whiteSpace=f.whiteSpace="pre";this.base.parentNode.appendChild(this);this.updateInput();d=this.style;d.color=a.color;d.fontFamily=a.fontFamily;d.fontSize=a.fontSize;d.fontWeight=a.fontWeight;d.textDecoration=a.textDecoration;d.padding=a.padding;d.margin=a.margin;d.border=a.border;d.borderRadius=a.borderRadius;"webkitTapHighlightColor"in d&&(d.webkitTapHighlightColor="rgba(0,0,0,0)");
b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement?(2==b.rows&&(f=parseFloat(a.height)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom),a=parseFloat(a.fontSize),a=Math.round(f/a),a>b.rows+1&&(b.rows=a)),c.width=d.width,c.minHeight=d.height):(c.minWidth=d.width,c.height=d.height);b.style.visibility="hidden";(function(a){a.__resizeHandler=function(){window.setTimeout(function(){a.updateInput()},1)};a.base.addEventListener("resize",a.__resizeHandler,!1);a.base.addEventListener("orientationchange",
a.__resizeHandler,!1)})(this);this.setText(b instanceof b.ownerDocument.defaultView.HTMLTextAreaElement||b instanceof b.ownerDocument.defaultView.HTMLInputElement?b.value:b.textContent,null)};e.prototype.setText=function(b,a){if(null===b){var c=this.__preCaret.textContent;b=this.__postCaret.textContent;b=c+b}0>a&&(a=0);c=b._kmwLength();if(null===a||void 0===a||a>c)a=c;c=b._kmwSubstr(0,a);b=b._kmwSubstr(a);this.__preCaret.textContent=c;this.__postCaret.textContent=b;this.__executingCaretSearch||this.updateBaseElement()};
e.prototype.getTextBeforeCaret=function(){return this.__preCaret.textContent};e.prototype.getTextAfterCaret=function(){return this.__postCaret.textContent};e.prototype.setTextBeforeCaret=function(b){this.isMultiline()||(b=b.replace(/\s+$/," "));this.__preCaret.textContent=b;this.__executingCaretSearch||this.finalizeCaret()};e.prototype.getTextCaret=function(){return this.getTextBeforeCaret()._kmwLength()};e.prototype.setTextCaret=function(b){this.setText(null,b);this.showCaret()};e.prototype.executeCaretSearch=
function(b,a){this.__executingCaretSearch=!0;try{this.performCaretSearch(b,a)}finally{this.__executingCaretSearch=!1,this.finalizeCaret()}};e.prototype.performCaretSearch=function(b,a){var c=document.body.scrollTop,d=0,f=this.getText()._kmwLength(),l=this.getTextCaret();if(this.base instanceof this.base.ownerDocument.defaultView.HTMLTextAreaElement){for(var g=a-Math.round(this.base.offsetHeight/this.base.rows);1<f-d;){var k=h.Utils.getAbsoluteY(this.__caretSpan)-c;if(k>a&&l>d)f=l,l=Math.round((l+
d)/2);else if(k<g&&l<f)d=l,l=Math.round((l+f)/2);else break;this.setTextCaret(l)}h.Utils.getAbsoluteY(this.__caretSpan)-c>a&&l>d&&this.setTextCaret(--l);h.Utils.getAbsoluteY(this.__caretSpan)-c<g&&l<f&&this.setTextCaret(++l);for(var D=d,n=l;n!=D;){var t=Math.floor((n+D)/2);this.setTextCaret(t);k=h.Utils.getAbsoluteY(this.__caretSpan)-c;d=k<g?D=t+1:n=t}for(g=f;g!=l;)t=Math.round((g+l)/2),this.setTextCaret(t),k=h.Utils.getAbsoluteY(this.__caretSpan)-c,f=k>a?g=t-1:l=t;l=Math.round((d+f)/2);this.setTextCaret(l)}"rtl"==
this.dir?(a=function(a,b){return a<b},c=-e.X_SNAP_LENIENCY_PIXELS):(a=function(a,b){return a>b},c=e.X_SNAP_LENIENCY_PIXELS);for(;1<f-d;){k=h.Utils.getAbsoluteX(this.__caretSpan);if(a(k,b)&&l>d)f=l,l=Math.round((l+d)/2);else if(!a(k,b)&&l<f)d=l,l=Math.round((l+f)/2);else break;this.setTextCaret(l)}a(h.Utils.getAbsoluteX(this.__caretSpan),b)&&l>d&&this.setTextCaret(--l);!a(h.Utils.getAbsoluteX(this.__caretSpan)+c,b)&&l<f&&this.setTextCaret(++l)};e.prototype.finalizeCaret=function(){this.updateBaseElement();
this.scrollInput()};e.prototype.updateBaseElement=function(){if(this.base){var b=this.base.ownerDocument.defaultView;this.base instanceof b.HTMLInputElement||this.base instanceof b.HTMLTextAreaElement?this.base.value=this.getText():this.base.textContent=this.getText();b=this.getText()._kmwLength();this.style.backgroundColor=0==b?"transparent":window.getComputedStyle(this.base,null).backgroundColor;"iOS"==e.getOS()&&(this.base.style.visibility=0==b?"visible":"hidden")}};e.prototype.flashCaret=function(){if(this.__activeCaret){var b=
this.__caretDiv.style;b.visibility="visible"!=b.visibility?"visible":"hidden"}};e.prototype.showCaret=function(){var b=this.__scrollDiv,a=this.__caretDiv.style,c=this.__caretSpan;this.__caretDiv.parentNode!=b&&b.appendChild(this.__caretDiv);a.left=c.offsetLeft+"px";a.top=c.offsetTop+"px";a.height=c.offsetHeight-1+"px";a.visibility="hidden";this.__activeCaret=!0;this.__executingCaretSearch||(this.scrollBody(),this.setScrollBar())};e.prototype.hideCaret=function(){if(this.base instanceof this.base.ownerDocument.defaultView.HTMLTextAreaElement||
this.base instanceof this.base.ownerDocument.defaultView.HTMLInputElement)this.base.value=this.getText();this.setText(null,1E5);var b=this.__scrollDiv.style;this.isMultiline()?b.top="0":b.left="rtl"==this.base.dir?this.offsetWidth-this.__scrollDiv.offsetWidth-8+"px":"0";this.__caretDiv.parentNode&&this.__caretDiv.parentNode.removeChild(this.__caretDiv);this.__caretDiv.style.visibility="hidden";this.__scrollBar.style.visibility="hidden";this.__activeCaret=!1};e.prototype.getText=function(){return this.textContent};
e.prototype.updateInput=function(){if(this.base){var b=this.style,a=this.base,c=window.getComputedStyle(a,null),d=parseFloat(c.marginLeft),f=parseFloat(c.marginTop),l=h.Utils.getAbsoluteX(a),g=h.Utils.getAbsoluteY(a),k=this.offsetParent;k&&(l-=h.Utils.getAbsoluteX(k),g-=h.Utils.getAbsoluteY(k));isNaN(d)&&(d=0);isNaN(f)&&(f=0);b.left=l-d+"px";b.top=g-f+"px";d=a.offsetWidth;a=a.offsetHeight;f=parseFloat(c.paddingLeft);l=parseFloat(c.paddingRight);g=parseFloat(c.paddingTop);k=parseFloat(c.paddingBottom);
var D=parseFloat(c.borderLeft),n=parseFloat(c.borderRight),t=parseFloat(c.borderTop),v=parseFloat(c.borderBottom),z="undefined";"undefined"!=typeof c.boxSizing?z=c.boxSizing:"undefined"!=typeof c.MozBoxSizing&&(z=c.MozBoxSizing);"content-box"==z&&(isNaN(f)||(d-=f),isNaN(l)||(d-=l),isNaN(D)||(d-=D),isNaN(n)||(d-=n),isNaN(g)||(a-=g),isNaN(k)||(a-=k),isNaN(t)||(a-=t),isNaN(v)||(a-=v));"Android"==e.getOS()&&(d++,a++);b.width=d+"px";b.height=a+"px"}};e.prototype.scrollInput=function(){var b=this.__scrollDiv,
a=this.__caretSpan,c=h.Utils.getAbsoluteX(a);a=h.Utils.getAbsoluteY(a);var d=h.Utils.getAbsoluteX(this),f=h.Utils.getAbsoluteY(this),l=parseInt(b.style.left,10),e=parseInt(b.style.top,10),g=0,k=0;isNaN(l)&&(l=0);isNaN(e)&&(e=0);this.isMultiline()?(c=Math.round(this.offsetHeight/this.base.rows),a<f&&(k=a-f),a>f+this.offsetHeight-c&&(k=a-f-this.offsetHeight+c),0!=k&&(b.style.top=(e<k?e-k:0)+"px")):(c<d+8&&(g=c-d-12),c>d+this.offsetWidth-12&&(g=c-d-this.offsetWidth+12),0!=g&&(b.style.left=(l<g?l-g:0)+
"px"));this.showCaret()};e.prototype.scrollBody=function(){var b=0;if(window.keyman){var a=window.keyman.osk;a&&a._Box&&(b=a._Box.offsetHeight)}a=this.__caretSpan;var c=h.Utils.getAbsoluteY(a),d=window.pageYOffset;c<d?b=c-d:(b=c-d-(window.innerHeight-b-a.offsetHeight-2),0>b&&(b=0));0!=b&&window.scrollTo(0,b+window.pageYOffset)};e.prototype.setScrollBar=function(){var b=this.__scrollDiv,a=this.__scrollBar.style;(b.offsetWidth>this.offsetWidth||0>b.offsetLeft)&&!this.isMultiline()?(a.height="4px",a.width=
this.offsetWidth/b.offsetWidth*100+"%",a.left=-b.offsetLeft/b.offsetWidth*100+"%",a.top="0",a.visibility="visible"):b.offsetHeight>this.offsetHeight||0>b.offsetTop?(a.width="4px",a.height=this.offsetHeight/b.offsetHeight*100+"%",a.top=-b.offsetTop/b.offsetHeight*100+"%",a.left="0",a.visibility="visible"):a.visibility="hidden"};e.X_SNAP_LENIENCY_PIXELS=5;return e}()})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function e(){}e._GetEventKeyCode=function(b){return b.keyCode?b.keyCode:b.which?b.which:null};e._GetKeyEventProperties=function(b,a){a=g.keyman.singleton;var c=a.core,d=new k.text.KeyEvent;b=a._GetEventObject(b);if(!0===b.cancelBubble)return null;d.Lcode=this._GetEventKeyCode(b);if(null==d.Lcode)return null;var f=c.keyboardProcessor.modStateFlags,l=!1,e=!1;var h=k.text.Codes.keyCodes;switch(d.Lcode){case h.K_CTRL:case h.K_LCTRL:case h.K_RCTRL:case h.K_CONTROL:case h.K_LCONTROL:case h.K_RCONTROL:l=
!0;break;case h.K_LMENU:case h.K_RMENU:case h.K_ALT:case h.K_LALT:case h.K_RALT:e=!0}h=0|(b.getModifierState("Shift")?16:0);var n=k.text.Codes.modifierCodes;b.getModifierState("Control")&&(h|=0!=b.location&&l?1==b.location?n.LCTRL:n.RCTRL:f&3);b.getModifierState("Alt")&&(h|=0!=b.location&&e?1==b.location?n.LALT:n.RALT:f&12);d.Lstates=0;d.Lstates|=b.getModifierState("CapsLock")?n.CAPS:n.NO_CAPS;d.Lstates|=b.getModifierState("NumLock")?n.NUM_LOCK:n.NO_NUM_LOCK;d.Lstates|=b.getModifierState("ScrollLock")||
b.getModifierState("Scroll")?n.SCROLL_LOCK:n.NO_SCROLL_LOCK;h|=d.Lstates;d.LmodifierChange=c.keyboardProcessor.modStateFlags!=h;c.keyboardProcessor.modStateFlags=h;l=n.RALT|n.LCTRL;(f&l)==l&&(h&l)!=l&&(h&=~l);h&n.RALT&&(h&=~n.LCTRL);l=k.text.Codes.modifierBitmasks;(f=c.activeKeyboard)&&f.isChiral?(d.Lmodifiers=h&l.CHIRAL,f.emulatesAltGr&&(d.Lmodifiers&l.ALT_GR_SIM)==l.ALT_GR_SIM&&(d.Lmodifiers^=l.ALT_GR_SIM,d.Lmodifiers|=n.RALT)):d.Lmodifiers=h&16|(h&(n.LCTRL|n.RCTRL)?32:0)|(h&(n.LALT|n.RALT)?64:
0);d.Lmodifiers|=b.metaKey?n.META:0;d.device=a.util.physicalDevice.coreSpec;!a.isEmbedded&&d.device.browser==k.utils.Browser.Firefox&&k.KeyMapping.browserMap.FF["k"+d.Lcode]&&(d.Lcode=k.KeyMapping.browserMap.FF["k"+d.Lcode]);f&&f.isMnemonic&&k.text.KeyboardProcessor.setMnemonicCode(d,b.getModifierState("Shift"),b.getModifierState("CapsLock"));d.LisVirtualKey="undefined"!=typeof b.charCode&&null!=b.charCode&&(0==b.charCode||0!=(d.Lmodifiers&111))||"keypress"!=b.type;d.isSynthetic=!1;f&&!f.isMnemonic&&
((b=k.KeyMapping.languageMap[c.keyboardProcessor.baseLayout])&&b["k"+d.Lcode]&&(d.Lcode=b["k"+d.Lcode]),f.definesPositionalOrMnemonic||d.Lmodifiers&96||(d={Lcode:k.KeyMapping._USKeyCodeToCharCode(d),Lmodifiers:0,LisVirtualKey:!1,vkCode:d.Lcode,Lstates:d.Lstates,kName:"",device:a.util.physicalDevice.coreSpec,isSynthetic:!1}));return d};e.getEventOutputTarget=function(b){b=g.keyman.singleton.util.eventTarget(b);if(null==b)return null;3==b.nodeType&&(b=b.parentNode);return h.Utils.getOutputTarget(b)};
e.keyDown=function(b){var a=g.keyman.singleton.core;h.DOMEventHandlers.states.swallowKeypress=!1;var c=this._GetKeyEventProperties(b,!0);if(null==c)return!0;var d=e.getEventOutputTarget(b);(a=(a=a.processKeyEvent(c,d))&&!a.triggerKeyDefault)?(b&&b.preventDefault&&(b.preventDefault(),b.stopPropagation()),h.DOMEventHandlers.states.swallowKeypress=!!c.Lcode,8==c.Lcode&&(h.DOMEventHandlers.states.swallowKeypress=!1)):h.DOMEventHandlers.states.swallowKeypress=!1;return!a};e.keyUp=function(b){var a=g.keyman.singleton.core,
c=this._GetKeyEventProperties(b,!1);if(null==c)return!0;b=e.getEventOutputTarget(b);return a.keyboardProcessor.doModifierPress(c,b,!1)};e.keyPress=function(b){var a=g.keyman.singleton,c=a.core,d=this._GetKeyEventProperties(b);if(null==d||d.LisVirtualKey)return!0;if(!c.activeKeyboard.isMnemonic){if(!h.DOMEventHandlers.states.swallowKeypress||32>d.Lcode||a._BrowserIsSafari&&63232<d.Lcode&&63744>d.Lcode)return!0;if(b=a._GetEventObject(b))b.returnValue=!1;return!1}a=e.getEventOutputTarget(b);if(h.DOMEventHandlers.states.swallowKeypress||
c.keyboardInterface.processKeystroke(a,d))return h.DOMEventHandlers.states.swallowKeypress=!1,b&&b.preventDefault&&(b.preventDefault(),b.stopPropagation()),!1;h.DOMEventHandlers.states.swallowKeypress=!1;return!0};return e}();h.PreProcessor=n})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var k=function(){function a(){this._DisableInput=!1;this._IgnoreNextSelChange=0;this._IgnoreBlurFocus=!1;this._SelectionControl=this._Selection=null}a.prototype.setFocusTimer=function(){this.focusing=!0;this.focusTimer=window.setTimeout(function(){this.focusing=!1}.bind(this),50)};return a}();h.CommonDOMStates=k;var e=function(){function a(c){this.setFocus=function(a){}.bind(this);this.setBlur=function(a){}.bind(this);this._ControlFocus=function(c){var d=this.keyman.util.device;
c=this.keyman._GetEventObject(c);c=this.keyman.util.eventTarget(c);if(null==c)return!0;c.body&&(c=c.body);if(d.touchable&&(null==c.className||0>c.className.indexOf("keymanweb-input")))return!0;c.nodeName.toLowerCase();if(c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLInputElement){if(d=c.type.toLowerCase(),"text"!=d&&"search"!=d)return!0}else if(!(c.ownerDocument&&"on"==c.ownerDocument.designMode||!d.touchable&&c.isContentEditable||c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLTextAreaElement))return!0;
d=a.states._lastActiveElement;3==c.nodeType&&(c=c.parentNode);var l=c;(null==c.className||0>c.className.indexOf("keymanweb-input"))&&this instanceof b&&this.scrollBody(c);c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(this.keyman.domManager._AttachToIframe(c),c=c.contentWindow.document.body);this.keyman.domManager.lastActiveElement=c;this.keyman.domManager.activeElement=c;this.keyman.uiManager.justActivated?this._BlurKeyboardSettings(c):this._FocusKeyboardSettings(c,
d?!1:!0);if(this._CommonFocusHelper(c))return!0;c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLElement&&this.keyman.domManager._SetTargDir(c);this.doControlFocused(l,this.keyman.domManager.lastActiveElement);return!0}.bind(this);this._ControlBlur=function(b){b=this.keyman._GetEventObject(b);var c=this.keyman.util.eventTarget(b);if(null==c)return!0;c.body&&(c=c.body);if(this.keyman.util.device.touchable&&(c=h.findTouchAliasTarget(c),!c))return!0;if(a.states._IgnoreNextSelChange)return a.states._IgnoreNextSelChange--,
b.cancelBubble=!0,b.stopPropagation(),!0;if(a.states._IgnoreBlurFocus)return b.cancelBubble=!0,b.stopPropagation(),!0;h.Utils.instanceof(this.keyman.domManager.activeElement,"TouchAliasElement")&&this.keyman.domManager.activeElement.hideCaret();3==c.nodeType&&(c=c.parentNode);c.ownerDocument&&c instanceof c.ownerDocument.defaultView.HTMLIFrameElement&&(c=c.contentWindow.frameElement);this.keyman.domManager.lastActiveElement&&this._BlurKeyboardSettings(this.keyman.domManager.lastActiveElement);this.keyman.domManager.activeElement=
null;this.keyman.domManager.lastActiveElement=c;this.keyman.uiManager.justActivated=!1;var d=this.keyman.uiManager.isActivating,e=g.keyman.singleton.core.activeKeyboard;!d&&e&&e.notify(0,h.Utils.getOutputTarget(c),0);this.doControlBlurred(c,b,d);this.doChangeEvent(c);this.keyman.resetContext();return!0}.bind(this);this._KeyDown=function(b){var c=this.keyman.core.activeKeyboard,d=this.keyman.util;if(a.states._DisableInput||null==c)return!0;c=d.eventTarget(b);if(d.device.touchable){if(c&&"undefined"!=
typeof c.kmwInput&&0==c.kmwInput)return!0}else if(c&&0<=c.className.indexOf("kmw-disabled"))return!0;return h.PreProcessor.keyDown(b)}.bind(this);this._Click=function(a){(a=a.target)&&a.base&&(a=a.base);g.keyman.singleton.core.processNewContextEvent(h.Utils.getOutputTarget(a));return!0}.bind(this);this._KeyPress=function(b){return a.states._DisableInput||null==this.keyman.core.activeKeyboard?!0:h.PreProcessor.keyPress(b)}.bind(this);this._KeyUp=function(a){var b=h.PreProcessor._GetKeyEventProperties(a,
!1);if(null==b)return!0;var c=h.PreProcessor.getEventOutputTarget(a),d=c.getElement();return 13!=b.Lcode||(b=!1,c instanceof d.ownerDocument.defaultView.HTMLTextAreaElement&&(b=!0),d.base&&d.base instanceof d.base.ownerDocument.defaultView.HTMLTextAreaElement&&(b=!0),b)?h.PreProcessor.keyUp(a):(d instanceof d.ownerDocument.defaultView.HTMLInputElement&&("search"==d.type||"submit"==d.type?d.form.submit():this.keyman.domManager.moveToNext(!1)),!0)}.bind(this);this.keyman=c}a.prototype.doControlFocused=
function(a,b){var c={};c.target=a;c.activeControl=b;return this.keyman.util.callEvent("kmw.controlfocused",c)};a.prototype.doControlBlurred=function(a,b,f){var c={};c.target=a;c.event=b;c.isActivating=f;return this.keyman.util.callEvent("kmw.controlblurred",c)};a.prototype._BlurKeyboardSettings=function(a,b,f){var c=this.keyman.core.activeKeyboard?this.keyman.core.activeKeyboard.id:"",d=this.keyman.keyboardManager.getActiveLanguage();void 0!==b&&void 0!==f&&(c=b,d=f);a&&null!=a._kmwAttachment.keyboard?
(a._kmwAttachment.keyboard=c,a._kmwAttachment.languageCode=d):(this.keyman.globalKeyboard=c,this.keyman.globalLanguageCode=d)};a.prototype._FocusKeyboardSettings=function(a,b){var c;a&&null!=a._kmwAttachment.keyboard?this.keyman.keyboardManager.setActiveKeyboard(a._kmwAttachment.keyboard,a._kmwAttachment.languageCode):b||this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode);this.keyman.modelManager&&(a=h.Utils.getOutputTarget(a),this.keyman.core.languageProcessor.invalidateContext(a,
null===(c=this.keyman.core.keyboardProcessor)||void 0===c?void 0:c.layerId))};a.prototype._CommonFocusHelper=function(b){var c,f=g.keyman.singleton,l=this.keyman.uiManager;if(b.ownerDocument&&b instanceof b.ownerDocument.defaultView.HTMLIFrameElement&&(!this.keyman.domManager._IsIEEditableIframe(b,1)||!this.keyman.domManager._IsMozillaEditableIframe(b,1)))return a.states._DisableInput=!0;a.states._DisableInput=!1;var e=h.Utils.getOutputTarget(b),k=f.core.activeKeyboard;l.justActivated||(b&&e&&e.deadkeys().clear(),
k&&k.notify(0,e,1));l.justActivated||a.states._SelectionControl==b||(l.isActivating=!1);l.justActivated=!1;(a.states._SelectionControl=b)&&e&&window.setTimeout(function(){g.keyman.singleton.core.processNewContextEvent(e)});f.core.languageProcessor.isActive&&f.core.languageProcessor.predictFromTarget(e,null===(c=f.core.keyboardProcessor)||void 0===c?void 0:c.layerId);return!1};a.prototype.doChangeEvent=function(b){if(a.states.changed){if("function"==typeof Event)var c=new Event("change",{bubbles:!0,
cancelable:!1});else c=document.createEvent("HTMLEvents"),c.initEvent("change",!0,!1);b.base&&b.base.kmw_ip&&(b=b.base);b.dispatchEvent(c)}a.states.changed=!1};a.states=new k;return a}();h.DOMEventHandlers=e;var b=function(a){function b(c){c=a.call(this,c)||this;c.setFocus=function(a){e.states.setFocusTimer();if(a&&h.Utils.instanceof(a,"TouchEvent"))try{var c=b.selectTouch(a)}catch(q){console.warn(q);return}else c={pageX:0,pageY:0},this.keyman.domManager.lastActiveElement?(c.target=this.keyman.domManager.lastActiveElement,
c.target.kmw_ip&&(c.target=c.target.kmw_ip)):c.target=this.keyman.domManager.sortedInputs[0].kmw_ip;this.setFocusWithTouch(c)}.bind(c);c.setBlur=function(a){if("relatedTarget"in a&&a.relatedTarget)var b=a.relatedTarget;this.executeBlur(b)}.bind(c);c.dragEnd=function(a){a.stopPropagation();this.firstTouch=null}.bind(c);c.dragInput=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();if(h.Utils.instanceof(a,"TouchEvent")){try{var c=b.selectTouch(a)}catch(v){console.warn(v);return}var d=
c.target}else d=a.target;if(null!=d&&(d=h.findTouchAliasTarget(d))){if(h.Utils.instanceof(a,"TouchEvent")){var f=c.screenX;c=c.screenY}else f=a.screenX,c=a.screenY;if("undefined"==typeof this.firstTouch||null==this.firstTouch)this.firstTouch={x:f,y:c};else{var e=this.firstTouch.x,g=this.firstTouch.y;a=d.firstChild;if("TEXTAREA"==d.base.nodeName){if(f=parseInt(a.style.top,10),isNaN(f)&&(f=0),e=g-c,-4>e||4<e)a.style.top=(f<e?f-e:0)+"px",this.firstTouch.y=c}else{c=parseInt(a.style.left,10);isNaN(c)&&
(c=0);var k=e-f;if(-4>k||4<k)e=0,g=h.Utils.getAbsoluteX(d)+d.offsetWidth-a.offsetWidth-32,"rtl"==d.base.dir?e=16:g-=24,c-=k,c>e&&(c=e),c<g&&(c=g),a.style.left=c+"px",this.firstTouch.x=f}}this.setScrollBar(d)}}.bind(c);return c}__extends(b,a);b.selectTouch=function(a){for(var b=a.target,c=0;c<a.changedTouches.length;c++)if(a.target==b&&h.findTouchAliasTarget(a.changedTouches[c].target))return a.changedTouches[c];throw Error("Could not select valid Touch for event.");};b.prototype.setFocusWithTouch=
function(a){var b=a.pageX,c=a.pageY,d=a.target;if(a=h.findTouchAliasTarget(d)){var e=a.firstChild;if(this.keyman.domManager.activeElement!=a){var g=this.keyman.domManager.activeElement;g&&g.kmw_ip&&(g=g.kmw_ip);g&&h.Utils.instanceof(g,"TouchAliasElement")&&g.hideCaret();this.keyman.domManager.activeElement=a;a.focus()}this.keyman.domManager._SetTargDir(a);d&&d==a?(c=h.Utils.getAbsoluteX(e.firstChild),"rtl"==a.dir?(c+=e.firstChild.offsetWidth,b=b>c?0:1E5):b=b<c?0:1E5,a.setTextCaret(b),a.scrollInput()):
d!=e.nextSibling&&a.executeCaretSearch(b,c);this.keyman.domManager.lastActiveElement&&this._BlurKeyboardSettings(this.keyman.domManager.lastActiveElement);this.keyman.domManager.lastActiveElement=a;a.showCaret();this._FocusKeyboardSettings(a,!1);this._CommonFocusHelper(a)}};b.prototype.cancelInput=function(){this.keyman.domManager.activeElement=null;this.keyman.domManager.lastActiveElement=null;this.keyman.osk.hideNow()};b.prototype.executeBlur=function(a){this.keyman.resetContext();if(a&&(this.doChangeEvent(a),
"DIV"!=a.nodeName||-1==a.className.indexOf("keymanweb-input"))){this.cancelInput();return}e.states.focusing||this.keyman.uiManager.justActivated||this.cancelInput()};b.prototype.setScrollBar=function(a){var b=a.childNodes[0],c=a.childNodes[1].style;(b.offsetWidth>a.offsetWidth||0>b.offsetLeft)&&"TEXTAREA"!=a.base.nodeName?(c.height="4px",c.width=a.offsetWidth/b.offsetWidth*100+"%",c.left=-b.offsetLeft/b.offsetWidth*100+"%",c.top="0",c.visibility="visible"):b.offsetHeight>a.offsetHeight||0>b.offsetTop?
(c.width="4px",c.height=a.offsetHeight/b.offsetHeight*100+"%",c.top=-b.offsetTop/b.offsetHeight*100+"%",c.left="0",c.visibility="visible"):c.visibility="hidden"};b.prototype.scrollBody=function(a){var b=this.keyman.osk;if(a&&null!=a.className&&!(0>a.className.indexOf("keymanweb-input"))&&b){a=a.firstChild.childNodes[1];var c=h.Utils.getAbsoluteY(a),d=window.pageYOffset;c<d?b=c-d:(b=c-d-(window.innerHeight-b._Box.offsetHeight-a.offsetHeight-2),0>b&&(b=0));0!=b&&window.scrollTo(0,b+window.pageYOffset)}};
return b}(e);h.DOMTouchHandlers=b})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=k.text.DefaultOutput,e=k.text.Codes,b=n.isCommand,a=n.applyCommand;n.isCommand=function(a){switch(n.codeForEvent(a)){case e.keyCodes.K_TAB:case e.keyCodes.K_TABBACK:case e.keyCodes.K_TABFWD:return!0;default:return b(a)}};n.applyCommand=function(b,d){var c=n.codeForEvent(b),l=g.keyman.singleton.domManager;var h=d instanceof g.keyman.dom.targets.TouchAlias?function(){d.root.hideCaret()}:function(){};switch(c){case e.keyCodes.K_TAB:h();l.moveToNext(0!=(b.Lmodifiers&
k.text.Codes.modifierCodes.SHIFT));break;case e.keyCodes.K_TABBACK:h();l.moveToNext(!0);break;case e.keyCodes.K_TABFWD:h(),l.moveToNext(!1)}a(b,d)}})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){k.text.prediction.LanguageProcessor.prototype.canEnable=function(){var e=g.keyman.singleton;return 10==e.util.getIEVersion()?(console.warn("KeymanWeb cannot properly initialize its WebWorker in this version of IE."),!1):10>e.util.getIEVersion()?(console.warn("WebWorkers are not supported in this version of IE."),!1):"function"!=typeof Worker?(console.warn("WebWorkers are not supported by this browser."),!1):!0};var n=k.text.RuleBehavior.prototype.finalize;k.text.RuleBehavior.prototype.finalize=
function(e,b,a){var c=g.keyman.singleton;n.call(this,e);a||(e=this.transcription.transform,(""!=e.insert||0<e.deleteLeft||0<e.deleteRight)&&b instanceof h.targets.OutputTarget&&b.getElement()==c.domManager.activeElement&&(h.DOMEventHandlers.states.changed=!0),c.isEmbedded&&(c.oninserttext(e.deleteLeft,e.insert,e.deleteRight),b instanceof h.targets.OutputTarget&&c.refreshElementContent(b.getElement())))}})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(h){var e=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}__extends(a,b);a.prototype.focus=function(){var a=this.getElement();a.focus&&a.focus()};a.prototype.dispatchInputEventOn=function(a){var b;window.InputEvent&&(b=new InputEvent("input",{bubbles:!0,cancelable:!1}));a&&b&&a.dispatchEvent(b)};a.prototype.apply=function(a){b.prototype.apply.call(this,a);var c=g.keyman.singleton;if(c&&c.oninserttext&&c.isEmbedded)c.oninserttext(a.deleteLeft,
a.insert,a.deleteRight)};return a}(k.text.OutputTarget);h.OutputTarget=e})(h.targets||(h.targets={}))})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(k){var e=function(b){function a(a){var c=b.call(this)||this;c.root=a;c._cachedSelectionStart=-1;return c}__extends(a,b);Object.defineProperty(a.prototype,"isSynthetic",{get:function(){return!1},enumerable:!0,configurable:!0});a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){this.getCaret();this.root.value=this.root.value._kmwSubstring(0,this.processedSelectionStart)+this.root.value._kmwSubstring(this.processedSelectionEnd);
this.setCaret(this.processedSelectionStart)};a.prototype.isSelectionEmpty=function(){return this.root.selectionStart==this.root.selectionEnd};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=
this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return"forward"==this.root.selectionDirection?this.processedSelectionEnd:this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a,"none")};a.prototype.setSelection=function(a,b,f){var c=this.root.value._kmwCodePointToCodeUnit(a),d=this.root.value._kmwCodePointToCodeUnit(b);this.root.setSelectionRange(c,d,f);this.processedSelectionStart=a;this.processedSelectionEnd=
b;h.Utils.forceScroll(this.root)};a.prototype.getSelectionDirection=function(){return this.root.selectionDirection};a.prototype.getTextBeforeCaret=function(){this.getCaret();return this.getText()._kmwSubstring(0,this.processedSelectionStart)};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=this.processedSelectionEnd-this.processedSelectionStart,c=this.getSelectionDirection(),l=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setSelection(l,
l+b,c)};a.prototype.setTextAfterCaret=function(a){this.getCaret();var b=this.getSelectionDirection();this.root.value=this.getTextBeforeCaret()+a;this.setSelection(this.processedSelectionStart,this.processedSelectionEnd,b)};a.prototype.getTextAfterCaret=function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret(),c=this.processedSelectionStart;
a>c&&(a=c);this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,c-a));this.setCaret(c-a)}};a.prototype.insertTextBeforeCaret=function(a){if(a){var b=this.getCaret(),c=this.getTextBeforeCaret(),l=this.getText()._kmwSubstring(this.processedSelectionStart);this.adjustDeadkeys(a._kmwLength());this.root.value=c+a+l;this.setCaret(b+a._kmwLength())}};a.prototype.handleNewlineAtCaret=function(){a.newlineHandler(this.root)};a.newlineHandler=function(a){!a||"search"!=a.type&&"submit"!=a.type?g.keyman.singleton&&
g.keyman.singleton.domManager.moveToNext(!1):(a.disabled=!1,a.form.submit())};a.prototype.doInputEvent=function(){this.dispatchInputEventOn(this.root)};return a}(k.OutputTarget);k.Input=e})(h.targets||(h.targets={}))})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(h){var e=function(b){function a(a){var c=b.call(this)||this;c.root=a;c._cachedSelectionStart=-1;return c}__extends(a,b);Object.defineProperty(a.prototype,"isSynthetic",{get:function(){return!1},enumerable:!0,configurable:!0});a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){this.getCaret();this.root.value=this.root.value._kmwSubstring(0,this.processedSelectionStart)+this.root.value._kmwSubstring(this.processedSelectionEnd);
this.setCaret(this.processedSelectionStart)};a.prototype.isSelectionEmpty=function(){return this.root.selectionStart==this.root.selectionEnd};a.prototype.hasSelection=function(){return!0};a.prototype.invalidateSelection=function(){this._cachedSelectionStart=-1};a.prototype.getCaret=function(){this.root.selectionStart!=this._cachedSelectionStart&&(this._cachedSelectionStart=this.root.selectionStart,this.processedSelectionStart=this.root.value._kmwCodeUnitToCodePoint(this.root.selectionStart),this.processedSelectionEnd=
this.root.value._kmwCodeUnitToCodePoint(this.root.selectionEnd));return"forward"==this.root.selectionDirection?this.processedSelectionEnd:this.processedSelectionStart};a.prototype.getDeadkeyCaret=function(){return this.getCaret()};a.prototype.setCaret=function(a){this.setSelection(a,a,"none")};a.prototype.setSelection=function(a,b,f){var c=this.root.value._kmwCodePointToCodeUnit(a),d=this.root.value._kmwCodePointToCodeUnit(b);this.root.setSelectionRange(c,d,f);this.processedSelectionStart=a;this.processedSelectionEnd=
b;g.Utils.forceScroll(this.root)};a.prototype.getSelectionDirection=function(){return this.root.selectionDirection};a.prototype.getTextBeforeCaret=function(){this.getCaret();return this.getText()._kmwSubstring(0,this.processedSelectionStart)};a.prototype.setTextBeforeCaret=function(a){this.getCaret();var b=this.processedSelectionEnd-this.processedSelectionStart,c=this.getSelectionDirection(),l=a._kmwLength();this.root.value=a+this.getText()._kmwSubstring(this.processedSelectionStart);this.setSelection(l,
l+b,c)};a.prototype.setTextAfterCaret=function(a){this.getCaret();var b=this.getSelectionDirection();this.root.value=this.getTextBeforeCaret()+a;this.setSelection(this.processedSelectionStart,this.processedSelectionEnd,b)};a.prototype.getTextAfterCaret=function(){this.getCaret();return this.getText()._kmwSubstring(this.processedSelectionEnd)};a.prototype.getText=function(){return this.root.value};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret(),c=this.processedSelectionStart;
a>c&&(a=c);this.adjustDeadkeys(-a);this.setTextBeforeCaret(b.kmwSubstring(0,c-a));this.setCaret(c-a)}};a.prototype.insertTextBeforeCaret=function(a){if(a){var b=this.getCaret(),c=this.getTextBeforeCaret(),l=this.getText()._kmwSubstring(this.processedSelectionStart);this.adjustDeadkeys(a._kmwLength());this.root.value=c+a+l;this.setCaret(b+a._kmwLength())}};a.prototype.handleNewlineAtCaret=function(){this.insertTextBeforeCaret("\n")};a.prototype.doInputEvent=function(){this.dispatchInputEventOn(this.root)};
return a}(h.OutputTarget);h.TextArea=e})(g.targets||(g.targets={}))})(g.dom||(g.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(g){var e=function(){return function(a,b){this.node=a;this.offset=b}}(),b=function(){return function(a,b){this.start=a;this.end=b}}(),a=function(a){function c(b){if(b.isContentEditable){var c=a.call(this)||this;c.root=b}else throw"Specified element is not already content-editable!";return c}__extends(c,a);Object.defineProperty(c.prototype,"isSynthetic",{get:function(){return!1},enumerable:!0,configurable:!0});c.prototype.getElement=function(){return this.root};
c.prototype.isSelectionEmpty=function(){return this.hasSelection()?this.root.ownerDocument.getSelection().isCollapsed:!0};c.prototype.hasSelection=function(){var a=this.root.ownerDocument.getSelection(),b=function(a,b){return 3!=b.nodeType?null:0!=(b.compareDocumentPosition(a)&8)};return this.root!=a.anchorNode&&!this.root.contains(a.anchorNode)&&!b(this.root,a.anchorNode)||this.root!=a.focusNode&&!this.root.contains(a.focusNode)&&!b(this.root,a.anchorNode)?!1:!0};c.prototype.clearSelection=function(){if(this.hasSelection()){var a=
this.root.ownerDocument.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};c.prototype.invalidateSelection=function(){};c.prototype.getCarets=function(){var a=this.root.ownerDocument.getSelection(),c=a.anchorNode.compareDocumentPosition(a.focusNode);if(a.isCollapsed)return c=new e(a.anchorNode,a.anchorOffset),new b(c,c);var d=new e(a.anchorNode,a.anchorOffset);a=new e(a.focusNode,a.focusOffset);d.node==a.node&&(c=0<a.offset-d.offset?
2:4);return c&2?new b(d,a):new b(a,d)};c.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};c.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};c.prototype.getTextAfterCaret=function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};c.prototype.getText=function(){return this.root.innerText};
c.prototype.deleteCharsBeforeCaret=function(a){if(this.hasSelection()&&!(0>=a)){var b=this.getCarets().start;a>b.offset&&(a=b.offset);if(3!=b.node.nodeType)console.warn("Deletion of characters requested without available context!");else{var c=this.root.ownerDocument.createRange(),d=b.offset-b.node.nodeValue.substr(0,b.offset)._kmwSubstr(-a).length;c.setStart(b.node,d);c.setEnd(b.node,b.offset);this.adjustDeadkeys(-a);c.deleteContents()}}};c.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var b=
this.getCarets().start,c=a._kmwLength(),d=this.root.ownerDocument.getSelection();if(0!=c){this.adjustDeadkeys(c);c=this.root.ownerDocument.createRange();if(3==b.node.nodeType){var f=b.node;f.insertData(b.offset,a);c.setStart(f,b.offset+a.length)}else{f=b.node.ownerDocument.createTextNode(a);var e=this.root.ownerDocument.createRange();e.setStart(b.node,b.offset);e.collapse(!0);e.insertNode(f);c.setStart(f,a.length)}c.collapse(!0);d.removeAllRanges();try{d.addRange(c)}catch(t){b.node.parentElement.scrollIntoView(),
d.addRange(c)}d.collapseToEnd()}}};c.prototype.handleNewlineAtCaret=function(){};c.prototype.setTextAfterCaret=function(a){if(this.hasSelection()){var b=this.getCarets().end,c=a._kmwLength();this.root.ownerDocument.getSelection();0!=c&&(3==b.node.nodeType?(c=b.node,c.replaceData(b.offset,c.length,a)):(a=b.node.ownerDocument.createTextNode(a),c=this.root.ownerDocument.createRange(),c.setStart(b.node,b.offset),c.collapse(!0),c.insertNode(a)))}};c.prototype.doInputEvent=function(){this.dispatchInputEventOn(this.root)};
return c}(g.OutputTarget);g.ContentEditable=a})(g.targets||(g.targets={}))})(g.dom||(g.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(g){var e=function(){return function(a,b){this.node=a;this.offset=b}}(),b=function(){return function(a,b){this.start=a;this.end=b}}(),a=function(){return function(a,b){this.cmd=a;this.stateType=b}}(),c=function(c){function d(a){var b=c.call(this)||this;b.root=a;if(a.contentWindow&&a.contentWindow.document&&"on"==a.contentWindow.document.designMode)b.doc=a.contentWindow.document,b.docRoot=a.contentWindow.document.documentElement;else throw"Specified IFrame is not in design-mode!";
return b}__extends(d,c);Object.defineProperty(d.prototype,"isSynthetic",{get:function(){return!1},enumerable:!0,configurable:!0});d.prototype.getElement=function(){return this.root};d.prototype.focus=function(){this.doc.defaultView.focus()};d.prototype.isSelectionEmpty=function(){return this.hasSelection()?this.doc.getSelection().isCollapsed:!0};d.prototype.hasSelection=function(){this.doc.getSelection();document.getSelection();return!0};d.prototype.clearSelection=function(){if(this.hasSelection()){var a=
this.doc.getSelection();a.isCollapsed||a.deleteFromDocument()}else console.warn("Attempted to clear an unowned Selection!")};d.prototype.invalidateSelection=function(){};d.prototype.getCarets=function(){var a=this.doc.getSelection(),c=a.anchorNode.compareDocumentPosition(a.focusNode);if(a.isCollapsed)return c=new e(a.anchorNode,a.anchorOffset),new b(c,c);var d=new e(a.anchorNode,a.anchorOffset);a=new e(a.focusNode,a.focusOffset);d.node==a.node&&(c=0<a.offset-d.offset?2:4);return c&2?new b(d,a):new b(a,
d)};d.prototype.getDeadkeyCaret=function(){return this.getTextBeforeCaret().kmwLength()};d.prototype.getTextBeforeCaret=function(){if(this.hasSelection()){var a=this.getCarets().start;return 3!=a.node.nodeType?"":a.node.textContent.substr(0,a.offset)}};d.prototype.getTextAfterCaret=function(){if(this.hasSelection()){var a=this.getCarets().end;return 3!=a.node.nodeType?"":a.node.textContent.substr(a.offset)}};d.prototype.getText=function(){return this.docRoot.innerText};d.prototype.deleteCharsBeforeCaret=
function(a){if(this.hasSelection()&&!(0>=a)){var b=this.getCarets().start;a>b.offset&&(a=b.offset);if(3!=b.node.nodeType)console.warn("Deletion of characters requested without available context!");else{var c=this.doc.createRange(),d=b.offset-b.node.nodeValue.substr(0,b.offset)._kmwSubstr(-a).length;c.setStart(b.node,d);c.setEnd(b.node,b.offset);this.adjustDeadkeys(-a);c.deleteContents()}}};d.prototype.insertTextBeforeCaret=function(a){if(this.hasSelection()){var b=this.getCarets().start,c=a._kmwLength(),
d=this.doc.getSelection();if(0!=c){this.adjustDeadkeys(c);c=this.root.ownerDocument.createRange();if(3==b.node.nodeType){var f=b.node;f.insertData(b.offset,a);c.setStart(f,b.offset+a.length)}else{f=this.doc.createTextNode(a);var l=this.doc.createRange();l.setStart(b.node,b.offset);l.collapse(!0);l.insertNode(f);c.setStart(f,a.length)}c.collapse(!0);d.removeAllRanges();try{d.addRange(c)}catch(v){b.node.parentElement.scrollIntoView(),d.addRange(c)}d.collapseToEnd()}}};d.prototype.handleNewlineAtCaret=
function(){};d.prototype.setTextAfterCaret=function(a){if(this.hasSelection()){var b=this.getCarets().end,c=a._kmwLength();this.doc.getSelection();0!=c&&(3==b.node.nodeType?(c=b.node,c.replaceData(b.offset,c.length,a)):(a=b.node.ownerDocument.createTextNode(a),c=this.root.ownerDocument.createRange(),c.setStart(b.node,b.offset),c.collapse(!0),c.insertNode(a)))}};d.prototype.saveProperties=function(){var b=[new a("backcolor",1),new a("fontname",1),new a("fontsize",1),new a("forecolor",1),new a("bold",
0),new a("italic",0),new a("strikethrough",0),new a("subscript",0),new a("superscript",0),new a("underline",0)];this.doc.defaultView&&b.push(new a("hilitecolor",1));for(var c=0;c<b.length;c++){var d=b[c];d.cache=1==d.stateType?this.doc.queryCommandValue(d.cmd):this.doc.queryCommandState(d.cmd)}this.commandCache=b};d.prototype.restoreProperties=function(a){this.commandCache||console.error("No command cache exists to restore!");for(var b=0;b<this.commandCache.length;b++){var c=this.commandCache[b];
1==c.stateType?this.doc.queryCommandValue(c.cmd)!=c.cache&&(a&&a(),this.doc.execCommand(c.cmd,!1,c.cache)):this.doc.queryCommandState(c.cmd)!=c.cache&&(a&&a(),this.doc.execCommand(c.cmd,!1,null))}};d.prototype.doInputEvent=function(){this.dispatchInputEventOn(this.root)};return d}(g.OutputTarget);g.DesignIFrame=c})(g.targets||(g.targets={}))})(g.dom||(g.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(h){var e=function(b){function a(a){var c=b.call(this)||this;c.root=a;return c}__extends(a,b);a.prototype.getElement=function(){return this.root};a.prototype.clearSelection=function(){};a.prototype.invalidateSelection=function(){};a.prototype.isSelectionEmpty=function(){return!0};a.prototype.hasSelection=function(){return!0};a.prototype.getDeadkeyCaret=function(){return this.root.getTextCaret()};a.prototype.getTextBeforeCaret=function(){return this.root.getTextBeforeCaret()};
a.prototype.getTextAfterCaret=function(){return this.root.getTextAfterCaret()};a.prototype.getText=function(){return this.root.getText()};a.prototype.deleteCharsBeforeCaret=function(a){if(0<a){var b=this.getTextBeforeCaret();this.getDeadkeyCaret()<a&&(a=this.getDeadkeyCaret());this.adjustDeadkeys(-a);this.root.setTextBeforeCaret(b.kmwSubstring(0,this.root.getTextCaret()-a))}};a.prototype.insertTextBeforeCaret=function(a){this.adjustDeadkeys(a._kmwLength());this.root.setTextBeforeCaret(this.root.getTextBeforeCaret()+
a)};a.prototype.handleNewlineAtCaret=function(){"TEXTAREA"==this.root.base.nodeName?this.insertTextBeforeCaret("\n"):g.Utils.instanceof(this.root.base,"HTMLInputElement")?(this.root.hideCaret(),h.Input.newlineHandler(this.root.base)):console.warn("TouchAlias OutputTarget cannot output newlines for unexpected base element types!")};a.prototype.setTextAfterCaret=function(a){this.root.setText(this.getTextBeforeCaret()+a,this.getTextBeforeCaret()._kmwLength())};a.prototype.doInputEvent=function(){this.dispatchInputEventOn(this.root.base)};
return a}(h.OutputTarget);h.TouchAlias=e})(g.targets||(g.targets={}))})(g.dom||(g.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(h){h.wrapElement=function(e){return g.Utils.instanceof(e,"HTMLInputElement")?new h.Input(e):g.Utils.instanceof(e,"HTMLTextAreaElement")?new h.TextArea(e):g.Utils.instanceof(e,"TouchAliasElement")?new h.TouchAlias(e):g.Utils.instanceof(e,"HTMLIFrameElement")&&e.contentWindow&&e.contentWindow.document&&"on"==e.contentWindow.document.designMode?new h.DesignIFrame(e):e.isContentEditable?new h.ContentEditable(e):null}})(g.targets||(g.targets={}))})(g.dom||
(g.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var k=function(){function e(){}e.prototype.loadStore=function(b,a){b=g.keyman.singleton.util.loadCookie("KeymanWeb_"+b+"_Option_"+a);"undefined"!=typeof b[a]&&(b[a]=decodeURIComponent(b[a]));return b||{}};e.prototype.saveStore=function(b,a,c){b="KeymanWeb_"+b+"_Option_"+a;c[a]=encodeURIComponent(c[a]);g.keyman.singleton.util.saveCookie(b,c)};return e}();h.VariableStoreCookieSerializer=k})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function b(a){this.e=a;this.c=a.style.backgroundColor}b.prototype.reset=function(){this.e.style.backgroundColor=this.c};return b}(),e=function(){function b(a){this.inputList=[];this.sortedInputs=[];this._BeepObjects=[];this._BeepTimeout=0;this.deactivateOnRelease=this.deactivateOnScroll=!1;this.nonKMWTouchHandler=function(a){h.DOMEventHandlers.states.focusing=!1;clearTimeout(h.DOMEventHandlers.states.focusTimer);this.keyman.osk.hideNow()}.bind(this);
this._EnablementMutationObserverCore=function(a){for(var b=0;b<a.length;b++){var c=a[b],l=c.oldValue?0<=c.oldValue.indexOf("kmw-disabled"):!1,e=0<=c.target.className.indexOf("kmw-disabled");l&&!e?this._EnableControl(c.target):!l&&e&&this._DisableControl(c.target);!e&&"readonly"==c.attributeName&&(l=c.oldValue?null!=c.oldValue:!1,e=c.target,e instanceof e.ownerDocument.defaultView.HTMLInputElement||e instanceof e.ownerDocument.defaultView.HTMLTextAreaElement)&&(e=e.readOnly,l&&!e?this._EnableControl(c.target):
!l&&e&&this._DisableControl(c.target))}}.bind(this);this._AutoAttachObserverCore=function(a){for(var b=[],c=[],l=0;l<a.length;l++){for(var e=a[l],g=0;g<e.addedNodes.length;g++)b=b.concat(this._GetDocumentEditables(e.addedNodes[g]));for(g=0;g<e.removedNodes.length;g++)c=c.concat(this._GetDocumentEditables(e.removedNodes[g]))}for(a=0;a<b.length;a++)this.isKMWInput(b[a])&&this._MutationAdditionObserved(b[a]);for(a=0;a<c.length;a++)this.isKMWInput(c[a])&&this._MutationRemovalObserved(c[a]);if(b.length||
c.length)if(!this.keyman.util.device.touchable)this.listInputs();else if(this.keyman.util.device.touchable){var h=this;window.setTimeout(function(){h.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput()}.bind(this),1)}}.bind(this);this._MutationAdditionObserved=function(a){if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!this.keyman.util.device.touchable){var b=this;a.addEventListener("load",function(){window.setTimeout(function(){b.attachToControl(a)},
1)})}else this.attachToControl(a)};this._MutationRemovalObserved=function(a){this.keyman.util.device.touchable&&this.disableTouchElement(a);this.disableInputElement(a);this.clearElementAttachment(a)};this.enableControl=function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0<=b.indexOf("kmw-disabled")&&(a.className=b.replace("kmw-disabled","").trim())};this._WindowLoad=function(a){document.body.scrollTop=0;"undefined"!=typeof document.documentElement&&
(document.documentElement.scrollTop=0)}.bind(this);this._WindowUnload=function(){this.keyman.uiManager.doUnload();this.keyman.osk&&(this.keyman.osk.shutdown(),this.keyman.osk._Unload&&this.keyman.osk._Unload());this.lastActiveElement=null}.bind(this);this.init=function(a){var c=this.keyman.util;var f=c.device;this.keyman.core.keyboardProcessor.beepHandler=this.doBeep.bind(this);this.keyman.core.keyboardProcessor.warningLogger=console.warn.bind(console);this.keyman.core.keyboardProcessor.errorLogger=
console.error.bind(console);var l=function(a){if(0==a.length)return a;"/"!=a.substr(a.length-1,1)&&(a+="/");return"http"==a.replace(/^(http)s?:.*/,"$1")||"file"==a.replace(/^(file):.*/,"$1")?a:"//"==a.substr(0,2)?this.keyman.protocol+a:"/"==a.substr(0,1)?this.keyman.rootPath+a.substr(1):this.keyman.srcPath+a}.bind(this);var e=this.keyman.options;if("object"==typeof a&&null!==a)for(k in e)a.hasOwnProperty(k)&&(e[k]=a[k]);""!=e.root&&(this.keyman.rootPath=l(e.root));""==e.resources&&(e.resources=this.keyman.srcPath);
e.resources=l(e.resources);e.keyboards=l(e.keyboards);e.fonts=l(e.fonts);this.keyman.setDefaultDeviceOptions(e);if(this.keyman.initialized)return Promise.resolve();var k=this.keyman;var n=this;if("complete"!==document.readyState)return new Promise(function(b){window.setTimeout(function(){n.init(a).then(function(){b()})},50)});k.modelManager.init();this.keyman._MasterDocument=window.document;this.keyman.setInitialized(1);this.keyman.osk=f.touchable?new g.keyman.osk.AnchoredOSKView(f.coreSpec):new g.keyman.osk.FloatingOSKView(f.coreSpec);
c.prepareWait();this.keyman.keyboardManager.endDeferment();this.initializeUI();if(this.keyman.isEmbedded)return this.keyman.keyboardManager.setDefaultKeyboard(),Promise.resolve();this.keyman.appliedFont=this.keyman.baseFont=this.getBaseFont();f.touchable&&this.keyman.handleRotationEvents();"manual"!=this.keyman.options.attachType&&this._SetupDocument(document.documentElement);this.listInputs();if(f.touchable){var u=k.osk;u._Box.addEventListener("touchend",function(a){a.stopPropagation()},!1);c=document.createElement("DIV");
k=c.style;k.width="100%";k.height=screen.width/2+"px";document.body.appendChild(c);var t=this;this.touchStartActivationHandler=function(a){t.deactivateOnRelease=!0;t.touchY=a.touches[0].screenY;t.deactivateOnScroll=!1;if("Android"==f.OS&&0<navigator.userAgent.indexOf("Chrome")){if("undefined"==typeof u._Box||"undefined"==typeof u._Box.style)return!1;a=a.target.parentElement;if("undefined"!=typeof a&&null!=a&&(0<=a.className.indexOf("keymanweb-input")||0<=a.className.indexOf("kmw-key-")||"undefined"!=
typeof a.parentElement&&null!=a.parentElement&&(a=a.parentElement,0<=a.className.indexOf("keymanweb-input")||0<=a.className.indexOf("kmw-key-"))))return!1;t.deactivateOnScroll=!0}return!1};this.touchMoveActivationHandler=function(a){t.deactivateOnScroll&&(h.DOMEventHandlers.states.focusing=!1,t.activeElement=null);a=a.touches[0].screenY;var b=t.touchY;if(5<a-b||5>b-a)t.deactivateOnRelease=!1;return!1};this.touchEndActivationHandler=function(){!t.deactivateOnRelease||u.lgList||h.DOMEventHandlers.states.focusing||
(t.activeElement=null);return t.deactivateOnRelease=!1};this.keyman.util.attachDOMEvent(document.body,"touchstart",this.touchStartActivationHandler,!1);this.keyman.util.attachDOMEvent(document.body,"touchmove",this.touchMoveActivationHandler,!1);this.keyman.util.attachDOMEvent(document.body,"touchend",this.touchEndActivationHandler,!1)}this.keyman.keyboardManager.restoreCurrentKeyboard();"function"==typeof MutationObserver?(c=document.querySelector("body"),"manual"!=this.keyman.options.attachType&&
(k={childList:!0,subtree:!0},this.attachmentObserver=new MutationObserver(this._AutoAttachObserverCore),this.attachmentObserver.observe(c,k)),k={subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["class","readonly"]},this.enablementObserver=new MutationObserver(this._EnablementMutationObserverCore),this.enablementObserver.observe(c,k)):console.warn("Your browser is outdated and does not support MutationObservers, a web feature needed by KeymanWeb to support dynamically-added elements.");
this.keyman.util.attachDOMEvent(document.body,"focus",b.suppressFocusCheck,!0);this.keyman.util.attachDOMEvent(document.body,"blur",b.suppressFocusCheck,!0);this.keyman.setInitialized(2);return Promise.resolve()}.bind(this);this.keyman=a;a.util.device.touchable&&(this.touchHandlers=new h.DOMTouchHandlers(a));this.nonTouchHandlers=new h.DOMEventHandlers(a)}b.prototype.shutdown=function(){try{this.enablementObserver&&this.enablementObserver.disconnect();this.attachmentObserver&&this.attachmentObserver.disconnect();
for(var a=0,c=this.inputList;a<c.length;a++)this.disableInputElement(c[a]);this.keyman.util.detachDOMEvent(document.body,"focus",b.suppressFocusCheck,!0);this.keyman.util.detachDOMEvent(document.body,"blur",b.suppressFocusCheck,!0);this.touchStartActivationHandler&&(this.keyman.util.detachDOMEvent(document.body,"touchstart",this.touchStartActivationHandler,!1),this.keyman.util.detachDOMEvent(document.body,"touchmove",this.touchMoveActivationHandler,!1),this.keyman.util.detachDOMEvent(document.body,
"touchend",this.touchEndActivationHandler,!1))}catch(d){console.error("Error occurred during shutdown"),console.error(d)}};b.prototype.doBeep=function(a){var b=g.keyman.singleton;if("beepKeyboard"in b)b.beepKeyboard();else if(a instanceof h.targets.OutputTarget&&(b=a.getElement(),a instanceof h.targets.DesignIFrame&&(b=a.docRoot),b&&b.style&&"undefined"!=typeof b.style.backgroundColor)){for(a=0;a<this._BeepObjects.length;a++)if(this._BeepObjects[a].e==b)return;this._BeepObjects=g.keyman.singleton._push(this._BeepObjects,
new n(b));b.style.backgroundColor="#000000";0==this._BeepTimeout&&(this._BeepTimeout=1,window.setTimeout(this.beepReset.bind(this),50))}};b.prototype.beepReset=function(){g.keyman.singleton.core.keyboardInterface.resetContextCache();var a;for(a=this._BeepTimeout=0;a<this._BeepObjects.length;a++)this._BeepObjects[a].reset();this._BeepObjects=[]};b.prototype.getHandlers=function(a){return(a=a.base?a.base._kmwAttachment:a._kmwAttachment)?a.touchEnabled?this.touchHandlers:this.nonTouchHandlers:this.keyman.touchAliasing};
b.prototype.enableTouchElement=function(a){if("iframe"==a.tagName.toLowerCase())return!1;if(this.isKMWDisabled(a))return this.setupNonKMWTouchElement(a),!1;a.kmwInput=!0;a.removeEventListener("touchstart",this.nonKMWTouchHandler);if(a.kmw_ip){if(-1!=this.inputList.indexOf(a.kmw_ip))return!1;this.inputList.push(a.kmw_ip);console.log("Unexpected state - this element's simulated input DIV should have been removed from the page!");return!0}var b=h.constructTouchAlias(a);this.isAttached(b)?b._kmwAttachment.interface=
h.targets.wrapElement(b):this.setupElementAttachment(b);a._kmwAttachment=b._kmwAttachment;this.enableInputElement(b,!0);var d=this.touchHandlers;b.addEventListener("touchstart",d.setFocus);b.onmspointerdown=function(a){a.preventDefault();a.stopPropagation();return d.setFocus(a)};b.addEventListener("touchend",d.dragEnd,!1);b.onmspointerup=function(a){a.stopPropagation()};b.addEventListener("touchmove",d.dragInput,!1);b.onmspointermove=d.dragInput;b.onblur=d.setBlur;return!0};b.prototype.disableTouchElement=
function(a){if("iframe"!=a.tagName.toLowerCase()){if(a.kmw_ip){var b=this.inputList.indexOf(a.kmw_ip);-1!=b&&this.inputList.splice(b,1);a.style.visibility="visible";a.disabled=!1;a.removeEventListener("resize",a.kmw_ip._kmwResizeHandler);this.disableInputElement(a.kmw_ip);a._kmwAttachment.interface=h.targets.wrapElement(a);a.parentNode&&a.parentNode.removeChild(a.kmw_ip);delete a.kmw_ip}this.setupNonKMWTouchElement(a)}};b.prototype.setupNonKMWTouchElement=function(a){this.keyman.util.attachDOMEvent(a,
"touchstart",this.nonKMWTouchHandler,!1);this.isAttached(a)&&(a._kmwAttachment.touchEnabled=!1)};b.prototype.enableInputElement=function(a,b){var c=b?a.base:a;this.isKMWDisabled(c)||(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement?this._AttachToIframe(a):(b||this.setupElementAttachment(a),c.className=c.className?c.className+" keymanweb-font":"keymanweb-font",this.inputList.push(a),this.keyman.util.attachDOMEvent(c,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.attachDOMEvent(c,
"blur",this.getHandlers(a)._ControlBlur),this.keyman.util.attachDOMEvent(c,"click",this.getHandlers(a)._Click),a.onkeypress=this.getHandlers(a)._KeyPress,a.onkeydown=this.getHandlers(a)._KeyDown,a.onkeyup=this.getHandlers(a)._KeyUp))};b.prototype.disableInputElement=function(a,b){if(a){var c=b?a.base:a;if(a.ownerDocument.defaultView&&a instanceof a.ownerDocument.defaultView.HTMLIFrameElement||a instanceof HTMLIFrameElement)this._DetachFromIframe(a);else{0<c.className.indexOf("keymanweb-font")&&!b&&
(c.className=c.className.replace("keymanweb-font","").trim());var f=this.inputList.indexOf(a);-1<f&&this.inputList.splice(f,1);b||(this.keyman.util.detachDOMEvent(c,"focus",this.getHandlers(a)._ControlFocus),this.keyman.util.detachDOMEvent(c,"blur",this.getHandlers(a)._ControlBlur),this.keyman.util.detachDOMEvent(c,"click",this.getHandlers(a)._Click));a.onkeypress=null;a.onkeydown=null;a.onkeyup=null}b&&(this.inputList.push(c),c.onkeypress=this.getHandlers(a)._KeyPress,c.onkeydown=this.getHandlers(a)._KeyDown,
c.onkeyup=this.getHandlers(a)._KeyUp);b=this.lastActiveElement;if(b==a||b==a.kmw_ip)this.activeElement==b&&(this.activeElement=null),this.lastActiveElement=null,this.keyman.osk.startHide(!1)}};b.prototype.isKMWDisabled=function(a){var b=a.className;return a.readOnly||b&&0<=b.indexOf("kmw-disabled")?!0:!1};b.prototype.attachToControl=function(a){var b=this.keyman.util.device.touchable;if(!this.isAttached(a)||a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(a)?this.isKMWDisabled(a)?
b&&this.setupNonKMWTouchElement(a):b&&!this.keyman.isEmbedded?this.enableTouchElement(a):this.enableInputElement(a):b&&this.setupNonKMWTouchElement(a)};b.prototype.detachFromControl=function(a){if(this.isAttached(a)||a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this.isKMWInput(a)&&(this.isKMWDisabled(a)||this._DisableControl(a)),this.clearElementAttachment(a)};b.prototype.isAttached=function(a){return a._kmwAttachment?!0:!1};b.prototype.isKMWInput=function(a){var b=this.keyman.util.device.touchable;
if(a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement)return!0;if(a instanceof a.ownerDocument.defaultView.HTMLInputElement){if("text"==a.type||"search"==a.type)return!0}else if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement&&!b)try{if(a.contentWindow&&a.contentWindow.document)return!0}catch(d){console.warn("Error during attachment to / detachment from iframe: "),console.warn(d)}else if(a.isContentEditable&&!b)return!0;return!1};b.prototype.setupElementAttachment=function(a){if(!a._kmwAttachment){var b=
h.targets.wrapElement(a);b||h.Utils.instanceof(a,"HTMLIFrameElement")||console.warn("Could not create processing interface for newly-attached element!");a._kmwAttachment=new k.AttachmentInfo(b,null,this.keyman.util.device.touchable)}};b.prototype.clearElementAttachment=function(a){a._kmwAttachment=null};b.prototype._AttachToIframe=function(a){var b=this.keyman.util;try{var d=a.contentWindow.document;d&&("on"==d.designMode.toLowerCase()?("firefox"==b.device.browser?(b.attachDOMEvent(d,"focus",this.getHandlers(a)._ControlFocus),
b.attachDOMEvent(d,"blur",this.getHandlers(a)._ControlBlur)):(b.attachDOMEvent(d.body,"focus",this.getHandlers(a)._ControlFocus),b.attachDOMEvent(d.body,"blur",this.getHandlers(a)._ControlBlur)),b.attachDOMEvent(d.body,"keydown",this.getHandlers(a)._KeyDown),b.attachDOMEvent(d.body,"keypress",this.getHandlers(a)._KeyPress),b.attachDOMEvent(d.body,"keyup",this.getHandlers(a)._KeyUp),this.setupElementAttachment(a),d.body._kmwAttachment=a._kmwAttachment):this._SetupDocument(d.body))}catch(f){}};b.prototype._DetachFromIframe=
function(a){var b=this.keyman.util;try{var d=a.contentWindow.document;d&&("on"==d.designMode.toLowerCase()?("firefox"==b.device.browser?(b.detachDOMEvent(d,"focus",this.getHandlers(a)._ControlFocus),b.detachDOMEvent(d,"blur",this.getHandlers(a)._ControlBlur)):(b.detachDOMEvent(d.body,"focus",this.getHandlers(a)._ControlFocus),b.detachDOMEvent(d.body,"blur",this.getHandlers(a)._ControlBlur)),b.detachDOMEvent(d.body,"keydown",this.getHandlers(a)._KeyDown),b.detachDOMEvent(d.body,"keypress",this.getHandlers(a)._KeyPress),
b.detachDOMEvent(d.body,"keyup",this.getHandlers(a)._KeyUp),d.body._kmwAttachment=null):this._ClearDocument(d.body))}catch(f){}};b.prototype._GetDocumentEditables=function(a){var b=this.keyman.util,d=[];if(a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement){var f=a.ownerDocument.defaultView;a instanceof f.HTMLInputElement||a instanceof f.HTMLTextAreaElement?d.push(a):a instanceof f.HTMLIFrameElement&&d.push(a)}a.getElementsByTagName&&(d=d.concat(b.arrayFromNodeList(a.getElementsByTagName("INPUT")),
b.arrayFromNodeList(a.getElementsByTagName("TEXTAREA")),b.arrayFromNodeList(a.getElementsByTagName("IFRAME"))));a.querySelectorAll&&(d=d.concat(b.arrayFromNodeList(a.querySelectorAll("[contenteditable]"))));a.ownerDocument&&a instanceof a.ownerDocument.defaultView.HTMLElement&&a.isContentEditable&&d.push(a);return d};b.prototype._SetupDocument=function(a){a=this._GetDocumentEditables(a);for(var b=0;b<a.length;b++)this.attachToControl(a[b])};b.prototype._ClearDocument=function(a){a=this._GetDocumentEditables(a);
for(var b=0;b<a.length;b++)this.detachFromControl(a[b])};b.prototype._SetTargDir=function(a){var b=g.keyman.singleton.core.activeKeyboard;b=b&&b.isRTL?"rtl":"ltr";a&&(this.keyman.util.device.touchable?0==a.textContent.length&&(a.base.dir=a.dir=b,a.setTextCaret(1E4)):a instanceof a.ownerDocument.defaultView.HTMLInputElement||a instanceof a.ownerDocument.defaultView.HTMLTextAreaElement?0==a.value.length&&(a.dir=b):"string"==typeof a.textContent&&0==a.textContent.length&&(a.dir=b))};b.prototype._DisableControl=
function(a){if(this.isAttached(a)||a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)this.keyman.util.device.touchable?(this.disableTouchElement(a),this.setupNonKMWTouchElement(a),window.setTimeout(function(){this.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),1)):this.listInputs(),this.disableInputElement(a)};b.prototype._EnableControl=function(a){if(this.isAttached(a))if(this.keyman.util.device.touchable){this.enableTouchElement(a);
var b=this.keyman;window.setTimeout(function(){b.domManager.listInputs();for(var a=0;a<this.sortedInputs.length;a++)this.sortedInputs[a].kmw_ip&&this.sortedInputs[a].kmw_ip.updateInput(this.sortedInputs[a].kmw_ip)}.bind(this),1)}else this.enableInputElement(a)};b.prototype.listInputs=function(){var a,b=[],d=document.getElementsByTagName("input"),f=document.getElementsByTagName("textarea");for(a=0;a<d.length;a++)switch(d[a].type){case "text":case "search":case "email":case "url":0>d[a].className.indexOf("kmw-disabled")&&
b.push({ip:d[a],x:h.Utils.getAbsoluteX(d[a]),y:h.Utils.getAbsoluteY(d[a])})}for(a=0;a<f.length;a++)0>f[a].className.indexOf("kmw-disabled")&&b.push({ip:f[a],x:h.Utils.getAbsoluteX(f[a]),y:h.Utils.getAbsoluteY(f[a])});b.sort(function(a,b){return a.y!=b.y?a.y-b.y:a.x-b.x});d=[];for(a=0;a<b.length;a++)d.push(b[a].ip);this.sortedInputs=d};b.prototype.disableControl=function(a){this.isAttached(a)||console.warn("KeymanWeb is not attached to element "+a);var b=a.className;0>b.indexOf("kmw-disabled")&&(a.className=
b?b+" kmw-disabled":"kmw-disabled")};b.prototype.setKeyboardForControl=function(a,b,d){null!==b&&void 0!==b?0>b.indexOf("Keyboard_")&&""!=b&&(b="Keyboard_"+b):d=null;if(a instanceof a.ownerDocument.defaultView.HTMLIFrameElement)console.warn("'keymanweb.setKeyboardForControl' cannot set keyboard on iframes.");else if(this.isAttached(a)){a._kmwAttachment.keyboard=b;a._kmwAttachment.languageCode=d;var c=this.lastActiveElement;!c||c!=a&&c!=a.kmw_ip||(null!=b&&null!=d?this.keyman.keyboardManager.setActiveKeyboard(b,
d):this.keyman.keyboardManager.setActiveKeyboard(this.keyman.globalKeyboard,this.keyman.globalLanguageCode))}else console.error("KeymanWeb is not attached to element "+a)};b.prototype.getKeyboardForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.keyboard;console.error("KeymanWeb is not attached to element "+a);return null};b.prototype.getLanguageForControl=function(a){if(this.isAttached(a))return a._kmwAttachment.languageCode;console.error("KeymanWeb is not attached to element "+
a);return null};b.prototype.focusLastActiveElement=function(){var a=this.lastActiveElement;a&&(this.keyman.uiManager.justActivated=!0,h.Utils.getOutputTarget(a).focus())};Object.defineProperty(b.prototype,"lastActiveElement",{get:function(){return h.DOMEventHandlers.states._lastActiveElement},set:function(a){h.DOMEventHandlers.states._lastActiveElement=a;(a=this.keyman.osk)&&null==this.lastActiveElement&&null==this.activeElement&&(a.activeTarget=null,this.keyman.osk.hideNow())},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"activeElement",{get:function(){return h.DOMEventHandlers.states._activeElement},set:function(a){var b;this.activeElement&&h.Utils.instanceof(this.keyman.domManager.activeElement,"TouchAliasElement")&&this.keyman.domManager.activeElement.hideCaret();h.DOMEventHandlers.states._activeElement=a;var d=this.keyman.uiManager.isActivating,f=this.keyman.osk;f&&(a=(null===(b=null===a||void 0===a?void 0:a._kmwAttachment)||void 0===b?void 0:b.interface)||null,!f||!a&&d||(f.activeTarget=
a))},enumerable:!0,configurable:!0});b.prototype.setActiveElement=function(a,b){"string"==typeof a&&(a=document.getElementById(a));if(this.keyman.isEmbedded)this.isAttached(a)||this.attachToControl(a);else if(!this.isAttached(a)){console.warn("Cannot set an element KMW is not attached to as the active element.");return}a=a.kmw_ip?a.kmw_ip:a;this.keyman.isEmbedded||this.keyman.touchAliasing._BlurKeyboardSettings(this.keyman.domManager.lastActiveElement);this.activeElement!=a&&this.keyman.resetContext(a);
this.activeElement=this.lastActiveElement=a;this.keyman.isEmbedded||this.keyman.touchAliasing._FocusKeyboardSettings(a,!1);1<arguments.length&&b&&(this.keyman.util.device.touchable?this.keyman.touchAliasing.setFocusWithTouch({pageX:0,pageY:0,target:a}):this.focusLastActiveElement());g.keyman.singleton.core.processNewContextEvent(h.Utils.getOutputTarget(a))};b.prototype.initActiveElement=function(a){null==this.activeElement&&(this.activeElement=a)};b.prototype.moveToNext=function(a){var b,d=this.sortedInputs,
f=this.activeElement,l=this.keyman.util.device.touchable;if(0!=d.length){l&&(f=f.base);for(b=0;b<d.length&&d[b]!=f;b++);b=a?b-1:b+1;b=b>=d.length?b-d.length:b;b=0>b?b+d.length:b;l?(h.DOMEventHandlers.states.focusing=!0,a=d[b].kmw_ip,"undefined"==typeof a?d[b].focus():(this.keyman.domManager.setActiveElement(a),a.setTextCaret(1E4),a.scrollInput(),a.focus())):d[b].focus()}};b.prototype.moveToElement=function(a){"string"==typeof a&&(a=document.getElementById(a));this.keyman.util.device.touchable&&a.kmw_ip?
a.kmw_ip.focus():a.focus()};b.prototype._IsIEEditableIframe=function(a,b){var c,f=a&&(c=a.tagName)&&"body"==c.toLowerCase()&&(c=a.ownerDocument)&&c.parentWindow;return!b&&f||b&&(!f||a.isContentEditable)};b.prototype._IsMozillaEditableIframe=function(a,b){var c;a=a&&(c=a.defaultView)&&c.frameElement;return!b&&a||b&&(!a||"on"==c.document.designMode.toLowerCase())};b.prototype.getBaseFont=function(){var a=this.keyman.util,b=document.getElementsByTagName("input"),d=document.getElementsByTagName("textarea"),
f=0;if(0==b.length&&0==d.length)f=0;else if(0<b.length&&0==d.length)f=1;else if(0==b.length&&0<d.length)f=2;else{var l=b[0],e=d[0];l.offsetTop<e.offsetTop?f=1:l.offsetTop>e.offsetTop?f=2:l.offsetLeft<e.offsetLeft?f=1:l.offsetLeft>e.offsetLeft&&(f=2)}switch(f){case 0:case 1:a.getStyleValue(b[0],"font-family");case 2:var g=a.getStyleValue(d[0],"font-family")}if("undefined"==typeof g||"monospace"==g)g="Arial,sans-serif";return g};b.prototype.initializeUI=function(){this.keyman.ui&&this.keyman.ui.initialize instanceof
Function?(this.keyman.ui.initialize(),this.keyman.osk.present()):this.keyman.isEmbedded||window.setTimeout(this.initializeUI.bind(this),1E3)};b.suppressFocusCheck=function(a){h.DOMEventHandlers.states._IgnoreBlurFocus&&(a.stopPropagation(),a.cancelBubble=!0);return!0};return b}();h.DOMManager=e})(k.dom||(k.dom={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){var h=function(){function e(b,a,c,d){this.Pelem=b;this.Peventname=a.toLowerCase();this.Phandler=c;this.PuseCapture=d}e.prototype.equals=function(b){return this.Pelem==b.Pelem&&this.Peventname==b.Peventname&&this.Phandler==b.Phandler&&this.PuseCapture==b.PuseCapture};return e}(),n=function(){function e(b){this.linkedStylesheets=[];this.events={};this.currentEvents=[];this.domEvents=[];this.embeddedFonts=[];this._GetAbsolute=this.getAbsolute;this.selectStartHandler=function(){return!1};
this._CancelMouse=function(a){(a=g.keyman.singleton._GetEventObject(a))&&a.preventDefault&&a.preventDefault();a&&(a.cancelBubble=!0,a.returnValue=!1);return!1};this.createElement=this._CreateElement;this.initDevices();this.keyman=b}e.prototype.getLanguageCodes=function(b){return-1==b.indexOf("-")?[b]:b.split("-")};e.prototype.initDevices=function(){this.device=new k.Device;this.physicalDevice=new k.Device;this.activeDevice=this.device;this.device.detect();"desktop"==this.device.formFactor&&(this.device.touchable=
!1);this.physicalDevice=new k.Device;this.physicalDevice.touchable=!1;this.physicalDevice.browser=this.device.browser;this.physicalDevice.formFactor="desktop";this.physicalDevice.OS=this.device.OS};e.prototype.arrayFromNodeList=function(b){for(var a=[],c=0;c<b.length;c++)a.push(b[c]);return a};e.prototype.addEventListener=function(b,a){this.removeEventListener(b,a);this.events[b].push(a);return!0};e.prototype.removeEventListener=function(b,a){"undefined"==typeof this.events[b]&&(this.events[b]=[]);
for(var c=0;c<this.events[b].length;c++)if(this.events[b][c]==a)return this.events[b].splice(c,1),!0;return!1};e.prototype.callEvent=function(b,a){if("undefined"==typeof this.events[b])return!0;if(-1!=this.currentEvents.indexOf(b))return!1;this.currentEvents.push(b);for(var c=0;c<this.events[b].length;c++){var d=this.events[b][c],f=!1;try{f=d(a)}catch(l){console.error(l),f=!1}if(!1===f)return this.currentEvents.pop(),!1}this.currentEvents.pop();return!0};e.prototype.attachDOMEvent=function(b,a,c,
d){this.detachDOMEvent(b,a,c,d);b.addEventListener(a,c,d?!0:!1);b=new h(b,a,c,d);this.domEvents.push(b)};e.prototype.detachDOMEvent=function(b,a,c,d){b.removeEventListener(a,c,d);b=new h(b,a,c,d);for(a=0;a<this.domEvents.length;a++)if(this.domEvents[a].equals(b)){this.domEvents.splice(a,1);break}};e.prototype.getOption=function(b,a){return b in this.keyman.options?this.keyman.options[b]:1<arguments.length?a:""};e.prototype.hasClass=function(b,a){a=" "+a+" ";return 0<=(" "+b.className+" ").replace(/[\n\t\r\f]/g,
" ").indexOf(a)};e.prototype.setOption=function(b,a){this.keyman.options[b]=a};e.prototype.getAbsoluteX=function(b){return k.dom.Utils.getAbsoluteX(b)};e.prototype.getAbsoluteY=function(b){return k.dom.Utils.getAbsoluteY(b)};e.prototype.getAbsolute=function(b){return{x:this.getAbsoluteX(b),y:this.getAbsoluteY(b)}};e.prototype._CreateElement=function(b){b=document.createElement(b);"undefined"!=typeof b.onselectstart?b.onselectstart=this.selectStartHandler:(b.style.MozUserSelect="none",b.style.KhtmlUserSelect=
"none",b.style.UserSelect="none",b.style.WebkitUserSelect="none");return b};e.prototype.getIEVersion=function(){return k.Device._GetIEVersion()};e.prototype.getStyleValue=function(b,a){try{if(b&&"undefined"!=typeof window.getComputedStyle)return window.getComputedStyle(b,"").getPropertyValue(a)}catch(c){}return""};e.prototype.getStyleInt=function(b,a,c){b=parseInt(this.getStyleValue(b,a),10);return isNaN(b)?"number"==typeof c?c:0:b};e.prototype.isTouchDevice=function(){return this.device.touchable};
e.prototype.portraitView=function(){return!this.landscapeView()};e.prototype.landscapeView=function(){if("undefined"!=typeof window.orientation)var b=window.orientation;else"undefined"!=typeof window.screen.orientation&&(b=window.screen.orientation.angle);return void 0!==b?1==Math.abs(b/90):!1};e.prototype.getViewportScale=function(){try{if("desktop"==this.device.formFactor)return 1;var b=document.documentElement.clientWidth;if(screen.width>b)return 1;var a=screen.width;this.landscapeView()?screen.width<
screen.height&&(a=screen.height):screen.width>screen.height&&(a=screen.height);return Math.round(100*a/b)/100}catch(c){return 1}};e.prototype.barHeight=function(){var b=0;"phone"==this.device.formFactor&&(b=screen.height/2-window.innerHeight-(this.landscapeView()?this.device.dyLandscape:this.device.dyPortrait));return b};e.prototype._EncodeEntities=function(b){return b.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")};e.prototype.createShim=function(){console.warn("The util.createShim function is deprecated, as its old functionality is no longer needed.  It and references to its previously-produced shims may be safely removed.")};
e.prototype.showShim=function(b,a,c){console.warn("The util.showShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};e.prototype.hideShim=function(b){console.warn("The util.hideShim function is deprecated, as its old functionality is no longer needed.  It may be safely removed.")};e.prototype.rgba=function(b,a,c,d,f){b="transparent";try{b="rgba("+a+","+c+","+d+","+f+")"}catch(l){b="rgb("+a+","+c+","+d+")"}return b};e.prototype.addStyleSheet=function(b){var a=
document.createElement("style");a.type="text/css";a.appendChild(document.createTextNode(b));b=document.getElementsByTagName("HEAD");0<b.length?b[0].appendChild(a):document.body.appendChild(a);this.linkedStylesheets.push(a);return a};e.prototype.removeStyleSheet=function(b){if(null==b||"object"!=typeof b||"STYLE"!=b.nodeName||"undefined"==typeof b.parentNode||null==b.parentNode)return!1;b.parentNode.removeChild(b);return!0};e.prototype.linkStyleSheet=function(b){try{if(null!=document.querySelector("link[href="+
JSON.stringify(b)+"]"))return}catch(d){return}var a=document.getElementsByTagName("head");if(0<a.length){var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=b;this.linkedStylesheets.push(c);a[0].appendChild(c)}};e.prototype.addFontFaceStyleSheet=function(b){if("undefined"!=typeof b&&("undefined"==typeof b.files&&(b.files=b.source),"undefined"!=typeof b.files)){var a,c="",d="",f="",l="",e=[];for(a=0;a<this.embeddedFonts.length;a++)if(this.embeddedFonts[a]==b.family)return;
"string"==typeof b.files?e[0]=b.files:e=b.files;for(a=0;a<e.length;a++)0<e[a].toLowerCase().indexOf(".otf")&&(c=e[a]),0<e[a].toLowerCase().indexOf(".ttf")&&(c=e[a]),0<e[a].toLowerCase().indexOf(".woff")&&(d=e[a]),0<e[a].toLowerCase().indexOf(".eot")&&(f=e[a]),0<e[a].toLowerCase().indexOf(".svg")&&(l=e[a]);""!=c&&0>c.indexOf("/")&&(c=this.keyman.options.fonts+c);""!=d&&0>d.indexOf("/")&&(d=this.keyman.options.fonts+d);""!=f&&0>f.indexOf("/")&&(f=this.keyman.options.fonts+f);""!=l&&0>l.indexOf("/")&&
(l=this.keyman.options.fonts+l);a="@font-face {\nfont-family:"+b.family+";\nfont-style:normal;\nfont-weight:normal;\n";if(9<=k.Device._GetIEVersion())if("iOS"==this.device.OS)if(""!=c)c=this.unCached(c),a=a+"src:url('"+c+"') format('truetype');";else return;else{f=[];"Android"==this.device.OS?(""!=l&&f.push("url('"+l+"') format('svg')"),""!=d&&f.push("url('"+d+"') format('woff')"),""!=c&&f.push("url('"+c+"') format('truetype')")):(""!=d&&f.push("url('"+d+"') format('woff')"),""!=c&&f.push("url('"+
c+"') format('truetype')"),""!=l&&f.push("url('"+l+"') format('svg')"));if(0==f.length)return;a+="src:"+f.join(",")+";"}else if(""!=f)a=a+"src:url('"+f+"');";else return;this.addStyleSheet(a+"\n}\n");this.embeddedFonts.push(b.family)}};e.prototype.unCached=function(b){return b};e.prototype.loadCookie=function(b){var a={};if(0<arguments.length){var c=this.loadCookie(),d;for(d in c)if(d==b)for(var f=decodeURIComponent(c[d]).split(";"),l=0;l<f.length;l++){var e=f[l].split("=");a[e[0]]=1<e.length?e[1]:
""}}else if("undefined"!=typeof document.cookie&&""!=document.cookie)for(c=document.cookie.split(/;\s*/),l=0;l<c.length;l++)f=c[l].split("="),2==f.length&&(a[f[0]]=f[1]);return a};e.prototype.saveCookie=function(b,a){var c="",d;for(d in a)c=c+d+"="+a[d]+";";a=(new Date((new Date).valueOf()+2592E6)).toUTCString();document.cookie=b+"="+encodeURIComponent(c)+"; path=/; expires="+a};e.prototype.toNumber=function(b,a){b=parseInt(b,10);return isNaN(b)?a:b};e.prototype.toFloat=function(b,a){b=parseFloat(b);
return isNaN(b)?a:b};e.prototype.nzString=function(b,a){var c="";1<arguments.length&&(c=a);return"undefined"==typeof b||null==b||0==b||""==b?c:""+b};e.prototype.eventTarget=function(b){return b?b.target?b.target:b.srcElement?b.srcElement:window.event?window.event.srcElement:null:null};e.prototype.eventType=function(b){return b&&b.type?b.type:window.event?window.event.type:""};e.prototype.alert=function(b,a){var c=this.waiting,d=c.firstChild.childNodes;d[0].style.display="block";d[1].className="kmw-alert-text";
d[1].innerHTML=b;d[2].style.display="none";c.style.display="block";c.dismiss=1<arguments.length?a:null};e.prototype.wait=function(b){};e.prototype.internalAlert=function(b,a){this.keyman.options.useAlerts&&this.alert(b,a)};e.prototype.prepareWait=function(){var b=document.createElement("DIV"),a=document.createElement("DIV"),c=document.createElement("DIV"),d=document.createElement("DIV"),f=document.createElement("DIV");b.className="kmw-wait-background";a.className="kmw-wait-box";b.dismiss=null;c.className=
"kmw-wait-text";d.className="kmw-wait-graphic";f.className="kmw-alert-close";a.onmousedown=a.onclick=function(a){"block"==f.style.display&&(b.style.display="none",b.dismiss&&b.dismiss())};a.addEventListener("touchstart",a.onclick,!1);b.onmousedown=b.onclick=function(a){a.preventDefault();a.stopPropagation()};b.addEventListener("touchstart",b.onclick,!1);a.appendChild(f);a.appendChild(c);a.appendChild(d);b.appendChild(a);document.body.appendChild(b);this.waiting=b};e.prototype.shutdown=function(){this.events=
{};for(var b=0,a=this.domEvents;b<a.length;b++){var c=a[b];this.detachDOMEvent(c.Pelem,c.Peventname,c.Phandler,c.PuseCapture)}this.waiting.parentNode.removeChild(this.waiting);b=0;for(a=this.linkedStylesheets;b<a.length;b++)c=a[b],c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)};e.prototype.myPath=function(b){var a,c=document.getElementsByTagName("script");for(a=0;a<c.length;a++){var d=c[a];if(0<=d.src.indexOf(b))return d.src.substr(0,d.src.lastIndexOf("/")+1)}return""};e.prototype.prependProtocol=
function(b){return/^https?:/.test(b)?b:"//"==b.substr(0,2)?this.keyman.protocol+b:"/"==b.substr(0,1)?this.keyman.protocol+"/"+b:this.keyman.protocol+"//"+b};e.prototype.testString=function(b){var a=b.family;if("sample"in b&&"string"==typeof b.sample)return"BESbswy"+b.sample;var c="TamilWeb TibetanWeb LatinWeb CherokeeWeb EgyptianWeb SinhalaWeb KhmerWeb ArabicWeb BurmeseWeb LaoWeb OriyaWeb GeezWeb".split(" "),d="\u0bbe\u0bf5 \u0f7f\u0fd0 \u02b0\u02a4 \u13d0\u13c9 \ua723\uf7d3 \u0dd8\u0da3 \u17d6\u178e \u0639\u06b3 \u1038\u1024 \u0ec0\u0edd \u0b03\u0b06 \u1361\u132c".split(" ");
for(b=0;b<c.length;b++)if(a==c[b])return"BESbswy"+d[b];return"BESbswy"};e.prototype.checkFont=function(b){var a=b.family,c=document.createElement("DIV"),d=c.style,f=document.createElement("P"),l=document.createElement("P"),e=document.createElement("SPAN"),g=e.style,h=document.createElement("SPAN"),k=h.style;d.position="absolute";d.top="10px";d.left="10px";d.visibility="hidden";document.body.appendChild(c);c.appendChild(f);c.appendChild(l);f.appendChild(e);l.appendChild(h);e.setAttribute("style","font-family:monospace !important");
k.fontFamily=a+",monospace";g.fontSize=k.fontSize="24px";e.innerHTML=h.innerHTML=this.testString(b);e.offsetWidth!=h.offsetWidth&&(e.setAttribute("style","font-family:sans-serif !important"),k.fontFamily=a+",sans-serif",e.offsetWidth!=h.offsetWidth&&(e.setAttribute("style","font-family:serif !important"),k.fontFamily=a+",serif"));b=e.offsetWidth!=h.offsetWidth;f.removeChild(e);l.removeChild(h);c.removeChild(f);c.removeChild(l);document.body.removeChild(c);return b};e.prototype.checkFontDescriptor=
function(b){return"undefined"==typeof b||"string"!=typeof b.family?!0:this.checkFont(b)};return e}();k.Util=n})(g.keyman||(g.keyman={}))})(com||(com={}));
var Util=com.keyman.Util,__assign=this&&this.__assign||function(){__assign=Object.assign||function(g){for(var k,h=1,n=arguments.length;h<n;h++){k=arguments[h];for(var e in k)Object.prototype.hasOwnProperty.call(k,e)&&(g[e]=k[e])}return g};return __assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(g,k,h,n){function e(b){return b instanceof h?b:new h(function(a){a(b)})}return new (h||(h=Promise))(function(b,a){function c(b){try{f(n.next(b))}catch(q){a(q)}}function d(b){try{f(n["throw"](b))}catch(q){a(q)}}
function f(a){a.done?b(a.value):e(a.value).then(c,d)}f((n=n.apply(g,k||[])).next())})},__generator=this&&this.__generator||function(g,k){function h(a){return function(b){return n([a,b])}}function n(d){if(b)throw new TypeError("Generator is already executing.");for(;e;)try{if(b=1,a&&(c=d[0]&2?a["return"]:d[0]?a["throw"]||((c=a["return"])&&c.call(a),0):a.next)&&!(c=c.call(a,d[1])).done)return c;if(a=0,c)d=[d[0]&2,c.value];switch(d[0]){case 0:case 1:c=d;break;case 4:return e.label++,{value:d[1],done:!1};
case 5:e.label++;a=d[1];d=[0];continue;case 7:d=e.ops.pop();e.trys.pop();continue;default:if(!(c=e.trys,c=0<c.length&&c[c.length-1])&&(6===d[0]||2===d[0])){e=0;continue}if(3===d[0]&&(!c||d[1]>c[0]&&d[1]<c[3]))e.label=d[1];else if(6===d[0]&&e.label<c[1])e.label=c[1],c=d;else if(c&&e.label<c[2])e.label=c[2],e.ops.push(d);else{c[2]&&e.ops.pop();e.trys.pop();continue}}d=k.call(g,e)}catch(l){d=[6,l],a=0}finally{b=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var e={label:0,sent:function(){if(c[0]&
1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,d;return d={next:h(0),"throw":h(1),"return":h(2)},"function"===typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};
(function(g){(function(k){(function(h){var n=function(){function a(a,b){this.id=a;this.language=b}a.prototype.toString=function(){var a=this.id;this.language?(a=a+"@"+this.language,this.version&&(a=a+"@"+this.version)):this.version&&(a=a+"@@"+this.version);return a};return a}(),e=function(){return function(a,b){this.family=a.family;this.files=a.source;this.path=b}}(),b=function(){function a(a,b){this.KI="Keyboard_"+a;this.KLC=b}a.toStubs=function(b){var c="";b?b.id?b.languages||(c="KeyboardStub has undefined languages"):
c="KeyboardStub has undefined id":c="Stub undefined";if(""!=c)return[{error:Error(c)}];var d=[];"object"===typeof b.languages?d.push(b.languages):b.languages.foreach(function(a){d.push(a)});var f=[];d.forEach(function(c){var d=new a(b.id,c.id);b.name&&(d.KN=b.name);b.filename&&(d.KF=b.filename);b.displayName&&(d.displayName=b.displayName);c.name&&(d.KL=c.name);c.region&&(d.KR=c.region);c.font&&(d.KFont=c.font);c.oskFont&&(d.KOskFont=c.oskFont);f.push(d)});return f};return a}();h.KeyboardStub=b;var a=
function(){return function(){this.stores={}}}();h.KeyboardTag=a;var c=function(){function c(a){this.activeStub=null;this.keyboardStubs=[];this.dfltStub=this.deferment=null;this.keyboards=[];this.registrationResolvers={};this.languageList=this.languageListPromise=null;this.linkedScripts=[];this._GetKeyboardDetail=function(a,b){var c={};c.Name=a.KN;c.InternalName=a.KI;c.LanguageName=a.KL;c.LanguageCode=a.KLC;c.RegionName=a.KR;c.RegionCode=a.KRC;c.CountryName=a.KC;c.CountryCode=a.KCC;c.KeyboardID=a.KD;
c.Font=a.KFont;c.OskFont=a.KOskFont;c.HasLoaded=!!b;c.IsRTL=b?!!b.KRTL:null;return c};this.keymanweb=a;var b=this;this.deferment=new Promise(function(a){b.endDeferment=a})}c.prototype.getActiveKeyboardName=function(){var a=g.keyman.singleton.core;return a.activeKeyboard?a.activeKeyboard.id:""};c.prototype.getActiveLanguage=function(a){return null==this.activeStub?"":a?this.activeStub.KL:this.activeStub.KLC};c.prototype.getDetailedKeyboards=function(){var a=[],b;for(b=0;b<this.keyboardStubs.length;b++){var c=
this.keyboardStubs[b];for(var d=void 0,e=0;e<this.keyboards.length;e++)if(this.keyboards[e].KI==c.KI){d=this.keyboards[e];break}c=this._GetKeyboardDetail(c,d);a=this.keymanweb._push(a,c)}return a};c.prototype.addStub=function(a){if("string"!=typeof a.id)return!1;"undefined"!=typeof a.language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a.languages=a.language);if("undefined"==typeof a.languages)return!1;"string"!=typeof a.name&&
(a.name=a.id.replace("_"," "),a.name=a.name.substr(0,1).toUpperCase()+a.name.substr(1));var b=a.languages,c=[];"undefined"==typeof b.length?c[0]=b:c=b;var d={keyboardBaseUri:this.keymanweb.options.keyboards,fontBaseUri:this.keymanweb.options.fonts};for(b=0;b<c.length;b++)this.mergeStub(a,c[b],d);return!0};c.prototype.mergeStub=function(a,d,g){var f=this.findStub(a.id,d.id),l=!1;null==f&&(f=new b(a.id,d.id),this.keyboardStubs.push(f),l=!0);var h=d.region,k=0;if("number"==typeof h)k=1>h||9<h?0:h-1;
else if("string"==typeof h)for(var q=2==h.length?c.regionCodes:c.regions,n=0;n<q.length;n++)if(h.toLowerCase()==q[n].toLowerCase()){k=n;break}f.KL="undefined"===typeof f.KL?d.name:f.KL;f.KR="undefined"===typeof f.KR?c.regions[k]:f.KR;f.KRC="undefined"===typeof f.KRC?c.regionCodes[k]:f.KRC;f.KN="undefined"===typeof f.KN?a.name:f.KN;f.displayName="undefined"===typeof f.displayName?a.displayName:f.displayName;"undefined"==typeof f.KF&&(h=/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/,f.KF=a.filename,h.test(f.KF)||
(f.KF=g.keyboardBaseUri+f.KF));a=g.fontBaseUri;""!=this.keymanweb.options.fonts?(a=this.keymanweb.options.fonts,h=/^https?\:/,h.test(a)||(a="//"==a.substr(0,2)?this.keymanweb.protocol+a:"/"==a.substr(0,1)?this.keymanweb.rootPath+a.substr(1):this.keymanweb.rootPath+a)):this.keymanweb.options.fonts=a;"undefined"!=typeof d.font&&(f.KFont="undefined"===typeof f.KFont?new e(d.font,a):f.KFont);"undefined"!=typeof d.oskFont&&(f.KOskFont="undefined"===typeof f.KOskFont?new e(d.oskFont,a):f.KOskFont);this.doKeyboardRegistered(f.KI,
f.KL,f.KN,f.KLC,f.KP);!this.activeStub&&l&&1==this.keyboardStubs.length&&"true"==this.keymanweb.options.setActiveOnRegister&&(this.doBeforeKeyboardChange(f.KI,f.KLC),this._SetActiveKeyboard(f.KI,f.KLC,!1),this.doKeyboardChange(f.KI,f.KLC))};c.prototype.findStub=function(a,b){var c;for(c=0;c<this.keyboardStubs.length;c++)if(this.keyboardStubs[c].KI=="Keyboard_"+a&&this.keyboardStubs[c].KLC==b)return this.keyboardStubs[c];return null};c.prototype.setDefaultKeyboard=function(){return 0<this.keyboardStubs.length?
(this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC),!0):!1};c.prototype.setActiveKeyboard=function(a,b){!this.keymanweb.isEmbedded&&a&&0!=a.indexOf("Keyboard_")&&(a="Keyboard_"+a);this.doBeforeKeyboardChange(a,b);var c=this._SetActiveKeyboard(a,b,!0);null!=this.keymanweb.domManager.lastActiveElement&&this.keymanweb.domManager.focusLastActiveElement();var d=this;c.then(function(){d.doKeyboardChange(a,b)});c.catch(function(c){throw Error('Unable to load keyboard with internal name "'+
a+'", language code "'+b+'": '+c);});return c};c.prototype._SetActiveKeyboard=function(a,b,c){var d,f,e,l=g.keyman.singleton,k=l.util,q=l.osk,n=l.core.activeKeyboard;if(2>arguments.length||!b)b="---";for(f=0;f<this.keyboardStubs.length&&(a!=this.keyboardStubs[f].KI||b!=this.keyboardStubs[f].KLC&&"---"!=b);f++);k.device.touchable&&(""==a||null==a||f>=this.keyboardStubs.length)&&0!=this.keyboardStubs.length&&(a=this.keyboardStubs[0].KI,b=this.keyboardStubs[0].KLC);2<arguments.length&&c&&this.saveCurrentKeyboard(a,
b);if(this.activeStub&&n&&n.id==a&&this.activeStub.KI==a&&this.activeStub.KLC==b&&!this.keymanweb.mustReloadKeyboard)return Promise.resolve();if(n&&n.id==a)for(e=0;e<this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&this.keyboardStubs[e].KLC==b)return this.activeStub=this.keyboardStubs[e],null===(d=q.vkbd)||void 0===d?void 0:d.appendStyleSheet(),this.keymanweb.mustReloadKeyboard&&(n.refreshLayouts(),q&&q._Load()),Promise.resolve();this.activeStub=l.core.activeKeyboard=null;if(""==a)return q.startHide(!1),
this.keymanweb.isEmbedded||k.wait(!1),Promise.resolve();for(e=0;e<this.keyboards.length;e++)if(this.keyboards[e].KI==a){l.core.activeKeyboard=new h.Keyboard(this.keyboards[e]);l.core.activeKeyboard.refreshLayouts();this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.lastActiveElement);for(d=0;d<this.keyboardStubs.length;d++)if(this.keyboardStubs[d].KI==a&&(this.keyboardStubs[d].KLC==b||"---"==b)){this.activeStub=this.keyboardStubs[d];break}break}if(null==l.core.activeKeyboard){for(e=0;e<
this.keyboardStubs.length;e++)if(this.keyboardStubs[e].KI==a&&(this.keyboardStubs[e].KLC==b||"---"==b)){if(this.isCJK(this.keyboardStubs[e])||k.device.touchable)q.displayIfActive=!0;if(!this.keyboardStubs[e].asyncLoader){q&&q.startHide(!1);var y=this.keyboardStubs[e];y.asyncLoader={};var A=y.KN,p=y.KL;A=A.replace(/\s*keyboard\s*/i,"");y.asyncLoader.callback=function(a,b){var c=a||"Sorry, the "+A+" keyboard for "+p+" is not currently available.";this.keymanweb.isEmbedded||(k.wait(!1),k.internalAlert(a||
c,function(){this.keymanweb.setActiveKeyboard("")}.bind(this)));switch(b){case "err":console.error(c);break;default:console.warn(c)}0<e&&(a=this.keyboardStubs[0],this._SetActiveKeyboard(a.KI,a.KLC,!0))}.bind(this);y.asyncLoader.timer=window.setTimeout(y.asyncLoader.callback,1E4);this.keymanweb.isEmbedded||k.wait("Installing keyboard<br/>"+A);var H=this;y.asyncLoader.promise=new Promise(function(a,b){window.setTimeout(function(){H.installKeyboard(a,b,y)},0)})}this.activeStub=this.keyboardStubs[e];
return this.keyboardStubs[e].asyncLoader.promise}this.keymanweb.domManager._SetTargDir(this.keymanweb.domManager.lastActiveElement)}q&&q._Load();return Promise.resolve()};c.prototype.installKeyboard=function(a,b,c){var d=this.keymanweb.util,f=this.keymanweb.osk,e=d._CreateElement("script");e.charset="UTF-8";e.type="text/javascript";this.keymanweb.isEmbedded&&(e.id=c.KI);var l=c.KL,q=c.KN,n=this.keymanweb.getKeyboardPath(c.KF),r=this,y=g.keyman.singleton.core;e.addEventListener("error",function(){null!==
c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=null);var a="Cannot find the "+q+" keyboard for "+l+" at "+n+".";c.asyncLoader.callback(a,"warn");c.asyncLoader=null;b(a)});e.addEventListener("load",function(){null!==c.asyncLoader.timer&&(window.clearTimeout(c.asyncLoader.timer),c.asyncLoader.timer=null);var e=r.getKeyboardByID(c.KI);e?(c==r.activeStub&&(r.doBeforeKeyboardChange(e.KI,c.KLC),y.activeKeyboard=new h.Keyboard(e),null!=r.keymanweb.domManager.lastActiveElement&&
(r.keymanweb.uiManager.justActivated=!0,r.keymanweb.domManager._SetTargDir(r.keymanweb.domManager.lastActiveElement)),r.saveCurrentKeyboard(e.KI,c.KLC),f&&f._Load(),null!=r.keymanweb.domManager.lastActiveElement&&y.processNewContextEvent(k.dom.Utils.getOutputTarget(r.keymanweb.domManager.lastActiveElement))),r.keymanweb.isEmbedded||d.wait(!1),c.asyncLoader=null,a()):(e="Error registering the "+q+" keyboard for "+l+"; keyboard script at "+n+" may contain an error.",c.asyncLoader.callback(e,"error"),
c.asyncLoader=null,b(e))},!1);e.src=n;try{document.body.appendChild(e)}catch(A){try{document.getElementsByTagName("head")[0].appendChild(e)}catch(p){b("Error registering script "+n+": "+p);return}}this.linkedScripts.push(e)};c.prototype.saveCurrentKeyboard=function(a,b){this.keymanweb.util.saveCookie("KeymanWeb_Keyboard",{current:a+":"+b});this.keymanweb.isEmbedded||this.keymanweb.touchAliasing._BlurKeyboardSettings(this.keymanweb.domManager.lastActiveElement,a,b)};c.prototype.restoreCurrentKeyboard=
function(){var a=this.keyboardStubs,b=a.length,c=g.keyman.singleton.core;if(!(1>a.length)){var d=this.getSavedKeyboard();d.split(":");var e=d.split(":");2>e.length&&(e[1]="");for(d=0;d<b&&(a[d].KI!=e[0]||a[d].KLC!=e[1]&&""!=e[1]);d++);if(d<b||null==c.activeKeyboard)this._SetActiveKeyboard(e[0],e[1],!1),this.keymanweb.globalKeyboard=e[0],this.keymanweb.globalLanguageCode=e[1],this.doKeyboardChange(e[0],e[1])}};c.prototype.getSavedKeyboard=function(){var a=this.keymanweb.util.loadCookie("KeymanWeb_Keyboard");
if("string"!=typeof a.current)return"Keyboard_us:eng";var b,c=this.keyboardStubs;for(b=0;b<c.length;b++){var d=c[b].KI+":"+c[b].KLC;if(d==a.current)return d}for(b=0;b<c.length;b++)if(d=c[b].KI+":"+c[b].KLC,"Keyboard_us:eng"==d)return d;return 0<c.length?c[0].KI+":"+c[0].KLC:"Keyboard_us:eng"};c.prototype.isCJK=function(a){var b;"undefined"!=typeof a.KLC?b=a.KLC:"undefined"!=typeof a.LanguageCode&&(b=a.LanguageCode);return"cmn"==b||"jpn"==b||"kor"==b};c.prototype.getKeyboardByID=function(a){var b;
for(b=0;b<this.keyboards.length;b++)if(a==this.keyboards[b].KI)return this.keyboards[b];return null};c.prototype.isUniqueRequest=function(a,b){var c;if(null==this.findStub(b.id,b.language)){for(c=0;c<a.length;c++)if(a[c].id==b.id&&a[c].language==b.language)return!1;return!0}return!1};c.prototype.mergeAndResolveStubPromises=function(a,b){return 0==b.length?Promise.resolve(a):0==a.length?Promise.reject(b):Promise.resolve(a.concat(b))};c.prototype.addKeyboardArray=function(a){return __awaiter(this,void 0,
void 0,function(){var c,d,f,e,g,h,k,z,r,y,A,p,H,qa,wa,Y;return __generator(this,function(l){switch(l.label){case 0:return c=[],this.keymanweb.initialized?[3,2]:[4,this.deferment];case 1:l.sent(),l.label=2;case 2:if(0==a.length)return d={error:Error("No keyboards to add")},c.push(d),[2,Promise.resolve(c)];h=g="";k=[];z=[];for(f=0;f<a.length;f++){if("string"==typeof a[f]&&0<a[f].length)for(y=a[f].split("@"),A=[""],"english"==y[0].toLowerCase()&&(y[0]="us"),1<y.length&&(A=y[1].split(",")),e=0;e<A.length;e++)r=
new n(y[0]),""!=A[e]&&(r.language=A[e]),2<y.length&&(r.version=y[2]),this.isUniqueRequest(k,r)&&k.push(r);if("object"==typeof a[f]&&null!=a[f]){if("string"==typeof a[f].filename)this.addStub(a[f])||this.keymanweb.util.internalAlert("To use a custom keyboard, you must specify file name, keyboard name, language, language code and region code.");else{a[f].language&&(console.warn("The 'language' property for keyboard stubs has been deprecated.  Please use the 'languages' property instead."),a[f].languages=
a[f].language);A=a[f].languages;if(!A){p="To use keyboard '"+a[f].id+"', you must specify languages.";H={keyboard:{id:a[f].id,name:a[f].name},error:Error(p)};c.push(H);continue}if("number"==typeof A.length)for(e=0;e<A.length;e++)r=new n(a[f].id,a[f].languages[e].id),this.isUniqueRequest(k,r)&&k.push(r);else r=new n(a[f].id,a[f].languages.id),this.isUniqueRequest(k,r)&&k.push(r)}qa=b.toStubs(a[f]);qa.forEach(function(a){a instanceof b?z.push(a):c.push(a)})}}try{if(0==k.length)return[2,this.mergeAndResolveStubPromises(z,
c)]}catch(S){return console.error(S),[2,Promise.reject(S)]}g="&keyboardid=";for(f=0;f<k.length;f++)g=g+h+k[f].toString(),h=",";l.label=3;case 3:return l.trys.push([3,5,,6]),[4,this.keymanCloudRequest(g,!1)];case 4:return wa=l.sent(),[2,this.mergeAndResolveStubPromises(wa,c)];case 5:return Y=l.sent(),console.error(Y),d={error:Y},c.push(d),[2,Promise.reject(c)];case 6:return[2,Promise.resolve(c)]}})})};c.prototype.registerLanguagesForKeyboard=function(a,b,c){var d,f=0;var e="";if("undefined"!=typeof a)if("string"==
typeof b.keyboardid&&(e=b.keyboardid.split(",")[c]),"number"==typeof a.length)if(1==a.length||"$"==e.substr(-1,1)||""==e)for(e=0;e<a.length;e++)this.registerLanguagesForKeyboard(a[e],b,c);else{for(e=0;e<a.length;e++){var l=a[e].id.toLowerCase();"us"==l&&(l="english");for(d=0;d<a[e].languages.length;d++)if(l==a[e].languages[d].name.toLowerCase()){f=e;break}}this.registerLanguagesForKeyboard(a[f],b,c)}else if(c=e.split("@")[1],"string"==typeof c&&(c=c.replace(/\$$/,"")),f=a.languages,"undefined"!=typeof f)if("number"==
typeof f.length)for(e=0;e<f.length;e++)"undefined"!=typeof c&&f[e].id!=c||this.mergeStub(a,f[e],b);else this.mergeStub(a,f,b)};c.prototype.register=function(a){var b=a.timerid;try{var c=this._registerCore(a)}catch(w){c=Error("Error occurred while registering keyboards: "+w)}if(b&&(a=this.registrationResolvers[b],window.clearTimeout(b),a))try{c instanceof Error?a.reject(c):a.resolve(c)}finally{delete this.registrationResolvers[b]}};c.prototype._registerCore=function(a){var b=a.options,c=this.keyboardStubs.length;
if("string"==typeof a.error)return b="","string"==typeof a.keyboardid&&(b=a.keyboardid.substr(0,1).toUpperCase()+a.keyboardid.substr(1)),Error(b+" keyboard not found.");if("undefined"==typeof b||"undefined"==typeof b.context)return Error("Could not find a keyboard with that ID.");if("keyboard"==b.context){var d=a.keyboard;if("number"==typeof d.length)for(a=0;a<d.length;a++)this.registerLanguagesForKeyboard(d[a],b,a);else this.registerLanguagesForKeyboard(d,b,0)}else"language"==b.context&&(this.languageList=
a.languages);return this.keyboardStubs.slice(c)};c.prototype.addLanguageKeyboards=function(a){var b=this,c=[];if(null==this.languageList){null==this.languageListPromise&&(this.languageListPromise=this.keymanCloudRequest("",!0).catch(function(a){console.error(a);c.push({error:a});return c}));var d=this;return(new Promise(function(b,c){if(d.languageListPromise)return d.languageListPromise.then(function(){b(d.addLanguageKeyboards(a))}).catch(function(a){c(a)});b(d.addLanguageKeyboards(a))})).then(function(a){if(a instanceof
Error)throw a;return a})}for(var f="",e=0;e<a.length;e++){var g=a[e].toLowerCase(),h="$"==g.substr(-1,1);h&&(g=g.substr(0,g.length-1));for(var k=!1,n=0;n<this.languageList.length;n++)if(g==this.languageList[n].name.toLowerCase()){""!=f&&(f+=",");f=f+"@"+this.languageList[n].id;h&&(f+="$");k=!0;break}k||(g={language:{name:g},error:Error(this.alertLanguageUnavailable(g))},c.push(g))}return""==f?Promise.reject(c):this.keymanCloudRequest("&keyboardid="+f,!1).then(function(a){return b.mergeAndResolveStubPromises(a,
c)},function(a){console.error(a);c.push({error:a});return Promise.reject(c)})};c.prototype.keymanCloudRequest=function(a,b){var c=this,d=this.keymanweb,f="https://api.keyman.com/cloud/4.0/"+(1<arguments.length&&b?"languages":"keyboards");return new Promise(function(b,e){var l=d.util._CreateElement("script"),g="?jsonp=keyman.register&languageidtype=bcp47&version="+d.version,h=window.setTimeout(function(){delete c.registrationResolvers[h];e(Error("The Cloud API request timed out."))},1E4);c.registrationResolvers[h]=
{resolve:b,reject:e};l.onload=function(a){window.clearTimeout(h);if(c.registrationResolvers[h])try{e(Error("The Cloud API failed to find an appropriate keyboard."))}finally{delete c.registrationResolvers[h]}};l.onerror=function(a,b,d,f,l){window.clearTimeout(h);try{a="Could not find a keyboard with that ID.",l&&(a=a+": "+l.message),e(Error(a))}finally{delete c.registrationResolvers[h]}};l.src=f+g+a+("&timerid="+h);try{document.body.appendChild(l)}catch(y){document.getElementsByTagName("head")[0].appendChild(l)}})};
c.prototype.alertLanguageUnavailable=function(a){a="No keyboards are available for "+a+". Does it have another language name?";this.keymanweb.util.internalAlert(a);return a};c.prototype.serverUnavailable=function(a){this.keymanweb.util.internalAlert(""==a?"Unable to connect to Keyman Cloud server!":a);this.keymanweb.warned=!0};c.prototype.removeKeyboards=function(a,b){if(0==arguments.length)return!1;var c,d,f=!0,e=!1,l=!1;for(c=0;c<arguments.length;c++){for(d=this.keyboardStubs.length-1;0<=d;d--)if("Keyboard_"+
arguments[c]==this.keyboardStubs[d].KI){"Keyboard_"+arguments[c]==this.getActiveKeyboardName()&&(e=!0);l=!0;this.keyboardStubs.splice(d,1);break}0>d&&(f=!1)}for(c=0;c<arguments.length;c++)for(d=this.keyboards.length-1;0<=d;d--)if("Keyboard_"+arguments[c]==this.keyboards[d].KI){this.keyboards.splice(d,1);break}e&&(0<this.keyboardStubs.length?this._SetActiveKeyboard(this.keyboardStubs[0].KI,this.keyboardStubs[0].KLC,!0):this._SetActiveKeyboard("","",!1),this.keymanweb.uiManager.justActivated=!0);l&&
this.doKeyboardUnregistered();return f};c.prototype._registerKeyboard=function(b){return __awaiter(this,void 0,void 0,function(){var c,d,f,e;return __generator(this,function(l){switch(l.label){case 0:return this.keymanweb.initialized?[3,2]:[4,this.deferment];case 1:l.sent(),l.label=2;case 2:if(b._kmw)return console.error("The keyboard _kmw property is a reserved field for engine use only; this keyboard is invalid."),[2];b._kmw=new a;this.keymanweb.isEmbedded&&this.keymanweb.preserveID(b);e=f=this.activeStub;
if(!(f&&"KI"in f)||f.KI!=b.KI)for(d=0;d<this.keyboardStubs.length;d++){f=this.keyboardStubs[d];if(b.KI==f.KI)break;f=null}null==this.activeStub&&null!=f&&(this.activeStub=f);for(c=0;c<this.keyboards.length;c++)if(b.KI==this.keyboards[c].KI)return[2];this.keyboards=this.keymanweb._push(this.keyboards,b);this.doKeyboardLoaded(b.KI);this.activeStub=e;return[2]}})})};c.prototype._registerStub=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return a=
__assign({},a),this.keymanweb.initialized?[3,2]:[4,this.deferment];case 1:b.sent(),b.label=2;case 2:return null==this.dfltStub&&(this.dfltStub=a),this.keymanweb.isEmbedded&&this.keymanweb.namespaceID(a),"undefined"==typeof a.KLC&&(a.KLC=""),"undefined"==typeof a.KL&&(a.KL="undefined"),this.keyboardStubs=this.keymanweb._push(this.keyboardStubs,a),this.doKeyboardRegistered(a.KI,a.KL,a.KN,a.KLC,a.KP),this.activeStub||this.dfltStub!=a||1!=this.keyboardStubs.length||"true"!=this.keymanweb.options.setActiveOnRegister||
this.setActiveKeyboard(a.KI,a.KLC),[2,Promise.resolve(!1)]}})})};c.prototype.doKeyboardRegistered=function(a,b,c,d,e){a={internalName:a,language:b,keyboardName:c,languageCode:d};e&&(a["package"]=e);return this.keymanweb.util.callEvent("kmw.keyboardregistered",a)};c.prototype.doKeyboardUnregistered=function(){return this.keymanweb.util.callEvent("kmw.keyboardregistered",{})};c.prototype.doKeyboardLoaded=function(a){var b={};b.keyboardName=a;return this.keymanweb.util.callEvent("kmw.keyboardloaded",
b)};c.prototype.doBeforeKeyboardChange=function(a,b){var c={};c.internalName=a;c.languageCode=b;return this.keymanweb.util.callEvent("kmw.beforekeyboardchange",c)};c.prototype.doKeyboardChange=function(a,b,c){return this.keymanweb.util.callEvent("kmw.keyboardchange",{internalName:a,languageCode:b,indirect:2<arguments.length?c:!1})};c.prototype.shutdown=function(){for(var a=0,b=this.linkedScripts;a<b.length;a++){var c=b[a];c.remove?c.remove():c.parentNode&&c.parentNode.removeChild(c)}};c.regions="World;Africa;Asia;Europe;South America;North America;Oceania;Central America;Middle East".split(";");
c.regionCodes="un af as eu sa na oc ca me".split(" ");return c}();h.KeyboardManager=c})(k.keyboards||(k.keyboards={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){var h=function(){function e(b,a,c){this.code=b;this.shift=a;this.handler=c}e.prototype.matches=function(b,a){return this.code==b&&this.shift==a};return e}(),k=function(){function e(b){this.hotkeys=[];this._Process=function(a){a||(a=window.event);var b=g.dom.PreProcessor._GetEventKeyCode(a);if(null==b)return!1;for(var d=(a.shiftKey?16:0)|(a.ctrlKey?32:0)|(a.altKey?64:0),f=0;f<this.hotkeys.length;f++)if(this.hotkeys[f].matches(b,d))return this.hotkeys[f].handler(),a.returnValue=
!1,a&&a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,!1;return!0}.bind(this);this.keyman=b}e.prototype.addHotKey=function(b,a,c){for(var d=0;d<this.hotkeys.length;d++)if(this.hotkeys[d].code==b&&this.hotkeys[d].shift==a){this.hotkeys[d].handler=c;return}this.hotkeys.push(new h(b,a,c))};e.prototype.removeHotkey=function(b,a){for(var c=0;c<this.hotkeys.length;c++)if(this.hotkeys[c].matches(b,a)){this.hotkeys.splice(c,1);break}};return e}();g.HotkeyManager=k})(g.keyman||(g.keyman={}))})(com||
(com={}));
(function(g){(function(g){var h=function(){return function(e,b){this.activationPending=e;this.activated=b}}();g.UIState=h;var k=function(){function e(b){this.justActivated=this.isActivating=!1;this.doUnload=function(){return this.keyman.util.callEvent("kmw.unloaduserinterface",{})};this.keyman=b}e.prototype.getUIState=function(){return new h(this.isActivating,this.justActivated)};e.prototype.setActivatingUI=function(b){this.isActivating=b?!0:!1};e.prototype.doLoad=function(){return this.keyman.util.callEvent("kmw.loaduserinterface",{})};
return e}();g.UIManager=k})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function e(b){this.keyman=b;this.scrolling=!1;this.shim=this.constructShim()}e.prototype.constructShim=function(){var b=this,a=this.keyman.util._CreateElement("div"),c=this.keyman.osk;a.id="kmw-language-menu-background";a.addEventListener("touchstart",function(a){a.preventDefault();b.hide();if(2<a.touches.length){var d=a.touches[1].pageX;a=a.touches[1].pageY;var e=c.vkbd.spaceBar;d>e.offsetLeft&&d<e.offsetLeft+e.offsetWidth&&a>e.offsetTop&&a<
e.offsetTop+e.offsetHeight&&c.showBuild()}},!1);return a};e.prototype.show=function(){var b=this.keyman.keyboardManager.keyboardStubs,a=this.keyman.util;if(!(1>b.length)){var c=this.lgList=a._CreateElement("div");this.lgList.id="kmw-language-menu";var d=this;document.body.appendChild(this.shim);var f=a._CreateElement("div"),e=f.style,g=a._CreateElement("div");f.id="kmw-menu-scroll-container";g.id="kmw-menu-scroller";"WebkitOverflowScrolling"in e&&(e.WebkitOverflowScrolling="touch");f.appendChild(g);
c.appendChild(f);var h;e=a._CreateElement("div");e.id="kmw-menu-index";for(h=1;26>=h;h++){var k=a._CreateElement("p");k.innerHTML=String.fromCharCode(h+64);e.appendChild(k)}e.addEventListener("touchstart",function(a){d.scrollToLanguage(a,f,g)},!1);e.addEventListener("touchend",function(a){a.stopPropagation();a.preventDefault()},!1);c.appendChild(e);c.addEventListener("scroll",function(a){d.scrolling=!0},!1);f.addEventListener("scroll",function(a){1>f.scrollTop&&(f.scrollTop=1);f.scrollTop>f.scrollHeight-
f.offsetHeight-1&&(f.scrollTop=f.scrollHeight-f.offsetHeight-1)},!1);this.activeLgNo=this.addLanguages(g,b);this.lgList.style.visibility="hidden";document.body.appendChild(this.lgList);"Android"==a.device.OS&&"devicePixelRatio"in window&&(this.lgList.style.fontSize=2/window.devicePixelRatio+"em");"Android"==a.device.OS&&"tablet"==a.device.formFactor&&"devicePixelRatio"in window&&(h=parseInt(a.getStyleValue(c,"width"),10),b=c.style,isNaN(h)||(b.width=b.maxWidth=2*h/window.devicePixelRatio+"px"),h=
parseInt(a.getStyleValue(f,"width"),10),b=f.style,isNaN(h)||(b.width=b.maxWidth=2*h/window.devicePixelRatio+"px"),h=parseInt(a.getStyleValue(g,"width"),10),b=g.style,isNaN(h)||(b.width=b.maxWidth=2*h/window.devicePixelRatio+"px"));this.adjust(0);a=Math.floor(c.offsetHeight/26);b=Math.round(100*a/(e.childNodes[1].offsetTop-e.childNodes[0].offsetTop))/100;k=.6<b?1:2;1.25<b&&(b=1.25);for(h=0;26>h;h++){var n=e.childNodes[h].style;2==k&&1==h%2?n.display="none":(n.fontSize=b*k+"em",n.lineHeight=a*k+"px")}h=
f.offsetWidth;f.scrollHeight>f.offsetHeight+3?h+=e.offsetWidth:e.style.display="none";c.style.width=h+"px";this.lgList.style.visibility="";c=g.firstChild.offsetHeight*this.activeLgNo+1;f.scrollTop=c;f.scrollTop<c&&(f.scrollTop=f.scrollHeight-f.offsetHeight);f.scrollTop>f.scrollHeight-f.offsetHeight-1&&(f.scrollTop=f.scrollHeight-f.offsetHeight-1)}};e.prototype.adjust=function(b){var a=this.keyman.osk,c=this.keyman.util,d=c.device,f=this.lgList,e=f.firstChild,g=e.firstChild,h=f.style;f=f.childNodes[1];
var n=window.innerHeight-a.vkbd.lgKey.offsetHeight-16;b=(g.childNodes.length+b-1)*g.firstChild.firstChild.offsetHeight;"iOS"==d.OS&&("phone"==d.formFactor?(d=c.landscapeView()?36:0,n=(window.innerHeight-d-16)*c.getViewportScale()):"tablet"==d.formFactor&&(d=c.landscapeView()?16:0,n-=d));h.left=k.dom.Utils.getAbsoluteX(a.vkbd.lgKey)+"px";b>n&&(b=n);h.height=b+"px";h.bottom="0px";f.style.height=e.style.height=h.height};e.prototype.scrollToLanguage=function(b,a,c){b.stopImmediatePropagation();b.stopPropagation();
b.preventDefault();var d=b.touches[0].target;if("P"==d.nodeName){var f;b=0;d=d.innerHTML.charCodeAt(0);var e=c.childNodes;try{for(f=0;f<e.length-1;f++){var g=e[f].firstChild.innerHTML.toUpperCase().charCodeAt(0);if(g>=d)break}}catch(w){}try{b=c.firstChild.offsetHeight*f+1,a.scrollTop=b}catch(w){b=0}try{a.scrollTop<b&&(a.scrollTop=a.scrollHeight-a.offsetHeight),a.scrollTop>a.scrollHeight-a.offsetHeight-1&&(a.scrollTop=a.scrollHeight-a.offsetHeight-1)}catch(w){}}};e.prototype.addLanguages=function(b,
a){var c=a.length,d=this.keyman.util,f=d.device,e,g,h=[];for(g=0;g<c;g++){var k=a[g].KL;-1==h.indexOf(k)&&h.push(k)}h.sort();var n=Math.round(100/d.getViewportScale())/100,t,v,z,r,y=-1;k=function(){t=d._CreateElement("div");t.className="kbd-list-closed";v=d._CreateElement("p");v.kList=[];for(g=0;g<c;g++)a[g].KL==h[e]&&v.kList.push(a[g]);"iOS"==f.OS&&(v.style.fontSize=n+"em");t.appendChild(v);b.appendChild(t);h[e]==A.keyman.keyboardManager.activeStub.KL&&(y=e);var l=A;if(1<v.kList.length)for(v.className=
"kbd-list",v.innerHTML=h[e]+"...",v.scrolled=!1,v.ontouchend=function(a){a.preventDefault();a.stopPropagation();a.target.scrolled?a.target.scrolled=!1:this.parentNode.className="kbd-list-closed"==this.parentNode.className?"kbd-list-open":"kbd-list-closed";l.adjust("kbd-list-closed"==this.parentNode.className?0:this.kList.length)},v.addEventListener("touchstart",function(a){a.stopPropagation()},!1),v.addEventListener("touchmove",function(a){a.target.scrolled=!0;a.stopPropagation()},!1),z=0;z<v.kList.length;z++)r=
d._CreateElement("p"),r.className="kbd-list-entry","iOS"==f.OS&&(r.style.fontSize=n+"em"),A.addKeyboard(v.kList[z],r,!1),t.appendChild(r);else v.innerHTML=h[e],v.className="kbd-single-entry",A.addKeyboard(v.kList[0],v,!0);e==y&&(v.className+=" current")};var A=this;for(e=0;e<h.length;e++)k();k=d._CreateElement("div");k.id="kmw-menu-footer";var p=function(a){a.preventDefault();a.stopPropagation()};k.addEventListener("touchstart",p,!1);k.addEventListener("touchmove",p,!1);k.addEventListener("touchend",
p,!1);b.appendChild(k);return y};e.prototype.addKeyboard=function(b,a,c){a.kn=b.KI;a.kc=b.KLC;a.innerHTML=c?b.KL:b.KN.replace(" Keyboard","");var d=this;b=function(a){a.stopPropagation();0>=this.className.indexOf("selected")&&(this.className+=" selected");d.scrolling=!1;d.y0=a.touches[0].pageY;return!0};c=function(a){a.stopImmediatePropagation();var b=d.lgList.childNodes[0],c=b.scrollHeight-b.offsetHeight;if("undefined"!=typeof a.pageY)var f=a.pageY;else if("undefined"!=typeof a.touches)f=a.touches[0].pageY;
else return;var e=f-d.y0;if(0>e)b.scrollTop>=c-1&&(a.preventDefault(),d.y0=f);else if(0<e)2>b.scrollTop&&(a.preventDefault(),d.y0=f);else return;if(-5>e||5<e)d.scrolling=!0,this.className=this.className.replace(/\s*selected/,""),d.y0=f;return!0};var f=function(a){a.preventDefault();"undefined"!=typeof a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation();d.scrolling?this.className=this.className.replace(/\s*selected/,""):(g.keyman.dom.DOMEventHandlers.states.setFocusTimer(),
d.lgList.style.display="none",d.keyman.keyboardManager._SetActiveKeyboard(this.kn,this.kc,!0),d.keyman.keyboardManager.doKeyboardChange(this.kn,this.kc),d.keyman.domManager.focusLastActiveElement(),d.hide());return!0};a.onmspointerdown=b;a.addEventListener("touchstart",b,!1);a.onmspointermove=c;a.addEventListener("touchmove",c,!1);a.onmspointerout=f;a.addEventListener("touchend",f,!1)};e.prototype.hide=function(){var b=this.keyman.osk,a=this;this.lgList&&(b.vkbd.highlightKey(b.vkbd.lgKey,!1),this.lgList.style.visibility=
"hidden",window.setTimeout(function(){a.shim.parentElement&&(document.body.removeChild(a.shim),document.body.removeChild(a.lgList))},500))};return e}();h.LanguageMenu=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b){Object.assign(this,"string"==typeof b?e.parseLengthStyle(b):b)}Object.defineProperty(e.prototype,"styleString",{get:function(){return this.absolute?this.val+"px":this.special?this.val+this.special:100*this.val+"%"},enumerable:!0,configurable:!0});e.prototype.scaledBy=function(b){return new e({val:b*this.val,absolute:this.absolute})};e.inPixels=function(b){return new e({val:b,absolute:!0})};e.inPercent=function(b){return new e({val:b/
100,absolute:!1})};e.forScalar=function(b){return new e({val:b,absolute:!1})};e.special=function(b,a){return new e({val:b,absolute:!1,special:a})};e.parseLengthStyle=function(b){var a=parseFloat(b);return isNaN(a)?(console.error("Could not properly parse specified length style info: '"+b+"'."),null):-1!=b.indexOf("px")?{val:a,absolute:!0}:-1!=b.indexOf("pt")?{val:4*a/3,absolute:!0}:-1!=b.indexOf("%")?{val:a/100,absolute:!1}:-1!=b.indexOf("rem")?{val:a,absolute:!1,special:"rem"}:-1!=b.indexOf("em")?
{val:a,absolute:!1,special:"em"}:{val:4*a/3,absolute:!0}};return e}();g.ParsedLengthStyle=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(k){var e=function(){function b(a){this.mouseCancellingHandler=function(a){a.preventDefault();a.cancelBubble=!0;return!1};this._element=this.buildResizeBar();a&&(this._resizeHandle.onmousedown=a.mouseDownHandler)}Object.defineProperty(b.prototype,"layoutHeight",{get:function(){return b.DISPLAY_HEIGHT},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"handle",{get:function(){return this._resizeHandle},enumerable:!0,configurable:!0});b.prototype.allowResizing=function(a){this._resizeHandle.style.display=a?"block":"none"};b.prototype.markUnselectable=function(a){a.style.MozUserSelect="none";a.style.KhtmlUserSelect="none";a.style.UserSelect="none";a.style.WebkitUserSelect="none"};b.prototype.buildResizeBar=function(){var a=g.keyman.singleton.util,b=g.keyman.singleton.osk,d=document.createElement("div");this.markUnselectable(d);d.className="kmw-footer";
d.onmousedown=this.mouseCancellingHandler;var f=document.createElement("div");this.markUnselectable(f);f.className="kmw-footer-caption";f.innerHTML='<a href="https://keyman.com/developer/keymanweb/">KeymanWeb</a>';f.id="keymanweb-osk-footer-caption";a.attachDOMEvent(f,"dblclick",function(a){a&&a.shiftKey&&b.showBuild();return!1}.bind(this),!1);"onselectstart"in f&&(f.onselectstart=a.selectStartHandler);d.appendChild(f);a=document.createElement("div");this.markUnselectable(a);a.className="kmw-footer-resize";
d.appendChild(a);this._resizeHandle=a;return d};b.prototype.refreshLayout=function(){};b.DISPLAY_HEIGHT=h.ParsedLengthStyle.inPixels(16);return b}();k.ResizeBar=e})(h.layouts||(h.layouts={}))})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b,a,c){this.x=b;this.y=a;c&&(this.source=c)}e.fromEvent=function(b){var a=window.TouchEvent&&b instanceof TouchEvent?b.changedTouches[0]:b.changedTouches?b.changedTouches[0]:b;return a.pageX?new e(a.pageX,a.pageY,b):a.clientX?new e(a.clientX+document.body.scrollLeft,a.clientY+document.body.scrollTop,b):new e(null,null,b)};Object.defineProperty(e.prototype,"activeInputCount",{get:function(){return window.TouchEvent&&void 0!==this.source.touches&&
null!==this.source.touches?this.source.touches.length:0<this.source.buttons?1:0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"target",{get:function(){var b;return null===(b=this.source)||void 0===b?void 0:b.target},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isFromTouch",{get:function(){return!this.isFromMouse},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isFromMouse",{get:function(){return this.source instanceof MouseEvent},enumerable:!0,
configurable:!0});return e}();g.InputEventCoordinate=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(h){var e=function(){function a(a){this._VPreviousMouseMove=document.onmousemove;this._VPreviousMouseUp=document.onmouseup;this._VPreviousCursor=document.body.style.cursor;this._VPreviousMouseButton="undefined"==typeof a.which?a.button:a.which}a.prototype.restore=function(){document.onmousemove=this._VPreviousMouseMove;document.onmouseup=this._VPreviousMouseUp;document.body.style.cursor&&(document.body.style.cursor=this._VPreviousCursor)};a.prototype.matchesCausingClick=
function(a){return this._VPreviousMouseButton==("undefined"==typeof a.which?a.button:a.which)};return a}(),b=function(){function a(a){this.startHandler=this._VMoveMouseDown.bind(this);this.cursorType=a}Object.defineProperty(a.prototype,"enabled",{get:function(){return this._enabled},set:function(a){this._enabled=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isActive",{get:function(){return!!this._mouseStartSnapshot},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"mouseDownHandler",{get:function(){return this.startHandler},enumerable:!0,configurable:!0});a.prototype._VMoveMouseDown=function(a){if(!a||!this._enabled)return!0;this._mouseStartSnapshot||(this._mouseStartSnapshot=new e(a));this._startCoord=g.InputEventCoordinate.fromEvent(a);document.onmousemove=this._VMoveMouseMove.bind(this);document.onmouseup=this._VMoveMouseUp.bind(this);document.body.style.cursor&&(document.body.style.cursor=this.cursorType);a.preventDefault();a.cancelBubble=!0;this.onDragStart();
return!1};a.prototype._VMoveMouseMove=function(a){if(!a||!this.enabled)return!0;a.preventDefault();a.cancelBubble=!0;return this._mouseStartSnapshot.matchesCausingClick(a)?(a=g.InputEventCoordinate.fromEvent(a),this.onDragMove(a.x-this._startCoord.x,a.y-this._startCoord.y),!1):this._VMoveMouseUp(a)};a.prototype._VMoveMouseUp=function(a){if(!a)return!0;this._mouseStartSnapshot.restore();this._mouseStartSnapshot=null;a.preventDefault();a.cancelBubble=!0;this.onDragRelease();return!1};return a}();h.MouseDragOperation=
b})(g.layouts||(g.layouts={}))})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(k){var e=function(){function b(a){this.mouseCancellingHandler=function(a){a.preventDefault();a.cancelBubble=!0;return!1};this._element=this.buildTitleBar();a&&(this.element.onmousedown=a.mouseDownHandler)}Object.defineProperty(b.prototype,"layoutHeight",{get:function(){return b.DISPLAY_HEIGHT},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0});b.prototype.setPinCJKOffset=
function(){this._unpinButton.style.left="15px"};b.prototype.showPin=function(a){this._unpinButton.style.display=a?"block":"none"};b.prototype.setTitle=function(a){this._caption.innerHTML=a};b.prototype.setTitleFromKeyboard=function(a){this._caption.innerHTML="<span style='font-weight:bold'>"+(null===a||void 0===a?void 0:a.name)+"</span>"};b.prototype.attachHandlers=function(a){var b=g.keyman.singleton.util;this._helpButton.onclick=function(){b.callEvent("osk.helpclick",{});window.event&&(window.event.returnValue=
!1);return!1};this._configButton.onclick=function(){b.callEvent("osk.configclick",{});window.event&&(window.event.returnValue=!1);return!1};this._closeButton.onclick=function(){a.startHide(!0);return!1};a instanceof h.FloatingOSKView&&(this._unpinButton.onclick=function(){a.restorePosition(!0);return!1})};b.prototype.buildTitleBar=function(){var a=document.createElement("div");this.markUnselectable(a);a.id="keymanweb_title_bar";a.className="kmw-title-bar";var b=this._caption=document.createElement("span");
this.markUnselectable(b);b.className="kmw-title-bar-caption";b.style.color="#fff";a.appendChild(b);b=this._closeButton=this.buildCloseButton();a.appendChild(b);b=this._helpButton=this.buildHelpButton();a.appendChild(b);b=this._configButton=this.buildConfigButton();a.appendChild(b);b=this._unpinButton=this.buildUnpinButton();a.appendChild(b);return a};b.prototype.markUnselectable=function(a){a.style.MozUserSelect="none";a.style.KhtmlUserSelect="none";a.style.UserSelect="none";a.style.WebkitUserSelect=
"none"};b.prototype.buildCloseButton=function(){var a=document.createElement("div");this.markUnselectable(a);a.id="kmw-close-button";a.className="kmw-title-bar-image";a.onmousedown=this.mouseCancellingHandler;return a};b.prototype.buildHelpButton=function(){var a=document.createElement("div");this.markUnselectable(a);a.id="kmw-help-image";a.className="kmw-title-bar-image";a.title="KeymanWeb Help";a.onmousedown=this.mouseCancellingHandler;return a};b.prototype.buildConfigButton=function(){var a=document.createElement("div");
this.markUnselectable(a);a.id="kmw-config-image";a.className="kmw-title-bar-image";a.title="KeymanWeb Configuration Options";a.onmousedown=this.mouseCancellingHandler;return a};b.prototype.buildUnpinButton=function(){var a=document.createElement("div");this.markUnselectable(a);a.id="kmw-pin-image";a.className="kmw-title-bar-image";a.title="Pin the On Screen Keyboard to its default location on the active text box";a.onmousedown=this.mouseCancellingHandler;return a};b.prototype.refreshLayout=function(){};
b.DISPLAY_HEIGHT=h.ParsedLengthStyle.inPixels(20);return b}();k.TitleBar=e})(h.layouts||(h.layouts={}))})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(h){var e=function(){function b(){this.titleBar=new h.TitleBar(this.titleDragHandler);this.resizeBar=new h.ResizeBar(this.resizeDragHandler)}Object.defineProperty(b.prototype,"movementEnabled",{get:function(){return this.titleDragHandler.enabled},set:function(a){this.titleDragHandler.enabled=a;this.titleBar.showPin(a&&this.oskView.userPositioned)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"resizingEnabled",{get:function(){return this.resizeDragHandler.enabled},
set:function(a){this.resizeDragHandler.enabled=a;this.resizeBar.allowResizing(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isBeingMoved",{get:function(){return this.titleDragHandler.isActive},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isBeingResized",{get:function(){return this.resizeDragHandler.isActive},enumerable:!0,configurable:!0});b.prototype.attachToView=function(a){this.oskView=a;this.titleBar.attachHandlers(a);this.titleDragHandler.enabled=
!a.noDrag;this.resizeDragHandler.enabled=!0};Object.defineProperty(b.prototype,"titleDragHandler",{get:function(){var a=this;return this._moveHandler?this._moveHandler:this._moveHandler=new (function(b){function c(){return b.call(this,"move")||this}__extends(c,b);c.prototype.onDragStart=function(){if(a.oskView){this.startX=a.oskView._Box.offsetLeft;this.startY=a.oskView._Box.offsetTop;var b=g.keyman.singleton;b.isCJK()&&a.titleBar.setPinCJKOffset();b.uiManager.justActivated=!0}};c.prototype.onDragMove=
function(b,c){a.oskView&&(a.titleBar.showPin(!0),a.oskView.userPositioned=!0,a.oskView._Box.style.left=this.startX+b+"px",a.oskView._Box.style.top=this.startY+c+"px",b=a.oskView.getRect(),a.oskView.setSize(b.width,b.height,!0),a.oskView.x=b.left,a.oskView.y=b.top)};c.prototype.onDragRelease=function(){if(a.oskView){var b=g.keyman.singleton;b.domManager.focusLastActiveElement();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);a.oskView.vkbd&&(a.oskView.vkbd.currentKey=null);a.oskView.userPositioned=
!0;a.oskView.doResizeMove();a.oskView.saveCookie()}};return c}(h.MouseDragOperation))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"resizeDragHandler",{get:function(){var a=this;return this._resizeHandler?this._resizeHandler:this._resizeHandler=new (function(b){function c(){return b.call(this,"se-resize")||this}__extends(c,b);c.prototype.onDragStart=function(){a.oskView&&(this.startWidth=a.oskView.computedWidth,this.startHeight=a.oskView.computedHeight,g.keyman.singleton.uiManager.justActivated=
!0)};c.prototype.onDragMove=function(b,c){a.oskView&&(b=this.startWidth+b,c=this.startHeight+c,b<.2*screen.width&&(b=.2*screen.width),c<.1*screen.height&&(c=.1*screen.height),b>.9*screen.width&&(b=.9*screen.width),c>.5*screen.height&&(c=.5*screen.height),a.oskView.setSize(b,c,!0))};c.prototype.onDragRelease=function(){if(a.oskView){var b=g.keyman.singleton;b.domManager.focusLastActiveElement();b.uiManager.justActivated=!1;b.uiManager.setActivatingUI(!1);a.oskView.vkbd&&(a.oskView.vkbd.currentKey=
null);a.oskView.vkbd&&(this.startWidth=a.oskView.computedWidth,this.startHeight=a.oskView.computedHeight);a.oskView.refreshLayout();a.oskView.doResizeMove();a.oskView.saveCookie()}};return c}(h.MouseDragOperation))},enumerable:!0,configurable:!0});return b}();h.TargetedFloatLayout=e})(h.layouts||(h.layouts={}))})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function e(){}e.clickKey=function(b,a){return(b=g.keyman.singleton.osk.vkbd.initKeyEvent(b,a))?this.raiseKeyEvent(b):!0};e.raiseKeyEvent=function(b){var a=g.keyman.singleton,c=a.domManager.lastActiveElement;if(null!=c){var d=k.dom.Utils.getOutputTarget(c);a.domManager.initActiveElement(c);d.invalidateSelection();d.deadkeys().deleteMatched();a.isEmbedded||(a.uiManager.setActivatingUI(!0),g.keyman.dom.DOMEventHandlers.states._IgnoreNextSelChange=
100,a.domManager.focusLastActiveElement(),g.keyman.dom.DOMEventHandlers.states._IgnoreNextSelChange=0);b=e.handleClick(b,d,null);a.uiManager.setActivatingUI(!1);return b}return!0};e.handleClick=function(b,a,c){var d=g.keyman.singleton;return"K_LOPT"==b.kName||"K_ROPT"==b.kName?(d.osk.vkbd.optionKey(c,b.kName,!0),!0):!!d.core.processKeyEvent(b,a)};return e}();h.PreProcessor=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){g.getFontSizeStyle=function(h){if("string"==typeof h)var e=h;else e=h.style.fontSize,e||(e=getComputedStyle(h).fontSize);return new g.ParsedLengthStyle(e)}})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){function n(a){return a&&"key"in a&&a.key instanceof b}var e=function(){return function(a,b){this.key=a;this.keyId=b}}();h.KeyData=e;h.link=function(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);return a};h.isKey=n;h.getKeyFrom=function(a){return n(a)?a:null};e=function(){return function(a,b,d,f,e,g){this.id=a;this.text=b;this.width=d?d:"50";this.sp=f;this.nextlayer=e;this.pad=g}}();h.OSKKeySpec=e;var b=function(){function a(a,b){this.spec=a;this.layer=
b}a.prototype.setButtonClass=function(){var b=this.spec,d=this.btn,f=0;"string"==typeof b.dk&&"1"==b.dk&&(f=8);"string"==typeof b.sp&&(f=parseInt(b.sp,10));if(0>f||10<f)f=0;d.className="kmw-key kmw-key-"+a.BUTTON_CLASSES[f]};a.prototype.setToggleState=function(b){var c;var f=(c="string"==typeof this.spec.sp)?parseInt(this.spec.sp,10):this.spec.sp;switch(a.BUTTON_CLASSES[f]){case "shift":case "shift-on":void 0===b&&(b="shift"==a.BUTTON_CLASSES[f]);this.spec.sp=1+(b?1:0);break;case "special":case "special-on":void 0===
b&&(b="special"==a.BUTTON_CLASSES[f]);this.spec.sp=3+(b?1:0);break;default:return}c&&(this.spec.sp=""+this.spec.sp);this.setButtonClass()};a.prototype.isFrameKey=function(){switch(a.BUTTON_CLASSES[this.spec.sp||0]){case "default":case "deadkey":return!1;default:return!0}};a.prototype.allowsKeyTip=function(){return this.isFrameKey()?!1:!this.btn.classList.contains("kmw-spacebar")};a.prototype.highlight=function(b){var c=this.btn.classList;b?c.contains(a.HIGHLIGHT_CLASS)||c.add(a.HIGHLIGHT_CLASS):c.remove(a.HIGHLIGHT_CLASS)};
a.getTextMetrics=function(b,d,f){f={fontFamily:f.fontFamily,fontSize:f.fontSize};f.fontFamily||(f.fontFamily=getComputedStyle(document.body).fontFamily);f.fontSize&&""!=f.fontSize||(f.fontSize="1em");var c=f.fontFamily;f=h.getFontSizeStyle(f.fontSize);d=f.absolute?f.val+"px":f.val*d+"px";f=(a.getTextMetrics.canvas||(a.getTextMetrics.canvas=document.createElement("canvas"))).getContext("2d");f.font=d+" "+c;return f.measureText(b)};a.prototype.getIdealFontSize=function(b,d,f){var c=getComputedStyle(this.btn),
e=parseFloat(c.width),g=1,k=h.getFontSizeStyle(d.fontSize||"1em");c.fontSize?f||(d=c):(g=b.getKeyEmFontSize(),e=this.getKeyWidth(b));b=h.getFontSizeStyle(d.fontSize||"1em");g=a.getTextMetrics(this.spec.text,g,d);var n,t;g.fontBoundingBoxAscent&&(n=g.fontBoundingBoxAscent+g.fontBoundingBoxDescent);n=n?n+2:0;d.height&&-1!=d.height.indexOf("px")&&(t=Number.parseFloat(d.height.substring(0,d.height.indexOf("px"))));d=.9*e/(g.width+2);t=n&&t?.9*t/n:void 0;e=d;t&&t<d&&(e=t);return 1>e?k.absolute?e*b.val+
"px":e*k.val+"em":k.absolute?b.val+"px":k.val+"em"};a.prototype.getKeyWidth=function(a){return this.spec.proportionalWidth*a.width};a.prototype.renameSpecialKey=function(a,b){switch(a){case "*ZWNJ*":a=b.device.OS==g.keyman.utils.OperatingSystem.Android?"*ZWNJAndroid*":"*ZWNJiOS*";break;case "*Enter*":a=b.isRTL?"*RTLEnter*":"*LTREnter*";break;case "*BkSp*":a=b.isRTL?"*RTLBkSp*":"*LTRBkSp*"}b=57344+h.VisualKeyboard.specialCharacters[a];return h.VisualKeyboard.specialCharacters[a]?String.fromCharCode(b):
a};a.prototype.unicodeKeyIdToString=function(a){if(!a||"U_"!=a.substr(0,2))return null;var b="",c=0;for(a=a.substr(2).split("_");c<a.length;c++){var e=parseInt(a[c],16);0<=e&&31>=e||128<=e&&159>=e||(b+=String.kmwFromCharCode(e))}return b?b:null};a.prototype.generateKeyText=function(b){var c=this.spec,f=document.createElement("span"),e=f.style;if(null==c.text||""==c.text){var g="\u00a0";"string"==typeof c.id&&(g=this.unicodeKeyIdToString(c.id)||g)}else g=c.text,"*Tab*"==g&&"shift"==this.layer&&(g=
"*TabLeft*");f.className="kmw-key-text";var h=this.renameSpecialKey(g,b);h!=g&&(g=h,c.font="SpecialOSK");"string"==typeof c.font&&""!=c.font&&(e.fontFamily=c.font);"string"==typeof c.fontsize&&""!=c.fontsize&&(e.fontSize=c.fontsize);c={fontSize:e.fontSize};c.fontFamily=e.fontFamily?e.fontFamily:b.fontFamily;h=b.getKeyEmFontSize();0==a.getTextMetrics(g,h,c).width&&""!=g&&"\u00a0"!=g&&b.isRTL&&(g="\u200f"+g);e.fontSize=this.getIdealFontSize(b,c);f.innerText=g;return f};a.prototype.isUnderTouch=function(a){var b=
a.x;a=a.y;var c=this.btn,e=k.dom.Utils.getAbsoluteX(c),g=k.dom.Utils.getAbsoluteY(c),h=e+c.offsetWidth;c=g+c.offsetHeight;return b>e&&b<h&&a>g&&a<c};a.prototype.refreshLayout=function(a){this.label&&(this.label.style.fontSize=this.getIdealFontSize(a,this.btn.style))};a.specialCharacters={"*Shift*":8,"*Enter*":5,"*Tab*":6,"*BkSp*":4,"*Menu*":11,"*Hide*":10,"*Alt*":25,"*Ctrl*":1,"*Caps*":3,"*ABC*":16,"*abc*":17,"*123*":19,"*Symbol*":21,"*Currency*":20,"*Shifted*":9,"*AltGr*":2,"*TabLeft*":7,"*LAlt*":86,
"*RAlt*":87,"*LCtrl*":88,"*RCtrl*":89,"*LAltCtrl*":96,"*RAltCtrl*":97,"*LAltCtrlShift*":98,"*RAltCtrlShift*":99,"*AltShift*":100,"*CtrlShift*":101,"*AltCtrlShift*":102,"*LAltShift*":103,"*RAltShift*":104,"*LCtrlShift*":105,"*RCtrlShift*":112,"*LTREnter*":5,"*LTRBkSp*":4,"*RTLEnter*":113,"*RTLBkSp*":114,"*ShiftLock*":115,"*ShiftedLock*":116,"*ZWNJ*":117,"*ZWNJiOS*":117,"*ZWNJAndroid*":118};a.BUTTON_CLASSES="default shift shift-on special special-on    deadkey blank hidden".split(" ");a.HIGHLIGHT_CLASS=
"kmw-key-touched";return a}();h.OSKKey=b})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=g.keyman.text.Codes,e=function(b){function a(a,d,f){a=b.call(this,a,d)||this;a.row=f;return a}__extends(a,b);a.prototype.getId=function(){return this.spec.elementID};a.prototype.getCoreId=function(){return this.spec.coreID};a.prototype.getBaseId=function(){return this.spec.baseKeyID};a.prototype.generateKeyCapLabel=function(){var a=n.keyCodes[this.spec.baseKeyID];switch(a){case 186:a=59;break;case 187:a=61;break;case 188:a=44;break;case 189:a=45;break;
case 190:a=46;break;case 191:a=47;break;case 192:a=96;break;case 219:a=91;break;case 220:a=92;break;case 221:a=93;break;case 222:a=39;break;default:if(48>a||90<a)a=0}var b=document.createElement("div");b.className="kmw-key-label";0<a&&(b.innerText=String.fromCharCode(a));return b};a.prototype.processSubkeys=function(a,b){var c,d=a.subKeys=this.spec.sk;for(c=0;c<d.length;c++){if("1"==d[c].sp||"2"==d[c].sp)d[c].text=this.renameSpecialKey(d[c].text,b);d[c].layer||(d[c].layer=a.key.layer)}b=document.createElement("div");
b.className="kmw-key-popup-icon";a.appendChild(b)};a.prototype.construct=function(a){var b=this.spec,c=document.createElement("div");c.className="kmw-key-square";var e=document.createElement("div");e=this.btn=h.link(e,new h.KeyData(this,b.id));this.setButtonClass();var g=this.capLabel=this.generateKeyCapLabel();e.appendChild(g);e.id=this.getId();e.appendChild(this.label=this.generateKeyText(a));"undefined"!=typeof b.sk&&null!=b.sk?this.processSubkeys(e,a):e.subKeys=null;c.appendChild(e);return this.square=
c};a.prototype.refreshLayout=function(a){var c=this.spec;this.square.style.width=a.layoutWidth.scaledBy(c.proportionalWidth).styleString;this.square.style.marginLeft=a.layoutWidth.scaledBy(c.proportionalPad).styleString;this.btn.style.width=a.usesFixedWidthScaling?this.square.style.width:"100%";this.square.style.height=a.usesFixedHeightScaling?a.internalHeight.scaledBy(this.row.heightFraction).styleString:"100%";b.prototype.refreshLayout.call(this,a);c=g.keyman.singleton.util;a=a.device;a.OS==k.utils.OperatingSystem.iOS&&
a.formFactor==k.utils.FormFactor.Phone&&c.landscapeView()&&this.capLabel&&(this.capLabel.style.fontSize="6px")};Object.defineProperty(a.prototype,"displaysKeyCap",{get:function(){return this.capLabel&&"block"==this.capLabel.style.display},set:function(a){if(!this.capLabel)throw Error("Key element not yet constructed; cannot display key cap");this.capLabel.style.display=a?"block":"none"},enumerable:!0,configurable:!0});return a}(h.OSKKey);h.OSKBaseKey=e})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||
(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b,a,c){var d=this.element=document.createElement("div");d.className="kmw-key-row";this.heightFraction=1/a.row.length;c=c.key;this.keys=[];for(var f=0;f<c.length;f++){var e=new g.OSKBaseKey(c[f],a.id,this),h=e.construct(b);this.keys.push(e);d.appendChild(h)}}Object.defineProperty(e.prototype,"displaysKeyCaps",{get:function(){if(0<this.keys.length)return this.keys[0].displaysKeyCap},set:function(b){for(var a=0,c=this.keys;a<c.length;a++)c[a].displaysKeyCap=
b},enumerable:!0,configurable:!0});e.prototype.refreshLayout=function(b){var a=this.element.style,c=b.internalHeight.scaledBy(this.heightFraction);b.usesFixedHeightScaling&&(a.maxHeight=a.lineHeight=a.height=c.styleString);a=b.usesFixedHeightScaling?c:g.ParsedLengthStyle.forScalar(1);c=a.scaledBy(.075);for(var d=a.scaledBy(.85),f=0,e=this.keys;f<e.length;f++){var h=e[f],k=h.btn;h=h.btn.parentElement.style;h.height=h.minHeight=a.styleString;h=k.style;h.top=c.styleString;h.height=h.lineHeight=h.minHeight=
d.styleString;k.key&&k.key.refreshLayout(b)}};return e}();g.OSKRow=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b,a,c){this.spec=c;var d=this.element=document.createElement("div"),f=d.style;d.className="kmw-key-layer";4<c.row.length&&"phone"==b.device.formFactor&&(d.className+=" kmw-5rows");f.fontFamily="font"in a?a.font:"";this.nextlayer=d.layer=c.id;"string"==typeof c.nextlayer&&(d.nextLayer=this.nextlayer=c.nextlayer);f=c.row;this.rows=[];for(var e=0;e<f.length;e++){var h=new g.OSKRow(b,c,f[e]);h.displaysKeyCaps=a.displayUnderlying;d.appendChild(h.element);
this.rows.push(h)}b.device.touchable&&(this.globeKey=this.findKey("K_LOPT"),this.hideKey=this.findKey("K_ROPT"));this.spaceBarKey=this.findKey("K_SPACE");this.capsKey=this.findKey("K_CAPS");this.numKey=this.findKey("K_NUMLOCK");this.scrollKey=this.findKey("K_SCROLL")}Object.defineProperty(e.prototype,"rowHeight",{get:function(){return this._rowHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"id",{get:function(){return this.spec.id},enumerable:!0,configurable:!0});e.prototype.findKey=
function(b){for(var a=0,c=this.rows;a<c.length;a++)for(var d=0,f=c[a].keys;d<f.length;d++){var e=f[d];if(e.getBaseId()==b)return e}return null};e.prototype.refreshLayout=function(b,a){var c=this.rows.length,d=this._rowHeight=Math.floor(a/(0==c?1:c));b.usesFixedHeightScaling&&(this.element.style.height=a+"px");for(var f=0;f<c;f++){var e=this.rows[f],g=(c-f-1)*d+1;b.usesFixedHeightScaling&&(this.spec.row[f].proportionalY=(a-g-d/2)/a,f==c-1&&(e.element.style.bottom="1px"));e.refreshLayout(b)}};return e}();
g.OSKLayer=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){return function(e,b,a){this.layers={};b=b.layout(a);a=this.element=document.createElement("div");var c=a.style;a.className="kmw-key-layer-group";if(null!=b){var d=b.fontsize;c.fontSize="undefined"==typeof d||null==d||""==d?"1em":b.fontsize;d=b.layer;e.getDefaultKeyObject().fontsize=c.fontSize;for(c=0;c<d.length;c++){var f=d[c],l=new g.OSKLayer(e,b,f);this.layers[f.id]=l;l.element.style.display=0==c?"block":"none";a.appendChild(l.element)}}}}();
g.OSKLayerGroup=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(h){var e=function(){function b(a){this.state=!1;var b=this.element=document.createElement("div");b.className="kmw-keytip";b.id="kmw-keytip";b.style.pointerEvents="none";b.style.display="none";b.appendChild(this.tip=document.createElement("div"));b.appendChild(this.cap=document.createElement("div"));this.tip.appendChild(this.label=document.createElement("span"));this.tip.className="kmw-keytip-tip";this.cap.className="kmw-keytip-cap";this.label.className=
"kmw-keytip-label";this.constrain=a}b.prototype.show=function(a,b,d){var c=g.keyman.singleton,e=c.util;if(b&&a.offsetParent){var h=a.key.row.element,k=a.getClientRects()[0];h=h.getClientRects()[0];var n=k.left-h.left;h=k.width;var u=k.height,t=a.key.label;k=this.element.style;var v=d.element.parentNode.getBoundingClientRect(),z=a.getBoundingClientRect(),r=z.bottom-v.top+1,y=h+2*Math.ceil(.3*h),A=Math.ceil(2.3*u)+(r-Math.floor(r));k.top="auto";k.bottom=Math.floor(c.osk.computedHeight-r)+"px";k.textAlign=
"center";k.overflow="visible";k.fontFamily=e.getStyleValue(t,"font-family");k.width=y+"px";k.height=A+"px";e=e.getStyleInt(t,"font-size");0!=e&&(k.fontSize=a.key.getIdealFontSize(d,{fontFamily:k.fontFamily,fontSize:1.8*e+"px",height:1.6*u+"px"},!0));this.label.textContent=t.textContent;d=(y-h)/2;n<d?(this.cap.style.left="1px",n+=d-1):n>window.innerWidth-h-d?(this.cap.style.left=y-h-1+"px",n-=d-1):this.cap.style.left=d+"px";k.left=n-d+"px";e=getComputedStyle(this.element);c=c.osk.computedHeight;d=
parseFloat(e.bottom);e=parseFloat(e.height);n=Math.ceil(A/2);this.cap.style.width=h+"px";this.tip.style.height=n+"px";this.cap.style.top=n-3+"px";this.cap.style.height=z.bottom-v.top-Math.floor(r-A)-n+"px";this.constrain&&e+d>c&&(h=e+d-c,k.height=A-h+"px",this.cap.style.height=Math.max(0,A-h-A/2+2)+"px");k.display="block"}else this.element.style.display="none";this.key=a;this.state=b};return b}();h.KeyTip=e})(h.browser||(h.browser={}))})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(h){var e=function(b){function a(a,d){if("string"!=typeof d||""==d)throw"The 'layer' parameter for subkey construction must be properly defined.";return b.call(this,a,d)||this}__extends(a,b);a.prototype.getId=function(){return"popup-"+this.layer+"-"+this.spec.id};a.prototype.construct=function(a,b,f){var c=this.spec,d=document.createElement("div"),e=a.getDefaultKeyObject(),h=d.style,k;for(k in e)"string"!=typeof c[k]&&(c[k]=e[k]);d.className="kmw-key-square-ex";
f&&(h.marginTop="5px");h.width="undefined"!=typeof c.width?parseInt(c.width,10)*b.offsetWidth/100+"px":b.offsetWidth+"px";h.height=b.offsetHeight+"px";f=document.createElement("div");c=this.btn=g.link(f,new g.KeyData(this,c.id));this.setButtonClass();c.id=this.getId();f=c.style;f.height=h.height;f.lineHeight=b.style.lineHeight;f.width=h.width;f.position="absolute";c.appendChild(this.label=this.generateKeyText(a));d.appendChild(c);return this.square=d};a.prototype.allowsKeyTip=function(){return!1};
return a}(g.OSKKey);h.OSKSubKey=e})(g.browser||(g.browser={}))})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(h){var e=function(){function b(a,b){var c=g.keyman.singleton,f=this;this.promise=new Promise(function(a){f.resolver=a});this.vkbd=a;this.currentSelection=this.baseKey=b;b.key.highlight(!0);var e=b.subKeys,q=this.element=document.createElement("div");q.id="kmw-popup-keys";var n=q.style;n.fontFamily=a.fontFamily;n.fontSize=c.util.getStyleValue(b,"font-size");n.visibility="hidden";c=e.length;var D=Math.min(Math.ceil(c/9),2);var u=Math.ceil(c/D);n.width=
u*b.offsetWidth+5*u+"px";for(n=0;n<c;n++){var t=!1,v=Math.floor(n/u);1<D&&0<v&&(t=!0);v=b.key.layer;if("string"!=typeof v||""==v)v=a.layerId;t=(new h.OSKSubKey(e[n],v)).construct(a,b,t);q.appendChild(t)}this.shim=document.createElement("div");this.shim.id="kmw-popup-shim";a.device.formFactor==k.utils.FormFactor.Phone&&this.selectDefaultSubkey(a,b,q)}b.prototype.finalize=function(a){if(this.resolver){var b=null;this.currentSelection&&(b=this.vkbd.initKeyEvent(this.currentSelection,a),this.currentSelection.key.highlight(!1));
this.resolver(b)}this.resolver=null};b.prototype.reposition=function(a){var b=g.keyman.singleton,d=this.element,f=this.baseKey,e=a.element.offsetParent,h=f.key.row.element,n=d.style,D=f.offsetLeft+f.offsetParent.offsetLeft+.5*(f.offsetWidth-d.offsetWidth),u=b.osk.computedWidth-d.offsetWidth;D>u&&(D=u);0>D&&(D=0);n.left=D+"px";e=e.getBoundingClientRect();h=h.getBoundingClientRect();n.top=h.top-e.top-d.offsetHeight-3+"px";n.visibility="visible";b=b.isEmbedded;d=getComputedStyle(d);d=parseFloat(d.top);
h=0;0>d&&b&&(h=0-d,n.top="0px");a.device.formFactor==k.utils.FormFactor.Phone&&a.device.OS==k.utils.OperatingSystem.iOS&&(this.callout=this.addCallout(f,h))};b.prototype.addCallout=function(a,b){var c=g.keyman.singleton;b=b||0;if(0<a.offsetHeight-b+6){var f=document.createElement("div"),e=f.style;f.id="kmw-popup-callout";c.osk._Box.appendChild(f);a=a.getBoundingClientRect();c=c.osk._Box.getBoundingClientRect();b=Math.floor(a.top-c.top-9+b);e.top=b+"px";e.left=a.left-c.left+"px";e.width=a.width+"px";
e.height=a.bottom-c.top-b-1+"px";return f}return null};b.prototype.selectDefaultSubkey=function(a,b,d){for(var c,e=b.subKeys,g=0;g<e.length;g++){var h=d.childNodes[g].firstChild;if(b.key&&b.key.spec&&e[g].elementID==b.key.spec.elementID){c=h;break}}c&&(a.keyPending=c,c.key.highlight(!0))};b.prototype.isVisible=function(){return"visible"==this.element.style.visibility};b.prototype.clear=function(){this.resolver=null;this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.shim.parentNode&&
this.shim.parentNode.removeChild(this.shim);this.callout&&this.callout.parentNode&&this.callout.parentNode.removeChild(this.callout)};b.prototype.updateTouch=function(a){this.currentSelection=null;this.baseKey.key.highlight(!1);for(var b=0;b<this.baseKey.subKeys.length;b++)try{var d=this.element.childNodes[b].firstChild,f=d.key.isUnderTouch(a);f&&(this.currentSelection=d);d.key.highlight(f)}catch(l){l.message?console.error("Unexpected error when attempting to update selected subkey:"+l.message):console.error("Unexpected error (and error type) when attempting to update selected subkey.")}!this.currentSelection&&
this.baseKey.key.isUnderTouch(a)&&(this.baseKey.key.highlight(!0),this.currentSelection=this.baseKey)};return b}();h.SubkeyPopup=e})(h.browser||(h.browser={}))})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){(function(g){var e=function(){function b(a,b){this.popupDelay=500;this.vkbd=a;this.baseKey=b;var c=this;this.promise=new Promise(function(a,b){c.resolver=a;c.timerId=window.setTimeout(c.resolve.bind(c),c.popupDelay)})}b.prototype.cancel=function(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);this.resolver&&(this.resolver(null),this.resolver=null)};b.prototype.resolve=function(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=
null);this.resolver&&this.resolver(new g.SubkeyPopup(this.vkbd,this.baseKey))};return b}();g.PendingLongpress=e})(g.browser||(g.browser={}))})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(h){var k;(function(b){b[b.Waiting=0]="Waiting";b[b.Realized=1]="Realized";b[b.Cancelled=2]="Cancelled"})(k=h.PendingMultiTapState||(h.PendingMultiTapState={}));var e=function(){function b(a,b,d){this._touches=1;this._state=k.Waiting;this.cancelDelayFactor=125;this.vkbd=a;this.count=d;this.baseKey=b;var c=this;this._timeout=new Promise(function(a){c.timerId=window.setTimeout(function(){c.cancel();a()},c.cancelDelayFactor*c.count)})}Object.defineProperty(b.prototype,
"timeout",{get:function(){return this._timeout},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"realized",{get:function(){return this._state==k.Realized},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"cancelled",{get:function(){return this._state==k.Cancelled},enumerable:!0,configurable:!0});b.isValidTarget=function(a,b){return b.keyId.includes("K_SHIFT")&&a.layerGroup.layers.caps&&!b.subKeys&&1==a.touchCount};b.prototype.cleanup=function(){this.timerId&&window.clearTimeout(this.timerId);
this.timerId=null};b.prototype.cancel=function(){this._state=k.Cancelled;this.cleanup()};b.prototype.incrementTouch=function(a){this._state==k.Waiting&&(a.keyId.includes("K_SHIFT")?++this._touches==this.count&&this.realize():this.cancel());return this._state};b.prototype.realize=function(){if(this._state==k.Waiting){this._state=k.Realized;this.cleanup();var a=g.text.KeyEvent.constructNullKeyEvent(this.vkbd.device);a.kNextLayer="caps";a.Lstates=g.text.Codes.stateBitmasks.CAPS;a.LmodifierChange=!0;
h.PreProcessor.raiseKeyEvent(a)}};return b}();h.PendingMultiTap=e})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b){this.config=b}e.prototype.onInputStart=function(b){this.config.inputStartHandler&&this.config.inputStartHandler(b)};e.prototype.onInputMove=function(b){this.config.inputMoveHandler&&this.config.inputMoveHandler(b)};e.prototype.onInputMoveCancel=function(b){this.config.inputMoveCancelHandler&&this.config.inputMoveCancelHandler(b)};e.prototype.onInputEnd=function(b){this.config.inputEndHandler&&this.config.inputEndHandler(b)};return e}();
g.InputEventEngine=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(e){function b(a){a=e.call(this,a)||this;a._touchStart=a.onTouchStart.bind(a);a._touchMove=a.onTouchMove.bind(a);a._touchEnd=a.onTouchEnd.bind(a);return a}__extends(b,e);b.forVisualKeyboard=function(a){a={targetRoot:a.element,eventRoot:a.element,inputStartHandler:a.touch.bind(a),inputMoveHandler:a.moveOver.bind(a),inputMoveCancelHandler:a.moveCancel.bind(a),inputEndHandler:a.release.bind(a),coordConstrainedWithinInteractiveBounds:a.detectWithinInteractiveBounds.bind(a)};
return new b(a)};b.forPredictiveBanner=function(a,c){a={targetRoot:a.getDiv(),eventRoot:a.getDiv(),inputStartHandler:c.touchStart.bind(c),inputMoveHandler:c.touchMove.bind(c),inputEndHandler:c.touchEnd.bind(c),coordConstrainedWithinInteractiveBounds:function(){return!0}};return new b(a)};b.prototype.registerEventHandlers=function(){this.config.eventRoot.addEventListener("touchstart",this._touchStart,!0);this.config.eventRoot.addEventListener("touchmove",this._touchMove,!1);this.config.eventRoot.addEventListener("touchend",
this._touchEnd,!0)};b.prototype.unregisterEventHandlers=function(){this.config.eventRoot.removeEventListener("touchstart",this._touchStart,!0);this.config.eventRoot.removeEventListener("touchmove",this._touchMove,!1);this.config.eventRoot.removeEventListener("touchend",this._touchEnd,!0)};b.prototype.preventPropagation=function(a){a.preventDefault();a.cancelBubble=!0;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation()};
b.prototype.onTouchStart=function(a){this.onInputStart(g.InputEventCoordinate.fromEvent(a))};b.prototype.onTouchMove=function(a){this.preventPropagation(a);a=g.InputEventCoordinate.fromEvent(a);if(this.config.coordConstrainedWithinInteractiveBounds(a))this.onInputMove(a);else this.onInputMoveCancel(a)};b.prototype.onTouchEnd=function(a){this.onInputEnd(g.InputEventCoordinate.fromEvent(a))};return b}(g.InputEventEngine);g.TouchEventEngine=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com=
{}));
(function(g){(function(g){(function(g){var h=function(e){function b(a){a=e.call(this,a)||this;a.hasActiveClick=!1;a.ignoreSequence=!1;a._mouseStart=a.onMouseStart.bind(a);a._mouseMove=a.onMouseMove.bind(a);a._mouseEnd=a.onMouseEnd.bind(a);return a}__extends(b,e);b.forVisualKeyboard=function(a){a={targetRoot:a.element,eventRoot:document.body,inputStartHandler:a.touch.bind(a),inputMoveHandler:a.moveOver.bind(a),inputMoveCancelHandler:a.moveCancel.bind(a),inputEndHandler:a.release.bind(a),coordConstrainedWithinInteractiveBounds:a.detectWithinInteractiveBounds.bind(a)};return new b(a)};
b.forPredictiveBanner=function(a,c){a={targetRoot:a.getDiv(),eventRoot:document.body,inputStartHandler:c.touchStart.bind(c),inputMoveHandler:c.touchMove.bind(c),inputEndHandler:c.touchEnd.bind(c),coordConstrainedWithinInteractiveBounds:function(){return!0}};return new b(a)};b.prototype.registerEventHandlers=function(){this.config.eventRoot.addEventListener("mousedown",this._mouseStart,!0);this.config.eventRoot.addEventListener("mousemove",this._mouseMove,!1);this.config.eventRoot.addEventListener("mouseup",
this._mouseEnd,!0)};b.prototype.unregisterEventHandlers=function(){this.config.eventRoot.removeEventListener("mousedown",this._mouseStart,!0);this.config.eventRoot.removeEventListener("mousemove",this._mouseMove,!1);this.config.eventRoot.removeEventListener("mouseup",this._mouseEnd,!0)};b.prototype.preventPropagation=function(a){a.preventDefault();a.cancelBubble=!0;a.returnValue=!1;"function"==typeof a.stopImmediatePropagation?a.stopImmediatePropagation():"function"==typeof a.stopPropagation&&a.stopPropagation()};
b.prototype.onMouseStart=function(a){this.config.targetRoot.contains(a.target)?(this.preventPropagation(a),this.onInputStart(g.InputEventCoordinate.fromEvent(a)),this.hasActiveClick=!0):this.ignoreSequence=!0};b.prototype.onMouseMove=function(a){if(!this.ignoreSequence){var b=g.InputEventCoordinate.fromEvent(a);if(!a.buttons)this.hasActiveClick&&(this.hasActiveClick=!1,this.onInputMoveCancel(b));else if(this.hasActiveClick)if(this.preventPropagation(a),this.config.coordConstrainedWithinInteractiveBounds(b))this.onInputMove(b);
else this.onInputMoveCancel(b)}};b.prototype.onMouseEnd=function(a){this.ignoreSequence?this.ignoreSequence=!1:(a.buttons||(this.hasActiveClick=!1),this.onInputEnd(g.InputEventCoordinate.fromEvent(a)))};return b}(g.InputEventEngine);g.MouseEventEngine=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function e(b,a,c,d){this._layerId="default";this.layerIndex=0;this._fixedWidthScaling=this.isStatic=!1;this._fixedHeightScaling=!0;this.repeatDelete=function(){this.deleting&&(this.modelKeyClick(this.deleteKey),this.deleting=window.setTimeout(this.repeatDelete,100))}.bind(this);this.device=a;this.hostDevice=c||a;d&&(this.isStatic=d);this._fixedWidthScaling=this.device.touchable&&!this.isStatic;this._fixedHeightScaling=this.device.touchable&&
!this.isStatic;c=document.createElement("div");b?(d=this.kbdLayout=b.layout(a.formFactor),this.isRTL=b.isRTL):(d=k.keyboards.Layouts.buildDefaultLayout(null,null,a.formFactor),d=this.kbdLayout=k.keyboards.ActiveLayout.polyfill(d,null,a.formFactor),this.isRTL=!1);this.fontFamily="font"in d?d.font:"";d=a.formFactor;b||(b=new k.keyboards.Keyboard(null));this.layerGroup=new h.OSKLayerGroup(this,b,d);b.markLayoutCalibrated(d);c.appendChild(this.layerGroup.element);this.kbdDiv=c;this.isStatic||(this.inputEngine=
this.hostDevice.touchable?h.TouchEventEngine.forVisualKeyboard(this):h.MouseEventEngine.forVisualKeyboard(this),this.inputEngine.registerEventHandlers());c.className=a.formFactor+" kmw-osk-inner-frame"}Object.defineProperty(e.prototype,"layerId",{get:function(){return this._layerId},set:function(b){this._layerId=b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"currentLayer",{get:function(){var b;return this.layerId?null===(b=this.layerGroup)||void 0===b?void 0:b.layers[this.layerId]:
null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"lgKey",{get:function(){var b,a;return null===(a=null===(b=this.currentLayer)||void 0===b?void 0:b.globeKey)||void 0===a?void 0:a.btn},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hkKey",{get:function(){var b,a;return null===(a=null===(b=this.currentLayer)||void 0===b?void 0:b.hideKey)||void 0===a?void 0:a.btn},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"spaceBar",{get:function(){var b,
a;return null===(a=null===(b=this.currentLayer)||void 0===b?void 0:b.spaceBarKey)||void 0===a?void 0:a.btn},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"element",{get:function(){return this.kbdDiv},enumerable:!0,configurable:!0});e.prototype.postInsert=function(){};Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"layoutWidth",{get:function(){if(this.usesFixedWidthScaling){var b=this.width,a=getComputedStyle(this.element);a.border&&(a=(new h.ParsedLengthStyle(a.borderWidth)).val,b-=2*a);return h.ParsedLengthStyle.inPixels(b)}return h.ParsedLengthStyle.forScalar(1)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layoutHeight",{get:function(){if(this.usesFixedHeightScaling){var b=this.height,a=getComputedStyle(this.element);a.border&&(a=(new h.ParsedLengthStyle(a.borderWidth)).val,
b-=2*a);return h.ParsedLengthStyle.inPixels(b)}return h.ParsedLengthStyle.forScalar(1)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"internalHeight",{get:function(){return this.usesFixedHeightScaling?h.ParsedLengthStyle.inPixels(this.layoutHeight.val-this.getVerticalLayerGroupPadding()):h.ParsedLengthStyle.forScalar(1)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fontSize",{get:function(){this._fontSize||(this._fontSize=new h.ParsedLengthStyle("1em"));
return this._fontSize},set:function(b){this._fontSize=b;this.kbdDiv.style.fontSize=b.styleString},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"usesFixedWidthScaling",{get:function(){return this._fixedWidthScaling},set:function(b){this._fixedWidthScaling=b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"usesFixedHeightScaling",{get:function(){return this._fixedHeightScaling},set:function(b){this._fixedHeightScaling=b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"usesFixedPositioning",{get:function(){for(var b=this.element;b;){if("fixed"==getComputedStyle(b).position)return!0;b=b.offsetParent}return!1},enumerable:!0,configurable:!0});e.prototype.setSize=function(b,a,c){this._width=b;this._height=a;this.kbdDiv&&(this.kbdDiv.style.width=b?this._width+"px":"",this.kbdDiv.style.height=a?this._height+"px":"",!this.device.touchable&&a&&(this.fontSize=new h.ParsedLengthStyle(this._height/8+"px")),c||this.refreshLayout())};e.prototype.getDefaultKeyObject=function(){return new h.OSKKeySpec(void 0,
"",k.keyboards.ActiveKey.DEFAULT_KEY.width,k.keyboards.ActiveKey.DEFAULT_KEY.sp,null,k.keyboards.ActiveKey.DEFAULT_KEY.pad)};e.prototype.getTouchCoordinatesOnKeyboard=function(b){var a=g.keyman.singleton.util.getAbsolute(this.kbdDiv);b={x:b.x-a.x,y:b.y-a.y};b.x/=this.layerGroup.element.offsetWidth;b.y/=this.kbdDiv.offsetHeight;return b};e.prototype.getTouchProbabilities=function(b,a){if(!g.keyman.singleton.core.languageProcessor.mayCorrect)return null;b=this.getTouchCoordinatesOnKeyboard(b);var c=
this.layerGroup.element,d=this.kbdDiv.offsetHeight;if(!c.offsetWidth||!d)return null;c=c.offsetWidth/this.kbdDiv.offsetHeight;b=this.kbdLayout.getLayer(this.layerId).getTouchProbabilities(b,c);if(a&&this.subkeyGesture&&this.subkeyGesture.baseKey.key){c=1;d=this.subkeyGesture.baseKey.key.spec.coreID;var f=3;a=a.coreID;a==d?(c+=f,f=0):a=d+"::"+a;for(var e=1/(1+c+f),h=0;h<b.length;h++){var k=b[h];k.keyId==d?(c+=k.p*e,b.splice(h,1),h--):k.keyId==a?(f=+k.p*e,b.splice(h,1),h--):k.p*=e}h=[];0<f&&h.push({keyId:a,
p:f*e});h.push({keyId:d,p:c*e});return h=h.concat(b)}return b};e.prototype.getInteractiveBoundingRect=function(){var b=k.dom.Utils.getAbsoluteX(this.element),a=k.dom.Utils.getAbsoluteY(this.element),c=.333*this.height/this.currentLayer.rows.length;return{left:b-c,right:b+this.width+c,top:a-c,bottom:a+this.height+c}};e.prototype.applyScreenMarginBoundsThresholding=function(b,a){var c=window.screenLeft-window.pageXOffset,d=window.screenTop-window.pageYOffset,f=__assign({},b);a=new h.InputEventCoordinate(a.x+
c,a.y+d);5<=a.x&&2>=b.left+c&&(f.left=2-c);a.x<=screen.width-5&&b.right+c>=screen.width-2&&(f.right=screen.width-2-c);5<=a.y&&2>=b.top+d&&(f.top=2-d);a.y<=screen.height-5&&b.bottom+d>=screen.height-2&&(f.bottom=screen.height-2-d);return f};e.prototype.detectWithinInteractiveBounds=function(b){if(null===b.x&&null===b.y)return!0;var a=this.getInteractiveBoundingRect();this.initTouchCoord&&this.applyScreenMarginBoundsThresholding(a,this.initTouchCoord);return b.x<a.left||b.x>a.right?!1:b.y<a.top||b.y>
a.bottom?!1:!0};e.prototype.touch=function(b){var a=b.target,c=this.keyTarget(a);this.initTouchCoord=b;this.currentTarget=c;this.cancelDelete();if(!this.subkeyGesture||!this.subkeyGesture.isVisible()){this.touchCount=b.activeInputCount;if(c&&(0<=c.className.indexOf("key-hidden")||0<=c.className.indexOf("key-blank"))||0<=a.className.indexOf("kmw-key-row"))b.isFromMouse||(c=this.findNearestKey(b,a));null!=c&&(a=c.keyId,this.highlightKey(c,!0),"K_LOPT"==a||"K_ROPT"==a?(window.setTimeout(function(){this.modelKeyClick(c);
this.highlightKey(c,!0)}.bind(this),0),this.touchPending=this.keyPending=null):"K_BKSP"==a?(this.modelKeyClick(c,b),this.deleteKey=c,this.deleting=window.setTimeout(this.repeatDelete,500),this.touchPending=this.keyPending=null):(this.keyPending?(this.highlightKey(this.keyPending,!1),this.subkeyGesture&&this.subkeyGesture instanceof h.browser.SubkeyPopup?(a=this.subkeyGesture,a.updateTouch(b),a.finalize(b)):this.modelKeyClick(this.keyPending,this.touchPending),this.touchCount--):this.initGestures(c,
b),this.keyPending=c,this.touchPending=b))}};e.prototype.release=function(b){var a=this.currentTarget;this.cancelDelete();this.pendingMultiTap&&this.pendingMultiTap.realized?(this.pendingMultiTap=null,this.highlightKey(this.keyPending,!1),this.touchPending=this.keyPending=null):(this.pendingMultiTap&&this.pendingMultiTap.cancelled&&(this.pendingMultiTap=null),this.subkeyGesture&&this.subkeyGesture.isVisible()?0<b.activeInputCount||(this.subkeyGesture instanceof h.browser.SubkeyPopup&&this.subkeyGesture.finalize(b),
this.highlightKey(this.keyPending,!1),this.touchPending=this.keyPending=null):(a&&a.id&&this.optionKey(a,a.id,!1),this.detectWithinInteractiveBounds(b)?(a=this.touchCount,0<this.touchCount&&this.touchCount--,this.keyPending?(this.highlightKey(this.keyPending,!1),0>this.keyPending.className.indexOf("hidden")&&0<a&&this.modelKeyClick(this.keyPending,b),this.clearPopup(),this.touchPending=this.keyPending=null):(a=this.keyTarget(b.target),a||(a=document.elementFromPoint(b.x-window.pageXOffset,b.y-window.pageYOffset),
a=this.findNearestKey(b,a)),this.highlightKey(a,!1))):(this.moveCancel(b),this.touchCount--)))};e.prototype.moveCancel=function(b){1<b.activeInputCount||this.updateGestures(null,this.keyPending,b)||(this.cancelDelete(),this.highlightKey(this.keyPending,!1),this.showKeyTip(null,!1),this.clearPopup(),this.touchPending=this.keyPending=null)};e.prototype.moveOver=function(b){if(0==this.touchCount)this.cancelDelete();else{var a=b.x-window.pageXOffset,c=b.y-window.pageYOffset;this.touchPending=b;a=document.elementFromPoint(a,
c);c=this.keyPending;var d=this.keyTarget(a);if(d&&0<=d.className.indexOf("key-hidden")||a&&!d&&0<=a.className.indexOf("key-row"))d=this.findNearestKey(b,a);d&&"string"==typeof d.id&&0>d.id.indexOf("-K_BKSP")&&this.cancelDelete();1<b.activeInputCount||this.updateGestures(d,c,b)||((this.currentTarget=d)&&this.keyPending&&(this.highlightKey(c,!1),this.keyPending=d,this.touchPending=b),c&&d&&d!=c&&""!=d.id&&(this.clearPopup(),this.initGestures(d,b)),this.keyPending&&(c!=d||0>d.className.indexOf(h.OSKKey.HIGHLIGHT_CLASS))&&
this.highlightKey(d,!0))}};e.prototype.keyTarget=function(b){try{if(b){if(b.classList.contains("kmw-key"))return h.getKeyFrom(b);if(b.parentNode&&b.parentNode.classList.contains("kmw-key"))return h.getKeyFrom(b.parentNode);if(b.firstChild&&b.firstChild.classList.contains("kmw-key"))return h.getKeyFrom(b.firstChild)}}catch(a){}return null};e.prototype.findNearestKey=function(b,a){if(!b)return null;for(b=b.x;a&&void 0!==a.className&&0>a.className.indexOf("key-row");)a=a.parentNode;if(!a)return null;
var c,d=0,f=24,e=1E5;for(c=0;c<a.childNodes.length;c++){var g=a.childNodes[c];var h=g.firstChild?g.firstChild:g;if(void 0===h.className||!(0<=h.className.indexOf("key-hidden")||0<=h.className.indexOf("key-blank"))){var k=g.offsetLeft;g=k+g.offsetWidth;if(b>=k&&b<=g)return h;k-=b;0<=k&&k<e&&(d=c,e=k);k=b-g;0<=k&&k<e&&(d=c,e=k)}}return 1E5>e&&(a=a.childNodes[d],k=a.offsetLeft,g=k+a.offsetWidth,40<a.offsetWidth&&(f=.6*a.offsetWidth),0<=k-b&&k-b<f||0<=b-g&&b-g<f)?a.firstChild:null};e.prototype.cancelDelete=
function(){this.deleting&&window.clearTimeout(this.deleting);this.deleting=0};e.prototype.modelKeyClick=function(b,a){b=this.initKeyEvent(b,a);h.PreProcessor.raiseKeyEvent(b)};e.prototype.initKeyEvent=function(b,a){this.highlightKey(b,!1);var c=b.key?b.key.spec:null;return c?this.keyEventFromSpec(c,a):(console.error("OSK key with ID '"+b.id+"', keyID '"+b.keyId+"' missing needed specification"),null)};e.prototype.keyEventFromSpec=function(b,a){var c=g.keyman.singleton.core,d=b.constructKeyEvent(c.keyboardProcessor,
this.device);c.languageProcessor.isActive&&a&&(d.source=a,d.keyDistribution=this.getTouchProbabilities(a,b));return d};e.prototype._UpdateVKShiftStyle=function(b){var a,c=g.keyman.singleton.core;b||(b=this.layerId);if((b=this.layerGroup.layers[b])&&null!==(a=c.activeKeyboard)&&void 0!==a&&a.usesDesktopLayoutOnDevice(this.device)){a=["K_CAPS","K_NUMLOCK","K_SCROLL"];var d=[b.capsKey,b.numKey,b.scrollKey];for(b=0;b<d.length;b++)null!=d[b]&&d[b].setToggleState(c.keyboardProcessor.stateKeys[a[b]])}};
e.prototype.clearPopup=function(){this.subkeyGesture&&(this.subkeyGesture.clear(),this.subkeyGesture=null);this.pendingSubkey&&(this.pendingSubkey.cancel(),this.pendingSubkey=null)};e.prototype.showLanguage=function(){var b=g.keyman.singleton,a=b.keyboardManager.activeStub;if(a)if(null!=a.displayName)b=a.displayName;else{var c=a.KL;a=a.KN;a=a.replace(/\s*keyboard\s*/i,"");switch(b.options.spacebarText){case k.SpacebarText.KEYBOARD:b=a;break;case k.SpacebarText.LANGUAGE:b=c;break;case k.SpacebarText.LANGUAGE_KEYBOARD:b=
a==c?c:c+" - "+a;break;case k.SpacebarText.BLANK:b="";break;default:b=a}}else b="(System keyboard)";try{var d=this.spaceBar.key.label,f=d.parentNode;"undefined"==typeof f.className||""==f.className?f.className="kmw-spacebar":-1==f.className.indexOf("kmw-spacebar")&&(f.className+=" kmw-spacebar");"kmw-spacebar-caption"!=d.className&&(d.className="kmw-spacebar-caption");if(d.innerText!=b||""==b)d.innerText=b}catch(l){}};e.prototype.highlightKey=function(b,a){!b||!b.key||""==b.className||0<=b.className.indexOf("kmw-key-row")||
(null!=this.keytip&&b.key.allowsKeyTip()?this.showKeyTip(b,a):(this.showKeyTip(null,!1),b.key.highlight(a)))};e.prototype.getKeyEmFontSize=function(){if(!this.fontSize)return 0;if("desktop"==this.device.formFactor)return this.fontSize.scaledBy(.8).val;var b=getComputedStyle(document.body).fontSize;b=h.getFontSizeStyle(b).val;var a=1;if(!this.isStatic){if(this.fontSize.absolute)return this.fontSize.val;a=this.fontSize.val}return b*a};e.prototype.updateState=function(){if(this.currentLayer){var b,a=
this.kbdDiv.childNodes[0].childNodes;this.nextLayer=this.layerId;this.currentLayer.nextlayer&&(this.nextLayer=this.currentLayer.nextlayer);for(b=0;b<a.length;b++){var c=a[b];c.layer==this.layerId?(c.style.display="block",this._UpdateVKShiftStyle()):c.style.display="none"}}};e.prototype.refreshLayout=function(){var b=g.keyman.singleton,a=1;this.device.OS!=k.utils.OperatingSystem.iOS||b.isEmbedded||(a/=b.util.getViewportScale());this.height&&this.computedAdjustedOskHeight(this.height);b=this.kbdDiv.style;
var c=this.layerGroup.element.style;this.usesFixedHeightScaling&&this.height&&(b.height=b.maxHeight=this.height+"px");b.fontSize=this.fontSize.styleString;c.fontSize=h.ParsedLengthStyle.forScalar(a).styleString;b=this.width&&this.height;a=getComputedStyle(this.kbdDiv);c=""!=a.height&&"auto"!=a.height;if(b)this._computedWidth=this.width,this._computedHeight=this.height;else if(c)this._computedWidth=parseInt(a.width,10),this._computedWidth||(b=getComputedStyle(this.kbdDiv.firstElementChild),this._computedWidth=
parseInt(b.width,10)),this._computedHeight=parseInt(a.height,10);else return;this.currentLayer&&this.currentLayer.refreshLayout(this,this._computedHeight-this.getVerticalLayerGroupPadding())};e.prototype.getVerticalLayerGroupPadding=function(){var b=getComputedStyle(this.layerGroup.element);return parseInt(b.paddingTop,10)+parseInt(b.paddingBottom,10)};e.prototype.computedAdjustedOskHeight=function(b){if(!this.layerGroup)return b;var a=this.layerGroup.layers,c=0,d;for(d in a){var f=a[d].rows.length;
f*=Math.floor(b/(0==f?1:f));f>c&&(c=f)}return c+0};e.prototype.appendStyleSheet=function(){var b=g.keyman.singleton,a=b.util,c=b.core.activeKeyboard,d=b.keyboardManager.activeStub;if(null!=d){this.styleSheet&&a.removeStyleSheet(this.styleSheet);var f=d.KFont;d=d.KOskFont;a.addFontFaceStyleSheet(f);a.addFontFaceStyleSheet(d);b.hideInputs();var e=this.addFontStyle(f,d);null!=c&&"string"==typeof c.oskStyling&&(e+=c.oskStyling);this.styleSheet=a.addStyleSheet(e);this.waitForFonts(f,d)&&b.alignInputs()}};
e.prototype.addFontStyle=function(b,a){var c=g.keyman.singleton,d=c.baseFont;"undefined"!=typeof b&&"undefined"!=typeof b.family&&(d=b.family);d=d.replace(/\u0022/g,"");var f=new RegExp("\\s?"+d+",?"),e=c.appliedFont.replace(/\u0022/g,"");e=e.replace(f,"");e=e.replace(/,$/,"");e='"'+(""==e?d:d+","+e).replace(/,\s?/g,'","')+'"';d=".keymanweb-font{\nfont-family:"+e+" !important;\n}\n";"undefined"!=typeof a?d=d+'.kmw-key-text{\nfont-family:"'+a.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n':
"undefined"!=typeof b&&(d=d+'.kmw-key-text{\nfont-family:"'+b.family.replace(/\u0022/g,"").replace(/,/g,'","')+'";\n}\n');c.appliedFont=e;return d};e.buildDocumentationKeyboard=function(b,a,c,d){if(!b)return null;a="undefined"==typeof a?"desktop":a;c="undefined"==typeof c?"default":c;var f=new k.Device;f.formFactor=a;"desktop"!=a?(f.OS="iOS",f.touchable=!0):(f.OS="windows",f.touchable=!1);var g=b.layout(a),n=new e(b,f.coreSpec,f.coreSpec,!0);n.layerGroup.element.className=n.kbdDiv.className+" "+f.formFactor+
"-static "+f.OS.toLowerCase();var w=n.kbdDiv.childNodes[0];null!=g?(n.layerId=c,n.updateState(),n.setSize(800,d),n.refreshLayout(),w.style.fontSize=n.kbdDiv.style.fontSize,w.style.height=n.kbdDiv.style.height,w.style.maxHeight=n.kbdDiv.style.maxHeight):w.innerHTML="<p style='color:#c40; font-size:0.5em;margin:10px;'>No "+a+" layout is defined for "+b.name+".</p>";w.style.border="1px solid #ccc";var D=window.setInterval(function(){getComputedStyle(w).fontSize&&(w.style.fontSize&&(n.fontSize=new h.ParsedLengthStyle(w.style.fontSize)),
n.refreshLayout(),window.clearInterval(D))},10);return w};e.prototype.onHide=function(){this.hkKey&&this.highlightKey(this.hkKey,!1)};e.prototype.startLongpress=function(b){var a=this;b=new h.browser.PendingLongpress(this,b);b.promise.then(function(b){if(b){var c=g.keyman.singleton;c.osk._Box.appendChild(b.element);c.osk._Box.appendChild(b.shim);b.reposition(a)}});return b};e.prototype.initGestures=function(b,a){var c=this;if(this.pendingMultiTap)switch(this.pendingMultiTap.incrementTouch(b)){case h.PendingMultiTapState.Cancelled:this.pendingMultiTap=
null;break;case h.PendingMultiTapState.Realized:return}!this.pendingMultiTap&&h.PendingMultiTap.isValidTarget(this,b)&&(this.pendingMultiTap=new h.PendingMultiTap(this,b,2),this.pendingMultiTap.timeout.then(function(){c.pendingMultiTap=null}));if(b.subKeys){var d=this,f=this.startLongpress(b);null!=f&&(this.pendingSubkey=f,f.promise.then(function(a){d.pendingSubkey==f&&(d.pendingSubkey=null);a&&(d.showKeyTip(null,!1),d.subkeyGesture=a,a.promise.then(function(a){a&&h.PreProcessor.raiseKeyEvent(a);
d.clearPopup()}))}))}};e.prototype.updateGestures=function(b,a,c){!b&&this.pendingMultiTap&&(this.pendingMultiTap.cancel(),this.pendingMultiTap=null);if(this.subkeyGesture)return a&&a.key.highlight(!1),this.subkeyGesture.updateTouch(c),this.touchPending=this.keyPending=null,!0;this.currentTarget=null;b&&null!=b.subKeys&&this.initTouchCoord&&this.pendingSubkey&&this.pendingSubkey instanceof h.browser.PendingLongpress&&this.initTouchCoord.y-c.y>this.getLongpressFlickThreshold()&&this.pendingSubkey.resolve();
return this.subkeyGesture||this.pendingSubkey?!0:!1};e.prototype.getLongpressFlickThreshold=function(){return Math.max(this.currentLayer.rowHeight/4,5)};e.prototype.optionKey=function(b,a,c){b=g.keyman.singleton;var d=b.osk;c&&(0<=a.indexOf("K_LOPT")?d.showLanguageMenu():0<=a.indexOf("K_ROPT")&&(b.uiManager.setActivatingUI(!1),d.startHide(!0),a=b.domManager.activeElement,k.dom.Utils.instanceof(a,"TouchAliasElement")&&a.hideCaret(),b.domManager.lastActiveElement=null))};e.prototype.showKeyTip=function(b,
a){var c=this.keytip;if(null!=c){var d=this.subkeyGesture;d=d&&d.isVisible();c.show(b,d?!1:a,this)}};e.prototype.createKeyTip=function(){var b=g.keyman.singleton;"phone"==this.device.formFactor&&(null==this.keytip&&(this.keytip=new h.browser.KeyTip(b.isEmbedded)),this.keytip&&this.keytip.element&&b.osk._Box.appendChild(this.keytip.element))};e.prototype.waitForFonts=function(b,a){var c=g.keyman.singleton,d=c.util;b=b&&b.files?b:void 0;a=a&&a.files?a:void 0;var f=d.checkFontDescriptor(b),e=d.checkFontDescriptor(a);
if(f&&e)return!0;c.fontCheckTimer=window.setInterval(function(){d.checkFontDescriptor(b)&&d.checkFontDescriptor(a)&&(window.clearInterval(c.fontCheckTimer),c.fontCheckTimer=null,c.alignInputs())},100);window.setTimeout(function(){c.fontCheckTimer&&(window.clearInterval(c.fontCheckTimer),c.fontCheckTimer=null,c.alignInputs())},5E3);return!1};e.prototype.shutdown=function(){var b,a,c,d,f=g.keyman.singleton;this.styleSheet&&f.util.removeStyleSheet(this.styleSheet);this.inputEngine&&this.inputEngine.unregisterEventHandlers();
this.deleting&&(window.clearTimeout(this.deleting),this.deleting=0);this.touchPending=this.keyPending=null;null===(b=this.keytip)||void 0===b?void 0:b.show(null,!1,this);null===(a=this.subkeyGesture)||void 0===a?void 0:a.clear();null===(c=this.pendingMultiTap)||void 0===c?void 0:c.cancel();null===(d=this.pendingSubkey)||void 0===d?void 0:d.cancel()};e.specialCharacters=h.OSKKey.specialCharacters;return e}();h.VisualKeyboard=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function b(a){this.totalLength=0;this.x=a.x;this.totalLength=0}b.prototype.updateTo=function(a){var b=this.x;this.x=a.x;a={deltaX:this.x-b};this.totalLength+=Math.abs(a.deltaX);return a};Object.defineProperty(b.prototype,"hasScrolled",{get:function(){return this.totalLength>b.HAS_SCROLLED_FUDGE_FACTOR},enumerable:!0,configurable:!0});b.HAS_SCROLLED_FUDGE_FACTOR=10;return b}(),e=function(){function b(a,b,d){this.baseElement=a;this.rowClassMatch=
b;this.selectedTargetMatch=d}b.prototype.findTargetFromTouch=function(a,b,d){for(a=a.x;b&&void 0!==b.className&&0>b.className.indexOf(this.rowClassMatch);)b=b.parentNode;if(!b)return null;var c=0,e=24,g=1E5;for(d=0;d<b.childNodes.length;d++){var h=b.childNodes[d];if(!this.isInvalidTarget(this.findTargetFrom(h))){var k=h.offsetLeft;var n=k+h.offsetWidth;k-=a;0<=k&&k<g&&(c=d,g=k);n=a-n;0<=n&&n<g&&(c=d,g=n);if(0>n&&0>k)return this.findTargetFrom(h)}}return 1E5>g&&(b=b.childNodes[c],k=b.offsetLeft,n=
k+b.offsetWidth,40<b.offsetWidth&&(e=.6*b.offsetWidth),0<=k-a&&k-a<e||0<=a-n&&a-n<e)?this.findTargetFrom(b):null};b.prototype.findBestTarget=function(a,b){var c=b?document.elementFromPoint(a.x+document.body.scrollLeft,a.y+document.body.scrollTop):a.target;var f=this.findTargetFrom(c);f||(f=this.findTargetFromTouch(a,c,b));return f};b.prototype.isInvalidTarget=function(a){return!1};b.prototype.touchStart=function(a){this.currentTarget=this.findBestTarget(a);this.touchX=a.x;this.touchY=a.y;this.touchCount=
a.activeInputCount;this.currentTarget&&(this.scrollTouchState=this.currentTarget.clientWidth<this.currentTarget.scrollWidth?new n(a):null,this.highlight(this.currentTarget,!0),this.pendingTarget?(this.highlight(this.pendingTarget,!1),this.select(this.pendingTarget),this.clearHolds(),this.touchCount--):this.hold(this.currentTarget),this.pendingTarget=this.currentTarget)};b.prototype.touchEnd=function(a){var b=this.currentTarget;if(this.isSubmenuActive()||this.hasModalPopup()){if(0<a.activeInputCount)return;
if(null==b||0>b.id.indexOf("popup"))this.highlight(this.pendingTarget,!1),this.clearHolds(),this.pendingTarget=null}b=a.x;b=2>b&&5<this.touchX||b>window.innerWidth-2&&this.touchX<window.innerWidth-5;this.scrollTouchState&&(b=b||this.scrollTouchState.hasScrolled);var d=this.touchCount;0<this.touchCount&&this.touchCount--;this.pendingTarget?(this.highlight(this.pendingTarget,!1),0>this.pendingTarget.className.indexOf("hidden")&&0<d&&!b&&this.select(this.pendingTarget),this.clearHolds(),this.pendingTarget=
null):(b=this.findBestTarget(a))&&this.highlight(b,!1)};b.prototype.touchMove=function(a){var b=g.keyman.singleton;if(!(1<a.activeInputCount||0==this.touchCount))if(this.currentTarget&&null!=this.scrollTouchState)a=this.scrollTouchState.updateTo(a).deltaX,this.currentTarget.scrollLeft-=window.devicePixelRatio*a;else{var d=a.y,f=this.pendingTarget,e=this.findBestTarget(a,!0);if(this.hasModalPopup())f&&this.highlight(f,!1),this.pendingTarget=null;else{this.currentTarget=e=this.dealiasSubTarget(e);f&&
e&&e!==f&&this.highlight(f,!1);if(e&&this.hasSubmenu(e)){!b.isEmbedded&&5<this.touchY-d&&!this.isSubmenuActive()&&this.displaySubmenuFor(e);if(e&&0>e.id.indexOf("popup"))return;e&&0>e.className.indexOf(this.selectedTargetMatch)&&this.highlight(e,!0)}else{d=this.baseElement;b=k.dom.Utils.getAbsoluteY(d);d=d.offsetHeight;var h=Math.max(5,b-.25*d);f&&(a.y<h||a.y>b+d+.25*d)&&(this.highlight(f,!1),this.clearHolds(),this.pendingTarget=null)}e&&this.pendingTarget&&(this.pendingTarget=e);this.pendingTarget&&
e&&(f!=e||0>e.className.indexOf(this.selectedTargetMatch))&&this.highlight(e,!0);f&&e&&e!=f&&""!=e.id&&this.hold(e)}}};return b}();h.UITouchHandlerBase=e})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(){function a(b){var c=g.keyman.singleton.util._CreateElement("div");c.id=a.BANNER_ID;c.className=a.BANNER_CLASS;this.div=c;this.height=b;this.update()}Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(a){this._height=0<a?a:0;this.update()},enumerable:!0,configurable:!0});a.prototype.update=function(){var a=this.div.style,b=a.height,c=a.display;0<this._height?(a.height=this._height+"px",a.display="block"):
(a.height="0px",a.display="none");return b!==a.height||c!==a.display};a.prototype.appendStyleSheet=function(){};a.prototype.getDiv=function(){return this.div};a.prototype.activate=function(){};a.prototype.deactivate=function(){};a.DEFAULT_HEIGHT=37;a.BANNER_CLASS="kmw-banner-bar";a.BANNER_ID="kmw-banner-bar";return a}();h.Banner=n;var e=function(a){function b(){return a.call(this,0)||this}__extends(b,a);return b}(n);h.BlankBanner=e;e=function(a){function b(b,c){if(0<b.length){var d=a.call(this)||
this;c&&(d.height=c)}else d=a.call(this,0)||this;0<=b.indexOf("base64")?console.log("Loading img from base64 data"):console.log("Loading img with src '"+b+"'");d.img=document.createElement("img");d.img.setAttribute("src",b);b=d.img.style;b.width="100%";b.height="100%";d.getDiv().appendChild(d.img);console.log("Image loaded.");return d}__extends(b,a);b.prototype.setImagePath=function(a){this.img&&this.img.setAttribute("src",a)};return b}(n);h.ImageBanner=e;var b=function(){function b(a){var b=g.keyman.singleton;
this.index=a;this.constructRoot();a=this.display=b.util._CreateElement("span");this.div.appendChild(a)}b.prototype.constructRoot=function(){var c=g.keyman.singleton,d=this.div=c.util._CreateElement("div"),e=d.style;d.className="kmw-suggest-option";d.id=b.BASE_ID+this.index;if(c=c.keyboardManager.activeStub)c.KLC&&(d.lang=c.KLC),(d=c.KFont)&&d.family&&""!=d.family&&(e.fontFamily=this.fontFamily=d.family);e.width=(100-a.MARGIN*(a.SUGGESTION_LIMIT-1))/a.SUGGESTION_LIMIT+"%";this.div.suggestion=this};
Object.defineProperty(b.prototype,"suggestion",{get:function(){return this._suggestion},enumerable:!0,configurable:!0});b.prototype.update=function(a){this._suggestion=a;this.updateText()};b.prototype.updateText=function(){var a=this.generateSuggestionText();this.div.replaceChild(a,this.display);this.display=a};b.prototype.apply=function(a){var b=g.keyman.singleton;if(this.isEmpty())return null;a||(a=k.dom.Utils.getOutputTarget());return"revert"==this._suggestion.tag?(b.core.languageProcessor.applyReversion(this._suggestion,
a),null):b.core.languageProcessor.applySuggestion(this.suggestion,a,function(){return b.core.keyboardProcessor.layerId})};b.prototype.isEmpty=function(){return!this._suggestion};b.prototype.generateSuggestionText=function(){var a=g.keyman.singleton,b=this._suggestion,c=a.util._CreateElement("span");c.className="kmw-suggestion-text";if(null==b)return c;null==b.displayAs||""==b.displayAs?b="\u00a0":(a=a.core.activeKeyboard,b=String.fromCharCode(a&&a.isRTL?8238:8237)+b.displayAs);c.innerHTML=b;return c};
b.BASE_ID="kmw-suggestion-";return b}();h.BannerSuggestion=b;var a=function(a){function d(e,f){f=a.call(this,f||n.DEFAULT_HEIGHT)||this;f.suggestionApplied=function(a){var b,c=g.keyman.singleton;c.core.keyboardProcessor.newLayerStore.set("");c.core.keyboardProcessor.oldLayerStore.set("");null===(b=c.core.keyboardProcessor.processPostKeystroke(this.hostDevice,a))||void 0===b?void 0:b.finalize(c.core.keyboardProcessor,a,!0);return!0}.bind(f);f.hostDevice=e;f.getDiv().className=f.getDiv().className+
" "+d.BANNER_CLASS;f.options=[];for(e=0;e<d.SUGGESTION_LIMIT;e++){var h=new b(e);f.options[e]=h}h=(e=g.keyman.singleton.core.activeKeyboard)&&e.isRTL;for(e=0;e<d.SUGGESTION_LIMIT;e++){var l=h?d.SUGGESTION_LIMIT-e-1:e;f.getDiv().appendChild(f.options[l].div);if(e!=d.SUGGESTION_LIMIT){l=g.keyman.singleton.util._CreateElement("div");l.className="kmw-banner-separator";var k=l.style;k.marginLeft=d.MARGIN/2+"%";k.marginRight=d.MARGIN/2+"%";f.getDiv().appendChild(l)}}f.manager=new c(f.getDiv(),f.options);
f.setupInputHandling();return f}__extends(d,a);d.prototype.setupInputHandling=function(){(this.hostDevice.touchable?h.TouchEventEngine.forPredictiveBanner(this,this.manager):h.MouseEventEngine.forPredictiveBanner(this,this.manager)).registerEventHandlers()};d.prototype.activate=function(){var a=g.keyman.singleton,b=this.manager;a.core.languageProcessor.addListener("invalidatesuggestions",b.invalidateSuggestions);a.core.languageProcessor.addListener("suggestionsready",b.updateSuggestions);a.core.languageProcessor.addListener("tryaccept",
b.tryAccept);a.core.languageProcessor.addListener("tryrevert",b.tryRevert);a.core.languageProcessor.addListener("suggestionapplied",this.suggestionApplied)};d.prototype.postConfigure=function(){var a=g.keyman.singleton;a.core.languageProcessor.predictFromTarget(k.dom.Utils.getOutputTarget(),a.core.keyboardProcessor.layerId)};d.prototype.deactivate=function(){var a=g.keyman.singleton,b=this.manager;a.core.languageProcessor.removeListener("invalidatesuggestions",b.invalidateSuggestions);a.core.languageProcessor.removeListener("suggestionsready",
b.updateSuggestions);a.core.languageProcessor.removeListener("tryaccept",b.tryAccept);a.core.languageProcessor.removeListener("tryrevert",b.tryRevert);a.core.languageProcessor.removeListener("suggestionapplied",this.suggestionApplied)};d.SUGGESTION_LIMIT=3;d.MARGIN=1;d.TOUCHED_CLASS="kmw-suggest-touched";d.BANNER_CLASS="kmw-suggest-banner";return d}(n);h.SuggestionBanner=a;var c=function(c){function d(b,d){b=c.call(this,b,n.BANNER_CLASS,a.TOUCHED_CLASS)||this;b.initNewContext=!0;b.currentSuggestions=
[];b.recentAccept=!1;b.swallowPrediction=!1;b.doRevert=!1;b.recentRevert=!1;b.tryAccept=function(a,b){var c=g.keyman.singleton;!this.recentAccept&&this.selected?(this.doAccept(this.selected),b.shouldSwallow=!0):this.recentAccept&&"space"==a?(this.recentAccept=!1,b.shouldSwallow=!!c.core.languageProcessor.wordbreaksAfterSuggestions):b.shouldSwallow=!1}.bind(b);b.tryRevert=function(a){this.doRevert?this.recentAccept=this.doRevert=!1:this.recentAccept&&(this.showRevert(),this.swallowPrediction=!0);a.shouldSwallow=
!1}.bind(b);b.invalidateSuggestions=function(a){this.initNewContext=!1;this.swallowPrediction&&"context"!=a||(this.recentRevert=this.doRevert=this.recentAccept=!1,"context"==a&&(this.swallowPrediction=!1,this.initNewContext=!0));this.options.forEach(function(a){a.update(null)})}.bind(b);b.updateSuggestions=function(a){this.currentSuggestions=a=a.suggestions;this.keepSuggestion=null;for(var b=0;b<a.length;b++){var c=a[b];"keep"==c.tag&&(this.keepSuggestion=c)}this.keepSuggestion&&this.currentSuggestions.splice(this.currentSuggestions.indexOf(this.keepSuggestion),
1);this.swallowPrediction?this.swallowPrediction=!1:this.recentRevert=this.doRevert=this.recentAccept=!1;this.doUpdate()}.bind(b);b.options=d;return b}__extends(d,c);d.prototype.findTargetFrom=function(a){var b=g.keyman.singleton.util;try{if(a){if(b.hasClass(a,"kmw-suggest-option"))return a;if(a.parentNode&&b.hasClass(a.parentNode,"kmw-suggest-option"))return a.parentNode}}catch(w){}return null};d.prototype.highlight=function(c,d){var e=c.className,f=" "+a.TOUCHED_CLASS;-1==c.id.indexOf(b.BASE_ID)?
console.warn("Cannot find BannerSuggestion object for element to highlight!"):(this.selected=c.suggestion).isEmpty()&&(d=!1,this.selected=null);d&&0>e.indexOf(f)?c.className=e+f:c.className=e.replace(f,"")};d.prototype.select=function(a){this.doAccept(a.suggestion)};d.prototype.hold=function(a){a=a.suggestion;var b=-1==this.currentSuggestions.indexOf(a.suggestion);this.platformHold&&this.platformHold(a,b)};d.prototype.clearHolds=function(){};d.prototype.hasModalPopup=function(){var a=g.keyman.singleton;
return a.osk.vkbd.subkeyGesture&&a.isEmbedded};d.prototype.dealiasSubTarget=function(a){return a};d.prototype.hasSubmenu=function(a){return!1};d.prototype.isSubmenuActive=function(){return!1};d.prototype.displaySubmenuFor=function(a){throw Error("Method not implemented.");};d.prototype.doAccept=function(a){var b=this;this.selected=null;this.doRevert=!1;(this.revertAcceptancePromise=a.apply())?(this.revertAcceptancePromise.then(function(a){a&&(b.revertSuggestion=a)}),this.recentAccept=!0,this.recentRevert=
!1,this.swallowPrediction=!0,this.doUpdate()):a.suggestion&&"revert"==a.suggestion.tag&&(this.recentAccept=!1,this.recentRevert=!0,this.doUpdate())};d.prototype.showRevert=function(){this.doRevert=!0;this.doUpdate()};d.prototype.activateKeep=function(){return!this.recentAccept&&!this.recentRevert&&!this.initNewContext};d.prototype.doUpdate=function(){var a=[];this.activateKeep()&&this.keepSuggestion&&this.keepSuggestion.matchesModel?a.push(this.keepSuggestion):this.doRevert&&a.push(this.revertSuggestion);
a=a.concat(this.currentSuggestions);this.options.forEach(function(b,c){c<a.length?b.update(a[c]):b.update(null)})};return d}(h.UITouchHandlerBase);h.SuggestionManager=c})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var k=function(){function e(b){this._options={};this.imagePath="";this.constructContainer();this.hostDevice=b;this.setOptions(e.DEFAULT_OPTIONS)}e.prototype.constructContainer=function(){var b=g.keyman.singleton.util._CreateElement("div");b.id="keymanweb_banner_container";b.className="kmw-banner-container";return this.bannerContainer=b};Object.defineProperty(e.prototype,"element",{get:function(){return this.bannerContainer},enumerable:!0,configurable:!0});e.prototype.getOptions=
function(){var b={},a;for(a in this._options)b[a]=this._options[a];return b};e.prototype.setOptions=function(b){var a=g.keyman.singleton,c;for(c in b){switch(c){case "alwaysShow":this.alwaysShow=b[c];break;case "mayPredict":a.core.languageProcessor.mayPredict=b[c];break;case "mayCorrect":a.core.languageProcessor.mayCorrect=b[c];break;case "imagePath":this.imagePath=b[c]}this._options[c]=b[c];this.activeBanner||this.selectBanner("inactive")}};e.prototype.appendStyles=function(){this.activeBanner&&
this.activeBanner.appendStyleSheet()};e.prototype.setBanner=function(b,a){switch(b){case "blank":a=new h.BlankBanner;break;case "image":a=new h.ImageBanner(this.imagePath,h.Banner.DEFAULT_HEIGHT);break;case "suggestion":a=new h.SuggestionBanner(this.hostDevice,a);break;default:throw Error("Invalid type specified for the banner!");}this._activeType=b;a&&(this._setBanner(a),a.activate())};e.prototype.selectBanner=function(b){"active"==b?this.setBanner("suggestion"):"inactive"==b?this.alwaysShow?this.setBanner("image"):
this.setBanner("blank"):"configured"==b&&(b=this.activeBanner,b.postConfigure&&b.postConfigure())};e.prototype._setBanner=function(b){if(this.activeBanner){if(b==this.activeBanner)return;var a=this.activeBanner;a.deactivate();this.bannerContainer.replaceChild(b.getDiv(),a.getDiv())}this.activeBanner=b;this.bannerContainer.appendChild(b.getDiv());b=g.keyman.singleton;b.osk&&b.osk.refreshLayout()};Object.defineProperty(e.prototype,"activeType",{get:function(){return this._activeType},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"height",{get:function(){return this.activeBanner?this.activeBanner.height:0},set:function(b){this.activeBanner&&(this.activeBanner.height=b)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layoutHeight",{get:function(){return h.ParsedLengthStyle.inPixels(this.height)},enumerable:!0,configurable:!0});e.prototype.refreshLayout=function(){};e.DEFAULT_OPTIONS={alwaysShow:!1,mayPredict:!0,mayCorrect:!0,imagePath:""};return e}();h.BannerManager=
k})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(b){this.kbd=b;var a=this.element=document.createElement("div");a.style.userSelect="none";a.className="kmw-osk-static";a.id=e.ID;a.innerHTML=b.helpText}e.prototype.postInsert=function(){if(!this.element.parentElement||!document.getElementById(e.ID))throw Error("The HelpPage root element has not yet been inserted into the DOM.");this.kbd.hasScript&&this.kbd.embedScript(this.element.parentElement)};e.prototype.updateState=function(){};
e.prototype.refreshLayout=function(){};Object.defineProperty(e.prototype,"layoutHeight",{get:function(){return g.ParsedLengthStyle.inPercent(100)},enumerable:!0,configurable:!0});e.ID="kmw-osk-help-page";return e}();g.HelpPageView=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(g){(function(g){var h=function(){function e(){var b=this.element=document.createElement("div");b.style.userSelect="none";b.className="kmw-osk-none"}e.prototype.postInsert=function(){};e.prototype.updateState=function(){};e.prototype.refreshLayout=function(){};Object.defineProperty(e.prototype,"layoutHeight",{get:function(){return g.ParsedLengthStyle.inPixels(0)},enumerable:!0,configurable:!0});return e}();g.EmptyView=h})(g.osk||(g.osk={}))})(g.keyman||(g.keyman={}))})(com||
(com={}));
(function(g){(function(k){(function(h){var n;(function(b){b["static"]="static";b.manual="manual";b.automatic="automatic"})(n=h.ActivationMode||(h.ActivationMode={}));var e=function(){function b(a,b){this.needsLayout=!0;this._activationMode=n.automatic;this._displayIfActive=!0;this.layerChangeHandler=function(a,b){this.vkbd&&this.vkbd._UpdateVKShiftStyle(b);if(this.vkbd&&this.vkbd.layerId!=b||a.value!=b)this.vkbd&&(this.vkbd.layerId=b,this.vkbd.showLanguage()),this.keyboardView.updateState(),this.refreshLayout()}.bind(this);
this._Visible=!1;this.device=a;b||(b=a);this.hostDevice=b;this._Box=document.createElement("div");this._Box.style.userSelect="none";this.bannerView=new h.BannerManager(this.hostDevice);this.keyboardView=null;a=g.keyman.singleton;a.util.linkStyleSheet(a.getStyleSheetPath("kmwosk.css"));this.setBaseMouseEventListeners();b.touchable&&this.setBaseTouchEventListeners();var c=this;a.core.languageProcessor.on("statechange",function(a){var b=c.bannerView.activeType;c.bannerView.selectBanner(a);b!=c.bannerView.activeType&&
c.refreshLayout();return!0})}b.prototype.setBaseMouseEventListeners=function(){var a=g.keyman.singleton;this._boxBaseMouseDown=function(b){a.uiManager.setActivatingUI(!0);return!1};this._Box.addEventListener("mousedown",this._boxBaseMouseDown,!1)};b.prototype.removeBaseMouseEventListeners=function(){this._boxBaseMouseDown&&(this._Box.removeEventListener("mousedown",this._boxBaseMouseDown,!1),this._boxBaseMouseDown=null)};b.prototype.setBaseTouchEventListeners=function(){var a=g.keyman.singleton,b=
this._boxBaseTouchEventCancel=function(a){a.cancelable&&a.preventDefault();a.stopPropagation();return!1};this._boxBaseTouchStart=function(c){a.uiManager.setActivatingUI(!0);return b(c)};this._Box.addEventListener("touchstart",this._boxBaseTouchStart,!1);this._Box.addEventListener("touchmove",this._boxBaseTouchEventCancel,!1);this._Box.addEventListener("touchend",this._boxBaseTouchEventCancel,!1);this._Box.addEventListener("touchcancel",this._boxBaseTouchEventCancel,!1)};b.prototype.removeBaseTouchEventListeners=
function(){this._boxBaseTouchEventCancel&&(this._Box.removeEventListener("touchstart",this._boxBaseTouchStart,!1),this._Box.removeEventListener("touchmove",this._boxBaseTouchEventCancel,!1),this._Box.removeEventListener("touchend",this._boxBaseTouchEventCancel,!1),this._Box.removeEventListener("touchcancel",this._boxBaseTouchEventCancel,!1),this._boxBaseTouchStart=this._boxBaseTouchEventCancel=null)};Object.defineProperty(b.prototype,"activeTarget",{get:function(){return this._target},set:function(a){if(null!=
this._target||null!=a)this._target=a,this.commonCheckAndDisplay()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"targetDevice",{get:function(){return this.device},set:function(a){this.allowsDeviceChange(a)?(this.device=a,this.loadActiveKeyboard()):console.error("May not change target device for this OSKView type.")},enumerable:!0,configurable:!0});b.prototype.allowsDeviceChange=function(a){return!1};Object.defineProperty(b.prototype,"activationMode",{get:function(){this._activationMode||
(this._activationMode=n.automatic);return this._activationMode},set:function(a){this._activationMode=a;this.commonCheckAndDisplay()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activationConditionsMet",{get:function(){switch(this.activationMode){case "manual":return!0;case "static":return!0;case "automatic":return!!this.activeTarget;default:return console.error("Unexpected activation mode set for the OSK."),!1}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"displayIfActive",{get:function(){return this._displayIfActive},set:function(a){var b;this.displayIfActive!=a&&((null===(b=this.keyboard)||void 0===b?0:b.isCJK)&&!a?(console.warn("Cannot hide display of OSK for CJK keyboards."),a=!0):this.hostDevice.touchable&&!a?(console.warn("Cannot hide display of OSK when hosted on touch-based devices."),a=!0):"static"==this.activationMode&&(a=!0),this._displayIfActive=a,this.commonCheckAndDisplay())},enumerable:!0,configurable:!0});b.prototype.commonCheckAndDisplay=
function(){this.activationConditionsMet&&this.displayIfActive?this.present():this.startHide(!1)};Object.defineProperty(b.prototype,"vkbd",{get:function(){return this.keyboardView instanceof h.VisualKeyboard?this.keyboardView:null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"banner",{get:function(){return this.bannerView},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"height",{get:function(){return this._height},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"computedWidth",{get:function(){this.needsLayout&&this.refreshLayout();return this._computedWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"computedHeight",{get:function(){this.needsLayout&&this.refreshLayout();return this._computedHeight},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"baseFontSize",{get:function(){var a;return(null===(a=this.parsedBaseFontSize)||
void 0===a?void 0:a.styleString)||""},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parsedBaseFontSize",{get:function(){this._baseFontSize||(this._baseFontSize=this.defaultFontSize(this.device,g.keyman.singleton.isEmbedded));return this._baseFontSize},enumerable:!0,configurable:!0});b.prototype.defaultFontSize=function(a,b){return a.touchable?h.ParsedLengthStyle.special("phone"==a.formFactor?1.92*(b?.65:.6):2,"em"):this.computedHeight?h.ParsedLengthStyle.inPixels(this.computedHeight/
8):void 0};Object.defineProperty(b.prototype,"activeKeyboard",{get:function(){return this.keyboard},set:function(a){var b;this.keyboard=a;this.loadActiveKeyboard();if(null===(b=this.keyboard)||void 0===b?0:b.isCJK)this.displayIfActive=!0},enumerable:!0,configurable:!0});b.prototype.computeFrameHeight=function(){var a,b;return((null===(a=this.headerView)||void 0===a?void 0:a.layoutHeight.val)||0)+((null===(b=this.footerView)||void 0===b?void 0:b.layoutHeight.val)||0)};b.prototype.setSize=function(a,
b,d){var c=!1;if(a||0===a)if(b||0===b){var e=Number.isFinite(a)?h.ParsedLengthStyle.inPixels(a):new h.ParsedLengthStyle(a);var g=Number.isFinite(b)?h.ParsedLengthStyle.inPixels(b):new h.ParsedLengthStyle(b);a&&b&&(c=(c=(c=!this._width||!this._height)||e.styleString!=this._width.styleString)||g.styleString!=this._height.styleString,this._width=e,this._height=g);this.needsLayout=this.needsLayout||c;this.refreshLayoutIfNeeded(d)}};b.prototype.setNeedsLayout=function(){this.needsLayout=!0};b.prototype.refreshLayout=
function(a){var b,d;if(this.keyboardView){var e=this.width&&this.height,h=e&&this.width.absolute&&this.height.absolute,k=getComputedStyle(this._Box);k=""!=k.height&&"auto"!=k.height;if(h)this._computedWidth=this.width.val,this._computedHeight=this.height.val;else if(k&&e)e=this._Box.offsetParent,this._computedWidth=this.width.val*(this.width.absolute?1:e.offsetWidth),this._computedHeight=this.height.val*(this.height.absolute?1:e.offsetHeight);else return;this.needsLayout=!1;this.banner.element.style.fontSize=
this.baseFontSize;this.vkbd&&(this.vkbd.fontSize=this.parsedBaseFontSize);a||(null===(b=this.headerView)||void 0===b?void 0:b.refreshLayout(),this.bannerView.refreshLayout(),null===(d=this.footerView)||void 0===d?void 0:d.refreshLayout());this.vkbd?(b=this.computedHeight-this.computeFrameHeight(),0<this.bannerView.height&&(b-=this.bannerView.height+5),this.vkbd.setSize(this.computedWidth,b,a),a=this._Box.style,a.width=a.maxWidth=this.computedWidth+"px",a.height=a.maxHeight=this.computedHeight+"px"):
(a=this._Box.style,a.width="auto",a.height="auto",a.maxWidth=a.maxHeight="");g.keyman.singleton.alignInputs()}};b.prototype.refreshLayoutIfNeeded=function(a){this.needsLayout&&this.refreshLayout(a)};b.prototype._Load=function(){this.activeKeyboard=g.keyman.singleton.core.activeKeyboard};b.prototype.loadActiveKeyboard=function(){this.setBoxStyling();this.vkbd&&this.vkbd.shutdown();this.keyboardView=null;this.needsLayout=!0;this._Box.innerHTML="";this.headerView&&this._Box.appendChild(this.headerView.element);
this._Box.appendChild(this.banner.element);var a=this.keyboardView=this._GenerateKeyboardView(this.activeKeyboard);this._Box.appendChild(a.element);a.postInsert();this.footerView&&this._Box.appendChild(this.footerView.element);var b=this.activeKeyboard?this.activeKeyboard.id.replace("Keyboard_",""):"";-1!=b.indexOf("::")&&(b=b.substring(b.indexOf("::")+2));a.element.className+=" kmw-keyboard-"+b;this.banner.appendStyles();this.vkbd&&(this.vkbd.createKeyTip(),this.vkbd.appendStyleSheet());this.postKeyboardLoad()};
b.prototype._GenerateKeyboardView=function(a){var b=this.device;this.vkbd&&this.vkbd.shutdown();this._Box.className="";return null!=a||b.touchable?a&&a.layout(b.formFactor)?this._GenerateVisualKeyboard(a):a?new h.HelpPageView(a):this._GenerateVisualKeyboard(null):new h.EmptyView};b.prototype._GenerateVisualKeyboard=function(a){var b=this.device;a=new h.VisualKeyboard(a,b,this.hostDevice);g.keyman.singleton.core.keyboardProcessor.layerStore.handler=this.layerChangeHandler;this._Box.className=b.formFactor+
" "+b.OS.toLowerCase()+" kmw-osk-frame";return a};b.prototype.present=function(){if(this.mayShow()){this.keyboardView.updateState();this._Box.style.display="block";this.refreshLayoutIfNeeded();this.keyboardView instanceof h.VisualKeyboard&&this.keyboardView.showLanguage();this._Visible=!0;this._Box.style.opacity="1";if("hidden"==this._Box.style.visibility){var a=this;window.setTimeout(function(){a._Box.style.visibility="visible"},0)}this.setDisplayPositioning()}};b.prototype.startHide=function(a){var b;
if(this.mayHide(a)){a&&(this._displayIfActive=this.keyboard.isCJK||this.hostDevice.touchable?!0:!1);var d=null;d=!this._Box||!this.hostDevice.touchable||this.keyboardView instanceof h.EmptyView?Promise.resolve(!0):this.useHideAnimation();var e=this;d.then(function(a){a&&e.finalizeHide()});d={};d.HiddenByUser=a;this.doHide(d);a&&this.activeTarget instanceof k.dom.targets.OutputTarget&&(null===(b=this.activeTarget)||void 0===b?void 0:b.focus())}};b.prototype.finalizeHide=function(){if(!(0<=document.body.className.indexOf("osk-always-visible"))){if(this._Box){var a=
this._Box.style;a.display="none";a.transition="";a.opacity="1";this._Visible=!1}if(this.vkbd)this.vkbd.onHide()}};b.prototype.mayShow=function(){return this.activationConditionsMet&&this.keyboardView&&!(this.keyboardView instanceof h.EmptyView)&&this.displayIfActive&&this._Box?!0:!1};b.prototype.mayHide=function(a){return"automatic"!=this.activationMode&&this.displayIfActive||!a&&"desktop"==this.hostDevice.formFactor&&0<=document.body.className.indexOf("osk-always-visible")?!1:!0};b.prototype.useHideAnimation=
function(){var a=this._Box.style,b=this;return new Promise(function(c){var d=function(){b._Box.removeEventListener("transitionend",d,!1);b._Box.removeEventListener("webkitTransitionEnd",d,!1);b._Box.removeEventListener("transitioncancel",d,!1);b._Box.removeEventListener("webkitTransitionCancel",d,!1);0!=b._animatedHideTimeout&&window.clearTimeout(b._animatedHideTimeout);b._animatedHideTimeout=0;if(b._Visible&&b.activationConditionsMet)return a.transition="",a.opacity="1",c(!1),!1;c(!0);return!0},
e=function(){b._Box.removeEventListener("transitionrun",e,!1);b._Box.removeEventListener("webkitTransitionRun",e,!1);b._Box.addEventListener("transitionend",d,!1);b._Box.addEventListener("webkitTransitionEnd",d,!1);b._Box.addEventListener("transitioncancel",d,!1);b._Box.addEventListener("webkitTransitionCancel",d,!1)};b._Box.addEventListener("transitionrun",e,!1);b._Box.addEventListener("webkitTransitionRun",e,!1);a.transition="opacity 0.5s linear 0";a.opacity="0";b._animatedHideTimeout=window.setTimeout(d,
200)})};b.prototype.hideNow=function(){if(this.mayHide(!1)&&this._Box){this._animatedHideTimeout&&(window.clearTimeout(this._animatedHideTimeout),this._animatedHideTimeout=0);var a=this._Box.style;a.transition="";a.opacity="0";this.finalizeHide()}};b.prototype.shutdown=function(){this.removeBaseMouseEventListeners();this.removeBaseTouchEventListeners();var a=this._Box;a.parentElement&&a.parentElement.removeChild(a)};b.prototype.getRect=function(){var a={};a.left=a.left=k.dom.Utils.getAbsoluteX(this._Box);
a.top=a.top=k.dom.Utils.getAbsoluteY(this._Box);a.width=this.computedWidth;a.height=this.computedHeight;return a};b.prototype.showBuild=function(){var a=g.keyman.singleton;a.util.internalAlert("KeymanWeb Version "+a.version+"."+a.build+'<br /><br /><span style="font-size:0.8em">Copyright &copy; 2021 SIL International</span>')};b.prototype.showLanguageMenu=function(){this.hostDevice.touchable&&(this.lgMenu=new h.LanguageMenu(g.keyman.singleton),this.lgMenu.show())};b.prototype.hideLanguageMenu=function(){var a;
null===(a=this.lgMenu)||void 0===a?void 0:a.hide();this.lgMenu=null};b.prototype.isEnabled=function(){return this.displayIfActive};b.prototype.isVisible=function(){return this._Visible};b.prototype.hide=function(){this.displayIfActive=!1;this.startHide(!0)};b.prototype.show=function(a){0<arguments.length?this.displayIfActive=a:this.activationConditionsMet&&(this.displayIfActive=!this.displayIfActive)};b.prototype.doShow=function(a){return g.keyman.singleton.util.callEvent("osk.show",a)};b.prototype.doHide=
function(a){return g.keyman.singleton.util.callEvent("osk.hide",a)};b.prototype.addEventListener=function(a,b){return g.keyman.singleton.util.addEventListener("osk."+a,b)};return b}();h.OSKView=e})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(e){function b(a){a=e.call(this,a)||this;a.isResizing=!1;a.modifierCodes=k.text.Codes.modifierCodes;a.modifierBitmasks=k.text.Codes.modifierBitmasks;a.stateBitmasks=k.text.Codes.stateBitmasks;a.keyCodes=k.text.Codes.keyCodes;a.restorePosition=function(a){}.bind(a);a._VKbdMouseOver=function(a){g.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(a);a._VKbdMouseOut=function(a){g.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(a);document.body.appendChild(a._Box);
g.keyman.singleton.isEmbedded&&a.activationMode==h.ActivationMode.manual;return a}__extends(b,e);b.prototype._Unload=function(){this._Box=this.bannerView=this.keyboardView=null};b.prototype.setBoxStyling=function(){var a=this._Box.style;a.zIndex="9999";a.display="none";a.width="100%";a.position="fixed"};b.prototype.refreshLayout=function(a){if(!this.isResizing){try{this.isResizing=!0,this.doResize()}finally{this.isResizing=!1}e.prototype.refreshLayout.call(this,a)}};b.prototype.doResize=function(){if(this.vkbd&&
this.device.touchable){var a=this.getDefaultKeyboardHeight();this.setSize(this.getDefaultWidth(),a+this.banner.height)}};b.prototype.postKeyboardLoad=function(){this.doResize();this._Visible=!1;this._Box.onmouseover=this._VKbdMouseOver;this._Box.onmouseout=this._VKbdMouseOut;this.displayIfActive&&this.present()};b.prototype.getDefaultKeyboardHeight=function(){var a,b,d=g.keyman.singleton,e=d.util.device;if("function"==typeof d.getOskHeight)return d.getOskHeight();var h=null===(a=null===document||
void 0===document?void 0:document.documentElement)||void 0===a?void 0:a.clientWidth;a=null===(b=null===document||void 0===document?void 0:document.documentElement)||void 0===b?void 0:b.clientHeight;"undefined"==typeof h&&(h=Math.min(screen.height,screen.width),a=Math.max(screen.height,screen.width),d.util.portraitView()||(b=h,h=a,a=b));h=Math.floor(Math.min(a,h)/2);"phone"==e.formFactor&&(h=d.util.portraitView()?Math.floor(a/2.4):Math.floor(a/1.6));"iOS"==e.OS&&(h/=d.util.getViewportScale());return h};
b.prototype.getDefaultWidth=function(){var a,b=g.keyman.singleton,d=b.util.device;if("function"==typeof b.getOskWidth)return b.getOskWidth();b=null===(a=null===document||void 0===document?void 0:document.documentElement)||void 0===a?void 0:a.clientWidth;"undefined"==typeof b&&(b="iOS"==d.OS?window.innerWidth:"Android"==d.OS?screen.availWidth:screen.width);return b};b.prototype.setRect=function(a){};b.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:this.x,top:this._Visible?
a.offsetTop:this.y}};b.prototype.setPos=function(a){};b.prototype.setDisplayPositioning=function(){var a=this._Box.style;this.vkbd&&(a.position="fixed",a.left=a.bottom="0px",a.border="none",a.borderTop="1px solid gray")};b.prototype.doShow=function(a){return g.keyman.singleton.util.callEvent("osk.show",a)};b.prototype.doHide=function(a){return g.keyman.singleton.util.callEvent("osk.hide",a)};return b}(h.OSKView);h.AnchoredOSKView=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(e){function b(a){a=e.call(this,a)||this;a.userPositioned=!1;a.specifiedPosition=!1;a.noDrag=!1;a.modifierCodes=k.text.Codes.modifierCodes;a.modifierBitmasks=k.text.Codes.modifierBitmasks;a.stateBitmasks=k.text.Codes.stateBitmasks;a.keyCodes=k.text.Codes.keyCodes;a.restorePosition=function(a){var b,c=this._Visible;c&&this.activeTarget instanceof k.dom.targets.OutputTarget&&(null===(b=this.activeTarget)||void 0===b?void 0:b.focus());this.loadCookie();
this.userPositioned=!1;a||(delete this.dfltX,delete this.dfltY);this.saveCookie();c&&this.present();this.doResizeMove();this.desktopLayout.titleBar.showPin(!1)}.bind(a);a._VKbdMouseOver=function(a){g.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(a);a._VKbdMouseOut=function(a){g.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(a);document.body.appendChild(a._Box);a.loadCookie();var b=a.desktopLayout=new h.layouts.TargetedFloatLayout;a.headerView=b.titleBar;b.titleBar.attachHandlers(a);return a}
__extends(b,e);b.prototype._Unload=function(){this._Box=this.bannerView=this.keyboardView=null};b.prototype.setBoxStyling=function(){var a=this._Box.style;a.zIndex="9999";a.display="none";a.width="auto";a.position="absolute"};b.prototype.postKeyboardLoad=function(){this._Visible=!1;this._Box.onmouseover=this._VKbdMouseOver;this._Box.onmouseout=this._VKbdMouseOut;var a=this.desktopLayout;a.attachToView(this);this.activeKeyboard&&this.desktopLayout.titleBar.setTitleFromKeyboard(this.activeKeyboard);
this.vkbd?(this.footerView=a.resizeBar,this._Box.appendChild(this.footerView.element)):(this.footerView&&this._Box.removeChild(this.footerView.element),this.footerView=null);this.loadCookie();this.setNeedsLayout();this.displayIfActive&&this.present()};b.prototype.isEnabled=function(){return this.displayIfActive};b.prototype.isVisible=function(){return this._Visible};b.prototype.saveCookie=function(){var a=g.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard"),d=this.getPos();b.visible=
this.displayIfActive?1:0;b.userSet=this.userPositioned?1:0;b.left=d.left;b.top=d.top;b._version=k.utils.Version.CURRENT.toString();this.vkbd&&(b.width=this.width.val,b.height=this.height.val);a.saveCookie("KeymanWeb_OnScreenKeyboard",b)};b.prototype.loadCookie=function(){var a=g.keyman.singleton.util,b=a.loadCookie("KeymanWeb_OnScreenKeyboard");this.displayIfActive=1==a.toNumber(b.visible,1);this.userPositioned=1==a.toNumber(b.userSet,0);this.x=a.toNumber(b.left,-1);this.y=a.toNumber(b.top,-1);a=
b._version;var d=.3*screen.width,e=.15*screen.height,h=parseInt(b.width,10);b=parseInt(b.height,10);var k=isNaN(b);h=isNaN(h)?d:h;b=isNaN(b)?e:b;h<.2*screen.width&&(h=.2*screen.width);b<.1*screen.height&&(b=.1*screen.height);h>.9*screen.width&&(h=.9*screen.width);b>.5*screen.height&&(b=.5*screen.height);if(k||!a)this.headerView&&this.headerView.layoutHeight.absolute&&(b+=this.headerView.layoutHeight.val),this.footerView&&this.footerView.layoutHeight.absolute&&(b+=this.footerView.layoutHeight.val);
this.setSize(h,b);-1!=this.x&&-1!=this.y&&this._Box||(this.userPositioned=!1);this.x<window.pageXOffset-.8*h&&(this.x=window.pageXOffset-.8*h);0>this.y&&(this.y=this.x=-1,this.userPositioned=!1);this.userPositioned&&this._Box&&this.setPos({left:this.x,top:this.y})};b.prototype.getDefaultKeyboardHeight=function(){var a=g.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskHeight)return a.getOskHeight();var d=Math.floor(Math.min(screen.availHeight,screen.availWidth)/2);if("phone"==b.formFactor){var e=
Math.min(screen.height,screen.width),h=Math.max(screen.height,screen.width);d=a.util.portraitView()?Math.floor(Math.max(screen.availHeight,screen.availWidth)/3):h/e*d/1.6}"iOS"==b.OS&&(d/=a.util.getViewportScale());return d};b.prototype.getDefaultWidth=function(){var a=g.keyman.singleton,b=a.util.device;if("function"==typeof a.getOskWidth)return a.getOskWidth();if("iOS"==b.OS)var d=window.innerWidth;else if("Android"==b.OS)try{d=document.documentElement.clientWidth}catch(f){d=screen.availWidth}else d=
screen.width;return d};b.prototype.doResizeMove=function(a){return g.keyman.singleton.util.callEvent("osk.resizemove",a)};b.prototype.setRect=function(a){var b=g.keyman.singleton.util;if(null!=this._Box&&"desktop"==b.device.formFactor){b=this._Box;var d=b.style;"left"in a&&(this.x=a.left-k.dom.Utils.getAbsoluteX(b)+b.offsetLeft,d.left=this.x+"px",this.dfltX=d.left);"top"in a&&(this.y=a.top-k.dom.Utils.getAbsoluteY(b)+b.offsetTop,d.top=this.y+"px",this.dfltY=d.top);if(null!=this.vkbd){var e=this.vkbd.kbdDiv;
d=e.style;if("width"in a){var h=a.width-(b.offsetWidth-e.offsetWidth);h<.2*screen.width&&(h=.2*screen.width);h>.9*screen.width&&(h=.9*screen.width);d.width=h+"px";this.setSize(h,this.computedHeight,!0)}"height"in a&&(b=a.height-(b.offsetHeight-e.offsetHeight),b<.1*screen.height&&(b=.1*screen.height),b>.5*screen.height&&(b=.5*screen.height),d.height=b+"px",d.fontSize=b/8+"px",this.setSize(this.computedWidth,b,!0));"nosize"in a&&(this.desktopLayout.resizingEnabled=!a.nosize)}"nomove"in a&&(this.noDrag=
a.nomove,this.desktopLayout.movementEnabled=!this.noDrag);this.saveCookie()}};b.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:this.x,top:this._Visible?a.offsetTop:this.y}};b.prototype.setPos=function(a){if("undefined"!=typeof this._Box){if(this.userPositioned){var b=a.left;a=a.top;"undefined"!=typeof b&&(b<-.8*this._Box.offsetWidth&&(b=-.8*this._Box.offsetWidth),this.userPositioned&&(this._Box.style.left=b+"px",this.x=b));"undefined"!=typeof a&&(0>a&&(a=0),this.userPositioned&&
(this._Box.style.top=a+"px",this.y=a))}this.desktopLayout&&this.desktopLayout.titleBar.showPin(this.userPositioned)}};b.prototype.setDisplayPositioning=function(){var a,b=this._Box.style;b.position="absolute";b.display="block";b.left="0px";if(this.specifiedPosition||this.userPositioned)b.left=this.x+"px",b.top=this.y+"px";else{var d=null;this.activeTarget instanceof k.dom.targets.OutputTarget&&(d=null===(a=this.activeTarget)||void 0===a?void 0:a.getElement());this.dfltX?b.left=this.dfltX:"undefined"!=
typeof d&&null!=d&&(b.left=k.dom.Utils.getAbsoluteX(d)+"px");this.dfltY?b.top=this.dfltY:"undefined"!=typeof d&&null!=d&&(b.top=k.dom.Utils.getAbsoluteY(d)+d.offsetHeight+"px")}this.specifiedPosition=!1};b.prototype.presentAtPosition=function(a,b){if(this.mayShow()){if(this.specifiedPosition=0<=a||0<=b)this.x=a,this.y=b;this.specifiedPosition=this.specifiedPosition||this.userPositioned;this.present()}};b.prototype.present=function(){if(this.mayShow()){this.desktopLayout.titleBar.showPin(this.userPositioned);
e.prototype.present.call(this);var a={};a.x=this._Box.offsetLeft;a.y=this._Box.offsetTop;a.userLocated=this.userPositioned;this.doShow(a)}};b.prototype.startHide=function(a){e.prototype.startHide.call(this,a);a&&this.saveCookie()};b.prototype.show=function(a){e.prototype.show.call(this,a);this.saveCookie()};b.prototype.userLocated=function(){return this.userPositioned};return b}(h.OSKView);h.FloatingOSKView=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){var n=function(e){function b(a,b){a=e.call(this,a,b)||this;a.modifierCodes=k.text.Codes.modifierCodes;a.modifierBitmasks=k.text.Codes.modifierBitmasks;a.stateBitmasks=k.text.Codes.stateBitmasks;a.keyCodes=k.text.Codes.keyCodes;a.restorePosition=function(a){}.bind(a);a._VKbdMouseOver=function(a){g.keyman.singleton.uiManager.setActivatingUI(!0)}.bind(a);a._VKbdMouseOut=function(a){g.keyman.singleton.uiManager.setActivatingUI(!1)}.bind(a);a.activationMode=h.ActivationMode.manual;
return a}__extends(b,e);Object.defineProperty(b.prototype,"element",{get:function(){return this._Box},enumerable:!0,configurable:!0});b.prototype._Unload=function(){this._Box=this.bannerView=this.keyboardView=null};b.prototype.setBoxStyling=function(){var a=this._Box.style;a.display="none";a.position="relative"};b.prototype.postKeyboardLoad=function(){this._Visible=!1;this._Box.onmouseover=this._VKbdMouseOver;this._Box.onmouseout=this._VKbdMouseOut;this.displayIfActive&&this.present()};b.prototype.getDefaultKeyboardHeight=
function(){return this.keyboardView instanceof h.VisualKeyboard?this.keyboardView.height:this.computedHeight};b.prototype.getDefaultWidth=function(){return this.computedWidth};b.prototype.setRect=function(a){};b.prototype.getPos=function(){var a=this._Box;return{left:this._Visible?a.offsetLeft:void 0,top:this._Visible?a.offsetTop:void 0}};b.prototype.setPos=function(a){};b.prototype.setDisplayPositioning=function(){};b.prototype.doShow=function(a){return g.keyman.singleton.util.callEvent("osk.show",
a)};b.prototype.doHide=function(a){return g.keyman.singleton.util.callEvent("osk.hide",a)};b.prototype.allowsDeviceChange=function(a){return!0};return b}(h.OSKView);h.InlinedOSKView=n})(k.osk||(k.osk={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){(function(h){(function(h){var e=function(){function b(){this.registeredModels={};this.languageModelMap={}}b.prototype.init=function(){g.keyman.singleton.addEventListener("keyboardchange",this.onKeyboardChange.bind(this))};b.prototype.onKeyboardChange=function(a){var b,d=g.keyman.singleton,e=d.core;"string"==typeof a&&(a=(b={},b.internalName=d.keyboardManager.getActiveKeyboardName(),b.languageCode=a,b.indirect=!0,b));a=this.languageModelMap[a.languageCode];e.activeModel&&
e.languageProcessor.unloadModel();a&&e.languageProcessor.loadModel(a)};b.prototype.register=function(a){var b=g.keyman.singleton.keyboardManager.getActiveLanguage();if(JSON.stringify(a)!=JSON.stringify(this.registeredModels[a.id])){this.registeredModels[a.id]=a;var d=this;a.languages.forEach(function(c){d.languageModelMap[c]=a;if(c==b)d.onKeyboardChange(c)})}};b.prototype.deregister=function(a){var b=g.keyman.singleton.core;if(this.registeredModels[a]){var d=this.registeredModels[a];delete this.registeredModels[a];
b.activeModel&&b.activeModel.id==a&&b.languageProcessor.unloadModel();var e=this;d.languages.forEach(function(b){e.languageModelMap[b].id==a&&delete e.languageModelMap[b]})}};b.prototype.isRegistered=function(a){return!!this.registeredModels[a.id]};return b}();h.ModelManager=e})(h.prediction||(h.prediction={}))})(k.text||(k.text={}))})(g.keyman||(g.keyman={}))})(com||(com={}));
(function(g){(function(k){var h;(function(e){e.KEYBOARD="keyboard";e.LANGUAGE="language";e.LANGUAGE_KEYBOARD="languageKeyboard";e.BLANK="blank"})(h=k.SpacebarText||(k.SpacebarText={}));var n=function(){function e(){var b=this;this._IE=0;this._MasterDocument=null;this._HotKeys=[];this.warned=!1;this.baseFont="sans-serif";this.appliedFont="";this.fontCheckTimer=null;this.protocol=this.rootPath=this.srcPath="";this.mustReloadKeyboard=!1;this.globalLanguageCode=this.globalKeyboard=null;this.isEmbedded=
!1;this.refocusTimer=0;this.isHeadless=!1;this.build=300;this.options={root:"",resources:"",keyboards:"",fonts:"",attachType:"",ui:null,setActiveOnRegister:"true",spacebarText:h.LANGUAGE_KEYBOARD,useAlerts:!0};this.refreshElementContent=null;this.pageFocusHandler=function(){var a;!b.uiManager.isActivating&&(null===(a=b.osk)||void 0===a?0:a.vkbd)&&b.util.device.touchable&&b.core.keyboardProcessor._UpdateVKShift(null);return!1};this.util=this.util=new k.Util(this);this.ui=this.ui={};this.keyboardManager=
new k.keyboards.KeyboardManager(this);this.domManager=new k.dom.DOMManager(this);this.hotkeyManager=new k.HotkeyManager(this);this.uiManager=new k.UIManager(this);var a="undefined"!==typeof window.KeymanWeb_BaseLayout?window.KeymanWeb_BaseLayout:"us";this._BrowserIsSafari=0<=navigator.userAgent.indexOf("AppleWebKit");this.core=new k.text.InputProcessor(this.util.device.coreSpec,{baseLayout:a,variableStoreSerializer:new k.dom.VariableStoreCookieSerializer});this["interface"]=this.core.keyboardInterface;
this.modelManager=new k.text.prediction.ModelManager;this.osk=this.osk=null;this.build=g.keyman.environment.BUILD;this.srcPath=e._srcPath;this.rootPath=e._rootPath;this.protocol=e._protocol;this.version=g.keyman.environment.VERSION;this.helpURL="http://help.keyman.com/go";this.setInitialized(0);this.loaded=!0}e.prototype.setDefaultDeviceOptions=function(b){};e.prototype.getStyleSheetPath=function(b){return b};e.prototype.getKeyboardPath=function(b,a){return b};e.prototype.KC_=function(b,a,c){return""};
e.prototype.handleRotationEvents=function(){};e.prototype.alignInputs=function(b){};e.prototype.hideInputs=function(){};e.prototype.namespaceID=function(b){};e.prototype.preserveID=function(b){};e.prototype.setInitialized=function(b){this.initialized=this.initialized=b};e.prototype.delayedInit=function(){this.touchAliasing=this.util.device.touchable?this.domManager.touchHandlers:this.domManager.nonTouchHandlers};e.prototype.shutdown=function(){this.util.detachDOMEvent(window,"focus",this.pageFocusHandler,
!1);this.util.detachDOMEvent(window,"blur",this.pageFocusHandler,!1);this.domManager.shutdown();this.osk.shutdown();this.util.shutdown();this.keyboardManager.shutdown();this.core.languageProcessor.shutdown();this.ui&&this.ui.shutdown&&this.ui.shutdown();k.dom.DOMEventHandlers.states=new k.dom.CommonDOMStates};e.prototype.getDebugInfo=function(){var b={attachType:this.options.attachType,device:this.util.device,initialized:this.initialized,isEmbedded:this.isEmbedded,ui:this.ui?this.ui.name:null};this.util.device.touchable&&
(b.ui="touch");return b};e.prototype.isFontAvailable=function(b){return this.util.checkFont({family:b})};e.prototype.addEventListener=function(b,a){return this.util.addEventListener("kmw."+b,a)};e.prototype._GetEventObject=function(b){if(!b&&(b=window.event,!b)){var a=this.domManager.lastActiveElement;if(a){b=a.ownerDocument;if(b)var c=b.defaultView;if(!c)return null;b=c.event}}return b};e.prototype._push=function(b,a){b.push?b.push(a):b=b.concat(a);return b};e.prototype.attachToControl=function(b){this.domManager.attachToControl(b)};
e.prototype.detachFromControl=function(b){this.domManager.detachFromControl(b)};e.prototype.addKeyboards=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];if(b&&b[0]&&0!=b[0].length){var c=[];Array.isArray(b[0])?b[0].forEach(function(a){return c.push(a)}):Array.isArray(b)?b.forEach(function(a){return c.push(a)}):c.push(b);return this.keyboardManager.addKeyboardArray(c)}return this.keyboardManager.keymanCloudRequest("",!1).catch(function(a){console.error(a);return Promise.reject([{error:a}])})};
e.prototype.addKeyboardsForLanguage=function(b){return"string"===typeof b?this.keyboardManager.addLanguageKeyboards(b.split(",").map(function(a){return a.trim()})):this.keyboardManager.addLanguageKeyboards(b)};e.prototype.register=function(b){this.keyboardManager.register(b)};e.prototype.removeKeyboards=function(b,a){return this.keyboardManager.removeKeyboards(b)};e.prototype.setActiveKeyboard=function(b,a){return this.keyboardManager.setActiveKeyboard(b,a)};e.prototype.getActiveKeyboard=function(){return this.keyboardManager.getActiveKeyboardName()};
e.prototype.getActiveLanguage=function(b){return this.keyboardManager.getActiveLanguage(b)};e.prototype.isAttached=function(b){return this.domManager.isAttached(b)};e.prototype.isCJK=function(b){return(b=b?new k.keyboards.Keyboard(b):this.core.activeKeyboard)&&b.isCJK};e.prototype.isChiral=function(b){return(b?new k.keyboards.Keyboard(b):this.core.activeKeyboard).isChiral};e.prototype.getKeyboard=function(b,a){var c,d=this.keyboardManager.getDetailedKeyboards();for(c=0;c<d.length;c++){var e=d[c];
if(e.InternalName==b||e.InternalName=="Keyboard_"+b)if(2>arguments.length||e.LanguageCode==a)return e}return null};e.prototype.getKeyboards=function(){return this.keyboardManager.getDetailedKeyboards()};e.prototype.getSavedKeyboard=function(){return this.keyboardManager.getSavedKeyboard()};e.prototype.init=function(b){return this.domManager.init(b)};e.prototype.resetContext=function(b){b||(b=this.domManager.activeElement);(b=k.dom.Utils.getOutputTarget(b))&&b.resetContext();this.core.resetContext(b)};
e.prototype.setNumericLayer=function(){this.core.keyboardProcessor.setNumericLayer(this.util.device.coreSpec)};e.prototype.disableControl=function(b){this.domManager.disableControl(b)};e.prototype.enableControl=function(b){this.domManager.enableControl(b)};e.prototype.setKeyboardForControl=function(b,a,c){this.domManager.setKeyboardForControl(b,a,c)};e.prototype.getKeyboardForControl=function(b){this.domManager.getKeyboardForControl(b)};e.prototype.getLanguageForControl=function(b){this.domManager.getLanguageForControl(b)};
e.prototype.focusLastActiveElement=function(){this.domManager.focusLastActiveElement()};e.prototype.getLastActiveElement=function(){return this.domManager.lastActiveElement};e.prototype.setActiveElement=function(b,a){return this.domManager.setActiveElement(b,a)};e.prototype.moveToElement=function(b){this.domManager.moveToElement(b)};e.prototype.addHotKey=function(b,a,c){this.hotkeyManager.addHotKey(b,a,c)};e.prototype.removeHotKey=function(b,a){this.hotkeyManager.removeHotkey(b,a)};e.prototype.getUIState=
function(){return this.uiManager.getUIState()};e.prototype.activatingUI=function(b){this.uiManager.setActivatingUI(b)};e.prototype.BuildVisualKeyboard=function(b,a,c,d){a=null;if(null!=b){b=b.toLowerCase().replace("keyboard_","");for(var e=this.keyboardManager.keyboards,h=0;h<e.length;h++)if(b==e[h].KI.toLowerCase().replace("keyboard_","")){a=new g.keyman.keyboards.Keyboard(e[h]);break}}a=a||this.core.activeKeyboard;b=this.getOskHeight;b=("function"==typeof b?b():null)||this.osk.computedHeight||200;
return g.keyman.osk.VisualKeyboard.buildDocumentationKeyboard(a,c,d,b)};return e}();k.KeymanBase=n})(g.keyman||(g.keyman={}))})(com||(com={}));var scripts=document.getElementsByTagName("script"),ss=scripts[scripts.length-1].src,sPath=ss.substr(0,ss.lastIndexOf("/")+1),KeymanBase=com.keyman.KeymanBase;KeymanBase._srcPath=sPath;KeymanBase._rootPath=sPath.replace(/(https?:\/\/)([^\/]*)(.*)/,"$1$2/");KeymanBase._protocol=sPath.replace(/(.{3,5}:)(.*)/,"$1");
window.keyman&&window.keyman.loaded||function(){window.keyman=com.keyman.singleton=com.keyman.singleton=new KeymanBase;window.keyman.core.languageProcessor.init()}();
window.keyman.initialized||function(){var g=window.keyman,k=g.util;g.debug=g.debug=function(h){if(null==g.debugElement){var k=document.createElement("DIV");var e=k.style;e.position="absolute";e.width="30%";e.maxHeight="50%";e.top="0";e.right="0";e.minHeight="50px";e.border="1px solid blue";e.whiteSpace="pre-line";e.overflowY="scroll";e=document.createElement("P");e.id="debug_output";e.style.margin="2px";k.appendChild(e);document.body.appendChild(k);g.debugElement=e}if(null!=(e=document.getElementById("debug_output")))if(0==
arguments.length)"undefined"!=typeof e.textContent?e.textContent="":e.innerHTML="";else{k=(new Date).toTimeString().substr(3,5)+" ";var b,a;for(b=0;b<arguments.length;b++){0<b&&(k+="; ");var c=arguments[b];if("object"==typeof c)if(null==c)k+="null";else{var d="";for(a in c){0<d.length&&(d+=", ");d=d+a+":";switch(typeof c[a]){case "string":case "number":case "boolean":d+=c[a];break;default:d+=typeof c[a]}if(1024<d.length){d=d.substr(0,1E3)+"...";break}}0<d.length&&(k=k+"{"+d+"}")}else k+=c}1500<k.length&&
(k=k.substr(0,1500)+" (more)");"undefined"!=typeof e.textContent?e.textContent=k+"\n"+e.textContent:e.innerHTML=k+"<br />"+e.innerHTML}};g.debugElement=null;g.delayedInit();k.attachDOMEvent(window,"load",g.domManager._WindowLoad,!1);k.attachDOMEvent(window,"unload",g.domManager._WindowUnload,!1);k.attachDOMEvent(document,"keyup",g.hotkeyManager._Process,!1);k.attachDOMEvent(window,"focus",g.pageFocusHandler,!1);k.attachDOMEvent(window,"blur",g.pageFocusHandler,!1);String.kmwEnableSupplementaryPlane(!0)}();
(function(g){(function(g){var h=function(){function e(){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight}e.prototype.equals=function(b){return this.innerWidth==b.innerWidth&&this.innerHeight==b.innerHeight};return e}(),k=function(){function e(b){this.idlePermutationCounter=e.IDLE_PERMUTATION_CAP;this.keyman=b}e.prototype.resolve=function(){this.keyman.alignInputs();var b=this.keyman.osk;b.hideLanguageMenu();b.setNeedsLayout();this.oskVisible&&b.present();this.isActive=!1;this.updateTimer&&
(window.clearInterval(this.updateTimer),this.rotState=null)};e.prototype.initNewRotation=function(){this.oskVisible=this.keyman.osk.isVisible();this.keyman.osk.hideNow();this.isActive=!0};e.prototype.init=function(){if(!this.keyman.isEmbedded){var b=this.keyman.util.device.OS,a=this.keyman.util,c=this;"iOS"==b?(a.attachDOMEvent(window,"orientationchange",function(){c.iOSEventHandler();return!1}),a.attachDOMEvent(window,"resize",function(){c.iOSEventHandler();return!1})):"Android"==b&&("onmozorientationchange"in
screen?a.attachDOMEvent(screen,"mozorientationchange",function(){c.initNewRotation();return!1}):a.attachDOMEvent(window,"orientationchange",function(){c.initNewRotation();return!1}),a.attachDOMEvent(window,"resize",function(){c.resolve();return!1}))}};e.prototype.iOSEventHandler=function(){this.isActive||(this.initNewRotation(),this.rotState=new h,this.updateTimer=window.setInterval(this.iOSEventUpdate.bind(this),e.UPDATE_INTERVAL));this.idlePermutationCounter=0};e.prototype.iOSEventUpdate=function(){var b=
new h;this.rotState.equals(b)?++this.idlePermutationCounter==e.IDLE_PERMUTATION_CAP&&this.resolve():(this.rotState=b,this.idlePermutationCounter=0)};e.IDLE_PERMUTATION_CAP=15;e.UPDATE_INTERVAL=20;return e}();g.RotationManager=k})(g.keyman||(g.keyman={}))})(com||(com={}));
window.keyman.initialized||function(){var g=window.keyman,k=g.util,h=k.device,n=com.keyman.dom;g.isEmbedded=!1;g.setDefaultDeviceOptions=function(e){e.attachType||(e.attachType=h.touchable?"manual":"auto")};k.wait=function(e){var b=this.waiting;if("undefined"!=typeof b&&null!=b&&!g.warned){var a=b.firstChild.childNodes;e?(b.pending=!0,window.setTimeout(function(){b.pending&&g.options.useAlerts&&(window.scrollTo(0,0),a[0].style.display="none",a[1].className="kmw-wait-text",a[1].innerHTML=e,a[2].style.display=
"block",b.style.display="block")},1E3)):b.pending&&(a[1].innerHTML="",b.pending=!1,b.style.display="none")}};g.getStyleSheetPath=function(e){return k.getOption("resources")+"osk/"+e};g.getKeyboardPath=function(e){return(/^(([\.]\/)|([\.][\.]\/)|(\/))|(:)/.test(e)?"":g.options.keyboards)+e};g.alignInputs=function(e){if(h.touchable){var b=g.domManager,a=[];e?e.forEach(function(b){b.base?a.push(b):b.kmw_ip&&a.push(b.kmw_ip)}):a=b.inputList;a.forEach(function(a){n.Utils.instanceof(a,"TouchAliasElement")&&
a.updateInput();a.style.visibility="visible";0<a.base.textContent.length&&(a.base.style.visibility="hidden")})}};g.hideInputs=function(){var e=g.domManager;if(h.touchable)for(var b=0;b<e.inputList.length;b++)e.inputList[b].style.visibility="hidden",e.inputList[b].base.style.visibility="visible"};g.isPositionSynthesized=function(){return h.touchable};g.handleRotationEvents=function(){(new com.keyman.RotationManager(g)).init()}}();
(function(){var g=window.keyman,k=window.setInterval(function(){"complete"===document.readyState&&(window.clearInterval(k),g.init(null))},10)})();(function(){var g=com.keyman.Util.prototype;g._GetAbsoluteX=g.getAbsoluteX;g._GetAbsoluteY=g.getAbsoluteY;g._GetAbsolute=g.getAbsolute;g.toNzString=g.nzString})();(function(){com.keyman.text.KeyboardInterface.__publishShorthandAPI()})();
//# sourceMappingURL=keymanweb.js.map
